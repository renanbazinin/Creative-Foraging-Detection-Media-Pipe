(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var vc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var L0={exports:{}},Su={},B0={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ra=Symbol.for("react.element"),_3=Symbol.for("react.portal"),j3=Symbol.for("react.fragment"),N3=Symbol.for("react.strict_mode"),b3=Symbol.for("react.profiler"),M3=Symbol.for("react.provider"),T3=Symbol.for("react.context"),P3=Symbol.for("react.forward_ref"),I3=Symbol.for("react.suspense"),R3=Symbol.for("react.memo"),L3=Symbol.for("react.lazy"),rm=Symbol.iterator;function B3(e){return e===null||typeof e!="object"?null:(e=rm&&e[rm]||e["@@iterator"],typeof e=="function"?e:null)}var F0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O0=Object.assign,$0={};function So(e,t,n){this.props=e,this.context=t,this.refs=$0,this.updater=n||F0}So.prototype.isReactComponent={};So.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};So.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function D0(){}D0.prototype=So.prototype;function Cf(e,t,n){this.props=e,this.context=t,this.refs=$0,this.updater=n||F0}var _f=Cf.prototype=new D0;_f.constructor=Cf;O0(_f,So.prototype);_f.isPureReactComponent=!0;var sm=Array.isArray,z0=Object.prototype.hasOwnProperty,jf={current:null},U0={key:!0,ref:!0,__self:!0,__source:!0};function H0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)z0.call(t,r)&&!U0.hasOwnProperty(r)&&(s[r]=t[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var d=Array(u),h=0;h<u;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:Ra,type:e,key:i,ref:a,props:s,_owner:jf.current}}function F3(e,t){return{$$typeof:Ra,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Nf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ra}function O3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var im=/\/+/g;function wc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?O3(""+e.key):t.toString(36)}function wl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ra:case _3:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+wc(a,0):r,sm(s)?(n="",e!=null&&(n=e.replace(im,"$&/")+"/"),wl(s,t,n,"",function(h){return h})):s!=null&&(Nf(s)&&(s=F3(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(im,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",sm(e))for(var u=0;u<e.length;u++){i=e[u];var d=r+wc(i,u);a+=wl(i,t,n,d,s)}else if(d=B3(e),typeof d=="function")for(e=d.call(e),u=0;!(i=e.next()).done;)i=i.value,d=r+wc(i,u++),a+=wl(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ja(e,t,n){if(e==null)return e;var r=[],s=0;return wl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function $3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kn={current:null},xl={transition:null},D3={ReactCurrentDispatcher:kn,ReactCurrentBatchConfig:xl,ReactCurrentOwner:jf};function G0(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Ja,forEach:function(e,t,n){Ja(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ja(e,function(){t++}),t},toArray:function(e){return Ja(e,function(t){return t})||[]},only:function(e){if(!Nf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=So;Ye.Fragment=j3;Ye.Profiler=b3;Ye.PureComponent=Cf;Ye.StrictMode=N3;Ye.Suspense=I3;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D3;Ye.act=G0;Ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=O0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=jf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(d in t)z0.call(t,d)&&!U0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&u!==void 0?u[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var h=0;h<d;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:Ra,type:e.type,key:s,ref:i,props:r,_owner:a}};Ye.createContext=function(e){return e={$$typeof:T3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:M3,_context:e},e.Consumer=e};Ye.createElement=H0;Ye.createFactory=function(e){var t=H0.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:P3,render:e}};Ye.isValidElement=Nf;Ye.lazy=function(e){return{$$typeof:L3,_payload:{_status:-1,_result:e},_init:$3}};Ye.memo=function(e,t){return{$$typeof:R3,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=xl.transition;xl.transition={};try{e()}finally{xl.transition=t}};Ye.unstable_act=G0;Ye.useCallback=function(e,t){return kn.current.useCallback(e,t)};Ye.useContext=function(e){return kn.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return kn.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return kn.current.useEffect(e,t)};Ye.useId=function(){return kn.current.useId()};Ye.useImperativeHandle=function(e,t,n){return kn.current.useImperativeHandle(e,t,n)};Ye.useInsertionEffect=function(e,t){return kn.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return kn.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return kn.current.useMemo(e,t)};Ye.useReducer=function(e,t,n){return kn.current.useReducer(e,t,n)};Ye.useRef=function(e){return kn.current.useRef(e)};Ye.useState=function(e){return kn.current.useState(e)};Ye.useSyncExternalStore=function(e,t,n){return kn.current.useSyncExternalStore(e,t,n)};Ye.useTransition=function(){return kn.current.useTransition()};Ye.version="18.3.1";B0.exports=Ye;var j=B0.exports;const W0=C3(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z3=j,U3=Symbol.for("react.element"),H3=Symbol.for("react.fragment"),G3=Object.prototype.hasOwnProperty,W3=z3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V3={key:!0,ref:!0,__self:!0,__source:!0};function V0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)G3.call(t,r)&&!V3.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:U3,type:e,key:i,ref:a,props:s,_owner:W3.current}}Su.Fragment=H3;Su.jsx=V0;Su.jsxs=V0;L0.exports=Su;var l=L0.exports,dd={},Y0={exports:{}},Jn={},X0={exports:{}},K0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,Z){var re=se.length;se.push(Z);e:for(;0<re;){var ge=re-1>>>1,Me=se[ge];if(0<s(Me,Z))se[ge]=Z,se[re]=Me,re=ge;else break e}}function n(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var Z=se[0],re=se.pop();if(re!==Z){se[0]=re;e:for(var ge=0,Me=se.length,Ue=Me>>>1;ge<Ue;){var $e=2*(ge+1)-1,Ne=se[$e],ze=$e+1,Y=se[ze];if(0>s(Ne,re))ze<Me&&0>s(Y,Ne)?(se[ge]=Y,se[ze]=re,ge=ze):(se[ge]=Ne,se[$e]=re,ge=$e);else if(ze<Me&&0>s(Y,re))se[ge]=Y,se[ze]=re,ge=ze;else break e}}return Z}function s(se,Z){var re=se.sortIndex-Z.sortIndex;return re!==0?re:se.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,u=a.now();e.unstable_now=function(){return a.now()-u}}var d=[],h=[],m=1,w=null,S=3,_=!1,L=!1,F=!1,X=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(se){for(var Z=n(h);Z!==null;){if(Z.callback===null)r(h);else if(Z.startTime<=se)r(h),Z.sortIndex=Z.expirationTime,t(d,Z);else break;Z=n(h)}}function E(se){if(F=!1,v(se),!L)if(n(d)!==null)L=!0,we(N);else{var Z=n(h);Z!==null&&Te(E,Z.startTime-se)}}function N(se,Z){L=!1,F&&(F=!1,C(H),H=-1),_=!0;var re=S;try{for(v(Z),w=n(d);w!==null&&(!(w.expirationTime>Z)||se&&!K());){var ge=w.callback;if(typeof ge=="function"){w.callback=null,S=w.priorityLevel;var Me=ge(w.expirationTime<=Z);Z=e.unstable_now(),typeof Me=="function"?w.callback=Me:w===n(d)&&r(d),v(Z)}else r(d);w=n(d)}if(w!==null)var Ue=!0;else{var $e=n(h);$e!==null&&Te(E,$e.startTime-Z),Ue=!1}return Ue}finally{w=null,S=re,_=!1}}var T=!1,$=null,H=-1,q=5,V=-1;function K(){return!(e.unstable_now()-V<q)}function ne(){if($!==null){var se=e.unstable_now();V=se;var Z=!0;try{Z=$(!0,se)}finally{Z?ee():(T=!1,$=null)}}else T=!1}var ee;if(typeof g=="function")ee=function(){g(ne)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,ve=ie.port2;ie.port1.onmessage=ne,ee=function(){ve.postMessage(null)}}else ee=function(){X(ne,0)};function we(se){$=se,T||(T=!0,ee())}function Te(se,Z){H=X(function(){se(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){L||_||(L=!0,we(N))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(se){switch(S){case 1:case 2:case 3:var Z=3;break;default:Z=S}var re=S;S=Z;try{return se()}finally{S=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,Z){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var re=S;S=se;try{return Z()}finally{S=re}},e.unstable_scheduleCallback=function(se,Z,re){var ge=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?ge+re:ge):re=ge,se){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=re+Me,se={id:m++,callback:Z,priorityLevel:se,startTime:re,expirationTime:Me,sortIndex:-1},re>ge?(se.sortIndex=re,t(h,se),n(d)===null&&se===n(h)&&(F?(C(H),H=-1):F=!0,Te(E,re-ge))):(se.sortIndex=Me,t(d,se),L||_||(L=!0,we(N))),se},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(se){var Z=S;return function(){var re=S;S=Z;try{return se.apply(this,arguments)}finally{S=re}}}})(K0);X0.exports=K0;var Y3=X0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X3=j,Kn=Y3;function ae(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Q0=new Set,ha={};function vi(e,t){ro(e,t),ro(e+"Capture",t)}function ro(e,t){for(ha[e]=t,e=0;e<t.length;e++)Q0.add(t[e])}var ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fd=Object.prototype.hasOwnProperty,K3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,om={},am={};function Q3(e){return fd.call(am,e)?!0:fd.call(om,e)?!1:K3.test(e)?am[e]=!0:(om[e]=!0,!1)}function J3(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function q3(e,t,n,r){if(t===null||typeof t>"u"||J3(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function An(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var an={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){an[e]=new An(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];an[t]=new An(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){an[e]=new An(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){an[e]=new An(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){an[e]=new An(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){an[e]=new An(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){an[e]=new An(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){an[e]=new An(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){an[e]=new An(e,5,!1,e.toLowerCase(),null,!1,!1)});var bf=/[\-:]([a-z])/g;function Mf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(bf,Mf);an[t]=new An(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(bf,Mf);an[t]=new An(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(bf,Mf);an[t]=new An(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){an[e]=new An(e,1,!1,e.toLowerCase(),null,!1,!1)});an.xlinkHref=new An("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){an[e]=new An(e,1,!1,e.toLowerCase(),null,!0,!0)});function Tf(e,t,n,r){var s=an.hasOwnProperty(t)?an[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(q3(t,n,s,r)&&(n=null),r||s===null?Q3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ps=X3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qa=Symbol.for("react.element"),Pi=Symbol.for("react.portal"),Ii=Symbol.for("react.fragment"),Pf=Symbol.for("react.strict_mode"),hd=Symbol.for("react.profiler"),J0=Symbol.for("react.provider"),q0=Symbol.for("react.context"),If=Symbol.for("react.forward_ref"),pd=Symbol.for("react.suspense"),md=Symbol.for("react.suspense_list"),Rf=Symbol.for("react.memo"),xs=Symbol.for("react.lazy"),Z0=Symbol.for("react.offscreen"),lm=Symbol.iterator;function Fo(e){return e===null||typeof e!="object"?null:(e=lm&&e[lm]||e["@@iterator"],typeof e=="function"?e:null)}var Tt=Object.assign,xc;function Xo(e){if(xc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);xc=t&&t[1]||""}return`
`+xc+e}var Sc=!1;function kc(e,t){if(!e||Sc)return"";Sc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,u=i.length-1;1<=a&&0<=u&&s[a]!==i[u];)u--;for(;1<=a&&0<=u;a--,u--)if(s[a]!==i[u]){if(a!==1||u!==1)do if(a--,u--,0>u||s[a]!==i[u]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=u);break}}}finally{Sc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Xo(e):""}function Z3(e){switch(e.tag){case 5:return Xo(e.type);case 16:return Xo("Lazy");case 13:return Xo("Suspense");case 19:return Xo("SuspenseList");case 0:case 2:case 15:return e=kc(e.type,!1),e;case 11:return e=kc(e.type.render,!1),e;case 1:return e=kc(e.type,!0),e;default:return""}}function gd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ii:return"Fragment";case Pi:return"Portal";case hd:return"Profiler";case Pf:return"StrictMode";case pd:return"Suspense";case md:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case q0:return(e.displayName||"Context")+".Consumer";case J0:return(e._context.displayName||"Context")+".Provider";case If:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Rf:return t=e.displayName||null,t!==null?t:gd(e.type)||"Memo";case xs:t=e._payload,e=e._init;try{return gd(e(t))}catch{}}return null}function e4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gd(t);case 8:return t===Pf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $s(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function eg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function t4(e){var t=eg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Za(e){e._valueTracker||(e._valueTracker=t4(e))}function tg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=eg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Fl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function yd(e,t){var n=t.checked;return Tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function um(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=$s(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ng(e,t){t=t.checked,t!=null&&Tf(e,"checked",t,!1)}function vd(e,t){ng(e,t);var n=$s(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wd(e,t.type,n):t.hasOwnProperty("defaultValue")&&wd(e,t.type,$s(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function cm(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function wd(e,t,n){(t!=="number"||Fl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ko=Array.isArray;function Wi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$s(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function xd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function dm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ae(92));if(Ko(n)){if(1<n.length)throw Error(ae(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:$s(n)}}function rg(e,t){var n=$s(t.value),r=$s(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function fm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var el,ig=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(el=el||document.createElement("div"),el.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=el.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function pa(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ea={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},n4=["Webkit","ms","Moz","O"];Object.keys(ea).forEach(function(e){n4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ea[t]=ea[e]})});function og(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ea.hasOwnProperty(e)&&ea[e]?(""+t).trim():t+"px"}function ag(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=og(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var r4=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kd(e,t){if(t){if(r4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ae(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ae(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ae(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ae(62))}}function Ad(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ed=null;function Lf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cd=null,Vi=null,Yi=null;function hm(e){if(e=Fa(e)){if(typeof Cd!="function")throw Error(ae(280));var t=e.stateNode;t&&(t=_u(t),Cd(e.stateNode,e.type,t))}}function lg(e){Vi?Yi?Yi.push(e):Yi=[e]:Vi=e}function ug(){if(Vi){var e=Vi,t=Yi;if(Yi=Vi=null,hm(e),t)for(e=0;e<t.length;e++)hm(t[e])}}function cg(e,t){return e(t)}function dg(){}var Ac=!1;function fg(e,t,n){if(Ac)return e(t,n);Ac=!0;try{return cg(e,t,n)}finally{Ac=!1,(Vi!==null||Yi!==null)&&(dg(),ug())}}function ma(e,t){var n=e.stateNode;if(n===null)return null;var r=_u(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ae(231,t,typeof n));return n}var _d=!1;if(ls)try{var Oo={};Object.defineProperty(Oo,"passive",{get:function(){_d=!0}}),window.addEventListener("test",Oo,Oo),window.removeEventListener("test",Oo,Oo)}catch{_d=!1}function s4(e,t,n,r,s,i,a,u,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(m){this.onError(m)}}var ta=!1,Ol=null,$l=!1,jd=null,i4={onError:function(e){ta=!0,Ol=e}};function o4(e,t,n,r,s,i,a,u,d){ta=!1,Ol=null,s4.apply(i4,arguments)}function a4(e,t,n,r,s,i,a,u,d){if(o4.apply(this,arguments),ta){if(ta){var h=Ol;ta=!1,Ol=null}else throw Error(ae(198));$l||($l=!0,jd=h)}}function wi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pm(e){if(wi(e)!==e)throw Error(ae(188))}function l4(e){var t=e.alternate;if(!t){if(t=wi(e),t===null)throw Error(ae(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return pm(s),e;if(i===r)return pm(s),t;i=i.sibling}throw Error(ae(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,u=s.child;u;){if(u===n){a=!0,n=s,r=i;break}if(u===r){a=!0,r=s,n=i;break}u=u.sibling}if(!a){for(u=i.child;u;){if(u===n){a=!0,n=i,r=s;break}if(u===r){a=!0,r=i,n=s;break}u=u.sibling}if(!a)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?e:t}function pg(e){return e=l4(e),e!==null?mg(e):null}function mg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mg(e);if(t!==null)return t;e=e.sibling}return null}var gg=Kn.unstable_scheduleCallback,mm=Kn.unstable_cancelCallback,u4=Kn.unstable_shouldYield,c4=Kn.unstable_requestPaint,$t=Kn.unstable_now,d4=Kn.unstable_getCurrentPriorityLevel,Bf=Kn.unstable_ImmediatePriority,yg=Kn.unstable_UserBlockingPriority,Dl=Kn.unstable_NormalPriority,f4=Kn.unstable_LowPriority,vg=Kn.unstable_IdlePriority,ku=null,Vr=null;function h4(e){if(Vr&&typeof Vr.onCommitFiberRoot=="function")try{Vr.onCommitFiberRoot(ku,e,void 0,(e.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:g4,p4=Math.log,m4=Math.LN2;function g4(e){return e>>>=0,e===0?32:31-(p4(e)/m4|0)|0}var tl=64,nl=4194304;function Qo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function zl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var u=a&~s;u!==0?r=Qo(u):(i&=a,i!==0&&(r=Qo(i)))}else a=n&~s,a!==0?r=Qo(a):i!==0&&(r=Qo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Nr(t),s=1<<n,r|=e[n],t&=~s;return r}function y4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Nr(i),u=1<<a,d=s[a];d===-1?(!(u&n)||u&r)&&(s[a]=y4(u,t)):d<=t&&(e.expiredLanes|=u),i&=~u}}function Nd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wg(){var e=tl;return tl<<=1,!(tl&4194240)&&(tl=64),e}function Ec(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function La(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nr(t),e[t]=n}function w4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Nr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Ff(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Nr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function xg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Sg,Of,kg,Ag,Eg,bd=!1,rl=[],bs=null,Ms=null,Ts=null,ga=new Map,ya=new Map,As=[],x4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gm(e,t){switch(e){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":Ms=null;break;case"mouseover":case"mouseout":Ts=null;break;case"pointerover":case"pointerout":ga.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ya.delete(t.pointerId)}}function $o(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Fa(t),t!==null&&Of(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function S4(e,t,n,r,s){switch(t){case"focusin":return bs=$o(bs,e,t,n,r,s),!0;case"dragenter":return Ms=$o(Ms,e,t,n,r,s),!0;case"mouseover":return Ts=$o(Ts,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return ga.set(i,$o(ga.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ya.set(i,$o(ya.get(i)||null,e,t,n,r,s)),!0}return!1}function Cg(e){var t=ri(e.target);if(t!==null){var n=wi(t);if(n!==null){if(t=n.tag,t===13){if(t=hg(n),t!==null){e.blockedOn=t,Eg(e.priority,function(){kg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Sl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Md(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ed=r,n.target.dispatchEvent(r),Ed=null}else return t=Fa(n),t!==null&&Of(t),e.blockedOn=n,!1;t.shift()}return!0}function ym(e,t,n){Sl(e)&&n.delete(t)}function k4(){bd=!1,bs!==null&&Sl(bs)&&(bs=null),Ms!==null&&Sl(Ms)&&(Ms=null),Ts!==null&&Sl(Ts)&&(Ts=null),ga.forEach(ym),ya.forEach(ym)}function Do(e,t){e.blockedOn===t&&(e.blockedOn=null,bd||(bd=!0,Kn.unstable_scheduleCallback(Kn.unstable_NormalPriority,k4)))}function va(e){function t(s){return Do(s,e)}if(0<rl.length){Do(rl[0],e);for(var n=1;n<rl.length;n++){var r=rl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(bs!==null&&Do(bs,e),Ms!==null&&Do(Ms,e),Ts!==null&&Do(Ts,e),ga.forEach(t),ya.forEach(t),n=0;n<As.length;n++)r=As[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<As.length&&(n=As[0],n.blockedOn===null);)Cg(n),n.blockedOn===null&&As.shift()}var Xi=ps.ReactCurrentBatchConfig,Ul=!0;function A4(e,t,n,r){var s=at,i=Xi.transition;Xi.transition=null;try{at=1,$f(e,t,n,r)}finally{at=s,Xi.transition=i}}function E4(e,t,n,r){var s=at,i=Xi.transition;Xi.transition=null;try{at=4,$f(e,t,n,r)}finally{at=s,Xi.transition=i}}function $f(e,t,n,r){if(Ul){var s=Md(e,t,n,r);if(s===null)Rc(e,t,r,Hl,n),gm(e,r);else if(S4(s,e,t,n,r))r.stopPropagation();else if(gm(e,r),t&4&&-1<x4.indexOf(e)){for(;s!==null;){var i=Fa(s);if(i!==null&&Sg(i),i=Md(e,t,n,r),i===null&&Rc(e,t,r,Hl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Rc(e,t,r,null,n)}}var Hl=null;function Md(e,t,n,r){if(Hl=null,e=Lf(r),e=ri(e),e!==null)if(t=wi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Hl=e,null}function _g(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(d4()){case Bf:return 1;case yg:return 4;case Dl:case f4:return 16;case vg:return 536870912;default:return 16}default:return 16}}var js=null,Df=null,kl=null;function jg(){if(kl)return kl;var e,t=Df,n=t.length,r,s="value"in js?js.value:js.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return kl=s.slice(e,1<r?1-r:void 0)}function Al(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sl(){return!0}function vm(){return!1}function qn(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(i):i[u]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sl:vm,this.isPropagationStopped=vm,this}return Tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=sl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=sl)},persist:function(){},isPersistent:sl}),t}var ko={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zf=qn(ko),Ba=Tt({},ko,{view:0,detail:0}),C4=qn(Ba),Cc,_c,zo,Au=Tt({},Ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==zo&&(zo&&e.type==="mousemove"?(Cc=e.screenX-zo.screenX,_c=e.screenY-zo.screenY):_c=Cc=0,zo=e),Cc)},movementY:function(e){return"movementY"in e?e.movementY:_c}}),wm=qn(Au),_4=Tt({},Au,{dataTransfer:0}),j4=qn(_4),N4=Tt({},Ba,{relatedTarget:0}),jc=qn(N4),b4=Tt({},ko,{animationName:0,elapsedTime:0,pseudoElement:0}),M4=qn(b4),T4=Tt({},ko,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),P4=qn(T4),I4=Tt({},ko,{data:0}),xm=qn(I4),R4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=B4[e])?!!t[e]:!1}function Uf(){return F4}var O4=Tt({},Ba,{key:function(e){if(e.key){var t=R4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Al(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?L4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uf,charCode:function(e){return e.type==="keypress"?Al(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Al(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$4=qn(O4),D4=Tt({},Au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sm=qn(D4),z4=Tt({},Ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uf}),U4=qn(z4),H4=Tt({},ko,{propertyName:0,elapsedTime:0,pseudoElement:0}),G4=qn(H4),W4=Tt({},Au,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),V4=qn(W4),Y4=[9,13,27,32],Hf=ls&&"CompositionEvent"in window,na=null;ls&&"documentMode"in document&&(na=document.documentMode);var X4=ls&&"TextEvent"in window&&!na,Ng=ls&&(!Hf||na&&8<na&&11>=na),km=" ",Am=!1;function bg(e,t){switch(e){case"keyup":return Y4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ri=!1;function K4(e,t){switch(e){case"compositionend":return Mg(t);case"keypress":return t.which!==32?null:(Am=!0,km);case"textInput":return e=t.data,e===km&&Am?null:e;default:return null}}function Q4(e,t){if(Ri)return e==="compositionend"||!Hf&&bg(e,t)?(e=jg(),kl=Df=js=null,Ri=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ng&&t.locale!=="ko"?null:t.data;default:return null}}var J4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Em(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!J4[e.type]:t==="textarea"}function Tg(e,t,n,r){lg(r),t=Gl(t,"onChange"),0<t.length&&(n=new zf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ra=null,wa=null;function q4(e){Ug(e,0)}function Eu(e){var t=Fi(e);if(tg(t))return e}function Z4(e,t){if(e==="change")return t}var Pg=!1;if(ls){var Nc;if(ls){var bc="oninput"in document;if(!bc){var Cm=document.createElement("div");Cm.setAttribute("oninput","return;"),bc=typeof Cm.oninput=="function"}Nc=bc}else Nc=!1;Pg=Nc&&(!document.documentMode||9<document.documentMode)}function _m(){ra&&(ra.detachEvent("onpropertychange",Ig),wa=ra=null)}function Ig(e){if(e.propertyName==="value"&&Eu(wa)){var t=[];Tg(t,wa,e,Lf(e)),fg(q4,t)}}function ew(e,t,n){e==="focusin"?(_m(),ra=t,wa=n,ra.attachEvent("onpropertychange",Ig)):e==="focusout"&&_m()}function tw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Eu(wa)}function nw(e,t){if(e==="click")return Eu(t)}function rw(e,t){if(e==="input"||e==="change")return Eu(t)}function sw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mr=typeof Object.is=="function"?Object.is:sw;function xa(e,t){if(Mr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!fd.call(t,s)||!Mr(e[s],t[s]))return!1}return!0}function jm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Nm(e,t){var n=jm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jm(n)}}function Rg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Lg(){for(var e=window,t=Fl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Fl(e.document)}return t}function Gf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function iw(e){var t=Lg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Rg(n.ownerDocument.documentElement,n)){if(r!==null&&Gf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Nm(n,i);var a=Nm(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ow=ls&&"documentMode"in document&&11>=document.documentMode,Li=null,Td=null,sa=null,Pd=!1;function bm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Pd||Li==null||Li!==Fl(r)||(r=Li,"selectionStart"in r&&Gf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),sa&&xa(sa,r)||(sa=r,r=Gl(Td,"onSelect"),0<r.length&&(t=new zf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Li)))}function il(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Bi={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionend:il("Transition","TransitionEnd")},Mc={},Bg={};ls&&(Bg=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function Cu(e){if(Mc[e])return Mc[e];if(!Bi[e])return e;var t=Bi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Bg)return Mc[e]=t[n];return e}var Fg=Cu("animationend"),Og=Cu("animationiteration"),$g=Cu("animationstart"),Dg=Cu("transitionend"),zg=new Map,Mm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hs(e,t){zg.set(e,t),vi(t,[e])}for(var Tc=0;Tc<Mm.length;Tc++){var Pc=Mm[Tc],aw=Pc.toLowerCase(),lw=Pc[0].toUpperCase()+Pc.slice(1);Hs(aw,"on"+lw)}Hs(Fg,"onAnimationEnd");Hs(Og,"onAnimationIteration");Hs($g,"onAnimationStart");Hs("dblclick","onDoubleClick");Hs("focusin","onFocus");Hs("focusout","onBlur");Hs(Dg,"onTransitionEnd");ro("onMouseEnter",["mouseout","mouseover"]);ro("onMouseLeave",["mouseout","mouseover"]);ro("onPointerEnter",["pointerout","pointerover"]);ro("onPointerLeave",["pointerout","pointerover"]);vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jo));function Tm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,a4(r,t,void 0,e),e.currentTarget=null}function Ug(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var u=r[a],d=u.instance,h=u.currentTarget;if(u=u.listener,d!==i&&s.isPropagationStopped())break e;Tm(s,u,h),i=d}else for(a=0;a<r.length;a++){if(u=r[a],d=u.instance,h=u.currentTarget,u=u.listener,d!==i&&s.isPropagationStopped())break e;Tm(s,u,h),i=d}}}if($l)throw e=jd,$l=!1,jd=null,e}function vt(e,t){var n=t[Fd];n===void 0&&(n=t[Fd]=new Set);var r=e+"__bubble";n.has(r)||(Hg(t,e,2,!1),n.add(r))}function Ic(e,t,n){var r=0;t&&(r|=4),Hg(n,e,r,t)}var ol="_reactListening"+Math.random().toString(36).slice(2);function Sa(e){if(!e[ol]){e[ol]=!0,Q0.forEach(function(n){n!=="selectionchange"&&(uw.has(n)||Ic(n,!1,e),Ic(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ol]||(t[ol]=!0,Ic("selectionchange",!1,t))}}function Hg(e,t,n,r){switch(_g(t)){case 1:var s=A4;break;case 4:s=E4;break;default:s=$f}n=s.bind(null,t,n,e),s=void 0,!_d||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Rc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;u!==null;){if(a=ri(u),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}u=u.parentNode}}r=r.return}fg(function(){var h=i,m=Lf(n),w=[];e:{var S=zg.get(e);if(S!==void 0){var _=zf,L=e;switch(e){case"keypress":if(Al(n)===0)break e;case"keydown":case"keyup":_=$4;break;case"focusin":L="focus",_=jc;break;case"focusout":L="blur",_=jc;break;case"beforeblur":case"afterblur":_=jc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=j4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=U4;break;case Fg:case Og:case $g:_=M4;break;case Dg:_=G4;break;case"scroll":_=C4;break;case"wheel":_=V4;break;case"copy":case"cut":case"paste":_=P4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Sm}var F=(t&4)!==0,X=!F&&e==="scroll",C=F?S!==null?S+"Capture":null:S;F=[];for(var g=h,v;g!==null;){v=g;var E=v.stateNode;if(v.tag===5&&E!==null&&(v=E,C!==null&&(E=ma(g,C),E!=null&&F.push(ka(g,E,v)))),X)break;g=g.return}0<F.length&&(S=new _(S,L,null,n,m),w.push({event:S,listeners:F}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",S&&n!==Ed&&(L=n.relatedTarget||n.fromElement)&&(ri(L)||L[us]))break e;if((_||S)&&(S=m.window===m?m:(S=m.ownerDocument)?S.defaultView||S.parentWindow:window,_?(L=n.relatedTarget||n.toElement,_=h,L=L?ri(L):null,L!==null&&(X=wi(L),L!==X||L.tag!==5&&L.tag!==6)&&(L=null)):(_=null,L=h),_!==L)){if(F=wm,E="onMouseLeave",C="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(F=Sm,E="onPointerLeave",C="onPointerEnter",g="pointer"),X=_==null?S:Fi(_),v=L==null?S:Fi(L),S=new F(E,g+"leave",_,n,m),S.target=X,S.relatedTarget=v,E=null,ri(m)===h&&(F=new F(C,g+"enter",L,n,m),F.target=v,F.relatedTarget=X,E=F),X=E,_&&L)t:{for(F=_,C=L,g=0,v=F;v;v=ji(v))g++;for(v=0,E=C;E;E=ji(E))v++;for(;0<g-v;)F=ji(F),g--;for(;0<v-g;)C=ji(C),v--;for(;g--;){if(F===C||C!==null&&F===C.alternate)break t;F=ji(F),C=ji(C)}F=null}else F=null;_!==null&&Pm(w,S,_,F,!1),L!==null&&X!==null&&Pm(w,X,L,F,!0)}}e:{if(S=h?Fi(h):window,_=S.nodeName&&S.nodeName.toLowerCase(),_==="select"||_==="input"&&S.type==="file")var N=Z4;else if(Em(S))if(Pg)N=rw;else{N=tw;var T=ew}else(_=S.nodeName)&&_.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(N=nw);if(N&&(N=N(e,h))){Tg(w,N,n,m);break e}T&&T(e,S,h),e==="focusout"&&(T=S._wrapperState)&&T.controlled&&S.type==="number"&&wd(S,"number",S.value)}switch(T=h?Fi(h):window,e){case"focusin":(Em(T)||T.contentEditable==="true")&&(Li=T,Td=h,sa=null);break;case"focusout":sa=Td=Li=null;break;case"mousedown":Pd=!0;break;case"contextmenu":case"mouseup":case"dragend":Pd=!1,bm(w,n,m);break;case"selectionchange":if(ow)break;case"keydown":case"keyup":bm(w,n,m)}var $;if(Hf)e:{switch(e){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else Ri?bg(e,n)&&(H="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(H="onCompositionStart");H&&(Ng&&n.locale!=="ko"&&(Ri||H!=="onCompositionStart"?H==="onCompositionEnd"&&Ri&&($=jg()):(js=m,Df="value"in js?js.value:js.textContent,Ri=!0)),T=Gl(h,H),0<T.length&&(H=new xm(H,e,null,n,m),w.push({event:H,listeners:T}),$?H.data=$:($=Mg(n),$!==null&&(H.data=$)))),($=X4?K4(e,n):Q4(e,n))&&(h=Gl(h,"onBeforeInput"),0<h.length&&(m=new xm("onBeforeInput","beforeinput",null,n,m),w.push({event:m,listeners:h}),m.data=$))}Ug(w,t)})}function ka(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ma(e,n),i!=null&&r.unshift(ka(e,i,s)),i=ma(e,t),i!=null&&r.push(ka(e,i,s))),e=e.return}return r}function ji(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Pm(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var u=n,d=u.alternate,h=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&h!==null&&(u=h,s?(d=ma(n,i),d!=null&&a.unshift(ka(n,d,u))):s||(d=ma(n,i),d!=null&&a.push(ka(n,d,u)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var cw=/\r\n?/g,dw=/\u0000|\uFFFD/g;function Im(e){return(typeof e=="string"?e:""+e).replace(cw,`
`).replace(dw,"")}function al(e,t,n){if(t=Im(t),Im(e)!==t&&n)throw Error(ae(425))}function Wl(){}var Id=null,Rd=null;function Ld(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bd=typeof setTimeout=="function"?setTimeout:void 0,fw=typeof clearTimeout=="function"?clearTimeout:void 0,Rm=typeof Promise=="function"?Promise:void 0,hw=typeof queueMicrotask=="function"?queueMicrotask:typeof Rm<"u"?function(e){return Rm.resolve(null).then(e).catch(pw)}:Bd;function pw(e){setTimeout(function(){throw e})}function Lc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),va(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);va(t)}function Ps(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Lm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ao=Math.random().toString(36).slice(2),Wr="__reactFiber$"+Ao,Aa="__reactProps$"+Ao,us="__reactContainer$"+Ao,Fd="__reactEvents$"+Ao,mw="__reactListeners$"+Ao,gw="__reactHandles$"+Ao;function ri(e){var t=e[Wr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[us]||n[Wr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Lm(e);e!==null;){if(n=e[Wr])return n;e=Lm(e)}return t}e=n,n=e.parentNode}return null}function Fa(e){return e=e[Wr]||e[us],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Fi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ae(33))}function _u(e){return e[Aa]||null}var Od=[],Oi=-1;function Gs(e){return{current:e}}function wt(e){0>Oi||(e.current=Od[Oi],Od[Oi]=null,Oi--)}function mt(e,t){Oi++,Od[Oi]=e.current,e.current=t}var Ds={},pn=Gs(Ds),Mn=Gs(!1),di=Ds;function so(e,t){var n=e.type.contextTypes;if(!n)return Ds;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Tn(e){return e=e.childContextTypes,e!=null}function Vl(){wt(Mn),wt(pn)}function Bm(e,t,n){if(pn.current!==Ds)throw Error(ae(168));mt(pn,t),mt(Mn,n)}function Gg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(ae(108,e4(e)||"Unknown",s));return Tt({},n,r)}function Yl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ds,di=pn.current,mt(pn,e),mt(Mn,Mn.current),!0}function Fm(e,t,n){var r=e.stateNode;if(!r)throw Error(ae(169));n?(e=Gg(e,t,di),r.__reactInternalMemoizedMergedChildContext=e,wt(Mn),wt(pn),mt(pn,e)):wt(Mn),mt(Mn,n)}var qr=null,ju=!1,Bc=!1;function Wg(e){qr===null?qr=[e]:qr.push(e)}function yw(e){ju=!0,Wg(e)}function Ws(){if(!Bc&&qr!==null){Bc=!0;var e=0,t=at;try{var n=qr;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}qr=null,ju=!1}catch(s){throw qr!==null&&(qr=qr.slice(e+1)),gg(Bf,Ws),s}finally{at=t,Bc=!1}}return null}var $i=[],Di=0,Xl=null,Kl=0,ur=[],cr=0,fi=null,ts=1,ns="";function ti(e,t){$i[Di++]=Kl,$i[Di++]=Xl,Xl=e,Kl=t}function Vg(e,t,n){ur[cr++]=ts,ur[cr++]=ns,ur[cr++]=fi,fi=e;var r=ts;e=ns;var s=32-Nr(r)-1;r&=~(1<<s),n+=1;var i=32-Nr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ts=1<<32-Nr(t)+s|n<<s|r,ns=i+e}else ts=1<<i|n<<s|r,ns=e}function Wf(e){e.return!==null&&(ti(e,1),Vg(e,1,0))}function Vf(e){for(;e===Xl;)Xl=$i[--Di],$i[Di]=null,Kl=$i[--Di],$i[Di]=null;for(;e===fi;)fi=ur[--cr],ur[cr]=null,ns=ur[--cr],ur[cr]=null,ts=ur[--cr],ur[cr]=null}var Xn=null,Yn=null,At=!1,_r=null;function Yg(e,t){var n=fr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Om(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xn=e,Yn=Ps(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xn=e,Yn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=fi!==null?{id:ts,overflow:ns}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=fr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Xn=e,Yn=null,!0):!1;default:return!1}}function $d(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Dd(e){if(At){var t=Yn;if(t){var n=t;if(!Om(e,t)){if($d(e))throw Error(ae(418));t=Ps(n.nextSibling);var r=Xn;t&&Om(e,t)?Yg(r,n):(e.flags=e.flags&-4097|2,At=!1,Xn=e)}}else{if($d(e))throw Error(ae(418));e.flags=e.flags&-4097|2,At=!1,Xn=e}}}function $m(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xn=e}function ll(e){if(e!==Xn)return!1;if(!At)return $m(e),At=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ld(e.type,e.memoizedProps)),t&&(t=Yn)){if($d(e))throw Xg(),Error(ae(418));for(;t;)Yg(e,t),t=Ps(t.nextSibling)}if($m(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ae(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Yn=Ps(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Yn=null}}else Yn=Xn?Ps(e.stateNode.nextSibling):null;return!0}function Xg(){for(var e=Yn;e;)e=Ps(e.nextSibling)}function io(){Yn=Xn=null,At=!1}function Yf(e){_r===null?_r=[e]:_r.push(e)}var vw=ps.ReactCurrentBatchConfig;function Uo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var u=s.refs;a===null?delete u[i]:u[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,e))}return e}function ul(e,t){throw e=Object.prototype.toString.call(t),Error(ae(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Dm(e){var t=e._init;return t(e._payload)}function Kg(e){function t(C,g){if(e){var v=C.deletions;v===null?(C.deletions=[g],C.flags|=16):v.push(g)}}function n(C,g){if(!e)return null;for(;g!==null;)t(C,g),g=g.sibling;return null}function r(C,g){for(C=new Map;g!==null;)g.key!==null?C.set(g.key,g):C.set(g.index,g),g=g.sibling;return C}function s(C,g){return C=Bs(C,g),C.index=0,C.sibling=null,C}function i(C,g,v){return C.index=v,e?(v=C.alternate,v!==null?(v=v.index,v<g?(C.flags|=2,g):v):(C.flags|=2,g)):(C.flags|=1048576,g)}function a(C){return e&&C.alternate===null&&(C.flags|=2),C}function u(C,g,v,E){return g===null||g.tag!==6?(g=Hc(v,C.mode,E),g.return=C,g):(g=s(g,v),g.return=C,g)}function d(C,g,v,E){var N=v.type;return N===Ii?m(C,g,v.props.children,E,v.key):g!==null&&(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===xs&&Dm(N)===g.type)?(E=s(g,v.props),E.ref=Uo(C,g,v),E.return=C,E):(E=Ml(v.type,v.key,v.props,null,C.mode,E),E.ref=Uo(C,g,v),E.return=C,E)}function h(C,g,v,E){return g===null||g.tag!==4||g.stateNode.containerInfo!==v.containerInfo||g.stateNode.implementation!==v.implementation?(g=Gc(v,C.mode,E),g.return=C,g):(g=s(g,v.children||[]),g.return=C,g)}function m(C,g,v,E,N){return g===null||g.tag!==7?(g=ui(v,C.mode,E,N),g.return=C,g):(g=s(g,v),g.return=C,g)}function w(C,g,v){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Hc(""+g,C.mode,v),g.return=C,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case qa:return v=Ml(g.type,g.key,g.props,null,C.mode,v),v.ref=Uo(C,null,g),v.return=C,v;case Pi:return g=Gc(g,C.mode,v),g.return=C,g;case xs:var E=g._init;return w(C,E(g._payload),v)}if(Ko(g)||Fo(g))return g=ui(g,C.mode,v,null),g.return=C,g;ul(C,g)}return null}function S(C,g,v,E){var N=g!==null?g.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return N!==null?null:u(C,g,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case qa:return v.key===N?d(C,g,v,E):null;case Pi:return v.key===N?h(C,g,v,E):null;case xs:return N=v._init,S(C,g,N(v._payload),E)}if(Ko(v)||Fo(v))return N!==null?null:m(C,g,v,E,null);ul(C,v)}return null}function _(C,g,v,E,N){if(typeof E=="string"&&E!==""||typeof E=="number")return C=C.get(v)||null,u(g,C,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case qa:return C=C.get(E.key===null?v:E.key)||null,d(g,C,E,N);case Pi:return C=C.get(E.key===null?v:E.key)||null,h(g,C,E,N);case xs:var T=E._init;return _(C,g,v,T(E._payload),N)}if(Ko(E)||Fo(E))return C=C.get(v)||null,m(g,C,E,N,null);ul(g,E)}return null}function L(C,g,v,E){for(var N=null,T=null,$=g,H=g=0,q=null;$!==null&&H<v.length;H++){$.index>H?(q=$,$=null):q=$.sibling;var V=S(C,$,v[H],E);if(V===null){$===null&&($=q);break}e&&$&&V.alternate===null&&t(C,$),g=i(V,g,H),T===null?N=V:T.sibling=V,T=V,$=q}if(H===v.length)return n(C,$),At&&ti(C,H),N;if($===null){for(;H<v.length;H++)$=w(C,v[H],E),$!==null&&(g=i($,g,H),T===null?N=$:T.sibling=$,T=$);return At&&ti(C,H),N}for($=r(C,$);H<v.length;H++)q=_($,C,H,v[H],E),q!==null&&(e&&q.alternate!==null&&$.delete(q.key===null?H:q.key),g=i(q,g,H),T===null?N=q:T.sibling=q,T=q);return e&&$.forEach(function(K){return t(C,K)}),At&&ti(C,H),N}function F(C,g,v,E){var N=Fo(v);if(typeof N!="function")throw Error(ae(150));if(v=N.call(v),v==null)throw Error(ae(151));for(var T=N=null,$=g,H=g=0,q=null,V=v.next();$!==null&&!V.done;H++,V=v.next()){$.index>H?(q=$,$=null):q=$.sibling;var K=S(C,$,V.value,E);if(K===null){$===null&&($=q);break}e&&$&&K.alternate===null&&t(C,$),g=i(K,g,H),T===null?N=K:T.sibling=K,T=K,$=q}if(V.done)return n(C,$),At&&ti(C,H),N;if($===null){for(;!V.done;H++,V=v.next())V=w(C,V.value,E),V!==null&&(g=i(V,g,H),T===null?N=V:T.sibling=V,T=V);return At&&ti(C,H),N}for($=r(C,$);!V.done;H++,V=v.next())V=_($,C,H,V.value,E),V!==null&&(e&&V.alternate!==null&&$.delete(V.key===null?H:V.key),g=i(V,g,H),T===null?N=V:T.sibling=V,T=V);return e&&$.forEach(function(ne){return t(C,ne)}),At&&ti(C,H),N}function X(C,g,v,E){if(typeof v=="object"&&v!==null&&v.type===Ii&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case qa:e:{for(var N=v.key,T=g;T!==null;){if(T.key===N){if(N=v.type,N===Ii){if(T.tag===7){n(C,T.sibling),g=s(T,v.props.children),g.return=C,C=g;break e}}else if(T.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===xs&&Dm(N)===T.type){n(C,T.sibling),g=s(T,v.props),g.ref=Uo(C,T,v),g.return=C,C=g;break e}n(C,T);break}else t(C,T);T=T.sibling}v.type===Ii?(g=ui(v.props.children,C.mode,E,v.key),g.return=C,C=g):(E=Ml(v.type,v.key,v.props,null,C.mode,E),E.ref=Uo(C,g,v),E.return=C,C=E)}return a(C);case Pi:e:{for(T=v.key;g!==null;){if(g.key===T)if(g.tag===4&&g.stateNode.containerInfo===v.containerInfo&&g.stateNode.implementation===v.implementation){n(C,g.sibling),g=s(g,v.children||[]),g.return=C,C=g;break e}else{n(C,g);break}else t(C,g);g=g.sibling}g=Gc(v,C.mode,E),g.return=C,C=g}return a(C);case xs:return T=v._init,X(C,g,T(v._payload),E)}if(Ko(v))return L(C,g,v,E);if(Fo(v))return F(C,g,v,E);ul(C,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,g!==null&&g.tag===6?(n(C,g.sibling),g=s(g,v),g.return=C,C=g):(n(C,g),g=Hc(v,C.mode,E),g.return=C,C=g),a(C)):n(C,g)}return X}var oo=Kg(!0),Qg=Kg(!1),Ql=Gs(null),Jl=null,zi=null,Xf=null;function Kf(){Xf=zi=Jl=null}function Qf(e){var t=Ql.current;wt(Ql),e._currentValue=t}function zd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ki(e,t){Jl=e,Xf=zi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(bn=!0),e.firstContext=null)}function mr(e){var t=e._currentValue;if(Xf!==e)if(e={context:e,memoizedValue:t,next:null},zi===null){if(Jl===null)throw Error(ae(308));zi=e,Jl.dependencies={lanes:0,firstContext:e}}else zi=zi.next=e;return t}var si=null;function Jf(e){si===null?si=[e]:si.push(e)}function Jg(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Jf(t)):(n.next=s.next,s.next=n),t.interleaved=n,cs(e,r)}function cs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ss=!1;function qf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ss(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Is(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ze&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,cs(e,n)}return s=r.interleaved,s===null?(t.next=t,Jf(r)):(t.next=s.next,s.next=t),r.interleaved=t,cs(e,n)}function El(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ff(e,n)}}function zm(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ql(e,t,n,r){var s=e.updateQueue;Ss=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var d=u,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var m=e.alternate;m!==null&&(m=m.updateQueue,u=m.lastBaseUpdate,u!==a&&(u===null?m.firstBaseUpdate=h:u.next=h,m.lastBaseUpdate=d))}if(i!==null){var w=s.baseState;a=0,m=h=d=null,u=i;do{var S=u.lane,_=u.eventTime;if((r&S)===S){m!==null&&(m=m.next={eventTime:_,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var L=e,F=u;switch(S=t,_=n,F.tag){case 1:if(L=F.payload,typeof L=="function"){w=L.call(_,w,S);break e}w=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=F.payload,S=typeof L=="function"?L.call(_,w,S):L,S==null)break e;w=Tt({},w,S);break e;case 2:Ss=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,S=s.effects,S===null?s.effects=[u]:S.push(u))}else _={eventTime:_,lane:S,tag:u.tag,payload:u.payload,callback:u.callback,next:null},m===null?(h=m=_,d=w):m=m.next=_,a|=S;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;S=u,u=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(!0);if(m===null&&(d=w),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);pi|=a,e.lanes=a,e.memoizedState=w}}function Um(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ae(191,s));s.call(r)}}}var Oa={},Yr=Gs(Oa),Ea=Gs(Oa),Ca=Gs(Oa);function ii(e){if(e===Oa)throw Error(ae(174));return e}function Zf(e,t){switch(mt(Ca,t),mt(Ea,e),mt(Yr,Oa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Sd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Sd(t,e)}wt(Yr),mt(Yr,t)}function ao(){wt(Yr),wt(Ea),wt(Ca)}function Zg(e){ii(Ca.current);var t=ii(Yr.current),n=Sd(t,e.type);t!==n&&(mt(Ea,e),mt(Yr,n))}function eh(e){Ea.current===e&&(wt(Yr),wt(Ea))}var Nt=Gs(0);function Zl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fc=[];function th(){for(var e=0;e<Fc.length;e++)Fc[e]._workInProgressVersionPrimary=null;Fc.length=0}var Cl=ps.ReactCurrentDispatcher,Oc=ps.ReactCurrentBatchConfig,hi=0,bt=null,Vt=null,qt=null,eu=!1,ia=!1,_a=0,ww=0;function un(){throw Error(ae(321))}function nh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Mr(e[n],t[n]))return!1;return!0}function rh(e,t,n,r,s,i){if(hi=i,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Cl.current=e===null||e.memoizedState===null?Aw:Ew,e=n(r,s),ia){i=0;do{if(ia=!1,_a=0,25<=i)throw Error(ae(301));i+=1,qt=Vt=null,t.updateQueue=null,Cl.current=Cw,e=n(r,s)}while(ia)}if(Cl.current=tu,t=Vt!==null&&Vt.next!==null,hi=0,qt=Vt=bt=null,eu=!1,t)throw Error(ae(300));return e}function sh(){var e=_a!==0;return _a=0,e}function Hr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?bt.memoizedState=qt=e:qt=qt.next=e,qt}function gr(){if(Vt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Vt.next;var t=qt===null?bt.memoizedState:qt.next;if(t!==null)qt=t,Vt=e;else{if(e===null)throw Error(ae(310));Vt=e,e={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},qt===null?bt.memoizedState=qt=e:qt=qt.next=e}return qt}function ja(e,t){return typeof t=="function"?t(e):t}function $c(e){var t=gr(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=Vt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var u=a=null,d=null,h=i;do{var m=h.lane;if((hi&m)===m)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var w={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(u=d=w,a=r):d=d.next=w,bt.lanes|=m,pi|=m}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=u,Mr(r,t.memoizedState)||(bn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,bt.lanes|=i,pi|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Dc(e){var t=gr(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Mr(i,t.memoizedState)||(bn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function e2(){}function t2(e,t){var n=bt,r=gr(),s=t(),i=!Mr(r.memoizedState,s);if(i&&(r.memoizedState=s,bn=!0),r=r.queue,ih(s2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||qt!==null&&qt.memoizedState.tag&1){if(n.flags|=2048,Na(9,r2.bind(null,n,r,s,t),void 0,null),Zt===null)throw Error(ae(349));hi&30||n2(n,t,s)}return s}function n2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function r2(e,t,n,r){t.value=n,t.getSnapshot=r,i2(t)&&o2(e)}function s2(e,t,n){return n(function(){i2(t)&&o2(e)})}function i2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Mr(e,n)}catch{return!0}}function o2(e){var t=cs(e,1);t!==null&&br(t,e,1,-1)}function Hm(e){var t=Hr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:e},t.queue=e,e=e.dispatch=kw.bind(null,bt,e),[t.memoizedState,e]}function Na(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function a2(){return gr().memoizedState}function _l(e,t,n,r){var s=Hr();bt.flags|=e,s.memoizedState=Na(1|t,n,void 0,r===void 0?null:r)}function Nu(e,t,n,r){var s=gr();r=r===void 0?null:r;var i=void 0;if(Vt!==null){var a=Vt.memoizedState;if(i=a.destroy,r!==null&&nh(r,a.deps)){s.memoizedState=Na(t,n,i,r);return}}bt.flags|=e,s.memoizedState=Na(1|t,n,i,r)}function Gm(e,t){return _l(8390656,8,e,t)}function ih(e,t){return Nu(2048,8,e,t)}function l2(e,t){return Nu(4,2,e,t)}function u2(e,t){return Nu(4,4,e,t)}function c2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function d2(e,t,n){return n=n!=null?n.concat([e]):null,Nu(4,4,c2.bind(null,t,e),n)}function oh(){}function f2(e,t){var n=gr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&nh(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function h2(e,t){var n=gr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&nh(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function p2(e,t,n){return hi&21?(Mr(n,t)||(n=wg(),bt.lanes|=n,pi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bn=!0),e.memoizedState=n)}function xw(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=Oc.transition;Oc.transition={};try{e(!1),t()}finally{at=n,Oc.transition=r}}function m2(){return gr().memoizedState}function Sw(e,t,n){var r=Ls(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},g2(e))y2(t,n);else if(n=Jg(e,t,n,r),n!==null){var s=xn();br(n,e,r,s),v2(n,t,r)}}function kw(e,t,n){var r=Ls(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(g2(e))y2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,u=i(a,n);if(s.hasEagerState=!0,s.eagerState=u,Mr(u,a)){var d=t.interleaved;d===null?(s.next=s,Jf(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=Jg(e,t,s,r),n!==null&&(s=xn(),br(n,e,r,s),v2(n,t,r))}}function g2(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function y2(e,t){ia=eu=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function v2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ff(e,n)}}var tu={readContext:mr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},Aw={readContext:mr,useCallback:function(e,t){return Hr().memoizedState=[e,t===void 0?null:t],e},useContext:mr,useEffect:Gm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,_l(4194308,4,c2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _l(4194308,4,e,t)},useInsertionEffect:function(e,t){return _l(4,2,e,t)},useMemo:function(e,t){var n=Hr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Sw.bind(null,bt,e),[r.memoizedState,e]},useRef:function(e){var t=Hr();return e={current:e},t.memoizedState=e},useState:Hm,useDebugValue:oh,useDeferredValue:function(e){return Hr().memoizedState=e},useTransition:function(){var e=Hm(!1),t=e[0];return e=xw.bind(null,e[1]),Hr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=bt,s=Hr();if(At){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=t(),Zt===null)throw Error(ae(349));hi&30||n2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Gm(s2.bind(null,r,i,e),[e]),r.flags|=2048,Na(9,r2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Hr(),t=Zt.identifierPrefix;if(At){var n=ns,r=ts;n=(r&~(1<<32-Nr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=_a++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ww++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ew={readContext:mr,useCallback:f2,useContext:mr,useEffect:ih,useImperativeHandle:d2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:h2,useReducer:$c,useRef:a2,useState:function(){return $c(ja)},useDebugValue:oh,useDeferredValue:function(e){var t=gr();return p2(t,Vt.memoizedState,e)},useTransition:function(){var e=$c(ja)[0],t=gr().memoizedState;return[e,t]},useMutableSource:e2,useSyncExternalStore:t2,useId:m2,unstable_isNewReconciler:!1},Cw={readContext:mr,useCallback:f2,useContext:mr,useEffect:ih,useImperativeHandle:d2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:h2,useReducer:Dc,useRef:a2,useState:function(){return Dc(ja)},useDebugValue:oh,useDeferredValue:function(e){var t=gr();return Vt===null?t.memoizedState=e:p2(t,Vt.memoizedState,e)},useTransition:function(){var e=Dc(ja)[0],t=gr().memoizedState;return[e,t]},useMutableSource:e2,useSyncExternalStore:t2,useId:m2,unstable_isNewReconciler:!1};function Er(e,t){if(e&&e.defaultProps){t=Tt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Ud(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Tt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var bu={isMounted:function(e){return(e=e._reactInternals)?wi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=xn(),s=Ls(e),i=ss(r,s);i.payload=t,n!=null&&(i.callback=n),t=Is(e,i,s),t!==null&&(br(t,e,s,r),El(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=xn(),s=Ls(e),i=ss(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Is(e,i,s),t!==null&&(br(t,e,s,r),El(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=xn(),r=Ls(e),s=ss(n,r);s.tag=2,t!=null&&(s.callback=t),t=Is(e,s,r),t!==null&&(br(t,e,r,n),El(t,e,r))}};function Wm(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!xa(n,r)||!xa(s,i):!0}function w2(e,t,n){var r=!1,s=Ds,i=t.contextType;return typeof i=="object"&&i!==null?i=mr(i):(s=Tn(t)?di:pn.current,r=t.contextTypes,i=(r=r!=null)?so(e,s):Ds),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=bu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Vm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&bu.enqueueReplaceState(t,t.state,null)}function Hd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},qf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=mr(i):(i=Tn(t)?di:pn.current,s.context=so(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Ud(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&bu.enqueueReplaceState(s,s.state,null),ql(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do n+=Z3(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function zc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Gd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _w=typeof WeakMap=="function"?WeakMap:Map;function x2(e,t,n){n=ss(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ru||(ru=!0,ef=r),Gd(e,t)},n}function S2(e,t,n){n=ss(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Gd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Gd(e,t),typeof r!="function"&&(Rs===null?Rs=new Set([this]):Rs.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Ym(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new _w;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Dw.bind(null,e,t,n),t.then(e,e))}function Xm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Km(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ss(-1,1),t.tag=2,Is(n,t,1))),n.lanes|=1),e)}var jw=ps.ReactCurrentOwner,bn=!1;function wn(e,t,n,r){t.child=e===null?Qg(t,null,n,r):oo(t,e.child,n,r)}function Qm(e,t,n,r,s){n=n.render;var i=t.ref;return Ki(t,s),r=rh(e,t,n,r,i,s),n=sh(),e!==null&&!bn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ds(e,t,s)):(At&&n&&Wf(t),t.flags|=1,wn(e,t,r,s),t.child)}function Jm(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!ph(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,k2(e,t,i,r,s)):(e=Ml(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:xa,n(a,r)&&e.ref===t.ref)return ds(e,t,s)}return t.flags|=1,e=Bs(i,r),e.ref=t.ref,e.return=t,t.child=e}function k2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(xa(i,r)&&e.ref===t.ref)if(bn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(bn=!0);else return t.lanes=e.lanes,ds(e,t,s)}return Wd(e,t,n,r,s)}function A2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Hi,Vn),Vn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(Hi,Vn),Vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,mt(Hi,Vn),Vn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,mt(Hi,Vn),Vn|=r;return wn(e,t,s,n),t.child}function E2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Wd(e,t,n,r,s){var i=Tn(n)?di:pn.current;return i=so(t,i),Ki(t,s),n=rh(e,t,n,r,i,s),r=sh(),e!==null&&!bn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ds(e,t,s)):(At&&r&&Wf(t),t.flags|=1,wn(e,t,n,s),t.child)}function qm(e,t,n,r,s){if(Tn(n)){var i=!0;Yl(t)}else i=!1;if(Ki(t,s),t.stateNode===null)jl(e,t),w2(t,n,r),Hd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,u=t.memoizedProps;a.props=u;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=mr(h):(h=Tn(n)?di:pn.current,h=so(t,h));var m=n.getDerivedStateFromProps,w=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||d!==h)&&Vm(t,a,r,h),Ss=!1;var S=t.memoizedState;a.state=S,ql(t,r,a,s),d=t.memoizedState,u!==r||S!==d||Mn.current||Ss?(typeof m=="function"&&(Ud(t,n,m,r),d=t.memoizedState),(u=Ss||Wm(t,n,u,r,S,d,h))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=u):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,qg(e,t),u=t.memoizedProps,h=t.type===t.elementType?u:Er(t.type,u),a.props=h,w=t.pendingProps,S=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=mr(d):(d=Tn(n)?di:pn.current,d=so(t,d));var _=n.getDerivedStateFromProps;(m=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==w||S!==d)&&Vm(t,a,r,d),Ss=!1,S=t.memoizedState,a.state=S,ql(t,r,a,s);var L=t.memoizedState;u!==w||S!==L||Mn.current||Ss?(typeof _=="function"&&(Ud(t,n,_,r),L=t.memoizedState),(h=Ss||Wm(t,n,h,r,S,L,d)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,L,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,L,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),a.props=r,a.state=L,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),r=!1)}return Vd(e,t,n,r,i,s)}function Vd(e,t,n,r,s,i){E2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&Fm(t,n,!1),ds(e,t,i);r=t.stateNode,jw.current=t;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=oo(t,e.child,null,i),t.child=oo(t,null,u,i)):wn(e,t,u,i),t.memoizedState=r.state,s&&Fm(t,n,!0),t.child}function C2(e){var t=e.stateNode;t.pendingContext?Bm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Bm(e,t.context,!1),Zf(e,t.containerInfo)}function Zm(e,t,n,r,s){return io(),Yf(s),t.flags|=256,wn(e,t,n,r),t.child}var Yd={dehydrated:null,treeContext:null,retryLane:0};function Xd(e){return{baseLanes:e,cachePool:null,transitions:null}}function _2(e,t,n){var r=t.pendingProps,s=Nt.current,i=!1,a=(t.flags&128)!==0,u;if((u=a)||(u=e!==null&&e.memoizedState===null?!1:(s&2)!==0),u?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),mt(Nt,s&1),e===null)return Dd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Pu(a,r,0,null),e=ui(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Xd(n),t.memoizedState=Yd,e):ah(t,a));if(s=e.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return Nw(e,t,a,r,u,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,u=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Bs(s,d),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?i=Bs(u,i):(i=ui(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Xd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Yd,r}return i=e.child,e=i.sibling,r=Bs(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function ah(e,t){return t=Pu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cl(e,t,n,r){return r!==null&&Yf(r),oo(t,e.child,null,n),e=ah(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Nw(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=zc(Error(ae(422))),cl(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Pu({mode:"visible",children:r.children},s,0,null),i=ui(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&oo(t,e.child,null,a),t.child.memoizedState=Xd(a),t.memoizedState=Yd,i);if(!(t.mode&1))return cl(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,i=Error(ae(419)),r=zc(i,r,void 0),cl(e,t,a,r)}if(u=(a&e.childLanes)!==0,bn||u){if(r=Zt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,cs(e,s),br(r,e,s,-1))}return hh(),r=zc(Error(ae(421))),cl(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=zw.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Yn=Ps(s.nextSibling),Xn=t,At=!0,_r=null,e!==null&&(ur[cr++]=ts,ur[cr++]=ns,ur[cr++]=fi,ts=e.id,ns=e.overflow,fi=t),t=ah(t,r.children),t.flags|=4096,t)}function e1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),zd(e.return,t,n)}function Uc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function j2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(wn(e,t,r.children,n),r=Nt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&e1(e,n,t);else if(e.tag===19)e1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(mt(Nt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Zl(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Uc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Zl(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Uc(t,!0,n,null,i);break;case"together":Uc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ds(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),pi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ae(153));if(t.child!==null){for(e=t.child,n=Bs(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Bs(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function bw(e,t,n){switch(t.tag){case 3:C2(t),io();break;case 5:Zg(t);break;case 1:Tn(t.type)&&Yl(t);break;case 4:Zf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;mt(Ql,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(mt(Nt,Nt.current&1),t.flags|=128,null):n&t.child.childLanes?_2(e,t,n):(mt(Nt,Nt.current&1),e=ds(e,t,n),e!==null?e.sibling:null);mt(Nt,Nt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return j2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),mt(Nt,Nt.current),r)break;return null;case 22:case 23:return t.lanes=0,A2(e,t,n)}return ds(e,t,n)}var N2,Kd,b2,M2;N2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kd=function(){};b2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ii(Yr.current);var i=null;switch(n){case"input":s=yd(e,s),r=yd(e,r),i=[];break;case"select":s=Tt({},s,{value:void 0}),r=Tt({},r,{value:void 0}),i=[];break;case"textarea":s=xd(e,s),r=xd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Wl)}kd(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var u=s[h];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ha.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(u=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==u&&(d!=null||u!=null))if(h==="style")if(u){for(a in u)!u.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&u[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(ha.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&vt("scroll",e),i||u===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};M2=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ho(e,t){if(!At)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Mw(e,t,n){var r=t.pendingProps;switch(Vf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(t),null;case 1:return Tn(t.type)&&Vl(),cn(t),null;case 3:return r=t.stateNode,ao(),wt(Mn),wt(pn),th(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ll(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_r!==null&&(rf(_r),_r=null))),Kd(e,t),cn(t),null;case 5:eh(t);var s=ii(Ca.current);if(n=t.type,e!==null&&t.stateNode!=null)b2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ae(166));return cn(t),null}if(e=ii(Yr.current),ll(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Wr]=t,r[Aa]=i,e=(t.mode&1)!==0,n){case"dialog":vt("cancel",r),vt("close",r);break;case"iframe":case"object":case"embed":vt("load",r);break;case"video":case"audio":for(s=0;s<Jo.length;s++)vt(Jo[s],r);break;case"source":vt("error",r);break;case"img":case"image":case"link":vt("error",r),vt("load",r);break;case"details":vt("toggle",r);break;case"input":um(r,i),vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},vt("invalid",r);break;case"textarea":dm(r,i),vt("invalid",r)}kd(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var u=i[a];a==="children"?typeof u=="string"?r.textContent!==u&&(i.suppressHydrationWarning!==!0&&al(r.textContent,u,e),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(i.suppressHydrationWarning!==!0&&al(r.textContent,u,e),s=["children",""+u]):ha.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&vt("scroll",r)}switch(n){case"input":Za(r),cm(r,i,!0);break;case"textarea":Za(r),fm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Wl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Wr]=t,e[Aa]=r,N2(e,t,!1,!1),t.stateNode=e;e:{switch(a=Ad(n,r),n){case"dialog":vt("cancel",e),vt("close",e),s=r;break;case"iframe":case"object":case"embed":vt("load",e),s=r;break;case"video":case"audio":for(s=0;s<Jo.length;s++)vt(Jo[s],e);s=r;break;case"source":vt("error",e),s=r;break;case"img":case"image":case"link":vt("error",e),vt("load",e),s=r;break;case"details":vt("toggle",e),s=r;break;case"input":um(e,r),s=yd(e,r),vt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Tt({},r,{value:void 0}),vt("invalid",e);break;case"textarea":dm(e,r),s=xd(e,r),vt("invalid",e);break;default:s=r}kd(n,s),u=s;for(i in u)if(u.hasOwnProperty(i)){var d=u[i];i==="style"?ag(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&ig(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&pa(e,d):typeof d=="number"&&pa(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ha.hasOwnProperty(i)?d!=null&&i==="onScroll"&&vt("scroll",e):d!=null&&Tf(e,i,d,a))}switch(n){case"input":Za(e),cm(e,r,!1);break;case"textarea":Za(e),fm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+$s(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Wi(e,!!r.multiple,i,!1):r.defaultValue!=null&&Wi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Wl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return cn(t),null;case 6:if(e&&t.stateNode!=null)M2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ae(166));if(n=ii(Ca.current),ii(Yr.current),ll(t)){if(r=t.stateNode,n=t.memoizedProps,r[Wr]=t,(i=r.nodeValue!==n)&&(e=Xn,e!==null))switch(e.tag){case 3:al(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&al(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wr]=t,t.stateNode=r}return cn(t),null;case 13:if(wt(Nt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(At&&Yn!==null&&t.mode&1&&!(t.flags&128))Xg(),io(),t.flags|=98560,i=!1;else if(i=ll(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ae(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ae(317));i[Wr]=t}else io(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;cn(t),i=!1}else _r!==null&&(rf(_r),_r=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Nt.current&1?Xt===0&&(Xt=3):hh())),t.updateQueue!==null&&(t.flags|=4),cn(t),null);case 4:return ao(),Kd(e,t),e===null&&Sa(t.stateNode.containerInfo),cn(t),null;case 10:return Qf(t.type._context),cn(t),null;case 17:return Tn(t.type)&&Vl(),cn(t),null;case 19:if(wt(Nt),i=t.memoizedState,i===null)return cn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Ho(i,!1);else{if(Xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Zl(e),a!==null){for(t.flags|=128,Ho(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return mt(Nt,Nt.current&1|2),t.child}e=e.sibling}i.tail!==null&&$t()>uo&&(t.flags|=128,r=!0,Ho(i,!1),t.lanes=4194304)}else{if(!r)if(e=Zl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ho(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!At)return cn(t),null}else 2*$t()-i.renderingStartTime>uo&&n!==1073741824&&(t.flags|=128,r=!0,Ho(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$t(),t.sibling=null,n=Nt.current,mt(Nt,r?n&1|2:n&1),t):(cn(t),null);case 22:case 23:return fh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Vn&1073741824&&(cn(t),t.subtreeFlags&6&&(t.flags|=8192)):cn(t),null;case 24:return null;case 25:return null}throw Error(ae(156,t.tag))}function Tw(e,t){switch(Vf(t),t.tag){case 1:return Tn(t.type)&&Vl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ao(),wt(Mn),wt(pn),th(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return eh(t),null;case 13:if(wt(Nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ae(340));io()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return wt(Nt),null;case 4:return ao(),null;case 10:return Qf(t.type._context),null;case 22:case 23:return fh(),null;case 24:return null;default:return null}}var dl=!1,hn=!1,Pw=typeof WeakSet=="function"?WeakSet:Set,Se=null;function Ui(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Lt(e,t,r)}else n.current=null}function Qd(e,t,n){try{n()}catch(r){Lt(e,t,r)}}var t1=!1;function Iw(e,t){if(Id=Ul,e=Lg(),Gf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,u=-1,d=-1,h=0,m=0,w=e,S=null;t:for(;;){for(var _;w!==n||s!==0&&w.nodeType!==3||(u=a+s),w!==i||r!==0&&w.nodeType!==3||(d=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(_=w.firstChild)!==null;)S=w,w=_;for(;;){if(w===e)break t;if(S===n&&++h===s&&(u=a),S===i&&++m===r&&(d=a),(_=w.nextSibling)!==null)break;w=S,S=w.parentNode}w=_}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Rd={focusedElem:e,selectionRange:n},Ul=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var F=L.memoizedProps,X=L.memoizedState,C=t.stateNode,g=C.getSnapshotBeforeUpdate(t.elementType===t.type?F:Er(t.type,F),X);C.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(E){Lt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return L=t1,t1=!1,L}function oa(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Qd(t,n,i)}s=s.next}while(s!==r)}}function Mu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Jd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function T2(e){var t=e.alternate;t!==null&&(e.alternate=null,T2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Wr],delete t[Aa],delete t[Fd],delete t[mw],delete t[gw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function P2(e){return e.tag===5||e.tag===3||e.tag===4}function n1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||P2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Wl));else if(r!==4&&(e=e.child,e!==null))for(qd(e,t,n),e=e.sibling;e!==null;)qd(e,t,n),e=e.sibling}function Zd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Zd(e,t,n),e=e.sibling;e!==null;)Zd(e,t,n),e=e.sibling}var sn=null,Cr=!1;function vs(e,t,n){for(n=n.child;n!==null;)I2(e,t,n),n=n.sibling}function I2(e,t,n){if(Vr&&typeof Vr.onCommitFiberUnmount=="function")try{Vr.onCommitFiberUnmount(ku,n)}catch{}switch(n.tag){case 5:hn||Ui(n,t);case 6:var r=sn,s=Cr;sn=null,vs(e,t,n),sn=r,Cr=s,sn!==null&&(Cr?(e=sn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):sn.removeChild(n.stateNode));break;case 18:sn!==null&&(Cr?(e=sn,n=n.stateNode,e.nodeType===8?Lc(e.parentNode,n):e.nodeType===1&&Lc(e,n),va(e)):Lc(sn,n.stateNode));break;case 4:r=sn,s=Cr,sn=n.stateNode.containerInfo,Cr=!0,vs(e,t,n),sn=r,Cr=s;break;case 0:case 11:case 14:case 15:if(!hn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Qd(n,t,a),s=s.next}while(s!==r)}vs(e,t,n);break;case 1:if(!hn&&(Ui(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Lt(n,t,u)}vs(e,t,n);break;case 21:vs(e,t,n);break;case 22:n.mode&1?(hn=(r=hn)||n.memoizedState!==null,vs(e,t,n),hn=r):vs(e,t,n);break;default:vs(e,t,n)}}function r1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Pw),t.forEach(function(r){var s=Uw.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ar(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,u=a;e:for(;u!==null;){switch(u.tag){case 5:sn=u.stateNode,Cr=!1;break e;case 3:sn=u.stateNode.containerInfo,Cr=!0;break e;case 4:sn=u.stateNode.containerInfo,Cr=!0;break e}u=u.return}if(sn===null)throw Error(ae(160));I2(i,a,s),sn=null,Cr=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){Lt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)R2(t,e),t=t.sibling}function R2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ar(t,e),Fr(e),r&4){try{oa(3,e,e.return),Mu(3,e)}catch(F){Lt(e,e.return,F)}try{oa(5,e,e.return)}catch(F){Lt(e,e.return,F)}}break;case 1:Ar(t,e),Fr(e),r&512&&n!==null&&Ui(n,n.return);break;case 5:if(Ar(t,e),Fr(e),r&512&&n!==null&&Ui(n,n.return),e.flags&32){var s=e.stateNode;try{pa(s,"")}catch(F){Lt(e,e.return,F)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,u=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{u==="input"&&i.type==="radio"&&i.name!=null&&ng(s,i),Ad(u,a);var h=Ad(u,i);for(a=0;a<d.length;a+=2){var m=d[a],w=d[a+1];m==="style"?ag(s,w):m==="dangerouslySetInnerHTML"?ig(s,w):m==="children"?pa(s,w):Tf(s,m,w,h)}switch(u){case"input":vd(s,i);break;case"textarea":rg(s,i);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Wi(s,!!i.multiple,_,!1):S!==!!i.multiple&&(i.defaultValue!=null?Wi(s,!!i.multiple,i.defaultValue,!0):Wi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Aa]=i}catch(F){Lt(e,e.return,F)}}break;case 6:if(Ar(t,e),Fr(e),r&4){if(e.stateNode===null)throw Error(ae(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(F){Lt(e,e.return,F)}}break;case 3:if(Ar(t,e),Fr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{va(t.containerInfo)}catch(F){Lt(e,e.return,F)}break;case 4:Ar(t,e),Fr(e);break;case 13:Ar(t,e),Fr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(ch=$t())),r&4&&r1(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(hn=(h=hn)||m,Ar(t,e),hn=h):Ar(t,e),Fr(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!m&&e.mode&1)for(Se=e,m=e.child;m!==null;){for(w=Se=m;Se!==null;){switch(S=Se,_=S.child,S.tag){case 0:case 11:case 14:case 15:oa(4,S,S.return);break;case 1:Ui(S,S.return);var L=S.stateNode;if(typeof L.componentWillUnmount=="function"){r=S,n=S.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(F){Lt(r,n,F)}}break;case 5:Ui(S,S.return);break;case 22:if(S.memoizedState!==null){i1(w);continue}}_!==null?(_.return=S,Se=_):i1(w)}m=m.sibling}e:for(m=null,w=e;;){if(w.tag===5){if(m===null){m=w;try{s=w.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(u=w.stateNode,d=w.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=og("display",a))}catch(F){Lt(e,e.return,F)}}}else if(w.tag===6){if(m===null)try{w.stateNode.nodeValue=h?"":w.memoizedProps}catch(F){Lt(e,e.return,F)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===e)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===e)break e;for(;w.sibling===null;){if(w.return===null||w.return===e)break e;m===w&&(m=null),w=w.return}m===w&&(m=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Ar(t,e),Fr(e),r&4&&r1(e);break;case 21:break;default:Ar(t,e),Fr(e)}}function Fr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(P2(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(pa(s,""),r.flags&=-33);var i=n1(e);Zd(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,u=n1(e);qd(e,u,a);break;default:throw Error(ae(161))}}catch(d){Lt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Rw(e,t,n){Se=e,L2(e)}function L2(e,t,n){for(var r=(e.mode&1)!==0;Se!==null;){var s=Se,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||dl;if(!a){var u=s.alternate,d=u!==null&&u.memoizedState!==null||hn;u=dl;var h=hn;if(dl=a,(hn=d)&&!h)for(Se=s;Se!==null;)a=Se,d=a.child,a.tag===22&&a.memoizedState!==null?o1(s):d!==null?(d.return=a,Se=d):o1(s);for(;i!==null;)Se=i,L2(i),i=i.sibling;Se=s,dl=u,hn=h}s1(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Se=i):s1(e)}}function s1(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:hn||Mu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!hn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Er(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Um(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Um(t,a,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var w=m.dehydrated;w!==null&&va(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}hn||t.flags&512&&Jd(t)}catch(S){Lt(t,t.return,S)}}if(t===e){Se=null;break}if(n=t.sibling,n!==null){n.return=t.return,Se=n;break}Se=t.return}}function i1(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Se=n;break}Se=t.return}}function o1(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Mu(4,t)}catch(d){Lt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){Lt(t,s,d)}}var i=t.return;try{Jd(t)}catch(d){Lt(t,i,d)}break;case 5:var a=t.return;try{Jd(t)}catch(d){Lt(t,a,d)}}}catch(d){Lt(t,t.return,d)}if(t===e){Se=null;break}var u=t.sibling;if(u!==null){u.return=t.return,Se=u;break}Se=t.return}}var Lw=Math.ceil,nu=ps.ReactCurrentDispatcher,lh=ps.ReactCurrentOwner,pr=ps.ReactCurrentBatchConfig,Ze=0,Zt=null,Ut=null,on=0,Vn=0,Hi=Gs(0),Xt=0,ba=null,pi=0,Tu=0,uh=0,aa=null,Nn=null,ch=0,uo=1/0,Jr=null,ru=!1,ef=null,Rs=null,fl=!1,Ns=null,su=0,la=0,tf=null,Nl=-1,bl=0;function xn(){return Ze&6?$t():Nl!==-1?Nl:Nl=$t()}function Ls(e){return e.mode&1?Ze&2&&on!==0?on&-on:vw.transition!==null?(bl===0&&(bl=wg()),bl):(e=at,e!==0||(e=window.event,e=e===void 0?16:_g(e.type)),e):1}function br(e,t,n,r){if(50<la)throw la=0,tf=null,Error(ae(185));La(e,n,r),(!(Ze&2)||e!==Zt)&&(e===Zt&&(!(Ze&2)&&(Tu|=n),Xt===4&&Es(e,on)),Pn(e,r),n===1&&Ze===0&&!(t.mode&1)&&(uo=$t()+500,ju&&Ws()))}function Pn(e,t){var n=e.callbackNode;v4(e,t);var r=zl(e,e===Zt?on:0);if(r===0)n!==null&&mm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&mm(n),t===1)e.tag===0?yw(a1.bind(null,e)):Wg(a1.bind(null,e)),hw(function(){!(Ze&6)&&Ws()}),n=null;else{switch(xg(r)){case 1:n=Bf;break;case 4:n=yg;break;case 16:n=Dl;break;case 536870912:n=vg;break;default:n=Dl}n=H2(n,B2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function B2(e,t){if(Nl=-1,bl=0,Ze&6)throw Error(ae(327));var n=e.callbackNode;if(Qi()&&e.callbackNode!==n)return null;var r=zl(e,e===Zt?on:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=iu(e,r);else{t=r;var s=Ze;Ze|=2;var i=O2();(Zt!==e||on!==t)&&(Jr=null,uo=$t()+500,li(e,t));do try{Ow();break}catch(u){F2(e,u)}while(!0);Kf(),nu.current=i,Ze=s,Ut!==null?t=0:(Zt=null,on=0,t=Xt)}if(t!==0){if(t===2&&(s=Nd(e),s!==0&&(r=s,t=nf(e,s))),t===1)throw n=ba,li(e,0),Es(e,r),Pn(e,$t()),n;if(t===6)Es(e,r);else{if(s=e.current.alternate,!(r&30)&&!Bw(s)&&(t=iu(e,r),t===2&&(i=Nd(e),i!==0&&(r=i,t=nf(e,i))),t===1))throw n=ba,li(e,0),Es(e,r),Pn(e,$t()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(ae(345));case 2:ni(e,Nn,Jr);break;case 3:if(Es(e,r),(r&130023424)===r&&(t=ch+500-$t(),10<t)){if(zl(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){xn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Bd(ni.bind(null,e,Nn,Jr),t);break}ni(e,Nn,Jr);break;case 4:if(Es(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Nr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lw(r/1960))-r,10<r){e.timeoutHandle=Bd(ni.bind(null,e,Nn,Jr),r);break}ni(e,Nn,Jr);break;case 5:ni(e,Nn,Jr);break;default:throw Error(ae(329))}}}return Pn(e,$t()),e.callbackNode===n?B2.bind(null,e):null}function nf(e,t){var n=aa;return e.current.memoizedState.isDehydrated&&(li(e,t).flags|=256),e=iu(e,t),e!==2&&(t=Nn,Nn=n,t!==null&&rf(t)),e}function rf(e){Nn===null?Nn=e:Nn.push.apply(Nn,e)}function Bw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Mr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Es(e,t){for(t&=~uh,t&=~Tu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Nr(t),r=1<<n;e[n]=-1,t&=~r}}function a1(e){if(Ze&6)throw Error(ae(327));Qi();var t=zl(e,0);if(!(t&1))return Pn(e,$t()),null;var n=iu(e,t);if(e.tag!==0&&n===2){var r=Nd(e);r!==0&&(t=r,n=nf(e,r))}if(n===1)throw n=ba,li(e,0),Es(e,t),Pn(e,$t()),n;if(n===6)throw Error(ae(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ni(e,Nn,Jr),Pn(e,$t()),null}function dh(e,t){var n=Ze;Ze|=1;try{return e(t)}finally{Ze=n,Ze===0&&(uo=$t()+500,ju&&Ws())}}function mi(e){Ns!==null&&Ns.tag===0&&!(Ze&6)&&Qi();var t=Ze;Ze|=1;var n=pr.transition,r=at;try{if(pr.transition=null,at=1,e)return e()}finally{at=r,pr.transition=n,Ze=t,!(Ze&6)&&Ws()}}function fh(){Vn=Hi.current,wt(Hi)}function li(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,fw(n)),Ut!==null)for(n=Ut.return;n!==null;){var r=n;switch(Vf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Vl();break;case 3:ao(),wt(Mn),wt(pn),th();break;case 5:eh(r);break;case 4:ao();break;case 13:wt(Nt);break;case 19:wt(Nt);break;case 10:Qf(r.type._context);break;case 22:case 23:fh()}n=n.return}if(Zt=e,Ut=e=Bs(e.current,null),on=Vn=t,Xt=0,ba=null,uh=Tu=pi=0,Nn=aa=null,si!==null){for(t=0;t<si.length;t++)if(n=si[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}si=null}return e}function F2(e,t){do{var n=Ut;try{if(Kf(),Cl.current=tu,eu){for(var r=bt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}eu=!1}if(hi=0,qt=Vt=bt=null,ia=!1,_a=0,lh.current=null,n===null||n.return===null){Xt=1,ba=t,Ut=null;break}e:{var i=e,a=n.return,u=n,d=t;if(t=on,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,m=u,w=m.tag;if(!(m.mode&1)&&(w===0||w===11||w===15)){var S=m.alternate;S?(m.updateQueue=S.updateQueue,m.memoizedState=S.memoizedState,m.lanes=S.lanes):(m.updateQueue=null,m.memoizedState=null)}var _=Xm(a);if(_!==null){_.flags&=-257,Km(_,a,u,i,t),_.mode&1&&Ym(i,h,t),t=_,d=h;var L=t.updateQueue;if(L===null){var F=new Set;F.add(d),t.updateQueue=F}else L.add(d);break e}else{if(!(t&1)){Ym(i,h,t),hh();break e}d=Error(ae(426))}}else if(At&&u.mode&1){var X=Xm(a);if(X!==null){!(X.flags&65536)&&(X.flags|=256),Km(X,a,u,i,t),Yf(lo(d,u));break e}}i=d=lo(d,u),Xt!==4&&(Xt=2),aa===null?aa=[i]:aa.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var C=x2(i,d,t);zm(i,C);break e;case 1:u=d;var g=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Rs===null||!Rs.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var E=S2(i,u,t);zm(i,E);break e}}i=i.return}while(i!==null)}D2(n)}catch(N){t=N,Ut===n&&n!==null&&(Ut=n=n.return);continue}break}while(!0)}function O2(){var e=nu.current;return nu.current=tu,e===null?tu:e}function hh(){(Xt===0||Xt===3||Xt===2)&&(Xt=4),Zt===null||!(pi&268435455)&&!(Tu&268435455)||Es(Zt,on)}function iu(e,t){var n=Ze;Ze|=2;var r=O2();(Zt!==e||on!==t)&&(Jr=null,li(e,t));do try{Fw();break}catch(s){F2(e,s)}while(!0);if(Kf(),Ze=n,nu.current=r,Ut!==null)throw Error(ae(261));return Zt=null,on=0,Xt}function Fw(){for(;Ut!==null;)$2(Ut)}function Ow(){for(;Ut!==null&&!u4();)$2(Ut)}function $2(e){var t=U2(e.alternate,e,Vn);e.memoizedProps=e.pendingProps,t===null?D2(e):Ut=t,lh.current=null}function D2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Tw(n,t),n!==null){n.flags&=32767,Ut=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xt=6,Ut=null;return}}else if(n=Mw(n,t,Vn),n!==null){Ut=n;return}if(t=t.sibling,t!==null){Ut=t;return}Ut=t=e}while(t!==null);Xt===0&&(Xt=5)}function ni(e,t,n){var r=at,s=pr.transition;try{pr.transition=null,at=1,$w(e,t,n,r)}finally{pr.transition=s,at=r}return null}function $w(e,t,n,r){do Qi();while(Ns!==null);if(Ze&6)throw Error(ae(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ae(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(w4(e,i),e===Zt&&(Ut=Zt=null,on=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fl||(fl=!0,H2(Dl,function(){return Qi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=pr.transition,pr.transition=null;var a=at;at=1;var u=Ze;Ze|=4,lh.current=null,Iw(e,n),R2(n,e),iw(Rd),Ul=!!Id,Rd=Id=null,e.current=n,Rw(n),c4(),Ze=u,at=a,pr.transition=i}else e.current=n;if(fl&&(fl=!1,Ns=e,su=s),i=e.pendingLanes,i===0&&(Rs=null),h4(n.stateNode),Pn(e,$t()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ru)throw ru=!1,e=ef,ef=null,e;return su&1&&e.tag!==0&&Qi(),i=e.pendingLanes,i&1?e===tf?la++:(la=0,tf=e):la=0,Ws(),null}function Qi(){if(Ns!==null){var e=xg(su),t=pr.transition,n=at;try{if(pr.transition=null,at=16>e?16:e,Ns===null)var r=!1;else{if(e=Ns,Ns=null,su=0,Ze&6)throw Error(ae(331));var s=Ze;for(Ze|=4,Se=e.current;Se!==null;){var i=Se,a=i.child;if(Se.flags&16){var u=i.deletions;if(u!==null){for(var d=0;d<u.length;d++){var h=u[d];for(Se=h;Se!==null;){var m=Se;switch(m.tag){case 0:case 11:case 15:oa(8,m,i)}var w=m.child;if(w!==null)w.return=m,Se=w;else for(;Se!==null;){m=Se;var S=m.sibling,_=m.return;if(T2(m),m===h){Se=null;break}if(S!==null){S.return=_,Se=S;break}Se=_}}}var L=i.alternate;if(L!==null){var F=L.child;if(F!==null){L.child=null;do{var X=F.sibling;F.sibling=null,F=X}while(F!==null)}}Se=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Se=a;else e:for(;Se!==null;){if(i=Se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:oa(9,i,i.return)}var C=i.sibling;if(C!==null){C.return=i.return,Se=C;break e}Se=i.return}}var g=e.current;for(Se=g;Se!==null;){a=Se;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,Se=v;else e:for(a=g;Se!==null;){if(u=Se,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Mu(9,u)}}catch(N){Lt(u,u.return,N)}if(u===a){Se=null;break e}var E=u.sibling;if(E!==null){E.return=u.return,Se=E;break e}Se=u.return}}if(Ze=s,Ws(),Vr&&typeof Vr.onPostCommitFiberRoot=="function")try{Vr.onPostCommitFiberRoot(ku,e)}catch{}r=!0}return r}finally{at=n,pr.transition=t}}return!1}function l1(e,t,n){t=lo(n,t),t=x2(e,t,1),e=Is(e,t,1),t=xn(),e!==null&&(La(e,1,t),Pn(e,t))}function Lt(e,t,n){if(e.tag===3)l1(e,e,n);else for(;t!==null;){if(t.tag===3){l1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rs===null||!Rs.has(r))){e=lo(n,e),e=S2(t,e,1),t=Is(t,e,1),e=xn(),t!==null&&(La(t,1,e),Pn(t,e));break}}t=t.return}}function Dw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=xn(),e.pingedLanes|=e.suspendedLanes&n,Zt===e&&(on&n)===n&&(Xt===4||Xt===3&&(on&130023424)===on&&500>$t()-ch?li(e,0):uh|=n),Pn(e,t)}function z2(e,t){t===0&&(e.mode&1?(t=nl,nl<<=1,!(nl&130023424)&&(nl=4194304)):t=1);var n=xn();e=cs(e,t),e!==null&&(La(e,t,n),Pn(e,n))}function zw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),z2(e,n)}function Uw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(t),z2(e,n)}var U2;U2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Mn.current)bn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return bn=!1,bw(e,t,n);bn=!!(e.flags&131072)}else bn=!1,At&&t.flags&1048576&&Vg(t,Kl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;jl(e,t),e=t.pendingProps;var s=so(t,pn.current);Ki(t,n),s=rh(null,t,r,e,s,n);var i=sh();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Tn(r)?(i=!0,Yl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,qf(t),s.updater=bu,t.stateNode=s,s._reactInternals=t,Hd(t,r,e,n),t=Vd(null,t,r,!0,i,n)):(t.tag=0,At&&i&&Wf(t),wn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(jl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Gw(r),e=Er(r,e),s){case 0:t=Wd(null,t,r,e,n);break e;case 1:t=qm(null,t,r,e,n);break e;case 11:t=Qm(null,t,r,e,n);break e;case 14:t=Jm(null,t,r,Er(r.type,e),n);break e}throw Error(ae(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Wd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),qm(e,t,r,s,n);case 3:e:{if(C2(t),e===null)throw Error(ae(387));r=t.pendingProps,i=t.memoizedState,s=i.element,qg(e,t),ql(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=lo(Error(ae(423)),t),t=Zm(e,t,r,n,s);break e}else if(r!==s){s=lo(Error(ae(424)),t),t=Zm(e,t,r,n,s);break e}else for(Yn=Ps(t.stateNode.containerInfo.firstChild),Xn=t,At=!0,_r=null,n=Qg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(io(),r===s){t=ds(e,t,n);break e}wn(e,t,r,n)}t=t.child}return t;case 5:return Zg(t),e===null&&Dd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Ld(r,s)?a=null:i!==null&&Ld(r,i)&&(t.flags|=32),E2(e,t),wn(e,t,a,n),t.child;case 6:return e===null&&Dd(t),null;case 13:return _2(e,t,n);case 4:return Zf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=oo(t,null,r,n):wn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Qm(e,t,r,s,n);case 7:return wn(e,t,t.pendingProps,n),t.child;case 8:return wn(e,t,t.pendingProps.children,n),t.child;case 12:return wn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,mt(Ql,r._currentValue),r._currentValue=a,i!==null)if(Mr(i.value,a)){if(i.children===s.children&&!Mn.current){t=ds(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var u=i.dependencies;if(u!==null){a=i.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=ss(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?d.next=d:(d.next=m.next,m.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),zd(i.return,n,t),u.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ae(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),zd(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}wn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ki(t,n),s=mr(s),r=r(s),t.flags|=1,wn(e,t,r,n),t.child;case 14:return r=t.type,s=Er(r,t.pendingProps),s=Er(r.type,s),Jm(e,t,r,s,n);case 15:return k2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),jl(e,t),t.tag=1,Tn(r)?(e=!0,Yl(t)):e=!1,Ki(t,n),w2(t,r,s),Hd(t,r,s,n),Vd(null,t,r,!0,e,n);case 19:return j2(e,t,n);case 22:return A2(e,t,n)}throw Error(ae(156,t.tag))};function H2(e,t){return gg(e,t)}function Hw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(e,t,n,r){return new Hw(e,t,n,r)}function ph(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gw(e){if(typeof e=="function")return ph(e)?1:0;if(e!=null){if(e=e.$$typeof,e===If)return 11;if(e===Rf)return 14}return 2}function Bs(e,t){var n=e.alternate;return n===null?(n=fr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ml(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")ph(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Ii:return ui(n.children,s,i,t);case Pf:a=8,s|=8;break;case hd:return e=fr(12,n,t,s|2),e.elementType=hd,e.lanes=i,e;case pd:return e=fr(13,n,t,s),e.elementType=pd,e.lanes=i,e;case md:return e=fr(19,n,t,s),e.elementType=md,e.lanes=i,e;case Z0:return Pu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case J0:a=10;break e;case q0:a=9;break e;case If:a=11;break e;case Rf:a=14;break e;case xs:a=16,r=null;break e}throw Error(ae(130,e==null?e:typeof e,""))}return t=fr(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ui(e,t,n,r){return e=fr(7,e,r,t),e.lanes=n,e}function Pu(e,t,n,r){return e=fr(22,e,r,t),e.elementType=Z0,e.lanes=n,e.stateNode={isHidden:!1},e}function Hc(e,t,n){return e=fr(6,e,null,t),e.lanes=n,e}function Gc(e,t,n){return t=fr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ww(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ec(0),this.expirationTimes=Ec(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ec(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mh(e,t,n,r,s,i,a,u,d){return e=new Ww(e,t,n,u,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=fr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qf(i),e}function Vw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function G2(e){if(!e)return Ds;e=e._reactInternals;e:{if(wi(e)!==e||e.tag!==1)throw Error(ae(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Tn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ae(171))}if(e.tag===1){var n=e.type;if(Tn(n))return Gg(e,n,t)}return t}function W2(e,t,n,r,s,i,a,u,d){return e=mh(n,r,!0,e,s,i,a,u,d),e.context=G2(null),n=e.current,r=xn(),s=Ls(n),i=ss(r,s),i.callback=t??null,Is(n,i,s),e.current.lanes=s,La(e,s,r),Pn(e,r),e}function Iu(e,t,n,r){var s=t.current,i=xn(),a=Ls(s);return n=G2(n),t.context===null?t.context=n:t.pendingContext=n,t=ss(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Is(s,t,a),e!==null&&(br(e,s,a,i),El(e,s,a)),a}function ou(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function u1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function gh(e,t){u1(e,t),(e=e.alternate)&&u1(e,t)}function Yw(){return null}var V2=typeof reportError=="function"?reportError:function(e){console.error(e)};function yh(e){this._internalRoot=e}Ru.prototype.render=yh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ae(409));Iu(e,t,null,null)};Ru.prototype.unmount=yh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;mi(function(){Iu(null,e,null,null)}),t[us]=null}};function Ru(e){this._internalRoot=e}Ru.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ag();e={blockedOn:null,target:e,priority:t};for(var n=0;n<As.length&&t!==0&&t<As[n].priority;n++);As.splice(n,0,e),n===0&&Cg(e)}};function vh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Lu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function c1(){}function Xw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=ou(a);i.call(h)}}var a=W2(t,r,e,0,null,!1,!1,"",c1);return e._reactRootContainer=a,e[us]=a.current,Sa(e.nodeType===8?e.parentNode:e),mi(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var h=ou(d);u.call(h)}}var d=mh(e,0,!1,null,null,!1,!1,"",c1);return e._reactRootContainer=d,e[us]=d.current,Sa(e.nodeType===8?e.parentNode:e),mi(function(){Iu(t,d,n,r)}),d}function Bu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var u=s;s=function(){var d=ou(a);u.call(d)}}Iu(t,a,e,s)}else a=Xw(n,t,e,s,r);return ou(a)}Sg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Qo(t.pendingLanes);n!==0&&(Ff(t,n|1),Pn(t,$t()),!(Ze&6)&&(uo=$t()+500,Ws()))}break;case 13:mi(function(){var r=cs(e,1);if(r!==null){var s=xn();br(r,e,1,s)}}),gh(e,1)}};Of=function(e){if(e.tag===13){var t=cs(e,134217728);if(t!==null){var n=xn();br(t,e,134217728,n)}gh(e,134217728)}};kg=function(e){if(e.tag===13){var t=Ls(e),n=cs(e,t);if(n!==null){var r=xn();br(n,e,t,r)}gh(e,t)}};Ag=function(){return at};Eg=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Cd=function(e,t,n){switch(t){case"input":if(vd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=_u(r);if(!s)throw Error(ae(90));tg(r),vd(r,s)}}}break;case"textarea":rg(e,n);break;case"select":t=n.value,t!=null&&Wi(e,!!n.multiple,t,!1)}};cg=dh;dg=mi;var Kw={usingClientEntryPoint:!1,Events:[Fa,Fi,_u,lg,ug,dh]},Go={findFiberByHostInstance:ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qw={bundleType:Go.bundleType,version:Go.version,rendererPackageName:Go.rendererPackageName,rendererConfig:Go.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ps.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pg(e),e===null?null:e.stateNode},findFiberByHostInstance:Go.findFiberByHostInstance||Yw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hl.isDisabled&&hl.supportsFiber)try{ku=hl.inject(Qw),Vr=hl}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kw;Jn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vh(t))throw Error(ae(200));return Vw(e,t,null,n)};Jn.createRoot=function(e,t){if(!vh(e))throw Error(ae(299));var n=!1,r="",s=V2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=mh(e,1,!1,null,null,n,!1,r,s),e[us]=t.current,Sa(e.nodeType===8?e.parentNode:e),new yh(t)};Jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ae(188)):(e=Object.keys(e).join(","),Error(ae(268,e)));return e=pg(t),e=e===null?null:e.stateNode,e};Jn.flushSync=function(e){return mi(e)};Jn.hydrate=function(e,t,n){if(!Lu(t))throw Error(ae(200));return Bu(null,e,t,!0,n)};Jn.hydrateRoot=function(e,t,n){if(!vh(e))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=V2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=W2(t,null,e,1,n??null,s,!1,i,a),e[us]=t.current,Sa(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Ru(t)};Jn.render=function(e,t,n){if(!Lu(t))throw Error(ae(200));return Bu(null,e,t,!1,n)};Jn.unmountComponentAtNode=function(e){if(!Lu(e))throw Error(ae(40));return e._reactRootContainer?(mi(function(){Bu(null,null,e,!1,function(){e._reactRootContainer=null,e[us]=null})}),!0):!1};Jn.unstable_batchedUpdates=dh;Jn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Lu(n))throw Error(ae(200));if(e==null||e._reactInternals===void 0)throw Error(ae(38));return Bu(e,t,n,!1,r)};Jn.version="18.3.1-next-f1338f8080-20240426";function Y2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Y2)}catch(e){console.error(e)}}Y2(),Y0.exports=Jn;var Jw=Y0.exports,d1=Jw;dd.createRoot=d1.createRoot,dd.hydrateRoot=d1.hydrateRoot;const Ji={},X2="production",f1={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-server.onrender.com/api",healthUrl:"https://cfg-server.onrender.com/health"}},K2=f1[X2]||f1.development,Fu=()=>{if(!(Ji!=null&&Ji.VITE_API_BASE_URL))return K2.baseUrl},qw=()=>{if(!(Ji!=null&&Ji.VITE_HEALTH_URL))return K2.healthUrl},Zw=async()=>{try{const e=await fetch(qw(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},ex=()=>X2;function tx({onStart:e}){const[t,n]=j.useState("1"),[r,s]=j.useState("individual"),[i,a]=j.useState("15"),[u,d]=j.useState({status:"checking",version:"...",commit:"...",healthy:!1});j.useEffect(()=>{const S=async()=>{const L=await Zw();d(L),console.log("[StartDialog] Server health:",L)};S();const _=setInterval(S,3e4);return()=>clearInterval(_)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const S={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(S)},m=()=>{window.close()},w=()=>u.status==="checking"?"checking":u.healthy?"healthy":"unhealthy";return l.jsx("div",{className:"dialog-overlay",children:l.jsxs("div",{className:"dialog-box",children:[l.jsxs("div",{className:"dialog-header",children:[l.jsx("h2",{children:"The Creative Game"}),l.jsxs("div",{className:`server-health-indicator ${w()}`,title:`Server: ${u.status}
Version: ${u.version}
Commit: ${u.commit}
Environment: ${ex()}`,children:[l.jsx("span",{className:"health-light"}),l.jsx("span",{className:"health-text",children:"Server"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"ID:"}),l.jsx("input",{type:"text",value:t,onChange:S=>n(S.target.value)})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Condition:"}),l.jsxs("select",{value:r,onChange:S=>s(S.target.value),children:[l.jsx("option",{value:"individual",children:"individual"}),l.jsx("option",{value:"group",children:"group"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Time (in minutes):"}),l.jsx("input",{type:"number",value:i,onChange:S=>a(S.target.value),min:"1"})]}),l.jsxs("div",{className:"dialog-buttons",children:[l.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),l.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),l.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),l.jsx("button",{className:"dialog-button cancel",onClick:m,children:"Cancel"})]})]})})}class h1{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const nx=.035;class rx{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=Fu(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),u=s-i;let d=0,h=0,m=0;n>=0&&n<60?(d=i,h=a,m=0):n<120?(d=a,h=i,m=0):n<180?(d=0,h=i,m=a):n<240?(d=0,h=a,m=i):n<300?(d=a,h=0,m=i):(d=i,h=0,m=a);const w=S=>{const _=Math.round((S+u)*255).toString(16);return _.length===1?"0"+_:_};return`#${w(d)}${w(h)}${w(m)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const u=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${u}

Please choose a different Session ID.`),this.stop(),new Error(u)):new Error(u)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/nx,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),u=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(S=>this.relativeToGrid(S)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:u,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:u,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(S=>this.relativeToGrid(S)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(S=>this.relativeToGrid(S)):null)),this.moves.push(h),this.persistMove(h).catch(S=>{console.error("[GameTracker] Failed to persist move to server:",S)});const m=this.getCurrentBraceletStatus(),w=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:u,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:m,lastKnownPlayer:w,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(S=>({status:S.status,elapsed:S.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(u=>u.timestamp>=s&&u.timestamp<=i);if(a.length>0){const u={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(u[h.status]=(u[h.status]||0)+1)});const d=Object.keys(u).reduce((h,m)=>u[h]>u[m]?h:m,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let Wc=null;const p1=()=>(Wc||(Wc=new rx),Wc),jr=.07,ua=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),jt=e=>Math.round(e*1e3)/1e3,sx=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[jt(i.position[0]-jr),jt(i.position[1])],[jt(i.position[0]+jr),jt(i.position[1])],[jt(i.position[0]),jt(i.position[1]-jr)],[jt(i.position[0]),jt(i.position[1]+jr)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},ix=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},sf=e=>e.map(t=>{const n=[],r=[[jt(t.position[0]-jr),jt(t.position[1])],[jt(t.position[0]+jr),jt(t.position[1])],[jt(t.position[0]),jt(t.position[1]-jr)],[jt(t.position[0]),jt(t.position[1]+jr)]];return e.forEach(s=>{r.forEach(i=>{jt(s.position[0])===i[0]&&jt(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),ox=e=>{const t=new Set;if(e.forEach((a,u)=>{a.forEach((d,h)=>{d&&t.add(`${u},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,u]=i.shift(),d=`${a},${u}`;s.has(d)||(s.add(d),n.forEach(([h,m])=>{const w=`${a+h},${u+m}`;t.has(w)&&!s.has(w)&&i.push([a+h,u+m])}))}return s.size===t.size},ax=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=jr)n.push(jt(i));const r=[];for(let i=-.7;i<0;i+=jr)r.push(jt(i));for(let i=0;i<=.77;i+=jr)r.push(jt(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const u=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);u!==-1&&d!==-1&&(s[d][u]=!0)}}),ox(s)},of=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=ax(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},m1=e=>{if(e.length===0)return null;try{const t=e.map(m=>m[0]),n=e.map(m=>m[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(m=>{const w=Math.sqrt(Math.pow(m[0]-r,2)+Math.pow(m[1]-s,2));w<i&&(i=w,a=m)});const u=-a[0],d=-a[1],h=e.map(m=>[jt(m[0]+u),jt(m[1]+d)]);return h.sort((m,w)=>m[0]-w[0]||m[1]-w[1]),h}catch{return null}},lx=60,g1=.07,Vc=120;function ux({config:e,interfaceHidden:t=!1}){const[n,r]=j.useState(ua()),[s,i]=j.useState(null),[a,u]=j.useState({x:0,y:0}),[d,h]=j.useState(!0),[m,w]=j.useState(e.timeSeconds),[S,_]=j.useState(0),[L,F]=j.useState(null),[X,C]=j.useState(!0),[g,v]=j.useState(""),[E,N]=j.useState(!1),[T,$]=j.useState({blockSize:lx,bottomPadding:Vc}),H=j.useRef(null),q=j.useRef(new h1(e)),V=j.useRef(p1()),K=j.useRef(null),ne=j.useRef(Date.now()),ee=j.useRef(Vc),ie=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,ve=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,we="The experiment is done. Thank you very much for your participation!",Te=j.useCallback(()=>{const R=H.current;if(!R)return;const z=R.offsetWidth,J=R.offsetHeight;if(!z||!J)return;const de=ee.current||Vc;let D=Math.max(1,Math.min(z,J-de)),y=Math.max(38,Math.min(D*g1*.95,D/4)),I=Math.max(y*2.5,110);D=Math.max(1,Math.min(z,J-I)),y=Math.max(38,Math.min(D*g1*.95,D/4)),I=Math.max(y*2.5,110),ee.current=I,$(M=>{const b=Math.abs(M.blockSize-y),B=Math.abs(M.bottomPadding-I);return b<.5&&B<.5?M:{blockSize:y,bottomPadding:I}})},[]);j.useEffect(()=>(v(ie),(async()=>{try{V.current.start(),await V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(z){console.error("[GameCanvas] Failed to initialize tracker:",z),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{C(!0),v(we),N(!0),V.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,V.current.stop()}),[]),j.useEffect(()=>{Te()},[Te,t]),j.useEffect(()=>{const R=()=>{Te()};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[Te]),j.useEffect(()=>{if(!d&&m>0){const R=setInterval(()=>{w(z=>z<=1?(clearInterval(R),C(!0),v(we),N(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):z-1)},1e3);return()=>clearInterval(R)}},[d,m]),j.useEffect(()=>{r(R=>of(sf(R),d))},[d]);const se=()=>(Date.now()-ne.current)/1e3,Z=(R,z)=>{const J=H.current;if(!J)return 0;const de=J.offsetHeight-ee.current,D=Math.min(J.offsetWidth,de),y=z==="x"?(J.offsetWidth-D)/2:(J.offsetHeight-ee.current-D)/2;return(R-y)/D-.5},re=(R,z)=>{const J=H.current;if(!J)return 0;const de=J.offsetHeight-ee.current,D=Math.min(J.offsetWidth,de),y=z==="x"?(J.offsetWidth-D)/2:(J.offsetHeight-ee.current-D)/2;return(R+.5)*D+y},ge=R=>{var D,y,I,M;const z=H.current.getBoundingClientRect(),J=R.clientX!==void 0?R.clientX:(y=(D=R.touches)==null?void 0:D[0])==null?void 0:y.clientX,de=R.clientY!==void 0?R.clientY:(M=(I=R.touches)==null?void 0:I[0])==null?void 0:M.clientY;return{x:J-z.left,y:de-z.top}},Me=(R,z)=>{const J=n.find(I=>I.id===z);if(!J||!J.canMove)return;R.preventDefault();const de=ge(R),D=re(J.position[0],"x"),y=re(J.position[1],"y");K.current=Date.now(),i(z),u({x:de.x-D,y:de.y-y})},Ue=R=>{if(s===null)return;R.preventDefault();const z=ge(R),J=Z(z.x-a.x,"x"),de=Z(z.y-a.y,"y");r(D=>D.map(y=>y.id===s?{...y,position:[J,de]}:y))},$e=()=>{try{const R=window.braceletDetectorVideo;if(!R||!R.videoWidth||R.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const z=document.createElement("canvas"),J=640,de=480;let D=R.videoWidth,y=R.videoHeight;const I=D/y;return D>J&&(D=J,y=D/I),y>de&&(y=de,D=y*I),z.width=Math.floor(D),z.height=Math.floor(y),z.getContext("2d").drawImage(R,0,0,z.width,z.height),z.toDataURL("image/jpeg",.6)}catch(R){return console.error("[GameCanvas] Error capturing camera frame:",R),null}},Ne=()=>{if(s===null)return;const R=n.find(b=>b.id===s),z=sx(n,s),J=ix(z,R.position),de=K.current?(Date.now()-K.current)/1e3:0,D=n.map(b=>b.id===s?{...b,position:J}:b),y=$e(),I=window.currentBraceletStatus||"Unknown",M={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:se(),unit:s,end_position:J,all_positions:D.map(b=>b.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:y,player:I};q.current.write(M),V.current.recordMove(M,de,y),r(b=>{const B=b.map(U=>U.id===s?{...U,position:J}:U);return of(sf(B),d)}),i(null),K.current=null},ze=()=>{const R=n.map(M=>M.position),z=m1(R),J=S+1,de=$e(),D=window.currentBraceletStatus||"Unknown",y={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:se(),unit:null,end_position:null,all_positions:null,gallery_shape_number:J,gallery:R,gallery_normalized:z,camera_frame:de,player:D};q.current.write(y),V.current.recordMove(y,0,de);const I=Y();F(I),_(J)},Y=()=>{const R=document.createElement("canvas");R.width=400,R.height=400;const z=R.getContext("2d");z.fillStyle="#000",z.fillRect(0,0,400,400);const J=n.map(D=>D.position),de=m1(J);return de&&de.forEach(D=>{const y=(D[0]+.5)*400,I=(D[1]+.5)*400;z.fillStyle="green",z.fillRect(y-15,I-15,30,30)}),R.toDataURL()},Q=j.useCallback(R=>{R.key==="p"&&d?(h(!1),C(!0),v(ve),ne.current=Date.now(),r(ua()),F(null),_(0),q.current=new h1(e),V.current.stop(),V.current=p1(),V.current.start(),V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):R.key==="q"&&!d&&(C(!0),v(we),N(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);j.useEffect(()=>(window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)),[Q]);const ye=()=>{if(E&&g===we){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&g===ve)try{const R=new(window.AudioContext||window.webkitAudioContext),z=R.createOscillator(),J=R.createGain();z.connect(J),J.connect(R.destination),z.frequency.setValueAtTime(800,R.currentTime),z.frequency.setValueAtTime(600,R.currentTime+.15),J.gain.setValueAtTime(.3,R.currentTime),J.gain.exponentialRampToValueAtTime(.01,R.currentTime+.3),z.start(R.currentTime),z.stop(R.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(R){console.error("[GameCanvas] Error playing sound:",R)}C(!1)},le=R=>{R.preventDefault()};return l.jsxs("div",{className:"game-canvas",ref:H,style:{"--block-size":`${T.blockSize}px`,"--bottom-padding":`${T.bottomPadding}px`},onMouseMove:Ue,onMouseUp:Ne,onMouseLeave:Ne,onTouchMove:Ue,onTouchEnd:Ne,onTouchCancel:Ne,onContextMenu:le,children:[l.jsx("div",{className:"gallery",onClick:ze,children:l.jsx("div",{className:"gallery-frame",children:L?l.jsx("img",{src:L,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&l.jsxs("div",{className:"timer",children:["Time: ",Math.floor(m/60),":",(m%60).toString().padStart(2,"0")]}),n.map(R=>l.jsx("div",{className:`block ${R.canMove?"movable":""}`,style:{left:`${re(R.position[0],"x")}px`,top:`${re(R.position[1],"y")}px`,backgroundColor:R.color||"green",cursor:R.canMove?"grab":"default"},onMouseDown:z=>Me(z,R.id),onTouchStart:z=>Me(z,R.id)},R.id)),X&&l.jsx("div",{className:"message-overlay",onClick:ye,children:l.jsxs("div",{className:"message-box",children:[g,l.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var au={};(function(){var e;function t(o){var c=0;return function(){return c<o.length?{done:!1,value:o[c++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof vc=="object"&&vc];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,c){if(c)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var x=o[p];if(!(x in f))break e;f=f[x]}o=o[o.length-1],p=f[o],c=c(p),c!=p&&c!=null&&n(f,o,{configurable:!0,writable:!0,value:c})}}i("Symbol",function(o){function c(A){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new f(p+(A||"")+"_"+x++,A)}function f(A,k){this.h=A,n(this,"description",{configurable:!0,writable:!0,value:k})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",x=0;return c}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<c.length;f++){var p=s[c[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function u(o){var c=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return c?c.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=u(o);for(var c,f=[];!(c=o.next()).done;)f.push(c.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,c){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(o[x]=p[x])}return o};i("Object.assign",function(o){return o||h});var m=typeof Object.create=="function"?Object.create:function(o){function c(){}return c.prototype=o,new c},w;if(typeof Object.setPrototypeOf=="function")w=Object.setPrototypeOf;else{var S;e:{var _={a:!0},L={};try{L.__proto__=_,S=L.a;break e}catch{}S=!1}w=S?function(o,c){if(o.__proto__=c,o.__proto__!==c)throw new TypeError(o+" is not extensible");return o}:null}var F=w;function X(o,c){if(o.prototype=m(c.prototype),o.prototype.constructor=o,F)F(o,c);else for(var f in c)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(c,f);p&&Object.defineProperty(o,f,p)}else o[f]=c[f];o.ya=c.prototype}function C(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function g(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}C.prototype.u=function(o){this.i=o};function v(o,c){o.l={ma:c,na:!0},o.h=o.s||o.v}C.prototype.return=function(o){this.l={return:o},this.h=this.v};function E(o,c,f){return o.h=f,{value:c}}function N(o){this.h=new C,this.i=o}function T(o,c){g(o.h);var f=o.h.j;return f?$(o,"return"in f?f.return:function(p){return{value:p,done:!0}},c,o.h.return):(o.h.return(c),H(o))}function $(o,c,f,p){try{var x=c.call(o.h.j,f);if(!(x instanceof Object))throw new TypeError("Iterator result "+x+" is not an object");if(!x.done)return o.h.m=!1,x;var A=x.value}catch(k){return o.h.j=null,v(o.h,k),H(o)}return o.h.j=null,p.call(o.h,A),H(o)}function H(o){for(;o.h.h;)try{var c=o.i(o.h);if(c)return o.h.m=!1,{value:c.value,done:!1}}catch(f){o.h.i=void 0,v(o.h,f)}if(o.h.m=!1,o.h.l){if(c=o.h.l,o.h.l=null,c.na)throw c.ma;return{value:c.return,done:!0}}return{value:void 0,done:!0}}function q(o){this.next=function(c){return g(o.h),o.h.j?c=$(o,o.h.j.next,c,o.h.u):(o.h.u(c),c=H(o)),c},this.throw=function(c){return g(o.h),o.h.j?c=$(o,o.h.j.throw,c,o.h.u):(v(o.h,c),c=H(o)),c},this.return=function(c){return T(o,c)},this[Symbol.iterator]=function(){return this}}function V(o){function c(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,x){function A(k){k.done?p(k.value):Promise.resolve(k.value).then(c,f).then(A,x)}A(o.next())})}function K(o){return V(new q(new N(o)))}i("Promise",function(o){function c(k){this.i=0,this.j=void 0,this.h=[],this.u=!1;var P=this.l();try{k(P.resolve,P.reject)}catch(G){P.reject(G)}}function f(){this.h=null}function p(k){return k instanceof c?k:new c(function(P){P(k)})}if(o)return o;f.prototype.i=function(k){if(this.h==null){this.h=[];var P=this;this.j(function(){P.m()})}this.h.push(k)};var x=s.setTimeout;f.prototype.j=function(k){x(k,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var k=this.h;this.h=[];for(var P=0;P<k.length;++P){var G=k[P];k[P]=null;try{G()}catch(oe){this.l(oe)}}}this.h=null},f.prototype.l=function(k){this.j(function(){throw k})},c.prototype.l=function(){function k(oe){return function(pe){G||(G=!0,oe.call(P,pe))}}var P=this,G=!1;return{resolve:k(this.I),reject:k(this.m)}},c.prototype.I=function(k){if(k===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(k instanceof c)this.L(k);else{e:switch(typeof k){case"object":var P=k!=null;break e;case"function":P=!0;break e;default:P=!1}P?this.F(k):this.s(k)}},c.prototype.F=function(k){var P=void 0;try{P=k.then}catch(G){this.m(G);return}typeof P=="function"?this.M(P,k):this.s(k)},c.prototype.m=function(k){this.v(2,k)},c.prototype.s=function(k){this.v(1,k)},c.prototype.v=function(k,P){if(this.i!=0)throw Error("Cannot settle("+k+", "+P+"): Promise already settled in state"+this.i);this.i=k,this.j=P,this.i===2&&this.K(),this.H()},c.prototype.K=function(){var k=this;x(function(){if(k.D()){var P=s.console;typeof P<"u"&&P.error(k.j)}},1)},c.prototype.D=function(){if(this.u)return!1;var k=s.CustomEvent,P=s.Event,G=s.dispatchEvent;return typeof G>"u"?!0:(typeof k=="function"?k=new k("unhandledrejection",{cancelable:!0}):typeof P=="function"?k=new P("unhandledrejection",{cancelable:!0}):(k=s.document.createEvent("CustomEvent"),k.initCustomEvent("unhandledrejection",!1,!0,k)),k.promise=this,k.reason=this.j,G(k))},c.prototype.H=function(){if(this.h!=null){for(var k=0;k<this.h.length;++k)A.i(this.h[k]);this.h=null}};var A=new f;return c.prototype.L=function(k){var P=this.l();k.T(P.resolve,P.reject)},c.prototype.M=function(k,P){var G=this.l();try{k.call(P,G.resolve,G.reject)}catch(oe){G.reject(oe)}},c.prototype.then=function(k,P){function G(Ce,xe){return typeof Ce=="function"?function(Fe){try{oe(Ce(Fe))}catch(Ve){pe(Ve)}}:xe}var oe,pe,Be=new c(function(Ce,xe){oe=Ce,pe=xe});return this.T(G(k,oe),G(P,pe)),Be},c.prototype.catch=function(k){return this.then(void 0,k)},c.prototype.T=function(k,P){function G(){switch(oe.i){case 1:k(oe.j);break;case 2:P(oe.j);break;default:throw Error("Unexpected state: "+oe.i)}}var oe=this;this.h==null?A.i(G):this.h.push(G),this.u=!0},c.resolve=p,c.reject=function(k){return new c(function(P,G){G(k)})},c.race=function(k){return new c(function(P,G){for(var oe=u(k),pe=oe.next();!pe.done;pe=oe.next())p(pe.value).T(P,G)})},c.all=function(k){var P=u(k),G=P.next();return G.done?p([]):new c(function(oe,pe){function Be(Fe){return function(Ve){Ce[Fe]=Ve,xe--,xe==0&&oe(Ce)}}var Ce=[],xe=0;do Ce.push(void 0),xe++,p(G.value).T(Be(Ce.length-1),pe),G=P.next();while(!G.done)})},c});function ne(o,c){o instanceof String&&(o+="");var f=0,p=!1,x={next:function(){if(!p&&f<o.length){var A=f++;return{value:c(A,o[A]),done:!1}}return p=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.keys",function(o){return o||function(){return ne(this,function(c){return c})}}),i("Array.prototype.fill",function(o){return o||function(c,f,p){var x=this.length||0;for(0>f&&(f=Math.max(0,x+f)),(p==null||p>x)&&(p=x),p=Number(p),0>p&&(p=Math.max(0,x+p)),f=Number(f||0);f<p;f++)this[f]=c;return this}});function ee(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",ee),i("Uint8Array.prototype.fill",ee),i("Uint8ClampedArray.prototype.fill",ee),i("Int16Array.prototype.fill",ee),i("Uint16Array.prototype.fill",ee),i("Int32Array.prototype.fill",ee),i("Uint32Array.prototype.fill",ee),i("Float32Array.prototype.fill",ee),i("Float64Array.prototype.fill",ee),i("Object.is",function(o){return o||function(c,f){return c===f?c!==0||1/c===1/f:c!==c&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(c,f){var p=this;p instanceof String&&(p=String(p));var x=p.length;for(f=f||0,0>f&&(f=Math.max(f+x,0));f<x;f++){var A=p[f];if(A===c||Object.is(A,c))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(c,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(c,f||0)!==-1}});var ie=this||self;function ve(o,c){o=o.split(".");var f=ie;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||c===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=c}function we(o){var c;e:{if((c=ie.navigator)&&(c=c.userAgent))break e;c=""}return c.indexOf(o)!=-1}var Te=Array.prototype.map?function(o,c){return Array.prototype.map.call(o,c,void 0)}:function(o,c){for(var f=o.length,p=Array(f),x=typeof o=="string"?o.split(""):o,A=0;A<f;A++)A in x&&(p[A]=c.call(void 0,x[A],A,o));return p},se={},Z=null;function re(o){var c=o.length,f=3*c/4;f%3?f=Math.floor(f):"=.".indexOf(o[c-1])!=-1&&(f="=.".indexOf(o[c-2])!=-1?f-2:f-1);var p=new Uint8Array(f),x=0;return ge(o,function(A){p[x++]=A}),x!==f?p.subarray(0,x):p}function ge(o,c){function f(G){for(;p<o.length;){var oe=o.charAt(p++),pe=Z[oe];if(pe!=null)return pe;if(!/^[\s\xa0]*$/.test(oe))throw Error("Unknown base64 encoding at char: "+oe)}return G}Me();for(var p=0;;){var x=f(-1),A=f(0),k=f(64),P=f(64);if(P===64&&x===-1)break;c(x<<2|A>>4),k!=64&&(c(A<<4&240|k>>2),P!=64&&c(k<<6&192|P))}}function Me(){if(!Z){Z={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(c[f].split(""));se[f]=p;for(var x=0;x<p.length;x++){var A=p[x];Z[A]===void 0&&(Z[A]=x)}}}}var Ue=typeof Uint8Array<"u",$e=!(we("Trident")||we("MSIE"))&&typeof ie.btoa=="function";function Ne(o){if(!$e){var c;c===void 0&&(c=0),Me(),c=se[c];for(var f=Array(Math.floor(o.length/3)),p=c[64]||"",x=0,A=0;x<o.length-2;x+=3){var k=o[x],P=o[x+1],G=o[x+2],oe=c[k>>2];k=c[(k&3)<<4|P>>4],P=c[(P&15)<<2|G>>6],G=c[G&63],f[A++]=oe+k+P+G}switch(oe=0,G=p,o.length-x){case 2:oe=o[x+1],G=c[(oe&15)<<2]||p;case 1:o=o[x],f[A]=c[o>>2]+c[(o&3)<<4|oe>>4]+G+p}return f.join("")}for(c="";10240<o.length;)c+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return c+=String.fromCharCode.apply(null,o),btoa(c)}var ze=RegExp("[-_.]","g");function Y(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Q(o){if(!$e)return re(o);ze.test(o)&&(o=o.replace(ze,Y)),o=atob(o);for(var c=new Uint8Array(o.length),f=0;f<o.length;f++)c[f]=o.charCodeAt(f);return c}var ye;function le(){return ye||(ye=new Uint8Array(0))}var R={},z=typeof Uint8Array.prototype.slice=="function",J=0,de=0;function D(o){var c=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),c&&(f=u(I(f,o)),c=f.next().value,o=f.next().value,f=c),J=f>>>0,de=o>>>0}var y=typeof BigInt=="function";function I(o,c){return c=~c,o?o=~o+1:c+=1,[o,c]}function M(o,c){this.i=o>>>0,this.h=c>>>0}function b(o){if(!o)return B||(B=new M(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)D(Number(o));else if(y)o=BigInt(o),J=Number(o&BigInt(4294967295))>>>0,de=Number(o>>BigInt(32)&BigInt(4294967295));else{var c=+(o[0]==="-");de=J=0;for(var f=o.length,p=c,x=(f-c)%6+c;x<=f;p=x,x+=6)p=Number(o.slice(p,x)),de*=1e6,J=1e6*J+p,4294967296<=J&&(de+=J/4294967296|0,J%=4294967296);c&&(c=u(I(J,de)),o=c.next().value,c=c.next().value,J=o,de=c)}return new M(J,de)}var B;function U(o,c){return Error("Invalid wire type: "+o+" (at position "+c+")")}function W(){return Error("Failed to read varint, encoding is invalid.")}function ue(o,c){return Error("Tried to read past the end of the data "+c+" > "+o)}function me(){throw Error("Invalid UTF8")}function be(o,c){return c=String.fromCharCode.apply(null,c),o==null?c:o+c}var Ie=void 0,Oe,tt=typeof TextDecoder<"u",Qe,lt=typeof TextEncoder<"u",ut;function He(o){if(o!==R)throw Error("illegal external caller")}function De(o,c){if(He(c),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ge(){return ut||(ut=new De(null,R))}function Je(o){He(R);var c=o.V;return c=c==null||Ue&&c!=null&&c instanceof Uint8Array?c:typeof c=="string"?Q(c):null,c==null?c:o.V=c}function _t(o){if(typeof o=="string")return{buffer:Q(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===De)return{buffer:Je(o)||le(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Bn(o,c){this.i=null,this.m=!1,this.h=this.j=this.l=0,ct(this,o,c)}function ct(o,c,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,c&&(c=_t(c),o.i=c.buffer,o.m=c.C,o.l=0,o.j=o.i.length,o.h=o.l)}Bn.prototype.reset=function(){this.h=this.l};function zt(o,c){if(o.h=c,c>o.j)throw ue(o.j,c)}function Pt(o){var c=o.i,f=o.h,p=c[f++],x=p&127;if(p&128&&(p=c[f++],x|=(p&127)<<7,p&128&&(p=c[f++],x|=(p&127)<<14,p&128&&(p=c[f++],x|=(p&127)<<21,p&128&&(p=c[f++],x|=p<<28,p&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128)))))throw W();return zt(o,f),x}function en(o,c){if(0>c)throw Error("Tried to read a negative byte length: "+c);var f=o.h,p=f+c;if(p>o.j)throw ue(c,o.j-f);return o.h=p,f}var mn=[];function gn(){this.h=[]}gn.prototype.length=function(){return this.h.length},gn.prototype.end=function(){var o=this.h;return this.h=[],o};function yn(o,c,f){for(;0<f||127<c;)o.h.push(c&127|128),c=(c>>>7|f<<25)>>>0,f>>>=7;o.h.push(c)}function tn(o,c){for(;127<c;)o.h.push(c&127|128),c>>>=7;o.h.push(c)}function Qr(o,c){if(mn.length){var f=mn.pop();ct(f,o,c),o=f}else o=new Bn(o,c);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(c)}Qr.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},Qr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Lr(o){var c=o.h;if(c.h==c.j)return!1;o.j=o.h.h;var f=Pt(o.h)>>>0;if(c=f>>>3,f&=7,!(0<=f&&5>=f))throw U(f,o.j);if(1>c)throw Error("Invalid field number: "+c+" (at position "+o.j+")");return o.l=c,o.i=f,!0}function Br(o){switch(o.i){case 0:if(o.i!=0)Br(o);else e:{o=o.h;for(var c=o.h,f=c+10,p=o.i;c<f;)if(!(p[c++]&128)){zt(o,c);break e}throw W()}break;case 1:o=o.h,zt(o,o.h+8);break;case 2:o.i!=2?Br(o):(c=Pt(o.h)>>>0,o=o.h,zt(o,o.h+c));break;case 5:o=o.h,zt(o,o.h+4);break;case 3:c=o.l;do{if(!Lr(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=c)throw Error("Unmatched end-group tag");break}Br(o)}while(!0);break;default:throw U(o.i,o.j)}}var Fn=[];function Ks(){this.j=[],this.i=0,this.h=new gn}function On(o,c){c.length!==0&&(o.j.push(c),o.i+=c.length)}function Si(o,c){if(c=c.R){On(o,o.h.end());for(var f=0;f<c.length;f++)On(o,Je(c[f])||le())}}var $n=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function nr(o,c){return $n?o[$n]|=c:o.A!==void 0?o.A|=c:(Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}}),c)}function Qs(o,c){$n?o[$n]&&(o[$n]&=~c):o.A!==void 0&&(o.A&=~c)}function St(o){var c;return $n?c=o[$n]:c=o.A,c??0}function Dn(o,c){$n?o[$n]=c:o.A!==void 0?o.A=c:Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}})}function ki(o){return nr(o,1),o}function Ga(o,c){Dn(c,(o|0)&-51)}function Js(o,c){Dn(c,(o|18)&-41)}var Ai={};function qs(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var gs,Po=[];Dn(Po,23),gs=Object.freeze(Po);function O(o){if(St(o.o)&2)throw Error("Cannot mutate an immutable Message")}function fe(o){var c=o.length;(c=c?o[c-1]:void 0)&&qs(c)?c.g=1:(c={},o.push((c.g=1,c)))}function he(o){var c=o.i+o.G;return o.B||(o.B=o.o[c]={})}function te(o,c){return c===-1?null:c>=o.i?o.B?o.B[c]:void 0:o.o[c+o.G]}function ce(o,c,f,p){O(o),Re(o,c,f,p)}function Re(o,c,f,p){o.j&&(o.j=void 0),c>=o.i||p?he(o)[c]=f:(o.o[c+o.G]=f,(o=o.B)&&c in o&&delete o[c])}function it(o,c,f,p){var x=te(o,c);Array.isArray(x)||(x=gs);var A=St(x);if(A&1||ki(x),p)A&2||nr(x,2),f&1||Object.freeze(x);else{p=!(f&2);var k=A&2;f&1||!k?p&&A&16&&!k&&Qs(x,16):(x=ki(Array.prototype.slice.call(x)),Re(o,c,x))}return x}function qe(o,c){var f=te(o,c),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&Re(o,c,p),p}function Le(o,c,f,p,x){o.h||(o.h={});var A=o.h[f],k=it(o,f,3,x);if(!A){var P=k;A=[];var G=!!(St(o.o)&16);k=!!(St(P)&2);var oe=P;!x&&k&&(P=Array.prototype.slice.call(P));for(var pe=k,Be=0;Be<P.length;Be++){var Ce=P[Be],xe=c,Fe=!1;if(Fe=Fe===void 0?!1:Fe,Ce=Array.isArray(Ce)?new xe(Ce):Fe?new xe:void 0,Ce!==void 0){xe=Ce.o;var Ve=Fe=St(xe);k&&(Ve|=2),G&&(Ve|=16),Ve!=Fe&&Dn(xe,Ve),xe=Ve,pe=pe||!!(2&xe),A.push(Ce)}}return o.h[f]=A,G=St(P),c=G|33,c=pe?c&-9:c|8,G!=c&&(pe=P,Object.isFrozen(pe)&&(pe=Array.prototype.slice.call(pe)),Dn(pe,c),P=pe),oe!==P&&Re(o,f,P),(x||p&&k)&&nr(A,2),p&&Object.freeze(A),A}return x||(x=Object.isFrozen(A),p&&!x?Object.freeze(A):!p&&x&&(A=Array.prototype.slice.call(A),o.h[f]=A)),A}function We(o,c,f){var p=!!(St(o.o)&2);if(c=Le(o,c,f,p,p),o=it(o,f,3,p),!(p||St(o)&8)){for(p=0;p<c.length;p++){if(f=c[p],St(f.o)&2){var x=Mp(f,!1);x.j=f}else x=f;f!==x&&(c[p]=x,o[p]=x.o)}nr(o,8)}return c}function dt(o,c,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);ce(o,c,f)}function rr(o,c,f,p,x){O(o);var A=Le(o,f,c,!1,!1);return f=p??new f,o=it(o,c,2,!1),x!=null?(A.splice(x,0,f),o.splice(x,0,f.o)):(A.push(f),o.push(f.o)),f.C()&&Qs(o,8),f}function ln(o,c){return o??c}function sr(o,c,f){return f=f===void 0?0:f,ln(qe(o,c),f)}var Ei;function Io(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(St(o)&128)return o=Array.prototype.slice.call(o),fe(o),o}else{if(Ue&&o!=null&&o instanceof Uint8Array)return Ne(o);if(o instanceof De){var c=o.V;return c==null?"":typeof c=="string"?c:o.V=Ne(c)}}}return o}function Wa(o,c,f,p){if(o!=null){if(Array.isArray(o))o=Zs(o,c,f,p!==void 0);else if(qs(o)){var x={},A;for(A in o)x[A]=Wa(o[A],c,f,p);o=x}else o=c(o,p);return o}}function Zs(o,c,f,p){var x=St(o);p=p?!!(x&16):void 0,o=Array.prototype.slice.call(o);for(var A=0;A<o.length;A++)o[A]=Wa(o[A],c,f,p);return f(x,o),o}function Wv(o){return o.ja===Ai?o.toJSON():Io(o)}function Vv(o,c){o&128&&fe(c)}function jp(o,c,f){if(f=f===void 0?Js:f,o!=null){if(Ue&&o instanceof Uint8Array)return o.length?new De(new Uint8Array(o),R):Ge();if(Array.isArray(o)){var p=St(o);return p&2?o:c&&!(p&32)&&(p&16||p===0)?(Dn(o,p|2),o):(o=Zs(o,jp,p&4?Js:f,!0),c=St(o),c&4&&c&2&&Object.freeze(o),o)}return o.ja===Ai?bp(o):o}}function Np(o,c,f,p,x,A,k){if(o=o.h&&o.h[f]){if(p=St(o),p&2?p=o:(A=Te(o,bp),Js(p,A),Object.freeze(A),p=A),O(c),k=p==null?gs:ki([]),p!=null){for(A=!!p.length,o=0;o<p.length;o++){var P=p[o];A=A&&!(St(P.o)&2),k[o]=P.o}A=(A?8:0)|1,o=St(k),(o&A)!==A&&(Object.isFrozen(k)&&(k=Array.prototype.slice.call(k)),Dn(k,o|A)),c.h||(c.h={}),c.h[f]=p}else c.h&&(c.h[f]=void 0);Re(c,f,k,x)}else ce(c,f,jp(p,A,k),x)}function bp(o){return St(o.o)&2||(o=Mp(o,!0),nr(o.o,2)),o}function Mp(o,c){var f=o.o,p=[];nr(p,16);var x=o.constructor.h;if(x&&p.push(x),x=o.B,x){p.length=f.length,p.fill(void 0,p.length,f.length);var A={};p[p.length-1]=A}St(f)&128&&fe(p),c=c||o.C()?Js:Ga,A=o.constructor,Ei=p,p=new A(p),Ei=void 0,o.R&&(p.R=o.R.slice()),A=!!(St(f)&16);for(var k=x?f.length-1:f.length,P=0;P<k;P++)Np(o,p,P-o.G,f[P],!1,A,c);if(x)for(var G in x)Np(o,p,+G,x[G],!0,A,c);return p}function _n(o,c,f){o==null&&(o=Ei),Ei=void 0;var p=this.constructor.i||0,x=0<p,A=this.constructor.h,k=!1;if(o==null){o=A?[A]:[];var P=48,G=!0;x&&(p=0,P|=128),Dn(o,P)}else{if(!Array.isArray(o)||A&&A!==o[0])throw Error();var oe=P=nr(o,0);if((G=(16&oe)!==0)&&((k=(32&oe)!==0)||(oe|=32)),x){if(128&oe)p=0;else if(0<o.length){var pe=o[o.length-1];if(qs(pe)&&"g"in pe){p=0,oe|=128,delete pe.g;var Be=!0,Ce;for(Ce in pe){Be=!1;break}Be&&o.pop()}}}else if(128&oe)throw Error();P!==oe&&Dn(o,oe)}this.G=(A?0:-1)-p,this.h=void 0,this.o=o;e:{if(A=this.o.length,p=A-1,A&&(A=this.o[p],qs(A))){this.B=A,this.i=p-this.G;break e}c!==void 0&&-1<c?(this.i=Math.max(c,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!x&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){c=G&&!k&&!0,x=this.i;var xe;for(G=0;G<f.length;G++)k=f[G],k<x?(k+=this.G,(p=o[k])?Tp(p,c):o[k]=gs):(xe||(xe=he(this)),(p=xe[k])?Tp(p,c):xe[k]=gs)}}_n.prototype.toJSON=function(){return Zs(this.o,Wv,Vv)},_n.prototype.C=function(){return!!(St(this.o)&2)};function Tp(o,c){if(Array.isArray(o)){var f=St(o),p=1;!c||f&2||(p|=16),(f&p)!==p&&Dn(o,f|p)}}_n.prototype.ja=Ai,_n.prototype.toString=function(){return this.o.toString()};function Pp(o,c,f){if(f){var p={},x;for(x in f){var A=f[x],k=A.qa;k||(p.J=A.wa||A.oa.W,A.ia?(p.aa=Fp(A.ia),k=function(P){return function(G,oe,pe){return P.J(G,oe,pe,P.aa)}}(p)):A.ka?(p.Z=Op(A.da.P,A.ka),k=function(P){return function(G,oe,pe){return P.J(G,oe,pe,P.Z)}}(p)):k=p.J,A.qa=k),k(c,o,A.da),p={J:p.J,aa:p.aa,Z:p.Z}}}Si(c,o)}var Va=Symbol();function Ip(o,c,f){return o[Va]||(o[Va]=function(p,x){return c(p,x,f)})}function Rp(o){var c=o[Va];if(!c){var f=fc(o);c=function(p,x){return $p(p,x,f)},o[Va]=c}return c}function Yv(o){var c=o.ia;if(c)return Rp(c);if(c=o.va)return Ip(o.da.P,c,o.ka)}function Xv(o){var c=Yv(o),f=o.da,p=o.oa.U;return c?function(x,A){return p(x,A,f,c)}:function(x,A){return p(x,A,f)}}function Lp(o,c){var f=o[c];return typeof f=="function"&&f.length===0&&(f=f(),o[c]=f),Array.isArray(f)&&(Lo in f||Ro in f||0<f.length&&typeof f[0]=="function")?f:void 0}function Bp(o,c,f,p,x,A){c.P=o[0];var k=1;if(o.length>k&&typeof o[k]!="number"){var P=o[k++];f(c,P)}for(;k<o.length;){f=o[k++];for(var G=k+1;G<o.length&&typeof o[G]!="number";)G++;switch(P=o[k++],G-=k,G){case 0:p(c,f,P);break;case 1:(G=Lp(o,k))?(k++,x(c,f,P,G)):p(c,f,P,o[k++]);break;case 2:G=k++,G=Lp(o,G),x(c,f,P,G,o[k++]);break;case 3:A(c,f,P,o[k++],o[k++],o[k++]);break;case 4:A(c,f,P,o[k++],o[k++],o[k++],o[k++]);break;default:throw Error("unexpected number of binary field arguments: "+G)}}return c}var Ya=Symbol();function Fp(o){var c=o[Ya];if(!c){var f=dc(o);c=function(p,x){return Dp(p,x,f)},o[Ya]=c}return c}function Op(o,c){var f=o[Ya];return f||(f=function(p,x){return Pp(p,x,c)},o[Ya]=f),f}var Ro=Symbol();function Kv(o,c){o.push(c)}function Qv(o,c,f){o.push(c,f.W)}function Jv(o,c,f,p){var x=Fp(p),A=dc(p).P,k=f.W;o.push(c,function(P,G,oe){return k(P,G,oe,A,x)})}function qv(o,c,f,p,x,A){var k=Op(p,A),P=f.W;o.push(c,function(G,oe,pe){return P(G,oe,pe,p,k)})}function dc(o){var c=o[Ro];return c||(c=Bp(o,o[Ro]=[],Kv,Qv,Jv,qv),Lo in o&&Ro in o&&(o.length=0),c)}var Lo=Symbol();function Zv(o,c){o[0]=c}function e3(o,c,f,p){var x=f.U;o[c]=p?function(A,k,P){return x(A,k,P,p)}:x}function t3(o,c,f,p,x){var A=f.U,k=Rp(p),P=fc(p).P;o[c]=function(G,oe,pe){return A(G,oe,pe,P,k,x)}}function n3(o,c,f,p,x,A,k){var P=f.U,G=Ip(p,x,A);o[c]=function(oe,pe,Be){return P(oe,pe,Be,p,G,k)}}function fc(o){var c=o[Lo];return c||(c=Bp(o,o[Lo]={},Zv,e3,t3,n3),Lo in o&&Ro in o&&(o.length=0),c)}function $p(o,c,f){for(;Lr(c)&&c.i!=4;){var p=c.l,x=f[p];if(!x){var A=f[0];A&&(A=A[p])&&(x=f[p]=Xv(A))}if(!x||!x(c,o,p)){x=c,p=o,A=x.j,Br(x);var k=x;if(!k.ca){if(x=k.h.h-A,k.h.h=A,k=k.h,x==0)x=Ge();else{if(A=en(k,x),k.S&&k.m)x=k.i.subarray(A,A+x);else{k=k.i;var P=A;x=A+x,x=P===x?le():z?k.slice(P,x):new Uint8Array(k.subarray(P,x))}x=x.length==0?Ge():new De(x,R)}(A=p.R)?A.push(x):p.R=[x]}}}return o}function Dp(o,c,f){for(var p=f.length,x=p%2==1,A=x?1:0;A<p;A+=2)(0,f[A+1])(c,o,f[A]);Pp(o,c,x?f[0]:void 0)}function Bo(o,c){return{U:o,W:c}}var kr=Bo(function(o,c,f){if(o.i!==5)return!1;o=o.h;var p=o.i,x=o.h,A=p[x],k=p[x+1],P=p[x+2];return p=p[x+3],zt(o,o.h+4),k=(A<<0|k<<8|P<<16|p<<24)>>>0,o=2*(k>>31)+1,A=k>>>23&255,k&=8388607,ce(c,f,A==255?k?NaN:1/0*o:A==0?o*Math.pow(2,-149)*k:o*Math.pow(2,A-150)*(k+Math.pow(2,23))),!0},function(o,c,f){if(c=qe(c,f),c!=null){tn(o.h,8*f+5),o=o.h;var p=+c;p===0?0<1/p?J=de=0:(de=0,J=2147483648):isNaN(p)?(de=0,J=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(de=0,J=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),de=0,J=(f|p)>>>0):(c=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-c),p=Math.round(8388608*p),16777216<=p&&++c,de=0,J=(f|c+127<<23|p&8388607)>>>0)),f=J,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),r3=Bo(function(o,c,f){if(o.i!==0)return!1;var p=o.h,x=0,A=o=0,k=p.i,P=p.h;do{var G=k[P++];x|=(G&127)<<A,A+=7}while(32>A&&G&128);for(32<A&&(o|=(G&127)>>4),A=3;32>A&&G&128;A+=7)G=k[P++],o|=(G&127)<<A;if(zt(p,P),128>G)p=x>>>0,G=o>>>0,(o=G&2147483648)&&(p=~p+1>>>0,G=~G>>>0,p==0&&(G=G+1>>>0)),p=4294967296*G+(p>>>0);else throw W();return ce(c,f,o?-p:p),!0},function(o,c,f){c=te(c,f),c!=null&&(typeof c=="string"&&b(c),c!=null&&(tn(o.h,8*f),typeof c=="number"?(o=o.h,D(c),yn(o,J,de)):(f=b(c),yn(o.h,f.i,f.h))))}),s3=Bo(function(o,c,f){return o.i!==0?!1:(ce(c,f,Pt(o.h)),!0)},function(o,c,f){if(c=te(c,f),c!=null&&c!=null)if(tn(o.h,8*f),o=o.h,f=c,0<=f)tn(o,f);else{for(c=0;9>c;c++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),zp=Bo(function(o,c,f){if(o.i!==2)return!1;var p=Pt(o.h)>>>0;o=o.h;var x=en(o,p);if(o=o.i,tt){var A=o,k;(k=Oe)||(k=Oe=new TextDecoder("utf-8",{fatal:!0})),o=x+p,A=x===0&&o===A.length?A:A.subarray(x,o);try{var P=k.decode(A)}catch(Be){if(Ie===void 0){try{k.decode(new Uint8Array([128]))}catch{}try{k.decode(new Uint8Array([97])),Ie=!0}catch{Ie=!1}}throw!Ie&&(Oe=void 0),Be}}else{P=x,p=P+p,x=[];for(var G=null,oe,pe;P<p;)oe=o[P++],128>oe?x.push(oe):224>oe?P>=p?me():(pe=o[P++],194>oe||(pe&192)!==128?(P--,me()):x.push((oe&31)<<6|pe&63)):240>oe?P>=p-1?me():(pe=o[P++],(pe&192)!==128||oe===224&&160>pe||oe===237&&160<=pe||((A=o[P++])&192)!==128?(P--,me()):x.push((oe&15)<<12|(pe&63)<<6|A&63)):244>=oe?P>=p-2?me():(pe=o[P++],(pe&192)!==128||(oe<<28)+(pe-144)>>30||((A=o[P++])&192)!==128||((k=o[P++])&192)!==128?(P--,me()):(oe=(oe&7)<<18|(pe&63)<<12|(A&63)<<6|k&63,oe-=65536,x.push((oe>>10&1023)+55296,(oe&1023)+56320))):me(),8192<=x.length&&(G=be(G,x),x.length=0);P=be(G,x)}return ce(c,f,P),!0},function(o,c,f){if(c=te(c,f),c!=null){var p=!1;if(p=p===void 0?!1:p,lt){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(c))throw Error("Found an unpaired surrogate");c=(Qe||(Qe=new TextEncoder)).encode(c)}else{for(var x=0,A=new Uint8Array(3*c.length),k=0;k<c.length;k++){var P=c.charCodeAt(k);if(128>P)A[x++]=P;else{if(2048>P)A[x++]=P>>6|192;else{if(55296<=P&&57343>=P){if(56319>=P&&k<c.length){var G=c.charCodeAt(++k);if(56320<=G&&57343>=G){P=1024*(P-55296)+G-56320+65536,A[x++]=P>>18|240,A[x++]=P>>12&63|128,A[x++]=P>>6&63|128,A[x++]=P&63|128;continue}else k--}if(p)throw Error("Found an unpaired surrogate");P=65533}A[x++]=P>>12|224,A[x++]=P>>6&63|128}A[x++]=P&63|128}}c=x===A.length?A:A.subarray(0,x)}tn(o.h,8*f+2),tn(o.h,c.length),On(o,o.h.end()),On(o,c)}}),Up=Bo(function(o,c,f,p,x){if(o.i!==2)return!1;c=rr(c,f,p),f=o.h.j,p=Pt(o.h)>>>0;var A=o.h.h+p,k=A-f;if(0>=k&&(o.h.j=A,x(c,o,void 0,void 0,void 0),k=A-o.h.h),k)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-k)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=A,o.h.j=f,!0},function(o,c,f,p,x){if(c=We(c,p,f),c!=null)for(p=0;p<c.length;p++){var A=o;tn(A.h,8*f+2);var k=A.h.end();On(A,k),k.push(A.i),A=k,x(c[p],o),k=o;var P=A.pop();for(P=k.i+k.h.length()-P;127<P;)A.push(P&127|128),P>>>=7,k.i++;A.push(P),k.i++}});function hc(o){return function(c,f){e:{if(Fn.length){var p=Fn.pop();p.setOptions(f),ct(p.h,c,f),c=p}else c=new Qr(c,f);try{var x=fc(o),A=$p(new x.P,c,x);break e}finally{x=c.h,x.i=null,x.m=!1,x.l=0,x.j=0,x.h=0,x.S=!1,c.l=-1,c.i=-1,100>Fn.length&&Fn.push(c)}A=void 0}return A}}function pc(o){return function(){var c=new Ks;Dp(this,c,dc(o)),On(c,c.h.end());for(var f=new Uint8Array(c.i),p=c.j,x=p.length,A=0,k=0;k<x;k++){var P=p[k];f.set(P,A),A+=P.length}return c.j=[f],f}}function Ci(o){_n.call(this,o)}X(Ci,_n);var Hp=[Ci,1,s3,2,kr,3,zp,4,zp];Ci.prototype.l=pc(Hp);function mc(o){_n.call(this,o,-1,i3)}X(mc,_n),mc.prototype.addClassification=function(o,c){return rr(this,1,Ci,o,c),this};var i3=[1],Gp=hc([mc,1,Up,Hp]);function _i(o){_n.call(this,o)}X(_i,_n);var Wp=[_i,1,kr,2,kr,3,kr,4,kr,5,kr];_i.prototype.l=pc(Wp);function Vp(o){_n.call(this,o,-1,o3)}X(Vp,_n);var o3=[1],Yp=hc([Vp,1,Up,Wp]);function Xa(o){_n.call(this,o)}X(Xa,_n);var Xp=[Xa,1,kr,2,kr,3,kr,4,kr,5,kr,6,r3],a3=hc(Xp);Xa.prototype.l=pc(Xp);function Kp(o,c,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function Qp(o){return We(o,Ci,1).map(function(c){var f=te(c,1);return{index:f??0,score:sr(c,2),label:te(c,3)!=null?ln(te(c,3),""):void 0,displayName:te(c,4)!=null?ln(te(c,4),""):void 0}})}function Jp(o){return{x:sr(o,1),y:sr(o,2),z:sr(o,3),visibility:qe(o,4)!=null?sr(o,4):void 0}}function qp(o){return o.map(function(c){return We(Yp(c),_i,1).map(Jp)})}function gc(o,c){this.i=o,this.h=c,this.m=0}function Zp(o,c,f){return l3(o,c),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function l3(o,c){var f=o.h;if(o.s===void 0){var p=Kp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),x=Kp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),A=f.createProgram();if(f.attachShader(A,p),f.attachShader(A,x),f.linkProgram(A),!f.getProgramParameter(A,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(A));p=o.s=A,f.useProgram(p),x=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:x},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(x,0)}p=o.l,f.useProgram(o.s),f.canvas.width=c.width,f.canvas.height=c.height,f.viewport(0,0,c.width,c.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(c.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function u3(o){this.h=o}var c3=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function d3(o,c){return c+o}function em(o,c){window[o]=c}function f3(o){var c=document.createElement("script");return c.setAttribute("src",o),c.setAttribute("crossorigin","anonymous"),new Promise(function(f){c.addEventListener("load",function(){f()},!1),c.addEventListener("error",function(){f()},!1),document.body.appendChild(c)})}function h3(){return K(function(o){switch(o.h){case 1:return o.s=2,E(o,WebAssembly.instantiate(c3),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function yc(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||d3,typeof window=="object")var c=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")c=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=c,o.options){c=u(Object.keys(o.options));for(var f=c.next();!f.done;f=c.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=yc.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function p3(o){var c,f,p,x,A,k,P,G,oe,pe,Be;return K(function(Ce){switch(Ce.h){case 1:return o.ga?(c=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,E(Ce,h3(),2)):Ce.return();case 2:if(f=Ce.i,typeof window=="object")return em("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),em("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),k=c.filter(function(xe){return xe.data!==void 0}),P=c.filter(function(xe){return xe.data===void 0}),G=Promise.all(k.map(function(xe){var Fe=Ka(o,xe.url);if(xe.path!==void 0){var Ve=xe.path;Fe=Fe.then(function(yt){return o.overrideFile(Ve,yt),Promise.resolve(yt)})}return Fe})),oe=Promise.all(P.map(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f?f3(o.locateFile(xe.url,o.ha)):Promise.resolve()})).then(function(){var xe,Fe,Ve;return K(function(yt){if(yt.h==1)return xe=window.createMediapipeSolutionsWasm,Fe=window.createMediapipeSolutionsPackedAssets,Ve=o,E(yt,xe(Fe),2);Ve.i=yt.i,yt.h=0})}),pe=function(){return K(function(xe){return o.h.graph&&o.h.graph.url?xe=E(xe,Ka(o,o.h.graph.url),0):(xe.h=0,xe=void 0),xe})}(),E(Ce,Promise.all([oe,G,pe]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=c.filter(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f}).map(function(xe){return o.locateFile(xe.url,o.ha)}),importScripts.apply(null,d(p)),x=o,E(Ce,createMediapipeSolutionsWasm(Module),6);case 6:x.i=Ce.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,A=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(A),Ce.h=4;break;case 7:if(o.m=document.createElement("canvas"),Be=o.m.getContext("webgl2",{}),!Be&&(Be=o.m.getContext("webgl",{}),!Be))return alert("Failed to create WebGL canvas context when passing video frame."),Ce.return();o.K=Be,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,Ce.h=0}})}function m3(o){var c,f,p,x,A,k,P,G;return K(function(oe){if(oe.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return oe.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){oe.h=2;return}return o.fa=o.h.graph.url,E(oe,Ka(o,o.h.graph.url),3)}for(oe.h!=2&&(c=oe.i,o.j.loadGraph(c)),f=u(Object.keys(o.D)),p=f.next();!p.done;p=f.next())x=p.value,o.j.overrideFile(x,o.D[x]);if(o.D={},o.h.listeners)for(A=u(o.h.listeners),k=A.next();!k.done;k=A.next())P=k.value,w3(o,P);G=o.l,o.l={},o.setOptions(G),oe.h=0})}e.reset=function(){var o=this;return K(function(c){o.j&&(o.j.reset(),o.s={},o.v={}),c.h=0})},e.setOptions=function(o,c){var f=this;if(c=c||this.h.options){for(var p=[],x=[],A={},k=u(Object.keys(o)),P=k.next();!P.done;A={X:A.X,Y:A.Y},P=k.next())if(P=P.value,!(P in this.l&&this.l[P]===o[P])){this.l[P]=o[P];var G=c[P];G!==void 0&&(G.onChange&&(A.X=G.onChange,A.Y=o[P],p.push(function(oe){return function(){var pe;return K(function(Be){if(Be.h==1)return E(Be,oe.X(oe.Y),2);pe=Be.i,pe===!0&&(f.u=!0),Be.h=0})}}(A))),G.graphOptionXref&&(P=Object.assign({},{calculatorName:"",calculatorIndex:0},G.graphOptionXref,{valueNumber:G.type===1?o[P]:0,valueBoolean:G.type===0?o[P]:!1,valueString:G.type===2?o[P]:""}),x.push(P)))}(p.length!==0||x.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(x),this.F=(this.F===void 0?[]:this.F).concat(p))}};function g3(o){var c,f,p,x,A,k,P;return K(function(G){switch(G.h){case 1:if(!o.u)return G.return();if(!o.F){G.h=2;break}c=u(o.F),f=c.next();case 3:if(f.done){G.h=5;break}return p=f.value,E(G,p(),4);case 4:f=c.next(),G.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(x=new o.i.GraphOptionChangeRequestList,A=u(o.H),k=A.next();!k.done;k=A.next())P=k.value,x.push_back(P);o.j.changeOptions(x),x.delete(),o.H=void 0}o.u=!1,G.h=0}})}e.initialize=function(){var o=this;return K(function(c){return c.h==1?E(c,p3(o),2):c.h!=3?E(c,m3(o),3):E(c,g3(o),0)})};function Ka(o,c){var f,p;return K(function(x){return c in o.L?x.return(o.L[c]):(f=o.locateFile(c,""),p=fetch(f).then(function(A){return A.arrayBuffer()}),o.L[c]=p,x.return(p))})}e.overrideFile=function(o,c){this.j?this.j.overrideFile(o,c):this.D[o]=c},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,c){var f=this,p,x,A,k,P,G,oe,pe,Be;return K(function(Ce){switch(Ce.h){case 1:return f.h.inputs?(p=1e3*(c??performance.now()),E(Ce,f.I,2)):Ce.return();case 2:return E(Ce,f.initialize(),3);case 3:for(x=new f.i.PacketDataList,A=u(Object.keys(o)),k=A.next();!k.done;k=A.next())if(P=k.value,G=f.h.inputs[P]){e:{var xe=o[P];switch(G.type){case"video":var Fe=f.s[G.stream];if(Fe||(Fe=new gc(f.i,f.K),f.s[G.stream]=Fe),Fe.m===0&&(Fe.m=Fe.i.createTexture()),typeof HTMLVideoElement<"u"&&xe instanceof HTMLVideoElement)var Ve=xe.videoWidth,yt=xe.videoHeight;else typeof HTMLImageElement<"u"&&xe instanceof HTMLImageElement?(Ve=xe.naturalWidth,yt=xe.naturalHeight):(Ve=xe.width,yt=xe.height);yt={glName:Fe.m,width:Ve,height:yt},Ve=Fe.h,Ve.canvas.width=yt.width,Ve.canvas.height=yt.height,Ve.activeTexture(Ve.TEXTURE0),Fe.i.bindTexture2d(Fe.m),Ve.texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,Ve.RGBA,Ve.UNSIGNED_BYTE,xe),Fe.i.bindTexture2d(0),Fe=yt;break e;case"detections":for(Fe=f.s[G.stream],Fe||(Fe=new u3(f.i),f.s[G.stream]=Fe),Fe.data||(Fe.data=new Fe.h.DetectionListData),Fe.data.reset(xe.length),yt=0;yt<xe.length;++yt){Ve=xe[yt];var ht=Fe.data,nn=ht.setBoundingBox,ir=yt,jn=Ve.la,nt=new Xa;if(dt(nt,1,jn.ra),dt(nt,2,jn.sa),dt(nt,3,jn.height),dt(nt,4,jn.width),dt(nt,5,jn.rotation),ce(nt,6,jn.pa),jn=nt.l(),nn.call(ht,ir,jn),Ve.ea)for(ht=0;ht<Ve.ea.length;++ht){nt=Ve.ea[ht],nn=Fe.data,ir=nn.addNormalizedLandmark,jn=yt,nt=Object.assign({},nt,{visibility:nt.visibility?nt.visibility:0});var rn=new _i;dt(rn,1,nt.x),dt(rn,2,nt.y),dt(rn,3,nt.z),nt.visibility&&dt(rn,4,nt.visibility),nt=rn.l(),ir.call(nn,jn,nt)}if(Ve.ba)for(ht=0;ht<Ve.ba.length;++ht)nn=Fe.data,ir=nn.addClassification,jn=yt,nt=Ve.ba[ht],rn=new Ci,dt(rn,2,nt.score),nt.index&&ce(rn,1,nt.index),nt.label&&ce(rn,3,nt.label),nt.displayName&&ce(rn,4,nt.displayName),nt=rn.l(),ir.call(nn,jn,nt)}Fe=Fe.data;break e;default:Fe={}}}switch(oe=Fe,pe=G.stream,G.type){case"video":x.pushTexture2d(Object.assign({},oe,{stream:pe,timestamp:p}));break;case"detections":Be=oe,Be.stream=pe,Be.timestamp=p,x.pushDetectionList(Be);break;default:throw Error("Unknown input config type: '"+G.type+"'")}}return f.j.send(x),E(Ce,f.I,4);case 4:x.delete(),Ce.h=0}})};function y3(o,c,f){var p,x,A,k,P,G,oe,pe,Be,Ce,xe,Fe,Ve,yt;return K(function(ht){switch(ht.h){case 1:if(!f)return ht.return(c);for(p={},x=0,A=u(Object.keys(f)),k=A.next();!k.done;k=A.next())P=k.value,G=f[P],typeof G!="string"&&G.type==="texture"&&c[G.stream]!==void 0&&++x;1<x&&(o.M=!1),oe=u(Object.keys(f)),k=oe.next();case 2:if(k.done){ht.h=4;break}if(pe=k.value,Be=f[pe],typeof Be=="string")return Ve=p,yt=pe,E(ht,v3(o,pe,c[Be]),14);if(Ce=c[Be.stream],Be.type==="detection_list"){if(Ce){for(var nn=Ce.getRectList(),ir=Ce.getLandmarksList(),jn=Ce.getClassificationsList(),nt=[],rn=0;rn<nn.size();++rn){var ys=a3(nn.get(rn)),x3=sr(ys,1),S3=sr(ys,2),k3=sr(ys,3),A3=sr(ys,4),E3=sr(ys,5,0),Qa=void 0;Qa=Qa===void 0?0:Qa,ys={la:{ra:x3,sa:S3,height:k3,width:A3,rotation:E3,pa:ln(te(ys,6),Qa)},ea:We(Yp(ir.get(rn)),_i,1).map(Jp),ba:Qp(Gp(jn.get(rn)))},nt.push(ys)}nn=nt}else nn=[];p[pe]=nn,ht.h=7;break}if(Be.type==="proto_list"){if(Ce){for(nn=Array(Ce.size()),ir=0;ir<Ce.size();ir++)nn[ir]=Ce.get(ir);Ce.delete()}else nn=[];p[pe]=nn,ht.h=7;break}if(Ce===void 0){ht.h=3;break}if(Be.type==="float_list"){p[pe]=Ce,ht.h=7;break}if(Be.type==="proto"){p[pe]=Ce,ht.h=7;break}if(Be.type!=="texture")throw Error("Unknown output config type: '"+Be.type+"'");return xe=o.v[pe],xe||(xe=new gc(o.i,o.K),o.v[pe]=xe),E(ht,Zp(xe,Ce,o.M),13);case 13:Fe=ht.i,p[pe]=Fe;case 7:Be.transform&&p[pe]&&(p[pe]=Be.transform(p[pe])),ht.h=3;break;case 14:Ve[yt]=ht.i;case 3:k=oe.next(),ht.h=2;break;case 4:return ht.return(p)}})}function v3(o,c,f){var p;return K(function(x){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?x.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[c],p||(p=new gc(o.i,o.K),o.v[c]=p),x.return(Zp(p,f,o.M))):x.return(void 0)})}function w3(o,c){for(var f=c.name||"$",p=[].concat(d(c.wants)),x=new o.i.StringList,A=u(c.wants),k=A.next();!k.done;k=A.next())x.push_back(k.value);A=o.i.PacketListener.implement({onResults:function(P){for(var G={},oe=0;oe<c.wants.length;++oe)G[p[oe]]=P.get(oe);var pe=o.listeners[f];pe&&(o.I=y3(o,G,c.outs).then(function(Be){Be=pe(Be);for(var Ce=0;Ce<c.wants.length;++Ce){var xe=G[p[Ce]];typeof xe=="object"&&xe.hasOwnProperty&&xe.hasOwnProperty("delete")&&xe.delete()}Be&&(o.I=Be)}))}}),o.j.attachMultiListener(x,A),x.delete()}e.onResults=function(o,c){this.listeners[c||"$"]=o},ve("Solution",yc),ve("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function tm(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function nm(o){var c=this;o=o||{},this.h=new yc({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:tm(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:qp},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:qp},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return Qp(Gp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,x,A;return K(function(k){return k.h==1?(p=tm(f),x="third_party/mediapipe/modules/hand_landmark/"+p,E(k,Ka(c.h,p),2)):(A=k.i,c.h.overrideFile(x,A),k.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=nm.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return K(function(c){return E(c,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var c=this;return K(function(f){return E(f,c.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},ve("Hands",nm),ve("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),ve("VERSION","0.4.1675469240")}).call(vc);const zn=(...e)=>{},Or={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},It={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function y1({hidden:e=!1}){const t=j.useRef(null),n=j.useRef(null),r=j.useRef(null),s=j.useRef(null),[i,a]=j.useState(!1),[u,d]=j.useState("None"),[h,m]=j.useState([]),[w,S]=j.useState(null),[_,L]=j.useState(null),[F,X]=j.useState(null),[C,g]=j.useState({a:null,b:null}),v=j.useRef(null),E=j.useRef(null),N=(D,y)=>{const I=localStorage.getItem(D);if(I===null)return y;const M=parseFloat(I);return Number.isFinite(M)?M:y},[T,$]=j.useState(()=>({roiSize:(()=>{const D=N(It.roiSize,44);return D>10?D:44})(),hueWeight:N(It.hueWeight,4),satWeight:N(It.satWeight,2),valWeight:N(It.valWeight,1),sensitivity:N(It.sensitivity,0)})),H=j.useRef(T),q=j.useRef(null),V=j.useRef(!1),K=j.useRef(0),ne=j.useRef(null),[ee,ie]=j.useState([]),ve=j.useRef([]),[we,Te]=j.useState(()=>localStorage.getItem(It.selectedCamera)||""),se=j.useCallback(async()=>{try{const y=(await navigator.mediaDevices.enumerateDevices()).filter(I=>I.kind==="videoinput");return ie(y),ve.current=y,y}catch{return[]}},[]),Z=j.useCallback(D=>{},[zn]),re=j.useCallback(async(D=null)=>{const y=t.current;if(!y)return;q.current&&(q.current.getTracks().forEach(b=>b.stop()),q.current=null),R();const I=++K.current;ne.current=null;const M=D!==null?D:we;try{const b=M?{video:{deviceId:{exact:M}}}:{video:!0};if(M){const W=ve.current.find(ue=>ue.deviceId===M);console.log("[Detector]  Loading SELECTED camera:",{deviceId:M,label:(W==null?void 0:W.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const B=await navigator.mediaDevices.getUserMedia(b);if(!V.current||I!==K.current){zn("Stale camera request (unmounted or superseded). Stopping stream."),B.getTracks().forEach(W=>W.stop());return}q.current=B;const U=B.getVideoTracks();if(zn("getUserMedia success. Tracks:",U),U.length>0){const W=U[0];console.log("[Detector]  Camera loaded successfully:",{label:W.label,deviceId:W.getSettings().deviceId,resolution:`${W.getSettings().width}x${W.getSettings().height}`,frameRate:W.getSettings().frameRate})}if(y.srcObject=B,await new Promise(W=>{if(y.readyState>=1&&y.videoWidth>0&&y.videoHeight>0)return W();const me=()=>{y.removeEventListener("loadedmetadata",me),W()};y.addEventListener("loadedmetadata",me,{once:!0}),setTimeout(()=>{y.removeEventListener("loadedmetadata",me),W()},1500)}),!V.current||I!==K.current){zn("Stale request before play(). Stopping stream."),B.getTracks().forEach(W=>W.stop());return}try{await y.play(),zn("video.play() promise resolved. Video should be playing.")}catch(W){if(console.error("[Detector] video.play() promise rejected:",W),zn("video.play() promise rejected:",W.name,W.message),I!==K.current){zn("play() aborted due to newer request."),B.getTracks().forEach(ue=>ue.stop());return}}if(ne.current!==I&&(ne.current=I,zn("Initializing MediaPipe for request id",I),Ne()),V.current){const W=await se();if(!M||!D){const ue=W.find(me=>me.deviceId);ue&&ue.deviceId&&ue.deviceId!==we&&(Te(ue.deviceId),localStorage.setItem(It.selectedCamera,ue.deviceId))}}}catch(b){console.error("[Detector] Error accessing camera:",b),zn("getUserMedia error:",b.name,b.message)}},[zn,se,Z,we]),ge=(D,y,I)=>{const M=(D||0)*2,b=(y||0)/255,B=(I||0)/255,U=B*b,W=U*(1-Math.abs(M/60%2-1)),ue=B-U;let me=0,be=0,Ie=0;M>=0&&M<60?(me=U,be=W,Ie=0):M<120?(me=W,be=U,Ie=0):M<180?(me=0,be=U,Ie=W):M<240?(me=0,be=W,Ie=U):M<300?(me=W,be=0,Ie=U):(me=U,be=0,Ie=W);const Oe=Math.round((me+ue)*255),tt=Math.round((be+ue)*255),Qe=Math.round((Ie+ue)*255);return`rgb(${Oe}, ${tt}, ${Qe})`},Me=D=>D?ge(D.h,D.s,D.v):"#ffffff",Ue=D=>D==="Player A"&&_?Me(_):D==="Player B"&&F?Me(F):D==="Red"?"#ff0000":D==="Blue"?"#0000ff":"#ffffff";j.useEffect(()=>{V.current=!0;const D=()=>{try{const M=JSON.parse(localStorage.getItem("calibrationA")||"null"),b=JSON.parse(localStorage.getItem("calibrationB")||"null");M&&L({h:M.h,s:M.s,v:M.v}),b&&X({h:b.h,s:b.s,v:b.v})}catch{}},y=M=>{!M||!M.key||(["calibrationA","calibrationB"].includes(M.key)&&D(),[It.roiSize,It.hueWeight,It.satWeight,It.valWeight,It.sensitivity].includes(M.key)&&$(b=>({roiSize:(()=>{const B=N(It.roiSize,(b==null?void 0:b.roiSize)??44);return B>10?B:(b==null?void 0:b.roiSize)??44})(),hueWeight:N(It.hueWeight,(b==null?void 0:b.hueWeight)??4),satWeight:N(It.satWeight,(b==null?void 0:b.satWeight)??2),valWeight:N(It.valWeight,(b==null?void 0:b.valWeight)??1),sensitivity:N(It.sensitivity,(b==null?void 0:b.sensitivity)??0)})))};return(async()=>{const M=await se();if(!V.current)return;const b=localStorage.getItem(It.selectedCamera);let B="";if(b&&M.some(U=>U.deviceId&&U.deviceId===b)){const U=M.find(W=>W.deviceId===b);B=b,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:b,label:(U==null?void 0:U.label)||"Unknown"})}else{b&&localStorage.removeItem(It.selectedCamera);const U=M.find(W=>W.deviceId);U&&U.deviceId?(B=U.deviceId,localStorage.setItem(It.selectedCamera,U.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:U.deviceId,label:U.label||"Unknown",savedCameraWas:b||"none"}),zn("Saved camera not found, using default camera:",U.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}Te(B?U=>U===B?U:B:U=>U||""),D()})(),window.addEventListener("storage",y),()=>{V.current=!1,K.current+=1,ne.current=null,s.current&&(s.current.stop(),s.current=null),q.current&&(q.current.getTracks().forEach(b=>b.stop()),q.current=null);const M=t.current;M&&(M.srcObject=null,Z(M)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",y)}},[]),j.useEffect(()=>{v.current=_},[_]),j.useEffect(()=>{E.current=F},[F]),j.useEffect(()=>{H.current=T},[T]),j.useEffect(()=>{re(we||null)},[we,re]),j.useEffect(()=>{const D=setInterval(()=>{d(y=>($e(y),y))},1e3);return()=>clearInterval(D)},[]);const $e=D=>{const I={timestamp:new Date().toISOString(),status:D};m(b=>[...b,I]);const M=JSON.parse(localStorage.getItem("braceletDetections")||"[]");M.push(I),localStorage.setItem("braceletDetections",JSON.stringify(M))},Ne=async()=>{try{const D=await(async()=>{try{if(typeof au.Hands=="function")return au.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((I,M)=>{const b="mp-hands-cdn-script";if(document.getElementById(b))return I();const B=document.createElement("script");B.id=b,B.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",B.async=!0,B.onload=()=>I(),B.onerror=U=>M(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(B)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),y=new D({locateFile:I=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${I}`});if(y.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),y.onResults(ze),r.current=y,t.current){const I=t.current;console.log("[Detector]  Starting manual frame capture from video element");let M;const b=async()=>{if(I.readyState>=2&&I.videoWidth>0)try{await y.send({image:I})}catch(B){console.error("[Detector] Error sending frame to MediaPipe:",B)}M=requestAnimationFrame(b)};b(),s.current={stop:()=>{M&&(cancelAnimationFrame(M),console.log("[Detector]  Stopped frame capture"))}}}}catch(D){console.error("MediaPipe initialization error:",D),S(`MediaPipe error: ${D.message}`)}},ze=D=>{var U;const y=n.current,I=t.current;if(!y||!I)return;const M=y.getContext("2d");y.width=I.videoWidth,y.height=I.videoHeight,M.drawImage(I,0,0,y.width,y.height);let b="None";if(D.multiHandLandmarks&&D.multiHandLandmarks.length>0){zn("onResults: hands=",D.multiHandLandmarks.length);let W=null,ue=0;if(D.multiHandLandmarks.forEach(me=>{const be=me[0];be.y>ue&&(ue=be.y,W=me)}),D.multiHandLandmarks.forEach(me=>{Y(M,me,y.width,y.height)}),W){const me=W[0],be=me.x*y.width,Ie=me.y*y.height;M.fillStyle="lime",M.beginPath(),M.arc(be,Ie,10,0,2*Math.PI),M.fill(),M.fillStyle="lime",M.font="16px Arial",M.fillText("SELECTED",be-40,Ie-15);const tt=Math.max(10,Math.min(300,Math.floor(((U=H.current)==null?void 0:U.roiSize)||60)))/2,Qe=Math.max(0,be-tt),lt=Math.max(0,Ie-tt),ut=Math.min(y.width,be+tt),He=Math.min(y.height,Ie+tt);M.strokeStyle="lime",M.lineWidth=3,M.strokeRect(Qe,lt,ut-Qe,He-lt);const De=ut-Qe,Ge=He-lt;if(De>0&&Ge>0)try{const Je=M.getImageData(Qe,lt,De,Ge),_t=v.current,Bn=E.current,ct=ye(Je,_t,Bn);b=ct.status,g({a:ct.percentA,b:ct.percentB}),zn("Detection result:",b,{roi:{x1:Qe,y1:lt,w:De,h:Ge}})}catch(Je){console.warn("[Detector] Failed to get ROI image data:",Je.message),b="None",g({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:De,height:Ge}),b="None",g({a:null,b:null})}}let B="#ffffff";b==="Player A"&&v.current?B=Me(v.current):b==="Player B"&&E.current&&(B=Me(E.current)),M.fillStyle=B,M.font="bold 32px Arial",M.fillText(`Status: ${b}`,10,40),d(b),typeof window<"u"&&(window.currentBraceletStatus=b,window.braceletDetectorCanvas=y,window.braceletDetectorVideo=I)},Y=(D,y,I,M)=>{D.strokeStyle="white",D.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([B,U])=>{const W=y[B],ue=y[U];D.beginPath(),D.moveTo(W.x*I,W.y*M),D.lineTo(ue.x*I,ue.y*M),D.stroke()}),y.forEach(B=>{D.fillStyle="red",D.beginPath(),D.arc(B.x*I,B.y*M,5,0,2*Math.PI),D.fill()})},Q=D=>{const y=D.data;let I=0,M=0;for(let b=0;b<y.length;b+=4){const B=y[b],U=y[b+1],W=y[b+2],ue=le(B,U,W);(ue[0]>=Or.red.lower1[0]&&ue[0]<=Or.red.upper1[0]||ue[0]>=Or.red.lower2[0]&&ue[0]<=Or.red.upper2[0])&&ue[1]>=Or.red.lower1[1]&&ue[2]>=Or.red.lower1[2]&&I++,ue[0]>=Or.blue.lower[0]&&ue[0]<=Or.blue.upper[0]&&ue[1]>=Or.blue.lower[1]&&ue[2]>=Or.blue.lower[2]&&M++}return{redCount:I,blueCount:M}},ye=(D,y,I)=>{var tt,Qe,lt,ut;const M=D.data;if(y&&!I)return{status:"Player A",percentA:null,percentB:null};if(I&&!y)return{status:"Player B",percentA:null,percentB:null};const b=((tt=H.current)==null?void 0:tt.hueWeight)??4,B=((Qe=H.current)==null?void 0:Qe.satWeight)??2,U=((lt=H.current)==null?void 0:lt.valWeight)??1,W=((ut=H.current)==null?void 0:ut.sensitivity)??0;if(y&&I){let He=0,De=0,Ge=0;for(let ct=0;ct<M.length;ct+=4){const zt=M[ct],Pt=M[ct+1],en=M[ct+2],[mn,gn,yn]=le(zt,Pt,en),tn=Math.min(1,Math.max(0,gn/255)),Qr=Math.min(1,Math.max(0,yn/255)),Lr=Math.max(.05,.5*tn+.5*Qr),Br=Math.min(Math.abs(mn-y.h),180-Math.abs(mn-y.h)),Fn=Math.min(Math.abs(mn-I.h),180-Math.abs(mn-I.h)),Ks=Math.abs(gn-y.s),On=Math.abs(gn-I.s),Si=Math.abs(yn-y.v),$n=Math.abs(yn-I.v),nr=Br*b+Ks*B+Si*U,Qs=Fn*b+On*B+$n*U;Math.min(nr,Qs)>180||(nr<=Qs?He+=Lr:De+=Lr,Ge+=Lr)}if(Ge===0)return{status:"None",percentA:0,percentB:0};const Je=He/Math.max(1e-6,Ge),_t=De/Math.max(1e-6,Ge),Bn=.12*(1+.8*Math.max(0,Math.min(1,W)));return Je>=Bn&&Je>=_t?{status:"Player A",percentA:Je,percentB:_t}:_t>=Bn&&_t>Je?{status:"Player B",percentA:Je,percentB:_t}:{status:"None",percentA:Je,percentB:_t}}const{redCount:ue,blueCount:me}=Q(D),be=ue+me;if(be===0)return{status:"None",percentA:0,percentB:0};const Ie=ue/be,Oe=me/be;return Ie>=.15&&Ie>=Oe?{status:"Player A",percentA:Ie,percentB:Oe}:Oe>=.15&&Oe>Ie?{status:"Player B",percentA:Ie,percentB:Oe}:{status:"None",percentA:Ie,percentB:Oe}},le=(D,y,I)=>{D/=255,y/=255,I/=255;const M=Math.max(D,y,I),b=Math.min(D,y,I),B=M-b;let U=0;B!==0&&(M===D?U=60*((y-I)/B%6):M===y?U=60*((I-D)/B+2):U=60*((D-y)/B+4)),U<0&&(U+=360);const W=M===0?0:B/M*255,ue=M*255;return[U/2,W,ue]},R=D=>{},z=D=>{Te(D),D?localStorage.setItem(It.selectedCamera,D):localStorage.removeItem(It.selectedCamera)},J=()=>{const D=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),y=new Blob([JSON.stringify(D,null,2)],{type:"application/json"}),I=URL.createObjectURL(y),M=document.createElement("a");M.href=I,M.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,M.click();const b=D.map(ue=>`${ue.timestamp}: ${ue.status}`).join(`
`),B=new Blob([b],{type:"text/plain"}),U=URL.createObjectURL(B),W=document.createElement("a");W.href=U,W.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,W.click()},de=()=>{localStorage.removeItem("braceletDetections"),m([])};return l.jsx(l.Fragment,{children:l.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:J,title:"Download Logs",children:""}),l.jsx("button",{onClick:de,title:"Clear Logs",children:""}),l.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),l.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{children:"Camera:"}),l.jsxs("select",{value:we,onChange:D=>z(D.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[l.jsx("option",{value:"",children:"System Default"}),ee.map((D,y)=>{var W;const I=!!D.deviceId,M=I?D.deviceId:"",b=I?D.deviceId:`camera-${y}`,B=((W=D.label)==null?void 0:W.trim())||`Camera ${y+1}`,U=I?`  ${D.deviceId.slice(0,8)}`:" (needs permission)";return l.jsxs("option",{value:M,disabled:!I,children:[B,U]},b)})]})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),l.jsx("canvas",{ref:n,className:"output_canvas"}),l.jsxs("div",{className:"detector-info",children:[l.jsxs("div",{className:"status-display",children:["Status: ",l.jsx("span",{style:{color:Ue(u),fontWeight:700},children:u})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:_?Me(_):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:C.a==null?"":`${Math.round(Math.max(0,Math.min(1,C.a))*100)}%`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:F?Me(F):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:C.b==null?"":`${Math.round(Math.max(0,Math.min(1,C.b))*100)}%`})]})]}),l.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",_?`h${Math.round(_.h)} s${Math.round(_.s)} v${Math.round(_.v)}`:""]}),l.jsxs("div",{children:["B: ",F?`h${Math.round(F.h)} s${Math.round(F.s)} v${Math.round(F.v)}`:""]})]})]})]})]})})}const Yc=(...e)=>{console.log("[Calibrate]",...e)},$r={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},cx=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,u=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,m=0,w=0;r>=0&&r<60?(h=a,m=u,w=0):r<120?(h=u,m=a,w=0):r<180?(h=0,m=a,w=u):r<240?(h=0,m=u,w=a):r<300?(h=u,m=0,w=a):(h=a,m=0,w=u);const S=Math.round((h+d)*255),_=Math.round((m+d)*255),L=Math.round((w+d)*255);return`rgb(${S}, ${_}, ${L})`},v1=e=>e?cx(e.h,e.s,e.v):"#444";function dx(){const e=j.useRef(null),t=j.useRef(null),n=j.useRef(null),r=j.useRef(!1),s=j.useRef(0),[i,a]=j.useState(!1),[u,d]=j.useState(""),[h,m]=j.useState(null),[w,S]=j.useState(null),_=(Y,Q)=>{const ye=localStorage.getItem(Y);if(ye===null)return Q;const le=parseFloat(ye);return Number.isFinite(le)?le:Q},[L,F]=j.useState(()=>{const Y=_($r.roiSize,44);return Y>10?Y:44}),[X,C]=j.useState(()=>_($r.hueWeight,4)),[g,v]=j.useState(()=>_($r.satWeight,2)),[E,N]=j.useState(()=>_($r.valWeight,1)),[T,$]=j.useState(()=>_($r.sensitivity,0)),[H,q]=j.useState(!1),[V,K]=j.useState("idle"),[ne,ee]=j.useState(5),ie=j.useRef({A:[],B:[]});j.useEffect(()=>{r.current=!0;try{const Y=JSON.parse(localStorage.getItem("calibrationA")||"null"),Q=JSON.parse(localStorage.getItem("calibrationB")||"null");Y&&m(Y),Q&&S(Q)}catch{}return(async()=>await ve())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(Q=>Q.stop()),n.current=null);const Y=e.current;Y&&(Y.srcObject=null)}},[]),j.useEffect(()=>{localStorage.setItem($r.roiSize,String(L))},[L]),j.useEffect(()=>{localStorage.setItem($r.hueWeight,String(X))},[X]),j.useEffect(()=>{localStorage.setItem($r.satWeight,String(g))},[g]),j.useEffect(()=>{localStorage.setItem($r.valWeight,String(E))},[E]),j.useEffect(()=>{localStorage.setItem($r.sensitivity,String(T))},[T]);const ve=j.useCallback(async()=>{const Y=e.current;if(!Y)return;n.current&&(n.current.getTracks().forEach(ye=>ye.stop()),n.current=null);const Q=++s.current;a(!1),d("Requesting camera...");try{const ye=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||Q!==s.current){ye.getTracks().forEach(le=>le.stop());return}if(n.current=ye,Y.srcObject=ye,await new Promise(le=>{if(Y.readyState>=1&&Y.videoWidth>0)return le();const z=()=>{Y.removeEventListener("loadedmetadata",z),le()};Y.addEventListener("loadedmetadata",z,{once:!0}),setTimeout(()=>{Y.removeEventListener("loadedmetadata",z),le()},1500)}),!r.current||Q!==s.current){ye.getTracks().forEach(le=>le.stop());return}try{await Y.play(),Yc("video.play resolved")}catch(le){Yc("video.play rejected",le)}a(!0),d("")}catch(ye){d(`Camera error: ${(ye==null?void 0:ye.message)||ye}`),Yc("getUserMedia error",ye)}},[]),we=(Y,Q,ye)=>{Y/=255,Q/=255,ye/=255;const le=Math.max(Y,Q,ye),R=Math.min(Y,Q,ye),z=le-R;let J=0;z!==0&&(le===Y?J=60*((Q-ye)/z%6):le===Q?J=60*((ye-Y)/z+2):J=60*((Y-Q)/z+4)),J<0&&(J+=360);const de=le===0?0:z/le*255,D=le*255;return[J/2,de,D]},Te=()=>{const Y=e.current,Q=t.current;if(!Y||!Q||Y.videoWidth===0)return null;const ye=Y.videoWidth,le=Y.videoHeight;Q.width=ye,Q.height=le;const R=Q.getContext("2d");R.drawImage(Y,0,0,ye,le);const z=Math.max(10,Math.min(300,Math.floor(L))),J=Math.floor(ye/2-z/2),de=Math.floor(le/2-z/2),y=R.getImageData(J,de,z,z).data;let I=0,M=0,b=0,B=0,U=0;for(let Qe=0;Qe<y.length;Qe+=4){const[lt,ut,He]=we(y[Qe],y[Qe+1],y[Qe+2]),De=lt*2*(Math.PI/180);I+=Math.cos(De),M+=Math.sin(De),b+=ut,B+=He,U++}if(U===0)return null;const W=b/U,ue=B/U,me=I/U,be=M/U;let Oe=Math.atan2(be,me)*(180/Math.PI);return Oe<0&&(Oe+=360),{h:Oe/2,s:W,v:ue}},se=Y=>{const Q=Te();if(!Q){d("Could not sample video frame.");return}Y==="A"?(localStorage.setItem("calibrationA",JSON.stringify(Q)),m(Q),d(`Saved Player A: h${Q.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(Q)),S(Q),d(`Saved Player B: h${Q.h.toFixed(0)}`))},Z=Y=>{Y==="A"?(localStorage.removeItem("calibrationA"),m(null)):(localStorage.removeItem("calibrationB"),S(null)),d("Cleared")},re=()=>{q(!0),K("playerA"),ee(5),ie.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};j.useEffect(()=>{if(!(!H||V==="idle"||V==="optimizing"||V==="complete"))if(ne>0){const Y=setTimeout(()=>{ee(ne-1)},1e3);return()=>clearTimeout(Y)}else V==="playerA"?(K("switching"),ee(3),d("Switch to Player B... Get ready!")):V==="switching"?(K("playerB"),ee(5),d("Hold Player B bracelet in center square...")):V==="playerB"&&(K("optimizing"),ge())},[H,V,ne]),j.useEffect(()=>{if(!H||V==="idle"||V==="switching"||V==="optimizing"||V==="complete")return;const Y=setInterval(()=>{const Q=Te();Q&&(V==="playerA"?ie.current.A.push(Q):V==="playerB"&&ie.current.B.push(Q))},200);return()=>clearInterval(Y)},[H,V]);const ge=()=>{d("Optimizing parameters...");const Y=ie.current.A,Q=ie.current.B;if(Y.length===0||Q.length===0){d("Error: Not enough samples collected!"),q(!1),K("idle");return}const ye=Me(Y),le=Me(Q),R=Math.min(Math.abs(ye.h-le.h),180-Math.abs(ye.h-le.h)),z=Math.abs(ye.s-le.s),J=Math.abs(ye.v-le.v),de=R/90,D=z/255,y=J/255,I=Ue(Y),M=Ue(Q),b={h:(I.h+M.h)/2,s:(I.s+M.s)/2,v:(I.v+M.v)/2},B=de+D+y,U=B>0?de/B*(1/(1+b.h/20))*6:2,W=B>0?D/B*(1/(1+b.s/50))*4:1,ue=B>0?y/B*(1/(1+b.v/50))*3:.5;C(Math.max(.5,Math.min(6,U))),v(Math.max(.1,Math.min(4,W))),N(Math.max(.1,Math.min(3,ue)));const me=$e(Y,Q,ye,le),be=Math.max(0,Math.min(.8,me*.5));$(be),localStorage.setItem("calibrationA",JSON.stringify(ye)),localStorage.setItem("calibrationB",JSON.stringify(le)),m(ye),S(le),K("complete"),d(` Auto-calibration complete! Collected ${Y.length+Q.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{q(!1),K("idle")},3e3)},Me=Y=>{const Q=Y.map(M=>M.h),ye=Y.map(M=>M.s).sort((M,b)=>M-b),le=Y.map(M=>M.v).sort((M,b)=>M-b);let R=0,z=0;Q.forEach(M=>{const b=M*2*(Math.PI/180);R+=Math.cos(b),z+=Math.sin(b)});let de=Math.atan2(z/Q.length,R/Q.length)*(180/Math.PI);de<0&&(de+=360);const D=de/2,y=ye[Math.floor(ye.length/2)],I=le[Math.floor(le.length/2)];return{h:D,s:y,v:I}},Ue=Y=>{const Q=Y.reduce((le,R)=>({h:le.h+R.h,s:le.s+R.s,v:le.v+R.v}),{h:0,s:0,v:0});Q.h/=Y.length,Q.s/=Y.length,Q.v/=Y.length;const ye=Y.reduce((le,R)=>({h:le.h+Math.pow(R.h-Q.h,2),s:le.s+Math.pow(R.s-Q.s,2),v:le.v+Math.pow(R.v-Q.v,2)}),{h:0,s:0,v:0});return{h:ye.h/Y.length,s:ye.s/Y.length,v:ye.v/Y.length}},$e=(Y,Q,ye,le)=>{let R=0;const z=Math.min(Y.length,Q.length)*2;return Y.forEach(J=>{const de=Ne(J,ye);Ne(J,le)<de*1.5&&R++}),Q.forEach(J=>{const de=Ne(J,ye),D=Ne(J,le);de<D*1.5&&R++}),R/z},Ne=(Y,Q)=>{const ye=Math.min(Math.abs(Y.h-Q.h),180-Math.abs(Y.h-Q.h)),le=Math.abs(Y.s-Q.s),R=Math.abs(Y.v-Q.v);return Math.sqrt(ye*ye+le*le+R*R)},ze=()=>{q(!1),K("idle"),ee(5),d("Generic mode cancelled")};return l.jsxs("div",{className:"calib-root",children:[l.jsxs("div",{className:"calib-header",children:[l.jsx("h2",{children:"Color Calibration"}),l.jsxs("div",{className:"calib-actions",children:[l.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),l.jsx("button",{onClick:ve,children:"Restart Camera"})]})]}),u&&l.jsx("div",{className:"calib-message",children:u}),l.jsxs("div",{className:"calib-content",children:[l.jsx("div",{children:l.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[l.jsx("div",{className:"label",children:"Live Preview"}),l.jsx("div",{className:"value",style:{marginBottom:8},children:H?`Generic Mode Active: ${V==="playerA"?"Player A":V==="switching"?"Switching...":V==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),l.jsxs("div",{className:"calib-video-wrap",children:[l.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),l.jsx("div",{className:"calib-center-box",style:{width:L,height:L,borderColor:"#22d3ee",borderWidth:H?"4px":"3px",boxShadow:H?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),H&&ne>0&&l.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:ne})]})]})}),l.jsxs("div",{className:"calib-controls",children:[l.jsxs("div",{className:"calib-block",style:{background:H?"#1a2332":"#0f172a",border:H?"2px solid #22d3ee":"1px solid #1f2937"},children:[l.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),l.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),H?l.jsxs("div",{style:{marginTop:8},children:[l.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[V==="playerA"&&`Player A: Hold bracelet steady... ${ne}s`,V==="switching"&&`Switch hands! Get Player B ready... ${ne}s`,V==="playerB"&&`Player B: Hold bracelet steady... ${ne}s`,V==="optimizing"&&"Optimizing parameters...",V==="complete"&&" Complete!"]}),l.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[V==="playerA"&&`Samples collected: ${ie.current.A.length}`,V==="switching"&&`Player A: ${ie.current.A.length} samples collected`,V==="playerB"&&`Samples collected: ${ie.current.B.length}`]}),V!=="complete"&&l.jsx("button",{onClick:ze,style:{background:"#ef4444"},children:"Cancel"})]}):l.jsx("div",{className:"buttons",children:l.jsx("button",{onClick:re,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Detector Settings"}),l.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Detection square size"}),l.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:L,onChange:Y=>F(Number(Y.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[L,"px"]})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Hue weight"}),l.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:X,onChange:Y=>C(Number(Y.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:X.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Saturation weight"}),l.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:g,onChange:Y=>v(Number(Y.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:g.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Value weight"}),l.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:E,onChange:Y=>N(Number(Y.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:E.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:T,onChange:Y=>$(Number(Y.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[(T*100).toFixed(0),"%"]})]}),l.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player A"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:v1(h)}}),l.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>se("A"),disabled:!i,children:"Save A"}),l.jsx("button",{onClick:()=>Z("A"),children:"Clear A"})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player B"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:v1(w)}}),l.jsx("span",{children:w?`h${w.h.toFixed(0)} s${w.s.toFixed(0)} v${w.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>se("B"),disabled:!i,children:"Save B"}),l.jsx("button",{onClick:()=>Z("B"),children:"Clear B"})]})]})]})]}),l.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function Q2({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var D;const[a,u]=j.useState(e),[d,h]=j.useState(0),[m,w]=j.useState(!1),[S,_]=j.useState(1),[L,F]=j.useState(ua()),[X,C]=j.useState(!0),[g,v]=j.useState([]),[E,N]=j.useState(null),[T,$]=j.useState(!1),H=j.useRef(null),q=j.useRef(null),V=j.useRef(null),K=n&&!e,ne=["summary-container",r].filter(Boolean).join(" "),ee=(y,I)=>{const M=V.current;if(!M)return 0;const b=M.offsetHeight;return(y+.5)*b},ie=j.useCallback((y,I=null)=>{const M=I||a;if(!M)return;let b=ua(),B=!0;const U=[];let W=null;for(let ue=0;ue<=y&&ue<M.moves.length;ue++){const me=M.moves[ue];me.phase==="experiment"&&B&&(B=!1,b=ua());const be=me.all_positions||(me.allPositions?me.allPositions.map(Ie=>[Ie[0]*.07,Ie[1]*.07]):null);if(me.type==="moveblock"&&be)be.length===10&&b.length===10?b=b.map((Ie,Oe)=>{const tt=be[Oe];return tt&&Array.isArray(tt)&&tt.length===2?{...Ie,position:[tt[0],tt[1]]}:Ie}):console.warn(`Position count mismatch: blocks=${b.length}, positions=${be==null?void 0:be.length}`),b=of(sf(b),B),W=me.blockId!==void 0?me.blockId:me.unit;else if(me.type==="added shape to gallery"&&me.gallery_normalized){const Ie=document.createElement("canvas");Ie.width=400,Ie.height=400;const Oe=Ie.getContext("2d");Oe.fillStyle="#000",Oe.fillRect(0,0,400,400),me.gallery_normalized.forEach(tt=>{const Qe=(tt[0]+.5)*400,lt=(tt[1]+.5)*400;Oe.fillStyle="green";const ut=60;Oe.fillRect(Qe-ut/2,lt-ut/2,ut,ut)}),U.push({number:me.gallery_shape_number,image:Ie.toDataURL()}),W=null}}F(b),C(B),v(U),N(W)},[a]),ve=y=>{u(y),h(0),w(!1),setTimeout(()=>{ie(0,y)},0)},we=y=>{if(!K)return;const I=y.target.files[0];if(!I)return;const M=new FileReader;M.onload=b=>{try{const B=JSON.parse(b.target.result);ve(B)}catch(B){alert("Failed to parse JSON file: "+B.message)}},M.readAsText(I)};j.useEffect(()=>{e&&ve(e)},[e]),j.useEffect(()=>{a&&d>=0&&ie(d)},[a,d,ie]),j.useEffect(()=>{const y=()=>{a&&d>=0&&setTimeout(()=>{ie(d)},100)};return window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[a,d,ie]);const Te=y=>{a&&(y<0||y>=a.moves.length||(ie(y),h(y)))},se=()=>{if(!a||m)return;w(!0),h(0),ie(0);let y=0;q.current=setInterval(()=>{if(y>=a.moves.length){Z();return}y++,ie(y),h(y)},1e3/S)},Z=()=>{q.current&&(clearInterval(q.current),q.current=null),w(!1)};if(j.useEffect(()=>()=>{q.current&&clearInterval(q.current)},[]),j.useEffect(()=>{if(m&&q.current){clearInterval(q.current),q.current=null;const y=d;h(0),w(!1),setTimeout(()=>{h(y),se()},0)}},[S]),!a)return K?l.jsx("div",{className:ne,children:l.jsxs("div",{className:"summary-upload",children:[l.jsx("h1",{children:t}),l.jsx("p",{children:"Load a game session JSON file to view the replay"}),l.jsx("input",{ref:H,type:"file",accept:".json",onChange:we,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var y;return(y=H.current)==null?void 0:y.click()},children:"Load JSON File"})]})}):null;const re=a.moves[d],ge=a.moves.length,Me=((D=a.summary)==null?void 0:D.movesByPlayer)||{},Ue=Object.entries(Me||{}),$e=(y,I=1)=>Number.isFinite(y)?y.toFixed(I):"",Ne=a.sessionInfo||{},ze=Ne.subjectId||Ne.id||a.subjectId||a.id||null,Y=Ne.sessionGameId||a.sessionGameId||ze||null,Q=Ne.condition||a.condition||null,ye=a.startTime||Ne.startedAt||Ne.date||null,le=a.endTime||Ne.endedAt||null,R=y=>{if(!y)return null;try{const I=new Date(y);if(!Number.isNaN(I.getTime()))return I.toLocaleString()}catch{}return y},z=[];Y&&z.push({label:"Session ID",value:Y}),ze&&ze!==Y&&z.push({label:"Participant",value:ze}),Q&&z.push({label:"Condition",value:Q});const J=R(ye);J&&z.push({label:"Start",value:J});const de=R(le);return de&&z.push({label:"End",value:de}),l.jsxs("div",{className:ne,children:[l.jsxs("div",{className:"summary-header",children:[l.jsx("h1",{children:t}),z.length>0&&l.jsx("div",{className:"summary-session-info",children:z.map(y=>l.jsxs("div",{className:"summary-session-info-item",children:[l.jsx("span",{className:"summary-session-info-label",children:y.label}),l.jsx("span",{className:"summary-session-info-value",children:y.value})]},`${y.label}-${y.value}`))})]}),l.jsxs("div",{className:"summary-main",children:[l.jsxs("div",{className:"summary-left",children:[l.jsx("div",{className:"summary-game-area",children:l.jsxs("div",{className:"game-canvas",ref:V,children:[l.jsx("div",{className:"gallery",children:l.jsx("div",{className:"gallery-frame",children:g.length>0?l.jsx("img",{src:g[g.length-1].image,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),L.map((y,I)=>{const M=y.position||[0,0];return!Array.isArray(M)||M.length!==2||!Number.isFinite(M[0])||!Number.isFinite(M[1])?(console.warn(`Invalid position for block ${y.id}:`,M),null):l.jsx("div",{className:`block ${y.canMove?"movable":""} ${y.id===E?"highlighted":""}`,style:{left:`${ee(M[0])}px`,top:`${ee(M[1])}px`,backgroundColor:y.color||"green",cursor:y.canMove?"grab":"default",zIndex:y.id===E?20:I+1}},y.id)})]})}),l.jsxs("div",{className:"summary-progress",children:[l.jsx("input",{type:"range",min:"0",max:Math.max(0,ge-1),value:d,onChange:y=>Te(parseInt(y.target.value)),style:{width:"100%"}}),l.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",ge,re&&l.jsxs("span",{className:"move-info",children:[" "," Player: ",re.player,Array.isArray(re.position)&&re.position.length===2&&`  Position: (${re.position[0]}, ${re.position[1]})`,Number.isFinite(re.holdTime)&&`  Hold: ${$e(re.holdTime,2)}s`," "," Time: ",$e(re.elapsed,1),"s"]})]})]})]}),l.jsxs("div",{className:"summary-right",children:[l.jsxs("div",{className:"summary-stats",children:[l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Duration"}),l.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),l.jsx("span",{className:"summary-stats-value",children:ge})]}),l.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[l.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),l.jsx("div",{className:"summary-stats-value",children:Ue.length===0?l.jsx("span",{children:""}):Ue.map(([y,I])=>l.jsxs("div",{children:[y,": ",I]},y))})]})]}),l.jsxs("div",{className:"summary-controls",children:[l.jsx("button",{onClick:()=>Te(0),disabled:d===0,children:" First"}),l.jsx("button",{onClick:()=>Te(d-1),disabled:d===0,children:" Previous"}),l.jsx("button",{onClick:m?Z:se,children:m?" Pause":" Play"}),l.jsx("button",{onClick:()=>Te(d+1),disabled:d>=ge-1,children:" Next"}),l.jsx("button",{onClick:()=>Te(ge-1),disabled:d>=ge-1,children:" Last"}),l.jsxs("div",{className:"speed-control",children:[l.jsx("label",{children:"Speed:"}),l.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:S,onChange:y=>_(parseFloat(y.target.value))}),l.jsxs("span",{children:[S,"x"]})]}),K&&l.jsxs(l.Fragment,{children:[l.jsx("input",{ref:H,type:"file",accept:".json",onChange:we,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var y;return(y=H.current)==null?void 0:y.click()},children:" Load New File"})]})]}),l.jsxs("div",{className:"summary-moves-list",children:[l.jsxs("div",{className:"move-list-header",children:[l.jsx("h2",{children:"Move History"}),i&&l.jsx("button",{className:`edit-mode-toggle ${T?"active":""}`,onClick:()=>$(!T),children:T?" Done Editing":"Edit Players"})]}),l.jsx("div",{className:"moves-scroll",children:a.moves.map((y,I)=>l.jsxs("div",{className:`move-item ${I===d?"active":""} ${T?"edit-mode":""}`,onClick:()=>!T&&Te(I),children:[l.jsx("div",{className:"move-number",children:I+1}),y.camera_frame&&l.jsx("div",{className:"move-camera-frame",children:l.jsx("img",{src:y.camera_frame,alt:`Camera frame for move ${I+1}`,className:"camera-frame-thumbnail"})}),l.jsxs("div",{className:"move-details",children:[l.jsx("div",{className:"move-type",children:y.type}),T&&i?l.jsxs("div",{className:"move-player-edit",children:[l.jsx("label",{children:"Player:"}),l.jsxs("select",{value:y.player||"Unknown",onChange:M=>{const b=M.target.value;i(y._id,b)},onClick:M=>M.stopPropagation(),children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):l.jsxs("div",{className:"move-player",children:["Player: ",y.player]}),y.blockId!==null&&y.blockId!==void 0||y.unit!==null&&y.unit!==void 0?l.jsxs("div",{className:"move-unit",children:["Block: ",y.blockId!==void 0?y.blockId:y.unit]}):null,Array.isArray(y.position)&&y.position.length===2&&l.jsxs("div",{className:"move-position",children:["Position: (",y.position[0],", ",y.position[1],")"]}),Number.isFinite(y.holdTime)&&y.holdTime>0&&l.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",$e(y.holdTime,2),"s"]}),l.jsxs("div",{className:"move-time",children:["Time: ",$e(y.elapsed,1),"s"]})]})]},I))})]})]})]})]})}const Kt=(...e)=>{console.log("[Detector2]",...e)},vn={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function fx(){const e=j.useRef(null),t=j.useRef(null),n=j.useRef(null),r=j.useRef(null),s=j.useRef(null),i=j.useRef(null),a=j.useRef(null),u=j.useRef(null),d=j.useRef(null),[h,m]=j.useState(""),[w,S]=j.useState(!1),[_,L]=j.useState({camA:"None",camB:"None",merged:"None"}),[F,X]=j.useState(!0),[C,g]=j.useState(null),[v,E]=j.useState(null),N=j.useRef(null),T=j.useRef(null),$=(y,I)=>{const M=localStorage.getItem(y);if(M===null)return I;const b=parseFloat(M);return Number.isFinite(b)?b:I},[H,q]=j.useState(()=>({roiSize:(()=>{const y=$(vn.roiSize,44);return y>10?y:44})(),hueWeight:$(vn.hueWeight,4),satWeight:$(vn.satWeight,2),valWeight:$(vn.valWeight,1),sensitivity:$(vn.sensitivity,0)})),V=j.useRef(H),[K,ne]=j.useState([]),[ee,ie]=j.useState(""),[ve,we]=j.useState("");j.useEffect(()=>{let y=!0;(async()=>{try{const B=(await navigator.mediaDevices.enumerateDevices()).filter(W=>W.kind==="videoinput");if(B.length===0){m("No cameras found");return}ne(B);const U=B.slice(0,2).map(W=>W.deviceId);ie(U[0]||""),we(U[1]||U[0]||""),await Te(U[0],e,u),U[1]?await Te(U[1],t,d):await Te(U[0],t,d),await $e(),await Ne("A",e,i),await Ne("B",t,a)}catch(b){if(!y)return;m((b==null?void 0:b.message)||String(b))}})();const I=()=>{try{const b=JSON.parse(localStorage.getItem("calibrationA")||"null"),B=JSON.parse(localStorage.getItem("calibrationB")||"null");b&&g({h:b.h,s:b.s,v:b.v}),B&&E({h:B.h,s:B.s,v:B.v})}catch{Kt("No existing calibrations")}};I();const M=b=>{!b||!b.key||(["calibrationA","calibrationB"].includes(b.key)&&I(),[vn.roiSize,vn.hueWeight,vn.satWeight,vn.valWeight,vn.sensitivity].includes(b.key)&&q(B=>({roiSize:(()=>{const U=$(vn.roiSize,(B==null?void 0:B.roiSize)??44);return U>10?U:(B==null?void 0:B.roiSize)??44})(),hueWeight:$(vn.hueWeight,(B==null?void 0:B.hueWeight)??4),satWeight:$(vn.satWeight,(B==null?void 0:B.satWeight)??2),valWeight:$(vn.valWeight,(B==null?void 0:B.valWeight)??1),sensitivity:$(vn.sensitivity,(B==null?void 0:B.sensitivity)??0)})))};return window.addEventListener("storage",M),()=>{if(y=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),u.current&&(u.current.getTracks().forEach(U=>U.stop()),u.current=null),d.current&&(d.current.getTracks().forEach(U=>U.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const b=e.current;b&&(b.srcObject=null);const B=t.current;B&&(B.srcObject=null),window.removeEventListener("storage",M)}},[]);const Te=async(y,I,M)=>{const b={video:{deviceId:{exact:y}}};Kt("Starting camera with deviceId:",y);const B=await navigator.mediaDevices.getUserMedia(b);M.current=B;const U=I.current;if(!U){Kt("Video element not found!");return}U.srcObject=B,Kt("Stream assigned to video element, waiting for metadata..."),await new Promise(W=>{if(U.readyState>=2&&U.videoWidth>0&&U.videoHeight>0)return Kt("Video already ready:",U.videoWidth,"x",U.videoHeight),W();const me=()=>{Kt("loadedmetadata event fired:",U.videoWidth,"x",U.videoHeight),U.removeEventListener("loadedmetadata",me),W()};U.addEventListener("loadedmetadata",me,{once:!0}),setTimeout(()=>{Kt("Metadata timeout - proceeding anyway"),U.removeEventListener("loadedmetadata",me),W()},2e3)});try{await U.play(),Kt("Video play() succeeded")}catch(W){Kt("Video play() failed:",W)}},se=j.useRef(null),Z=j.useRef(null),re=j.useRef(null),ge=j.useRef(!1),Me=async()=>{if(!ge.current){ge.current=!0;try{for(;Z.current||re.current;){const y=s.current;if(!y)break;let I=null,M=null;if(Z.current?(I="A",M=Z.current,Z.current=null):re.current&&(I="B",M=re.current,re.current=null),!!M){se.current=I;try{await y.send({image:M})}catch(b){console.error("[Detector2] hands.send error:",b);break}}}}finally{ge.current=!1}}},Ue=(y,I)=>{y==="A"?Z.current=I:re.current=I,Promise.resolve().then(Me)},$e=async()=>{if(s.current)return s.current;try{const y=await(async()=>{try{if(typeof au.Hands=="function")return au.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const M=document.getElementById("mp-hands-cdn-script");if(M&&(await new Promise(b=>{if(window.Hands&&typeof window.Hands=="function")return b();const B=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(B),b())},50);setTimeout(()=>{clearInterval(B),b()},3e3)}),window.Hands&&typeof window.Hands=="function")||(M||await new Promise((b,B)=>{const U=document.createElement("script");U.id="mp-hands-cdn-script",U.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",U.async=!0,U.onload=()=>b(),U.onerror=W=>B(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(U)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),I=new y({locateFile:M=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${M}`});return I.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),I.onResults(M=>{const b=se.current;b==="A"?Q(M):b==="B"&&ye(M)}),s.current=I,I}catch(y){return console.error("MediaPipe initialization error:",y),m(`MediaPipe error: ${y.message}`),null}},Ne=async(y,I,M)=>{if(!await $e())return;const B=I.current;if(!B){Kt(`Video ref for ${y} not found`);return}Kt(`Initializing manual frame capture for camera ${y}, video dimensions:`,B.videoWidth,"x",B.videoHeight);let U=null;const W=()=>{const ue=I.current;ue&&ue.readyState>=2&&ue.videoWidth>0&&Ue(y,ue),U=requestAnimationFrame(W)};U=requestAnimationFrame(W),M.current={stop:()=>{U&&(cancelAnimationFrame(U),U=null,Kt(`Stopped manual frame capture for camera ${y}`))}},Kt(`Manual frame capture started for camera ${y}`)},ze=j.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),Y=j.useRef({wristY:null,player:"None",landmarks:null,wristX:null});j.useEffect(()=>{N.current=C},[C]),j.useEffect(()=>{T.current=v},[v]),j.useEffect(()=>{V.current=H},[H]);const Q=y=>le(y,n,"A"),ye=y=>le(y,r,"B"),le=(y,I,M)=>{var ut;const b=I.current;if(!b)return;const B=b.getContext("2d");if(!B)return;const U=M==="A"?e.current:t.current;if(!U||U.videoWidth===0||U.videoHeight===0){M==="A"?ze.current={wristY:null,wristX:null,landmarks:null,player:"None"}:Y.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}b.width=U.videoWidth,b.height=U.videoHeight,B.drawImage(U,0,0,b.width,b.height),B.fillStyle="rgba(0, 0, 0, 0.6)",B.fillRect(b.width-80,5,75,20),B.fillStyle="white",B.font="bold 14px Arial",B.fillText(`Camera ${M}`,b.width-75,20);let W=null,ue=null,me=null,be=[];if(y.multiHandLandmarks&&y.multiHandLandmarks.length>0)for(const He of y.multiHandLandmarks){const De=He[0],Ge=De.x*b.width,Je=De.y*b.height;be.push({x:Ge,y:Je,landmarks:He}),(W===null||(F?Je<W:Je>W))&&(W=Je,ue=He,me=Ge)}be.forEach(({x:He,y:De})=>{B.fillStyle="orange",B.beginPath(),B.arc(He,De,8,0,Math.PI*2),B.fill()});let Ie="None";if(ue){B.fillStyle="lime",B.beginPath(),B.arc(me,W,10,0,2*Math.PI),B.fill(),B.fillStyle="lime",B.font="16px Arial",B.fillText("SELECTED",me-40,W-15);const De=Math.max(10,Math.min(300,Math.floor(((ut=V.current)==null?void 0:ut.roiSize)||60)))/2,Ge=Math.max(0,me-De),Je=Math.max(0,W-De),_t=Math.min(b.width,me+De),Bn=Math.min(b.height,W+De),ct=Math.max(0,Math.floor(Ge)),zt=Math.max(0,Math.floor(Je));let Pt=Math.floor(_t-Ge),en=Math.floor(Bn-Je);if(Pt=Math.max(1,Pt),en=Math.max(1,en),Pt=Math.min(Pt,b.width-ct),en=Math.min(en,b.height-zt),Pt>0&&en>0){B.strokeStyle="lime",B.lineWidth=3,B.strokeRect(ct,zt,Pt,en);try{const mn=B.getImageData(ct,zt,Pt,en),gn=N.current,yn=T.current;Ie=z(mn,gn,yn).status}catch(mn){console.warn("[Detector2] ROI sampling failed:",mn),Ie="None"}}else Kt("ROI skipped due to zero width/height",{width:Pt,height:en,left:ct,top:zt})}if(be.length>=1){let He=be[0].y,De=be[0].y;be.forEach(_t=>{_t.y<He&&(He=_t.y),_t.y>De&&(De=_t.y)}),B.strokeStyle="yellow",B.setLineDash([6,4]),B.beginPath(),B.moveTo(0,F?He:De),B.lineTo(b.width,F?He:De),B.stroke(),B.strokeStyle="cyan",B.beginPath(),B.moveTo(0,F?De:He),B.lineTo(b.width,F?De:He),B.stroke(),B.setLineDash([]);const Ge=F?"A (top)":"A (bottom)",Je=F?"B (bottom)":"B (top)";B.fillStyle="lime",B.font="16px Arial",B.fillText(Ge,6,Math.max(14,(F?He:De)-6)),B.fillStyle="dodgerblue",B.fillText(Je,6,Math.min(b.height-6,(F?De:He)+18))}const Oe={wristY:W,wristX:me,landmarks:ue,player:Ie};M==="A"?ze.current=Oe:Y.current=Oe;const tt=ze.current.wristY,Qe=Y.current.wristY;let lt="None";if(tt!=null||Qe!=null){const He=F?(Ge,Je)=>Ge==null?Je:Math.min(Ge,Je):(Ge,Je)=>Ge==null?Je:Math.max(Ge,Je);[tt,Qe].filter(Ge=>Ge!=null).reduce(He,null)===tt?lt=ze.current.player:lt=Y.current.player}L({camA:ze.current.player,camB:Y.current.player,merged:lt})},R=(y,I,M)=>{y/=255,I/=255,M/=255;const b=Math.max(y,I,M),B=Math.min(y,I,M),U=b-B;let W=0;U!==0&&(b===y?W=60*((I-M)/U%6):b===I?W=60*((M-y)/U+2):W=60*((y-I)/U+4)),W<0&&(W+=360);const ue=b===0?0:U/b*255,me=b*255;return[W/2,ue,me]},z=(y,I,M)=>{var me,be,Ie,Oe;const b=y.data;if(I&&!M)return{status:"Player A",percentA:null,percentB:null};if(M&&!I)return{status:"Player B",percentA:null,percentB:null};const B=((me=V.current)==null?void 0:me.hueWeight)??4,U=((be=V.current)==null?void 0:be.satWeight)??2,W=((Ie=V.current)==null?void 0:Ie.valWeight)??1,ue=((Oe=V.current)==null?void 0:Oe.sensitivity)??0;if(I&&M){let tt=0,Qe=0,lt=0;for(let Ge=0;Ge<b.length;Ge+=4){const Je=b[Ge],_t=b[Ge+1],Bn=b[Ge+2],[ct,zt,Pt]=R(Je,_t,Bn),en=Math.min(1,Math.max(0,zt/255)),mn=Math.min(1,Math.max(0,Pt/255)),gn=Math.max(.05,.5*en+.5*mn),yn=Math.min(Math.abs(ct-I.h),180-Math.abs(ct-I.h)),tn=Math.min(Math.abs(ct-M.h),180-Math.abs(ct-M.h)),Qr=Math.abs(zt-I.s),Lr=Math.abs(zt-M.s),Br=Math.abs(Pt-I.v),Fn=Math.abs(Pt-M.v),Ks=yn*B+Qr*U+Br*W,On=tn*B+Lr*U+Fn*W;Math.min(Ks,On)>180||(Ks<=On?tt+=gn:Qe+=gn,lt+=gn)}if(lt===0)return{status:"None",percentA:0,percentB:0};const ut=tt/Math.max(1e-6,lt),He=Qe/Math.max(1e-6,lt),De=.12*(1+.8*Math.max(0,Math.min(1,ue)));return ut>=De&&ut>=He?{status:"Player A",percentA:ut,percentB:He}:He>=De&&He>ut?{status:"Player B",percentA:ut,percentB:He}:{status:"None",percentA:ut,percentB:He}}return{status:"None",percentA:0,percentB:0}},J=(y,I,M)=>{const b=(y||0)*2,B=(I||0)/255,U=(M||0)/255,W=U*B,ue=W*(1-Math.abs(b/60%2-1)),me=U-W;let be=0,Ie=0,Oe=0;b>=0&&b<60?(be=W,Ie=ue,Oe=0):b<120?(be=ue,Ie=W,Oe=0):b<180?(be=0,Ie=W,Oe=ue):b<240?(be=0,Ie=ue,Oe=W):b<300?(be=ue,Ie=0,Oe=W):(be=W,Ie=0,Oe=ue);const tt=Math.round((be+me)*255),Qe=Math.round((Ie+me)*255),lt=Math.round((Oe+me)*255);return`rgb(${tt}, ${Qe}, ${lt})`},de=y=>y?J(y.h,y.s,y.v):"#ffffff",D=async(y,I)=>{try{if(y==="A"){if(ie(I),i.current){try{i.current.stop()}catch(b){Kt("Stop camA error:",b)}i.current=null}u.current&&(u.current.getTracks().forEach(b=>b.stop()),u.current=null);const M=e.current;M&&(M.srcObject=null),await new Promise(b=>setTimeout(b,100)),await Te(I,e,u),await new Promise(b=>setTimeout(b,200)),await $e(),await Ne("A",e,i),Kt("Camera A switched to:",I)}else{if(we(I),a.current){try{a.current.stop()}catch(b){Kt("Stop camB error:",b)}a.current=null}d.current&&(d.current.getTracks().forEach(b=>b.stop()),d.current=null);const M=t.current;M&&(M.srcObject=null),await new Promise(b=>setTimeout(b,100)),await Te(I,t,d),await new Promise(b=>setTimeout(b,200)),await $e(),await Ne("B",t,a),Kt("Camera B switched to:",I)}}catch(M){console.error("[Detector2] Camera switch error:",M),m(`Camera switch error: ${M.message}`)}};return l.jsxs("div",{className:`detector-window ${w?"minimized":""}`,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:()=>S(!w),children:w?"":""}),l.jsx("button",{onClick:()=>X(!F),title:"Toggle A criterion",children:F?"A=Top":"A=Bottom"})]})]}),l.jsxs("div",{className:"detector-content",style:{display:w?"none":"block"},children:[l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera A:"}),l.jsx("select",{value:ee,onChange:y=>D("A",y.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(y=>l.jsx("option",{value:y.deviceId,children:y.label||`Camera ${y.deviceId.slice(0,8)}`},y.deviceId))})]}),l.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:n,className:"output_canvas"})]}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera B:"}),l.jsx("select",{value:ve,onChange:y=>D("B",y.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(y=>l.jsx("option",{value:y.deviceId,children:y.label||`Camera ${y.deviceId.slice(0,8)}`},y.deviceId))})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),l.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[l.jsxs("div",{className:"status-display",children:["Merged: ",l.jsx("strong",{children:_.merged})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:C?de(C):"#444"}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:v?de(v):"#444"}})]})]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",C?`h${Math.round(C.h)} s${Math.round(C.s)} v${Math.round(C.v)}`:""]}),l.jsxs("div",{children:["B: ",v?`h${Math.round(v.h)} s${Math.round(v.s)} v${Math.round(v.v)}`:""]})]}),h&&l.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),l.jsxs("div",{style:{fontSize:12,marginTop:6},children:[l.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const Wo=Fu(),w1=e=>{var i,a,u,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((m,w)=>typeof w.elapsed=="number"&&w.elapsed>m?w.elapsed:m,0),r={},s={};return t.forEach(m=>{const w=(m==null?void 0:m.player)||"Unknown";r[w]=(r[w]||0)+1;const S=(m==null?void 0:m.phase)||"unknown";s[S]=(s[S]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((u=(a=e.metadata)==null?void 0:a.config)==null?void 0:u.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},hx=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},x1="adminPassword";function px(){var K;const[e,t]=j.useState([]),[n,r]=j.useState(!0),[s,i]=j.useState(null),[a,u]=j.useState(null),[d,h]=j.useState(null),[m,w]=j.useState(!1),[S,_]=j.useState(null),[L,F]=j.useState(!1),[X,C]=j.useState(""),[g,v]=j.useState(!1);j.useEffect(()=>{const ne=localStorage.getItem(x1);ne&&C(ne)},[]);const E=j.useCallback(async()=>{if(!X){i("Password required"),r(!1);return}r(!0),i(null),v(!1);try{const ne=await fetch(`${Wo}/sessions`,{headers:{"x-admin-password":X}});if(ne.status===401||ne.status===403)throw v(!0),new Error("Invalid password");if(!ne.ok)throw new Error(`Failed to load sessions (${ne.status})`);const ee=await ne.json(),ie=Array.isArray(ee)?ee:[];localStorage.setItem(x1,X),t(ie),u(ve=>ve&&ie.some(we=>we.sessionGameId===ve)?ve:ie.length>0?ie[0].sessionGameId:null)}catch(ne){console.error("[Admin] Error fetching sessions:",ne),i(ne.message||"Failed to load sessions"),t([]),u(null)}finally{r(!1)}},[X]);j.useEffect(()=>{E()},[E]),j.useEffect(()=>{if(!a){h(null);return}let ne=!1;return(async()=>{if(X){w(!0),_(null);try{const ie=await fetch(`${Wo}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":X}});if(!ie.ok)throw ie.status===404?new Error("Session not found"):new Error(`Failed to load session (${ie.status})`);const ve=await ie.json();ne||h(w1(ve))}catch(ie){console.error("[Admin] Error fetching session detail:",ie),ne||(_(ie.message||"Failed to load session"),h(null))}finally{ne||w(!1)}}})(),()=>{ne=!0}},[a]);const N=ne=>{u(ne),F(!1)},T=async()=>{if(!a||!X)return;const ne=!L;F(ne),w(!0),_(null);try{const ee=ne?`${Wo}/sessions/${encodeURIComponent(a)}/experiment-only`:`${Wo}/sessions/${encodeURIComponent(a)}`,ie=await fetch(ee,{headers:{"x-admin-password":X}});if(!ie.ok)throw new Error(`Failed to load session data (${ie.status})`);const ve=await ie.json();h(w1(ve))}catch(ee){console.error("[Admin] Error loading session data:",ee),_(ee.message||"Failed to load session data"),F(!ne)}finally{w(!1)}},$=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},H=()=>{if(!d)return;const ne=JSON.stringify(d,null,2),ee=new Blob([ne],{type:"application/json"}),ie=URL.createObjectURL(ee),ve=document.createElement("a");ve.href=ie;const we=`${a}_${new Date().toISOString().split("T")[0]}.json`;ve.download=we,ve.click(),URL.revokeObjectURL(ie),console.log("[Admin] Downloaded JSON:",we)},q=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const ne=new Set;d.moves.forEach(re=>{Object.keys(re).forEach(ge=>{ge!=="camera_frame"&&ge!=="__v"&&ne.add(ge)})});const ee=Array.from(ne),ie=[ee.join(",")];d.moves.forEach(re=>{const ge=ee.map(Me=>{const Ue=re[Me];return Ue==null||Ue===""?"":Array.isArray(Ue)||typeof Ue=="object"?`"${JSON.stringify(Ue).replace(/"/g,'""')}"`:`"${String(Ue).replace(/"/g,'""')}"`});ie.push(ge.join(","))});const ve=ie.join(`
`),we=new Blob([ve],{type:"text/csv;charset=utf-8;"}),Te=URL.createObjectURL(we),se=document.createElement("a");se.href=Te;const Z=`${a}_${new Date().toISOString().split("T")[0]}.csv`;se.download=Z,se.click(),URL.revokeObjectURL(Te),console.log("[Admin] Downloaded CSV:",Z)},V=async(ne,ee)=>{if(!(!a||!ne||!X))try{const ie=await fetch(`${Wo}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(ne)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":X},body:JSON.stringify({player:ee})});if(!ie.ok)throw new Error(`Failed to update player (${ie.status})`);h(ve=>ve&&{...ve,moves:ve.moves.map(we=>we._id===ne?{...we,player:ee}:we)}),console.log("[Admin] Player updated:",ne,ee)}catch(ie){console.error("[Admin] Error updating player:",ie),alert("Failed to update player: "+ie.message)}};return l.jsxs("div",{className:"admin-container",children:[l.jsxs("aside",{className:"admin-sidebar",children:[l.jsxs("div",{className:"admin-sidebar-header",children:[l.jsx("h1",{children:"Admin"}),l.jsxs("div",{className:"admin-password-row",children:[l.jsx("input",{type:"password",className:`admin-password-input ${g?"error":""}`,placeholder:"Password",value:X,onChange:ne=>C(ne.target.value),onKeyPress:ne=>{ne.key==="Enter"&&E()}}),l.jsx("button",{className:"admin-refresh-button",onClick:E,disabled:n||!X,children:n?"Refreshing":"Refresh"})]})]}),s&&l.jsx("div",{className:"admin-error",children:s}),l.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&l.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&l.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(ne=>{const ee=typeof ne.movesCount=="number"?ne.movesCount:Array.isArray(ne.moves)?ne.moves.length:0,ie=ne.sessionGameId===a;return l.jsxs("button",{className:`admin-session-card ${ie?"active":""}`,onClick:()=>N(ne.sessionGameId),children:[l.jsx("div",{className:"admin-session-id",children:ne.sessionGameId}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Participant: ",ne.subjectId||""]}),l.jsxs("span",{children:["Condition: ",ne.condition||""]})]}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Moves: ",ee]}),l.jsxs("span",{children:["Updated: ",hx(ne.updatedAt)]})]})]},ne.sessionGameId)})]})]}),l.jsxs("main",{className:"admin-content",children:[m&&l.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),S&&l.jsx("div",{className:"admin-error admin-error--content",children:S}),!m&&!S&&d&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"admin-toolbar",children:[l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[l.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),l.jsx("button",{className:`admin-toolbar-button experiment-toggle ${L?"active":""}`,onClick:T,title:L?"Show all moves (including practice)":"Show only experiment phase moves",children:L?"Show All Moves":"Experiment Only"}),l.jsx("button",{className:"admin-toolbar-button edit-players",onClick:$,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[l.jsx("button",{className:"admin-toolbar-button download-json",onClick:H,title:"Download session data as JSON",children:"Download JSON"}),l.jsx("button",{className:"admin-toolbar-button download-csv",onClick:q,title:"Download moves as CSV",children:"Download CSV"})]})]}),l.jsx("div",{className:"admin-summary-wrapper",children:l.jsx(Q2,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((K=d.sessionInfo)==null?void 0:K.sessionGameId)||a||""}${L?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:V})})]}),!m&&!S&&!d&&l.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const S1="adminPassword";function mx(){const[e,t]=j.useState(null),[n,r]=j.useState(!1),[s,i]=j.useState(null),[a,u]=j.useState(null),[d,h]=j.useState(null),[m,w]=j.useState(""),[S,_]=j.useState(!1);j.useEffect(()=>{const X=localStorage.getItem(S1);X&&w(X)},[]);const L=X=>{const C=X.target.files[0];if(!C)return;if(!C.name.endsWith(".json")){u("Please select a JSON file"),t(null);return}t(C),u(null),i(null);const g=new FileReader;g.onload=v=>{var E;try{const N=JSON.parse(v.target.result);h({sessionGameId:N.sessionGameId||"N/A",subjectId:N.subjectId||"N/A",condition:N.condition||"N/A",date:N.date||"N/A",movesCount:((E=N.moves)==null?void 0:E.length)||0,hasColorA:!!N.colorA,hasColorB:!!N.colorB})}catch(N){u("Invalid JSON file: "+N.message),h(null)}},g.readAsText(C)},F=async()=>{var X;if(!e){u("Please select a file first");return}r(!0),u(null),i(null);try{const C=await new Promise((T,$)=>{const H=new FileReader;H.onload=q=>T(q.target.result),H.onerror=$,H.readAsText(e)}),g=JSON.parse(C);if(!g.sessionGameId||!g.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!m)throw new Error("Admin password is required. Please enter it below.");const v=await fetch(`${Fu()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":m},body:JSON.stringify(g)}),E=await v.json();if(v.status===401||v.status===403)throw _(!0),new Error(E.message||"Invalid admin password");if(!v.ok)throw new Error(E.message||"Upload failed");localStorage.setItem(S1,m),_(!1),i(` Successfully uploaded session "${g.sessionGameId}" with ${((X=g.moves)==null?void 0:X.length)||0} moves`),t(null),h(null);const N=document.getElementById("json-file-input");N&&(N.value="")}catch(C){u(C.message||"Failed to upload file")}finally{r(!1)}};return l.jsx("div",{className:"admin-upload-container",children:l.jsxs("div",{className:"admin-upload-card",children:[l.jsx("h1",{children:"Admin: Upload Session JSON"}),l.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),l.jsxs("div",{className:"admin-upload-form",children:[l.jsxs("div",{className:"password-input-wrapper",children:[l.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),l.jsx("input",{id:"admin-password",type:"password",value:m,onChange:X=>{w(X.target.value),_(!1)},placeholder:"Enter admin password",className:S?"error":""}),S&&l.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),l.jsxs("div",{className:"file-input-wrapper",children:[l.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:L,disabled:n}),l.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&l.jsxs("div",{className:"file-preview",children:[l.jsx("h3",{children:"File Preview"}),l.jsxs("div",{className:"preview-grid",children:[l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Condition:"})," ",d.condition]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Date:"})," ",d.date]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&l.jsxs("div",{className:"error-message",children:[l.jsx("strong",{children:"Error:"})," ",a]}),s&&l.jsx("div",{className:"success-message",children:s}),l.jsx("button",{className:"upload-button",onClick:F,disabled:!e||!m||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var gi=typeof self<"u"?self:{};function ei(){throw Error("Invalid UTF8")}function k1(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let pl,Xc;const gx=typeof TextDecoder<"u";let yx;const vx=typeof TextEncoder<"u";function J2(e){if(vx)e=(yx||(yx=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var wh,lu;e:{for(var A1=["CLOSURE_FLAGS"],Kc=gi,Qc=0;Qc<A1.length;Qc++)if((Kc=Kc[A1[Qc]])==null){lu=null;break e}lu=Kc}var Ma,E1=lu&&lu[610401301];wh=E1!=null&&E1;const C1=gi.navigator;function af(e){return!!wh&&!!Ma&&Ma.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function dr(e){var t;return(t=gi.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function Cs(){return!!wh&&!!Ma&&Ma.brands.length>0}function Jc(){return Cs()?af("Chromium"):(dr("Chrome")||dr("CriOS"))&&!(!Cs()&&dr("Edge"))||dr("Silk")}function xh(e){return xh[" "](e),e}Ma=C1&&C1.userAgentData||null,xh[" "]=function(){};var wx=!Cs()&&(dr("Trident")||dr("MSIE"));!dr("Android")||Jc(),Jc(),dr("Safari")&&(Jc()||!Cs()&&dr("Coast")||!Cs()&&dr("Opera")||!Cs()&&dr("Edge")||(Cs()?af("Microsoft Edge"):dr("Edg/"))||Cs()&&af("Opera"));var q2={},qo=null;function xx(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function u(h){for(;d<i.length;){const m=i.charAt(d++),w=qo[m];if(w!=null)return w;if(!/^[\s\xa0]*$/.test(m))throw Error("Unknown base64 encoding at char: "+m)}return h}Z2();let d=0;for(;;){const h=u(-1),m=u(0),w=u(64),S=u(64);if(S===64&&h===-1)break;a(h<<2|m>>4),w!=64&&(a(m<<4&240|w>>2),S!=64&&a(w<<6&192|S))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function Z2(){if(!qo){qo={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));q2[n]=r;for(let s=0;s<r.length;s++){const i=r[s];qo[i]===void 0&&(qo[i]=s)}}}}var ey=typeof Uint8Array<"u",ty=!wx&&typeof btoa=="function";function _1(e){if(!ty){var t;t===void 0&&(t=0),Z2(),t=q2[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],u=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=u+s+i+a}switch(u=0,a=r,e.length-d){case 2:a=t[(15&(u=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|u>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const j1=/[-_.]/g,Sx={"-":"+",_:"/",".":"="};function kx(e){return Sx[e]||""}function ny(e){if(!ty)return xx(e);j1.test(e)&&(e=e.replace(j1,kx)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function $a(e){return ey&&e!=null&&e instanceof Uint8Array}var co={};function yi(){return Ax||(Ax=new is(null,co))}function Sh(e){ry(co);var t=e.g;return(t=t==null||$a(t)?t:typeof t=="string"?ny(t):null)==null?t:e.g=t}var is=class{h(){return new Uint8Array(Sh(this)||0)}constructor(e,t){if(ry(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let Ax,Ex;function ry(e){if(e!==co)throw Error("illegal external caller")}function sy(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function lf(e){return sy(e=Error(e),"warning"),e}var Ou=typeof Symbol=="function"&&typeof Symbol()=="symbol",Cx=new Set;function Da(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&Cx.add(e),e}var _x=Da("jas",void 0,!0,!0),N1=Da(void 0,"0di"),qc=Da(void 0,"2ex"),Vo=Da(void 0,"1oa",!0),fo=Da(void 0,Symbol(),!0);const je=Ou?_x:"Ga",iy={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},oy=Object.defineProperties;function $u(e,t){Ou||je in e||oy(e,iy),e[je]|=t}function Ht(e,t){Ou||je in e||oy(e,iy),e[je]=t}function Eo(e){return $u(e,34),e}function jx(e,t){Ht(t,-30975&(0|e))}function uf(e,t){Ht(t,-30941&(34|e))}function kh(){return typeof BigInt=="function"}function In(e){return Array.prototype.slice.call(e)}var Ah,za={},ay={};function b1(e){return!(!e||typeof e!="object"||e.Ia!==ay)}function Eh(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function Ch(e,t){if(e!=null){if(typeof e=="string")e=e?new is(e,co):yi();else if(e.constructor!==is)if($a(e))e=e.length?new is(new Uint8Array(e),co):yi();else{if(!t)throw Error();e=void 0}}return e}function uu(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[je]))}const M1=[];function Vs(e){if(2&e)throw Error()}Ht(M1,55),Ah=Object.freeze(M1);class cu{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new cu(this.g,this.h,this.m)}}function _h(e){return fo?e[fo]:void 0}var Nx=Object.freeze({});function Du(e){return e.Qa=!0,e}var bx=Du(e=>typeof e=="number"),T1=Du(e=>typeof e=="string"),Mx=Du(e=>typeof e=="boolean"),zu=typeof gi.BigInt=="function"&&typeof gi.BigInt(0)=="bigint",cf=Du(e=>zu?e>=Px&&e<=Rx:e[0]==="-"?P1(e,Tx):P1(e,Ix));const Tx=Number.MIN_SAFE_INTEGER.toString(),Px=zu?BigInt(Number.MIN_SAFE_INTEGER):void 0,Ix=Number.MAX_SAFE_INTEGER.toString(),Rx=zu?BigInt(Number.MAX_SAFE_INTEGER):void 0;function P1(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const Lx=typeof Uint8Array.prototype.slice=="function";let ly,ft=0,Bt=0;function I1(e){const t=e>>>0;ft=t,Bt=(e-t)/4294967296>>>0}function ho(e){if(e<0){I1(-e);const[t,n]=Mh(ft,Bt);ft=t>>>0,Bt=n>>>0}else I1(e)}function jh(e){const t=ly||(ly=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),Bt=0,ft=t.getUint32(0,!0)}function Nh(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:Ta(e,t)}function bh(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=Nh(e,t))=="number"?n?-e:e:n?"-"+e:e}function Ta(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else kh()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+R1(n)+R1(e));return n}function R1(e){return e=String(e),"0000000".slice(e.length)+e}function Uu(e){if(e.length<16)ho(Number(e));else if(kh())e=BigInt(e),ft=Number(e&BigInt(4294967295))>>>0,Bt=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");Bt=ft=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));Bt*=1e6,ft=1e6*ft+i,ft>=4294967296&&(Bt+=Math.trunc(ft/4294967296),Bt>>>=0,ft>>>=0)}if(t){const[r,s]=Mh(ft,Bt);ft=r,Bt=s}}}function Mh(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const Th=typeof BigInt=="function"?BigInt.asIntN:void 0,Bx=typeof BigInt=="function"?BigInt.asUintN:void 0,qi=Number.isSafeInteger,Hu=Number.isFinite,du=Math.trunc;function Ys(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function uy(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const Fx=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Gu(e){switch(typeof e){case"bigint":return!0;case"number":return Hu(e);case"string":return Fx.test(e);default:return!1}}function Co(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Hu(e)?0|e:void 0}function cy(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Hu(e)?e>>>0:void 0}function L1(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Ph(e){return e=du(e),qi(e)||(ho(e),e=bh(ft,Bt)),e}function Ih(e){var t=du(Number(e));if(qi(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if(Uu(e),e=ft,2147483648&(t=Bt))if(kh())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=Mh(e,t);e="-"+Ta(n,r)}else e=Ta(e,t);return e}function fu(e){return e==null?e:typeof e=="bigint"?(cf(e)?e=Number(e):(e=Th(64,e),e=cf(e)?Number(e):String(e)),e):Gu(e)?typeof e=="number"?Ph(e):Ih(e):void 0}function Ox(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(Bx(64,e));if(Gu(e)){if(t==="string")return t=du(Number(e)),qi(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),L1(e)||(Uu(e),e=Ta(ft,Bt))),e;if(t==="number")return(e=du(e))>=0&&qi(e)?e:function(n){if(n<0){ho(n);var r=Ta(ft,Bt);return n=Number(r),qi(n)?n:r}return L1(r=String(n))?r:(ho(n),Nh(ft,Bt))}(e)}}function dy(e){if(typeof e!="string")throw Error();return e}function _o(e){if(e!=null&&typeof e!="string")throw Error();return e}function po(e){return e==null||typeof e=="string"?e:void 0}function Rh(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===za)return e;if(!Array.isArray(e))return n?2&r?((e=t[N1])||(Eo((e=new t).u),e=t[N1]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[je];return s===0&&(s|=32&r),s|=2&r,s!==n&&Ht(e,s),new t(e)}function $x(e,t,n){if(t)e:{if(!Gu(t=e))throw lf("int64");switch(typeof t){case"string":t=Ih(t);break e;case"bigint":if(e=t=Th(64,t),T1(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(bx(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=zu?BigInt(t):Mx(t)?t?"1":"0":T1(t)?t.trim()||"0":String(t);break e;default:t=Ph(t)}}else t=fu(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&qi(t=+n)?t:n}const Dx={};let zx=function(){try{return xh(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class Zc{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const Ux=zx?(Object.setPrototypeOf(Zc.prototype,Map.prototype),Object.defineProperties(Zc.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),Zc):class extends Map{constructor(){super()}};function B1(e){return e}function ed(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var yr=class extends Ux{constructor(e,t,n=B1,r=B1){super();let s=0|e[je];s|=64,Ht(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?Hx:r;for(let i=0;i<e.length;i++){const a=e[i],u=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(u,d)}}na(e=F1){if(this.size!==0)return this.X(e)}X(e=F1){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){ed(this),super.clear()}delete(e){return ed(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new cu(e,Gx,this)}keys(){return this.Ha()}values(){var e=this.ma();return new cu(e,yr.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return ed(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Hx(e,t,n,r,s,i){return e=Rh(e,r,n,i),s&&(e=Vu(e)),e}function F1(e){return e}function Gx(e){return[e,this.get(e)]}let Wx,fy,Vx;function O1(){return Wx||(Wx=new yr(Eo([]),void 0,void 0,void 0,Dx))}function Lh(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=uu(e)?void 0:s&&2&(0|e[je])?e:Bh(e,t,n,r!==void 0,s);else if(Eh(e)){const i={};for(let a in e)i[a]=Lh(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function Bh(e,t,n,r,s){const i=r||n?0|e[je]:0,a=r?!!(32&i):void 0;r=In(e);for(let u=0;u<r.length;u++)r[u]=Lh(r[u],t,n,a,s);return n&&((e=_h(e))&&(r[fo]=In(e)),n(i,r)),r}function Yx(e){return Lh(e,hy,void 0,void 0,!1)}function hy(e){return e.W===za?e.toJSON():e instanceof yr?e.na(Yx):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return cf(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(uu(t))return}else{if($a(t))return _1(t);if(t instanceof is){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=_1(n)}if(t instanceof yr)return t.na()}}return t}(e)}function py(e){return Bh(e,hy,void 0,void 0,!1)}function Fs(e,t,n){return e=my(e,t[0],t[1],n?1:2),t!==fy&&n&&$u(e,16384),e}function my(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[je]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(Eh(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return Ht(e,s),e}function df(e,t,n=uf){if(e!=null){if(ey&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[je];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?(Ht(e,-12293&(34|r)),e):Bh(e,df,4&r?uf:n,!0,!0))}return e.W===za?e=2&(r=0|(n=e.u)[je])?e:new e.constructor(Wu(n,r,!0)):e instanceof yr&&!(2&e.L)&&(n=Eo(e.X(df)),e=new yr(n,e.S,e.R,e.Y)),e}}function Wu(e,t,n){const r=n||2&t?uf:jx,s=!!(32&t);return e=function(i,a,u){const d=In(i);var h=d.length;const m=256&a?d[h-1]:void 0;for(h+=m?-1:0,a=512&a?1:0;a<h;a++)d[a]=u(d[a]);if(m){a=d[a]={};for(const w in m)a[w]=u(m[w])}return(i=_h(i))&&(d[fo]=In(i)),d}(e,t,i=>df(i,s,r)),$u(e,32|(n?2:0)),e}function Vu(e){const t=e.u,n=0|t[je];return 2&n?new e.constructor(Wu(t,n,!1)):e}function mo(e,t){return ms(e=e.u,0|e[je],t)}function ms(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&qc!=null&&((s=(e=Ex??(Ex={}))[qc]||0)>=4||(e[qc]=s+1,sy(e=Error(),"incident"),function(a){gi.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function pt(e,t,n){const r=e.u;let s=0|r[je];return Vs(s),Mt(r,s,t,n),e}function Mt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},Ht(e,t|=256)):e[i]=r),t)}function Tl(e,t){let n=0|(e=e.u)[je];const r=ms(e,n,t),s=Ys(r);return s!=null&&s!==r&&Mt(e,n,t,s),s}function gy(e){let t=0|(e=e.u)[je];const n=ms(e,t,1),r=Ch(n,!0);return r!=null&&r!==n&&Mt(e,t,1,r),r}function oi(){return Nx===void 0?2:4}function ai(e,t,n,r,s){const i=e.u,a=2&(e=0|i[je])?1:r;s=!!s;let u=0|(r=Fh(i,e,t))[je];if(!(4&u)){4&u&&(r=In(r),u=os(u,e),e=Mt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const m=n(r[d]);m!=null&&(r[h++]=m)}h<d&&(r.length=h),u=Oh(u,e),n=-4097&(20|u),u=n&=-8193,Ht(r,u),2&u&&Object.freeze(r)}return a===1||a===4&&32&u?rs(u)||(s=u,u|=2,u!==s&&Ht(r,u),Object.freeze(r)):(a===2&&rs(u)&&(r=In(r),u=os(u,e),u=Os(u,e,s),Ht(r,u),e=Mt(i,e,t,r)),rs(u)||(t=u,u=Os(u,e,s),u!==t&&Ht(r,u))),r}function Fh(e,t,n,r){return e=ms(e,t,n,r),Array.isArray(e)?e:Ah}function Oh(e,t){return e===0&&(e=os(e,t)),1|e}function rs(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function yy(e){e=In(e);for(let t=0;t<e.length;t++){const n=e[t]=In(e[t]);Array.isArray(n[1])&&(n[1]=Eo(n[1]))}return e}function ff(e,t,n,r){let s=0|(e=e.u)[je];Vs(s),Mt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function jo(e,t,n,r,s){Vs(t);var i=!(!(64&t)&&16384&t);const a=(s=Fh(e,t,n,s))!==Ah;if(i||!a){let u=i=a?0|s[je]:0;(!a||2&u||rs(u)||4&u&&!(32&u))&&(s=In(s),u=os(u,t),t=Mt(e,t,n,s)),u=-13&Oh(u,t),u=Os(r?-17&u:16|u,t,!0),u!==i&&Ht(s,u)}return s}function td(e,t){var n=ov;return Dh($h(e=e.u),e,0|e[je],n)===t?t:-1}function $h(e){if(Ou)return e[Vo]??(e[Vo]=new Map);if(Vo in e)return e[Vo];const t=new Map;return Object.defineProperty(e,Vo,{value:t}),t}function vy(e,t,n,r){const s=$h(e),i=Dh(s,e,t,n);return i!==r&&(i&&(t=Mt(e,t,i)),s.set(n,r)),t}function Dh(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];ms(t,n,a)!=null&&(s!==0&&(n=Mt(t,n,s)),s=a)}return e.set(r,s),s}function zh(e,t,n,r){let s,i=0|e[je];if((r=ms(e,i,n,r))!=null&&r.W===za)return(t=Vu(r))!==r&&Mt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[je];s=2&a?Fs(Wu(r,a,!1),t,!0):64&a?r:Fs(s,t,!0)}else s=Fs(void 0,t,!0);return s!==r&&Mt(e,i,n,s),s}function wy(e,t,n,r){let s=0|(e=e.u)[je];return(t=Rh(r=ms(e,s,n,r),t,!1,s))!==r&&t!=null&&Mt(e,s,n,t),t}function et(e,t,n,r=!1){if((t=wy(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[je]))){const s=Vu(t);s!==t&&Mt(e,r,n,t=s)}return t}function xy(e,t,n,r,s,i,a){e=e.u;var u=!!(2&t);const d=u?1:s;i=!!i,a&&(a=!u);var h=0|(s=Fh(e,t,r))[je];if(!(u=!!(4&h))){var m=s,w=t;const S=!!(2&(h=Oh(h,t)));S&&(w|=2);let _=!S,L=!0,F=0,X=0;for(;F<m.length;F++){const C=Rh(m[F],n,!1,w);if(C instanceof n){if(!S){const g=!!(2&(0|C.u[je]));_&&(_=!g),L&&(L=g)}m[X++]=C}}X<F&&(m.length=X),h|=4,h=L?16|h:-17&h,Ht(m,h=_?8|h:-9&h),S&&Object.freeze(m)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(rs(h)&&(s=In(s),h=os(h,t),t=Mt(e,t,r,s)),n=s,a=h,m=0;m<n.length;m++)(h=n[m])!==(w=Vu(h))&&(n[m]=w);a|=8,Ht(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?rs(h)||(t=h,(h|=!s.length||16&h&&(!u||32&h)?2:2048)!==t&&Ht(s,h),Object.freeze(s)):(d===2&&rs(h)&&(Ht(s=In(s),h=Os(h=os(h,t),t,i)),t=Mt(e,t,r,s)),rs(h)||(r=h,(h=Os(h,t,i))!==r&&Ht(s,h))),s}function fs(e,t,n){const r=0|e.u[je];return xy(e,r,t,n,oi(),!1,!(2&r))}function Pe(e,t,n,r){return r==null&&(r=void 0),pt(e,n,r)}function ca(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[je];if(Vs(s),r==null){const i=$h(e);if(Dh(i,e,s,n)!==t)break e;i.set(n,0)}else s=vy(e,s,n,t);Mt(e,s,t,r)}}function os(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function Os(e,t,n){return 32&t&&n||(e&=-33),e}function hu(e,t,n,r){const s=0|e.u[je];Vs(s),e=xy(e,s,n,t,2,!0),r=r??new n,e.push(r),e[je]=2&(0|r.u[je])?-9&e[je]:-17&e[je]}function hr(e,t){return Co(mo(e,t))}function vr(e,t){return po(mo(e,t))}function Ot(e,t){return Tl(e,t)??0}function Pa(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);pt(e,t,n)}function Xr(e,t,n){if(n!=null){if(typeof n!="number"||!Hu(n))throw lf("int32");n|=0}pt(e,t,n)}function Ee(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);pt(e,t,n)}function pu(e,t,n){{const a=e.u;let u=0|a[je];if(Vs(u),n==null)Mt(a,u,t);else{var r=e=0|n[je],s=rs(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=In(n),r=0,e=Os(e=os(e,u),u,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=dy(d);Object.is(d,h)||(i&&(n=In(n),r=0,e=Os(e=os(e,u),u,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=In(n),e=Os(e=os(e,u),u,!0)),Ht(n,e)),Mt(a,u,t,n)}}}function Yu(e,t,n){Vs(0|e.u[je]),ai(e,t,po,2,!0).push(dy(n))}function Sy(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Uh(){return Error("Failed to read varint, encoding is invalid.")}function ky(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function Hh(e){if(typeof e=="string")return{buffer:ny(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===is)return{buffer:Sh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Gh(e,t){let n,r=0,s=0,i=0;const a=e.h;let u=e.g;do n=a[u++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[u++],s|=(127&n)<<i;if(ci(e,u),n<128)return t(r>>>0,s>>>0);throw Uh()}function Wh(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return ci(e,n),!!(127&t)}throw Uh()}function zs(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Uh();return ci(e,n),s}function hs(e){return zs(e)>>>0}function hf(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],ci(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function pf(e){var t=hf(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function Xx(e){return zs(e)}function nd(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=Hh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function ci(e,t){if(e.g=t,t>e.l)throw ky(e.l,t)}function Ay(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw ky(t,e.l-n);return e.g=r,n}function Ey(e,t){if(t==0)return yi();var n=Ay(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Lx?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?yi():new is(n,co)}yr.prototype.toJSON=void 0,yr.prototype.Ia=ay;var $1=[];function Cy(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=hs(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw Sy(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function Pl(e){switch(e.h){case 0:e.h!=0?Pl(e):Wh(e.g);break;case 1:ci(e=e.g,e.g+8);break;case 2:if(e.h!=2)Pl(e);else{var t=hs(e.g);ci(e=e.g,e.g+t)}break;case 5:ci(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!Cy(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}Pl(e)}break;default:throw Sy(e.h,e.l)}}function Ua(e,t,n){const r=e.g.l,s=hs(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function Vh(e){var t=hs(e.g),n=Ay(e=e.g,t);if(e=e.h,gx){var r,s=e;(r=Xc)||(r=Xc=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(u){if(pl===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),pl=!0}catch{pl=!1}}throw!pl&&(Xc=void 0),u}}else{t=(i=n)+t,n=[];let u,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?ei():(u=e[i++],a<194||(192&u)!=128?(i--,ei()):n.push((31&a)<<6|63&u)):a<240?i>=t-1?ei():(u=e[i++],(192&u)!=128||a===224&&u<160||a===237&&u>=160||(192&(r=e[i++]))!=128?(i--,ei()):n.push((15&a)<<12|(63&u)<<6|63&r)):a<=244?i>=t-2?ei():(u=e[i++],(192&u)!=128||u-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,ei()):(a=(7&a)<<18|(63&u)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):ei(),n.length>=8192&&(d=k1(d,n),n.length=0)}i=k1(d,n)}return i}function _y(e){const t=hs(e.g);return Ey(e.g,t)}function Xu(e,t,n){var r=hs(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var ml=[];function Kx(e){return e}let Zi;function Tr(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var Ae=class{constructor(e,t){this.u=my(e,t)}toJSON(){const e=!Zi;try{return e&&(Zi=py),jy(this)}finally{e&&(Zi=void 0)}}l(){var e=T5;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(Wu(e,0|e[je],!1))}N(){return!!(2&(0|this.u[je]))}};function jy(e){var t=e.u;{t=(e=Zi(t))!==t;let h=e.length;if(h){var n=e[h-1],r=Eh(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,u=!1;if(a)for(let m in a)isNaN(+m)?(i??(i={}))[m]=a[m]:(r=a[m],Array.isArray(r)&&(uu(r)||b1(r)&&r.size===0)&&(r=null),r==null&&(u=!0),r!=null&&((i??(i={}))[m]=r));if(u||(i=a),i)for(let m in i){u=i;break e}u=null}a=u==null?n!=null:u!==n}for(;h>0&&((i=s[h-1])==null||uu(i)||b1(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||u)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),u&&s.push(u)),d=s}else d=e}return d}function D1(e){return e?/^\d+$/.test(e)?(Uu(e),new mf(ft,Bt)):null:Qx||(Qx=new mf(0,0))}Ae.prototype.W=za,Ae.prototype.toString=function(){try{return Zi=Kx,jy(this).toString()}finally{Zi=void 0}};var mf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Qx;function z1(e){return e?/^-?\d+$/.test(e)?(Uu(e),new gf(ft,Bt)):null:Jx||(Jx=new gf(0,0))}var gf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Jx;function eo(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function No(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function Ku(e,t){if(t>=0)No(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function Ia(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function go(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function Zn(e,t,n){No(e.g,8*t+n)}function Yh(e,t){return Zn(e,t,2),t=e.g.end(),go(e,t),t.push(e.h),t}function Xh(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function Qu(e,t,n){Zn(e,t,2),No(e.g,n.length),go(e,e.g.end()),go(e,n)}function mu(e,t,n,r){n!=null&&(t=Yh(e,t),r(n,e),Xh(e,t))}function Pr(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var Kh=Pr(),Ny=Pr(),Qh=Pr(),Jh=Pr(),by=Pr(),My=Pr(),qh=Pr(),Ty=Pr(),Py=Pr(),bo=class{constructor(e,t,n){this.g=e,this.h=t,e=Kh,this.l=!!e&&n===e||!1}};function Ju(e,t){return new bo(e,t,Kh)}function Iy(e,t,n,r,s){mu(e,n,Fy(t,r),s)}const qx=Ju(function(e,t,n,r,s){return e.h===2&&(Ua(e,zh(t,r,n),s),!0)},Iy),Zx=Ju(function(e,t,n,r,s){return e.h===2&&(Ua(e,zh(t,r,n,!0),s),!0)},Iy);var qu=Symbol(),Zh=Symbol(),U1=Symbol(),H1=Symbol();let Ry,Ly;function xi(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(w){switch(typeof w){case"boolean":return fy||(fy=[0,void 0,!0]);case"number":return w>0?void 0:w===0?Vx||(Vx=[0,void 0]):[-w,void 0];case"string":return[0,w];case"object":return w}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Ry??(Ry=i),Ly??(Ly=r[a+1]),i=r[a+=2]));const u={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)u[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let w;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof bo?w=i:(w=qx,a--),w==null?void 0:w.l){i=r[++a],h=r;var m=a;typeof i=="function"&&(i=i(),h[m]=i),h=i}for(m=d+1,typeof(i=r[++a])=="number"&&i<0&&(m-=i,i=r[++a]);d<m;d++){const S=u[d];h?n(s,d,w,h,S):t(s,d,w,S)}}return r[e]=s}function By(e){return Array.isArray(e)?e[0]instanceof bo?e:[Zx,e]:[e,void 0]}function Fy(e,t){return e instanceof Ae?e.u:Array.isArray(e)?Fs(e,t,!1):void 0}function ep(e,t,n,r){const s=n.g;e[t]=r?(i,a,u)=>s(i,a,u,r):s}function tp(e,t,n,r,s){const i=n.g;let a,u;e[t]=(d,h,m)=>i(d,h,m,u||(u=xi(Zh,ep,tp,r).V),a||(a=np(r)),s)}function np(e){let t=e[U1];if(t!=null)return t;const n=xi(Zh,ep,tp,e);return t=n.la?(r,s)=>Ry(r,s,n):(r,s)=>{const i=0|r[je];for(;Cy(s)&&s.h!=4;){var a=s.m,u=n[a];if(u==null){var d=n.ga;d&&(d=d[a])&&(d=e5(d))!=null&&(u=n[a]=d)}u!=null&&u(s,r,a)||(a=(u=s).l,Pl(u),u.fa?u=void 0:(d=u.g.g-a,u.g.g=a,u=Ey(u.g,d)),a=r,u&&((d=a[fo])?d.push(u):a[fo]=[u]))}return 16384&i&&Eo(r),!0},e[U1]=t}function e5(e){const t=(e=By(e))[0].g;if(e=e[1]){const n=np(e),r=xi(Zh,ep,tp,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function Zu(e,t,n){e[t]=n.h}function ec(e,t,n,r){let s,i;const a=n.h;e[t]=(u,d,h)=>a(u,d,h,i||(i=xi(qu,Zu,ec,r).V),s||(s=Oy(r)))}function Oy(e){let t=e[H1];if(!t){const n=xi(qu,Zu,ec,e);t=(r,s)=>$y(r,s,n),e[H1]=t}return t}function $y(e,t,n){for(var r=0|e[je],s=512&r?0:-1,i=e.length,a=512&r?1:0,u=i+(256&r?-1:0);a<u;a++){const d=e[a];if(d==null)continue;const h=a-s,m=G1(n,h);m&&m(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(u=G1(n,s))&&u(t,i,s)}if(e=_h(e))for(go(t,t.g.end()),n=0;n<e.length;n++)go(t,Sh(e[n])||new Uint8Array(0))}function G1(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=By(n))[0].h;if(n=n[1]){const s=Oy(n),i=xi(qu,Zu,ec,n).V;n=e.la?Ly(i,s):(a,u,d)=>r(a,u,d,i,s)}else n=r;return e[t]=n}}function Mo(e,t){if(Array.isArray(t)){var n=0|t[je];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),Ht(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function En(e,t,n){return new bo(e,t,n)}function To(e,t,n){return new bo(e,t,n)}function Cn(e,t,n){Mt(e,0|e[je],t,n)}var t5=Ju(function(e,t,n,r,s){return e.h===2&&(e=Ua(e,Fs([void 0,void 0],r,!0),s),Vs(r=0|t[je]),(s=ms(t,r,n))instanceof yr?2&s.L?((s=s.X()).push(e),Mt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[je])&&Mt(t,r,n,s=yy(s)),s.push(e)):Mt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof yr)t.forEach((i,a)=>{mu(e,n,Fs([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&mu(e,n,Fs(a,r,!1),s)}});function Dy(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String(Th(64,r));if(Gu(r)){if(s==="string")return Ih(r);if(s==="number")return Ph(r)}}(t),t!=null&&(typeof t=="string"&&z1(t),t!=null))switch(Zn(e,n,0),typeof t){case"number":e=e.g,ho(t),eo(e,ft,Bt);break;case"bigint":n=BigInt.asUintN(64,t),n=new gf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),eo(e.g,n.h,n.g);break;default:n=z1(t),eo(e.g,n.h,n.g)}}function zy(e,t,n){(t=Co(t))!=null&&t!=null&&(Zn(e,n,0),Ku(e.g,t))}function Uy(e,t,n){(t=uy(t))!=null&&(Zn(e,n,0),e.g.g.push(t?1:0))}function Hy(e,t,n){(t=po(t))!=null&&Qu(e,n,J2(t))}function Gy(e,t,n,r,s){mu(e,n,Fy(t,r),s)}function Wy(e,t,n){(t=t==null||typeof t=="string"||$a(t)||t instanceof is?t:void 0)!=null&&Qu(e,n,Hh(t).buffer)}function Vy(e,t,n){return(e.h===5||e.h===2)&&(t=jo(t,0|t[je],n,!1,!1),e.h==2?Xu(e,pf,t):t.push(pf(e.g)),!0)}var Zr=En(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=hf(r);const s=hf(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,Cn(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Ys(t))!=null&&(Zn(e,n,1),e=e.g,(n=ly||(ly=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),ft=n.getUint32(0,!0),Bt=n.getUint32(4,!0),Ia(e,ft),Ia(e,Bt))},Pr()),Gt=En(function(e,t,n){return e.h===5&&(Cn(t,n,pf(e.g)),!0)},function(e,t,n){(t=Ys(t))!=null&&(Zn(e,n,5),e=e.g,jh(t),Ia(e,ft))},qh),n5=To(Vy,function(e,t,n){if((t=Mo(Ys,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(Zn(r,s,5),r=r.g,jh(i),Ia(r,ft))}},qh),rp=To(Vy,function(e,t,n){if((t=Mo(Ys,t))!=null&&t.length){Zn(e,n,2),No(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,jh(t[r]),Ia(n,ft)}},qh),Us=En(function(e,t,n){return e.h===0&&(Cn(t,n,Gh(e.g,bh)),!0)},Dy,My),rd=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=Gh(e.g,bh))===0?void 0:e),!0)},Dy,My),r5=En(function(e,t,n){return e.h===0&&(Cn(t,n,Gh(e.g,Nh)),!0)},function(e,t,n){if((t=Ox(t))!=null&&(typeof t=="string"&&D1(t),t!=null))switch(Zn(e,n,0),typeof t){case"number":e=e.g,ho(t),eo(e,ft,Bt);break;case"bigint":n=BigInt.asUintN(64,t),n=new mf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),eo(e.g,n.h,n.g);break;default:n=D1(t),eo(e.g,n.h,n.g)}},Pr()),Ft=En(function(e,t,n){return e.h===0&&(Cn(t,n,zs(e.g)),!0)},zy,Jh),tc=To(function(e,t,n){return(e.h===0||e.h===2)&&(t=jo(t,0|t[je],n,!1,!1),e.h==2?Xu(e,zs,t):t.push(zs(e.g)),!0)},function(e,t,n){if((t=Mo(Co,t))!=null&&t.length){n=Yh(e,n);for(let r=0;r<t.length;r++)Ku(e.g,t[r]);Xh(e,n)}},Jh),Gi=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=zs(e.g))===0?void 0:e),!0)},zy,Jh),Et=En(function(e,t,n){return e.h===0&&(Cn(t,n,Wh(e.g)),!0)},Uy,Ny),to=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=Wh(e.g))===!1?void 0:e),!0)},Uy,Ny),fn=To(function(e,t,n){return e.h===2&&(e=Vh(e),jo(t,0|t[je],n,!1).push(e),!0)},function(e,t,n){if((t=Mo(po,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&Qu(r,s,J2(i))}},Qh),_s=En(function(e,t,n){return e.h===2&&(Cn(t,n,(e=Vh(e))===""?void 0:e),!0)},Hy,Qh),st=En(function(e,t,n){return e.h===2&&(Cn(t,n,Vh(e)),!0)},Hy,Qh),Yt=function(e,t,n=Kh){return new bo(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=Fs(void 0,r,!0),jo(t,0|t[je],n,!0).push(r),Ua(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)Gy(e,t[i],n,r,s)}),ot=Ju(function(e,t,n,r,s,i){return e.h===2&&(vy(t,0|t[je],i,n),Ua(e,t=zh(t,r,n),s),!0)},Gy),Yy=En(function(e,t,n){return e.h===2&&(Cn(t,n,_y(e)),!0)},Wy,Ty),s5=To(function(e,t,n){return(e.h===0||e.h===2)&&(t=jo(t,0|t[je],n,!1,!1),e.h==2?Xu(e,hs,t):t.push(hs(e.g)),!0)},function(e,t,n){if((t=Mo(cy,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(Zn(r,s,0),No(r.g,i))}},by),i5=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=hs(e.g))===0?void 0:e),!0)},function(e,t,n){(t=cy(t))!=null&&t!=null&&(Zn(e,n,0),No(e.g,t))},by),wr=En(function(e,t,n){return e.h===0&&(Cn(t,n,zs(e.g)),!0)},function(e,t,n){(t=Co(t))!=null&&(t=parseInt(t,10),Zn(e,n,0),Ku(e.g,t))},Py);class o5{constructor(t,n){this.h=t,this.g=n,this.l=et,this.m=Pe,this.defaultValue=void 0}}function Ir(e,t){return new o5(e,t)}function Xs(e,t){return(n,r)=>{if(ml.length){const i=ml.pop();i.o(r),nd(i.g,n,r),n=i}else n=new class{constructor(i,a){if($1.length){const u=$1.pop();nd(u,i,a),i=u}else i=new class{constructor(u,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,nd(this,u,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;np(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,ml.length<100&&ml.push(n)}return s}}function nc(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};$y(this.u,t,xi(qu,Zu,ec,e)),go(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const u=r[a];n.set(u,i),i+=u.length}return t.l=[n],n}}var W1=class extends Ae{constructor(e){super(e)}},V1=[0,_s,En(function(e,t,n){return e.h===2&&(Cn(t,n,(e=_y(e))===yi()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof Ae){const r=t.Ra;return void(r&&(t=r(t),t!=null&&Qu(e,n,Hh(t).buffer)))}if(Array.isArray(t))return}Wy(e,t,n)},Ty)];let sd,Y1=globalThis.trustedTypes;function X1(e){sd===void 0&&(sd=function(){let n=null;if(!Y1)return n;try{const r=s=>s;n=Y1.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=sd;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function a5(e,...t){if(t.length===0)return X1(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return X1(n)}var Xy=[0,Ft,wr,Et,-1,tc,wr,-1],l5=class extends Ae{constructor(e){super(e)}},Ky=[0,Et,st,Et,wr,-1,To(function(e,t,n){return(e.h===0||e.h===2)&&(t=jo(t,0|t[je],n,!1,!1),e.h==2?Xu(e,Xx,t):t.push(zs(e.g)),!0)},function(e,t,n){if((t=Mo(Co,t))!=null&&t.length){n=Yh(e,n);for(let r=0;r<t.length;r++)Ku(e.g,t[r]);Xh(e,n)}},Py),st,-1,[0,Et,-1],wr,Et,-1],Qy=[0,st,-2],K1=class extends Ae{constructor(e){super(e)}},Jy=[0],qy=[0,Ft,Et,1,Et,-3],Qn=class extends Ae{constructor(e){super(e,2)}},Wt={};Wt[336783863]=[0,st,Et,-1,Ft,[0,[1,2,3,4,5,6,7,8],ot,Jy,ot,Ky,ot,Qy,ot,qy,ot,Xy,ot,[0,st,-2],ot,[0,st,wr],ot,[0,wr,st]],[0,st],Et,[0,[1,3],[2,4],ot,[0,tc],-1,ot,[0,fn],-1,Yt,[0,st,-1]],st];var Q1=[0,rd,-1,to,-3,rd,tc,_s,Gi,rd,-1,to,Gi,to,-2,_s];function er(e,t){ff(e,2,_o(t),"")}function gt(e,t){Yu(e,3,t)}function Ke(e,t){Yu(e,4,t)}var Sn=class extends Ae{constructor(e){super(e,500)}o(e){return Pe(this,0,7,e)}},da=[-1,{}],J1=[0,st,1,da],q1=[0,st,fn,da];function tr(e,t){hu(e,1,Sn,t)}function xt(e,t){Yu(e,10,t)}function rt(e,t){Yu(e,15,t)}var Ln=class extends Ae{constructor(e){super(e,500)}o(e){return Pe(this,0,1001,e)}},Zy=[-500,Yt,[-500,_s,-1,fn,-3,[-2,Wt,Et],Yt,V1,Gi,-1,J1,q1,Yt,[0,_s,to],_s,Q1,Gi,fn,987,fn],4,Yt,[-500,st,-1,[-1,{}],998,st],Yt,[-500,st,fn,-1,[-2,{},Et],997,fn,-1],Gi,Yt,[-500,st,fn,da,998,fn],fn,Gi,J1,q1,Yt,[0,_s,-1,da],fn,-2,Q1,_s,-1,to,[0,to,i5],978,da,Yt,V1];Ln.prototype.g=nc(Zy);var u5=Xs(Ln,Zy),c5=class extends Ae{constructor(e){super(e)}},ev=class extends Ae{constructor(e){super(e)}g(){return fs(this,c5,1)}},tv=[0,Yt,[0,Ft,Gt,st,-1]],rc=Xs(ev,tv),d5=class extends Ae{constructor(e){super(e)}},f5=class extends Ae{constructor(e){super(e)}},id=class extends Ae{constructor(e){super(e)}h(){return et(this,d5,2)}g(){return fs(this,f5,5)}},nv=Xs(class extends Ae{constructor(e){super(e)}},[0,fn,tc,rp,[0,wr,[0,Ft,-3],[0,Gt,-3],[0,Ft,-1,[0,Yt,[0,Ft,-2]]],Yt,[0,Gt,-1,st,Gt]],st,-1,Us,Yt,[0,Ft,Gt],fn,Us]),rv=class extends Ae{constructor(e){super(e)}},no=Xs(class extends Ae{constructor(e){super(e)}},[0,Yt,[0,Gt,-4]]),sv=class extends Ae{constructor(e){super(e)}},Ha=Xs(class extends Ae{constructor(e){super(e)}},[0,Yt,[0,Gt,-4]]),h5=class extends Ae{constructor(e){super(e)}},p5=[0,Ft,-1,rp,wr],iv=class extends Ae{constructor(e){super(e)}};iv.prototype.g=nc([0,Gt,-4,Us]);var m5=class extends Ae{constructor(e){super(e)}},g5=Xs(class extends Ae{constructor(e){super(e)}},[0,Yt,[0,1,Ft,st,tv],Us]),Z1=class extends Ae{constructor(e){super(e)}},y5=class extends Ae{constructor(e){super(e)}oa(){const e=gy(this);return e??yi()}},v5=class extends Ae{constructor(e){super(e)}},ov=[1,2],w5=Xs(class extends Ae{constructor(e){super(e)}},[0,Yt,[0,ov,ot,[0,rp],ot,[0,Yy],Ft,st],Us]),sp=class extends Ae{constructor(e){super(e)}},av=[0,st,Ft,Gt,fn,-1],e0=class extends Ae{constructor(e){super(e)}},x5=[0,Et,-1],t0=class extends Ae{constructor(e){super(e)}},Il=[1,2,3,4,5],gu=class extends Ae{constructor(e){super(e)}g(){return gy(this)!=null}h(){return vr(this,2)!=null}},Ct=class extends Ae{constructor(e){super(e)}g(){return uy(mo(this,2))??!1}},lv=[0,Yy,st,[0,Ft,Us,-1],[0,r5,Us]],Dt=[0,lv,Et,[0,Il,ot,qy,ot,Ky,ot,Xy,ot,Jy,ot,Qy],wr],sc=class extends Ae{constructor(e){super(e)}},ip=[0,Dt,Gt,-1,Ft],S5=Ir(502141897,sc);Wt[502141897]=ip;var k5=Xs(class extends Ae{constructor(e){super(e)}},[0,[0,wr,-1,n5,s5],p5]),uv=class extends Ae{constructor(e){super(e)}},cv=class extends Ae{constructor(e){super(e)}},op=[0,Dt,Gt,[0,Dt],Et],dv=[0,Dt,ip,op,Gt,[0,[0,lv]]],A5=Ir(508968150,cv);Wt[508968150]=dv,Wt[508968149]=op;var fv=class extends Ae{constructor(e){super(e)}},E5=Ir(513916220,fv);Wt[513916220]=[0,Dt,dv,Ft];var Ni=class extends Ae{constructor(e){super(e)}h(){return et(this,sp,2)}g(){pt(this,2)}},hv=[0,Dt,av];Wt[478825465]=hv;var C5=class extends Ae{constructor(e){super(e)}},pv=class extends Ae{constructor(e){super(e)}},ap=class extends Ae{constructor(e){super(e)}},lp=class extends Ae{constructor(e){super(e)}},mv=class extends Ae{constructor(e){super(e)}},n0=[0,Dt,[0,Dt],hv,-1],gv=[0,Dt,Gt,Ft],up=[0,Dt,Gt],yv=[0,Dt,gv,up,Gt],_5=Ir(479097054,mv);Wt[479097054]=[0,Dt,yv,n0],Wt[463370452]=n0,Wt[464864288]=gv;var j5=Ir(462713202,lp);Wt[462713202]=yv,Wt[474472470]=up;var N5=class extends Ae{constructor(e){super(e)}},vv=class extends Ae{constructor(e){super(e)}},wv=class extends Ae{constructor(e){super(e)}},xv=class extends Ae{constructor(e){super(e)}},cp=[0,Dt,Gt,-1,Ft],yf=[0,Dt,Gt,Et];xv.prototype.g=nc([0,Dt,up,[0,Dt],ip,op,cp,yf]);var Sv=class extends Ae{constructor(e){super(e)}},b5=Ir(456383383,Sv);Wt[456383383]=[0,Dt,av];var kv=class extends Ae{constructor(e){super(e)}},M5=Ir(476348187,kv);Wt[476348187]=[0,Dt,x5];var Av=class extends Ae{constructor(e){super(e)}},r0=class extends Ae{constructor(e){super(e)}},Ev=[0,wr,-1],T5=Ir(458105876,class extends Ae{constructor(e){super(e)}g(){var e=this.u;const t=0|e[je],n=2&t;return e=function(r,s,i){var a=r0;const u=2&s;let d=!1;if(i==null){if(u)return O1();i=[]}else if(i.constructor===yr){if(!(2&i.L)||u)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[je])):i=[];if(u){if(!i.length)return O1();d||(d=!0,Eo(i))}else d&&(d=!1,i=yy(i));return d||(64&(0|i[je])?i[je]&=-33:32&s&&$u(i,32)),Mt(r,s,2,a=new yr(i,a,$x,void 0)),a}(e,t,ms(e,t,2)),!n&&r0&&(e.ra=!0),e}});Wt[458105876]=[0,Ev,t5,[!0,Us,[0,st,-1,fn]]];var dp=class extends Ae{constructor(e){super(e)}},Cv=Ir(458105758,dp);Wt[458105758]=[0,Dt,st,Ev];var _v=class extends Ae{constructor(e){super(e)}},P5=Ir(443442058,_v);Wt[443442058]=[0,Dt,st,Ft,Gt,fn,-1,Et,Gt],Wt[514774813]=cp;var jv=class extends Ae{constructor(e){super(e)}},I5=Ir(516587230,jv);function vf(e,t){return t=t?t.clone():new sp,e.displayNamesLocale!==void 0?pt(t,1,_o(e.displayNamesLocale)):e.displayNamesLocale===void 0&&pt(t,1),e.maxResults!==void 0?Xr(t,2,e.maxResults):"maxResults"in e&&pt(t,2),e.scoreThreshold!==void 0?Ee(t,3,e.scoreThreshold):"scoreThreshold"in e&&pt(t,3),e.categoryAllowlist!==void 0?pu(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&pt(t,4),e.categoryDenylist!==void 0?pu(t,5,e.categoryDenylist):"categoryDenylist"in e&&pt(t,5),t}function fp(e,t=-1,n=""){return{categories:e.map(r=>({index:hr(r,1)??0??-1,score:Ot(r,2)??0,categoryName:vr(r,3)??""??"",displayName:vr(r,4)??""??""})),headIndex:t,headName:n}}function Nv(e){var a,u;var t=ai(e,3,Ys,oi()),n=ai(e,2,Co,oi()),r=ai(e,1,po,oi()),s=ai(e,9,po,oi());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=et(e,id,4))==null?void 0:a.h())&&(i.boundingBox={originX:hr(t,1)??0,originY:hr(t,2)??0,width:hr(t,3)??0,height:hr(t,4)??0,angle:0}),(u=et(e,id,4))==null?void 0:u.g().length)for(const d of et(e,id,4).g())i.keypoints.push({x:Tl(d,1)??0,y:Tl(d,2)??0,score:Tl(d,4)??0,label:vr(d,3)??""});return i}function ic(e){const t=[];for(const n of fs(e,sv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function fa(e){const t=[];for(const n of fs(e,rv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function s0(e){return Array.from(e,t=>t>127?t-256:t)}function i0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let gl;Wt[516587230]=[0,Dt,cp,yf,Gt],Wt[518928384]=yf;const R5=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function bv(){if(gl===void 0)try{await WebAssembly.instantiate(R5),gl=!0}catch{gl=!1}return gl}async function Yo(e,t=a5``){const n=await bv()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var ks=class{};function Mv(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function o0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function Tv(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function _e(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function a0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=Tv(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function l0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function Dr(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function ws(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}ks.forVisionTasks=function(e){return Yo("vision",e)},ks.forTextTasks=function(e){return Yo("text",e)},ks.forGenAiExperimentalTasks=function(e){return Yo("genai_experimental",e)},ks.forGenAiTasks=function(e){return Yo("genai",e)},ks.forAudioTasks=function(e){return Yo("audio",e)},ks.isSimdSupported=function(){return bv()};async function L5(e,t,n,r){return e=await(async(s,i,a,u,d)=>{if(i&&await o0(i),!self.ModuleFactory||a&&(await o0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,u)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function od(e,t){const n=et(e.baseOptions,gu,1)||new gu;typeof t=="string"?(pt(n,2,_o(t)),pt(n,1)):t instanceof Uint8Array&&(pt(n,1,Ch(t,!1)),pt(n,2)),Pe(e.baseOptions,0,1,n)}function u0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function ke(e,t){e.B=Math.max(e.B,t)}function oc(e,t){e.A=new Sn,er(e.A,"PassThroughCalculator"),gt(e.A,"free_memory"),Ke(e.A,"free_memory_unused_out"),xt(t,"free_memory"),tr(t,e.A)}function yo(e,t){gt(e.A,t),Ke(e.A,t+"_unused_out")}function ac(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var Rl=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,u;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=et(this.baseOptions,gu,1))!=null&&s.g()||(i=et(this.baseOptions,gu,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(u=e.baseOptions)!=null&&u.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,m){let w=et(h.baseOptions,t0,3);if(!w){var S=w=new t0,_=new K1;ca(S,4,Il,_)}"delegate"in m&&(m.delegate==="GPU"?(m=w,S=new l5,ca(m,2,Il,S)):(m=w,S=new K1,ca(m,4,Il,S))),Pe(h.baseOptions,0,3,w)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),od(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)od(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const m=[];for(var w=0;;){const{done:S,value:_}=await h.read();if(S)break;m.push(_),w+=_.length}if(m.length===0)return new Uint8Array(0);if(m.length===1)return m[0];h=new Uint8Array(w),w=0;for(const S of m)h.set(S,w),w+=S.length;return h}(d.modelAssetBuffer).then(h=>{od(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=u5(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,u0(this)}finishProcessing(){this.g.finishProcessing(),u0(this)}close(){this.A=void 0,this.g.closeGraph()}};function as(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Rl.prototype.close=Rl.prototype.close,function(e,t){e=e.split(".");var n,r=gi;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",Rl);class B5{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function c0(e,t,n){const r=e.g;if(n=as(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function d0(e,t){const n=e.g,r=as(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=as(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=as(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new B5(n,r,s,i)}function hp(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function pp(e,t,n,r){return hp(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=d0(e,!0)),n=e.s):(e.v||(e.v=d0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function lc(e,t,n){return hp(e,t),e=as(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function uc(e,t,n){hp(e,t),e.A||(e.A=as(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function mp(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var gp=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=as(e.createProgram(),"Failed to create WebGL program"),this.aa=c0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=c0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function es(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function wf(e){var t=es(e,1);if(!t){if(t=es(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=vo(e);var n=yp(e);if(uc(n,r,Pv(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function Pv(e){let t=es(e,2);if(!t){const n=vo(e);t=Rv(e);const r=wf(e),s=Iv(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),xf(e)}return t}function vo(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=as(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Iv(e){if(e=vo(e),!yl)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))yl=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");yl=e.R16F}return yl}function yp(e){return e.l||(e.l=new gp),e.l}function Rv(e){const t=vo(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=es(e,2);return n||(n=lc(yp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function xf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var yl,Qt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--f0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!es(this,0)}ja(){return!!es(this,1)}P(){return!!es(this,2)}ia(){return(t=es(e=this,0))||(t=wf(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return wf(this)}M(){return Pv(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=vo(this),s=yp(this);r.activeTexture(r.TEXTURE1),n=lc(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=Iv(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),uc(s,r,n),pp(s,r,!1,()=>{Rv(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),xf(this)}),mp(s),xf(this)}}e.push(n)}return new Qt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&vo(this).deleteTexture(es(this,2)),f0=-1}};Qt.prototype.close=Qt.prototype.close,Qt.prototype.clone=Qt.prototype.clone,Qt.prototype.getAsWebGLTexture=Qt.prototype.M,Qt.prototype.getAsFloat32Array=Qt.prototype.ha,Qt.prototype.getAsUint8Array=Qt.prototype.ia,Qt.prototype.hasWebGLTexture=Qt.prototype.P,Qt.prototype.hasFloat32Array=Qt.prototype.ja,Qt.prototype.hasUint8Array=Qt.prototype.Fa;var f0=250;function Gr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function Lv(e){var t=Gr(e,0);if(!t){t=wo(e);const n=cc(e),r=new Uint8Array(e.width*e.height*4);uc(n,t,Ll(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),mp(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function Ll(e){let t=Gr(e,2);if(!t){const n=wo(e);t=Bl(e);const r=Gr(e,1)||Lv(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),Zo(e)}return t}function wo(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=as(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function cc(e){return e.l||(e.l=new gp),e.l}function Bl(e){const t=wo(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Gr(e,2);return n||(n=lc(cc(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Zo(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function h0(e){const t=wo(e);return pp(cc(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var Jt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--p0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Gr(this,0)}ka(){return!!Gr(this,1)}P(){return!!Gr(this,2)}Ca(){return Lv(this)}Ba(){var e=Gr(this,1);return e||(Ll(this),Bl(this),e=h0(this),Zo(this),this.g.push(e),this.j=!0),e}M(){return Ll(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=wo(this),s=cc(this);r.activeTexture(r.TEXTURE1),n=lc(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),uc(s,r,n),pp(s,r,!1,()=>{Bl(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Zo(this)}),mp(s),Zo(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Ll(this),Bl(this),n=h0(this),Zo(this)}e.push(n)}return new Jt(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Gr(this,1).close(),this.m&&wo(this).deleteTexture(Gr(this,2)),p0=-1}};Jt.prototype.close=Jt.prototype.close,Jt.prototype.clone=Jt.prototype.clone,Jt.prototype.getAsWebGLTexture=Jt.prototype.M,Jt.prototype.getAsImageBitmap=Jt.prototype.Ba,Jt.prototype.getAsImageData=Jt.prototype.Ca,Jt.prototype.hasWebGLTexture=Jt.prototype.P,Jt.prototype.hasImageBitmap=Jt.prototype.ka,Jt.prototype.hasImageData=Jt.prototype.Ea;var p0=250;function Rr(...e){return e.map(([t,n])=>({start:t,end:n}))}const F5=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((m0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:Mv()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),_e(this,r||"input_audio",i=>{_e(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){Dr(this,"__graph_config__",t=>{e(t)}),_e(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),_e(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){_e(this,t,r=>{const[s,i]=a0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){_e(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){_e(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){_e(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){_e(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){_e(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){_e(this,t,r=>{_e(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){_e(this,t,r=>{l0(this,Object.keys(e),s=>{l0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){_e(this,n,s=>{_e(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){_e(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){_e(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){_e(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){_e(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){_e(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){_e(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){_e(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)_e(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){_e(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){_e(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){_e(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){_e(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){_e(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){_e(this,t,n=>{_e(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){_e(this,n,r=>{_e(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){_e(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){_e(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){_e(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){_e(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){_e(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){_e(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)_e(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){Dr(this,e,t),_e(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){ws(this,e,t),_e(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){Dr(this,e,t),_e(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){ws(this,e,t),_e(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){Dr(this,e,t),_e(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){ws(this,e,t),_e(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){Dr(this,e,t),_e(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){ws(this,e,t),_e(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){Dr(this,e,t),_e(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){ws(this,e,t),_e(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){Dr(this,e,t),_e(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){ws(this,e,t),_e(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){Dr(this,e,t),_e(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){ws(this,e,t),_e(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Dr(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),_e(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends m0{get ea(){return this.i}qa(e,t,n){_e(this,t,r=>{const[s,i]=a0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){Dr(this,e,t),_e(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){ws(this,e,t),_e(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var m0,xr=class extends F5{};async function Xe(e,t,n){return async function(r,s,i,a){return L5(r,s,i,a)}(e,n.canvas??(Mv()?void 0:document.createElement("canvas")),t,n)}function Bv(e,t,n,r){if(e.T){const i=new iv;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");Ee(i,1,(s.left+s.right)/2),Ee(i,2,(s.top+s.bottom)/2),Ee(i,4,s.right-s.left),Ee(i,3,s.bottom-s.top)}else Ee(i,1,.5),Ee(i,2,.5),Ee(i,4,1),Ee(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(Ee(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,u]=Tv(t);n=Ot(i,3)*u/a,s=Ot(i,4)*a/u,Ee(i,4,n),Ee(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function Sr(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Bv(e,t,n,e.B+1)}function Kr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Bv(e,t,n,r)}function xo(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new Qt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Rn=class extends Rl{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new gp}l(e,t=!0){if("runningMode"in e&&Pa(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Rn.prototype.close=Rn.prototype.close;var or=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Pe(e=this.h=new sc,0,1,t=new Ct),Ee(this.h,2,.5),Ee(this.h,3,.3)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&Ee(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&Ee(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},Sr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Kr(this,e,n,t),this.j}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect_in"),rt(e,"detections");const t=new Qn;Tr(t,S5,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect_in"),Ke(n,"DETECTIONS:detections"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=nv(i),this.j.detections.push(Nv(r));ke(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};or.prototype.detectForVideo=or.prototype.F,or.prototype.detect=or.prototype.D,or.prototype.setOptions=or.prototype.o,or.createFromModelPath=async function(e,t){return Xe(or,e,{baseOptions:{modelAssetPath:t}})},or.createFromModelBuffer=function(e,t){return Xe(or,e,{baseOptions:{modelAssetBuffer:t}})},or.createFromOptions=function(e,t){return Xe(or,e,t)};var vp=Rr([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),wp=Rr([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),xp=Rr([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),Fv=Rr([474,475],[475,476],[476,477],[477,474]),Sp=Rr([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),kp=Rr([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Ov=Rr([469,470],[470,471],[471,472],[472,469]),Ap=Rr([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),$v=[...vp,...wp,...xp,...Sp,...kp,...Ap],Dv=Rr([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function g0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var Rt=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Pe(e=this.h=new cv,0,1,t=new Ct),this.v=new uv,Pe(this.h,0,3,this.v),this.s=new sc,Pe(this.h,0,2,this.s),Xr(this.s,4,1),Ee(this.s,2,.5),Ee(this.v,2,.5),Ee(this.h,4,.5)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numFaces"in e&&Xr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&Ee(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&Ee(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&Ee(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return g0(this),Sr(this,e,t),this.j}F(e,t,n){return g0(this),Kr(this,e,n,t),this.j}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect"),rt(e,"face_landmarks");const t=new Qn;Tr(t,A5,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=Ha(i),this.j.faceLandmarks.push(ic(r));ke(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{ke(this,r)}),this.outputFaceBlendshapes&&(rt(e,"blendshapes"),Ke(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=rc(i),this.j.faceBlendshapes.push(fp(r.g()??[]));ke(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{ke(this,r)})),this.outputFacialTransformationMatrixes&&(rt(e,"face_geometry"),Ke(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=et(k5(i),h5,2))&&this.j.facialTransformationMatrixes.push({rows:hr(r,1)??0??0,columns:hr(r,2)??0??0,data:ai(r,3,Ys,oi()).slice()??[]});ke(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{ke(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Rt.prototype.detectForVideo=Rt.prototype.F,Rt.prototype.detect=Rt.prototype.D,Rt.prototype.setOptions=Rt.prototype.o,Rt.createFromModelPath=function(e,t){return Xe(Rt,e,{baseOptions:{modelAssetPath:t}})},Rt.createFromModelBuffer=function(e,t){return Xe(Rt,e,{baseOptions:{modelAssetBuffer:t}})},Rt.createFromOptions=function(e,t){return Xe(Rt,e,t)},Rt.FACE_LANDMARKS_LIPS=vp,Rt.FACE_LANDMARKS_LEFT_EYE=wp,Rt.FACE_LANDMARKS_LEFT_EYEBROW=xp,Rt.FACE_LANDMARKS_LEFT_IRIS=Fv,Rt.FACE_LANDMARKS_RIGHT_EYE=Sp,Rt.FACE_LANDMARKS_RIGHT_EYEBROW=kp,Rt.FACE_LANDMARKS_RIGHT_IRIS=Ov,Rt.FACE_LANDMARKS_FACE_OVAL=Ap,Rt.FACE_LANDMARKS_CONTOURS=$v,Rt.FACE_LANDMARKS_TESSELATION=Dv;var zr=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!0),Pe(e=this.j=new fv,0,1,t=new Ct)}get baseOptions(){return et(this.j,Ct,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,Sr(this,e,r??{}),!this.h)return this.s}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect"),rt(e,"stylized_image");const t=new Qn;Tr(t,E5,this.j);const n=new Sn;er(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),tr(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,u=r.width;const d=u*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let m=0;m<d;++m)h[4*m]=a[3*m],h[4*m+1]=a[3*m+1],h[4*m+2]=a[3*m+2],h[4*m+3]=255;a=new ImageData(h,u,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),u,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);u=new Jt([a],!1,!1,this.g.i.canvas,this.O,u,r),this.s=i=i?u.clone():u,this.h&&this.h(i),ke(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};zr.prototype.stylize=zr.prototype.Oa,zr.prototype.setOptions=zr.prototype.o,zr.createFromModelPath=function(e,t){return Xe(zr,e,{baseOptions:{modelAssetPath:t}})},zr.createFromModelBuffer=function(e,t){return Xe(zr,e,{baseOptions:{modelAssetBuffer:t}})},zr.createFromOptions=function(e,t){return Xe(zr,e,t)};var Ep=Rr([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function y0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function v0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function w0(e,t=!0){const n=[];for(const s of e){var r=rc(s);e=[];for(const i of r.g())r=t&&hr(i,1)!=null?hr(i,1)??0:-1,e.push({score:Ot(i,2)??0,index:r,categoryName:vr(i,3)??""??"",displayName:vr(i,4)??""??""});n.push(e)}return n}var Un=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Pe(e=this.j=new mv,0,1,t=new Ct),this.s=new lp,Pe(this.j,0,2,this.s),this.C=new ap,Pe(this.s,0,3,this.C),this.v=new pv,Pe(this.s,0,2,this.v),this.h=new C5,Pe(this.j,0,3,this.h),Ee(this.v,2,.5),Ee(this.s,4,.5),Ee(this.C,2,.5)}get baseOptions(){return et(this.j,Ct,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){var s,i,a,u;if(Xr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&Ee(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Ee(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Ee(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new Ni,n=t,r=vf(e.cannedGesturesClassifierOptions,(s=et(this.h,Ni,3))==null?void 0:s.h());Pe(n,0,2,r),Pe(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=et(this.h,Ni,3))==null||i.g());return e.customGesturesClassifierOptions?(Pe(n=t=new Ni,0,2,r=vf(e.customGesturesClassifierOptions,(a=et(this.h,Ni,4))==null?void 0:a.h())),Pe(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((u=et(this.h,Ni,4))==null||u.g()),this.l(e)}Ja(e,t){return y0(this),Sr(this,e,t),v0(this)}Ka(e,t,n){return y0(this),Kr(this,e,n,t),v0(this)}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect"),rt(e,"hand_gestures"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Qn;Tr(t,_5,this.j);const n=new Sn;er(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"HAND_GESTURES:hand_gestures"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=Ha(i);const a=[];for(const u of fs(r,sv,1))a.push({x:Ot(u,1)??0,y:Ot(u,2)??0,z:Ot(u,3)??0,visibility:Ot(u,4)??0});this.landmarks.push(a)}ke(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=no(i);const a=[];for(const u of fs(r,rv,1))a.push({x:Ot(u,1)??0,y:Ot(u,2)??0,z:Ot(u,3)??0,visibility:Ot(u,4)??0});this.worldLandmarks.push(a)}ke(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...w0(r,!1)),ke(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{ke(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...w0(r)),ke(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function x0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Un.prototype.recognizeForVideo=Un.prototype.Ka,Un.prototype.recognize=Un.prototype.Ja,Un.prototype.setOptions=Un.prototype.o,Un.createFromModelPath=function(e,t){return Xe(Un,e,{baseOptions:{modelAssetPath:t}})},Un.createFromModelBuffer=function(e,t){return Xe(Un,e,{baseOptions:{modelAssetBuffer:t}})},Un.createFromOptions=function(e,t){return Xe(Un,e,t)},Un.HAND_CONNECTIONS=Ep;var Hn=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Pe(e=this.h=new lp,0,1,t=new Ct),this.s=new ap,Pe(this.h,0,3,this.s),this.j=new pv,Pe(this.h,0,2,this.j),Xr(this.j,3,1),Ee(this.j,2,.5),Ee(this.s,2,.5),Ee(this.h,4,.5)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numHands"in e&&Xr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&Ee(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Ee(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Ee(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Sr(this,e,t),x0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Kr(this,e,n,t),x0(this)}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Qn;Tr(t,j5,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=Ha(i),this.landmarks.push(ic(r));ke(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=no(i),this.worldLandmarks.push(fa(r));ke(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const u=[];for(const d of r){r=rc(d);const h=[];for(const m of r.g())h.push({score:Ot(m,2)??0,index:hr(m,1)??0??-1,categoryName:vr(m,3)??""??"",displayName:vr(m,4)??""??""});u.push(h)}a.call(i,...u),ke(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Hn.prototype.detectForVideo=Hn.prototype.F,Hn.prototype.detect=Hn.prototype.D,Hn.prototype.setOptions=Hn.prototype.o,Hn.createFromModelPath=function(e,t){return Xe(Hn,e,{baseOptions:{modelAssetPath:t}})},Hn.createFromModelBuffer=function(e,t){return Xe(Hn,e,{baseOptions:{modelAssetBuffer:t}})},Hn.createFromOptions=function(e,t){return Xe(Hn,e,t)},Hn.HAND_CONNECTIONS=Ep;var zv=Rr([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function S0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function k0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{ac(e)}}function vl(e,t){e=Ha(e),t.push(ic(e))}var kt=class extends Rn{constructor(e,t){super(new xr(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Pe(e=this.j=new xv,0,1,t=new Ct),this.J=new ap,Pe(this.j,0,2,this.J),this.Z=new N5,Pe(this.j,0,3,this.Z),this.s=new sc,Pe(this.j,0,4,this.s),this.H=new uv,Pe(this.j,0,5,this.H),this.v=new vv,Pe(this.j,0,6,this.v),this.K=new wv,Pe(this.j,0,7,this.K),Ee(this.s,2,.5),Ee(this.s,3,.3),Ee(this.H,2,.5),Ee(this.v,2,.5),Ee(this.v,3,.3),Ee(this.K,2,.5),Ee(this.J,2,.5)}get baseOptions(){return et(this.j,Ct,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&Ee(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&Ee(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&Ee(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&Ee(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&Ee(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&Ee(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&Ee(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,S0(this),Sr(this,e,r),k0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,S0(this),Kr(this,e,s,t),k0(this)}m(){var e=new Ln;xt(e,"input_frames_image"),rt(e,"pose_landmarks"),rt(e,"pose_world_landmarks"),rt(e,"face_landmarks"),rt(e,"left_hand_landmarks"),rt(e,"left_hand_world_landmarks"),rt(e,"right_hand_landmarks"),rt(e,"right_hand_world_landmarks");const t=new Qn,n=new W1;ff(n,1,_o("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))pt(s,2,py(i));else{if(!(typeof i=="string"||i instanceof is||$a(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");ff(s,2,Ch(i,!1),yi())}}(n,this.j.g());const r=new Sn;er(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),hu(r,8,W1,n),gt(r,"IMAGE:input_frames_image"),Ke(r,"POSE_LANDMARKS:pose_landmarks"),Ke(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Ke(r,"FACE_LANDMARKS:face_landmarks"),Ke(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Ke(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Ke(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Ke(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),tr(e,r),oc(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{vl(s,this.h.poseLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=no(s),a.push(fa(s)),ke(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{ke(this,s)}),this.outputPoseSegmentationMasks&&(Ke(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),yo(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[xo(this,s,!0,!this.C)],ke(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],ke(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{vl(s,this.h.faceLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{ke(this,s)}),this.outputFaceBlendshapes&&(rt(e,"extra_blendshapes"),Ke(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=rc(s),a.push(fp(s.g()??[]))),ke(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{ke(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{vl(s,this.h.leftHandLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=no(s),a.push(fa(s)),ke(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{vl(s,this.h.rightHandLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=no(s),a.push(fa(s)),ke(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{ke(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};kt.prototype.detectForVideo=kt.prototype.F,kt.prototype.detect=kt.prototype.D,kt.prototype.setOptions=kt.prototype.o,kt.createFromModelPath=function(e,t){return Xe(kt,e,{baseOptions:{modelAssetPath:t}})},kt.createFromModelBuffer=function(e,t){return Xe(kt,e,{baseOptions:{modelAssetBuffer:t}})},kt.createFromOptions=function(e,t){return Xe(kt,e,t)},kt.HAND_CONNECTIONS=Ep,kt.POSE_CONNECTIONS=zv,kt.FACE_LANDMARKS_LIPS=vp,kt.FACE_LANDMARKS_LEFT_EYE=wp,kt.FACE_LANDMARKS_LEFT_EYEBROW=xp,kt.FACE_LANDMARKS_LEFT_IRIS=Fv,kt.FACE_LANDMARKS_RIGHT_EYE=Sp,kt.FACE_LANDMARKS_RIGHT_EYEBROW=kp,kt.FACE_LANDMARKS_RIGHT_IRIS=Ov,kt.FACE_LANDMARKS_FACE_OVAL=Ap,kt.FACE_LANDMARKS_CONTOURS=$v,kt.FACE_LANDMARKS_TESSELATION=Dv;var ar=class extends Rn{constructor(e,t){super(new xr(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Pe(e=this.h=new Sv,0,1,t=new Ct)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return Pe(this.h,0,2,vf(e,et(this.h,sp,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},Sr(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},Kr(this,e,n,t),this.j}m(){var e=new Ln;xt(e,"input_image"),xt(e,"norm_rect"),rt(e,"classifications");const t=new Qn;Tr(t,b5,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),gt(n,"IMAGE:input_image"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"CLASSIFICATIONS:classifications"),n.o(t),tr(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:fs(i,m5,1).map(u=>{var d;return fp(((d=et(u,ev,4))==null?void 0:d.g())??[],hr(u,2)??0,vr(u,3)??"")})};return fu(mo(i,2))!=null&&(a.timestampMs=fu(mo(i,2))??0),a}(g5(r)),ke(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ar.prototype.classifyForVideo=ar.prototype.ta,ar.prototype.classify=ar.prototype.sa,ar.prototype.setOptions=ar.prototype.o,ar.createFromModelPath=function(e,t){return Xe(ar,e,{baseOptions:{modelAssetPath:t}})},ar.createFromModelBuffer=function(e,t){return Xe(ar,e,{baseOptions:{modelAssetBuffer:t}})},ar.createFromOptions=function(e,t){return Xe(ar,e,t)};var Gn=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!0),this.h=new kv,this.embeddings={embeddings:[]},Pe(e=this.h,0,1,t=new Ct)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){var t=this.h,n=et(this.h,e0,2);return n=n?n.clone():new e0,e.l2Normalize!==void 0?Pa(n,1,e.l2Normalize):"l2Normalize"in e&&pt(n,1),e.quantize!==void 0?Pa(n,2,e.quantize):"quantize"in e&&pt(n,2),Pe(t,0,2,n),this.l(e)}za(e,t){return Sr(this,e,t),this.embeddings}Aa(e,t,n){return Kr(this,e,n,t),this.embeddings}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect"),rt(e,"embeddings_out");const t=new Qn;Tr(t,M5,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"EMBEDDINGS:embeddings_out"),n.o(t),tr(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=w5(r),this.embeddings=function(i){return{embeddings:fs(i,v5,1).map(a=>{var d,h;const u={headIndex:hr(a,3)??0??-1,headName:vr(a,4)??""??""};if(wy(a,Z1,td(a,1))!==void 0)a=ai(a=et(a,Z1,td(a,1)),1,Ys,oi()),u.floatEmbedding=a.slice();else{const m=new Uint8Array(0);u.quantizedEmbedding=((h=(d=et(a,y5,td(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??m}return u}),timestampMs:fu(mo(i,2))??0}}(r),ke(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Gn.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=i0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=i0(s0(e.quantizedEmbedding),s0(t.quantizedEmbedding))}return e},Gn.prototype.embedForVideo=Gn.prototype.Aa,Gn.prototype.embed=Gn.prototype.za,Gn.prototype.setOptions=Gn.prototype.o,Gn.createFromModelPath=function(e,t){return Xe(Gn,e,{baseOptions:{modelAssetPath:t}})},Gn.createFromModelBuffer=function(e,t){return Xe(Gn,e,{baseOptions:{modelAssetBuffer:t}})},Gn.createFromOptions=function(e,t){return Xe(Gn,e,t)};var Sf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function A0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function E0(e){try{const t=new Sf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{ac(e)}}Sf.prototype.close=Sf.prototype.close;var dn=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new dp,this.v=new Av,Pe(this.h,0,3,this.v),Pe(e=this.h,0,1,t=new Ct)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?pt(this.h,2,_o(e.displayNamesLocale)):"displayNamesLocale"in e&&pt(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=fs(e.da(),Sn,1).filter(s=>(vr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=et(t[0],Qn,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=vr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,A0(this),Sr(this,e,r),E0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,A0(this),Kr(this,e,s,t),E0(this)}Da(){return this.s}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect");const t=new Qn;Tr(t,Cv,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect"),n.o(t),tr(e,n),oc(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),yo(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>xo(this,i,!0,!this.j)),ke(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],ke(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),yo(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=xo(this,r,!1,!this.j),ke(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,ke(this,r)})),rt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,ke(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};dn.prototype.getLabels=dn.prototype.Da,dn.prototype.segmentForVideo=dn.prototype.Ma,dn.prototype.segment=dn.prototype.segment,dn.prototype.setOptions=dn.prototype.o,dn.createFromModelPath=function(e,t){return Xe(dn,e,{baseOptions:{modelAssetPath:t}})},dn.createFromModelBuffer=function(e,t){return Xe(dn,e,{baseOptions:{modelAssetBuffer:t}})},dn.createFromOptions=function(e,t){return Xe(dn,e,t)};var kf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};kf.prototype.close=kf.prototype.close;var O5=class extends Ae{constructor(e){super(e)}},bi=[0,Ft,-2],yu=[0,Zr,-3,Et,Zr,-1],C0=[0,yu],_0=[0,yu,Ft,-1],ad=class extends Ae{constructor(e){super(e)}},j0=[0,Zr,-1,Et],$5=class extends Ae{constructor(e){super(e)}},N0=class extends Ae{constructor(e){super(e)}},Af=[1,2,3,4,5,6,7,8,9,10,14,15],Uv=class extends Ae{constructor(e){super(e)}};Uv.prototype.g=nc([0,Yt,[0,Af,ot,yu,ot,[0,yu,bi],ot,C0,ot,[0,C0,bi],ot,j0,ot,[0,Zr,-3,Et,wr],ot,[0,Zr,-3,Et],ot,[0,st,Zr,-2,Et,Ft,Et,-1,2,Zr,bi],ot,_0,ot,[0,_0,bi],Zr,bi,st,ot,[0,Zr,-3,Et,bi,-1],ot,[0,Yt,j0]],st,[0,st,Ft,-1,Et]]);var Ur=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new dp,this.s=new Av,Pe(this.h,0,3,this.s),Pe(e=this.h,0,1,t=new Ct)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new Uv;const i=new N0;var a=new O5;if(Xr(a,1,255),Pe(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var u=new ad;Pa(u,3,!0),Ee(u,1,t.keypoint.x),Ee(u,2,t.keypoint.y),ca(i,5,Af,u)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(u of(a=new $5,t.scribble))Pa(t=new ad,3,!0),Ee(t,1,u.x),Ee(t,2,u.y),hu(a,1,ad,t);ca(i,15,Af,a)}hu(r,1,N0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),Sr(this,e,s);e:{try{const h=new kf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{ac(this)}d=void 0}return d}m(){var e=new Ln;xt(e,"image_in"),xt(e,"roi_in"),xt(e,"norm_rect_in");const t=new Qn;Tr(t,Cv,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),gt(n,"IMAGE:image_in"),gt(n,"ROI:roi_in"),gt(n,"NORM_RECT:norm_rect_in"),n.o(t),tr(e,n),oc(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),yo(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>xo(this,i,!0,!this.j)),ke(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],ke(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),yo(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=xo(this,r,!1,!this.j),ke(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,ke(this,r)})),rt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,ke(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ur.prototype.segment=Ur.prototype.segment,Ur.prototype.setOptions=Ur.prototype.o,Ur.createFromModelPath=function(e,t){return Xe(Ur,e,{baseOptions:{modelAssetPath:t}})},Ur.createFromModelBuffer=function(e,t){return Xe(Ur,e,{baseOptions:{modelAssetBuffer:t}})},Ur.createFromOptions=function(e,t){return Xe(Ur,e,t)};var lr=class extends Rn{constructor(e,t){super(new xr(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Pe(e=this.h=new _v,0,1,t=new Ct)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?pt(this.h,2,_o(e.displayNamesLocale)):"displayNamesLocale"in e&&pt(this.h,2),e.maxResults!==void 0?Xr(this.h,3,e.maxResults):"maxResults"in e&&pt(this.h,3),e.scoreThreshold!==void 0?Ee(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&pt(this.h,4),e.categoryAllowlist!==void 0?pu(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&pt(this.h,5),e.categoryDenylist!==void 0?pu(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&pt(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},Sr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Kr(this,e,n,t),this.j}m(){var e=new Ln;xt(e,"input_frame_gpu"),xt(e,"norm_rect"),rt(e,"detections");const t=new Qn;Tr(t,P5,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),gt(n,"IMAGE:input_frame_gpu"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"DETECTIONS:detections"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=nv(i),this.j.detections.push(Nv(r));ke(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};lr.prototype.detectForVideo=lr.prototype.F,lr.prototype.detect=lr.prototype.D,lr.prototype.setOptions=lr.prototype.o,lr.createFromModelPath=async function(e,t){return Xe(lr,e,{baseOptions:{modelAssetPath:t}})},lr.createFromModelBuffer=function(e,t){return Xe(lr,e,{baseOptions:{modelAssetBuffer:t}})},lr.createFromOptions=function(e,t){return Xe(lr,e,t)};var Ef=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function b0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function M0(e){try{const t=new Ef(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{ac(e)}}Ef.prototype.close=Ef.prototype.close;var Wn=class extends Rn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Pe(e=this.h=new jv,0,1,t=new Ct),this.v=new wv,Pe(this.h,0,3,this.v),this.j=new vv,Pe(this.h,0,2,this.j),Xr(this.j,4,1),Ee(this.j,2,.5),Ee(this.v,2,.5),Ee(this.h,4,.5)}get baseOptions(){return et(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numPoses"in e&&Xr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&Ee(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&Ee(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&Ee(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,b0(this),Sr(this,e,r),M0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,b0(this),Kr(this,e,s,t),M0(this)}m(){var e=new Ln;xt(e,"image_in"),xt(e,"norm_rect"),rt(e,"normalized_landmarks"),rt(e,"world_landmarks"),rt(e,"segmentation_masks");const t=new Qn;Tr(t,I5,this.h);const n=new Sn;er(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),gt(n,"IMAGE:image_in"),gt(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:normalized_landmarks"),Ke(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),tr(e,n),oc(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=Ha(i),this.landmarks.push(ic(r));ke(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],ke(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=no(i),this.worldLandmarks.push(fa(r));ke(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],ke(this,r)}),this.outputSegmentationMasks&&(Ke(n,"SEGMENTATION_MASK:segmentation_masks"),yo(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>xo(this,i,!0,!this.s)),ke(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],ke(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Wn.prototype.detectForVideo=Wn.prototype.F,Wn.prototype.detect=Wn.prototype.D,Wn.prototype.setOptions=Wn.prototype.o,Wn.createFromModelPath=function(e,t){return Xe(Wn,e,{baseOptions:{modelAssetPath:t}})},Wn.createFromModelBuffer=function(e,t){return Xe(Wn,e,{baseOptions:{modelAssetBuffer:t}})},Wn.createFromOptions=function(e,t){return Xe(Wn,e,t)},Wn.POSE_CONNECTIONS=zv;const Hv="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",D5=Hv,vu=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let u=0,d=0,h=0;t>=0&&t<60?(u=s,d=i,h=0):t<120?(u=i,d=s,h=0):t<180?(u=0,d=s,h=i):t<240?(u=0,d=i,h=s):t<300?(u=i,d=0,h=s):(u=s,d=0,h=i);const m=w=>Math.max(0,Math.min(255,Math.round((w+a)*255)));return{r:m(u),g:m(d),b:m(h)}}return null},Cp=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),T0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),P0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},Gv=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const u=e.canvas;return s=u.width,i=u.height,r=u.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(u){console.warn("[ColorDetector] Failed to extract category mask data:",u)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},z5=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=vu(t),a=vu(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:u="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:m=50,minGapRatio:w=.05}=r,S=new Image;S.crossOrigin="anonymous",S.onload=()=>{try{const _=S.width>d?d/S.width:1,L=Math.max(1,Math.round(S.width*_)),F=Math.max(1,Math.round(S.height*_)),X=document.createElement("canvas");X.width=L,X.height=F;const C=X.getContext("2d");if(!C){s({suggestion:"None",stats:{mode:"colorMask"}});return}C.drawImage(S,0,0,L,F);const g=C.getImageData(0,0,L,F),{data:v}=g,E=h*h,N={minY:F,maxY:-1,pixels:0},T={minY:F,maxY:-1,pixels:0},$=new Uint8Array(L*F);for(let ee=0;ee<F;ee+=1)for(let ie=0;ie<L;ie+=1){const ve=(ee*L+ie)*4,we=ee*L+ie,Te=v[ve],se=v[ve+1],Z=v[ve+2],re=(Te-i.r)*(Te-i.r)+(se-i.g)*(se-i.g)+(Z-i.b)*(Z-i.b),ge=(Te-a.r)*(Te-a.r)+(se-a.g)*(se-a.g)+(Z-a.b)*(Z-a.b);re<E&&re<ge?(N.pixels+=1,ee<N.minY&&(N.minY=ee),ee>N.maxY&&(N.maxY=ee),$[we]=1):ge<E&&ge<re&&(T.pixels+=1,ee<T.minY&&(T.minY=ee),ee>T.maxY&&(T.maxY=ee),$[we]=2)}const H={mode:"colorMask",pixelsA:N.pixels,pixelsB:T.pixels,minYA:N.pixels>0?N.minY:null,maxYA:N.pixels>0?N.maxY:null,minYB:T.pixels>0?T.minY:null,maxYB:T.pixels>0?T.maxY:null,width:L,height:F},q=N.pixels>=m,V=T.pixels>=m;let K="None";if(q&&!V)K="A";else if(!q&&V)K="B";else if(q&&V){let ee,ie;u==="top"?(ee=N.minY,ie=T.minY):(ee=N.maxY,ie=T.maxY);const ve=Math.abs(ee-ie),we=F*w;ve>=we&&(K=u==="top"?ee<ie?"A":"B":ee>ie?"A":"B")}let ne=null;try{const ee=document.createElement("canvas");ee.width=L,ee.height=F;const ie=ee.getContext("2d");ie.drawImage(S,0,0,L,F);const ve=ie.getImageData(0,0,L,F),we=ve.data,Te=(re,ge)=>{we[re]=Math.round(we[re]*.3+ge.r*.7),we[re+1]=Math.round(we[re+1]*.3+ge.g*.7),we[re+2]=Math.round(we[re+2]*.3+ge.b*.7),we[re+3]=255},se={r:255,g:82,b:97},Z={r:80,g:170,b:255};for(let re=0;re<$.length;re+=1)$[re]===1?Te(re*4,se):$[re]===2&&Te(re*4,Z);ie.putImageData(ve,0,0),ne=ee.toDataURL("image/png")}catch(ee){console.warn("[ColorDetector] Failed generating preview",ee)}s({suggestion:K,stats:H,preview:ne})}catch(_){console.error("[ColorDetector] Error processing frame:",_),s({suggestion:"None",stats:{mode:"colorMask"}})}},S.onerror=_=>{console.error("[ColorDetector] Failed to load frame image",_),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?S.src=e:typeof e=="string"?S.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),I0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const _ of e){const L=_.y*t+_.x;L>=0&&L<i.length&&(i[L]=1)}const a=[],u=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const _ of e){const L=_.y*t+_.x;if(L<0||L>=i.length||i[L]!==1)continue;let F=0;const X=[{x:_.x,y:_.y}];i[L]=2;const C=[];let g=0;for(;g<X.length;){const{x:v,y:E}=X[g++];F++,C.push({x:v,y:E});for(const N of u){const T=v+N.dx,$=E+N.dy;if(T>=0&&T<t&&$>=0&&$<n){const H=$*t+T;H>=0&&H<i.length&&i[H]===1&&(i[H]=2,X.push({x:T,y:$}))}}}a.push({size:F,pixels:C})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((_,L)=>L.size>_.size?L:_).size,m=Math.max(1,Math.floor(h*s));let w=0;const S=[];for(const _ of a)_.size>=m&&(w+=_.size,S.push(..._.pixels));return{count:w,pixels:S,largestBlobSize:h,minBlobSize:m,totalBlobs:a.length,filteredBlobs:a.filter(_=>_.size>=m).length}},U5=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=vu(t),i=vu(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await Cp(e),u=a.naturalWidth||a.width,d=a.naturalHeight||a.height,m=(await _p()).segment(a),{maskData:w,maskWidth:S,maskHeight:_,isRGBA:L}=Gv(m.categoryMask,u,d);if(!w)throw new Error("Failed to extract segmentation mask data");const F=new Uint8ClampedArray(u*d*4),X=u/S,C=d/_;for(let R=0;R<d;R++)for(let z=0;z<u;z++){const J=Math.min(S-1,Math.floor(z/X)),D=(Math.min(_-1,Math.floor(R/C))*S+J)*(L?4:1);let y=0;w&&D<w.length&&(y=w[D]);const I=y!==0&&y!==2?255:0,M=(R*u+z)*4;F[M]=I,F[M+1]=I,F[M+2]=I,F[M+3]=255}const g=document.createElement("canvas");g.width=u,g.height=d;const v=g.getContext("2d");v.drawImage(a,0,0,u,d);const E=v.getImageData(0,0,u,d).data,N=r.maskThreshold||100,T=r.colorThreshold??95,$=r.anchor||"top",H=T*T,q=r.scanDepth??1,V=r.stride||2;let K=$==="top"?d:0,ne=!1;if($==="top")for(let R=0;R<d;R+=V){for(let z=0;z<u;z+=V)if(F[(R*u+z)*4]>=N){K=R,ne=!0;break}if(ne)break}else for(let R=d-1;R>=0;R-=V){for(let z=0;z<u;z+=V)if(F[(R*u+z)*4]>=N){K=R,ne=!0;break}if(ne)break}let ee,ie,ve;if(r.manualBounds&&$==="manually")ee=r.manualBounds.topY,ie=r.manualBounds.bottomY,ve=ie-ee,ne||(K=ee);else{if(!ne)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};ve=q?Math.floor(d*q):d,$==="top"?(ee=K,ie=Math.min(d,K+ve)):(ee=Math.max(0,K-ve),ie=K)}const we=[],Te=[];for(let R=ee;R<ie;R+=V)for(let z=0;z<u;z+=V){const J=(R*u+z)*4;if(F[J]<N)continue;const de=E[J],D=E[J+1],y=E[J+2],I=T0({r:de,g:D,b:y},s),M=T0({r:de,g:D,b:y},i);I<H&&I<M?we.push({x:z,y:R}):M<H&&M<I&&Te.push({x:z,y:R})}const se=r.minBlobRatio??.1,Z=I0(we,u,d,V,se),re=I0(Te,u,d,V,se),ge=Z.count,Me=re.count,Ue=Z.pixels.map(R=>({...R,idx:(R.y*u+R.x)*4})),$e=re.pixels.map(R=>({...R,idx:(R.y*u+R.x)*4})),Ne=50;let ze="None",Y=null;ge>Ne&&ge>Me?(ze="A",Y={color:"A",pixelCount:ge,minY:ee,maxY:ie,anchorY:K,rawPixels:we.length,largestBlobSize:Z.largestBlobSize,minBlobSize:Z.minBlobSize}):Me>Ne&&Me>ge&&(ze="B",Y={color:"B",pixelCount:Me,minY:ee,maxY:ie,anchorY:K,rawPixels:Te.length,largestBlobSize:re.largestBlobSize,minBlobSize:re.minBlobSize});let Q=null,ye=null;try{const R=document.createElement("canvas");R.width=u,R.height=d;const z=R.getContext("2d");z.drawImage(a,0,0,u,d),z.fillStyle="rgba(0,0,0,0.6)",z.fillRect(0,0,u,d),z.globalCompositeOperation="destination-out",z.fillStyle="rgba(0,0,0,1)",z.fillRect(0,ee,u,ie-ee),z.globalCompositeOperation="destination-over",z.drawImage(a,0,0,u,d),z.globalCompositeOperation="source-over";const J=z.createImageData(u,d),de=J.data;for(let U=ee;U<ie;U+=1)for(let W=0;W<u;W+=1){const ue=(U*u+W)*4;F[ue]>=N&&(de[ue]=0,de[ue+1]=255,de[ue+2]=255,de[ue+3]=90)}z.putImageData(J,0,0);const D=z.createImageData(u,d),y=D.data;for(const U of Ue){const W=U.idx;W>=0&&W<y.length-3&&(y[W]=255,y[W+1]=0,y[W+2]=0,y[W+3]=180)}for(const U of $e){const W=U.idx;W>=0&&W<y.length-3&&(y[W]=0,y[W+1]=100,y[W+2]=255,y[W+3]=180)}z.putImageData(D,0,0),z.globalCompositeOperation="source-over",z.strokeStyle="#00FF00",z.lineWidth=3,z.setLineDash([]),z.beginPath(),z.moveTo(0,ee),z.lineTo(u,ee),z.stroke(),z.strokeStyle="#FFFF00",z.lineWidth=3,z.setLineDash([5,5]),z.beginPath(),z.moveTo(0,ie),z.lineTo(u,ie),z.stroke(),K!==ee&&K!==ie&&(z.strokeStyle="#FF00FF",z.lineWidth=2,z.setLineDash([2,2]),z.beginPath(),z.moveTo(0,K),z.lineTo(u,K),z.stroke()),Q=R.toDataURL("image/png");const I=document.createElement("canvas");I.width=u,I.height=d;const M=I.getContext("2d"),b=M.createImageData(u,d),B=b.data;for(let U=0;U<u*d;U+=1){const W=U*4,me=F[U*4]>=N?255:0;B[W]=me,B[W+1]=me,B[W+2]=me,B[W+3]=255}M.putImageData(b,0,0),ye=I.toDataURL("image/png")}catch(R){console.warn("[ColorDetector] Failed generating preview",R)}const le={mode:"segmentation",width:u,height:d,pixelsA:ge,pixelsB:Me,rawPixelsA:we.length,rawPixelsB:Te.length,tipY:K,scanDepth:ve,scanDepthRatio:q,anchor:$,bestArm:Y,blobInfoA:{largestBlobSize:Z.largestBlobSize,minBlobSize:Z.minBlobSize,totalBlobs:Z.totalBlobs,filteredBlobs:Z.filteredBlobs,droppedPixels:we.length-ge},blobInfoB:{largestBlobSize:re.largestBlobSize,minBlobSize:re.minBlobSize,totalBlobs:re.totalBlobs,filteredBlobs:re.filteredBlobs,droppedPixels:Te.length-Me},minBlobRatio:se};return{suggestion:ze,stats:le,preview:Q,maskPreview:ye}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},H5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},wu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),G5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,u=-1/0;for(const w of e){const S=wu(w,i);S>u&&(u=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let _=0;_<e.length;_++){let L=0,F=1/0;for(let X=0;X<s.length;X++){const C=wu(e[_],s[X]);C<F&&(F=C,L=X)}d[_]!==L&&(d[_]=L,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((_,L)=>{const F=d[L];S[F]+=1;for(let X=0;X<r;X++)w[F][X]+=_[X]});for(let _=0;_<s.length;_++)S[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=w[_].map(L=>L/S[_]);h+=1}return{assignments:d,centroids:s}},W5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await _p(),r=t.maxFrames||e.length,s=t.stride||2;t.minClothPixels;const i=t.manualBounds||null,a=e.slice(0,r),u=[];let d=0;for(const g of a)try{const v=await Cp(g.frameDataUrl),E=v.naturalWidth||v.width,N=v.naturalHeight||v.height,T=n.segment(v),{maskData:$,maskWidth:H,maskHeight:q,isRGBA:V}=Gv(T.categoryMask,E,N);if(!$){d+=1;continue}const K=document.createElement("canvas");K.width=E,K.height=N;const ne=K.getContext("2d");ne.drawImage(v,0,0,E,N);const ee=ne.getImageData(0,0,E,N).data,ie=E/H,ve=N/q;let we;i?we=i.bottomY-i.topY:we=N;const Te=Math.floor(we/s),se=Math.floor(E/s),Z=Te*se,ge=Math.max(Math.floor(Z*.005),20);let Me=0,Ue=0,$e=0,Ne=0,ze=0,Y=0;for(let le=0;le<N;le+=s){if(i&&(le<i.topY||le>i.bottomY))continue;const R=Math.min(q-1,Math.floor(le/ve));for(let z=0;z<E;z+=s){const J=Math.min(H-1,Math.floor(z/ie)),de=(R*H+J)*(V?4:1);if($[de]===4){const y=(le*E+z)*4,I=ee[y],M=ee[y+1],b=ee[y+2];Me+=I,Ue+=M,$e+=b,Ne+=z,ze+=le,Y+=1}}}if(Y<ge){console.log(`[Cloth] Frame ${g.moveId} SKIPPED - cloth pixels: ${Y}, threshold: ${ge}, scan area: ${we}px, manual bounds: ${i?"YES":"NO"}`),d+=1;continue}console.log(`[Cloth] Frame ${g.moveId} ACCEPTED - cloth pixels: ${Y}, threshold: ${ge}, scan area: ${we}px, manual bounds: ${i?`Y:${i.topY}-${i.bottomY}`:"NO"}`);const Q={r:Me/Y,g:Ue/Y,b:$e/Y};let ye=null;try{const le=document.createElement("canvas");le.width=E,le.height=N;const R=le.getContext("2d");R.drawImage(v,0,0,E,N);const z=R.getImageData(0,0,E,N),J=z.data;for(let de=0;de<N;de+=1){const D=Math.min(q-1,Math.floor(de/ve));for(let y=0;y<E;y+=1){const I=Math.min(H-1,Math.floor(y/ie)),M=(D*H+I)*(V?4:1);if($[M]===4){const B=(de*E+y)*4;J[B]=Math.round(J[B]*.5+50),J[B+1]=Math.round(J[B+1]*.5+255*.5),J[B+2]=Math.round(J[B+2]*.5+50)}}}R.putImageData(z,0,0),i&&(R.fillStyle="rgba(0, 0, 0, 0.5)",R.fillRect(0,0,E,i.topY),R.fillRect(0,i.bottomY,E,N-i.bottomY),R.strokeStyle="#00FF00",R.lineWidth=3,R.setLineDash([]),R.beginPath(),R.moveTo(0,i.topY),R.lineTo(E,i.topY),R.stroke(),R.strokeStyle="#FFFF00",R.lineWidth=3,R.setLineDash([5,5]),R.beginPath(),R.moveTo(0,i.bottomY),R.lineTo(E,i.bottomY),R.stroke(),R.fillStyle="#00FF00",R.font="bold 16px Arial",R.fillText(`Manual Scan Area (${we}px)`,10,i.topY-10)),R.fillStyle="rgba(0, 0, 0, 0.7)",R.fillRect(10,10,300,80),R.fillStyle="#FFFFFF",R.font="bold 14px Arial",R.fillText(`Cloth Pixels: ${Y}`,20,30),R.fillText(`Threshold: ${ge}`,20,50),R.fillText(`Mean Color: ${P0(Q.r,Q.g,Q.b)}`,20,70),ye=le.toDataURL("image/png")}catch(le){console.warn("[ColorDetector] Failed to generate debug preview:",le)}u.push({moveId:g.moveId,meanColor:Q,feature:[Q.r/255,Q.g/255,Q.b/255],centroidX:Ne/Y/E,centroidY:ze/Y/N,pixelCount:Y,existingPlayer:g.existingPlayer||null,debugPreview:ye})}catch(v){console.warn("[ColorDetector] Cloth analysis failed for frame",g.moveId,v),d+=1}if(u.length<2)throw new Error("Not enough frames with detectable clothing");const h=u.map(g=>g.feature),{assignments:m,centroids:w}=G5(h,Math.min(2,u.length)),S=w.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));m.forEach((g,v)=>{const E=u[v],N=S[g];N.samples.push({moveId:E.moveId,centroidX:E.centroidX,centroidY:E.centroidY,pixelCount:E.pixelCount}),N.sumR+=E.meanColor.r,N.sumG+=E.meanColor.g,N.sumB+=E.meanColor.b,N.sumPixels+=E.pixelCount,N.sumBrightness+=(E.meanColor.r+E.meanColor.g+E.meanColor.b)/3,(E.existingPlayer==="Player A"||E.existingPlayer==="Player B")&&(N.labelCounts[E.existingPlayer]+=1)});const _={};S.forEach((g,v)=>{const E=g.labelCounts["Player A"],N=g.labelCounts["Player B"];E>N?_[v]="Player A":N>E&&(_[v]="Player B")});const L=S.map((g,v)=>{const E=g.sumR/Math.max(1,g.samples.length),N=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length);return{idx:v,hue:H5(E,N,T),brightness:g.sumBrightness/Math.max(1,g.samples.length)}}).sort((g,v)=>g.hue-v.hue||g.brightness-v.brightness),F=["Player A","Player B"];L.forEach(({idx:g})=>{if(!_[g]){const v=Object.values(_),E=F.find(N=>!v.includes(N))||"Player A";_[g]=E}});const X={};m.forEach((g,v)=>{const E=u[v],N=_[g]||(g===0?"Player A":"Player B"),T=w[g],$=w[g===0?1:0],H=wu(E.feature,T),q=$?wu(E.feature,$):H,V=$?Math.max(0,1-H/(H+q+1e-6)):1;X[E.moveId]={player:N,clusterId:g,styleLabel:`Style ${g+1}`,confidence:V,stats:{meanColor:E.meanColor,pixelCount:E.pixelCount,debugPreview:E.debugPreview}}});const C=S.map((g,v)=>{const E=g.sumR/Math.max(1,g.samples.length),N=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length),$=P0(E,N,T);return{id:v,styleLabel:`Style ${v+1}`,assignedPlayer:_[v]||(v===0?"Player A":"Player B"),hexColor:$,meanColor:{r:E,g:N,b:T},sampleCount:g.samples.length,avgPixels:g.sumPixels/Math.max(1,g.samples.length),avgBrightness:g.sumBrightness/Math.max(1,g.samples.length),knownAssignments:g.labelCounts}});return{assignments:X,clusters:C,analytics:{totalFrames:a.length,usedFrames:u.length,skippedFrames:d,clusters:C}}};let ld=null;const _p=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!ld){const e=await ks.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");ld=await dn.createFromOptions(e,{baseOptions:{modelAssetPath:D5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return ld},V5=async e=>{try{const t=await Cp(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await _p()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let u;if(i.categoryMask.getAsUint8Array)u=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(u=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,u.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=u[w*4];u=m}}else if(i.categoryMask instanceof Uint8Array)u=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=h[w*4];u=m}else u=h}return await Promise.all(a.map(async h=>{const m=document.createElement("canvas");m.width=n,m.height=r;const w=m.getContext("2d");w.drawImage(t,0,0,n,r);const S=w.getImageData(0,0,n,r),_=S.data;let L=0;for(let F=0;F<u.length;F++)if(u[F]===h.id){L++;const X=F*4;h.id===0?(_[X]=_[X]*.25,_[X+1]=_[X+1]*.25,_[X+2]=_[X+2]*.25):(_[X]=(_[X]+h.color[0])/2,_[X+1]=(_[X+1]+h.color[1])/2,_[X+2]=(_[X+2]+h.color[2])/2)}return w.putImageData(S,0,0),{...h,pixelCount:L,preview:m.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},Y5=Hv,X5=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),K5=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const u=e.canvas;return s=u.width,i=u.height,r=u.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(u){console.warn("[ColorDetectorGeneral] Failed to extract category mask data:",u)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},xu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),Q5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,u=-1/0;for(const w of e){const S=xu(w,i);S>u&&(u=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let _=0;_<e.length;_++){let L=0,F=1/0;for(let X=0;X<s.length;X++){const C=xu(e[_],s[X]);C<F&&(F=C,L=X)}d[_]!==L&&(d[_]=L,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((_,L)=>{const F=d[L];S[F]+=1;for(let X=0;X<r;X++)w[F][X]+=_[X]});for(let _=0;_<s.length;_++)S[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=w[_].map(L=>L/S[_]);h+=1}return{assignments:d,centroids:s}},J5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},R0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()};let ud=null;const q5=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!ud){const e=await ks.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");ud=await dn.createFromOptions(e,{baseOptions:{modelAssetPath:Y5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return ud},Z5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for analysis");const n=await q5(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minPixels||5,a=t.manualBounds||null,u=e.slice(0,r),d=[];let h=0;for(const v of u)try{const E=await X5(v.frameDataUrl),N=E.naturalWidth||E.width,T=E.naturalHeight||E.height,$=n.segment(E),{maskData:H,maskWidth:q,maskHeight:V,isRGBA:K}=K5($.categoryMask,N,T);if(!H){h+=1;continue}const ne=document.createElement("canvas");ne.width=N,ne.height=T;const ee=ne.getContext("2d");ee.drawImage(E,0,0,N,T);const ie=ee.getImageData(0,0,N,T).data,ve=N/q,we=T/V;let Te=0,se=T;a&&(Te=Math.max(0,a.topY),se=Math.min(T,a.bottomY));let Z=0,re=0,ge=0,Me=0,Ue=0,$e=0;for(let Y=Te;Y<se;Y+=s){const Q=Math.min(V-1,Math.floor(Y/we));for(let ye=0;ye<N;ye+=s){const le=Math.min(q-1,Math.floor(ye/ve)),R=(Q*q+le)*(K?4:1);if(H[R]!==0){const J=(Y*N+ye)*4,de=ie[J],D=ie[J+1],y=ie[J+2];Z+=de,re+=D,ge+=y,Me+=ye,Ue+=Y,$e+=1}}}if($e<i){h+=1;continue}const Ne={r:Z/$e,g:re/$e,b:ge/$e};let ze=null;try{const Y=document.createElement("canvas");Y.width=N,Y.height=T;const Q=Y.getContext("2d");Q.drawImage(E,0,0,N,T);const ye=Q.getImageData(0,0,N,T),le=ye.data;for(let R=0;R<T;R+=1){const z=Math.min(V-1,Math.floor(R/we));for(let J=0;J<N;J+=1){const de=Math.min(q-1,Math.floor(J/ve)),D=(z*q+de)*(K?4:1);if(H[D]!==0){const I=(R*N+J)*4;le[I]=Math.round(le[I]*.5+50),le[I+1]=Math.round(le[I+1]*.5+100),le[I+2]=Math.round(le[I+2]*.5+255*.5)}}}if(Q.putImageData(ye,0,0),a){Q.fillStyle="rgba(0, 0, 0, 0.5)",Q.fillRect(0,0,N,a.topY),Q.fillRect(0,a.bottomY,N,T-a.bottomY),Q.strokeStyle="#00FF00",Q.lineWidth=3,Q.setLineDash([]),Q.beginPath(),Q.moveTo(0,a.topY),Q.lineTo(N,a.topY),Q.stroke(),Q.strokeStyle="#FFFF00",Q.lineWidth=3,Q.setLineDash([5,5]),Q.beginPath(),Q.moveTo(0,a.bottomY),Q.lineTo(N,a.bottomY),Q.stroke();const R=a.bottomY-a.topY;Q.fillStyle="#00FF00",Q.font="bold 16px Arial",Q.fillText(`Manual Scan Area (${R}px)`,10,a.topY-10)}Q.fillStyle="rgba(0, 0, 0, 0.7)",Q.fillRect(10,10,300,80),Q.fillStyle="#FFFFFF",Q.font="bold 14px Arial",Q.fillText(`Non-BG Pixels: ${$e}`,20,30),Q.fillText(`Threshold: ${i}`,20,50),Q.fillText(`Mean Color: ${R0(Ne.r,Ne.g,Ne.b)}`,20,70),ze=Y.toDataURL("image/png")}catch(Y){console.warn("[ColorDetectorGeneral] Failed to generate debug preview:",Y)}d.push({moveId:v.moveId,meanColor:Ne,feature:[Ne.r/255,Ne.g/255,Ne.b/255],centroidX:Me/$e/N,centroidY:Ue/$e/T,pixelCount:$e,existingPlayer:v.existingPlayer||null,debugPreview:ze})}catch(E){console.warn("[ColorDetectorGeneral] Analysis failed for frame",v.moveId,E),h+=1}if(d.length<2)throw new Error("Not enough frames with detectable pixels (need at least 2)");const m=d.map(v=>v.feature),{assignments:w,centroids:S}=Q5(m,Math.min(2,d.length)),_=S.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));w.forEach((v,E)=>{const N=d[E],T=_[v];T.samples.push({moveId:N.moveId,centroidX:N.centroidX,centroidY:N.centroidY,pixelCount:N.pixelCount}),T.sumR+=N.meanColor.r,T.sumG+=N.meanColor.g,T.sumB+=N.meanColor.b,T.sumPixels+=N.pixelCount,T.sumBrightness+=(N.meanColor.r+N.meanColor.g+N.meanColor.b)/3,(N.existingPlayer==="Player A"||N.existingPlayer==="Player B")&&(T.labelCounts[N.existingPlayer]+=1)});const L={};_.forEach((v,E)=>{const N=v.labelCounts["Player A"],T=v.labelCounts["Player B"];N>T?L[E]="Player A":T>N&&(L[E]="Player B")});const F=_.map((v,E)=>{const N=v.sumR/Math.max(1,v.samples.length),T=v.sumG/Math.max(1,v.samples.length),$=v.sumB/Math.max(1,v.samples.length);return{idx:E,hue:J5(N,T,$),brightness:v.sumBrightness/Math.max(1,v.samples.length)}}).sort((v,E)=>v.hue-E.hue||v.brightness-E.brightness),X=["Player A","Player B"];F.forEach(({idx:v})=>{if(!L[v]){const E=Object.values(L),N=X.find(T=>!E.includes(T))||"Player A";L[v]=N}});const C={};w.forEach((v,E)=>{const N=d[E],T=L[v]||(v===0?"Player A":"Player B"),$=S[v],H=S[v===0?1:0],q=xu(N.feature,$),V=H?xu(N.feature,H):q,K=H?Math.max(0,1-q/(q+V+1e-6)):1,ne=_[v],ee=ne.sumR/Math.max(1,ne.samples.length),ie=ne.sumG/Math.max(1,ne.samples.length),ve=ne.sumB/Math.max(1,ne.samples.length);C[N.moveId]={player:T,clusterId:v,styleLabel:`Style ${v+1}`,confidence:K,stats:{meanColor:{r:ee,g:ie,b:ve},pixelCount:N.pixelCount,debugPreview:N.debugPreview}}});const g=_.map((v,E)=>{const N=v.sumR/Math.max(1,v.samples.length),T=v.sumG/Math.max(1,v.samples.length),$=v.sumB/Math.max(1,v.samples.length),H=R0(N,T,$);return{id:E,styleLabel:`Style ${E+1}`,assignedPlayer:L[E]||(E===0?"Player A":"Player B"),hexColor:H,meanColor:{r:N,g:T,b:$},sampleCount:v.samples.length,avgPixels:v.sumPixels/Math.max(1,v.samples.length),avgBrightness:v.sumBrightness/Math.max(1,v.samples.length),knownAssignments:v.labelCounts}});return{assignments:C,clusters:g,analytics:{totalFrames:u.length,usedFrames:d.length,skippedFrames:h,clusters:g}}},cd=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,e6=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function t6({colorPreview:e,onClose:t}){var _,L,F,X,C,g,v,E,N,T,$,H,q,V;const[n,r]=j.useState("overview"),[s,i]=j.useState(null),[a,u]=j.useState(!1),d=async()=>{if(e!=null&&e.original){u(!0);try{const K=await V5(e.original);i(K)}catch(K){console.error("Failed to run multiclass segmentation:",K)}finally{u(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,m=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,w=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",S=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return l.jsx("div",{className:"image-modal",onClick:t,children:l.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:K=>K.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:t,children:""}),l.jsxs("div",{className:"color-preview-tabs",children:[l.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),l.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"color-preview-grid",children:[l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Original Frame"}),l.jsx("img",{src:e.original,alt:"Original frame"})]}),l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Mask View"}),e.preview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((_=e.stats)==null?void 0:_.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((L=e.stats)==null?void 0:L.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),l.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((F=e.stats)==null?void 0:F.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),l.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):l.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&l.jsxs("div",{className:"color-preview-stats",children:[l.jsxs("div",{className:"color-preview-meta",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${m.toLocaleString()} px)`:""]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Method:"})," ",S]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Anchor:"})," ",w]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&l.jsxs("div",{children:[l.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&l.jsxs("div",{children:[l.jsx("strong",{children:"Person coverage:"})," ",e6(e.stats.personPixels)]}),e.stats.reason&&l.jsxs("div",{children:[l.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),l.jsxs("div",{className:"color-preview-calibration",children:[l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player A color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),l.jsx("code",{children:e.colorA||""}),e.calibrationA&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player B color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),l.jsx("code",{children:e.colorB||""}),e.calibrationB&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Scan Zone"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Depth:"})," ",((X=e.stats.scanDepth)==null?void 0:X.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color A Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((C=e.stats.pixelsA)==null?void 0:C.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((g=e.stats.rawPixelsA)==null?void 0:g.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((v=e.stats.blobInfoA.largestBlobSize)==null?void 0:v.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((E=e.stats.blobInfoA.minBlobSize)==null?void 0:E.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color B Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((N=e.stats.pixelsB)==null?void 0:N.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((T=e.stats.rawPixelsB)==null?void 0:T.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",(($=e.stats.blobInfoB.largestBlobSize)==null?void 0:$.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((H=e.stats.blobInfoB.minBlobSize)==null?void 0:H.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&l.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[l.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixel Count:"})," ",((q=e.stats.bestArm.pixelCount)==null?void 0:q.toLocaleString())||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((V=e.stats.armRegions)==null?void 0:V.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((K,ne)=>{const ee=e.stats.bestArm&&K.category===e.stats.bestArm.category&&K.dominantColor===e.stats.bestArm.dominantColor;return l.jsxs("div",{className:"segmentation-card",style:{border:ee?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:ee?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[l.jsxs("h4",{children:["Arm ",ne+1,": ",K.categoryName,ee&&l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Dominant Color:"})," ",l.jsxs("span",{style:{color:K.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",K.dominantColor]})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels A:"})," ",K.pixelsA||0," | ",l.jsx("strong",{children:"Pixels B:"})," ",K.pixelsB||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Total arm pixels:"})," ",K.pixelCount||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," Y=",K.minY,"  ",K.maxY," (Anchor Y: ",K.anchorY,")"]})]},ne)}):l.jsx("p",{children:"No arms detected with matching colors"})]}):l.jsxs("div",{className:"color-preview-breakdown",children:[l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player A band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",cd(e.stats.pixelsA,m),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player B band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",cd(e.stats.pixelsB,m),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):l.jsxs("div",{className:"multiclass-view",children:[l.jsxs("div",{className:"multiclass-header",children:[l.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),l.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&l.jsxs("div",{className:"loading-indicator",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&l.jsx("div",{className:"multiclass-grid",children:s.map(K=>l.jsxs("div",{className:"multiclass-card",children:[l.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${K.color.join(",")})`},children:[l.jsxs("h4",{children:[K.id,". ",K.name]}),l.jsx("span",{className:"multiclass-badge",children:cd(K.pixelCount,m)})]}),l.jsx("p",{className:"multiclass-desc",children:K.desc}),l.jsx("div",{className:"multiclass-preview-container",children:l.jsx("img",{src:K.preview,alt:K.name})}),l.jsxs("div",{className:"multiclass-footer",children:[K.pixelCount.toLocaleString()," pixels"]})]},K.id))}),!a&&!s&&l.jsxs("div",{className:"error-message",children:[l.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),l.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function n6({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=j.useState(0),[i,a]=j.useState(0),[u,d]=j.useState(!1),[h,m]=j.useState(!1),w=j.useRef(null),[S,_]=j.useState(0),[L,F]=j.useState(0),X=j.useRef(null),C=W0.useCallback((T,$,H,q,V,K)=>{T.clearRect(0,0,q,V),K&&T.drawImage(K,0,0),T.fillStyle="rgba(0, 255, 0, 0.2)",T.fillRect(0,$,q,H-$),T.strokeStyle="#00FF00",T.lineWidth=3,T.setLineDash([]),T.beginPath(),T.moveTo(0,$),T.lineTo(q,$),T.stroke(),T.strokeStyle="#FFFF00",T.setLineDash([]),T.beginPath(),T.moveTo(0,H),T.lineTo(q,H),T.stroke(),T.fillStyle="#00FF00",T.font="16px Arial",T.fillText("Top",10,$-5),T.fillStyle="#FFFF00",T.fillText("Bottom",10,H+20)},[]);j.useEffect(()=>{if(!e||!w.current)return;const T=new Image;T.crossOrigin="anonymous",T.onload=()=>{const $=w.current,H=$.getContext("2d");$.width=T.width,$.height=T.height,F(T.width),_(T.height),X.current=T;const q=Math.floor(T.height*.2),V=Math.floor(T.height*.8);s(q),a(V),C(H,q,V,T.width,T.height,T)},e.startsWith("data:image")?T.src=e:T.src=`data:image/jpeg;base64,${e}`},[e]),j.useEffect(()=>{if(!w.current||S===0||!X.current)return;const T=w.current.getContext("2d");C(T,r,i,L,S,X.current)},[r,i,L,S]);const g=T=>{const $=w.current,H=$.getBoundingClientRect(),q=Math.floor((T.clientY-H.top)*($.height/H.height));Math.abs(q-r)<10?d(!0):Math.abs(q-i)<10&&m(!0)},v=T=>{if(!u&&!h)return;const $=w.current,H=$.getBoundingClientRect(),q=Math.floor((T.clientY-H.top)*($.height/H.height)),V=Math.max(0,Math.min($.height,q));if(u){const K=Math.min(V,i-10);s(K)}else if(h){const K=Math.max(V,r+10);a(K)}},E=()=>{d(!1),m(!1)},N=()=>{t({topY:r,bottomY:i})};return l.jsx("div",{className:"image-modal",onClick:n,children:l.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:T=>T.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:n,children:""}),l.jsx("h2",{children:"Set Manual Scan Area"}),l.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines to define the scan area"}),l.jsx("canvas",{ref:w,onMouseDown:g,onMouseMove:v,onMouseUp:E,onMouseLeave:E,style:{cursor:u||h?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),l.jsx("div",{className:"manual-scan-info",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Top Y:"})," ",r," | ",l.jsx("strong",{children:"Bottom Y:"})," ",i," | ",l.jsx("strong",{children:"Height:"})," ",i-r,"px"]})}),l.jsxs("div",{className:"manual-scan-actions",children:[l.jsx("button",{onClick:N,className:"save-btn",children:"Save Bounds"}),l.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const Mi=Fu(),r6="adminPassword",Ti=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),s6=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function i6({sessionGameId:e}){var Dn,ki,Ga,Js,Ai,qs,gs,Po;const[t,n]=j.useState(null),[r,s]=j.useState(!0),[i,a]=j.useState(null),[u,d]=j.useState(null),[h,m]=j.useState(null),[w,S]=j.useState("all"),[_,L]=j.useState("all"),[F,X]=j.useState(""),[C,g]=j.useState(!1),[v,E]=j.useState({}),[N,T]=j.useState({current:0,total:0}),[$,H]=j.useState("#FF0000"),[q,V]=j.useState("#0000FF"),[K,ne]=j.useState(!1),[ee,ie]=j.useState(!1),[ve,we]=j.useState({}),[Te,se]=j.useState({current:0,total:0}),[Z,re]=j.useState("bottom"),[ge,Me]=j.useState(100),[Ue,$e]=j.useState(null),[Ne,ze]=j.useState(null),[Y,Q]=j.useState(!1),[ye,le]=j.useState(null),[R,z]=j.useState(!1),[J,de]=j.useState(null),[D,y]=j.useState({}),[I,M]=j.useState(!1),[b,B]=j.useState(""),[U,W]=j.useState(!1),[ue,me]=j.useState(null),[be,Ie]=j.useState("chronological"),[Oe,tt]=j.useState(55),[Qe,lt]=j.useState(!1),[ut,He]=j.useState({current:0,total:0}),[De,Ge]=j.useState(null),Je=j.useCallback(async O=>{if(!O)return{suggestion:"None",stats:null};try{const fe=await U5(O,$,q,{anchor:Z,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:Z==="manually"&&Ne?null:ge/100,manualBounds:Z==="manually"?Ne:null});if(fe)return fe}catch(fe){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",fe)}return z5(O,$,q,{anchor:Z})},[$,q,Z,ge,Ne]);j.useEffect(()=>{const O=localStorage.getItem(r6);O&&X(O)},[]),j.useEffect(()=>{e&&F&&Bn()},[e,F]);const _t=O=>{if(!O||typeof O.h>"u")return null;const fe=(O.h||0)*2,he=(O.s||0)/255,te=(O.v||0)/255,ce=te*he,Re=ce*(1-Math.abs(fe/60%2-1)),it=te-ce;let qe=0,Le=0,We=0;fe>=0&&fe<60?(qe=ce,Le=Re,We=0):fe<120?(qe=Re,Le=ce,We=0):fe<180?(qe=0,Le=ce,We=Re):fe<240?(qe=0,Le=Re,We=ce):fe<300?(qe=Re,Le=0,We=ce):(qe=ce,Le=0,We=Re);const dt=rr=>{const ln=Math.round((rr+it)*255).toString(16);return ln.length===1?"0"+ln:ln};return`#${dt(qe)}${dt(Le)}${dt(We)}`.toUpperCase()},Bn=async()=>{var O,fe,he,te;if(F){s(!0),a(null);try{const ce=await fetch(`${Mi}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":F}});if(!ce.ok)throw new Error(`Failed to load session (${ce.status})`);const Re=await ce.json();n(Re);let it=null,qe=null,Le="";if(Re.colorA&&Re.colorB?(it=Re.colorA,qe=Re.colorB,Le="session root"):(fe=(O=Re.metadata)==null?void 0:O.config)!=null&&fe.colorA&&((te=(he=Re.metadata)==null?void 0:he.config)!=null&&te.colorB)&&(it=Re.metadata.config.colorA,qe=Re.metadata.config.colorB,Le="session metadata"),it&&qe)H(it),V(qe),console.log(`[MoveHistoryEditor]  Loaded colors from ${Le}:`,it,qe);else try{const We=JSON.parse(localStorage.getItem("calibrationA")||"null"),dt=JSON.parse(localStorage.getItem("calibrationB")||"null");if(We&&dt){const rr=_t(We),ln=_t(dt);rr&&ln?(H(rr),V(ln),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",rr,ln)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch(We){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",We),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(ce){console.error("[MoveHistoryEditor] Error loading session:",ce),a(ce.message)}finally{s(!1)}}},ct=async(O,fe)=>{if(!(!e||!O||!F))try{const he=await fetch(`${Mi}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent(O)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":F},body:JSON.stringify({player:fe})});if(!he.ok)throw new Error(`Failed to update player (${he.status})`);n(te=>te&&{...te,moves:te.moves.map(ce=>ce._id===O?{...ce,player:fe}:ce)}),E(te=>{const ce={...te};return delete ce[O],ce}),console.log("[MoveHistoryEditor] Player updated:",O,fe)}catch(he){console.error("[MoveHistoryEditor] Error updating player:",he),alert("Failed to update player: "+he.message)}},zt=async()=>{if(!(!e||!F)){g(!0),E({});try{console.log("[MoveHistoryEditor] Starting AI identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",$,"Player B:",q);const O=Fn.filter(he=>he.camera_frame);if(O.length===0){alert("No moves with camera frames to process");return}T({current:0,total:O.length}),console.log(`[MoveHistoryEditor] Processing ${O.length} moves one by one...`);let fe=0;for(const he of O){T({current:fe+1,total:O.length});try{const te=await fetch(`${Mi}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":F},body:JSON.stringify({sessionGameId:e,moveId:he._id,colorA:$,colorB:q,cameraPosition:Z==="top"||Z==="bottom"?Z:void 0})});if(te.ok){const ce=await te.json();B(""),E(Re=>({...Re,[he._id]:{player:ce.suggestion==="A"?"Player A":ce.suggestion==="B"?"Player B":"None",confidence:ce.confidence,rawResponse:ce.rawResponse}})),fe++,console.log(`[MoveHistoryEditor]  Processed ${fe}/${O.length}: ${ce.suggestion}`)}else te.status===503?B(" Retrying..."):B(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${he._id}`)}catch(te){B(""),console.error(`[MoveHistoryEditor] Error processing move ${he._id}:`,te)}}console.log("[MoveHistoryEditor] AI identification complete:",fe,"moves processed"),alert(`AI identified ${fe} moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in AI identification:",O),alert("AI identification failed: "+O.message)}finally{g(!1),T({current:0,total:0}),B("")}}},Pt=async()=>{if(!(!e||!F)){g(!0),E({});try{console.log("[MoveHistoryEditor] Starting AI identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",$,"Player B:",q);const O=Fn.filter(he=>he.camera_frame&&(!he.player||he.player==="Unknown"||he.player==="None"));if(O.length===0){alert("No unknown moves with camera frames to process");return}T({current:0,total:O.length}),console.log(`[MoveHistoryEditor] Processing ${O.length} unknown moves one by one...`);let fe=0;for(const he of O){T({current:fe+1,total:O.length});try{const te=await fetch(`${Mi}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":F},body:JSON.stringify({sessionGameId:e,moveId:he._id,colorA:$,colorB:q,cameraPosition:Z==="top"||Z==="bottom"?Z:void 0})});if(te.ok){const ce=await te.json();B(""),E(Re=>({...Re,[he._id]:{player:ce.suggestion==="A"?"Player A":ce.suggestion==="B"?"Player B":"None",confidence:ce.confidence,rawResponse:ce.rawResponse}})),fe++,console.log(`[MoveHistoryEditor]  Processed ${fe}/${O.length}: ${ce.suggestion}`)}else te.status===503?B(" Retrying..."):B(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${he._id}`)}catch(te){B(""),console.error(`[MoveHistoryEditor] Error processing move ${he._id}:`,te)}}console.log("[MoveHistoryEditor] AI identification complete:",fe,"unknown moves processed"),alert(`AI identified ${fe} unknown moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in AI identification:",O),alert("AI identification failed: "+O.message)}finally{g(!1),T({current:0,total:0}),B("")}}},en=async O=>{const fe=v[O];fe&&await ct(O,fe.player)},mn=async O=>{const fe=ve[O];fe&&(await ct(O,fe.player),we(he=>{const te={...he};return delete te[O],te}))},gn=async O=>{if(!t||!Array.isArray(t.moves))return;const fe=t.moves.find(he=>he._id===O);if(!fe||!fe.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${O}`);const he=await Je(fe.camera_frame);if(!he){alert("Color-based identification failed for this move.");return}we(Re=>({...Re,[O]:{method:"color",player:he.suggestion==="A"?"Player A":he.suggestion==="B"?"Player B":"None",stats:he.stats,preview:he.preview}}));let te=null,ce=null;try{te=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{te=null}try{ce=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{ce=null}$e({moveId:O,original:fe.camera_frame,preview:he.preview,maskPreview:he.maskPreview,stats:he.stats,suggestion:he.suggestion,colorA:$,colorB:q,calibrationA:te,calibrationB:ce,anchor:Z})}catch(he){console.error("[MoveHistoryEditor] Error color-identifying move:",he),alert("Color-based identification failed: "+he.message)}},yn=j.useCallback(async({mode:O})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const fe=t.moves.filter(te=>te.camera_frame);if(fe.length===0){alert("No camera frames available for cloth-based identification.");return}const he=new Set(t.moves.filter(te=>!te.player||te.player==="Unknown"||te.player==="None").map(te=>te._id));if(O==="unknown"&&he.size===0){alert("All moves already have players assigned.");return}z(!0),de(null);try{const te=fe.map(Le=>({moveId:Le._id,frameDataUrl:Le.camera_frame,existingPlayer:Le.player&&Le.player!=="Unknown"?Le.player:null})),ce=await W5(te,{maxFrames:fe.length,stride:2,minClothPixels:80,manualBounds:Z==="manually"?Ne:null});ce!=null&&ce.analytics&&de(ce.analytics);const Re={};ce!=null&&ce.assignments&&Object.entries(ce.assignments).forEach(([Le,We])=>{var dt;(dt=We.stats)!=null&&dt.debugPreview&&(Re[Le]=We.stats.debugPreview)}),Object.keys(Re).length>0&&y(Re);const it={};ce!=null&&ce.assignments&&Object.entries(ce.assignments).forEach(([Le,We])=>{(O==="all"||he.has(Le))&&(it[Le]={method:"cloth",player:We.player,styleLabel:We.styleLabel,confidence:We.confidence,stats:We.stats})});const qe=Object.keys(it).length;qe===0?alert(`Cloth-based method did not find suggestions for any ${O==="all"?"moves":"unknown moves"}.`):(we(We=>({...We,...it})),alert(`Cloth-based method suggested players for ${qe} ${O==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(te){console.error("[MoveHistoryEditor] Cloth identification failed:",te),alert("Cloth-based identification failed: "+te.message)}finally{z(!1)}},[t,Z,Ne]);j.useCallback(()=>{yn({mode:"all"})},[yn]),j.useCallback(()=>{yn({mode:"unknown"})},[yn]);const tn=j.useCallback(async({mode:O})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const fe=t.moves.filter(te=>te.camera_frame);if(fe.length===0){alert("No camera frames available for All-All identification.");return}const he=new Set(t.moves.filter(te=>!te.player||te.player==="Unknown"||te.player==="None").map(te=>te._id));if(O==="unknown"&&he.size===0){alert("All moves already have players assigned.");return}W(!0),me(null);try{const te=fe.map(Le=>({moveId:Le._id,frameDataUrl:Le.camera_frame,existingPlayer:Le.player&&Le.player!=="Unknown"&&Le.player!=="None"?Le.player:null})),ce=await Z5(te,{maxFrames:fe.length,stride:2,minPixels:80,manualBounds:Z==="manually"?Ne:null});ce!=null&&ce.analytics&&me(ce.analytics);const Re={};ce!=null&&ce.assignments&&Object.entries(ce.assignments).forEach(([Le,We])=>{var dt;(dt=We.stats)!=null&&dt.debugPreview&&(Re[Le]=We.stats.debugPreview)}),Object.keys(Re).length>0&&y(Le=>({...Le,...Re}));const it={};ce!=null&&ce.assignments&&Object.entries(ce.assignments).forEach(([Le,We])=>{(O==="all"||he.has(Le))&&(it[Le]={method:"allall",player:We.player,styleLabel:We.styleLabel,confidence:We.confidence,stats:We.stats})});const qe=Object.keys(it).length;qe===0?alert(`All-All method did not find suggestions for any ${O==="all"?"moves":"unknown moves"}.`):(we(We=>({...We,...it})),alert(`All-All method suggested players for ${qe} ${O==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(te){console.error("[MoveHistoryEditor] All-All identification failed:",te),alert("All-All identification failed: "+te.message)}finally{W(!1)}},[t,Z,Ne]),Qr=j.useCallback(()=>{tn({mode:"all"})},[tn]),Lr=j.useCallback(()=>{tn({mode:"unknown"})},[tn]),Br=async O=>{if(!(!e||!F))try{console.log(`[MoveHistoryEditor] Identifying single move: ${O}`);const fe=await fetch(`${Mi}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":F},body:JSON.stringify({sessionGameId:e,moveId:O,colorA:$,colorB:q,cameraPosition:Z==="top"||Z==="bottom"?Z:void 0})});if(fe.ok){const he=await fe.json();E(te=>({...te,[O]:{player:he.suggestion==="A"?"Player A":he.suggestion==="B"?"Player B":"None",confidence:he.confidence,rawResponse:he.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${he.suggestion}`)}else{const he=await fe.json();alert(`Failed to identify move: ${he.message}`)}}catch(fe){console.error("[MoveHistoryEditor] Error identifying move:",fe),alert("AI identification failed: "+fe.message)}},Fn=((Dn=t==null?void 0:t.moves)==null?void 0:Dn.filter(O=>{let fe=!0;w!=="all"&&(fe=O.phase===w);let he=!0;return _!=="all"&&(_==="None"?he=!O.player||O.player==="None"||O.player==="Unknown":he=O.player===_),fe&&he}))||[],On=(()=>{const O=[...Fn];return be==="chronological"?O:O.sort((fe,he)=>{var qe,Le;const te=!!ve[fe._id],ce=!!ve[he._id];if(te&&!ce)return-1;if(!te&&ce)return 1;if(!te&&!ce)return 0;const Re=((qe=ve[fe._id])==null?void 0:qe.confidence)||0,it=((Le=ve[he._id])==null?void 0:Le.confidence)||0;return be==="confidenceDesc"?it-Re:be==="confidenceAsc"?Re-it:0})})(),Si=async()=>{if(!e||!F)return;const O=Object.entries(ve).filter(([fe,he])=>(he.confidence||0)*100>=Oe).map(([fe,he])=>({moveId:fe,player:he.player}));if(O.length===0){alert(`No moves found with confidence above ${Oe}%`);return}if(window.confirm(`Are you sure you want to confirm ${O.length} moves with confidence >= ${Oe}%?`)){lt(!0),He({current:0,total:O.length});try{const fe=await fetch(`${Mi}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":F},body:JSON.stringify({updates:O})});if(!fe.ok)throw new Error(`Failed to update players (${fe.status})`);const he=await fe.json();console.log("[MoveHistoryEditor] Bulk update success:",he),n(te=>{if(!te)return te;const ce=te.moves.map(Re=>{const it=O.find(qe=>qe.moveId===Re._id);return it?{...Re,player:it.player}:Re});return{...te,moves:ce}}),we(te=>{const ce={...te};return O.forEach(({moveId:Re})=>{delete ce[Re]}),ce}),alert(`Successfully confirmed ${O.length} moves.`)}catch(fe){console.error("Failed to confirm moves:",fe),alert("Failed to confirm moves: "+fe.message)}finally{lt(!1),He({current:0,total:0})}}};if(r)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return l.jsx("div",{className:"move-editor-container",children:l.jsxs("div",{className:"move-editor-error",children:[l.jsx("h2",{children:"Error Loading Session"}),l.jsx("p",{children:i}),l.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-error",children:"Session not found"})});const $n=((ki=t.moves)==null?void 0:ki.filter(O=>O.phase==="practice").length)||0,nr=((Ga=t.moves)==null?void 0:Ga.filter(O=>O.phase==="experiment").length)||0,Qs=((Js=t.moves)==null?void 0:Js.filter(O=>O.player==="Player A").length)||0,St=((Ai=t.moves)==null?void 0:Ai.filter(O=>O.player==="Player B").length)||0;return l.jsxs("div",{className:"move-editor-container",children:[l.jsxs("header",{className:"move-editor-header",children:[l.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),l.jsxs("div",{className:"move-editor-title",children:[l.jsx("h1",{children:"Move History Editor"}),l.jsxs("div",{className:"session-info",children:[l.jsxs("span",{className:"session-id",children:["Session: ",e]}),l.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),l.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]}),l.jsxs("div",{className:"player-stats",style:{marginTop:"5px",fontSize:"0.9em"},children:[l.jsxs("span",{style:{marginRight:"15px",color:$,fontWeight:"bold"},children:["Player A: ",Qs]}),l.jsxs("span",{style:{color:q,fontWeight:"bold"},children:["Player B: ",St]})]})]}),l.jsxs("div",{className:"phase-filter",children:[l.jsxs("button",{className:`filter-btn ${w==="all"?"active":""}`,onClick:()=>S("all"),children:["All (",((qs=t.moves)==null?void 0:qs.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${w==="practice"?"active":""}`,onClick:()=>S("practice"),children:["Practice (",$n,")"]}),l.jsxs("button",{className:`filter-btn ${w==="experiment"?"active":""}`,onClick:()=>S("experiment"),children:["Experiment (",nr,")"]})]}),l.jsxs("div",{className:"phase-filter",style:{marginTop:"10px"},children:[l.jsx("button",{className:`filter-btn ${_==="all"?"active":""}`,onClick:()=>L("all"),children:"All Players"}),l.jsx("button",{className:`filter-btn ${_==="Player A"?"active":""}`,onClick:()=>L("Player A"),style:{borderColor:$,color:_==="Player A"?"white":$,backgroundColor:_==="Player A"?$:"transparent"},children:"Player A"}),l.jsx("button",{className:`filter-btn ${_==="Player B"?"active":""}`,onClick:()=>L("Player B"),style:{borderColor:q,color:_==="Player B"?"white":q,backgroundColor:_==="Player B"?q:"transparent"},children:"Player B"}),l.jsx("button",{className:`filter-btn ${_==="None"?"active":""}`,onClick:()=>L("None"),children:"None/Unknown"})]}),l.jsxs("div",{className:"bracelet-colors-controls",children:[l.jsx("button",{className:"color-picker-toggle",onClick:()=>ne(!K),children:"Bracelet Colors"}),K&&l.jsxs("div",{className:"color-picker-panel",children:[l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player A:"}),l.jsx("input",{type:"color",value:$,onChange:O=>H(O.target.value)}),l.jsx("span",{children:$})]}),l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player B:"}),l.jsx("input",{type:"color",value:q,onChange:O=>V(O.target.value)}),l.jsx("span",{children:q})]})]})]}),l.jsxs("div",{className:"ai-controls",children:[l.jsx("button",{className:"ai-btn ai-btn-all",onClick:zt,disabled:C,children:C&&N.total>0?b?`${b} ${N.current}/${N.total}`:`Processing ${N.current}/${N.total}...`:"AI Identify All"}),l.jsx("button",{className:"ai-btn ai-btn-unknown",onClick:Pt,disabled:C,children:C&&N.total>0?b?`${b} ${N.current}/${N.total}`:`Processing ${N.current}/${N.total}...`:"AI Identify Unknown"})]}),l.jsxs("div",{className:"color-controls",children:[Object.keys(D).length>0&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:`ai-btn debug-btn ${I?"active":""}`,onClick:()=>M(!I),style:{backgroundColor:I?"#4CAF50":"#666",marginLeft:"20px"},children:I?" Debug View ON":" Show Debug View"}),l.jsx("button",{className:"ai-btn debug-btn",onClick:()=>{M(!1),y({})},style:{backgroundColor:"#ff5722"},children:" Clear Debug"})]}),l.jsx("button",{className:"ai-btn allall-btn",onClick:Qr,disabled:U,children:U?" Identifying by All All...":" Identify by All All"}),l.jsx("button",{className:"ai-btn allall-btn",onClick:Lr,disabled:U,children:U?" Identifying by All All...":" Identify by All Unknown"}),l.jsxs("div",{className:"color-anchor-toggle",children:[l.jsx("label",{children:"Color scan:"}),l.jsxs("select",{value:Z,onChange:O=>{if(re(O.target.value),O.target.value==="manually"){const fe=(t==null?void 0:t.moves)||[];if(fe.length>0){const he=fe[Math.floor(Math.random()*fe.length)];he!=null&&he.camera_frame?(le(he.camera_frame),Q(!0)):(alert("No frames available. Please ensure moves have camera frames."),re("bottom"))}else alert("No moves available."),re("bottom")}else Q(!1),ze(null),le(null)},children:[l.jsx("option",{value:"bottom",children:"Bottom"}),l.jsx("option",{value:"top",children:"Top"}),l.jsx("option",{value:"manually",children:"Manually"})]})]}),Z!=="manually"&&l.jsxs("div",{className:"color-scan-percentage",children:[l.jsxs("label",{children:["Scan area: ",ge,"%"]}),l.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:ge,onChange:O=>Me(Number(O.target.value)),style:{width:"120px",marginLeft:"8px"}})]}),Z==="manually"&&Ne&&l.jsxs("div",{className:"manual-bounds-info",children:[l.jsxs("span",{children:["Manual: Y=",Ne.topY,"  ",Ne.bottomY]}),l.jsx("button",{onClick:()=>Q(!0),style:{marginLeft:"8px",padding:"4px 8px"},children:"Edit"})]})]})]}),J&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsx("div",{className:"cloth-analytics-header",children:l.jsxs("div",{children:[l.jsx("h3",{children:"Cloth Styles Analytics"}),l.jsxs("p",{children:["Frames analyzed: ",J.usedFrames,"/",J.totalFrames,"  Skipped:"," ",J.skippedFrames]})]})}),l.jsx("div",{className:"cloth-style-grid",children:(gs=J.clusters)==null?void 0:gs.map(O=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:O.styleLabel}),l.jsx("span",{className:"player-label",children:O.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:O.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",O.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",O.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Ti(O.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Ti(O.avgBrightness||0)]})]})]},O.id))})]}),ue&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsxs("div",{className:"cloth-analytics-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:" All-All Styles Analytics (Background Excluded)"}),l.jsxs("p",{children:["Frames analyzed: ",ue.usedFrames,"/",ue.totalFrames,"  Skipped:"," ",ue.skippedFrames]})]}),l.jsxs("div",{className:"analytics-controls",style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"15px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#f5f5f5",padding:"4px 8px",borderRadius:"4px"},children:[l.jsxs("label",{style:{fontSize:"14px"},children:["Confirm threshold: ",Oe,"%"]}),l.jsx("input",{type:"range",min:"50",max:"100",value:Oe,onChange:O=>tt(Number(O.target.value)),style:{width:"100px"}}),l.jsx("button",{onClick:Si,disabled:Qe,style:{backgroundColor:Qe?"#9E9E9E":"#4CAF50",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:Qe?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",minWidth:"140px"},children:Qe?`Saving ${ut.current}/${ut.total}...`:`Confirm All  ${Oe}% (${Object.values(ve).filter(O=>(O.confidence||0)*100>=Oe).length})`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("label",{children:"Sort by:"}),l.jsxs("select",{value:be,onChange:O=>Ie(O.target.value),style:{padding:"4px",borderRadius:"4px"},children:[l.jsx("option",{value:"chronological",children:"Chronological"}),l.jsx("option",{value:"confidenceDesc",children:"Confidence (High to Low)"}),l.jsx("option",{value:"confidenceAsc",children:"Confidence (Low to High)"})]})]})]})]}),l.jsx("div",{className:"cloth-style-grid",children:(Po=ue.clusters)==null?void 0:Po.map(O=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:O.styleLabel}),l.jsx("span",{className:"player-label",children:O.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:O.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",O.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",O.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Ti(O.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Ti(O.avgBrightness||0)]})]})]},O.id))})]}),l.jsxs("div",{className:"move-editor-content",children:[l.jsx("div",{className:"moves-grid",children:On.map((O,fe)=>{var he;return l.jsxs("div",{className:`move-card ${(u==null?void 0:u._id)===O._id?"selected":""}`,onClick:()=>d(O),children:[l.jsxs("div",{className:"move-card-header",children:[l.jsxs("span",{className:"move-number",children:["#",fe+1]}),l.jsx("span",{className:`move-phase ${O.phase}`,children:O.phase})]}),O.camera_frame&&l.jsxs("div",{className:"move-image",onClick:te=>{te.stopPropagation(),m(I&&D[O._id]?D[O._id]:O.camera_frame)},style:{position:"relative"},children:[l.jsx("img",{src:I&&D[O._id]?D[O._id]:O.camera_frame,alt:`Move ${fe+1}`}),l.jsx("div",{className:"image-overlay",children:" Click to enlarge"}),I&&D[O._id]&&l.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(76, 175, 80, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:" DEBUG"})]}),l.jsxs("div",{className:"move-card-body",children:[l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Type:"}),l.jsx("span",{className:"value",children:O.type})]}),v[O._id]&&(()=>{const te=v[O._id].player,Re=te==="A"||te==="Player A"?$:q;return l.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:Re,outline:`2px solid ${s6(Re,.25)}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:""}),l.jsxs("span",{className:"ai-text",children:["AI suggests: ",l.jsx("strong",{children:v[O._id].player})]})]}),l.jsx("button",{className:"ai-confirm-btn",onClick:it=>{it.stopPropagation(),en(O._id)},children:" Confirm"})]})})(),ve[O._id]&&(()=>{const te=ve[O._id],it=te.player==="Player A"?$:q,qe=te.method||"color",Le=qe==="cloth"?"":qe==="allall"?"":"",We=qe==="cloth"?`Cloth suggests${te.styleLabel?` (${te.styleLabel})`:""}:`:qe==="allall"?`All-All suggests${te.styleLabel?` (${te.styleLabel})`:""}:`:"Color suggests:",dt=typeof te.confidence=="number"?`  ${Math.round(te.confidence*100)}% confidence`:"";let rr=it;if(te.stats&&te.stats.meanColor){const{r:ln,g:sr,b:Ei}=te.stats.meanColor,Io=Wa=>{const Zs=Math.round(Wa).toString(16);return Zs.length===1?"0"+Zs:Zs};rr=`#${Io(ln)}${Io(sr)}${Io(Ei)}`}return l.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:rr,borderWidth:"2px",outline:`4px solid ${rr}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:Le}),l.jsxs("span",{className:"ai-text",children:[We," ",l.jsx("strong",{children:te.player}),dt]})]}),l.jsx("button",{className:"ai-confirm-btn",disabled:De===O._id,onClick:async ln=>{ln.stopPropagation(),Ge(O._id),await mn(O._id),Ge(null)},children:De===O._id?"...":" Confirm"})]})})(),l.jsxs("div",{className:"move-info-row player-row",style:{borderColor:O.player==="Player A"?$:O.player==="Player B"?q:O.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("span",{className:"label",children:"Player:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[l.jsxs("select",{className:`player-select ${(he=O.player)==null?void 0:he.toLowerCase().replace(" ","-")}`,value:O.player||"Unknown",onChange:te=>ct(O._id,te.target.value),onClick:te=>te.stopPropagation(),style:{flex:1,borderColor:O.player==="Player A"?$:O.player==="Player B"?q:O.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]}),O.camera_frame&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"ai-single-btn",onClick:te=>{te.stopPropagation(),Br(O._id)},title:"Identify this move with AI",children:""}),l.jsx("button",{className:"ai-single-btn color-single-btn",onClick:te=>{te.stopPropagation(),gn(O._id)},title:"Identify this move by color",children:""})]})]})]}),O.blockId!==null&&O.blockId!==void 0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Block:"}),l.jsx("span",{className:"value",children:O.blockId})]}),Array.isArray(O.position)&&O.position.length===2&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Position:"}),l.jsxs("span",{className:"value",children:["(",O.position[0],", ",O.position[1],")"]})]}),l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Time:"}),l.jsxs("span",{className:"value",children:[Ti(O.elapsed,1),"s"]})]}),Number.isFinite(O.holdTime)&&O.holdTime>0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Hold:"}),l.jsxs("span",{className:"value",children:[Ti(O.holdTime,2),"s"]})]})]})]},O._id||fe)})}),Fn.length===0&&l.jsx("div",{className:"no-moves",children:l.jsx("p",{children:"No moves found for selected filter."})})]}),h&&l.jsx("div",{className:"image-modal",onClick:()=>m(null),children:l.jsxs("div",{className:"image-modal-content",onClick:O=>O.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:()=>m(null),children:""}),l.jsx("img",{src:h,alt:"Expanded view"})]})}),l.jsx(t6,{colorPreview:Ue,onClose:()=>$e(null)}),Y&&ye&&l.jsx(n6,{frameDataUrl:ye,onSave:O=>{ze(O),Q(!1)},onCancel:()=>{Q(!1),re("bottom"),le(null)}})]})}const o6=!1;function a6(){const[e,t]=j.useState(!1),[n,r]=j.useState(null),[s,i]=j.useState(null),[a,u]=j.useState(window.location.hash),[d,h]=j.useState(!1);j.useEffect(()=>{const L=()=>{u(window.location.hash)};return window.addEventListener("hashchange",L),()=>window.removeEventListener("hashchange",L)},[]),j.useEffect(()=>(window.toggleInterface=L=>{h(L),console.log("[App] Interface "+(L?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const m=L=>{r(L),t(!0)},w=()=>{s&&!s.closed&&s.close();const L=window.location.origin+window.location.pathname+"#/detector",F=window.open(L,"BraceletDetector","width=700,height=600,left=100,top=100");i(F)};j.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),j.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(L){console.error("Error ending experience:",L),alert("Error ending experience: "+L.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let S=null;const _=a.match(/^#\/admin\/edit-moves\/(.+)$/);if(a==="#/detector")S=l.jsx(y1,{});else if(a==="#/calibrate")S=l.jsx(dx,{});else if(a==="#/detector2")S=l.jsx(fx,{});else if(a==="#/summary")S=l.jsx(Q2,{});else if(a==="#/admin")S=l.jsx(px,{});else if(a==="#/admin/upload")S=l.jsx(mx,{});else if(_){const L=decodeURIComponent(_[1]);S=l.jsx(i6,{sessionGameId:L},L)}else S=e?l.jsxs(l.Fragment,{children:[l.jsx(ux,{config:n,interfaceHidden:d}),l.jsx(y1,{hidden:d}),o6,!d&&l.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[l.jsx("button",{onClick:w,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),l.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),l.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&l.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:l.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):l.jsx(tx,{onStart:m});return l.jsx("div",{className:"App",children:S})}dd.createRoot(document.getElementById("root")).render(l.jsx(W0.StrictMode,{children:l.jsx(a6,{})}));
