(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $0={exports:{}},bc={},D0={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Da=Symbol.for("react.element"),b3=Symbol.for("react.portal"),M3=Symbol.for("react.fragment"),P3=Symbol.for("react.strict_mode"),T3=Symbol.for("react.profiler"),I3=Symbol.for("react.provider"),R3=Symbol.for("react.context"),L3=Symbol.for("react.forward_ref"),B3=Symbol.for("react.suspense"),F3=Symbol.for("react.memo"),O3=Symbol.for("react.lazy"),im=Symbol.iterator;function $3(e){return e===null||typeof e!="object"?null:(e=im&&e[im]||e["@@iterator"],typeof e=="function"?e:null)}var z0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U0=Object.assign,H0={};function Co(e,t,n){this.props=e,this.context=t,this.refs=H0,this.updater=n||z0}Co.prototype.isReactComponent={};Co.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Co.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function W0(){}W0.prototype=Co.prototype;function If(e,t,n){this.props=e,this.context=t,this.refs=H0,this.updater=n||z0}var Rf=If.prototype=new W0;Rf.constructor=If;U0(Rf,Co.prototype);Rf.isPureReactComponent=!0;var om=Array.isArray,G0=Object.prototype.hasOwnProperty,Lf={current:null},V0={key:!0,ref:!0,__self:!0,__source:!0};function Y0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)G0.call(t,r)&&!V0.hasOwnProperty(r)&&(s[r]=t[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var d=Array(c),h=0;h<c;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Da,type:e,key:i,ref:a,props:s,_owner:Lf.current}}function D3(e,t){return{$$typeof:Da,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Da}function z3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var am=/\/+/g;function _u(e,t){return typeof e=="object"&&e!==null&&e.key!=null?z3(""+e.key):t.toString(36)}function Nl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Da:case b3:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+_u(a,0):r,om(s)?(n="",e!=null&&(n=e.replace(am,"$&/")+"/"),Nl(s,t,n,"",function(h){return h})):s!=null&&(Bf(s)&&(s=D3(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(am,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",om(e))for(var c=0;c<e.length;c++){i=e[c];var d=r+_u(i,c);a+=Nl(i,t,n,d,s)}else if(d=$3(e),typeof d=="function")for(e=d.call(e),c=0;!(i=e.next()).done;)i=i.value,d=r+_u(i,c++),a+=Nl(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function il(e,t,n){if(e==null)return e;var r=[],s=0;return Nl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function U3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xn={current:null},bl={transition:null},H3={ReactCurrentDispatcher:xn,ReactCurrentBatchConfig:bl,ReactCurrentOwner:Lf};function X0(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:il,forEach:function(e,t,n){il(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return il(e,function(){t++}),t},toArray:function(e){return il(e,function(t){return t})||[]},only:function(e){if(!Bf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=Co;Xe.Fragment=M3;Xe.Profiler=T3;Xe.PureComponent=If;Xe.StrictMode=P3;Xe.Suspense=B3;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H3;Xe.act=X0;Xe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=U0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Lf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(d in t)G0.call(t,d)&&!V0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&c!==void 0?c[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){c=Array(d);for(var h=0;h<d;h++)c[h]=arguments[h+2];r.children=c}return{$$typeof:Da,type:e.type,key:s,ref:i,props:r,_owner:a}};Xe.createContext=function(e){return e={$$typeof:R3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:I3,_context:e},e.Consumer=e};Xe.createElement=Y0;Xe.createFactory=function(e){var t=Y0.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:L3,render:e}};Xe.isValidElement=Bf;Xe.lazy=function(e){return{$$typeof:O3,_payload:{_status:-1,_result:e},_init:U3}};Xe.memo=function(e,t){return{$$typeof:F3,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=bl.transition;bl.transition={};try{e()}finally{bl.transition=t}};Xe.unstable_act=X0;Xe.useCallback=function(e,t){return xn.current.useCallback(e,t)};Xe.useContext=function(e){return xn.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return xn.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return xn.current.useEffect(e,t)};Xe.useId=function(){return xn.current.useId()};Xe.useImperativeHandle=function(e,t,n){return xn.current.useImperativeHandle(e,t,n)};Xe.useInsertionEffect=function(e,t){return xn.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return xn.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return xn.current.useMemo(e,t)};Xe.useReducer=function(e,t,n){return xn.current.useReducer(e,t,n)};Xe.useRef=function(e){return xn.current.useRef(e)};Xe.useState=function(e){return xn.current.useState(e)};Xe.useSyncExternalStore=function(e,t,n){return xn.current.useSyncExternalStore(e,t,n)};Xe.useTransition=function(){return xn.current.useTransition()};Xe.version="18.3.1";D0.exports=Xe;var S=D0.exports;const K0=N3(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W3=S,G3=Symbol.for("react.element"),V3=Symbol.for("react.fragment"),Y3=Object.prototype.hasOwnProperty,X3=W3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K3={key:!0,ref:!0,__self:!0,__source:!0};function Q0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)Y3.call(t,r)&&!K3.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:G3,type:e,key:i,ref:a,props:s,_owner:X3.current}}bc.Fragment=V3;bc.jsx=Q0;bc.jsxs=Q0;$0.exports=bc;var l=$0.exports,wd={},J0={exports:{}},er={},q0={exports:{}},Z0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,ne){var Z=se.length;se.push(ne);e:for(;0<Z;){var pe=Z-1>>>1,ke=se[pe];if(0<s(ke,ne))se[pe]=ne,se[Z]=ke,Z=pe;else break e}}function n(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var ne=se[0],Z=se.pop();if(Z!==ne){se[0]=Z;e:for(var pe=0,ke=se.length,ze=ke>>>1;pe<ze;){var Ue=2*(pe+1)-1,Te=se[Ue],Fe=Ue+1,te=se[Fe];if(0>s(Te,Z))Fe<ke&&0>s(te,Te)?(se[pe]=te,se[Fe]=Z,pe=Fe):(se[pe]=Te,se[Ue]=Z,pe=Ue);else if(Fe<ke&&0>s(te,Z))se[pe]=te,se[Fe]=Z,pe=Fe;else break e}}return ne}function s(se,ne){var Z=se.sortIndex-ne.sortIndex;return Z!==0?Z:se.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();e.unstable_now=function(){return a.now()-c}}var d=[],h=[],g=1,v=null,w=3,N=!1,D=!1,T=!1,V=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(se){for(var ne=n(h);ne!==null;){if(ne.callback===null)r(h);else if(ne.startTime<=se)r(h),ne.sortIndex=ne.expirationTime,t(d,ne);else break;ne=n(h)}}function M(se){if(T=!1,k(se),!D)if(n(d)!==null)D=!0,he(b);else{var ne=n(h);ne!==null&&Se(M,ne.startTime-se)}}function b(se,ne){D=!1,T&&(T=!1,j(F),F=-1),N=!0;var Z=w;try{for(k(ne),v=n(d);v!==null&&(!(v.expirationTime>ne)||se&&!Y());){var pe=v.callback;if(typeof pe=="function"){v.callback=null,w=v.priorityLevel;var ke=pe(v.expirationTime<=ne);ne=e.unstable_now(),typeof ke=="function"?v.callback=ke:v===n(d)&&r(d),k(ne)}else r(d);v=n(d)}if(v!==null)var ze=!0;else{var Ue=n(h);Ue!==null&&Se(M,Ue.startTime-ne),ze=!1}return ze}finally{v=null,w=Z,N=!1}}var H=!1,L=null,F=-1,z=5,W=-1;function Y(){return!(e.unstable_now()-W<z)}function q(){if(L!==null){var se=e.unstable_now();W=se;var ne=!0;try{ne=L(!0,se)}finally{ne?J():(H=!1,L=null)}}else H=!1}var J;if(typeof y=="function")J=function(){y(q)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,fe=re.port2;re.port1.onmessage=q,J=function(){fe.postMessage(null)}}else J=function(){V(q,0)};function he(se){L=se,H||(H=!0,J())}function Se(se,ne){F=V(function(){se(e.unstable_now())},ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){D||N||(D=!0,he(b))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return w},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(se){switch(w){case 1:case 2:case 3:var ne=3;break;default:ne=w}var Z=w;w=ne;try{return se()}finally{w=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,ne){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Z=w;w=se;try{return ne()}finally{w=Z}},e.unstable_scheduleCallback=function(se,ne,Z){var pe=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?pe+Z:pe):Z=pe,se){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=Z+ke,se={id:g++,callback:ne,priorityLevel:se,startTime:Z,expirationTime:ke,sortIndex:-1},Z>pe?(se.sortIndex=Z,t(h,se),n(d)===null&&se===n(h)&&(T?(j(F),F=-1):T=!0,Se(M,Z-pe))):(se.sortIndex=ke,t(d,se),D||N||(D=!0,he(b))),se},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(se){var ne=w;return function(){var Z=w;w=ne;try{return se.apply(this,arguments)}finally{w=Z}}}})(Z0);q0.exports=Z0;var Q3=q0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J3=S,qn=Q3;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eg=new Set,wa={};function vi(e,t){ao(e,t),ao(e+"Capture",t)}function ao(e,t){for(wa[e]=t,e=0;e<t.length;e++)eg.add(t[e])}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xd=Object.prototype.hasOwnProperty,q3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lm={},cm={};function Z3(e){return xd.call(cm,e)?!0:xd.call(lm,e)?!1:q3.test(e)?cm[e]=!0:(lm[e]=!0,!1)}function e4(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function t4(e,t,n,r){if(t===null||typeof t>"u"||e4(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Sn(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var an={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){an[e]=new Sn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];an[t]=new Sn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){an[e]=new Sn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){an[e]=new Sn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){an[e]=new Sn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){an[e]=new Sn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){an[e]=new Sn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){an[e]=new Sn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){an[e]=new Sn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ff=/[\-:]([a-z])/g;function Of(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ff,Of);an[t]=new Sn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ff,Of);an[t]=new Sn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ff,Of);an[t]=new Sn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){an[e]=new Sn(e,1,!1,e.toLowerCase(),null,!1,!1)});an.xlinkHref=new Sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){an[e]=new Sn(e,1,!1,e.toLowerCase(),null,!0,!0)});function $f(e,t,n,r){var s=an.hasOwnProperty(t)?an[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(t4(t,n,s,r)&&(n=null),r||s===null?Z3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ms=J3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ol=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Bi=Symbol.for("react.fragment"),Df=Symbol.for("react.strict_mode"),Sd=Symbol.for("react.profiler"),tg=Symbol.for("react.provider"),ng=Symbol.for("react.context"),zf=Symbol.for("react.forward_ref"),kd=Symbol.for("react.suspense"),Ad=Symbol.for("react.suspense_list"),Uf=Symbol.for("react.memo"),ks=Symbol.for("react.lazy"),rg=Symbol.for("react.offscreen"),um=Symbol.iterator;function Ho(e){return e===null||typeof e!="object"?null:(e=um&&e[um]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,Nu;function ea(e){if(Nu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Nu=t&&t[1]||""}return`
`+Nu+e}var bu=!1;function Mu(e,t){if(!e||bu)return"";bu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=c);break}}}finally{bu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ea(e):""}function n4(e){switch(e.tag){case 5:return ea(e.type);case 16:return ea("Lazy");case 13:return ea("Suspense");case 19:return ea("SuspenseList");case 0:case 2:case 15:return e=Mu(e.type,!1),e;case 11:return e=Mu(e.type.render,!1),e;case 1:return e=Mu(e.type,!0),e;default:return""}}function Ed(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Bi:return"Fragment";case Li:return"Portal";case Sd:return"Profiler";case Df:return"StrictMode";case kd:return"Suspense";case Ad:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ng:return(e.displayName||"Context")+".Consumer";case tg:return(e._context.displayName||"Context")+".Provider";case zf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Uf:return t=e.displayName||null,t!==null?t:Ed(e.type)||"Memo";case ks:t=e._payload,e=e._init;try{return Ed(e(t))}catch{}}return null}function r4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ed(t);case 8:return t===Df?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function zs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function s4(e){var t=sg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function al(e){e._valueTracker||(e._valueTracker=s4(e))}function ig(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=sg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Vl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cd(e,t){var n=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function dm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=zs(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function og(e,t){t=t.checked,t!=null&&$f(e,"checked",t,!1)}function jd(e,t){og(e,t);var n=zs(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_d(e,t.type,n):t.hasOwnProperty("defaultValue")&&_d(e,t.type,zs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function fm(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _d(e,t,n){(t!=="number"||Vl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ta=Array.isArray;function Ki(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+zs(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Nd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ce(92));if(ta(n)){if(1<n.length)throw Error(ce(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:zs(n)}}function ag(e,t){var n=zs(t.value),r=zs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function pm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ll,cg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ll=ll||document.createElement("div"),ll.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ll.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function xa(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var oa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i4=["Webkit","ms","Moz","O"];Object.keys(oa).forEach(function(e){i4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),oa[t]=oa[e]})});function ug(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||oa.hasOwnProperty(e)&&oa[e]?(""+t).trim():t+"px"}function dg(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ug(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var o4=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Md(e,t){if(t){if(o4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function Pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Td=null;function Hf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Id=null,Qi=null,Ji=null;function mm(e){if(e=Ha(e)){if(typeof Id!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=Rc(t),Id(e.stateNode,e.type,t))}}function fg(e){Qi?Ji?Ji.push(e):Ji=[e]:Qi=e}function hg(){if(Qi){var e=Qi,t=Ji;if(Ji=Qi=null,mm(e),t)for(e=0;e<t.length;e++)mm(t[e])}}function pg(e,t){return e(t)}function mg(){}var Pu=!1;function gg(e,t,n){if(Pu)return e(t,n);Pu=!0;try{return pg(e,t,n)}finally{Pu=!1,(Qi!==null||Ji!==null)&&(mg(),hg())}}function Sa(e,t){var n=e.stateNode;if(n===null)return null;var r=Rc(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ce(231,t,typeof n));return n}var Rd=!1;if(cs)try{var Wo={};Object.defineProperty(Wo,"passive",{get:function(){Rd=!0}}),window.addEventListener("test",Wo,Wo),window.removeEventListener("test",Wo,Wo)}catch{Rd=!1}function a4(e,t,n,r,s,i,a,c,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(g){this.onError(g)}}var aa=!1,Yl=null,Xl=!1,Ld=null,l4={onError:function(e){aa=!0,Yl=e}};function c4(e,t,n,r,s,i,a,c,d){aa=!1,Yl=null,a4.apply(l4,arguments)}function u4(e,t,n,r,s,i,a,c,d){if(c4.apply(this,arguments),aa){if(aa){var h=Yl;aa=!1,Yl=null}else throw Error(ce(198));Xl||(Xl=!0,Ld=h)}}function wi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function yg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gm(e){if(wi(e)!==e)throw Error(ce(188))}function d4(e){var t=e.alternate;if(!t){if(t=wi(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return gm(s),e;if(i===r)return gm(s),t;i=i.sibling}throw Error(ce(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a)throw Error(ce(189))}}if(n.alternate!==r)throw Error(ce(190))}if(n.tag!==3)throw Error(ce(188));return n.stateNode.current===n?e:t}function vg(e){return e=d4(e),e!==null?wg(e):null}function wg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=wg(e);if(t!==null)return t;e=e.sibling}return null}var xg=qn.unstable_scheduleCallback,ym=qn.unstable_cancelCallback,f4=qn.unstable_shouldYield,h4=qn.unstable_requestPaint,Ot=qn.unstable_now,p4=qn.unstable_getCurrentPriorityLevel,Wf=qn.unstable_ImmediatePriority,Sg=qn.unstable_UserBlockingPriority,Kl=qn.unstable_NormalPriority,m4=qn.unstable_LowPriority,kg=qn.unstable_IdlePriority,Mc=null,Yr=null;function g4(e){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(Mc,e,void 0,(e.current.flags&128)===128)}catch{}}var Mr=Math.clz32?Math.clz32:w4,y4=Math.log,v4=Math.LN2;function w4(e){return e>>>=0,e===0?32:31-(y4(e)/v4|0)|0}var cl=64,ul=4194304;function na(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ql(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=na(c):(i&=a,i!==0&&(r=na(i)))}else a=n&~s,a!==0?r=na(a):i!==0&&(r=na(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Mr(t),s=1<<n,r|=e[n],t&=~s;return r}function x4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Mr(i),c=1<<a,d=s[a];d===-1?(!(c&n)||c&r)&&(s[a]=x4(c,t)):d<=t&&(e.expiredLanes|=c),i&=~c}}function Bd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ag(){var e=cl;return cl<<=1,!(cl&4194240)&&(cl=64),e}function Tu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function za(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mr(t),e[t]=n}function k4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Mr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Gf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Mr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function Eg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Cg,Vf,jg,_g,Ng,Fd=!1,dl=[],Ps=null,Ts=null,Is=null,ka=new Map,Aa=new Map,Cs=[],A4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vm(e,t){switch(e){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Ts=null;break;case"mouseover":case"mouseout":Is=null;break;case"pointerover":case"pointerout":ka.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Aa.delete(t.pointerId)}}function Go(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ha(t),t!==null&&Vf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function E4(e,t,n,r,s){switch(t){case"focusin":return Ps=Go(Ps,e,t,n,r,s),!0;case"dragenter":return Ts=Go(Ts,e,t,n,r,s),!0;case"mouseover":return Is=Go(Is,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return ka.set(i,Go(ka.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Aa.set(i,Go(Aa.get(i)||null,e,t,n,r,s)),!0}return!1}function bg(e){var t=ri(e.target);if(t!==null){var n=wi(t);if(n!==null){if(t=n.tag,t===13){if(t=yg(n),t!==null){e.blockedOn=t,Ng(e.priority,function(){jg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ml(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Od(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Td=r,n.target.dispatchEvent(r),Td=null}else return t=Ha(n),t!==null&&Vf(t),e.blockedOn=n,!1;t.shift()}return!0}function wm(e,t,n){Ml(e)&&n.delete(t)}function C4(){Fd=!1,Ps!==null&&Ml(Ps)&&(Ps=null),Ts!==null&&Ml(Ts)&&(Ts=null),Is!==null&&Ml(Is)&&(Is=null),ka.forEach(wm),Aa.forEach(wm)}function Vo(e,t){e.blockedOn===t&&(e.blockedOn=null,Fd||(Fd=!0,qn.unstable_scheduleCallback(qn.unstable_NormalPriority,C4)))}function Ea(e){function t(s){return Vo(s,e)}if(0<dl.length){Vo(dl[0],e);for(var n=1;n<dl.length;n++){var r=dl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ps!==null&&Vo(Ps,e),Ts!==null&&Vo(Ts,e),Is!==null&&Vo(Is,e),ka.forEach(t),Aa.forEach(t),n=0;n<Cs.length;n++)r=Cs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Cs.length&&(n=Cs[0],n.blockedOn===null);)bg(n),n.blockedOn===null&&Cs.shift()}var qi=ms.ReactCurrentBatchConfig,Jl=!0;function j4(e,t,n,r){var s=at,i=qi.transition;qi.transition=null;try{at=1,Yf(e,t,n,r)}finally{at=s,qi.transition=i}}function _4(e,t,n,r){var s=at,i=qi.transition;qi.transition=null;try{at=4,Yf(e,t,n,r)}finally{at=s,qi.transition=i}}function Yf(e,t,n,r){if(Jl){var s=Od(e,t,n,r);if(s===null)Uu(e,t,r,ql,n),vm(e,r);else if(E4(s,e,t,n,r))r.stopPropagation();else if(vm(e,r),t&4&&-1<A4.indexOf(e)){for(;s!==null;){var i=Ha(s);if(i!==null&&Cg(i),i=Od(e,t,n,r),i===null&&Uu(e,t,r,ql,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Uu(e,t,r,null,n)}}var ql=null;function Od(e,t,n,r){if(ql=null,e=Hf(r),e=ri(e),e!==null)if(t=wi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=yg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ql=e,null}function Mg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p4()){case Wf:return 1;case Sg:return 4;case Kl:case m4:return 16;case kg:return 536870912;default:return 16}default:return 16}}var bs=null,Xf=null,Pl=null;function Pg(){if(Pl)return Pl;var e,t=Xf,n=t.length,r,s="value"in bs?bs.value:bs.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return Pl=s.slice(e,1<r?1-r:void 0)}function Tl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function fl(){return!0}function xm(){return!1}function tr(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?fl:xm,this.isPropagationStopped=xm,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fl)},persist:function(){},isPersistent:fl}),t}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kf=tr(jo),Ua=Mt({},jo,{view:0,detail:0}),N4=tr(Ua),Iu,Ru,Yo,Pc=Mt({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yo&&(Yo&&e.type==="mousemove"?(Iu=e.screenX-Yo.screenX,Ru=e.screenY-Yo.screenY):Ru=Iu=0,Yo=e),Iu)},movementY:function(e){return"movementY"in e?e.movementY:Ru}}),Sm=tr(Pc),b4=Mt({},Pc,{dataTransfer:0}),M4=tr(b4),P4=Mt({},Ua,{relatedTarget:0}),Lu=tr(P4),T4=Mt({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),I4=tr(T4),R4=Mt({},jo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),L4=tr(R4),B4=Mt({},jo,{data:0}),km=tr(B4),F4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function D4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$4[e])?!!t[e]:!1}function Qf(){return D4}var z4=Mt({},Ua,{key:function(e){if(e.key){var t=F4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?O4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qf,charCode:function(e){return e.type==="keypress"?Tl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),U4=tr(z4),H4=Mt({},Pc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Am=tr(H4),W4=Mt({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qf}),G4=tr(W4),V4=Mt({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y4=tr(V4),X4=Mt({},Pc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),K4=tr(X4),Q4=[9,13,27,32],Jf=cs&&"CompositionEvent"in window,la=null;cs&&"documentMode"in document&&(la=document.documentMode);var J4=cs&&"TextEvent"in window&&!la,Tg=cs&&(!Jf||la&&8<la&&11>=la),Em=" ",Cm=!1;function Ig(e,t){switch(e){case"keyup":return Q4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Fi=!1;function q4(e,t){switch(e){case"compositionend":return Rg(t);case"keypress":return t.which!==32?null:(Cm=!0,Em);case"textInput":return e=t.data,e===Em&&Cm?null:e;default:return null}}function Z4(e,t){if(Fi)return e==="compositionend"||!Jf&&Ig(e,t)?(e=Pg(),Pl=Xf=bs=null,Fi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tg&&t.locale!=="ko"?null:t.data;default:return null}}var ew={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ew[e.type]:t==="textarea"}function Lg(e,t,n,r){fg(r),t=Zl(t,"onChange"),0<t.length&&(n=new Kf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ca=null,Ca=null;function tw(e){Vg(e,0)}function Tc(e){var t=Di(e);if(ig(t))return e}function nw(e,t){if(e==="change")return t}var Bg=!1;if(cs){var Bu;if(cs){var Fu="oninput"in document;if(!Fu){var _m=document.createElement("div");_m.setAttribute("oninput","return;"),Fu=typeof _m.oninput=="function"}Bu=Fu}else Bu=!1;Bg=Bu&&(!document.documentMode||9<document.documentMode)}function Nm(){ca&&(ca.detachEvent("onpropertychange",Fg),Ca=ca=null)}function Fg(e){if(e.propertyName==="value"&&Tc(Ca)){var t=[];Lg(t,Ca,e,Hf(e)),gg(tw,t)}}function rw(e,t,n){e==="focusin"?(Nm(),ca=t,Ca=n,ca.attachEvent("onpropertychange",Fg)):e==="focusout"&&Nm()}function sw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Tc(Ca)}function iw(e,t){if(e==="click")return Tc(t)}function ow(e,t){if(e==="input"||e==="change")return Tc(t)}function aw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tr=typeof Object.is=="function"?Object.is:aw;function ja(e,t){if(Tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!xd.call(t,s)||!Tr(e[s],t[s]))return!1}return!0}function bm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Mm(e,t){var n=bm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=bm(n)}}function Og(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Og(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $g(){for(var e=window,t=Vl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Vl(e.document)}return t}function qf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function lw(e){var t=$g(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Og(n.ownerDocument.documentElement,n)){if(r!==null&&qf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Mm(n,i);var a=Mm(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cw=cs&&"documentMode"in document&&11>=document.documentMode,Oi=null,$d=null,ua=null,Dd=!1;function Pm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Dd||Oi==null||Oi!==Vl(r)||(r=Oi,"selectionStart"in r&&qf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ua&&ja(ua,r)||(ua=r,r=Zl($d,"onSelect"),0<r.length&&(t=new Kf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Oi)))}function hl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var $i={animationend:hl("Animation","AnimationEnd"),animationiteration:hl("Animation","AnimationIteration"),animationstart:hl("Animation","AnimationStart"),transitionend:hl("Transition","TransitionEnd")},Ou={},Dg={};cs&&(Dg=document.createElement("div").style,"AnimationEvent"in window||(delete $i.animationend.animation,delete $i.animationiteration.animation,delete $i.animationstart.animation),"TransitionEvent"in window||delete $i.transitionend.transition);function Ic(e){if(Ou[e])return Ou[e];if(!$i[e])return e;var t=$i[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Dg)return Ou[e]=t[n];return e}var zg=Ic("animationend"),Ug=Ic("animationiteration"),Hg=Ic("animationstart"),Wg=Ic("transitionend"),Gg=new Map,Tm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gs(e,t){Gg.set(e,t),vi(t,[e])}for(var $u=0;$u<Tm.length;$u++){var Du=Tm[$u],uw=Du.toLowerCase(),dw=Du[0].toUpperCase()+Du.slice(1);Gs(uw,"on"+dw)}Gs(zg,"onAnimationEnd");Gs(Ug,"onAnimationIteration");Gs(Hg,"onAnimationStart");Gs("dblclick","onDoubleClick");Gs("focusin","onFocus");Gs("focusout","onBlur");Gs(Wg,"onTransitionEnd");ao("onMouseEnter",["mouseout","mouseover"]);ao("onMouseLeave",["mouseout","mouseover"]);ao("onPointerEnter",["pointerout","pointerover"]);ao("onPointerLeave",["pointerout","pointerover"]);vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fw=new Set("cancel close invalid load scroll toggle".split(" ").concat(ra));function Im(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,u4(r,t,void 0,e),e.currentTarget=null}function Vg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var c=r[a],d=c.instance,h=c.currentTarget;if(c=c.listener,d!==i&&s.isPropagationStopped())break e;Im(s,c,h),i=d}else for(a=0;a<r.length;a++){if(c=r[a],d=c.instance,h=c.currentTarget,c=c.listener,d!==i&&s.isPropagationStopped())break e;Im(s,c,h),i=d}}}if(Xl)throw e=Ld,Xl=!1,Ld=null,e}function yt(e,t){var n=t[Gd];n===void 0&&(n=t[Gd]=new Set);var r=e+"__bubble";n.has(r)||(Yg(t,e,2,!1),n.add(r))}function zu(e,t,n){var r=0;t&&(r|=4),Yg(n,e,r,t)}var pl="_reactListening"+Math.random().toString(36).slice(2);function _a(e){if(!e[pl]){e[pl]=!0,eg.forEach(function(n){n!=="selectionchange"&&(fw.has(n)||zu(n,!1,e),zu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[pl]||(t[pl]=!0,zu("selectionchange",!1,t))}}function Yg(e,t,n,r){switch(Mg(t)){case 1:var s=j4;break;case 4:s=_4;break;default:s=Yf}n=s.bind(null,t,n,e),s=void 0,!Rd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Uu(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;c!==null;){if(a=ri(c),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}c=c.parentNode}}r=r.return}gg(function(){var h=i,g=Hf(n),v=[];e:{var w=Gg.get(e);if(w!==void 0){var N=Kf,D=e;switch(e){case"keypress":if(Tl(n)===0)break e;case"keydown":case"keyup":N=U4;break;case"focusin":D="focus",N=Lu;break;case"focusout":D="blur",N=Lu;break;case"beforeblur":case"afterblur":N=Lu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=Sm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=M4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=G4;break;case zg:case Ug:case Hg:N=I4;break;case Wg:N=Y4;break;case"scroll":N=N4;break;case"wheel":N=K4;break;case"copy":case"cut":case"paste":N=L4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=Am}var T=(t&4)!==0,V=!T&&e==="scroll",j=T?w!==null?w+"Capture":null:w;T=[];for(var y=h,k;y!==null;){k=y;var M=k.stateNode;if(k.tag===5&&M!==null&&(k=M,j!==null&&(M=Sa(y,j),M!=null&&T.push(Na(y,M,k)))),V)break;y=y.return}0<T.length&&(w=new N(w,D,null,n,g),v.push({event:w,listeners:T}))}}if(!(t&7)){e:{if(w=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",w&&n!==Td&&(D=n.relatedTarget||n.fromElement)&&(ri(D)||D[us]))break e;if((N||w)&&(w=g.window===g?g:(w=g.ownerDocument)?w.defaultView||w.parentWindow:window,N?(D=n.relatedTarget||n.toElement,N=h,D=D?ri(D):null,D!==null&&(V=wi(D),D!==V||D.tag!==5&&D.tag!==6)&&(D=null)):(N=null,D=h),N!==D)){if(T=Sm,M="onMouseLeave",j="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(T=Am,M="onPointerLeave",j="onPointerEnter",y="pointer"),V=N==null?w:Di(N),k=D==null?w:Di(D),w=new T(M,y+"leave",N,n,g),w.target=V,w.relatedTarget=k,M=null,ri(g)===h&&(T=new T(j,y+"enter",D,n,g),T.target=k,T.relatedTarget=V,M=T),V=M,N&&D)t:{for(T=N,j=D,y=0,k=T;k;k=Pi(k))y++;for(k=0,M=j;M;M=Pi(M))k++;for(;0<y-k;)T=Pi(T),y--;for(;0<k-y;)j=Pi(j),k--;for(;y--;){if(T===j||j!==null&&T===j.alternate)break t;T=Pi(T),j=Pi(j)}T=null}else T=null;N!==null&&Rm(v,w,N,T,!1),D!==null&&V!==null&&Rm(v,V,D,T,!0)}}e:{if(w=h?Di(h):window,N=w.nodeName&&w.nodeName.toLowerCase(),N==="select"||N==="input"&&w.type==="file")var b=nw;else if(jm(w))if(Bg)b=ow;else{b=sw;var H=rw}else(N=w.nodeName)&&N.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(b=iw);if(b&&(b=b(e,h))){Lg(v,b,n,g);break e}H&&H(e,w,h),e==="focusout"&&(H=w._wrapperState)&&H.controlled&&w.type==="number"&&_d(w,"number",w.value)}switch(H=h?Di(h):window,e){case"focusin":(jm(H)||H.contentEditable==="true")&&(Oi=H,$d=h,ua=null);break;case"focusout":ua=$d=Oi=null;break;case"mousedown":Dd=!0;break;case"contextmenu":case"mouseup":case"dragend":Dd=!1,Pm(v,n,g);break;case"selectionchange":if(cw)break;case"keydown":case"keyup":Pm(v,n,g)}var L;if(Jf)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Fi?Ig(e,n)&&(F="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(F="onCompositionStart");F&&(Tg&&n.locale!=="ko"&&(Fi||F!=="onCompositionStart"?F==="onCompositionEnd"&&Fi&&(L=Pg()):(bs=g,Xf="value"in bs?bs.value:bs.textContent,Fi=!0)),H=Zl(h,F),0<H.length&&(F=new km(F,e,null,n,g),v.push({event:F,listeners:H}),L?F.data=L:(L=Rg(n),L!==null&&(F.data=L)))),(L=J4?q4(e,n):Z4(e,n))&&(h=Zl(h,"onBeforeInput"),0<h.length&&(g=new km("onBeforeInput","beforeinput",null,n,g),v.push({event:g,listeners:h}),g.data=L))}Vg(v,t)})}function Na(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Zl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Sa(e,n),i!=null&&r.unshift(Na(e,i,s)),i=Sa(e,t),i!=null&&r.push(Na(e,i,s))),e=e.return}return r}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Rm(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var c=n,d=c.alternate,h=c.stateNode;if(d!==null&&d===r)break;c.tag===5&&h!==null&&(c=h,s?(d=Sa(n,i),d!=null&&a.unshift(Na(n,d,c))):s||(d=Sa(n,i),d!=null&&a.push(Na(n,d,c)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var hw=/\r\n?/g,pw=/\u0000|\uFFFD/g;function Lm(e){return(typeof e=="string"?e:""+e).replace(hw,`
`).replace(pw,"")}function ml(e,t,n){if(t=Lm(t),Lm(e)!==t&&n)throw Error(ce(425))}function ec(){}var zd=null,Ud=null;function Hd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wd=typeof setTimeout=="function"?setTimeout:void 0,mw=typeof clearTimeout=="function"?clearTimeout:void 0,Bm=typeof Promise=="function"?Promise:void 0,gw=typeof queueMicrotask=="function"?queueMicrotask:typeof Bm<"u"?function(e){return Bm.resolve(null).then(e).catch(yw)}:Wd;function yw(e){setTimeout(function(){throw e})}function Hu(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Ea(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ea(t)}function Rs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Fm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var _o=Math.random().toString(36).slice(2),Vr="__reactFiber$"+_o,ba="__reactProps$"+_o,us="__reactContainer$"+_o,Gd="__reactEvents$"+_o,vw="__reactListeners$"+_o,ww="__reactHandles$"+_o;function ri(e){var t=e[Vr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[us]||n[Vr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Fm(e);e!==null;){if(n=e[Vr])return n;e=Fm(e)}return t}e=n,n=e.parentNode}return null}function Ha(e){return e=e[Vr]||e[us],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Di(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function Rc(e){return e[ba]||null}var Vd=[],zi=-1;function Vs(e){return{current:e}}function vt(e){0>zi||(e.current=Vd[zi],Vd[zi]=null,zi--)}function ht(e,t){zi++,Vd[zi]=e.current,e.current=t}var Us={},mn=Vs(Us),Tn=Vs(!1),di=Us;function lo(e,t){var n=e.type.contextTypes;if(!n)return Us;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function In(e){return e=e.childContextTypes,e!=null}function tc(){vt(Tn),vt(mn)}function Om(e,t,n){if(mn.current!==Us)throw Error(ce(168));ht(mn,t),ht(Tn,n)}function Xg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(ce(108,r4(e)||"Unknown",s));return Mt({},n,r)}function nc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Us,di=mn.current,ht(mn,e),ht(Tn,Tn.current),!0}function $m(e,t,n){var r=e.stateNode;if(!r)throw Error(ce(169));n?(e=Xg(e,t,di),r.__reactInternalMemoizedMergedChildContext=e,vt(Tn),vt(mn),ht(mn,e)):vt(Tn),ht(Tn,n)}var Zr=null,Lc=!1,Wu=!1;function Kg(e){Zr===null?Zr=[e]:Zr.push(e)}function xw(e){Lc=!0,Kg(e)}function Ys(){if(!Wu&&Zr!==null){Wu=!0;var e=0,t=at;try{var n=Zr;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Zr=null,Lc=!1}catch(s){throw Zr!==null&&(Zr=Zr.slice(e+1)),xg(Wf,Ys),s}finally{at=t,Wu=!1}}return null}var Ui=[],Hi=0,rc=null,sc=0,ur=[],dr=0,fi=null,ns=1,rs="";function ti(e,t){Ui[Hi++]=sc,Ui[Hi++]=rc,rc=e,sc=t}function Qg(e,t,n){ur[dr++]=ns,ur[dr++]=rs,ur[dr++]=fi,fi=e;var r=ns;e=rs;var s=32-Mr(r)-1;r&=~(1<<s),n+=1;var i=32-Mr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ns=1<<32-Mr(t)+s|n<<s|r,rs=i+e}else ns=1<<i|n<<s|r,rs=e}function Zf(e){e.return!==null&&(ti(e,1),Qg(e,1,0))}function eh(e){for(;e===rc;)rc=Ui[--Hi],Ui[Hi]=null,sc=Ui[--Hi],Ui[Hi]=null;for(;e===fi;)fi=ur[--dr],ur[dr]=null,rs=ur[--dr],ur[dr]=null,ns=ur[--dr],ur[dr]=null}var Jn=null,Qn=null,kt=!1,Nr=null;function Jg(e,t){var n=hr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Dm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Jn=e,Qn=Rs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Jn=e,Qn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=fi!==null?{id:ns,overflow:rs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Jn=e,Qn=null,!0):!1;default:return!1}}function Yd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xd(e){if(kt){var t=Qn;if(t){var n=t;if(!Dm(e,t)){if(Yd(e))throw Error(ce(418));t=Rs(n.nextSibling);var r=Jn;t&&Dm(e,t)?Jg(r,n):(e.flags=e.flags&-4097|2,kt=!1,Jn=e)}}else{if(Yd(e))throw Error(ce(418));e.flags=e.flags&-4097|2,kt=!1,Jn=e}}}function zm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Jn=e}function gl(e){if(e!==Jn)return!1;if(!kt)return zm(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Hd(e.type,e.memoizedProps)),t&&(t=Qn)){if(Yd(e))throw qg(),Error(ce(418));for(;t;)Jg(e,t),t=Rs(t.nextSibling)}if(zm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Qn=Rs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Qn=null}}else Qn=Jn?Rs(e.stateNode.nextSibling):null;return!0}function qg(){for(var e=Qn;e;)e=Rs(e.nextSibling)}function co(){Qn=Jn=null,kt=!1}function th(e){Nr===null?Nr=[e]:Nr.push(e)}var Sw=ms.ReactCurrentBatchConfig;function Xo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ce(309));var r=n.stateNode}if(!r)throw Error(ce(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var c=s.refs;a===null?delete c[i]:c[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ce(284));if(!n._owner)throw Error(ce(290,e))}return e}function yl(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Um(e){var t=e._init;return t(e._payload)}function Zg(e){function t(j,y){if(e){var k=j.deletions;k===null?(j.deletions=[y],j.flags|=16):k.push(y)}}function n(j,y){if(!e)return null;for(;y!==null;)t(j,y),y=y.sibling;return null}function r(j,y){for(j=new Map;y!==null;)y.key!==null?j.set(y.key,y):j.set(y.index,y),y=y.sibling;return j}function s(j,y){return j=Os(j,y),j.index=0,j.sibling=null,j}function i(j,y,k){return j.index=k,e?(k=j.alternate,k!==null?(k=k.index,k<y?(j.flags|=2,y):k):(j.flags|=2,y)):(j.flags|=1048576,y)}function a(j){return e&&j.alternate===null&&(j.flags|=2),j}function c(j,y,k,M){return y===null||y.tag!==6?(y=Ju(k,j.mode,M),y.return=j,y):(y=s(y,k),y.return=j,y)}function d(j,y,k,M){var b=k.type;return b===Bi?g(j,y,k.props.children,M,k.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ks&&Um(b)===y.type)?(M=s(y,k.props),M.ref=Xo(j,y,k),M.return=j,M):(M=$l(k.type,k.key,k.props,null,j.mode,M),M.ref=Xo(j,y,k),M.return=j,M)}function h(j,y,k,M){return y===null||y.tag!==4||y.stateNode.containerInfo!==k.containerInfo||y.stateNode.implementation!==k.implementation?(y=qu(k,j.mode,M),y.return=j,y):(y=s(y,k.children||[]),y.return=j,y)}function g(j,y,k,M,b){return y===null||y.tag!==7?(y=ci(k,j.mode,M,b),y.return=j,y):(y=s(y,k),y.return=j,y)}function v(j,y,k){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ju(""+y,j.mode,k),y.return=j,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ol:return k=$l(y.type,y.key,y.props,null,j.mode,k),k.ref=Xo(j,null,y),k.return=j,k;case Li:return y=qu(y,j.mode,k),y.return=j,y;case ks:var M=y._init;return v(j,M(y._payload),k)}if(ta(y)||Ho(y))return y=ci(y,j.mode,k,null),y.return=j,y;yl(j,y)}return null}function w(j,y,k,M){var b=y!==null?y.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return b!==null?null:c(j,y,""+k,M);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ol:return k.key===b?d(j,y,k,M):null;case Li:return k.key===b?h(j,y,k,M):null;case ks:return b=k._init,w(j,y,b(k._payload),M)}if(ta(k)||Ho(k))return b!==null?null:g(j,y,k,M,null);yl(j,k)}return null}function N(j,y,k,M,b){if(typeof M=="string"&&M!==""||typeof M=="number")return j=j.get(k)||null,c(y,j,""+M,b);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case ol:return j=j.get(M.key===null?k:M.key)||null,d(y,j,M,b);case Li:return j=j.get(M.key===null?k:M.key)||null,h(y,j,M,b);case ks:var H=M._init;return N(j,y,k,H(M._payload),b)}if(ta(M)||Ho(M))return j=j.get(k)||null,g(y,j,M,b,null);yl(y,M)}return null}function D(j,y,k,M){for(var b=null,H=null,L=y,F=y=0,z=null;L!==null&&F<k.length;F++){L.index>F?(z=L,L=null):z=L.sibling;var W=w(j,L,k[F],M);if(W===null){L===null&&(L=z);break}e&&L&&W.alternate===null&&t(j,L),y=i(W,y,F),H===null?b=W:H.sibling=W,H=W,L=z}if(F===k.length)return n(j,L),kt&&ti(j,F),b;if(L===null){for(;F<k.length;F++)L=v(j,k[F],M),L!==null&&(y=i(L,y,F),H===null?b=L:H.sibling=L,H=L);return kt&&ti(j,F),b}for(L=r(j,L);F<k.length;F++)z=N(L,j,F,k[F],M),z!==null&&(e&&z.alternate!==null&&L.delete(z.key===null?F:z.key),y=i(z,y,F),H===null?b=z:H.sibling=z,H=z);return e&&L.forEach(function(Y){return t(j,Y)}),kt&&ti(j,F),b}function T(j,y,k,M){var b=Ho(k);if(typeof b!="function")throw Error(ce(150));if(k=b.call(k),k==null)throw Error(ce(151));for(var H=b=null,L=y,F=y=0,z=null,W=k.next();L!==null&&!W.done;F++,W=k.next()){L.index>F?(z=L,L=null):z=L.sibling;var Y=w(j,L,W.value,M);if(Y===null){L===null&&(L=z);break}e&&L&&Y.alternate===null&&t(j,L),y=i(Y,y,F),H===null?b=Y:H.sibling=Y,H=Y,L=z}if(W.done)return n(j,L),kt&&ti(j,F),b;if(L===null){for(;!W.done;F++,W=k.next())W=v(j,W.value,M),W!==null&&(y=i(W,y,F),H===null?b=W:H.sibling=W,H=W);return kt&&ti(j,F),b}for(L=r(j,L);!W.done;F++,W=k.next())W=N(L,j,F,W.value,M),W!==null&&(e&&W.alternate!==null&&L.delete(W.key===null?F:W.key),y=i(W,y,F),H===null?b=W:H.sibling=W,H=W);return e&&L.forEach(function(q){return t(j,q)}),kt&&ti(j,F),b}function V(j,y,k,M){if(typeof k=="object"&&k!==null&&k.type===Bi&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case ol:e:{for(var b=k.key,H=y;H!==null;){if(H.key===b){if(b=k.type,b===Bi){if(H.tag===7){n(j,H.sibling),y=s(H,k.props.children),y.return=j,j=y;break e}}else if(H.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ks&&Um(b)===H.type){n(j,H.sibling),y=s(H,k.props),y.ref=Xo(j,H,k),y.return=j,j=y;break e}n(j,H);break}else t(j,H);H=H.sibling}k.type===Bi?(y=ci(k.props.children,j.mode,M,k.key),y.return=j,j=y):(M=$l(k.type,k.key,k.props,null,j.mode,M),M.ref=Xo(j,y,k),M.return=j,j=M)}return a(j);case Li:e:{for(H=k.key;y!==null;){if(y.key===H)if(y.tag===4&&y.stateNode.containerInfo===k.containerInfo&&y.stateNode.implementation===k.implementation){n(j,y.sibling),y=s(y,k.children||[]),y.return=j,j=y;break e}else{n(j,y);break}else t(j,y);y=y.sibling}y=qu(k,j.mode,M),y.return=j,j=y}return a(j);case ks:return H=k._init,V(j,y,H(k._payload),M)}if(ta(k))return D(j,y,k,M);if(Ho(k))return T(j,y,k,M);yl(j,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,y!==null&&y.tag===6?(n(j,y.sibling),y=s(y,k),y.return=j,j=y):(n(j,y),y=Ju(k,j.mode,M),y.return=j,j=y),a(j)):n(j,y)}return V}var uo=Zg(!0),e2=Zg(!1),ic=Vs(null),oc=null,Wi=null,nh=null;function rh(){nh=Wi=oc=null}function sh(e){var t=ic.current;vt(ic),e._currentValue=t}function Kd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Zi(e,t){oc=e,nh=Wi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pn=!0),e.firstContext=null)}function gr(e){var t=e._currentValue;if(nh!==e)if(e={context:e,memoizedValue:t,next:null},Wi===null){if(oc===null)throw Error(ce(308));Wi=e,oc.dependencies={lanes:0,firstContext:e}}else Wi=Wi.next=e;return t}var si=null;function ih(e){si===null?si=[e]:si.push(e)}function t2(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,ih(t)):(n.next=s.next,s.next=n),t.interleaved=n,ds(e,r)}function ds(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var As=!1;function oh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function n2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function is(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ls(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,et&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,ds(e,n)}return s=r.interleaved,s===null?(t.next=t,ih(r)):(t.next=s.next,s.next=t),r.interleaved=t,ds(e,n)}function Il(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gf(e,n)}}function Hm(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ac(e,t,n,r){var s=e.updateQueue;As=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var d=c,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var g=e.alternate;g!==null&&(g=g.updateQueue,c=g.lastBaseUpdate,c!==a&&(c===null?g.firstBaseUpdate=h:c.next=h,g.lastBaseUpdate=d))}if(i!==null){var v=s.baseState;a=0,g=h=d=null,c=i;do{var w=c.lane,N=c.eventTime;if((r&w)===w){g!==null&&(g=g.next={eventTime:N,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var D=e,T=c;switch(w=t,N=n,T.tag){case 1:if(D=T.payload,typeof D=="function"){v=D.call(N,v,w);break e}v=D;break e;case 3:D.flags=D.flags&-65537|128;case 0:if(D=T.payload,w=typeof D=="function"?D.call(N,v,w):D,w==null)break e;v=Mt({},v,w);break e;case 2:As=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,w=s.effects,w===null?s.effects=[c]:w.push(c))}else N={eventTime:N,lane:w,tag:c.tag,payload:c.payload,callback:c.callback,next:null},g===null?(h=g=N,d=v):g=g.next=N,a|=w;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;w=c,c=w.next,w.next=null,s.lastBaseUpdate=w,s.shared.pending=null}}while(!0);if(g===null&&(d=v),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);pi|=a,e.lanes=a,e.memoizedState=v}}function Wm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ce(191,s));s.call(r)}}}var Wa={},Xr=Vs(Wa),Ma=Vs(Wa),Pa=Vs(Wa);function ii(e){if(e===Wa)throw Error(ce(174));return e}function ah(e,t){switch(ht(Pa,t),ht(Ma,e),ht(Xr,Wa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bd(t,e)}vt(Xr),ht(Xr,t)}function fo(){vt(Xr),vt(Ma),vt(Pa)}function r2(e){ii(Pa.current);var t=ii(Xr.current),n=bd(t,e.type);t!==n&&(ht(Ma,e),ht(Xr,n))}function lh(e){Ma.current===e&&(vt(Xr),vt(Ma))}var _t=Vs(0);function lc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Gu=[];function ch(){for(var e=0;e<Gu.length;e++)Gu[e]._workInProgressVersionPrimary=null;Gu.length=0}var Rl=ms.ReactCurrentDispatcher,Vu=ms.ReactCurrentBatchConfig,hi=0,Nt=null,Gt=null,Zt=null,cc=!1,da=!1,Ta=0,kw=0;function un(){throw Error(ce(321))}function uh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Tr(e[n],t[n]))return!1;return!0}function dh(e,t,n,r,s,i){if(hi=i,Nt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Rl.current=e===null||e.memoizedState===null?jw:_w,e=n(r,s),da){i=0;do{if(da=!1,Ta=0,25<=i)throw Error(ce(301));i+=1,Zt=Gt=null,t.updateQueue=null,Rl.current=Nw,e=n(r,s)}while(da)}if(Rl.current=uc,t=Gt!==null&&Gt.next!==null,hi=0,Zt=Gt=Nt=null,cc=!1,t)throw Error(ce(300));return e}function fh(){var e=Ta!==0;return Ta=0,e}function Wr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Nt.memoizedState=Zt=e:Zt=Zt.next=e,Zt}function yr(){if(Gt===null){var e=Nt.alternate;e=e!==null?e.memoizedState:null}else e=Gt.next;var t=Zt===null?Nt.memoizedState:Zt.next;if(t!==null)Zt=t,Gt=e;else{if(e===null)throw Error(ce(310));Gt=e,e={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Zt===null?Nt.memoizedState=Zt=e:Zt=Zt.next=e}return Zt}function Ia(e,t){return typeof t=="function"?t(e):t}function Yu(e){var t=yr(),n=t.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=e;var r=Gt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=a=null,d=null,h=i;do{var g=h.lane;if((hi&g)===g)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var v={lane:g,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(c=d=v,a=r):d=d.next=v,Nt.lanes|=g,pi|=g}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=c,Tr(r,t.memoizedState)||(Pn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Nt.lanes|=i,pi|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Xu(e){var t=yr(),n=t.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Tr(i,t.memoizedState)||(Pn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function s2(){}function i2(e,t){var n=Nt,r=yr(),s=t(),i=!Tr(r.memoizedState,s);if(i&&(r.memoizedState=s,Pn=!0),r=r.queue,hh(l2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Zt!==null&&Zt.memoizedState.tag&1){if(n.flags|=2048,Ra(9,a2.bind(null,n,r,s,t),void 0,null),en===null)throw Error(ce(349));hi&30||o2(n,t,s)}return s}function o2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function a2(e,t,n,r){t.value=n,t.getSnapshot=r,c2(t)&&u2(e)}function l2(e,t,n){return n(function(){c2(t)&&u2(e)})}function c2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Tr(e,n)}catch{return!0}}function u2(e){var t=ds(e,1);t!==null&&Pr(t,e,1,-1)}function Gm(e){var t=Wr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:e},t.queue=e,e=e.dispatch=Cw.bind(null,Nt,e),[t.memoizedState,e]}function Ra(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function d2(){return yr().memoizedState}function Ll(e,t,n,r){var s=Wr();Nt.flags|=e,s.memoizedState=Ra(1|t,n,void 0,r===void 0?null:r)}function Bc(e,t,n,r){var s=yr();r=r===void 0?null:r;var i=void 0;if(Gt!==null){var a=Gt.memoizedState;if(i=a.destroy,r!==null&&uh(r,a.deps)){s.memoizedState=Ra(t,n,i,r);return}}Nt.flags|=e,s.memoizedState=Ra(1|t,n,i,r)}function Vm(e,t){return Ll(8390656,8,e,t)}function hh(e,t){return Bc(2048,8,e,t)}function f2(e,t){return Bc(4,2,e,t)}function h2(e,t){return Bc(4,4,e,t)}function p2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function m2(e,t,n){return n=n!=null?n.concat([e]):null,Bc(4,4,p2.bind(null,t,e),n)}function ph(){}function g2(e,t){var n=yr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&uh(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function y2(e,t){var n=yr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&uh(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function v2(e,t,n){return hi&21?(Tr(n,t)||(n=Ag(),Nt.lanes|=n,pi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pn=!0),e.memoizedState=n)}function Aw(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=Vu.transition;Vu.transition={};try{e(!1),t()}finally{at=n,Vu.transition=r}}function w2(){return yr().memoizedState}function Ew(e,t,n){var r=Fs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},x2(e))S2(t,n);else if(n=t2(e,t,n,r),n!==null){var s=vn();Pr(n,e,r,s),k2(n,t,r)}}function Cw(e,t,n){var r=Fs(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(x2(e))S2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,c=i(a,n);if(s.hasEagerState=!0,s.eagerState=c,Tr(c,a)){var d=t.interleaved;d===null?(s.next=s,ih(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=t2(e,t,s,r),n!==null&&(s=vn(),Pr(n,e,r,s),k2(n,t,r))}}function x2(e){var t=e.alternate;return e===Nt||t!==null&&t===Nt}function S2(e,t){da=cc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function k2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gf(e,n)}}var uc={readContext:gr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},jw={readContext:gr,useCallback:function(e,t){return Wr().memoizedState=[e,t===void 0?null:t],e},useContext:gr,useEffect:Vm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ll(4194308,4,p2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ll(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ll(4,2,e,t)},useMemo:function(e,t){var n=Wr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Wr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ew.bind(null,Nt,e),[r.memoizedState,e]},useRef:function(e){var t=Wr();return e={current:e},t.memoizedState=e},useState:Gm,useDebugValue:ph,useDeferredValue:function(e){return Wr().memoizedState=e},useTransition:function(){var e=Gm(!1),t=e[0];return e=Aw.bind(null,e[1]),Wr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Nt,s=Wr();if(kt){if(n===void 0)throw Error(ce(407));n=n()}else{if(n=t(),en===null)throw Error(ce(349));hi&30||o2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Vm(l2.bind(null,r,i,e),[e]),r.flags|=2048,Ra(9,a2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Wr(),t=en.identifierPrefix;if(kt){var n=rs,r=ns;n=(r&~(1<<32-Mr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ta++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=kw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_w={readContext:gr,useCallback:g2,useContext:gr,useEffect:hh,useImperativeHandle:m2,useInsertionEffect:f2,useLayoutEffect:h2,useMemo:y2,useReducer:Yu,useRef:d2,useState:function(){return Yu(Ia)},useDebugValue:ph,useDeferredValue:function(e){var t=yr();return v2(t,Gt.memoizedState,e)},useTransition:function(){var e=Yu(Ia)[0],t=yr().memoizedState;return[e,t]},useMutableSource:s2,useSyncExternalStore:i2,useId:w2,unstable_isNewReconciler:!1},Nw={readContext:gr,useCallback:g2,useContext:gr,useEffect:hh,useImperativeHandle:m2,useInsertionEffect:f2,useLayoutEffect:h2,useMemo:y2,useReducer:Xu,useRef:d2,useState:function(){return Xu(Ia)},useDebugValue:ph,useDeferredValue:function(e){var t=yr();return Gt===null?t.memoizedState=e:v2(t,Gt.memoizedState,e)},useTransition:function(){var e=Xu(Ia)[0],t=yr().memoizedState;return[e,t]},useMutableSource:s2,useSyncExternalStore:i2,useId:w2,unstable_isNewReconciler:!1};function jr(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Qd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Mt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Fc={isMounted:function(e){return(e=e._reactInternals)?wi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Fs(e),i=is(r,s);i.payload=t,n!=null&&(i.callback=n),t=Ls(e,i,s),t!==null&&(Pr(t,e,s,r),Il(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Fs(e),i=is(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ls(e,i,s),t!==null&&(Pr(t,e,s,r),Il(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=vn(),r=Fs(e),s=is(n,r);s.tag=2,t!=null&&(s.callback=t),t=Ls(e,s,r),t!==null&&(Pr(t,e,r,n),Il(t,e,r))}};function Ym(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!ja(n,r)||!ja(s,i):!0}function A2(e,t,n){var r=!1,s=Us,i=t.contextType;return typeof i=="object"&&i!==null?i=gr(i):(s=In(t)?di:mn.current,r=t.contextTypes,i=(r=r!=null)?lo(e,s):Us),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Fc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Xm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Fc.enqueueReplaceState(t,t.state,null)}function Jd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},oh(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=gr(i):(i=In(t)?di:mn.current,s.context=lo(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Qd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Fc.enqueueReplaceState(s,s.state,null),ac(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ho(e,t){try{var n="",r=t;do n+=n4(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Ku(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function qd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var bw=typeof WeakMap=="function"?WeakMap:Map;function E2(e,t,n){n=is(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){fc||(fc=!0,cf=r),qd(e,t)},n}function C2(e,t,n){n=is(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){qd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qd(e,t),typeof r!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Km(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new bw;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Hw.bind(null,e,t,n),t.then(e,e))}function Qm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jm(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=is(-1,1),t.tag=2,Ls(n,t,1))),n.lanes|=1),e)}var Mw=ms.ReactCurrentOwner,Pn=!1;function yn(e,t,n,r){t.child=e===null?e2(t,null,n,r):uo(t,e.child,n,r)}function qm(e,t,n,r,s){n=n.render;var i=t.ref;return Zi(t,s),r=dh(e,t,n,r,i,s),n=fh(),e!==null&&!Pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fs(e,t,s)):(kt&&n&&Zf(t),t.flags|=1,yn(e,t,r,s),t.child)}function Zm(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!kh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,j2(e,t,i,r,s)):(e=$l(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ja,n(a,r)&&e.ref===t.ref)return fs(e,t,s)}return t.flags|=1,e=Os(i,r),e.ref=t.ref,e.return=t,t.child=e}function j2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(ja(i,r)&&e.ref===t.ref)if(Pn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Pn=!0);else return t.lanes=e.lanes,fs(e,t,s)}return Zd(e,t,n,r,s)}function _2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(Vi,Kn),Kn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(Vi,Kn),Kn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ht(Vi,Kn),Kn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,ht(Vi,Kn),Kn|=r;return yn(e,t,s,n),t.child}function N2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Zd(e,t,n,r,s){var i=In(n)?di:mn.current;return i=lo(t,i),Zi(t,s),n=dh(e,t,n,r,i,s),r=fh(),e!==null&&!Pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fs(e,t,s)):(kt&&r&&Zf(t),t.flags|=1,yn(e,t,n,s),t.child)}function e1(e,t,n,r,s){if(In(n)){var i=!0;nc(t)}else i=!1;if(Zi(t,s),t.stateNode===null)Bl(e,t),A2(t,n,r),Jd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,c=t.memoizedProps;a.props=c;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=gr(h):(h=In(n)?di:mn.current,h=lo(t,h));var g=n.getDerivedStateFromProps,v=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||d!==h)&&Xm(t,a,r,h),As=!1;var w=t.memoizedState;a.state=w,ac(t,r,a,s),d=t.memoizedState,c!==r||w!==d||Tn.current||As?(typeof g=="function"&&(Qd(t,n,g,r),d=t.memoizedState),(c=As||Ym(t,n,c,r,w,d,h))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=c):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,n2(e,t),c=t.memoizedProps,h=t.type===t.elementType?c:jr(t.type,c),a.props=h,v=t.pendingProps,w=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=gr(d):(d=In(n)?di:mn.current,d=lo(t,d));var N=n.getDerivedStateFromProps;(g=typeof N=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==v||w!==d)&&Xm(t,a,r,d),As=!1,w=t.memoizedState,a.state=w,ac(t,r,a,s);var D=t.memoizedState;c!==v||w!==D||Tn.current||As?(typeof N=="function"&&(Qd(t,n,N,r),D=t.memoizedState),(h=As||Ym(t,n,h,r,w,D,d)||!1)?(g||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,D,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,D,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=D),a.props=r,a.state=D,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),r=!1)}return ef(e,t,n,r,i,s)}function ef(e,t,n,r,s,i){N2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&$m(t,n,!1),fs(e,t,i);r=t.stateNode,Mw.current=t;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=uo(t,e.child,null,i),t.child=uo(t,null,c,i)):yn(e,t,c,i),t.memoizedState=r.state,s&&$m(t,n,!0),t.child}function b2(e){var t=e.stateNode;t.pendingContext?Om(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Om(e,t.context,!1),ah(e,t.containerInfo)}function t1(e,t,n,r,s){return co(),th(s),t.flags|=256,yn(e,t,n,r),t.child}var tf={dehydrated:null,treeContext:null,retryLane:0};function nf(e){return{baseLanes:e,cachePool:null,transitions:null}}function M2(e,t,n){var r=t.pendingProps,s=_t.current,i=!1,a=(t.flags&128)!==0,c;if((c=a)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ht(_t,s&1),e===null)return Xd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Dc(a,r,0,null),e=ci(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=nf(n),t.memoizedState=tf,e):mh(t,a));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Pw(e,t,a,r,c,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,c=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Os(s,d),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Os(c,i):(i=ci(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?nf(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=tf,r}return i=e.child,e=i.sibling,r=Os(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function mh(e,t){return t=Dc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function vl(e,t,n,r){return r!==null&&th(r),uo(t,e.child,null,n),e=mh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pw(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Ku(Error(ce(422))),vl(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Dc({mode:"visible",children:r.children},s,0,null),i=ci(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&uo(t,e.child,null,a),t.child.memoizedState=nf(a),t.memoizedState=tf,i);if(!(t.mode&1))return vl(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(ce(419)),r=Ku(i,r,void 0),vl(e,t,a,r)}if(c=(a&e.childLanes)!==0,Pn||c){if(r=en,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ds(e,s),Pr(r,e,s,-1))}return Sh(),r=Ku(Error(ce(421))),vl(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Ww.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Qn=Rs(s.nextSibling),Jn=t,kt=!0,Nr=null,e!==null&&(ur[dr++]=ns,ur[dr++]=rs,ur[dr++]=fi,ns=e.id,rs=e.overflow,fi=t),t=mh(t,r.children),t.flags|=4096,t)}function n1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Kd(e.return,t,n)}function Qu(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function P2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(yn(e,t,r.children,n),r=_t.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&n1(e,n,t);else if(e.tag===19)n1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ht(_t,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&lc(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Qu(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&lc(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Qu(t,!0,n,null,i);break;case"together":Qu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),pi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,n=Os(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Os(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Tw(e,t,n){switch(t.tag){case 3:b2(t),co();break;case 5:r2(t);break;case 1:In(t.type)&&nc(t);break;case 4:ah(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ht(ic,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ht(_t,_t.current&1),t.flags|=128,null):n&t.child.childLanes?M2(e,t,n):(ht(_t,_t.current&1),e=fs(e,t,n),e!==null?e.sibling:null);ht(_t,_t.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return P2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ht(_t,_t.current),r)break;return null;case 22:case 23:return t.lanes=0,_2(e,t,n)}return fs(e,t,n)}var T2,rf,I2,R2;T2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rf=function(){};I2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ii(Xr.current);var i=null;switch(n){case"input":s=Cd(e,s),r=Cd(e,r),i=[];break;case"select":s=Mt({},s,{value:void 0}),r=Mt({},r,{value:void 0}),i=[];break;case"textarea":s=Nd(e,s),r=Nd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ec)}Md(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var c=s[h];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(wa.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(c=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==c&&(d!=null||c!=null))if(h==="style")if(c){for(a in c)!c.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&c[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(wa.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&yt("scroll",e),i||c===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};R2=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ko(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function dn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Iw(e,t,n){var r=t.pendingProps;switch(eh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(t),null;case 1:return In(t.type)&&tc(),dn(t),null;case 3:return r=t.stateNode,fo(),vt(Tn),vt(mn),ch(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(gl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nr!==null&&(ff(Nr),Nr=null))),rf(e,t),dn(t),null;case 5:lh(t);var s=ii(Pa.current);if(n=t.type,e!==null&&t.stateNode!=null)I2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ce(166));return dn(t),null}if(e=ii(Xr.current),gl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Vr]=t,r[ba]=i,e=(t.mode&1)!==0,n){case"dialog":yt("cancel",r),yt("close",r);break;case"iframe":case"object":case"embed":yt("load",r);break;case"video":case"audio":for(s=0;s<ra.length;s++)yt(ra[s],r);break;case"source":yt("error",r);break;case"img":case"image":case"link":yt("error",r),yt("load",r);break;case"details":yt("toggle",r);break;case"input":dm(r,i),yt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},yt("invalid",r);break;case"textarea":hm(r,i),yt("invalid",r)}Md(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&ml(r.textContent,c,e),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&ml(r.textContent,c,e),s=["children",""+c]):wa.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&yt("scroll",r)}switch(n){case"input":al(r),fm(r,i,!0);break;case"textarea":al(r),pm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ec)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Vr]=t,e[ba]=r,T2(e,t,!1,!1),t.stateNode=e;e:{switch(a=Pd(n,r),n){case"dialog":yt("cancel",e),yt("close",e),s=r;break;case"iframe":case"object":case"embed":yt("load",e),s=r;break;case"video":case"audio":for(s=0;s<ra.length;s++)yt(ra[s],e);s=r;break;case"source":yt("error",e),s=r;break;case"img":case"image":case"link":yt("error",e),yt("load",e),s=r;break;case"details":yt("toggle",e),s=r;break;case"input":dm(e,r),s=Cd(e,r),yt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Mt({},r,{value:void 0}),yt("invalid",e);break;case"textarea":hm(e,r),s=Nd(e,r),yt("invalid",e);break;default:s=r}Md(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var d=c[i];i==="style"?dg(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&cg(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&xa(e,d):typeof d=="number"&&xa(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(wa.hasOwnProperty(i)?d!=null&&i==="onScroll"&&yt("scroll",e):d!=null&&$f(e,i,d,a))}switch(n){case"input":al(e),fm(e,r,!1);break;case"textarea":al(e),pm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+zs(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ki(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ki(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ec)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dn(t),null;case 6:if(e&&t.stateNode!=null)R2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ce(166));if(n=ii(Pa.current),ii(Xr.current),gl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Vr]=t,(i=r.nodeValue!==n)&&(e=Jn,e!==null))switch(e.tag){case 3:ml(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ml(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vr]=t,t.stateNode=r}return dn(t),null;case 13:if(vt(_t),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&Qn!==null&&t.mode&1&&!(t.flags&128))qg(),co(),t.flags|=98560,i=!1;else if(i=gl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ce(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[Vr]=t}else co(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dn(t),i=!1}else Nr!==null&&(ff(Nr),Nr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?Yt===0&&(Yt=3):Sh())),t.updateQueue!==null&&(t.flags|=4),dn(t),null);case 4:return fo(),rf(e,t),e===null&&_a(t.stateNode.containerInfo),dn(t),null;case 10:return sh(t.type._context),dn(t),null;case 17:return In(t.type)&&tc(),dn(t),null;case 19:if(vt(_t),i=t.memoizedState,i===null)return dn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Ko(i,!1);else{if(Yt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=lc(e),a!==null){for(t.flags|=128,Ko(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ht(_t,_t.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ot()>po&&(t.flags|=128,r=!0,Ko(i,!1),t.lanes=4194304)}else{if(!r)if(e=lc(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ko(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!kt)return dn(t),null}else 2*Ot()-i.renderingStartTime>po&&n!==1073741824&&(t.flags|=128,r=!0,Ko(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ot(),t.sibling=null,n=_t.current,ht(_t,r?n&1|2:n&1),t):(dn(t),null);case 22:case 23:return xh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Kn&1073741824&&(dn(t),t.subtreeFlags&6&&(t.flags|=8192)):dn(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function Rw(e,t){switch(eh(t),t.tag){case 1:return In(t.type)&&tc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fo(),vt(Tn),vt(mn),ch(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lh(t),null;case 13:if(vt(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));co()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vt(_t),null;case 4:return fo(),null;case 10:return sh(t.type._context),null;case 22:case 23:return xh(),null;case 24:return null;default:return null}}var wl=!1,pn=!1,Lw=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function Gi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Rt(e,t,r)}else n.current=null}function sf(e,t,n){try{n()}catch(r){Rt(e,t,r)}}var r1=!1;function Bw(e,t){if(zd=Jl,e=$g(),qf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,c=-1,d=-1,h=0,g=0,v=e,w=null;t:for(;;){for(var N;v!==n||s!==0&&v.nodeType!==3||(c=a+s),v!==i||r!==0&&v.nodeType!==3||(d=a+r),v.nodeType===3&&(a+=v.nodeValue.length),(N=v.firstChild)!==null;)w=v,v=N;for(;;){if(v===e)break t;if(w===n&&++h===s&&(c=a),w===i&&++g===r&&(d=a),(N=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=N}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ud={focusedElem:e,selectionRange:n},Jl=!1,Ae=t;Ae!==null;)if(t=Ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ae=e;else for(;Ae!==null;){t=Ae;try{var D=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(D!==null){var T=D.memoizedProps,V=D.memoizedState,j=t.stateNode,y=j.getSnapshotBeforeUpdate(t.elementType===t.type?T:jr(t.type,T),V);j.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(M){Rt(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,Ae=e;break}Ae=t.return}return D=r1,r1=!1,D}function fa(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&sf(t,n,i)}s=s.next}while(s!==r)}}function Oc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function of(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function L2(e){var t=e.alternate;t!==null&&(e.alternate=null,L2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vr],delete t[ba],delete t[Gd],delete t[vw],delete t[ww])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function B2(e){return e.tag===5||e.tag===3||e.tag===4}function s1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||B2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function af(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ec));else if(r!==4&&(e=e.child,e!==null))for(af(e,t,n),e=e.sibling;e!==null;)af(e,t,n),e=e.sibling}function lf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(lf(e,t,n),e=e.sibling;e!==null;)lf(e,t,n),e=e.sibling}var sn=null,_r=!1;function xs(e,t,n){for(n=n.child;n!==null;)F2(e,t,n),n=n.sibling}function F2(e,t,n){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(Mc,n)}catch{}switch(n.tag){case 5:pn||Gi(n,t);case 6:var r=sn,s=_r;sn=null,xs(e,t,n),sn=r,_r=s,sn!==null&&(_r?(e=sn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):sn.removeChild(n.stateNode));break;case 18:sn!==null&&(_r?(e=sn,n=n.stateNode,e.nodeType===8?Hu(e.parentNode,n):e.nodeType===1&&Hu(e,n),Ea(e)):Hu(sn,n.stateNode));break;case 4:r=sn,s=_r,sn=n.stateNode.containerInfo,_r=!0,xs(e,t,n),sn=r,_r=s;break;case 0:case 11:case 14:case 15:if(!pn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&sf(n,t,a),s=s.next}while(s!==r)}xs(e,t,n);break;case 1:if(!pn&&(Gi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Rt(n,t,c)}xs(e,t,n);break;case 21:xs(e,t,n);break;case 22:n.mode&1?(pn=(r=pn)||n.memoizedState!==null,xs(e,t,n),pn=r):xs(e,t,n);break;default:xs(e,t,n)}}function i1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Lw),t.forEach(function(r){var s=Gw.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Cr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,c=a;e:for(;c!==null;){switch(c.tag){case 5:sn=c.stateNode,_r=!1;break e;case 3:sn=c.stateNode.containerInfo,_r=!0;break e;case 4:sn=c.stateNode.containerInfo,_r=!0;break e}c=c.return}if(sn===null)throw Error(ce(160));F2(i,a,s),sn=null,_r=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){Rt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)O2(t,e),t=t.sibling}function O2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Cr(t,e),Or(e),r&4){try{fa(3,e,e.return),Oc(3,e)}catch(T){Rt(e,e.return,T)}try{fa(5,e,e.return)}catch(T){Rt(e,e.return,T)}}break;case 1:Cr(t,e),Or(e),r&512&&n!==null&&Gi(n,n.return);break;case 5:if(Cr(t,e),Or(e),r&512&&n!==null&&Gi(n,n.return),e.flags&32){var s=e.stateNode;try{xa(s,"")}catch(T){Rt(e,e.return,T)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,c=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&og(s,i),Pd(c,a);var h=Pd(c,i);for(a=0;a<d.length;a+=2){var g=d[a],v=d[a+1];g==="style"?dg(s,v):g==="dangerouslySetInnerHTML"?cg(s,v):g==="children"?xa(s,v):$f(s,g,v,h)}switch(c){case"input":jd(s,i);break;case"textarea":ag(s,i);break;case"select":var w=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var N=i.value;N!=null?Ki(s,!!i.multiple,N,!1):w!==!!i.multiple&&(i.defaultValue!=null?Ki(s,!!i.multiple,i.defaultValue,!0):Ki(s,!!i.multiple,i.multiple?[]:"",!1))}s[ba]=i}catch(T){Rt(e,e.return,T)}}break;case 6:if(Cr(t,e),Or(e),r&4){if(e.stateNode===null)throw Error(ce(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(T){Rt(e,e.return,T)}}break;case 3:if(Cr(t,e),Or(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ea(t.containerInfo)}catch(T){Rt(e,e.return,T)}break;case 4:Cr(t,e),Or(e);break;case 13:Cr(t,e),Or(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(vh=Ot())),r&4&&i1(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(pn=(h=pn)||g,Cr(t,e),pn=h):Cr(t,e),Or(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!g&&e.mode&1)for(Ae=e,g=e.child;g!==null;){for(v=Ae=g;Ae!==null;){switch(w=Ae,N=w.child,w.tag){case 0:case 11:case 14:case 15:fa(4,w,w.return);break;case 1:Gi(w,w.return);var D=w.stateNode;if(typeof D.componentWillUnmount=="function"){r=w,n=w.return;try{t=r,D.props=t.memoizedProps,D.state=t.memoizedState,D.componentWillUnmount()}catch(T){Rt(r,n,T)}}break;case 5:Gi(w,w.return);break;case 22:if(w.memoizedState!==null){a1(v);continue}}N!==null?(N.return=w,Ae=N):a1(v)}g=g.sibling}e:for(g=null,v=e;;){if(v.tag===5){if(g===null){g=v;try{s=v.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=v.stateNode,d=v.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=ug("display",a))}catch(T){Rt(e,e.return,T)}}}else if(v.tag===6){if(g===null)try{v.stateNode.nodeValue=h?"":v.memoizedProps}catch(T){Rt(e,e.return,T)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;g===v&&(g=null),v=v.return}g===v&&(g=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Cr(t,e),Or(e),r&4&&i1(e);break;case 21:break;default:Cr(t,e),Or(e)}}function Or(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(B2(n)){var r=n;break e}n=n.return}throw Error(ce(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(xa(s,""),r.flags&=-33);var i=s1(e);lf(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=s1(e);af(e,c,a);break;default:throw Error(ce(161))}}catch(d){Rt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Fw(e,t,n){Ae=e,$2(e)}function $2(e,t,n){for(var r=(e.mode&1)!==0;Ae!==null;){var s=Ae,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||wl;if(!a){var c=s.alternate,d=c!==null&&c.memoizedState!==null||pn;c=wl;var h=pn;if(wl=a,(pn=d)&&!h)for(Ae=s;Ae!==null;)a=Ae,d=a.child,a.tag===22&&a.memoizedState!==null?l1(s):d!==null?(d.return=a,Ae=d):l1(s);for(;i!==null;)Ae=i,$2(i),i=i.sibling;Ae=s,wl=c,pn=h}o1(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ae=i):o1(e)}}function o1(e){for(;Ae!==null;){var t=Ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pn||Oc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:jr(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Wm(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Wm(t,a,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var g=h.memoizedState;if(g!==null){var v=g.dehydrated;v!==null&&Ea(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}pn||t.flags&512&&of(t)}catch(w){Rt(t,t.return,w)}}if(t===e){Ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ae=n;break}Ae=t.return}}function a1(e){for(;Ae!==null;){var t=Ae;if(t===e){Ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ae=n;break}Ae=t.return}}function l1(e){for(;Ae!==null;){var t=Ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Oc(4,t)}catch(d){Rt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){Rt(t,s,d)}}var i=t.return;try{of(t)}catch(d){Rt(t,i,d)}break;case 5:var a=t.return;try{of(t)}catch(d){Rt(t,a,d)}}}catch(d){Rt(t,t.return,d)}if(t===e){Ae=null;break}var c=t.sibling;if(c!==null){c.return=t.return,Ae=c;break}Ae=t.return}}var Ow=Math.ceil,dc=ms.ReactCurrentDispatcher,gh=ms.ReactCurrentOwner,mr=ms.ReactCurrentBatchConfig,et=0,en=null,zt=null,on=0,Kn=0,Vi=Vs(0),Yt=0,La=null,pi=0,$c=0,yh=0,ha=null,Mn=null,vh=0,po=1/0,qr=null,fc=!1,cf=null,Bs=null,xl=!1,Ms=null,hc=0,pa=0,uf=null,Fl=-1,Ol=0;function vn(){return et&6?Ot():Fl!==-1?Fl:Fl=Ot()}function Fs(e){return e.mode&1?et&2&&on!==0?on&-on:Sw.transition!==null?(Ol===0&&(Ol=Ag()),Ol):(e=at,e!==0||(e=window.event,e=e===void 0?16:Mg(e.type)),e):1}function Pr(e,t,n,r){if(50<pa)throw pa=0,uf=null,Error(ce(185));za(e,n,r),(!(et&2)||e!==en)&&(e===en&&(!(et&2)&&($c|=n),Yt===4&&js(e,on)),Rn(e,r),n===1&&et===0&&!(t.mode&1)&&(po=Ot()+500,Lc&&Ys()))}function Rn(e,t){var n=e.callbackNode;S4(e,t);var r=Ql(e,e===en?on:0);if(r===0)n!==null&&ym(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&ym(n),t===1)e.tag===0?xw(c1.bind(null,e)):Kg(c1.bind(null,e)),gw(function(){!(et&6)&&Ys()}),n=null;else{switch(Eg(r)){case 1:n=Wf;break;case 4:n=Sg;break;case 16:n=Kl;break;case 536870912:n=kg;break;default:n=Kl}n=Y2(n,D2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function D2(e,t){if(Fl=-1,Ol=0,et&6)throw Error(ce(327));var n=e.callbackNode;if(eo()&&e.callbackNode!==n)return null;var r=Ql(e,e===en?on:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=pc(e,r);else{t=r;var s=et;et|=2;var i=U2();(en!==e||on!==t)&&(qr=null,po=Ot()+500,li(e,t));do try{zw();break}catch(c){z2(e,c)}while(!0);rh(),dc.current=i,et=s,zt!==null?t=0:(en=null,on=0,t=Yt)}if(t!==0){if(t===2&&(s=Bd(e),s!==0&&(r=s,t=df(e,s))),t===1)throw n=La,li(e,0),js(e,r),Rn(e,Ot()),n;if(t===6)js(e,r);else{if(s=e.current.alternate,!(r&30)&&!$w(s)&&(t=pc(e,r),t===2&&(i=Bd(e),i!==0&&(r=i,t=df(e,i))),t===1))throw n=La,li(e,0),js(e,r),Rn(e,Ot()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(ce(345));case 2:ni(e,Mn,qr);break;case 3:if(js(e,r),(r&130023424)===r&&(t=vh+500-Ot(),10<t)){if(Ql(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){vn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Wd(ni.bind(null,e,Mn,qr),t);break}ni(e,Mn,qr);break;case 4:if(js(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Mr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=Ot()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ow(r/1960))-r,10<r){e.timeoutHandle=Wd(ni.bind(null,e,Mn,qr),r);break}ni(e,Mn,qr);break;case 5:ni(e,Mn,qr);break;default:throw Error(ce(329))}}}return Rn(e,Ot()),e.callbackNode===n?D2.bind(null,e):null}function df(e,t){var n=ha;return e.current.memoizedState.isDehydrated&&(li(e,t).flags|=256),e=pc(e,t),e!==2&&(t=Mn,Mn=n,t!==null&&ff(t)),e}function ff(e){Mn===null?Mn=e:Mn.push.apply(Mn,e)}function $w(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Tr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function js(e,t){for(t&=~yh,t&=~$c,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Mr(t),r=1<<n;e[n]=-1,t&=~r}}function c1(e){if(et&6)throw Error(ce(327));eo();var t=Ql(e,0);if(!(t&1))return Rn(e,Ot()),null;var n=pc(e,t);if(e.tag!==0&&n===2){var r=Bd(e);r!==0&&(t=r,n=df(e,r))}if(n===1)throw n=La,li(e,0),js(e,t),Rn(e,Ot()),n;if(n===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ni(e,Mn,qr),Rn(e,Ot()),null}function wh(e,t){var n=et;et|=1;try{return e(t)}finally{et=n,et===0&&(po=Ot()+500,Lc&&Ys())}}function mi(e){Ms!==null&&Ms.tag===0&&!(et&6)&&eo();var t=et;et|=1;var n=mr.transition,r=at;try{if(mr.transition=null,at=1,e)return e()}finally{at=r,mr.transition=n,et=t,!(et&6)&&Ys()}}function xh(){Kn=Vi.current,vt(Vi)}function li(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,mw(n)),zt!==null)for(n=zt.return;n!==null;){var r=n;switch(eh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tc();break;case 3:fo(),vt(Tn),vt(mn),ch();break;case 5:lh(r);break;case 4:fo();break;case 13:vt(_t);break;case 19:vt(_t);break;case 10:sh(r.type._context);break;case 22:case 23:xh()}n=n.return}if(en=e,zt=e=Os(e.current,null),on=Kn=t,Yt=0,La=null,yh=$c=pi=0,Mn=ha=null,si!==null){for(t=0;t<si.length;t++)if(n=si[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}si=null}return e}function z2(e,t){do{var n=zt;try{if(rh(),Rl.current=uc,cc){for(var r=Nt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cc=!1}if(hi=0,Zt=Gt=Nt=null,da=!1,Ta=0,gh.current=null,n===null||n.return===null){Yt=1,La=t,zt=null;break}e:{var i=e,a=n.return,c=n,d=t;if(t=on,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,g=c,v=g.tag;if(!(g.mode&1)&&(v===0||v===11||v===15)){var w=g.alternate;w?(g.updateQueue=w.updateQueue,g.memoizedState=w.memoizedState,g.lanes=w.lanes):(g.updateQueue=null,g.memoizedState=null)}var N=Qm(a);if(N!==null){N.flags&=-257,Jm(N,a,c,i,t),N.mode&1&&Km(i,h,t),t=N,d=h;var D=t.updateQueue;if(D===null){var T=new Set;T.add(d),t.updateQueue=T}else D.add(d);break e}else{if(!(t&1)){Km(i,h,t),Sh();break e}d=Error(ce(426))}}else if(kt&&c.mode&1){var V=Qm(a);if(V!==null){!(V.flags&65536)&&(V.flags|=256),Jm(V,a,c,i,t),th(ho(d,c));break e}}i=d=ho(d,c),Yt!==4&&(Yt=2),ha===null?ha=[i]:ha.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var j=E2(i,d,t);Hm(i,j);break e;case 1:c=d;var y=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Bs===null||!Bs.has(k)))){i.flags|=65536,t&=-t,i.lanes|=t;var M=C2(i,c,t);Hm(i,M);break e}}i=i.return}while(i!==null)}W2(n)}catch(b){t=b,zt===n&&n!==null&&(zt=n=n.return);continue}break}while(!0)}function U2(){var e=dc.current;return dc.current=uc,e===null?uc:e}function Sh(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),en===null||!(pi&268435455)&&!($c&268435455)||js(en,on)}function pc(e,t){var n=et;et|=2;var r=U2();(en!==e||on!==t)&&(qr=null,li(e,t));do try{Dw();break}catch(s){z2(e,s)}while(!0);if(rh(),et=n,dc.current=r,zt!==null)throw Error(ce(261));return en=null,on=0,Yt}function Dw(){for(;zt!==null;)H2(zt)}function zw(){for(;zt!==null&&!f4();)H2(zt)}function H2(e){var t=V2(e.alternate,e,Kn);e.memoizedProps=e.pendingProps,t===null?W2(e):zt=t,gh.current=null}function W2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Rw(n,t),n!==null){n.flags&=32767,zt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Yt=6,zt=null;return}}else if(n=Iw(n,t,Kn),n!==null){zt=n;return}if(t=t.sibling,t!==null){zt=t;return}zt=t=e}while(t!==null);Yt===0&&(Yt=5)}function ni(e,t,n){var r=at,s=mr.transition;try{mr.transition=null,at=1,Uw(e,t,n,r)}finally{mr.transition=s,at=r}return null}function Uw(e,t,n,r){do eo();while(Ms!==null);if(et&6)throw Error(ce(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(k4(e,i),e===en&&(zt=en=null,on=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xl||(xl=!0,Y2(Kl,function(){return eo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=mr.transition,mr.transition=null;var a=at;at=1;var c=et;et|=4,gh.current=null,Bw(e,n),O2(n,e),lw(Ud),Jl=!!zd,Ud=zd=null,e.current=n,Fw(n),h4(),et=c,at=a,mr.transition=i}else e.current=n;if(xl&&(xl=!1,Ms=e,hc=s),i=e.pendingLanes,i===0&&(Bs=null),g4(n.stateNode),Rn(e,Ot()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(fc)throw fc=!1,e=cf,cf=null,e;return hc&1&&e.tag!==0&&eo(),i=e.pendingLanes,i&1?e===uf?pa++:(pa=0,uf=e):pa=0,Ys(),null}function eo(){if(Ms!==null){var e=Eg(hc),t=mr.transition,n=at;try{if(mr.transition=null,at=16>e?16:e,Ms===null)var r=!1;else{if(e=Ms,Ms=null,hc=0,et&6)throw Error(ce(331));var s=et;for(et|=4,Ae=e.current;Ae!==null;){var i=Ae,a=i.child;if(Ae.flags&16){var c=i.deletions;if(c!==null){for(var d=0;d<c.length;d++){var h=c[d];for(Ae=h;Ae!==null;){var g=Ae;switch(g.tag){case 0:case 11:case 15:fa(8,g,i)}var v=g.child;if(v!==null)v.return=g,Ae=v;else for(;Ae!==null;){g=Ae;var w=g.sibling,N=g.return;if(L2(g),g===h){Ae=null;break}if(w!==null){w.return=N,Ae=w;break}Ae=N}}}var D=i.alternate;if(D!==null){var T=D.child;if(T!==null){D.child=null;do{var V=T.sibling;T.sibling=null,T=V}while(T!==null)}}Ae=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Ae=a;else e:for(;Ae!==null;){if(i=Ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:fa(9,i,i.return)}var j=i.sibling;if(j!==null){j.return=i.return,Ae=j;break e}Ae=i.return}}var y=e.current;for(Ae=y;Ae!==null;){a=Ae;var k=a.child;if(a.subtreeFlags&2064&&k!==null)k.return=a,Ae=k;else e:for(a=y;Ae!==null;){if(c=Ae,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Oc(9,c)}}catch(b){Rt(c,c.return,b)}if(c===a){Ae=null;break e}var M=c.sibling;if(M!==null){M.return=c.return,Ae=M;break e}Ae=c.return}}if(et=s,Ys(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(Mc,e)}catch{}r=!0}return r}finally{at=n,mr.transition=t}}return!1}function u1(e,t,n){t=ho(n,t),t=E2(e,t,1),e=Ls(e,t,1),t=vn(),e!==null&&(za(e,1,t),Rn(e,t))}function Rt(e,t,n){if(e.tag===3)u1(e,e,n);else for(;t!==null;){if(t.tag===3){u1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Bs===null||!Bs.has(r))){e=ho(n,e),e=C2(t,e,1),t=Ls(t,e,1),e=vn(),t!==null&&(za(t,1,e),Rn(t,e));break}}t=t.return}}function Hw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=vn(),e.pingedLanes|=e.suspendedLanes&n,en===e&&(on&n)===n&&(Yt===4||Yt===3&&(on&130023424)===on&&500>Ot()-vh?li(e,0):yh|=n),Rn(e,t)}function G2(e,t){t===0&&(e.mode&1?(t=ul,ul<<=1,!(ul&130023424)&&(ul=4194304)):t=1);var n=vn();e=ds(e,t),e!==null&&(za(e,t,n),Rn(e,n))}function Ww(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),G2(e,n)}function Gw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ce(314))}r!==null&&r.delete(t),G2(e,n)}var V2;V2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Tn.current)Pn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Pn=!1,Tw(e,t,n);Pn=!!(e.flags&131072)}else Pn=!1,kt&&t.flags&1048576&&Qg(t,sc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Bl(e,t),e=t.pendingProps;var s=lo(t,mn.current);Zi(t,n),s=dh(null,t,r,e,s,n);var i=fh();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,In(r)?(i=!0,nc(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,oh(t),s.updater=Fc,t.stateNode=s,s._reactInternals=t,Jd(t,r,e,n),t=ef(null,t,r,!0,i,n)):(t.tag=0,kt&&i&&Zf(t),yn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Bl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Yw(r),e=jr(r,e),s){case 0:t=Zd(null,t,r,e,n);break e;case 1:t=e1(null,t,r,e,n);break e;case 11:t=qm(null,t,r,e,n);break e;case 14:t=Zm(null,t,r,jr(r.type,e),n);break e}throw Error(ce(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),Zd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),e1(e,t,r,s,n);case 3:e:{if(b2(t),e===null)throw Error(ce(387));r=t.pendingProps,i=t.memoizedState,s=i.element,n2(e,t),ac(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=ho(Error(ce(423)),t),t=t1(e,t,r,n,s);break e}else if(r!==s){s=ho(Error(ce(424)),t),t=t1(e,t,r,n,s);break e}else for(Qn=Rs(t.stateNode.containerInfo.firstChild),Jn=t,kt=!0,Nr=null,n=e2(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(co(),r===s){t=fs(e,t,n);break e}yn(e,t,r,n)}t=t.child}return t;case 5:return r2(t),e===null&&Xd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Hd(r,s)?a=null:i!==null&&Hd(r,i)&&(t.flags|=32),N2(e,t),yn(e,t,a,n),t.child;case 6:return e===null&&Xd(t),null;case 13:return M2(e,t,n);case 4:return ah(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=uo(t,null,r,n):yn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),qm(e,t,r,s,n);case 7:return yn(e,t,t.pendingProps,n),t.child;case 8:return yn(e,t,t.pendingProps.children,n),t.child;case 12:return yn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,ht(ic,r._currentValue),r._currentValue=a,i!==null)if(Tr(i.value,a)){if(i.children===s.children&&!Tn.current){t=fs(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var d=c.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=is(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var g=h.pending;g===null?d.next=d:(d.next=g.next,g.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),Kd(i.return,n,t),c.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ce(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Kd(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}yn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Zi(t,n),s=gr(s),r=r(s),t.flags|=1,yn(e,t,r,n),t.child;case 14:return r=t.type,s=jr(r,t.pendingProps),s=jr(r.type,s),Zm(e,t,r,s,n);case 15:return j2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),Bl(e,t),t.tag=1,In(r)?(e=!0,nc(t)):e=!1,Zi(t,n),A2(t,r,s),Jd(t,r,s,n),ef(null,t,r,!0,e,n);case 19:return P2(e,t,n);case 22:return _2(e,t,n)}throw Error(ce(156,t.tag))};function Y2(e,t){return xg(e,t)}function Vw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(e,t,n,r){return new Vw(e,t,n,r)}function kh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Yw(e){if(typeof e=="function")return kh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zf)return 11;if(e===Uf)return 14}return 2}function Os(e,t){var n=e.alternate;return n===null?(n=hr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function $l(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")kh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Bi:return ci(n.children,s,i,t);case Df:a=8,s|=8;break;case Sd:return e=hr(12,n,t,s|2),e.elementType=Sd,e.lanes=i,e;case kd:return e=hr(13,n,t,s),e.elementType=kd,e.lanes=i,e;case Ad:return e=hr(19,n,t,s),e.elementType=Ad,e.lanes=i,e;case rg:return Dc(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case tg:a=10;break e;case ng:a=9;break e;case zf:a=11;break e;case Uf:a=14;break e;case ks:a=16,r=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=hr(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ci(e,t,n,r){return e=hr(7,e,r,t),e.lanes=n,e}function Dc(e,t,n,r){return e=hr(22,e,r,t),e.elementType=rg,e.lanes=n,e.stateNode={isHidden:!1},e}function Ju(e,t,n){return e=hr(6,e,null,t),e.lanes=n,e}function qu(e,t,n){return t=hr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Xw(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tu(0),this.expirationTimes=Tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ah(e,t,n,r,s,i,a,c,d){return e=new Xw(e,t,n,c,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=hr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},oh(i),e}function Kw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function X2(e){if(!e)return Us;e=e._reactInternals;e:{if(wi(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(In(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var n=e.type;if(In(n))return Xg(e,n,t)}return t}function K2(e,t,n,r,s,i,a,c,d){return e=Ah(n,r,!0,e,s,i,a,c,d),e.context=X2(null),n=e.current,r=vn(),s=Fs(n),i=is(r,s),i.callback=t??null,Ls(n,i,s),e.current.lanes=s,za(e,s,r),Rn(e,r),e}function zc(e,t,n,r){var s=t.current,i=vn(),a=Fs(s);return n=X2(n),t.context===null?t.context=n:t.pendingContext=n,t=is(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ls(s,t,a),e!==null&&(Pr(e,s,a,i),Il(e,s,a)),a}function mc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function d1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Eh(e,t){d1(e,t),(e=e.alternate)&&d1(e,t)}function Qw(){return null}var Q2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ch(e){this._internalRoot=e}Uc.prototype.render=Ch.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));zc(e,t,null,null)};Uc.prototype.unmount=Ch.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;mi(function(){zc(null,e,null,null)}),t[us]=null}};function Uc(e){this._internalRoot=e}Uc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_g();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Cs.length&&t!==0&&t<Cs[n].priority;n++);Cs.splice(n,0,e),n===0&&bg(e)}};function jh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Hc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function f1(){}function Jw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=mc(a);i.call(h)}}var a=K2(t,r,e,0,null,!1,!1,"",f1);return e._reactRootContainer=a,e[us]=a.current,_a(e.nodeType===8?e.parentNode:e),mi(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var h=mc(d);c.call(h)}}var d=Ah(e,0,!1,null,null,!1,!1,"",f1);return e._reactRootContainer=d,e[us]=d.current,_a(e.nodeType===8?e.parentNode:e),mi(function(){zc(t,d,n,r)}),d}function Wc(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var d=mc(a);c.call(d)}}zc(t,a,e,s)}else a=Jw(n,t,e,s,r);return mc(a)}Cg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=na(t.pendingLanes);n!==0&&(Gf(t,n|1),Rn(t,Ot()),!(et&6)&&(po=Ot()+500,Ys()))}break;case 13:mi(function(){var r=ds(e,1);if(r!==null){var s=vn();Pr(r,e,1,s)}}),Eh(e,1)}};Vf=function(e){if(e.tag===13){var t=ds(e,134217728);if(t!==null){var n=vn();Pr(t,e,134217728,n)}Eh(e,134217728)}};jg=function(e){if(e.tag===13){var t=Fs(e),n=ds(e,t);if(n!==null){var r=vn();Pr(n,e,t,r)}Eh(e,t)}};_g=function(){return at};Ng=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Id=function(e,t,n){switch(t){case"input":if(jd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Rc(r);if(!s)throw Error(ce(90));ig(r),jd(r,s)}}}break;case"textarea":ag(e,n);break;case"select":t=n.value,t!=null&&Ki(e,!!n.multiple,t,!1)}};pg=wh;mg=mi;var qw={usingClientEntryPoint:!1,Events:[Ha,Di,Rc,fg,hg,wh]},Qo={findFiberByHostInstance:ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Zw={bundleType:Qo.bundleType,version:Qo.version,rendererPackageName:Qo.rendererPackageName,rendererConfig:Qo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vg(e),e===null?null:e.stateNode},findFiberByHostInstance:Qo.findFiberByHostInstance||Qw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sl.isDisabled&&Sl.supportsFiber)try{Mc=Sl.inject(Zw),Yr=Sl}catch{}}er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qw;er.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jh(t))throw Error(ce(200));return Kw(e,t,null,n)};er.createRoot=function(e,t){if(!jh(e))throw Error(ce(299));var n=!1,r="",s=Q2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ah(e,1,!1,null,null,n,!1,r,s),e[us]=t.current,_a(e.nodeType===8?e.parentNode:e),new Ch(t)};er.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=vg(t),e=e===null?null:e.stateNode,e};er.flushSync=function(e){return mi(e)};er.hydrate=function(e,t,n){if(!Hc(t))throw Error(ce(200));return Wc(null,e,t,!0,n)};er.hydrateRoot=function(e,t,n){if(!jh(e))throw Error(ce(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Q2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=K2(t,null,e,1,n??null,s,!1,i,a),e[us]=t.current,_a(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Uc(t)};er.render=function(e,t,n){if(!Hc(t))throw Error(ce(200));return Wc(null,e,t,!1,n)};er.unmountComponentAtNode=function(e){if(!Hc(e))throw Error(ce(40));return e._reactRootContainer?(mi(function(){Wc(null,null,e,!1,function(){e._reactRootContainer=null,e[us]=null})}),!0):!1};er.unstable_batchedUpdates=wh;er.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Hc(n))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return Wc(e,t,n,!1,r)};er.version="18.3.1-next-f1338f8080-20240426";function J2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(J2)}catch(e){console.error(e)}}J2(),J0.exports=er;var ex=J0.exports,h1=ex;wd.createRoot=h1.createRoot,wd.hydrateRoot=h1.hydrateRoot;const to={},q2="production",p1={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-server.onrender.com/api",healthUrl:"https://cfg-server.onrender.com/health"}},Z2=p1[q2]||p1.development,Ga=()=>{if(!(to!=null&&to.VITE_API_BASE_URL))return Z2.baseUrl},tx=()=>{if(!(to!=null&&to.VITE_HEALTH_URL))return Z2.healthUrl},nx=async()=>{try{const e=await fetch(tx(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},rx=()=>q2;function sx({onStart:e}){const[t,n]=S.useState("1"),[r,s]=S.useState("individual"),[i,a]=S.useState("15"),[c,d]=S.useState({status:"checking",version:"...",commit:"...",healthy:!1});S.useEffect(()=>{const w=async()=>{const D=await nx();d(D),console.log("[StartDialog] Server health:",D)};w();const N=setInterval(w,3e4);return()=>clearInterval(N)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const w={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(w)},g=()=>{window.close()},v=()=>c.status==="checking"?"checking":c.healthy?"healthy":"unhealthy";return l.jsx("div",{className:"dialog-overlay",children:l.jsxs("div",{className:"dialog-box",children:[l.jsxs("div",{className:"dialog-header",children:[l.jsx("h2",{children:"The Creative Game"}),l.jsxs("div",{className:`server-health-indicator ${v()}`,title:`Server: ${c.status}
Version: ${c.version}
Commit: ${c.commit}
Environment: ${rx()}`,children:[l.jsx("span",{className:"health-light"}),l.jsx("span",{className:"health-text",children:"Server"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"ID:"}),l.jsx("input",{type:"text",value:t,onChange:w=>n(w.target.value)})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Condition:"}),l.jsxs("select",{value:r,onChange:w=>s(w.target.value),children:[l.jsx("option",{value:"individual",children:"individual"}),l.jsx("option",{value:"group",children:"group"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Time (in minutes):"}),l.jsx("input",{type:"number",value:i,onChange:w=>a(w.target.value),min:"1"})]}),l.jsxs("div",{className:"dialog-buttons",children:[l.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),l.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),l.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),l.jsx("button",{className:"dialog-button cancel",onClick:g,children:"Cancel"})]})]})})}class m1{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const ix=.035;class ox{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=Ga(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),c=s-i;let d=0,h=0,g=0;n>=0&&n<60?(d=i,h=a,g=0):n<120?(d=a,h=i,g=0):n<180?(d=0,h=i,g=a):n<240?(d=0,h=a,g=i):n<300?(d=a,h=0,g=i):(d=i,h=0,g=a);const v=w=>{const N=Math.round((w+c)*255).toString(16);return N.length===1?"0"+N:N};return`#${v(d)}${v(h)}${v(g)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const c=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${c}

Please choose a different Session ID.`),this.stop(),new Error(c)):new Error(c)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/ix,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),c=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(w=>this.relativeToGrid(w)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:c,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:c,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(w=>this.relativeToGrid(w)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(w=>this.relativeToGrid(w)):null)),this.moves.push(h),this.persistMove(h).catch(w=>{console.error("[GameTracker] Failed to persist move to server:",w)});const g=this.getCurrentBraceletStatus(),v=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:c,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:g,lastKnownPlayer:v,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(w=>({status:w.status,elapsed:w.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(c=>c.timestamp>=s&&c.timestamp<=i);if(a.length>0){const c={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(c[h.status]=(c[h.status]||0)+1)});const d=Object.keys(c).reduce((h,g)=>c[h]>c[g]?h:g,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let Zu=null;const g1=()=>(Zu||(Zu=new ox),Zu),br=.07,ma=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),jt=e=>Math.round(e*1e3)/1e3,ax=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[jt(i.position[0]-br),jt(i.position[1])],[jt(i.position[0]+br),jt(i.position[1])],[jt(i.position[0]),jt(i.position[1]-br)],[jt(i.position[0]),jt(i.position[1]+br)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},lx=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},hf=e=>e.map(t=>{const n=[],r=[[jt(t.position[0]-br),jt(t.position[1])],[jt(t.position[0]+br),jt(t.position[1])],[jt(t.position[0]),jt(t.position[1]-br)],[jt(t.position[0]),jt(t.position[1]+br)]];return e.forEach(s=>{r.forEach(i=>{jt(s.position[0])===i[0]&&jt(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),cx=e=>{const t=new Set;if(e.forEach((a,c)=>{a.forEach((d,h)=>{d&&t.add(`${c},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,c]=i.shift(),d=`${a},${c}`;s.has(d)||(s.add(d),n.forEach(([h,g])=>{const v=`${a+h},${c+g}`;t.has(v)&&!s.has(v)&&i.push([a+h,c+g])}))}return s.size===t.size},ux=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=br)n.push(jt(i));const r=[];for(let i=-.7;i<0;i+=br)r.push(jt(i));for(let i=0;i<=.77;i+=br)r.push(jt(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const c=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);c!==-1&&d!==-1&&(s[d][c]=!0)}}),cx(s)},pf=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=ux(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},y1=e=>{if(e.length===0)return null;try{const t=e.map(g=>g[0]),n=e.map(g=>g[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(g=>{const v=Math.sqrt(Math.pow(g[0]-r,2)+Math.pow(g[1]-s,2));v<i&&(i=v,a=g)});const c=-a[0],d=-a[1],h=e.map(g=>[jt(g[0]+c),jt(g[1]+d)]);return h.sort((g,v)=>g[0]-v[0]||g[1]-v[1]),h}catch{return null}},dx=60,v1=.07,ed=120;function fx({config:e,interfaceHidden:t=!1}){const[n,r]=S.useState(ma()),[s,i]=S.useState(null),[a,c]=S.useState({x:0,y:0}),[d,h]=S.useState(!0),[g,v]=S.useState(e.timeSeconds),[w,N]=S.useState(0),[D,T]=S.useState(null),[V,j]=S.useState(!0),[y,k]=S.useState(""),[M,b]=S.useState(!1),[H,L]=S.useState({blockSize:dx,bottomPadding:ed}),F=S.useRef(null),z=S.useRef(new m1(e)),W=S.useRef(g1()),Y=S.useRef(null),q=S.useRef(Date.now()),J=S.useRef(ed),re=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,fe=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,he="The experiment is done. Thank you very much for your participation!",Se=S.useCallback(()=>{const U=F.current;if(!U)return;const G=U.offsetWidth,Q=U.offsetHeight;if(!G||!Q)return;const ee=J.current||ed;let O=Math.max(1,Math.min(G,Q-ee)),m=Math.max(38,Math.min(O*v1*.95,O/4)),P=Math.max(m*2.5,110);O=Math.max(1,Math.min(G,Q-P)),m=Math.max(38,Math.min(O*v1*.95,O/4)),P=Math.max(m*2.5,110),J.current=P,L(_=>{const C=Math.abs(_.blockSize-m),I=Math.abs(_.bottomPadding-P);return C<.5&&I<.5?_:{blockSize:m,bottomPadding:P}})},[]);S.useEffect(()=>(k(re),(async()=>{try{W.current.start(),await W.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(G){console.error("[GameCanvas] Failed to initialize tracker:",G),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{j(!0),k(he),b(!0),W.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,W.current.stop()}),[]),S.useEffect(()=>{Se()},[Se,t]),S.useEffect(()=>{const U=()=>{Se()};return U(),window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[Se]),S.useEffect(()=>{if(!d&&g>0){const U=setInterval(()=>{v(G=>G<=1?(clearInterval(U),j(!0),k(he),b(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):G-1)},1e3);return()=>clearInterval(U)}},[d,g]),S.useEffect(()=>{r(U=>pf(hf(U),d))},[d]);const se=()=>(Date.now()-q.current)/1e3,ne=(U,G)=>{const Q=F.current;if(!Q)return 0;const ee=Q.offsetHeight-J.current,O=Math.min(Q.offsetWidth,ee),m=G==="x"?(Q.offsetWidth-O)/2:(Q.offsetHeight-J.current-O)/2;return(U-m)/O-.5},Z=(U,G)=>{const Q=F.current;if(!Q)return 0;const ee=Q.offsetHeight-J.current,O=Math.min(Q.offsetWidth,ee),m=G==="x"?(Q.offsetWidth-O)/2:(Q.offsetHeight-J.current-O)/2;return(U+.5)*O+m},pe=U=>{var O,m,P,_;const G=F.current.getBoundingClientRect(),Q=U.clientX!==void 0?U.clientX:(m=(O=U.touches)==null?void 0:O[0])==null?void 0:m.clientX,ee=U.clientY!==void 0?U.clientY:(_=(P=U.touches)==null?void 0:P[0])==null?void 0:_.clientY;return{x:Q-G.left,y:ee-G.top}},ke=(U,G)=>{const Q=n.find(P=>P.id===G);if(!Q||!Q.canMove)return;U.preventDefault();const ee=pe(U),O=Z(Q.position[0],"x"),m=Z(Q.position[1],"y");Y.current=Date.now(),i(G),c({x:ee.x-O,y:ee.y-m})},ze=U=>{if(s===null)return;U.preventDefault();const G=pe(U),Q=ne(G.x-a.x,"x"),ee=ne(G.y-a.y,"y");r(O=>O.map(m=>m.id===s?{...m,position:[Q,ee]}:m))},Ue=()=>{try{const U=window.braceletDetectorVideo;if(!U||!U.videoWidth||U.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const G=document.createElement("canvas"),Q=640,ee=480;let O=U.videoWidth,m=U.videoHeight;const P=O/m;return O>Q&&(O=Q,m=O/P),m>ee&&(m=ee,O=m*P),G.width=Math.floor(O),G.height=Math.floor(m),G.getContext("2d").drawImage(U,0,0,G.width,G.height),G.toDataURL("image/jpeg",.6)}catch(U){return console.error("[GameCanvas] Error capturing camera frame:",U),null}},Te=()=>{if(s===null)return;const U=n.find(C=>C.id===s),G=ax(n,s),Q=lx(G,U.position),ee=Y.current?(Date.now()-Y.current)/1e3:0,O=n.map(C=>C.id===s?{...C,position:Q}:C),m=Ue(),P=window.currentBraceletStatus||"Unknown",_={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:se(),unit:s,end_position:Q,all_positions:O.map(C=>C.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:m,player:P};z.current.write(_),W.current.recordMove(_,ee,m),r(C=>{const I=C.map($=>$.id===s?{...$,position:Q}:$);return pf(hf(I),d)}),i(null),Y.current=null},Fe=()=>{const U=n.map(_=>_.position),G=y1(U),Q=w+1,ee=Ue(),O=window.currentBraceletStatus||"Unknown",m={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:se(),unit:null,end_position:null,all_positions:null,gallery_shape_number:Q,gallery:U,gallery_normalized:G,camera_frame:ee,player:O};z.current.write(m),W.current.recordMove(m,0,ee);const P=te();T(P),N(Q)},te=()=>{const U=document.createElement("canvas");U.width=400,U.height=400;const G=U.getContext("2d");G.fillStyle="#000",G.fillRect(0,0,400,400);const Q=n.map(O=>O.position),ee=y1(Q);return ee&&ee.forEach(O=>{const m=(O[0]+.5)*400,P=(O[1]+.5)*400;G.fillStyle="green",G.fillRect(m-15,P-15,30,30)}),U.toDataURL()},ue=S.useCallback(U=>{U.key==="p"&&d?(h(!1),j(!0),k(fe),q.current=Date.now(),r(ma()),T(null),N(0),z.current=new m1(e),W.current.stop(),W.current=g1(),W.current.start(),W.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):U.key==="q"&&!d&&(j(!0),k(he),b(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);S.useEffect(()=>(window.addEventListener("keydown",ue),()=>window.removeEventListener("keydown",ue)),[ue]);const we=()=>{if(M&&y===he){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&y===fe)try{const U=new(window.AudioContext||window.webkitAudioContext),G=U.createOscillator(),Q=U.createGain();G.connect(Q),Q.connect(U.destination),G.frequency.setValueAtTime(800,U.currentTime),G.frequency.setValueAtTime(600,U.currentTime+.15),Q.gain.setValueAtTime(.3,U.currentTime),Q.gain.exponentialRampToValueAtTime(.01,U.currentTime+.3),G.start(U.currentTime),G.stop(U.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(U){console.error("[GameCanvas] Error playing sound:",U)}j(!1)},de=U=>{U.preventDefault()};return l.jsxs("div",{className:"game-canvas",ref:F,style:{"--block-size":`${H.blockSize}px`,"--bottom-padding":`${H.bottomPadding}px`},onMouseMove:ze,onMouseUp:Te,onMouseLeave:Te,onTouchMove:ze,onTouchEnd:Te,onTouchCancel:Te,onContextMenu:de,children:[l.jsx("div",{className:"gallery",onClick:Fe,children:l.jsx("div",{className:"gallery-frame",children:D?l.jsx("img",{src:D,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&l.jsxs("div",{className:"timer",children:["Time: ",Math.floor(g/60),":",(g%60).toString().padStart(2,"0")]}),n.map(U=>l.jsx("div",{className:`block ${U.canMove?"movable":""}`,style:{left:`${Z(U.position[0],"x")}px`,top:`${Z(U.position[1],"y")}px`,backgroundColor:U.color||"green",cursor:U.canMove?"grab":"default"},onMouseDown:G=>ke(G,U.id),onTouchStart:G=>ke(G,U.id)},U.id)),V&&l.jsx("div",{className:"message-overlay",onClick:we,children:l.jsxs("div",{className:"message-box",children:[y,l.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var gc={};(function(){var e;function t(o){var u=0;return function(){return u<o.length?{done:!1,value:o[u++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,f){return o==Array.prototype||o==Object.prototype||(o[u]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ju=="object"&&ju];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,u){if(u)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var x=o[p];if(!(x in f))break e;f=f[x]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&n(f,o,{configurable:!0,writable:!0,value:u})}}i("Symbol",function(o){function u(E){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return new f(p+(E||"")+"_"+x++,E)}function f(E,A){this.h=E,n(this,"description",{configurable:!0,writable:!0,value:A})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",x=0;return u}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var u="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<u.length;f++){var p=s[u[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function c(o){var u=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return u?u.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=c(o);for(var u,f=[];!(u=o.next()).done;)f.push(u.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,u){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(o[x]=p[x])}return o};i("Object.assign",function(o){return o||h});var g=typeof Object.create=="function"?Object.create:function(o){function u(){}return u.prototype=o,new u},v;if(typeof Object.setPrototypeOf=="function")v=Object.setPrototypeOf;else{var w;e:{var N={a:!0},D={};try{D.__proto__=N,w=D.a;break e}catch{}w=!1}v=w?function(o,u){if(o.__proto__=u,o.__proto__!==u)throw new TypeError(o+" is not extensible");return o}:null}var T=v;function V(o,u){if(o.prototype=g(u.prototype),o.prototype.constructor=o,T)T(o,u);else for(var f in u)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(u,f);p&&Object.defineProperty(o,f,p)}else o[f]=u[f];o.ya=u.prototype}function j(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function y(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}j.prototype.u=function(o){this.i=o};function k(o,u){o.l={ma:u,na:!0},o.h=o.s||o.v}j.prototype.return=function(o){this.l={return:o},this.h=this.v};function M(o,u,f){return o.h=f,{value:u}}function b(o){this.h=new j,this.i=o}function H(o,u){y(o.h);var f=o.h.j;return f?L(o,"return"in f?f.return:function(p){return{value:p,done:!0}},u,o.h.return):(o.h.return(u),F(o))}function L(o,u,f,p){try{var x=u.call(o.h.j,f);if(!(x instanceof Object))throw new TypeError("Iterator result "+x+" is not an object");if(!x.done)return o.h.m=!1,x;var E=x.value}catch(A){return o.h.j=null,k(o.h,A),F(o)}return o.h.j=null,p.call(o.h,E),F(o)}function F(o){for(;o.h.h;)try{var u=o.i(o.h);if(u)return o.h.m=!1,{value:u.value,done:!1}}catch(f){o.h.i=void 0,k(o.h,f)}if(o.h.m=!1,o.h.l){if(u=o.h.l,o.h.l=null,u.na)throw u.ma;return{value:u.return,done:!0}}return{value:void 0,done:!0}}function z(o){this.next=function(u){return y(o.h),o.h.j?u=L(o,o.h.j.next,u,o.h.u):(o.h.u(u),u=F(o)),u},this.throw=function(u){return y(o.h),o.h.j?u=L(o,o.h.j.throw,u,o.h.u):(k(o.h,u),u=F(o)),u},this.return=function(u){return H(o,u)},this[Symbol.iterator]=function(){return this}}function W(o){function u(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,x){function E(A){A.done?p(A.value):Promise.resolve(A.value).then(u,f).then(E,x)}E(o.next())})}function Y(o){return W(new z(new b(o)))}i("Promise",function(o){function u(A){this.i=0,this.j=void 0,this.h=[],this.u=!1;var R=this.l();try{A(R.resolve,R.reject)}catch(K){R.reject(K)}}function f(){this.h=null}function p(A){return A instanceof u?A:new u(function(R){R(A)})}if(o)return o;f.prototype.i=function(A){if(this.h==null){this.h=[];var R=this;this.j(function(){R.m()})}this.h.push(A)};var x=s.setTimeout;f.prototype.j=function(A){x(A,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var A=this.h;this.h=[];for(var R=0;R<A.length;++R){var K=A[R];A[R]=null;try{K()}catch(oe){this.l(oe)}}}this.h=null},f.prototype.l=function(A){this.j(function(){throw A})},u.prototype.l=function(){function A(oe){return function(ye){K||(K=!0,oe.call(R,ye))}}var R=this,K=!1;return{resolve:A(this.I),reject:A(this.m)}},u.prototype.I=function(A){if(A===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(A instanceof u)this.L(A);else{e:switch(typeof A){case"object":var R=A!=null;break e;case"function":R=!0;break e;default:R=!1}R?this.F(A):this.s(A)}},u.prototype.F=function(A){var R=void 0;try{R=A.then}catch(K){this.m(K);return}typeof R=="function"?this.M(R,A):this.s(A)},u.prototype.m=function(A){this.v(2,A)},u.prototype.s=function(A){this.v(1,A)},u.prototype.v=function(A,R){if(this.i!=0)throw Error("Cannot settle("+A+", "+R+"): Promise already settled in state"+this.i);this.i=A,this.j=R,this.i===2&&this.K(),this.H()},u.prototype.K=function(){var A=this;x(function(){if(A.D()){var R=s.console;typeof R<"u"&&R.error(A.j)}},1)},u.prototype.D=function(){if(this.u)return!1;var A=s.CustomEvent,R=s.Event,K=s.dispatchEvent;return typeof K>"u"?!0:(typeof A=="function"?A=new A("unhandledrejection",{cancelable:!0}):typeof R=="function"?A=new R("unhandledrejection",{cancelable:!0}):(A=s.document.createEvent("CustomEvent"),A.initCustomEvent("unhandledrejection",!1,!0,A)),A.promise=this,A.reason=this.j,K(A))},u.prototype.H=function(){if(this.h!=null){for(var A=0;A<this.h.length;++A)E.i(this.h[A]);this.h=null}};var E=new f;return u.prototype.L=function(A){var R=this.l();A.T(R.resolve,R.reject)},u.prototype.M=function(A,R){var K=this.l();try{A.call(R,K.resolve,K.reject)}catch(oe){K.reject(oe)}},u.prototype.then=function(A,R){function K(be,xe){return typeof be=="function"?function(De){try{oe(be(De))}catch(Ye){ye(Ye)}}:xe}var oe,ye,$e=new u(function(be,xe){oe=be,ye=xe});return this.T(K(A,oe),K(R,ye)),$e},u.prototype.catch=function(A){return this.then(void 0,A)},u.prototype.T=function(A,R){function K(){switch(oe.i){case 1:A(oe.j);break;case 2:R(oe.j);break;default:throw Error("Unexpected state: "+oe.i)}}var oe=this;this.h==null?E.i(K):this.h.push(K),this.u=!0},u.resolve=p,u.reject=function(A){return new u(function(R,K){K(A)})},u.race=function(A){return new u(function(R,K){for(var oe=c(A),ye=oe.next();!ye.done;ye=oe.next())p(ye.value).T(R,K)})},u.all=function(A){var R=c(A),K=R.next();return K.done?p([]):new u(function(oe,ye){function $e(De){return function(Ye){be[De]=Ye,xe--,xe==0&&oe(be)}}var be=[],xe=0;do be.push(void 0),xe++,p(K.value).T($e(be.length-1),ye),K=R.next();while(!K.done)})},u});function q(o,u){o instanceof String&&(o+="");var f=0,p=!1,x={next:function(){if(!p&&f<o.length){var E=f++;return{value:u(E,o[E]),done:!1}}return p=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.keys",function(o){return o||function(){return q(this,function(u){return u})}}),i("Array.prototype.fill",function(o){return o||function(u,f,p){var x=this.length||0;for(0>f&&(f=Math.max(0,x+f)),(p==null||p>x)&&(p=x),p=Number(p),0>p&&(p=Math.max(0,x+p)),f=Number(f||0);f<p;f++)this[f]=u;return this}});function J(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",J),i("Uint8Array.prototype.fill",J),i("Uint8ClampedArray.prototype.fill",J),i("Int16Array.prototype.fill",J),i("Uint16Array.prototype.fill",J),i("Int32Array.prototype.fill",J),i("Uint32Array.prototype.fill",J),i("Float32Array.prototype.fill",J),i("Float64Array.prototype.fill",J),i("Object.is",function(o){return o||function(u,f){return u===f?u!==0||1/u===1/f:u!==u&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(u,f){var p=this;p instanceof String&&(p=String(p));var x=p.length;for(f=f||0,0>f&&(f=Math.max(f+x,0));f<x;f++){var E=p[f];if(E===u||Object.is(E,u))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(u,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(u instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(u,f||0)!==-1}});var re=this||self;function fe(o,u){o=o.split(".");var f=re;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||u===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=u}function he(o){var u;e:{if((u=re.navigator)&&(u=u.userAgent))break e;u=""}return u.indexOf(o)!=-1}var Se=Array.prototype.map?function(o,u){return Array.prototype.map.call(o,u,void 0)}:function(o,u){for(var f=o.length,p=Array(f),x=typeof o=="string"?o.split(""):o,E=0;E<f;E++)E in x&&(p[E]=u.call(void 0,x[E],E,o));return p},se={},ne=null;function Z(o){var u=o.length,f=3*u/4;f%3?f=Math.floor(f):"=.".indexOf(o[u-1])!=-1&&(f="=.".indexOf(o[u-2])!=-1?f-2:f-1);var p=new Uint8Array(f),x=0;return pe(o,function(E){p[x++]=E}),x!==f?p.subarray(0,x):p}function pe(o,u){function f(K){for(;p<o.length;){var oe=o.charAt(p++),ye=ne[oe];if(ye!=null)return ye;if(!/^[\s\xa0]*$/.test(oe))throw Error("Unknown base64 encoding at char: "+oe)}return K}ke();for(var p=0;;){var x=f(-1),E=f(0),A=f(64),R=f(64);if(R===64&&x===-1)break;u(x<<2|E>>4),A!=64&&(u(E<<4&240|A>>2),R!=64&&u(A<<6&192|R))}}function ke(){if(!ne){ne={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),u=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(u[f].split(""));se[f]=p;for(var x=0;x<p.length;x++){var E=p[x];ne[E]===void 0&&(ne[E]=x)}}}}var ze=typeof Uint8Array<"u",Ue=!(he("Trident")||he("MSIE"))&&typeof re.btoa=="function";function Te(o){if(!Ue){var u;u===void 0&&(u=0),ke(),u=se[u];for(var f=Array(Math.floor(o.length/3)),p=u[64]||"",x=0,E=0;x<o.length-2;x+=3){var A=o[x],R=o[x+1],K=o[x+2],oe=u[A>>2];A=u[(A&3)<<4|R>>4],R=u[(R&15)<<2|K>>6],K=u[K&63],f[E++]=oe+A+R+K}switch(oe=0,K=p,o.length-x){case 2:oe=o[x+1],K=u[(oe&15)<<2]||p;case 1:o=o[x],f[E]=u[o>>2]+u[(o&3)<<4|oe>>4]+K+p}return f.join("")}for(u="";10240<o.length;)u+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return u+=String.fromCharCode.apply(null,o),btoa(u)}var Fe=RegExp("[-_.]","g");function te(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function ue(o){if(!Ue)return Z(o);Fe.test(o)&&(o=o.replace(Fe,te)),o=atob(o);for(var u=new Uint8Array(o.length),f=0;f<o.length;f++)u[f]=o.charCodeAt(f);return u}var we;function de(){return we||(we=new Uint8Array(0))}var U={},G=typeof Uint8Array.prototype.slice=="function",Q=0,ee=0;function O(o){var u=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),u&&(f=c(P(f,o)),u=f.next().value,o=f.next().value,f=u),Q=f>>>0,ee=o>>>0}var m=typeof BigInt=="function";function P(o,u){return u=~u,o?o=~o+1:u+=1,[o,u]}function _(o,u){this.i=o>>>0,this.h=u>>>0}function C(o){if(!o)return I||(I=new _(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)O(Number(o));else if(m)o=BigInt(o),Q=Number(o&BigInt(4294967295))>>>0,ee=Number(o>>BigInt(32)&BigInt(4294967295));else{var u=+(o[0]==="-");ee=Q=0;for(var f=o.length,p=u,x=(f-u)%6+u;x<=f;p=x,x+=6)p=Number(o.slice(p,x)),ee*=1e6,Q=1e6*Q+p,4294967296<=Q&&(ee+=Q/4294967296|0,Q%=4294967296);u&&(u=c(P(Q,ee)),o=u.next().value,u=u.next().value,Q=o,ee=u)}return new _(Q,ee)}var I;function $(o,u){return Error("Invalid wire type: "+o+" (at position "+u+")")}function X(){return Error("Failed to read varint, encoding is invalid.")}function ie(o,u){return Error("Tried to read past the end of the data "+u+" > "+o)}function ge(){throw Error("Invalid UTF8")}function Ce(o,u){return u=String.fromCharCode.apply(null,u),o==null?u:o+u}var Re=void 0,Oe,nt=typeof TextDecoder<"u",qe,lt=typeof TextEncoder<"u",ct;function Ge(o){if(o!==U)throw Error("illegal external caller")}function He(o,u){if(Ge(u),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ve(){return ct||(ct=new He(null,U))}function Ze(o){Ge(U);var u=o.V;return u=u==null||ze&&u!=null&&u instanceof Uint8Array?u:typeof u=="string"?ue(u):null,u==null?u:o.V=u}function Ct(o){if(typeof o=="string")return{buffer:ue(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===He)return{buffer:Ze(o)||de(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function On(o,u){this.i=null,this.m=!1,this.h=this.j=this.l=0,mt(this,o,u)}function mt(o,u,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,u&&(u=Ct(u),o.i=u.buffer,o.m=u.C,o.l=0,o.j=o.i.length,o.h=o.l)}On.prototype.reset=function(){this.h=this.l};function Dt(o,u){if(o.h=u,u>o.j)throw ie(o.j,u)}function Pt(o){var u=o.i,f=o.h,p=u[f++],x=p&127;if(p&128&&(p=u[f++],x|=(p&127)<<7,p&128&&(p=u[f++],x|=(p&127)<<14,p&128&&(p=u[f++],x|=(p&127)<<21,p&128&&(p=u[f++],x|=p<<28,p&128&&u[f++]&128&&u[f++]&128&&u[f++]&128&&u[f++]&128&&u[f++]&128)))))throw X();return Dt(o,f),x}function tn(o,u){if(0>u)throw Error("Tried to read a negative byte length: "+u);var f=o.h,p=f+u;if(p>o.j)throw ie(u,o.j-f);return o.h=p,f}var ln=[];function cn(){this.h=[]}cn.prototype.length=function(){return this.h.length},cn.prototype.end=function(){var o=this.h;return this.h=[],o};function En(o,u,f){for(;0<f||127<u;)o.h.push(u&127|128),u=(u>>>7|f<<25)>>>0,f>>>=7;o.h.push(u)}function Cn(o,u){for(;127<u;)o.h.push(u&127|128),u>>>=7;o.h.push(u)}function Jr(o,u){if(ln.length){var f=ln.pop();mt(f,o,u),o=f}else o=new On(o,u);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(u)}Jr.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},Jr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Fr(o){var u=o.h;if(u.h==u.j)return!1;o.j=o.h.h;var f=Pt(o.h)>>>0;if(u=f>>>3,f&=7,!(0<=f&&5>=f))throw $(f,o.j);if(1>u)throw Error("Invalid field number: "+u+" (at position "+o.j+")");return o.l=u,o.i=f,!0}function $n(o){switch(o.i){case 0:if(o.i!=0)$n(o);else e:{o=o.h;for(var u=o.h,f=u+10,p=o.i;u<f;)if(!(p[u++]&128)){Dt(o,u);break e}throw X()}break;case 1:o=o.h,Dt(o,o.h+8);break;case 2:o.i!=2?$n(o):(u=Pt(o.h)>>>0,o=o.h,Dt(o,o.h+u));break;case 5:o=o.h,Dt(o,o.h+4);break;case 3:u=o.l;do{if(!Fr(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=u)throw Error("Unmatched end-group tag");break}$n(o)}while(!0);break;default:throw $(o.i,o.j)}}var Dn=[];function ys(){this.j=[],this.i=0,this.h=new cn}function zn(o,u){u.length!==0&&(o.j.push(u),o.i+=u.length)}function Si(o,u){if(u=u.R){zn(o,o.h.end());for(var f=0;f<u.length;f++)zn(o,Ze(u[f])||de())}}var jn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Ar(o,u){return jn?o[jn]|=u:o.A!==void 0?o.A|=u:(Object.defineProperties(o,{A:{value:u,configurable:!0,writable:!0,enumerable:!1}}),u)}function Js(o,u){jn?o[jn]&&(o[jn]&=~u):o.A!==void 0&&(o.A&=~u)}function xt(o){var u;return jn?u=o[jn]:u=o.A,u??0}function Un(o,u){jn?o[jn]=u:o.A!==void 0?o.A=u:Object.defineProperties(o,{A:{value:u,configurable:!0,writable:!0,enumerable:!1}})}function Bo(o){return Ar(o,1),o}function vu(o,u){Un(u,(o|0)&-51)}function ki(o,u){Un(u,(o|18)&-41)}var Ai={};function qs(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var Zs,Fo=[];Un(Fo,23),Zs=Object.freeze(Fo);function Ei(o){if(xt(o.o)&2)throw Error("Cannot mutate an immutable Message")}function Ci(o){var u=o.length;(u=u?o[u-1]:void 0)&&qs(u)?u.g=1:(u={},o.push((u.g=1,u)))}function Oo(o){var u=o.i+o.G;return o.B||(o.B=o.o[u]={})}function _n(o,u){return u===-1?null:u>=o.i?o.B?o.B[u]:void 0:o.o[u+o.G]}function Hn(o,u,f,p){Ei(o),vs(o,u,f,p)}function vs(o,u,f,p){o.j&&(o.j=void 0),u>=o.i||p?Oo(o)[u]=f:(o.o[u+o.G]=f,(o=o.B)&&u in o&&delete o[u])}function ji(o,u,f,p){var x=_n(o,u);Array.isArray(x)||(x=Zs);var E=xt(x);if(E&1||Bo(x),p)E&2||Ar(x,2),f&1||Object.freeze(x);else{p=!(f&2);var A=E&2;f&1||!A?p&&E&16&&!A&&Js(x,16):(x=Bo(Array.prototype.slice.call(x)),vs(o,u,x))}return x}function _i(o,u){var f=_n(o,u),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&vs(o,u,p),p}function $o(o,u,f,p,x){o.h||(o.h={});var E=o.h[f],A=ji(o,f,3,x);if(!E){var R=A;E=[];var K=!!(xt(o.o)&16);A=!!(xt(R)&2);var oe=R;!x&&A&&(R=Array.prototype.slice.call(R));for(var ye=A,$e=0;$e<R.length;$e++){var be=R[$e],xe=u,De=!1;if(De=De===void 0?!1:De,be=Array.isArray(be)?new xe(be):De?new xe:void 0,be!==void 0){xe=be.o;var Ye=De=xt(xe);A&&(Ye|=2),K&&(Ye|=16),Ye!=De&&Un(xe,Ye),xe=Ye,ye=ye||!!(2&xe),E.push(be)}}return o.h[f]=E,K=xt(R),u=K|33,u=ye?u&-9:u|8,K!=u&&(ye=R,Object.isFrozen(ye)&&(ye=Array.prototype.slice.call(ye)),Un(ye,u),R=ye),oe!==R&&vs(o,f,R),(x||p&&A)&&Ar(E,2),p&&Object.freeze(E),E}return x||(x=Object.isFrozen(E),p&&!x?Object.freeze(E):!p&&x&&(E=Array.prototype.slice.call(E),o.h[f]=E)),E}function B(o,u,f){var p=!!(xt(o.o)&2);if(u=$o(o,u,f,p,p),o=ji(o,f,3,p),!(p||xt(o)&8)){for(p=0;p<u.length;p++){if(f=u[p],xt(f.o)&2){var x=qa(f,!1);x.j=f}else x=f;f!==x&&(u[p]=x,o[p]=x.o)}Ar(o,8)}return u}function le(o,u,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);Hn(o,u,f)}function me(o,u,f,p,x){Ei(o);var E=$o(o,f,u,!1,!1);return f=p??new f,o=ji(o,u,2,!1),x!=null?(E.splice(x,0,f),o.splice(x,0,f.o)):(E.push(f),o.push(f.o)),f.C()&&Js(o,8),f}function ae(o,u){return o??u}function ve(o,u,f){return f=f===void 0?0:f,ae(_i(o,u),f)}var Be;function je(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(xt(o)&128)return o=Array.prototype.slice.call(o),Ci(o),o}else{if(ze&&o!=null&&o instanceof Uint8Array)return Te(o);if(o instanceof He){var u=o.V;return u==null?"":typeof u=="string"?u:o.V=Te(u)}}}return o}function We(o,u,f,p){if(o!=null){if(Array.isArray(o))o=Le(o,u,f,p!==void 0);else if(qs(o)){var x={},E;for(E in o)x[E]=We(o[E],u,f,p);o=x}else o=u(o,p);return o}}function Le(o,u,f,p){var x=xt(o);p=p?!!(x&16):void 0,o=Array.prototype.slice.call(o);for(var E=0;E<o.length;E++)o[E]=We(o[E],u,f,p);return f(x,o),o}function Ke(o){return o.ja===Ai?o.toJSON():je(o)}function Xt(o,u){o&128&&Ci(u)}function ir(o,u,f){if(f=f===void 0?ki:f,o!=null){if(ze&&o instanceof Uint8Array)return o.length?new He(new Uint8Array(o),U):Ve();if(Array.isArray(o)){var p=xt(o);return p&2?o:u&&!(p&32)&&(p&16||p===0)?(Un(o,p|2),o):(o=Le(o,ir,p&4?ki:f,!0),u=xt(o),u&4&&u&2&&Object.freeze(o),o)}return o.ja===Ai?Ja(o):o}}function Nn(o,u,f,p,x,E,A){if(o=o.h&&o.h[f]){if(p=xt(o),p&2?p=o:(E=Se(o,Ja),ki(p,E),Object.freeze(E),p=E),Ei(u),A=p==null?Zs:Bo([]),p!=null){for(E=!!p.length,o=0;o<p.length;o++){var R=p[o];E=E&&!(xt(R.o)&2),A[o]=R.o}E=(E?8:0)|1,o=xt(A),(o&E)!==E&&(Object.isFrozen(A)&&(A=Array.prototype.slice.call(A)),Un(A,o|E)),u.h||(u.h={}),u.h[f]=p}else u.h&&(u.h[f]=void 0);vs(u,f,A,x)}else Hn(u,f,ir(p,E,A),x)}function Ja(o){return xt(o.o)&2||(o=qa(o,!0),Ar(o.o,2)),o}function qa(o,u){var f=o.o,p=[];Ar(p,16);var x=o.constructor.h;if(x&&p.push(x),x=o.B,x){p.length=f.length,p.fill(void 0,p.length,f.length);var E={};p[p.length-1]=E}xt(f)&128&&Ci(p),u=u||o.C()?ki:vu,E=o.constructor,Be=p,p=new E(p),Be=void 0,o.R&&(p.R=o.R.slice()),E=!!(xt(f)&16);for(var A=x?f.length-1:f.length,R=0;R<A;R++)Nn(o,p,R-o.G,f[R],!1,E,u);if(x)for(var K in x)Nn(o,p,+K,x[K],!0,E,u);return p}function Kt(o,u,f){o==null&&(o=Be),Be=void 0;var p=this.constructor.i||0,x=0<p,E=this.constructor.h,A=!1;if(o==null){o=E?[E]:[];var R=48,K=!0;x&&(p=0,R|=128),Un(o,R)}else{if(!Array.isArray(o)||E&&E!==o[0])throw Error();var oe=R=Ar(o,0);if((K=(16&oe)!==0)&&((A=(32&oe)!==0)||(oe|=32)),x){if(128&oe)p=0;else if(0<o.length){var ye=o[o.length-1];if(qs(ye)&&"g"in ye){p=0,oe|=128,delete ye.g;var $e=!0,be;for(be in ye){$e=!1;break}$e&&o.pop()}}}else if(128&oe)throw Error();R!==oe&&Un(o,oe)}this.G=(E?0:-1)-p,this.h=void 0,this.o=o;e:{if(E=this.o.length,p=E-1,E&&(E=this.o[p],qs(E))){this.B=E,this.i=p-this.G;break e}u!==void 0&&-1<u?(this.i=Math.max(u,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!x&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){u=K&&!A&&!0,x=this.i;var xe;for(K=0;K<f.length;K++)A=f[K],A<x?(A+=this.G,(p=o[A])?Za(p,u):o[A]=Zs):(xe||(xe=Oo(this)),(p=xe[A])?Za(p,u):xe[A]=Zs)}}Kt.prototype.toJSON=function(){return Le(this.o,Ke,Xt)},Kt.prototype.C=function(){return!!(xt(this.o)&2)};function Za(o,u){if(Array.isArray(o)){var f=xt(o),p=1;!u||f&2||(p|=16),(f&p)!==p&&Un(o,f|p)}}Kt.prototype.ja=Ai,Kt.prototype.toString=function(){return this.o.toString()};function Ni(o,u,f){if(f){var p={},x;for(x in f){var E=f[x],A=E.qa;A||(p.J=E.wa||E.oa.W,E.ia?(p.aa=$p(E.ia),A=function(R){return function(K,oe,ye){return R.J(K,oe,ye,R.aa)}}(p)):E.ka?(p.Z=Dp(E.da.P,E.ka),A=function(R){return function(K,oe,ye){return R.J(K,oe,ye,R.Z)}}(p)):A=p.J,E.qa=A),A(u,o,E.da),p={J:p.J,aa:p.aa,Z:p.Z}}}Si(u,o)}var el=Symbol();function Lp(o,u,f){return o[el]||(o[el]=function(p,x){return u(p,x,f)})}function Bp(o){var u=o[el];if(!u){var f=xu(o);u=function(p,x){return zp(p,x,f)},o[el]=u}return u}function Qv(o){var u=o.ia;if(u)return Bp(u);if(u=o.va)return Lp(o.da.P,u,o.ka)}function Jv(o){var u=Qv(o),f=o.da,p=o.oa.U;return u?function(x,E){return p(x,E,f,u)}:function(x,E){return p(x,E,f)}}function Fp(o,u){var f=o[u];return typeof f=="function"&&f.length===0&&(f=f(),o[u]=f),Array.isArray(f)&&(zo in f||Do in f||0<f.length&&typeof f[0]=="function")?f:void 0}function Op(o,u,f,p,x,E){u.P=o[0];var A=1;if(o.length>A&&typeof o[A]!="number"){var R=o[A++];f(u,R)}for(;A<o.length;){f=o[A++];for(var K=A+1;K<o.length&&typeof o[K]!="number";)K++;switch(R=o[A++],K-=A,K){case 0:p(u,f,R);break;case 1:(K=Fp(o,A))?(A++,x(u,f,R,K)):p(u,f,R,o[A++]);break;case 2:K=A++,K=Fp(o,K),x(u,f,R,K,o[A++]);break;case 3:E(u,f,R,o[A++],o[A++],o[A++]);break;case 4:E(u,f,R,o[A++],o[A++],o[A++],o[A++]);break;default:throw Error("unexpected number of binary field arguments: "+K)}}return u}var tl=Symbol();function $p(o){var u=o[tl];if(!u){var f=wu(o);u=function(p,x){return Up(p,x,f)},o[tl]=u}return u}function Dp(o,u){var f=o[tl];return f||(f=function(p,x){return Ni(p,x,u)},o[tl]=f),f}var Do=Symbol();function qv(o,u){o.push(u)}function Zv(o,u,f){o.push(u,f.W)}function e3(o,u,f,p){var x=$p(p),E=wu(p).P,A=f.W;o.push(u,function(R,K,oe){return A(R,K,oe,E,x)})}function t3(o,u,f,p,x,E){var A=Dp(p,E),R=f.W;o.push(u,function(K,oe,ye){return R(K,oe,ye,p,A)})}function wu(o){var u=o[Do];return u||(u=Op(o,o[Do]=[],qv,Zv,e3,t3),zo in o&&Do in o&&(o.length=0),u)}var zo=Symbol();function n3(o,u){o[0]=u}function r3(o,u,f,p){var x=f.U;o[u]=p?function(E,A,R){return x(E,A,R,p)}:x}function s3(o,u,f,p,x){var E=f.U,A=Bp(p),R=xu(p).P;o[u]=function(K,oe,ye){return E(K,oe,ye,R,A,x)}}function i3(o,u,f,p,x,E,A){var R=f.U,K=Lp(p,x,E);o[u]=function(oe,ye,$e){return R(oe,ye,$e,p,K,A)}}function xu(o){var u=o[zo];return u||(u=Op(o,o[zo]={},n3,r3,s3,i3),zo in o&&Do in o&&(o.length=0),u)}function zp(o,u,f){for(;Fr(u)&&u.i!=4;){var p=u.l,x=f[p];if(!x){var E=f[0];E&&(E=E[p])&&(x=f[p]=Jv(E))}if(!x||!x(u,o,p)){x=u,p=o,E=x.j,$n(x);var A=x;if(!A.ca){if(x=A.h.h-E,A.h.h=E,A=A.h,x==0)x=Ve();else{if(E=tn(A,x),A.S&&A.m)x=A.i.subarray(E,E+x);else{A=A.i;var R=E;x=E+x,x=R===x?de():G?A.slice(R,x):new Uint8Array(A.subarray(R,x))}x=x.length==0?Ve():new He(x,U)}(E=p.R)?E.push(x):p.R=[x]}}}return o}function Up(o,u,f){for(var p=f.length,x=p%2==1,E=x?1:0;E<p;E+=2)(0,f[E+1])(u,o,f[E]);Ni(o,u,x?f[0]:void 0)}function Uo(o,u){return{U:o,W:u}}var Er=Uo(function(o,u,f){if(o.i!==5)return!1;o=o.h;var p=o.i,x=o.h,E=p[x],A=p[x+1],R=p[x+2];return p=p[x+3],Dt(o,o.h+4),A=(E<<0|A<<8|R<<16|p<<24)>>>0,o=2*(A>>31)+1,E=A>>>23&255,A&=8388607,Hn(u,f,E==255?A?NaN:1/0*o:E==0?o*Math.pow(2,-149)*A:o*Math.pow(2,E-150)*(A+Math.pow(2,23))),!0},function(o,u,f){if(u=_i(u,f),u!=null){Cn(o.h,8*f+5),o=o.h;var p=+u;p===0?0<1/p?Q=ee=0:(ee=0,Q=2147483648):isNaN(p)?(ee=0,Q=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(ee=0,Q=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),ee=0,Q=(f|p)>>>0):(u=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-u),p=Math.round(8388608*p),16777216<=p&&++u,ee=0,Q=(f|u+127<<23|p&8388607)>>>0)),f=Q,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),o3=Uo(function(o,u,f){if(o.i!==0)return!1;var p=o.h,x=0,E=o=0,A=p.i,R=p.h;do{var K=A[R++];x|=(K&127)<<E,E+=7}while(32>E&&K&128);for(32<E&&(o|=(K&127)>>4),E=3;32>E&&K&128;E+=7)K=A[R++],o|=(K&127)<<E;if(Dt(p,R),128>K)p=x>>>0,K=o>>>0,(o=K&2147483648)&&(p=~p+1>>>0,K=~K>>>0,p==0&&(K=K+1>>>0)),p=4294967296*K+(p>>>0);else throw X();return Hn(u,f,o?-p:p),!0},function(o,u,f){u=_n(u,f),u!=null&&(typeof u=="string"&&C(u),u!=null&&(Cn(o.h,8*f),typeof u=="number"?(o=o.h,O(u),En(o,Q,ee)):(f=C(u),En(o.h,f.i,f.h))))}),a3=Uo(function(o,u,f){return o.i!==0?!1:(Hn(u,f,Pt(o.h)),!0)},function(o,u,f){if(u=_n(u,f),u!=null&&u!=null)if(Cn(o.h,8*f),o=o.h,f=u,0<=f)Cn(o,f);else{for(u=0;9>u;u++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),Hp=Uo(function(o,u,f){if(o.i!==2)return!1;var p=Pt(o.h)>>>0;o=o.h;var x=tn(o,p);if(o=o.i,nt){var E=o,A;(A=Oe)||(A=Oe=new TextDecoder("utf-8",{fatal:!0})),o=x+p,E=x===0&&o===E.length?E:E.subarray(x,o);try{var R=A.decode(E)}catch($e){if(Re===void 0){try{A.decode(new Uint8Array([128]))}catch{}try{A.decode(new Uint8Array([97])),Re=!0}catch{Re=!1}}throw!Re&&(Oe=void 0),$e}}else{R=x,p=R+p,x=[];for(var K=null,oe,ye;R<p;)oe=o[R++],128>oe?x.push(oe):224>oe?R>=p?ge():(ye=o[R++],194>oe||(ye&192)!==128?(R--,ge()):x.push((oe&31)<<6|ye&63)):240>oe?R>=p-1?ge():(ye=o[R++],(ye&192)!==128||oe===224&&160>ye||oe===237&&160<=ye||((E=o[R++])&192)!==128?(R--,ge()):x.push((oe&15)<<12|(ye&63)<<6|E&63)):244>=oe?R>=p-2?ge():(ye=o[R++],(ye&192)!==128||(oe<<28)+(ye-144)>>30||((E=o[R++])&192)!==128||((A=o[R++])&192)!==128?(R--,ge()):(oe=(oe&7)<<18|(ye&63)<<12|(E&63)<<6|A&63,oe-=65536,x.push((oe>>10&1023)+55296,(oe&1023)+56320))):ge(),8192<=x.length&&(K=Ce(K,x),x.length=0);R=Ce(K,x)}return Hn(u,f,R),!0},function(o,u,f){if(u=_n(u,f),u!=null){var p=!1;if(p=p===void 0?!1:p,lt){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(u))throw Error("Found an unpaired surrogate");u=(qe||(qe=new TextEncoder)).encode(u)}else{for(var x=0,E=new Uint8Array(3*u.length),A=0;A<u.length;A++){var R=u.charCodeAt(A);if(128>R)E[x++]=R;else{if(2048>R)E[x++]=R>>6|192;else{if(55296<=R&&57343>=R){if(56319>=R&&A<u.length){var K=u.charCodeAt(++A);if(56320<=K&&57343>=K){R=1024*(R-55296)+K-56320+65536,E[x++]=R>>18|240,E[x++]=R>>12&63|128,E[x++]=R>>6&63|128,E[x++]=R&63|128;continue}else A--}if(p)throw Error("Found an unpaired surrogate");R=65533}E[x++]=R>>12|224,E[x++]=R>>6&63|128}E[x++]=R&63|128}}u=x===E.length?E:E.subarray(0,x)}Cn(o.h,8*f+2),Cn(o.h,u.length),zn(o,o.h.end()),zn(o,u)}}),Wp=Uo(function(o,u,f,p,x){if(o.i!==2)return!1;u=me(u,f,p),f=o.h.j,p=Pt(o.h)>>>0;var E=o.h.h+p,A=E-f;if(0>=A&&(o.h.j=E,x(u,o,void 0,void 0,void 0),A=E-o.h.h),A)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-A)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=E,o.h.j=f,!0},function(o,u,f,p,x){if(u=B(u,p,f),u!=null)for(p=0;p<u.length;p++){var E=o;Cn(E.h,8*f+2);var A=E.h.end();zn(E,A),A.push(E.i),E=A,x(u[p],o),A=o;var R=E.pop();for(R=A.i+A.h.length()-R;127<R;)E.push(R&127|128),R>>>=7,A.i++;E.push(R),A.i++}});function Su(o){return function(u,f){e:{if(Dn.length){var p=Dn.pop();p.setOptions(f),mt(p.h,u,f),u=p}else u=new Jr(u,f);try{var x=xu(o),E=zp(new x.P,u,x);break e}finally{x=u.h,x.i=null,x.m=!1,x.l=0,x.j=0,x.h=0,x.S=!1,u.l=-1,u.i=-1,100>Dn.length&&Dn.push(u)}E=void 0}return E}}function ku(o){return function(){var u=new ys;Up(this,u,wu(o)),zn(u,u.h.end());for(var f=new Uint8Array(u.i),p=u.j,x=p.length,E=0,A=0;A<x;A++){var R=p[A];f.set(R,E),E+=R.length}return u.j=[f],f}}function bi(o){Kt.call(this,o)}V(bi,Kt);var Gp=[bi,1,a3,2,Er,3,Hp,4,Hp];bi.prototype.l=ku(Gp);function Au(o){Kt.call(this,o,-1,l3)}V(Au,Kt),Au.prototype.addClassification=function(o,u){return me(this,1,bi,o,u),this};var l3=[1],Vp=Su([Au,1,Wp,Gp]);function Mi(o){Kt.call(this,o)}V(Mi,Kt);var Yp=[Mi,1,Er,2,Er,3,Er,4,Er,5,Er];Mi.prototype.l=ku(Yp);function Xp(o){Kt.call(this,o,-1,c3)}V(Xp,Kt);var c3=[1],Kp=Su([Xp,1,Wp,Yp]);function nl(o){Kt.call(this,o)}V(nl,Kt);var Qp=[nl,1,Er,2,Er,3,Er,4,Er,5,Er,6,o3],u3=Su(Qp);nl.prototype.l=ku(Qp);function Jp(o,u,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,u),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function qp(o){return B(o,bi,1).map(function(u){var f=_n(u,1);return{index:f??0,score:ve(u,2),label:_n(u,3)!=null?ae(_n(u,3),""):void 0,displayName:_n(u,4)!=null?ae(_n(u,4),""):void 0}})}function Zp(o){return{x:ve(o,1),y:ve(o,2),z:ve(o,3),visibility:_i(o,4)!=null?ve(o,4):void 0}}function em(o){return o.map(function(u){return B(Kp(u),Mi,1).map(Zp)})}function Eu(o,u){this.i=o,this.h=u,this.m=0}function tm(o,u,f){return d3(o,u),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function d3(o,u){var f=o.h;if(o.s===void 0){var p=Jp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),x=Jp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),E=f.createProgram();if(f.attachShader(E,p),f.attachShader(E,x),f.linkProgram(E),!f.getProgramParameter(E,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(E));p=o.s=E,f.useProgram(p),x=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:x},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(x,0)}p=o.l,f.useProgram(o.s),f.canvas.width=u.width,f.canvas.height=u.height,f.viewport(0,0,u.width,u.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(u.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function f3(o){this.h=o}var h3=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function p3(o,u){return u+o}function nm(o,u){window[o]=u}function m3(o){var u=document.createElement("script");return u.setAttribute("src",o),u.setAttribute("crossorigin","anonymous"),new Promise(function(f){u.addEventListener("load",function(){f()},!1),u.addEventListener("error",function(){f()},!1),document.body.appendChild(u)})}function g3(){return Y(function(o){switch(o.h){case 1:return o.s=2,M(o,WebAssembly.instantiate(h3),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function Cu(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||p3,typeof window=="object")var u=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")u=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=u,o.options){u=c(Object.keys(o.options));for(var f=u.next();!f.done;f=u.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=Cu.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function y3(o){var u,f,p,x,E,A,R,K,oe,ye,$e;return Y(function(be){switch(be.h){case 1:return o.ga?(u=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,M(be,g3(),2)):be.return();case 2:if(f=be.i,typeof window=="object")return nm("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),nm("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),A=u.filter(function(xe){return xe.data!==void 0}),R=u.filter(function(xe){return xe.data===void 0}),K=Promise.all(A.map(function(xe){var De=rl(o,xe.url);if(xe.path!==void 0){var Ye=xe.path;De=De.then(function(gt){return o.overrideFile(Ye,gt),Promise.resolve(gt)})}return De})),oe=Promise.all(R.map(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f?m3(o.locateFile(xe.url,o.ha)):Promise.resolve()})).then(function(){var xe,De,Ye;return Y(function(gt){if(gt.h==1)return xe=window.createMediapipeSolutionsWasm,De=window.createMediapipeSolutionsPackedAssets,Ye=o,M(gt,xe(De),2);Ye.i=gt.i,gt.h=0})}),ye=function(){return Y(function(xe){return o.h.graph&&o.h.graph.url?xe=M(xe,rl(o,o.h.graph.url),0):(xe.h=0,xe=void 0),xe})}(),M(be,Promise.all([oe,K,ye]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=u.filter(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f}).map(function(xe){return o.locateFile(xe.url,o.ha)}),importScripts.apply(null,d(p)),x=o,M(be,createMediapipeSolutionsWasm(Module),6);case 6:x.i=be.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,E=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(E),be.h=4;break;case 7:if(o.m=document.createElement("canvas"),$e=o.m.getContext("webgl2",{}),!$e&&($e=o.m.getContext("webgl",{}),!$e))return alert("Failed to create WebGL canvas context when passing video frame."),be.return();o.K=$e,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,be.h=0}})}function v3(o){var u,f,p,x,E,A,R,K;return Y(function(oe){if(oe.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return oe.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){oe.h=2;return}return o.fa=o.h.graph.url,M(oe,rl(o,o.h.graph.url),3)}for(oe.h!=2&&(u=oe.i,o.j.loadGraph(u)),f=c(Object.keys(o.D)),p=f.next();!p.done;p=f.next())x=p.value,o.j.overrideFile(x,o.D[x]);if(o.D={},o.h.listeners)for(E=c(o.h.listeners),A=E.next();!A.done;A=E.next())R=A.value,k3(o,R);K=o.l,o.l={},o.setOptions(K),oe.h=0})}e.reset=function(){var o=this;return Y(function(u){o.j&&(o.j.reset(),o.s={},o.v={}),u.h=0})},e.setOptions=function(o,u){var f=this;if(u=u||this.h.options){for(var p=[],x=[],E={},A=c(Object.keys(o)),R=A.next();!R.done;E={X:E.X,Y:E.Y},R=A.next())if(R=R.value,!(R in this.l&&this.l[R]===o[R])){this.l[R]=o[R];var K=u[R];K!==void 0&&(K.onChange&&(E.X=K.onChange,E.Y=o[R],p.push(function(oe){return function(){var ye;return Y(function($e){if($e.h==1)return M($e,oe.X(oe.Y),2);ye=$e.i,ye===!0&&(f.u=!0),$e.h=0})}}(E))),K.graphOptionXref&&(R=Object.assign({},{calculatorName:"",calculatorIndex:0},K.graphOptionXref,{valueNumber:K.type===1?o[R]:0,valueBoolean:K.type===0?o[R]:!1,valueString:K.type===2?o[R]:""}),x.push(R)))}(p.length!==0||x.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(x),this.F=(this.F===void 0?[]:this.F).concat(p))}};function w3(o){var u,f,p,x,E,A,R;return Y(function(K){switch(K.h){case 1:if(!o.u)return K.return();if(!o.F){K.h=2;break}u=c(o.F),f=u.next();case 3:if(f.done){K.h=5;break}return p=f.value,M(K,p(),4);case 4:f=u.next(),K.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(x=new o.i.GraphOptionChangeRequestList,E=c(o.H),A=E.next();!A.done;A=E.next())R=A.value,x.push_back(R);o.j.changeOptions(x),x.delete(),o.H=void 0}o.u=!1,K.h=0}})}e.initialize=function(){var o=this;return Y(function(u){return u.h==1?M(u,y3(o),2):u.h!=3?M(u,v3(o),3):M(u,w3(o),0)})};function rl(o,u){var f,p;return Y(function(x){return u in o.L?x.return(o.L[u]):(f=o.locateFile(u,""),p=fetch(f).then(function(E){return E.arrayBuffer()}),o.L[u]=p,x.return(p))})}e.overrideFile=function(o,u){this.j?this.j.overrideFile(o,u):this.D[o]=u},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,u){var f=this,p,x,E,A,R,K,oe,ye,$e;return Y(function(be){switch(be.h){case 1:return f.h.inputs?(p=1e3*(u??performance.now()),M(be,f.I,2)):be.return();case 2:return M(be,f.initialize(),3);case 3:for(x=new f.i.PacketDataList,E=c(Object.keys(o)),A=E.next();!A.done;A=E.next())if(R=A.value,K=f.h.inputs[R]){e:{var xe=o[R];switch(K.type){case"video":var De=f.s[K.stream];if(De||(De=new Eu(f.i,f.K),f.s[K.stream]=De),De.m===0&&(De.m=De.i.createTexture()),typeof HTMLVideoElement<"u"&&xe instanceof HTMLVideoElement)var Ye=xe.videoWidth,gt=xe.videoHeight;else typeof HTMLImageElement<"u"&&xe instanceof HTMLImageElement?(Ye=xe.naturalWidth,gt=xe.naturalHeight):(Ye=xe.width,gt=xe.height);gt={glName:De.m,width:Ye,height:gt},Ye=De.h,Ye.canvas.width=gt.width,Ye.canvas.height=gt.height,Ye.activeTexture(Ye.TEXTURE0),De.i.bindTexture2d(De.m),Ye.texImage2D(Ye.TEXTURE_2D,0,Ye.RGBA,Ye.RGBA,Ye.UNSIGNED_BYTE,xe),De.i.bindTexture2d(0),De=gt;break e;case"detections":for(De=f.s[K.stream],De||(De=new f3(f.i),f.s[K.stream]=De),De.data||(De.data=new De.h.DetectionListData),De.data.reset(xe.length),gt=0;gt<xe.length;++gt){Ye=xe[gt];var dt=De.data,nn=dt.setBoundingBox,or=gt,bn=Ye.la,rt=new nl;if(le(rt,1,bn.ra),le(rt,2,bn.sa),le(rt,3,bn.height),le(rt,4,bn.width),le(rt,5,bn.rotation),Hn(rt,6,bn.pa),bn=rt.l(),nn.call(dt,or,bn),Ye.ea)for(dt=0;dt<Ye.ea.length;++dt){rt=Ye.ea[dt],nn=De.data,or=nn.addNormalizedLandmark,bn=gt,rt=Object.assign({},rt,{visibility:rt.visibility?rt.visibility:0});var rn=new Mi;le(rn,1,rt.x),le(rn,2,rt.y),le(rn,3,rt.z),rt.visibility&&le(rn,4,rt.visibility),rt=rn.l(),or.call(nn,bn,rt)}if(Ye.ba)for(dt=0;dt<Ye.ba.length;++dt)nn=De.data,or=nn.addClassification,bn=gt,rt=Ye.ba[dt],rn=new bi,le(rn,2,rt.score),rt.index&&Hn(rn,1,rt.index),rt.label&&Hn(rn,3,rt.label),rt.displayName&&Hn(rn,4,rt.displayName),rt=rn.l(),or.call(nn,bn,rt)}De=De.data;break e;default:De={}}}switch(oe=De,ye=K.stream,K.type){case"video":x.pushTexture2d(Object.assign({},oe,{stream:ye,timestamp:p}));break;case"detections":$e=oe,$e.stream=ye,$e.timestamp=p,x.pushDetectionList($e);break;default:throw Error("Unknown input config type: '"+K.type+"'")}}return f.j.send(x),M(be,f.I,4);case 4:x.delete(),be.h=0}})};function x3(o,u,f){var p,x,E,A,R,K,oe,ye,$e,be,xe,De,Ye,gt;return Y(function(dt){switch(dt.h){case 1:if(!f)return dt.return(u);for(p={},x=0,E=c(Object.keys(f)),A=E.next();!A.done;A=E.next())R=A.value,K=f[R],typeof K!="string"&&K.type==="texture"&&u[K.stream]!==void 0&&++x;1<x&&(o.M=!1),oe=c(Object.keys(f)),A=oe.next();case 2:if(A.done){dt.h=4;break}if(ye=A.value,$e=f[ye],typeof $e=="string")return Ye=p,gt=ye,M(dt,S3(o,ye,u[$e]),14);if(be=u[$e.stream],$e.type==="detection_list"){if(be){for(var nn=be.getRectList(),or=be.getLandmarksList(),bn=be.getClassificationsList(),rt=[],rn=0;rn<nn.size();++rn){var ws=u3(nn.get(rn)),A3=ve(ws,1),E3=ve(ws,2),C3=ve(ws,3),j3=ve(ws,4),_3=ve(ws,5,0),sl=void 0;sl=sl===void 0?0:sl,ws={la:{ra:A3,sa:E3,height:C3,width:j3,rotation:_3,pa:ae(_n(ws,6),sl)},ea:B(Kp(or.get(rn)),Mi,1).map(Zp),ba:qp(Vp(bn.get(rn)))},rt.push(ws)}nn=rt}else nn=[];p[ye]=nn,dt.h=7;break}if($e.type==="proto_list"){if(be){for(nn=Array(be.size()),or=0;or<be.size();or++)nn[or]=be.get(or);be.delete()}else nn=[];p[ye]=nn,dt.h=7;break}if(be===void 0){dt.h=3;break}if($e.type==="float_list"){p[ye]=be,dt.h=7;break}if($e.type==="proto"){p[ye]=be,dt.h=7;break}if($e.type!=="texture")throw Error("Unknown output config type: '"+$e.type+"'");return xe=o.v[ye],xe||(xe=new Eu(o.i,o.K),o.v[ye]=xe),M(dt,tm(xe,be,o.M),13);case 13:De=dt.i,p[ye]=De;case 7:$e.transform&&p[ye]&&(p[ye]=$e.transform(p[ye])),dt.h=3;break;case 14:Ye[gt]=dt.i;case 3:A=oe.next(),dt.h=2;break;case 4:return dt.return(p)}})}function S3(o,u,f){var p;return Y(function(x){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?x.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[u],p||(p=new Eu(o.i,o.K),o.v[u]=p),x.return(tm(p,f,o.M))):x.return(void 0)})}function k3(o,u){for(var f=u.name||"$",p=[].concat(d(u.wants)),x=new o.i.StringList,E=c(u.wants),A=E.next();!A.done;A=E.next())x.push_back(A.value);E=o.i.PacketListener.implement({onResults:function(R){for(var K={},oe=0;oe<u.wants.length;++oe)K[p[oe]]=R.get(oe);var ye=o.listeners[f];ye&&(o.I=x3(o,K,u.outs).then(function($e){$e=ye($e);for(var be=0;be<u.wants.length;++be){var xe=K[p[be]];typeof xe=="object"&&xe.hasOwnProperty&&xe.hasOwnProperty("delete")&&xe.delete()}$e&&(o.I=$e)}))}}),o.j.attachMultiListener(x,E),x.delete()}e.onResults=function(o,u){this.listeners[u||"$"]=o},fe("Solution",Cu),fe("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function rm(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function sm(o){var u=this;o=o||{},this.h=new Cu({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:rm(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:em},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:em},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return qp(Vp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,x,E;return Y(function(A){return A.h==1?(p=rm(f),x="third_party/mediapipe/modules/hand_landmark/"+p,M(A,rl(u.h,p),2)):(E=A.i,u.h.overrideFile(x,E),A.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=sm.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return Y(function(u){return M(u,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var u=this;return Y(function(f){return M(f,u.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},fe("Hands",sm),fe("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),fe("VERSION","0.4.1675469240")}).call(ju);const Wn=(...e)=>{},$r={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},Tt={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function w1({hidden:e=!1}){const t=S.useRef(null),n=S.useRef(null),r=S.useRef(null),s=S.useRef(null),[i,a]=S.useState(!1),[c,d]=S.useState("None"),[h,g]=S.useState([]),[v,w]=S.useState(null),[N,D]=S.useState(null),[T,V]=S.useState(null),[j,y]=S.useState({a:null,b:null}),k=S.useRef(null),M=S.useRef(null),b=(O,m)=>{const P=localStorage.getItem(O);if(P===null)return m;const _=parseFloat(P);return Number.isFinite(_)?_:m},[H,L]=S.useState(()=>({roiSize:(()=>{const O=b(Tt.roiSize,44);return O>10?O:44})(),hueWeight:b(Tt.hueWeight,4),satWeight:b(Tt.satWeight,2),valWeight:b(Tt.valWeight,1),sensitivity:b(Tt.sensitivity,0)})),F=S.useRef(H),z=S.useRef(null),W=S.useRef(!1),Y=S.useRef(0),q=S.useRef(null),[J,re]=S.useState([]),fe=S.useRef([]),[he,Se]=S.useState(()=>localStorage.getItem(Tt.selectedCamera)||""),se=S.useCallback(async()=>{try{const m=(await navigator.mediaDevices.enumerateDevices()).filter(P=>P.kind==="videoinput");return re(m),fe.current=m,m}catch{return[]}},[]),ne=S.useCallback(O=>{},[Wn]),Z=S.useCallback(async(O=null)=>{const m=t.current;if(!m)return;z.current&&(z.current.getTracks().forEach(C=>C.stop()),z.current=null),U();const P=++Y.current;q.current=null;const _=O!==null?O:he;try{const C=_?{video:{deviceId:{exact:_}}}:{video:!0};if(_){const X=fe.current.find(ie=>ie.deviceId===_);console.log("[Detector]  Loading SELECTED camera:",{deviceId:_,label:(X==null?void 0:X.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const I=await navigator.mediaDevices.getUserMedia(C);if(!W.current||P!==Y.current){Wn("Stale camera request (unmounted or superseded). Stopping stream."),I.getTracks().forEach(X=>X.stop());return}z.current=I;const $=I.getVideoTracks();if(Wn("getUserMedia success. Tracks:",$),$.length>0){const X=$[0];console.log("[Detector]  Camera loaded successfully:",{label:X.label,deviceId:X.getSettings().deviceId,resolution:`${X.getSettings().width}x${X.getSettings().height}`,frameRate:X.getSettings().frameRate})}if(m.srcObject=I,await new Promise(X=>{if(m.readyState>=1&&m.videoWidth>0&&m.videoHeight>0)return X();const ge=()=>{m.removeEventListener("loadedmetadata",ge),X()};m.addEventListener("loadedmetadata",ge,{once:!0}),setTimeout(()=>{m.removeEventListener("loadedmetadata",ge),X()},1500)}),!W.current||P!==Y.current){Wn("Stale request before play(). Stopping stream."),I.getTracks().forEach(X=>X.stop());return}try{await m.play(),Wn("video.play() promise resolved. Video should be playing.")}catch(X){if(console.error("[Detector] video.play() promise rejected:",X),Wn("video.play() promise rejected:",X.name,X.message),P!==Y.current){Wn("play() aborted due to newer request."),I.getTracks().forEach(ie=>ie.stop());return}}if(q.current!==P&&(q.current=P,Wn("Initializing MediaPipe for request id",P),Te()),W.current){const X=await se();if(!_||!O){const ie=X.find(ge=>ge.deviceId);ie&&ie.deviceId&&ie.deviceId!==he&&(Se(ie.deviceId),localStorage.setItem(Tt.selectedCamera,ie.deviceId))}}}catch(C){console.error("[Detector] Error accessing camera:",C),Wn("getUserMedia error:",C.name,C.message)}},[Wn,se,ne,he]),pe=(O,m,P)=>{const _=(O||0)*2,C=(m||0)/255,I=(P||0)/255,$=I*C,X=$*(1-Math.abs(_/60%2-1)),ie=I-$;let ge=0,Ce=0,Re=0;_>=0&&_<60?(ge=$,Ce=X,Re=0):_<120?(ge=X,Ce=$,Re=0):_<180?(ge=0,Ce=$,Re=X):_<240?(ge=0,Ce=X,Re=$):_<300?(ge=X,Ce=0,Re=$):(ge=$,Ce=0,Re=X);const Oe=Math.round((ge+ie)*255),nt=Math.round((Ce+ie)*255),qe=Math.round((Re+ie)*255);return`rgb(${Oe}, ${nt}, ${qe})`},ke=O=>O?pe(O.h,O.s,O.v):"#ffffff",ze=O=>O==="Player A"&&N?ke(N):O==="Player B"&&T?ke(T):O==="Red"?"#ff0000":O==="Blue"?"#0000ff":"#ffffff";S.useEffect(()=>{W.current=!0;const O=()=>{try{const _=JSON.parse(localStorage.getItem("calibrationA")||"null"),C=JSON.parse(localStorage.getItem("calibrationB")||"null");_&&D({h:_.h,s:_.s,v:_.v}),C&&V({h:C.h,s:C.s,v:C.v})}catch{}},m=_=>{!_||!_.key||(["calibrationA","calibrationB"].includes(_.key)&&O(),[Tt.roiSize,Tt.hueWeight,Tt.satWeight,Tt.valWeight,Tt.sensitivity].includes(_.key)&&L(C=>({roiSize:(()=>{const I=b(Tt.roiSize,(C==null?void 0:C.roiSize)??44);return I>10?I:(C==null?void 0:C.roiSize)??44})(),hueWeight:b(Tt.hueWeight,(C==null?void 0:C.hueWeight)??4),satWeight:b(Tt.satWeight,(C==null?void 0:C.satWeight)??2),valWeight:b(Tt.valWeight,(C==null?void 0:C.valWeight)??1),sensitivity:b(Tt.sensitivity,(C==null?void 0:C.sensitivity)??0)})))};return(async()=>{const _=await se();if(!W.current)return;const C=localStorage.getItem(Tt.selectedCamera);let I="";if(C&&_.some($=>$.deviceId&&$.deviceId===C)){const $=_.find(X=>X.deviceId===C);I=C,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:C,label:($==null?void 0:$.label)||"Unknown"})}else{C&&localStorage.removeItem(Tt.selectedCamera);const $=_.find(X=>X.deviceId);$&&$.deviceId?(I=$.deviceId,localStorage.setItem(Tt.selectedCamera,$.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:$.deviceId,label:$.label||"Unknown",savedCameraWas:C||"none"}),Wn("Saved camera not found, using default camera:",$.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}Se(I?$=>$===I?$:I:$=>$||""),O()})(),window.addEventListener("storage",m),()=>{W.current=!1,Y.current+=1,q.current=null,s.current&&(s.current.stop(),s.current=null),z.current&&(z.current.getTracks().forEach(C=>C.stop()),z.current=null);const _=t.current;_&&(_.srcObject=null,ne(_)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",m)}},[]),S.useEffect(()=>{k.current=N},[N]),S.useEffect(()=>{M.current=T},[T]),S.useEffect(()=>{F.current=H},[H]),S.useEffect(()=>{Z(he||null)},[he,Z]),S.useEffect(()=>{const O=setInterval(()=>{d(m=>(Ue(m),m))},1e3);return()=>clearInterval(O)},[]);const Ue=O=>{const P={timestamp:new Date().toISOString(),status:O};g(C=>[...C,P]);const _=JSON.parse(localStorage.getItem("braceletDetections")||"[]");_.push(P),localStorage.setItem("braceletDetections",JSON.stringify(_))},Te=async()=>{try{const O=await(async()=>{try{if(typeof gc.Hands=="function")return gc.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((P,_)=>{const C="mp-hands-cdn-script";if(document.getElementById(C))return P();const I=document.createElement("script");I.id=C,I.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",I.async=!0,I.onload=()=>P(),I.onerror=$=>_(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(I)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),m=new O({locateFile:P=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${P}`});if(m.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),m.onResults(Fe),r.current=m,t.current){const P=t.current;console.log("[Detector]  Starting manual frame capture from video element");let _;const C=async()=>{if(P.readyState>=2&&P.videoWidth>0)try{await m.send({image:P})}catch(I){console.error("[Detector] Error sending frame to MediaPipe:",I)}_=requestAnimationFrame(C)};C(),s.current={stop:()=>{_&&(cancelAnimationFrame(_),console.log("[Detector]  Stopped frame capture"))}}}}catch(O){console.error("MediaPipe initialization error:",O),w(`MediaPipe error: ${O.message}`)}},Fe=O=>{var $;const m=n.current,P=t.current;if(!m||!P)return;const _=m.getContext("2d");m.width=P.videoWidth,m.height=P.videoHeight,_.drawImage(P,0,0,m.width,m.height);let C="None";if(O.multiHandLandmarks&&O.multiHandLandmarks.length>0){Wn("onResults: hands=",O.multiHandLandmarks.length);let X=null,ie=0;if(O.multiHandLandmarks.forEach(ge=>{const Ce=ge[0];Ce.y>ie&&(ie=Ce.y,X=ge)}),O.multiHandLandmarks.forEach(ge=>{te(_,ge,m.width,m.height)}),X){const ge=X[0],Ce=ge.x*m.width,Re=ge.y*m.height;_.fillStyle="lime",_.beginPath(),_.arc(Ce,Re,10,0,2*Math.PI),_.fill(),_.fillStyle="lime",_.font="16px Arial",_.fillText("SELECTED",Ce-40,Re-15);const nt=Math.max(10,Math.min(300,Math.floor((($=F.current)==null?void 0:$.roiSize)||60)))/2,qe=Math.max(0,Ce-nt),lt=Math.max(0,Re-nt),ct=Math.min(m.width,Ce+nt),Ge=Math.min(m.height,Re+nt);_.strokeStyle="lime",_.lineWidth=3,_.strokeRect(qe,lt,ct-qe,Ge-lt);const He=ct-qe,Ve=Ge-lt;if(He>0&&Ve>0)try{const Ze=_.getImageData(qe,lt,He,Ve),Ct=k.current,On=M.current,mt=we(Ze,Ct,On);C=mt.status,y({a:mt.percentA,b:mt.percentB}),Wn("Detection result:",C,{roi:{x1:qe,y1:lt,w:He,h:Ve}})}catch(Ze){console.warn("[Detector] Failed to get ROI image data:",Ze.message),C="None",y({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:He,height:Ve}),C="None",y({a:null,b:null})}}let I="#ffffff";C==="Player A"&&k.current?I=ke(k.current):C==="Player B"&&M.current&&(I=ke(M.current)),_.fillStyle=I,_.font="bold 32px Arial",_.fillText(`Status: ${C}`,10,40),d(C),typeof window<"u"&&(window.currentBraceletStatus=C,window.braceletDetectorCanvas=m,window.braceletDetectorVideo=P)},te=(O,m,P,_)=>{O.strokeStyle="white",O.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([I,$])=>{const X=m[I],ie=m[$];O.beginPath(),O.moveTo(X.x*P,X.y*_),O.lineTo(ie.x*P,ie.y*_),O.stroke()}),m.forEach(I=>{O.fillStyle="red",O.beginPath(),O.arc(I.x*P,I.y*_,5,0,2*Math.PI),O.fill()})},ue=O=>{const m=O.data;let P=0,_=0;for(let C=0;C<m.length;C+=4){const I=m[C],$=m[C+1],X=m[C+2],ie=de(I,$,X);(ie[0]>=$r.red.lower1[0]&&ie[0]<=$r.red.upper1[0]||ie[0]>=$r.red.lower2[0]&&ie[0]<=$r.red.upper2[0])&&ie[1]>=$r.red.lower1[1]&&ie[2]>=$r.red.lower1[2]&&P++,ie[0]>=$r.blue.lower[0]&&ie[0]<=$r.blue.upper[0]&&ie[1]>=$r.blue.lower[1]&&ie[2]>=$r.blue.lower[2]&&_++}return{redCount:P,blueCount:_}},we=(O,m,P)=>{var nt,qe,lt,ct;const _=O.data;if(m&&!P)return{status:"Player A",percentA:null,percentB:null};if(P&&!m)return{status:"Player B",percentA:null,percentB:null};const C=((nt=F.current)==null?void 0:nt.hueWeight)??4,I=((qe=F.current)==null?void 0:qe.satWeight)??2,$=((lt=F.current)==null?void 0:lt.valWeight)??1,X=((ct=F.current)==null?void 0:ct.sensitivity)??0;if(m&&P){let Ge=0,He=0,Ve=0;for(let mt=0;mt<_.length;mt+=4){const Dt=_[mt],Pt=_[mt+1],tn=_[mt+2],[ln,cn,En]=de(Dt,Pt,tn),Cn=Math.min(1,Math.max(0,cn/255)),Jr=Math.min(1,Math.max(0,En/255)),Fr=Math.max(.05,.5*Cn+.5*Jr),$n=Math.min(Math.abs(ln-m.h),180-Math.abs(ln-m.h)),Dn=Math.min(Math.abs(ln-P.h),180-Math.abs(ln-P.h)),ys=Math.abs(cn-m.s),zn=Math.abs(cn-P.s),Si=Math.abs(En-m.v),jn=Math.abs(En-P.v),Ar=$n*C+ys*I+Si*$,Js=Dn*C+zn*I+jn*$;Math.min(Ar,Js)>180||(Ar<=Js?Ge+=Fr:He+=Fr,Ve+=Fr)}if(Ve===0)return{status:"None",percentA:0,percentB:0};const Ze=Ge/Math.max(1e-6,Ve),Ct=He/Math.max(1e-6,Ve),On=.12*(1+.8*Math.max(0,Math.min(1,X)));return Ze>=On&&Ze>=Ct?{status:"Player A",percentA:Ze,percentB:Ct}:Ct>=On&&Ct>Ze?{status:"Player B",percentA:Ze,percentB:Ct}:{status:"None",percentA:Ze,percentB:Ct}}const{redCount:ie,blueCount:ge}=ue(O),Ce=ie+ge;if(Ce===0)return{status:"None",percentA:0,percentB:0};const Re=ie/Ce,Oe=ge/Ce;return Re>=.15&&Re>=Oe?{status:"Player A",percentA:Re,percentB:Oe}:Oe>=.15&&Oe>Re?{status:"Player B",percentA:Re,percentB:Oe}:{status:"None",percentA:Re,percentB:Oe}},de=(O,m,P)=>{O/=255,m/=255,P/=255;const _=Math.max(O,m,P),C=Math.min(O,m,P),I=_-C;let $=0;I!==0&&(_===O?$=60*((m-P)/I%6):_===m?$=60*((P-O)/I+2):$=60*((O-m)/I+4)),$<0&&($+=360);const X=_===0?0:I/_*255,ie=_*255;return[$/2,X,ie]},U=O=>{},G=O=>{Se(O),O?localStorage.setItem(Tt.selectedCamera,O):localStorage.removeItem(Tt.selectedCamera)},Q=()=>{const O=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),m=new Blob([JSON.stringify(O,null,2)],{type:"application/json"}),P=URL.createObjectURL(m),_=document.createElement("a");_.href=P,_.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,_.click();const C=O.map(ie=>`${ie.timestamp}: ${ie.status}`).join(`
`),I=new Blob([C],{type:"text/plain"}),$=URL.createObjectURL(I),X=document.createElement("a");X.href=$,X.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,X.click()},ee=()=>{localStorage.removeItem("braceletDetections"),g([])};return l.jsx(l.Fragment,{children:l.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:Q,title:"Download Logs",children:""}),l.jsx("button",{onClick:ee,title:"Clear Logs",children:""}),l.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),l.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{children:"Camera:"}),l.jsxs("select",{value:he,onChange:O=>G(O.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[l.jsx("option",{value:"",children:"System Default"}),J.map((O,m)=>{var X;const P=!!O.deviceId,_=P?O.deviceId:"",C=P?O.deviceId:`camera-${m}`,I=((X=O.label)==null?void 0:X.trim())||`Camera ${m+1}`,$=P?`  ${O.deviceId.slice(0,8)}`:" (needs permission)";return l.jsxs("option",{value:_,disabled:!P,children:[I,$]},C)})]})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),l.jsx("canvas",{ref:n,className:"output_canvas"}),l.jsxs("div",{className:"detector-info",children:[l.jsxs("div",{className:"status-display",children:["Status: ",l.jsx("span",{style:{color:ze(c),fontWeight:700},children:c})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:N?ke(N):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:j.a==null?"":`${Math.round(Math.max(0,Math.min(1,j.a))*100)}%`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:T?ke(T):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:j.b==null?"":`${Math.round(Math.max(0,Math.min(1,j.b))*100)}%`})]})]}),l.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",N?`h${Math.round(N.h)} s${Math.round(N.s)} v${Math.round(N.v)}`:""]}),l.jsxs("div",{children:["B: ",T?`h${Math.round(T.h)} s${Math.round(T.s)} v${Math.round(T.v)}`:""]})]})]})]})]})})}const td=(...e)=>{console.log("[Calibrate]",...e)},Dr={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},hx=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,c=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,g=0,v=0;r>=0&&r<60?(h=a,g=c,v=0):r<120?(h=c,g=a,v=0):r<180?(h=0,g=a,v=c):r<240?(h=0,g=c,v=a):r<300?(h=c,g=0,v=a):(h=a,g=0,v=c);const w=Math.round((h+d)*255),N=Math.round((g+d)*255),D=Math.round((v+d)*255);return`rgb(${w}, ${N}, ${D})`},x1=e=>e?hx(e.h,e.s,e.v):"#444";function px(){const e=S.useRef(null),t=S.useRef(null),n=S.useRef(null),r=S.useRef(!1),s=S.useRef(0),[i,a]=S.useState(!1),[c,d]=S.useState(""),[h,g]=S.useState(null),[v,w]=S.useState(null),N=(te,ue)=>{const we=localStorage.getItem(te);if(we===null)return ue;const de=parseFloat(we);return Number.isFinite(de)?de:ue},[D,T]=S.useState(()=>{const te=N(Dr.roiSize,44);return te>10?te:44}),[V,j]=S.useState(()=>N(Dr.hueWeight,4)),[y,k]=S.useState(()=>N(Dr.satWeight,2)),[M,b]=S.useState(()=>N(Dr.valWeight,1)),[H,L]=S.useState(()=>N(Dr.sensitivity,0)),[F,z]=S.useState(!1),[W,Y]=S.useState("idle"),[q,J]=S.useState(5),re=S.useRef({A:[],B:[]});S.useEffect(()=>{r.current=!0;try{const te=JSON.parse(localStorage.getItem("calibrationA")||"null"),ue=JSON.parse(localStorage.getItem("calibrationB")||"null");te&&g(te),ue&&w(ue)}catch{}return(async()=>await fe())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(ue=>ue.stop()),n.current=null);const te=e.current;te&&(te.srcObject=null)}},[]),S.useEffect(()=>{localStorage.setItem(Dr.roiSize,String(D))},[D]),S.useEffect(()=>{localStorage.setItem(Dr.hueWeight,String(V))},[V]),S.useEffect(()=>{localStorage.setItem(Dr.satWeight,String(y))},[y]),S.useEffect(()=>{localStorage.setItem(Dr.valWeight,String(M))},[M]),S.useEffect(()=>{localStorage.setItem(Dr.sensitivity,String(H))},[H]);const fe=S.useCallback(async()=>{const te=e.current;if(!te)return;n.current&&(n.current.getTracks().forEach(we=>we.stop()),n.current=null);const ue=++s.current;a(!1),d("Requesting camera...");try{const we=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||ue!==s.current){we.getTracks().forEach(de=>de.stop());return}if(n.current=we,te.srcObject=we,await new Promise(de=>{if(te.readyState>=1&&te.videoWidth>0)return de();const G=()=>{te.removeEventListener("loadedmetadata",G),de()};te.addEventListener("loadedmetadata",G,{once:!0}),setTimeout(()=>{te.removeEventListener("loadedmetadata",G),de()},1500)}),!r.current||ue!==s.current){we.getTracks().forEach(de=>de.stop());return}try{await te.play(),td("video.play resolved")}catch(de){td("video.play rejected",de)}a(!0),d("")}catch(we){d(`Camera error: ${(we==null?void 0:we.message)||we}`),td("getUserMedia error",we)}},[]),he=(te,ue,we)=>{te/=255,ue/=255,we/=255;const de=Math.max(te,ue,we),U=Math.min(te,ue,we),G=de-U;let Q=0;G!==0&&(de===te?Q=60*((ue-we)/G%6):de===ue?Q=60*((we-te)/G+2):Q=60*((te-ue)/G+4)),Q<0&&(Q+=360);const ee=de===0?0:G/de*255,O=de*255;return[Q/2,ee,O]},Se=()=>{const te=e.current,ue=t.current;if(!te||!ue||te.videoWidth===0)return null;const we=te.videoWidth,de=te.videoHeight;ue.width=we,ue.height=de;const U=ue.getContext("2d");U.drawImage(te,0,0,we,de);const G=Math.max(10,Math.min(300,Math.floor(D))),Q=Math.floor(we/2-G/2),ee=Math.floor(de/2-G/2),m=U.getImageData(Q,ee,G,G).data;let P=0,_=0,C=0,I=0,$=0;for(let qe=0;qe<m.length;qe+=4){const[lt,ct,Ge]=he(m[qe],m[qe+1],m[qe+2]),He=lt*2*(Math.PI/180);P+=Math.cos(He),_+=Math.sin(He),C+=ct,I+=Ge,$++}if($===0)return null;const X=C/$,ie=I/$,ge=P/$,Ce=_/$;let Oe=Math.atan2(Ce,ge)*(180/Math.PI);return Oe<0&&(Oe+=360),{h:Oe/2,s:X,v:ie}},se=te=>{const ue=Se();if(!ue){d("Could not sample video frame.");return}te==="A"?(localStorage.setItem("calibrationA",JSON.stringify(ue)),g(ue),d(`Saved Player A: h${ue.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(ue)),w(ue),d(`Saved Player B: h${ue.h.toFixed(0)}`))},ne=te=>{te==="A"?(localStorage.removeItem("calibrationA"),g(null)):(localStorage.removeItem("calibrationB"),w(null)),d("Cleared")},Z=()=>{z(!0),Y("playerA"),J(5),re.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};S.useEffect(()=>{if(!(!F||W==="idle"||W==="optimizing"||W==="complete"))if(q>0){const te=setTimeout(()=>{J(q-1)},1e3);return()=>clearTimeout(te)}else W==="playerA"?(Y("switching"),J(3),d("Switch to Player B... Get ready!")):W==="switching"?(Y("playerB"),J(5),d("Hold Player B bracelet in center square...")):W==="playerB"&&(Y("optimizing"),pe())},[F,W,q]),S.useEffect(()=>{if(!F||W==="idle"||W==="switching"||W==="optimizing"||W==="complete")return;const te=setInterval(()=>{const ue=Se();ue&&(W==="playerA"?re.current.A.push(ue):W==="playerB"&&re.current.B.push(ue))},200);return()=>clearInterval(te)},[F,W]);const pe=()=>{d("Optimizing parameters...");const te=re.current.A,ue=re.current.B;if(te.length===0||ue.length===0){d("Error: Not enough samples collected!"),z(!1),Y("idle");return}const we=ke(te),de=ke(ue),U=Math.min(Math.abs(we.h-de.h),180-Math.abs(we.h-de.h)),G=Math.abs(we.s-de.s),Q=Math.abs(we.v-de.v),ee=U/90,O=G/255,m=Q/255,P=ze(te),_=ze(ue),C={h:(P.h+_.h)/2,s:(P.s+_.s)/2,v:(P.v+_.v)/2},I=ee+O+m,$=I>0?ee/I*(1/(1+C.h/20))*6:2,X=I>0?O/I*(1/(1+C.s/50))*4:1,ie=I>0?m/I*(1/(1+C.v/50))*3:.5;j(Math.max(.5,Math.min(6,$))),k(Math.max(.1,Math.min(4,X))),b(Math.max(.1,Math.min(3,ie)));const ge=Ue(te,ue,we,de),Ce=Math.max(0,Math.min(.8,ge*.5));L(Ce),localStorage.setItem("calibrationA",JSON.stringify(we)),localStorage.setItem("calibrationB",JSON.stringify(de)),g(we),w(de),Y("complete"),d(` Auto-calibration complete! Collected ${te.length+ue.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{z(!1),Y("idle")},3e3)},ke=te=>{const ue=te.map(_=>_.h),we=te.map(_=>_.s).sort((_,C)=>_-C),de=te.map(_=>_.v).sort((_,C)=>_-C);let U=0,G=0;ue.forEach(_=>{const C=_*2*(Math.PI/180);U+=Math.cos(C),G+=Math.sin(C)});let ee=Math.atan2(G/ue.length,U/ue.length)*(180/Math.PI);ee<0&&(ee+=360);const O=ee/2,m=we[Math.floor(we.length/2)],P=de[Math.floor(de.length/2)];return{h:O,s:m,v:P}},ze=te=>{const ue=te.reduce((de,U)=>({h:de.h+U.h,s:de.s+U.s,v:de.v+U.v}),{h:0,s:0,v:0});ue.h/=te.length,ue.s/=te.length,ue.v/=te.length;const we=te.reduce((de,U)=>({h:de.h+Math.pow(U.h-ue.h,2),s:de.s+Math.pow(U.s-ue.s,2),v:de.v+Math.pow(U.v-ue.v,2)}),{h:0,s:0,v:0});return{h:we.h/te.length,s:we.s/te.length,v:we.v/te.length}},Ue=(te,ue,we,de)=>{let U=0;const G=Math.min(te.length,ue.length)*2;return te.forEach(Q=>{const ee=Te(Q,we);Te(Q,de)<ee*1.5&&U++}),ue.forEach(Q=>{const ee=Te(Q,we),O=Te(Q,de);ee<O*1.5&&U++}),U/G},Te=(te,ue)=>{const we=Math.min(Math.abs(te.h-ue.h),180-Math.abs(te.h-ue.h)),de=Math.abs(te.s-ue.s),U=Math.abs(te.v-ue.v);return Math.sqrt(we*we+de*de+U*U)},Fe=()=>{z(!1),Y("idle"),J(5),d("Generic mode cancelled")};return l.jsxs("div",{className:"calib-root",children:[l.jsxs("div",{className:"calib-header",children:[l.jsx("h2",{children:"Color Calibration"}),l.jsxs("div",{className:"calib-actions",children:[l.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),l.jsx("button",{onClick:fe,children:"Restart Camera"})]})]}),c&&l.jsx("div",{className:"calib-message",children:c}),l.jsxs("div",{className:"calib-content",children:[l.jsx("div",{children:l.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[l.jsx("div",{className:"label",children:"Live Preview"}),l.jsx("div",{className:"value",style:{marginBottom:8},children:F?`Generic Mode Active: ${W==="playerA"?"Player A":W==="switching"?"Switching...":W==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),l.jsxs("div",{className:"calib-video-wrap",children:[l.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),l.jsx("div",{className:"calib-center-box",style:{width:D,height:D,borderColor:"#22d3ee",borderWidth:F?"4px":"3px",boxShadow:F?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),F&&q>0&&l.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:q})]})]})}),l.jsxs("div",{className:"calib-controls",children:[l.jsxs("div",{className:"calib-block",style:{background:F?"#1a2332":"#0f172a",border:F?"2px solid #22d3ee":"1px solid #1f2937"},children:[l.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),l.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),F?l.jsxs("div",{style:{marginTop:8},children:[l.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[W==="playerA"&&`Player A: Hold bracelet steady... ${q}s`,W==="switching"&&`Switch hands! Get Player B ready... ${q}s`,W==="playerB"&&`Player B: Hold bracelet steady... ${q}s`,W==="optimizing"&&"Optimizing parameters...",W==="complete"&&" Complete!"]}),l.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[W==="playerA"&&`Samples collected: ${re.current.A.length}`,W==="switching"&&`Player A: ${re.current.A.length} samples collected`,W==="playerB"&&`Samples collected: ${re.current.B.length}`]}),W!=="complete"&&l.jsx("button",{onClick:Fe,style:{background:"#ef4444"},children:"Cancel"})]}):l.jsx("div",{className:"buttons",children:l.jsx("button",{onClick:Z,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Detector Settings"}),l.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Detection square size"}),l.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:D,onChange:te=>T(Number(te.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[D,"px"]})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Hue weight"}),l.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:V,onChange:te=>j(Number(te.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:V.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Saturation weight"}),l.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:y,onChange:te=>k(Number(te.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:y.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Value weight"}),l.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:M,onChange:te=>b(Number(te.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:M.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:H,onChange:te=>L(Number(te.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[(H*100).toFixed(0),"%"]})]}),l.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player A"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:x1(h)}}),l.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>se("A"),disabled:!i,children:"Save A"}),l.jsx("button",{onClick:()=>ne("A"),children:"Clear A"})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player B"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:x1(v)}}),l.jsx("span",{children:v?`h${v.h.toFixed(0)} s${v.s.toFixed(0)} v${v.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>se("B"),disabled:!i,children:"Save B"}),l.jsx("button",{onClick:()=>ne("B"),children:"Clear B"})]})]})]})]}),l.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function ey({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var O;const[a,c]=S.useState(e),[d,h]=S.useState(0),[g,v]=S.useState(!1),[w,N]=S.useState(1),[D,T]=S.useState(ma()),[V,j]=S.useState(!0),[y,k]=S.useState([]),[M,b]=S.useState(null),[H,L]=S.useState(!1),F=S.useRef(null),z=S.useRef(null),W=S.useRef(null),Y=n&&!e,q=["summary-container",r].filter(Boolean).join(" "),J=(m,P)=>{const _=W.current;if(!_)return 0;const C=_.offsetHeight;return(m+.5)*C},re=S.useCallback((m,P=null)=>{const _=P||a;if(!_)return;let C=ma(),I=!0;const $=[];let X=null;for(let ie=0;ie<=m&&ie<_.moves.length;ie++){const ge=_.moves[ie];ge.phase==="experiment"&&I&&(I=!1,C=ma());const Ce=ge.all_positions||(ge.allPositions?ge.allPositions.map(Re=>[Re[0]*.07,Re[1]*.07]):null);if(ge.type==="moveblock"&&Ce)Ce.length===10&&C.length===10?C=C.map((Re,Oe)=>{const nt=Ce[Oe];return nt&&Array.isArray(nt)&&nt.length===2?{...Re,position:[nt[0],nt[1]]}:Re}):console.warn(`Position count mismatch: blocks=${C.length}, positions=${Ce==null?void 0:Ce.length}`),C=pf(hf(C),I),X=ge.blockId!==void 0?ge.blockId:ge.unit;else if(ge.type==="added shape to gallery"&&ge.gallery_normalized){const Re=document.createElement("canvas");Re.width=400,Re.height=400;const Oe=Re.getContext("2d");Oe.fillStyle="#000",Oe.fillRect(0,0,400,400),ge.gallery_normalized.forEach(nt=>{const qe=(nt[0]+.5)*400,lt=(nt[1]+.5)*400;Oe.fillStyle="green";const ct=60;Oe.fillRect(qe-ct/2,lt-ct/2,ct,ct)}),$.push({number:ge.gallery_shape_number,image:Re.toDataURL()}),X=null}}T(C),j(I),k($),b(X)},[a]),fe=m=>{c(m),h(0),v(!1),setTimeout(()=>{re(0,m)},0)},he=m=>{if(!Y)return;const P=m.target.files[0];if(!P)return;const _=new FileReader;_.onload=C=>{try{const I=JSON.parse(C.target.result);fe(I)}catch(I){alert("Failed to parse JSON file: "+I.message)}},_.readAsText(P)};S.useEffect(()=>{e&&fe(e)},[e]),S.useEffect(()=>{a&&d>=0&&re(d)},[a,d,re]),S.useEffect(()=>{const m=()=>{a&&d>=0&&setTimeout(()=>{re(d)},100)};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[a,d,re]);const Se=m=>{a&&(m<0||m>=a.moves.length||(re(m),h(m)))},se=()=>{if(!a||g)return;v(!0),h(0),re(0);let m=0;z.current=setInterval(()=>{if(m>=a.moves.length){ne();return}m++,re(m),h(m)},1e3/w)},ne=()=>{z.current&&(clearInterval(z.current),z.current=null),v(!1)};if(S.useEffect(()=>()=>{z.current&&clearInterval(z.current)},[]),S.useEffect(()=>{if(g&&z.current){clearInterval(z.current),z.current=null;const m=d;h(0),v(!1),setTimeout(()=>{h(m),se()},0)}},[w]),!a)return Y?l.jsx("div",{className:q,children:l.jsxs("div",{className:"summary-upload",children:[l.jsx("h1",{children:t}),l.jsx("p",{children:"Load a game session JSON file to view the replay"}),l.jsx("input",{ref:F,type:"file",accept:".json",onChange:he,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var m;return(m=F.current)==null?void 0:m.click()},children:"Load JSON File"})]})}):null;const Z=a.moves[d],pe=a.moves.length,ke=((O=a.summary)==null?void 0:O.movesByPlayer)||{},ze=Object.entries(ke||{}),Ue=(m,P=1)=>Number.isFinite(m)?m.toFixed(P):"",Te=a.sessionInfo||{},Fe=Te.subjectId||Te.id||a.subjectId||a.id||null,te=Te.sessionGameId||a.sessionGameId||Fe||null,ue=Te.condition||a.condition||null,we=a.startTime||Te.startedAt||Te.date||null,de=a.endTime||Te.endedAt||null,U=m=>{if(!m)return null;try{const P=new Date(m);if(!Number.isNaN(P.getTime()))return P.toLocaleString()}catch{}return m},G=[];te&&G.push({label:"Session ID",value:te}),Fe&&Fe!==te&&G.push({label:"Participant",value:Fe}),ue&&G.push({label:"Condition",value:ue});const Q=U(we);Q&&G.push({label:"Start",value:Q});const ee=U(de);return ee&&G.push({label:"End",value:ee}),l.jsxs("div",{className:q,children:[l.jsxs("div",{className:"summary-header",children:[l.jsx("h1",{children:t}),G.length>0&&l.jsx("div",{className:"summary-session-info",children:G.map(m=>l.jsxs("div",{className:"summary-session-info-item",children:[l.jsx("span",{className:"summary-session-info-label",children:m.label}),l.jsx("span",{className:"summary-session-info-value",children:m.value})]},`${m.label}-${m.value}`))})]}),l.jsxs("div",{className:"summary-main",children:[l.jsxs("div",{className:"summary-left",children:[l.jsx("div",{className:"summary-game-area",children:l.jsxs("div",{className:"game-canvas",ref:W,children:[l.jsx("div",{className:"gallery",children:l.jsx("div",{className:"gallery-frame",children:y.length>0?l.jsx("img",{src:y[y.length-1].image,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),D.map((m,P)=>{const _=m.position||[0,0];return!Array.isArray(_)||_.length!==2||!Number.isFinite(_[0])||!Number.isFinite(_[1])?(console.warn(`Invalid position for block ${m.id}:`,_),null):l.jsx("div",{className:`block ${m.canMove?"movable":""} ${m.id===M?"highlighted":""}`,style:{left:`${J(_[0])}px`,top:`${J(_[1])}px`,backgroundColor:m.color||"green",cursor:m.canMove?"grab":"default",zIndex:m.id===M?20:P+1}},m.id)})]})}),l.jsxs("div",{className:"summary-progress",children:[l.jsx("input",{type:"range",min:"0",max:Math.max(0,pe-1),value:d,onChange:m=>Se(parseInt(m.target.value)),style:{width:"100%"}}),l.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",pe,Z&&l.jsxs("span",{className:"move-info",children:[" "," Player: ",Z.player,Array.isArray(Z.position)&&Z.position.length===2&&`  Position: (${Z.position[0]}, ${Z.position[1]})`,Number.isFinite(Z.holdTime)&&`  Hold: ${Ue(Z.holdTime,2)}s`," "," Time: ",Ue(Z.elapsed,1),"s"]})]})]})]}),l.jsxs("div",{className:"summary-right",children:[l.jsxs("div",{className:"summary-stats",children:[l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Duration"}),l.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),l.jsx("span",{className:"summary-stats-value",children:pe})]}),l.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[l.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),l.jsx("div",{className:"summary-stats-value",children:ze.length===0?l.jsx("span",{children:""}):ze.map(([m,P])=>l.jsxs("div",{children:[m,": ",P]},m))})]})]}),l.jsxs("div",{className:"summary-controls",children:[l.jsx("button",{onClick:()=>Se(0),disabled:d===0,children:" First"}),l.jsx("button",{onClick:()=>Se(d-1),disabled:d===0,children:" Previous"}),l.jsx("button",{onClick:g?ne:se,children:g?" Pause":" Play"}),l.jsx("button",{onClick:()=>Se(d+1),disabled:d>=pe-1,children:" Next"}),l.jsx("button",{onClick:()=>Se(pe-1),disabled:d>=pe-1,children:" Last"}),l.jsxs("div",{className:"speed-control",children:[l.jsx("label",{children:"Speed:"}),l.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:w,onChange:m=>N(parseFloat(m.target.value))}),l.jsxs("span",{children:[w,"x"]})]}),Y&&l.jsxs(l.Fragment,{children:[l.jsx("input",{ref:F,type:"file",accept:".json",onChange:he,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var m;return(m=F.current)==null?void 0:m.click()},children:" Load New File"})]})]}),l.jsxs("div",{className:"summary-moves-list",children:[l.jsxs("div",{className:"move-list-header",children:[l.jsx("h2",{children:"Move History"}),i&&l.jsx("button",{className:`edit-mode-toggle ${H?"active":""}`,onClick:()=>L(!H),children:H?" Done Editing":"Edit Players"})]}),l.jsx("div",{className:"moves-scroll",children:a.moves.map((m,P)=>l.jsxs("div",{className:`move-item ${P===d?"active":""} ${H?"edit-mode":""}`,onClick:()=>!H&&Se(P),children:[l.jsx("div",{className:"move-number",children:P+1}),m.camera_frame&&l.jsx("div",{className:"move-camera-frame",children:l.jsx("img",{src:m.camera_frame,alt:`Camera frame for move ${P+1}`,className:"camera-frame-thumbnail"})}),l.jsxs("div",{className:"move-details",children:[l.jsx("div",{className:"move-type",children:m.type}),H&&i?l.jsxs("div",{className:"move-player-edit",children:[l.jsx("label",{children:"Player:"}),l.jsxs("select",{value:m.player||"Unknown",onChange:_=>{const C=_.target.value;i(m._id,C)},onClick:_=>_.stopPropagation(),children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):l.jsxs("div",{className:"move-player",children:["Player: ",m.player]}),m.blockId!==null&&m.blockId!==void 0||m.unit!==null&&m.unit!==void 0?l.jsxs("div",{className:"move-unit",children:["Block: ",m.blockId!==void 0?m.blockId:m.unit]}):null,Array.isArray(m.position)&&m.position.length===2&&l.jsxs("div",{className:"move-position",children:["Position: (",m.position[0],", ",m.position[1],")"]}),Number.isFinite(m.holdTime)&&m.holdTime>0&&l.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",Ue(m.holdTime,2),"s"]}),l.jsxs("div",{className:"move-time",children:["Time: ",Ue(m.elapsed,1),"s"]})]})]},P))})]})]})]})]})}const Qt=(...e)=>{console.log("[Detector2]",...e)},gn={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function mx(){const e=S.useRef(null),t=S.useRef(null),n=S.useRef(null),r=S.useRef(null),s=S.useRef(null),i=S.useRef(null),a=S.useRef(null),c=S.useRef(null),d=S.useRef(null),[h,g]=S.useState(""),[v,w]=S.useState(!1),[N,D]=S.useState({camA:"None",camB:"None",merged:"None"}),[T,V]=S.useState(!0),[j,y]=S.useState(null),[k,M]=S.useState(null),b=S.useRef(null),H=S.useRef(null),L=(m,P)=>{const _=localStorage.getItem(m);if(_===null)return P;const C=parseFloat(_);return Number.isFinite(C)?C:P},[F,z]=S.useState(()=>({roiSize:(()=>{const m=L(gn.roiSize,44);return m>10?m:44})(),hueWeight:L(gn.hueWeight,4),satWeight:L(gn.satWeight,2),valWeight:L(gn.valWeight,1),sensitivity:L(gn.sensitivity,0)})),W=S.useRef(F),[Y,q]=S.useState([]),[J,re]=S.useState(""),[fe,he]=S.useState("");S.useEffect(()=>{let m=!0;(async()=>{try{const I=(await navigator.mediaDevices.enumerateDevices()).filter(X=>X.kind==="videoinput");if(I.length===0){g("No cameras found");return}q(I);const $=I.slice(0,2).map(X=>X.deviceId);re($[0]||""),he($[1]||$[0]||""),await Se($[0],e,c),$[1]?await Se($[1],t,d):await Se($[0],t,d),await Ue(),await Te("A",e,i),await Te("B",t,a)}catch(C){if(!m)return;g((C==null?void 0:C.message)||String(C))}})();const P=()=>{try{const C=JSON.parse(localStorage.getItem("calibrationA")||"null"),I=JSON.parse(localStorage.getItem("calibrationB")||"null");C&&y({h:C.h,s:C.s,v:C.v}),I&&M({h:I.h,s:I.s,v:I.v})}catch{Qt("No existing calibrations")}};P();const _=C=>{!C||!C.key||(["calibrationA","calibrationB"].includes(C.key)&&P(),[gn.roiSize,gn.hueWeight,gn.satWeight,gn.valWeight,gn.sensitivity].includes(C.key)&&z(I=>({roiSize:(()=>{const $=L(gn.roiSize,(I==null?void 0:I.roiSize)??44);return $>10?$:(I==null?void 0:I.roiSize)??44})(),hueWeight:L(gn.hueWeight,(I==null?void 0:I.hueWeight)??4),satWeight:L(gn.satWeight,(I==null?void 0:I.satWeight)??2),valWeight:L(gn.valWeight,(I==null?void 0:I.valWeight)??1),sensitivity:L(gn.sensitivity,(I==null?void 0:I.sensitivity)??0)})))};return window.addEventListener("storage",_),()=>{if(m=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),c.current&&(c.current.getTracks().forEach($=>$.stop()),c.current=null),d.current&&(d.current.getTracks().forEach($=>$.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const C=e.current;C&&(C.srcObject=null);const I=t.current;I&&(I.srcObject=null),window.removeEventListener("storage",_)}},[]);const Se=async(m,P,_)=>{const C={video:{deviceId:{exact:m}}};Qt("Starting camera with deviceId:",m);const I=await navigator.mediaDevices.getUserMedia(C);_.current=I;const $=P.current;if(!$){Qt("Video element not found!");return}$.srcObject=I,Qt("Stream assigned to video element, waiting for metadata..."),await new Promise(X=>{if($.readyState>=2&&$.videoWidth>0&&$.videoHeight>0)return Qt("Video already ready:",$.videoWidth,"x",$.videoHeight),X();const ge=()=>{Qt("loadedmetadata event fired:",$.videoWidth,"x",$.videoHeight),$.removeEventListener("loadedmetadata",ge),X()};$.addEventListener("loadedmetadata",ge,{once:!0}),setTimeout(()=>{Qt("Metadata timeout - proceeding anyway"),$.removeEventListener("loadedmetadata",ge),X()},2e3)});try{await $.play(),Qt("Video play() succeeded")}catch(X){Qt("Video play() failed:",X)}},se=S.useRef(null),ne=S.useRef(null),Z=S.useRef(null),pe=S.useRef(!1),ke=async()=>{if(!pe.current){pe.current=!0;try{for(;ne.current||Z.current;){const m=s.current;if(!m)break;let P=null,_=null;if(ne.current?(P="A",_=ne.current,ne.current=null):Z.current&&(P="B",_=Z.current,Z.current=null),!!_){se.current=P;try{await m.send({image:_})}catch(C){console.error("[Detector2] hands.send error:",C);break}}}}finally{pe.current=!1}}},ze=(m,P)=>{m==="A"?ne.current=P:Z.current=P,Promise.resolve().then(ke)},Ue=async()=>{if(s.current)return s.current;try{const m=await(async()=>{try{if(typeof gc.Hands=="function")return gc.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const _=document.getElementById("mp-hands-cdn-script");if(_&&(await new Promise(C=>{if(window.Hands&&typeof window.Hands=="function")return C();const I=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(I),C())},50);setTimeout(()=>{clearInterval(I),C()},3e3)}),window.Hands&&typeof window.Hands=="function")||(_||await new Promise((C,I)=>{const $=document.createElement("script");$.id="mp-hands-cdn-script",$.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",$.async=!0,$.onload=()=>C(),$.onerror=X=>I(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild($)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),P=new m({locateFile:_=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${_}`});return P.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),P.onResults(_=>{const C=se.current;C==="A"?ue(_):C==="B"&&we(_)}),s.current=P,P}catch(m){return console.error("MediaPipe initialization error:",m),g(`MediaPipe error: ${m.message}`),null}},Te=async(m,P,_)=>{if(!await Ue())return;const I=P.current;if(!I){Qt(`Video ref for ${m} not found`);return}Qt(`Initializing manual frame capture for camera ${m}, video dimensions:`,I.videoWidth,"x",I.videoHeight);let $=null;const X=()=>{const ie=P.current;ie&&ie.readyState>=2&&ie.videoWidth>0&&ze(m,ie),$=requestAnimationFrame(X)};$=requestAnimationFrame(X),_.current={stop:()=>{$&&(cancelAnimationFrame($),$=null,Qt(`Stopped manual frame capture for camera ${m}`))}},Qt(`Manual frame capture started for camera ${m}`)},Fe=S.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),te=S.useRef({wristY:null,player:"None",landmarks:null,wristX:null});S.useEffect(()=>{b.current=j},[j]),S.useEffect(()=>{H.current=k},[k]),S.useEffect(()=>{W.current=F},[F]);const ue=m=>de(m,n,"A"),we=m=>de(m,r,"B"),de=(m,P,_)=>{var ct;const C=P.current;if(!C)return;const I=C.getContext("2d");if(!I)return;const $=_==="A"?e.current:t.current;if(!$||$.videoWidth===0||$.videoHeight===0){_==="A"?Fe.current={wristY:null,wristX:null,landmarks:null,player:"None"}:te.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}C.width=$.videoWidth,C.height=$.videoHeight,I.drawImage($,0,0,C.width,C.height),I.fillStyle="rgba(0, 0, 0, 0.6)",I.fillRect(C.width-80,5,75,20),I.fillStyle="white",I.font="bold 14px Arial",I.fillText(`Camera ${_}`,C.width-75,20);let X=null,ie=null,ge=null,Ce=[];if(m.multiHandLandmarks&&m.multiHandLandmarks.length>0)for(const Ge of m.multiHandLandmarks){const He=Ge[0],Ve=He.x*C.width,Ze=He.y*C.height;Ce.push({x:Ve,y:Ze,landmarks:Ge}),(X===null||(T?Ze<X:Ze>X))&&(X=Ze,ie=Ge,ge=Ve)}Ce.forEach(({x:Ge,y:He})=>{I.fillStyle="orange",I.beginPath(),I.arc(Ge,He,8,0,Math.PI*2),I.fill()});let Re="None";if(ie){I.fillStyle="lime",I.beginPath(),I.arc(ge,X,10,0,2*Math.PI),I.fill(),I.fillStyle="lime",I.font="16px Arial",I.fillText("SELECTED",ge-40,X-15);const He=Math.max(10,Math.min(300,Math.floor(((ct=W.current)==null?void 0:ct.roiSize)||60)))/2,Ve=Math.max(0,ge-He),Ze=Math.max(0,X-He),Ct=Math.min(C.width,ge+He),On=Math.min(C.height,X+He),mt=Math.max(0,Math.floor(Ve)),Dt=Math.max(0,Math.floor(Ze));let Pt=Math.floor(Ct-Ve),tn=Math.floor(On-Ze);if(Pt=Math.max(1,Pt),tn=Math.max(1,tn),Pt=Math.min(Pt,C.width-mt),tn=Math.min(tn,C.height-Dt),Pt>0&&tn>0){I.strokeStyle="lime",I.lineWidth=3,I.strokeRect(mt,Dt,Pt,tn);try{const ln=I.getImageData(mt,Dt,Pt,tn),cn=b.current,En=H.current;Re=G(ln,cn,En).status}catch(ln){console.warn("[Detector2] ROI sampling failed:",ln),Re="None"}}else Qt("ROI skipped due to zero width/height",{width:Pt,height:tn,left:mt,top:Dt})}if(Ce.length>=1){let Ge=Ce[0].y,He=Ce[0].y;Ce.forEach(Ct=>{Ct.y<Ge&&(Ge=Ct.y),Ct.y>He&&(He=Ct.y)}),I.strokeStyle="yellow",I.setLineDash([6,4]),I.beginPath(),I.moveTo(0,T?Ge:He),I.lineTo(C.width,T?Ge:He),I.stroke(),I.strokeStyle="cyan",I.beginPath(),I.moveTo(0,T?He:Ge),I.lineTo(C.width,T?He:Ge),I.stroke(),I.setLineDash([]);const Ve=T?"A (top)":"A (bottom)",Ze=T?"B (bottom)":"B (top)";I.fillStyle="lime",I.font="16px Arial",I.fillText(Ve,6,Math.max(14,(T?Ge:He)-6)),I.fillStyle="dodgerblue",I.fillText(Ze,6,Math.min(C.height-6,(T?He:Ge)+18))}const Oe={wristY:X,wristX:ge,landmarks:ie,player:Re};_==="A"?Fe.current=Oe:te.current=Oe;const nt=Fe.current.wristY,qe=te.current.wristY;let lt="None";if(nt!=null||qe!=null){const Ge=T?(Ve,Ze)=>Ve==null?Ze:Math.min(Ve,Ze):(Ve,Ze)=>Ve==null?Ze:Math.max(Ve,Ze);[nt,qe].filter(Ve=>Ve!=null).reduce(Ge,null)===nt?lt=Fe.current.player:lt=te.current.player}D({camA:Fe.current.player,camB:te.current.player,merged:lt})},U=(m,P,_)=>{m/=255,P/=255,_/=255;const C=Math.max(m,P,_),I=Math.min(m,P,_),$=C-I;let X=0;$!==0&&(C===m?X=60*((P-_)/$%6):C===P?X=60*((_-m)/$+2):X=60*((m-P)/$+4)),X<0&&(X+=360);const ie=C===0?0:$/C*255,ge=C*255;return[X/2,ie,ge]},G=(m,P,_)=>{var ge,Ce,Re,Oe;const C=m.data;if(P&&!_)return{status:"Player A",percentA:null,percentB:null};if(_&&!P)return{status:"Player B",percentA:null,percentB:null};const I=((ge=W.current)==null?void 0:ge.hueWeight)??4,$=((Ce=W.current)==null?void 0:Ce.satWeight)??2,X=((Re=W.current)==null?void 0:Re.valWeight)??1,ie=((Oe=W.current)==null?void 0:Oe.sensitivity)??0;if(P&&_){let nt=0,qe=0,lt=0;for(let Ve=0;Ve<C.length;Ve+=4){const Ze=C[Ve],Ct=C[Ve+1],On=C[Ve+2],[mt,Dt,Pt]=U(Ze,Ct,On),tn=Math.min(1,Math.max(0,Dt/255)),ln=Math.min(1,Math.max(0,Pt/255)),cn=Math.max(.05,.5*tn+.5*ln),En=Math.min(Math.abs(mt-P.h),180-Math.abs(mt-P.h)),Cn=Math.min(Math.abs(mt-_.h),180-Math.abs(mt-_.h)),Jr=Math.abs(Dt-P.s),Fr=Math.abs(Dt-_.s),$n=Math.abs(Pt-P.v),Dn=Math.abs(Pt-_.v),ys=En*I+Jr*$+$n*X,zn=Cn*I+Fr*$+Dn*X;Math.min(ys,zn)>180||(ys<=zn?nt+=cn:qe+=cn,lt+=cn)}if(lt===0)return{status:"None",percentA:0,percentB:0};const ct=nt/Math.max(1e-6,lt),Ge=qe/Math.max(1e-6,lt),He=.12*(1+.8*Math.max(0,Math.min(1,ie)));return ct>=He&&ct>=Ge?{status:"Player A",percentA:ct,percentB:Ge}:Ge>=He&&Ge>ct?{status:"Player B",percentA:ct,percentB:Ge}:{status:"None",percentA:ct,percentB:Ge}}return{status:"None",percentA:0,percentB:0}},Q=(m,P,_)=>{const C=(m||0)*2,I=(P||0)/255,$=(_||0)/255,X=$*I,ie=X*(1-Math.abs(C/60%2-1)),ge=$-X;let Ce=0,Re=0,Oe=0;C>=0&&C<60?(Ce=X,Re=ie,Oe=0):C<120?(Ce=ie,Re=X,Oe=0):C<180?(Ce=0,Re=X,Oe=ie):C<240?(Ce=0,Re=ie,Oe=X):C<300?(Ce=ie,Re=0,Oe=X):(Ce=X,Re=0,Oe=ie);const nt=Math.round((Ce+ge)*255),qe=Math.round((Re+ge)*255),lt=Math.round((Oe+ge)*255);return`rgb(${nt}, ${qe}, ${lt})`},ee=m=>m?Q(m.h,m.s,m.v):"#ffffff",O=async(m,P)=>{try{if(m==="A"){if(re(P),i.current){try{i.current.stop()}catch(C){Qt("Stop camA error:",C)}i.current=null}c.current&&(c.current.getTracks().forEach(C=>C.stop()),c.current=null);const _=e.current;_&&(_.srcObject=null),await new Promise(C=>setTimeout(C,100)),await Se(P,e,c),await new Promise(C=>setTimeout(C,200)),await Ue(),await Te("A",e,i),Qt("Camera A switched to:",P)}else{if(he(P),a.current){try{a.current.stop()}catch(C){Qt("Stop camB error:",C)}a.current=null}d.current&&(d.current.getTracks().forEach(C=>C.stop()),d.current=null);const _=t.current;_&&(_.srcObject=null),await new Promise(C=>setTimeout(C,100)),await Se(P,t,d),await new Promise(C=>setTimeout(C,200)),await Ue(),await Te("B",t,a),Qt("Camera B switched to:",P)}}catch(_){console.error("[Detector2] Camera switch error:",_),g(`Camera switch error: ${_.message}`)}};return l.jsxs("div",{className:`detector-window ${v?"minimized":""}`,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:()=>w(!v),children:v?"":""}),l.jsx("button",{onClick:()=>V(!T),title:"Toggle A criterion",children:T?"A=Top":"A=Bottom"})]})]}),l.jsxs("div",{className:"detector-content",style:{display:v?"none":"block"},children:[l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera A:"}),l.jsx("select",{value:J,onChange:m=>O("A",m.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:Y.map(m=>l.jsx("option",{value:m.deviceId,children:m.label||`Camera ${m.deviceId.slice(0,8)}`},m.deviceId))})]}),l.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:n,className:"output_canvas"})]}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera B:"}),l.jsx("select",{value:fe,onChange:m=>O("B",m.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:Y.map(m=>l.jsx("option",{value:m.deviceId,children:m.label||`Camera ${m.deviceId.slice(0,8)}`},m.deviceId))})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),l.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[l.jsxs("div",{className:"status-display",children:["Merged: ",l.jsx("strong",{children:N.merged})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:j?ee(j):"#444"}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:k?ee(k):"#444"}})]})]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",j?`h${Math.round(j.h)} s${Math.round(j.s)} v${Math.round(j.v)}`:""]}),l.jsxs("div",{children:["B: ",k?`h${Math.round(k.h)} s${Math.round(k.s)} v${Math.round(k.v)}`:""]})]}),h&&l.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),l.jsxs("div",{style:{fontSize:12,marginTop:6},children:[l.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const Jo=Ga(),S1=e=>{var i,a,c,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((g,v)=>typeof v.elapsed=="number"&&v.elapsed>g?v.elapsed:g,0),r={},s={};return t.forEach(g=>{const v=(g==null?void 0:g.player)||"Unknown";r[v]=(r[v]||0)+1;const w=(g==null?void 0:g.phase)||"unknown";s[w]=(s[w]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((c=(a=e.metadata)==null?void 0:a.config)==null?void 0:c.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},gx=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},k1="adminPassword";function yx(){var Y;const[e,t]=S.useState([]),[n,r]=S.useState(!0),[s,i]=S.useState(null),[a,c]=S.useState(null),[d,h]=S.useState(null),[g,v]=S.useState(!1),[w,N]=S.useState(null),[D,T]=S.useState(!1),[V,j]=S.useState(""),[y,k]=S.useState(!1);S.useEffect(()=>{const q=localStorage.getItem(k1);q&&j(q)},[]);const M=S.useCallback(async()=>{if(!V){i("Password required"),r(!1);return}r(!0),i(null),k(!1);try{const q=await fetch(`${Jo}/sessions`,{headers:{"x-admin-password":V}});if(q.status===401||q.status===403)throw k(!0),new Error("Invalid password");if(!q.ok)throw new Error(`Failed to load sessions (${q.status})`);const J=await q.json(),re=Array.isArray(J)?J:[];localStorage.setItem(k1,V),t(re),c(fe=>fe&&re.some(he=>he.sessionGameId===fe)?fe:re.length>0?re[0].sessionGameId:null)}catch(q){console.error("[Admin] Error fetching sessions:",q),i(q.message||"Failed to load sessions"),t([]),c(null)}finally{r(!1)}},[V]);S.useEffect(()=>{M()},[M]),S.useEffect(()=>{if(!a){h(null);return}let q=!1;return(async()=>{if(V){v(!0),N(null);try{const re=await fetch(`${Jo}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":V}});if(!re.ok)throw re.status===404?new Error("Session not found"):new Error(`Failed to load session (${re.status})`);const fe=await re.json();q||h(S1(fe))}catch(re){console.error("[Admin] Error fetching session detail:",re),q||(N(re.message||"Failed to load session"),h(null))}finally{q||v(!1)}}})(),()=>{q=!0}},[a]);const b=q=>{c(q),T(!1)},H=async()=>{if(!a||!V)return;const q=!D;T(q),v(!0),N(null);try{const J=q?`${Jo}/sessions/${encodeURIComponent(a)}/experiment-only`:`${Jo}/sessions/${encodeURIComponent(a)}`,re=await fetch(J,{headers:{"x-admin-password":V}});if(!re.ok)throw new Error(`Failed to load session data (${re.status})`);const fe=await re.json();h(S1(fe))}catch(J){console.error("[Admin] Error loading session data:",J),N(J.message||"Failed to load session data"),T(!q)}finally{v(!1)}},L=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},F=()=>{if(!d)return;const q=JSON.stringify(d,null,2),J=new Blob([q],{type:"application/json"}),re=URL.createObjectURL(J),fe=document.createElement("a");fe.href=re;const he=`${a}_${new Date().toISOString().split("T")[0]}.json`;fe.download=he,fe.click(),URL.revokeObjectURL(re),console.log("[Admin] Downloaded JSON:",he)},z=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const q=new Set;d.moves.forEach(Z=>{Object.keys(Z).forEach(pe=>{pe!=="camera_frame"&&pe!=="__v"&&q.add(pe)})});const J=Array.from(q),re=[J.join(",")];d.moves.forEach(Z=>{const pe=J.map(ke=>{const ze=Z[ke];return ze==null||ze===""?"":Array.isArray(ze)||typeof ze=="object"?`"${JSON.stringify(ze).replace(/"/g,'""')}"`:`"${String(ze).replace(/"/g,'""')}"`});re.push(pe.join(","))});const fe=re.join(`
`),he=new Blob([fe],{type:"text/csv;charset=utf-8;"}),Se=URL.createObjectURL(he),se=document.createElement("a");se.href=Se;const ne=`${a}_${new Date().toISOString().split("T")[0]}.csv`;se.download=ne,se.click(),URL.revokeObjectURL(Se),console.log("[Admin] Downloaded CSV:",ne)},W=async(q,J)=>{if(!(!a||!q||!V))try{const re=await fetch(`${Jo}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(q)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":V},body:JSON.stringify({player:J})});if(!re.ok)throw new Error(`Failed to update player (${re.status})`);h(fe=>fe&&{...fe,moves:fe.moves.map(he=>he._id===q?{...he,player:J}:he)}),console.log("[Admin] Player updated:",q,J)}catch(re){console.error("[Admin] Error updating player:",re),alert("Failed to update player: "+re.message)}};return l.jsxs("div",{className:"admin-container",children:[l.jsxs("aside",{className:"admin-sidebar",children:[l.jsxs("div",{className:"admin-sidebar-header",children:[l.jsx("h1",{children:"Admin"}),l.jsxs("div",{className:"admin-password-row",children:[l.jsx("input",{type:"password",className:`admin-password-input ${y?"error":""}`,placeholder:"Password",value:V,onChange:q=>j(q.target.value),onKeyPress:q=>{q.key==="Enter"&&M()}}),l.jsx("button",{className:"admin-refresh-button",onClick:M,disabled:n||!V,children:n?"Refreshing":"Refresh"})]})]}),s&&l.jsx("div",{className:"admin-error",children:s}),l.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&l.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&l.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(q=>{const J=typeof q.movesCount=="number"?q.movesCount:Array.isArray(q.moves)?q.moves.length:0,re=q.sessionGameId===a;return l.jsxs("button",{className:`admin-session-card ${re?"active":""}`,onClick:()=>b(q.sessionGameId),children:[l.jsx("div",{className:"admin-session-id",children:q.sessionGameId}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Participant: ",q.subjectId||""]}),l.jsxs("span",{children:["Condition: ",q.condition||""]})]}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Moves: ",J]}),l.jsxs("span",{children:["Updated: ",gx(q.updatedAt)]})]})]},q.sessionGameId)})]})]}),l.jsxs("main",{className:"admin-content",children:[g&&l.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),w&&l.jsx("div",{className:"admin-error admin-error--content",children:w}),!g&&!w&&d&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"admin-toolbar",children:[l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[l.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),l.jsx("button",{className:`admin-toolbar-button experiment-toggle ${D?"active":""}`,onClick:H,title:D?"Show all moves (including practice)":"Show only experiment phase moves",children:D?"Show All Moves":"Experiment Only"}),l.jsx("button",{className:"admin-toolbar-button edit-players",onClick:L,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[l.jsx("button",{className:"admin-toolbar-button download-json",onClick:F,title:"Download session data as JSON",children:"Download JSON"}),l.jsx("button",{className:"admin-toolbar-button download-csv",onClick:z,title:"Download moves as CSV",children:"Download CSV"})]})]}),l.jsx("div",{className:"admin-summary-wrapper",children:l.jsx(ey,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((Y=d.sessionInfo)==null?void 0:Y.sessionGameId)||a||""}${D?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:W})})]}),!g&&!w&&!d&&l.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const A1="adminPassword";function vx(){const[e,t]=S.useState(null),[n,r]=S.useState(!1),[s,i]=S.useState(null),[a,c]=S.useState(null),[d,h]=S.useState(null),[g,v]=S.useState(""),[w,N]=S.useState(!1);S.useEffect(()=>{const V=localStorage.getItem(A1);V&&v(V)},[]);const D=V=>{const j=V.target.files[0];if(!j)return;if(!j.name.endsWith(".json")){c("Please select a JSON file"),t(null);return}t(j),c(null),i(null);const y=new FileReader;y.onload=k=>{var M;try{const b=JSON.parse(k.target.result);h({sessionGameId:b.sessionGameId||"N/A",subjectId:b.subjectId||"N/A",condition:b.condition||"N/A",date:b.date||"N/A",movesCount:((M=b.moves)==null?void 0:M.length)||0,hasColorA:!!b.colorA,hasColorB:!!b.colorB})}catch(b){c("Invalid JSON file: "+b.message),h(null)}},y.readAsText(j)},T=async()=>{var V;if(!e){c("Please select a file first");return}r(!0),c(null),i(null);try{const j=await new Promise((H,L)=>{const F=new FileReader;F.onload=z=>H(z.target.result),F.onerror=L,F.readAsText(e)}),y=JSON.parse(j);if(!y.sessionGameId||!y.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!g)throw new Error("Admin password is required. Please enter it below.");const k=await fetch(`${Ga()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":g},body:JSON.stringify(y)}),M=await k.json();if(k.status===401||k.status===403)throw N(!0),new Error(M.message||"Invalid admin password");if(!k.ok)throw new Error(M.message||"Upload failed");localStorage.setItem(A1,g),N(!1),i(` Successfully uploaded session "${y.sessionGameId}" with ${((V=y.moves)==null?void 0:V.length)||0} moves`),t(null),h(null);const b=document.getElementById("json-file-input");b&&(b.value="")}catch(j){c(j.message||"Failed to upload file")}finally{r(!1)}};return l.jsx("div",{className:"admin-upload-container",children:l.jsxs("div",{className:"admin-upload-card",children:[l.jsx("h1",{children:"Admin: Upload Session JSON"}),l.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),l.jsxs("div",{className:"admin-upload-form",children:[l.jsxs("div",{className:"password-input-wrapper",children:[l.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),l.jsx("input",{id:"admin-password",type:"password",value:g,onChange:V=>{v(V.target.value),N(!1)},placeholder:"Enter admin password",className:w?"error":""}),w&&l.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),l.jsxs("div",{className:"file-input-wrapper",children:[l.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:D,disabled:n}),l.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&l.jsxs("div",{className:"file-preview",children:[l.jsx("h3",{children:"File Preview"}),l.jsxs("div",{className:"preview-grid",children:[l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Condition:"})," ",d.condition]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Date:"})," ",d.date]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&l.jsxs("div",{className:"error-message",children:[l.jsx("strong",{children:"Error:"})," ",a]}),s&&l.jsx("div",{className:"success-message",children:s}),l.jsx("button",{className:"upload-button",onClick:T,disabled:!e||!g||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var gi=typeof self<"u"?self:{};function ei(){throw Error("Invalid UTF8")}function E1(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let kl,nd;const wx=typeof TextDecoder<"u";let xx;const Sx=typeof TextEncoder<"u";function ty(e){if(Sx)e=(xx||(xx=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var _h,yc;e:{for(var C1=["CLOSURE_FLAGS"],rd=gi,sd=0;sd<C1.length;sd++)if((rd=rd[C1[sd]])==null){yc=null;break e}yc=rd}var Ba,j1=yc&&yc[610401301];_h=j1!=null&&j1;const _1=gi.navigator;function mf(e){return!!_h&&!!Ba&&Ba.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function fr(e){var t;return(t=gi.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function _s(){return!!_h&&!!Ba&&Ba.brands.length>0}function id(){return _s()?mf("Chromium"):(fr("Chrome")||fr("CriOS"))&&!(!_s()&&fr("Edge"))||fr("Silk")}function Nh(e){return Nh[" "](e),e}Ba=_1&&_1.userAgentData||null,Nh[" "]=function(){};var kx=!_s()&&(fr("Trident")||fr("MSIE"));!fr("Android")||id(),id(),fr("Safari")&&(id()||!_s()&&fr("Coast")||!_s()&&fr("Opera")||!_s()&&fr("Edge")||(_s()?mf("Microsoft Edge"):fr("Edg/"))||_s()&&mf("Opera"));var ny={},sa=null;function Ax(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function c(h){for(;d<i.length;){const g=i.charAt(d++),v=sa[g];if(v!=null)return v;if(!/^[\s\xa0]*$/.test(g))throw Error("Unknown base64 encoding at char: "+g)}return h}ry();let d=0;for(;;){const h=c(-1),g=c(0),v=c(64),w=c(64);if(w===64&&h===-1)break;a(h<<2|g>>4),v!=64&&(a(g<<4&240|v>>2),w!=64&&a(v<<6&192|w))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function ry(){if(!sa){sa={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));ny[n]=r;for(let s=0;s<r.length;s++){const i=r[s];sa[i]===void 0&&(sa[i]=s)}}}}var sy=typeof Uint8Array<"u",iy=!kx&&typeof btoa=="function";function N1(e){if(!iy){var t;t===void 0&&(t=0),ry(),t=ny[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],c=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=c+s+i+a}switch(c=0,a=r,e.length-d){case 2:a=t[(15&(c=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|c>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const b1=/[-_.]/g,Ex={"-":"+",_:"/",".":"="};function Cx(e){return Ex[e]||""}function oy(e){if(!iy)return Ax(e);b1.test(e)&&(e=e.replace(b1,Cx)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function Va(e){return sy&&e!=null&&e instanceof Uint8Array}var mo={};function yi(){return jx||(jx=new os(null,mo))}function bh(e){ay(mo);var t=e.g;return(t=t==null||Va(t)?t:typeof t=="string"?oy(t):null)==null?t:e.g=t}var os=class{h(){return new Uint8Array(bh(this)||0)}constructor(e,t){if(ay(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let jx,_x;function ay(e){if(e!==mo)throw Error("illegal external caller")}function ly(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function gf(e){return ly(e=Error(e),"warning"),e}var Gc=typeof Symbol=="function"&&typeof Symbol()=="symbol",Nx=new Set;function Ya(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&Nx.add(e),e}var bx=Ya("jas",void 0,!0,!0),M1=Ya(void 0,"0di"),od=Ya(void 0,"2ex"),qo=Ya(void 0,"1oa",!0),go=Ya(void 0,Symbol(),!0);const Pe=Gc?bx:"Ga",cy={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},uy=Object.defineProperties;function Vc(e,t){Gc||Pe in e||uy(e,cy),e[Pe]|=t}function Ut(e,t){Gc||Pe in e||uy(e,cy),e[Pe]=t}function No(e){return Vc(e,34),e}function Mx(e,t){Ut(t,-30975&(0|e))}function yf(e,t){Ut(t,-30941&(34|e))}function Mh(){return typeof BigInt=="function"}function Ln(e){return Array.prototype.slice.call(e)}var Ph,Xa={},dy={};function P1(e){return!(!e||typeof e!="object"||e.Ia!==dy)}function Th(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function Ih(e,t){if(e!=null){if(typeof e=="string")e=e?new os(e,mo):yi();else if(e.constructor!==os)if(Va(e))e=e.length?new os(new Uint8Array(e),mo):yi();else{if(!t)throw Error();e=void 0}}return e}function vc(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[Pe]))}const T1=[];function Xs(e){if(2&e)throw Error()}Ut(T1,55),Ph=Object.freeze(T1);class wc{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new wc(this.g,this.h,this.m)}}function Rh(e){return go?e[go]:void 0}var Px=Object.freeze({});function Yc(e){return e.Qa=!0,e}var Tx=Yc(e=>typeof e=="number"),I1=Yc(e=>typeof e=="string"),Ix=Yc(e=>typeof e=="boolean"),Xc=typeof gi.BigInt=="function"&&typeof gi.BigInt(0)=="bigint",vf=Yc(e=>Xc?e>=Lx&&e<=Fx:e[0]==="-"?R1(e,Rx):R1(e,Bx));const Rx=Number.MIN_SAFE_INTEGER.toString(),Lx=Xc?BigInt(Number.MIN_SAFE_INTEGER):void 0,Bx=Number.MAX_SAFE_INTEGER.toString(),Fx=Xc?BigInt(Number.MAX_SAFE_INTEGER):void 0;function R1(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const Ox=typeof Uint8Array.prototype.slice=="function";let fy,ut=0,Lt=0;function L1(e){const t=e>>>0;ut=t,Lt=(e-t)/4294967296>>>0}function yo(e){if(e<0){L1(-e);const[t,n]=Oh(ut,Lt);ut=t>>>0,Lt=n>>>0}else L1(e)}function Lh(e){const t=fy||(fy=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),Lt=0,ut=t.getUint32(0,!0)}function Bh(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:Fa(e,t)}function Fh(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=Bh(e,t))=="number"?n?-e:e:n?"-"+e:e}function Fa(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else Mh()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+B1(n)+B1(e));return n}function B1(e){return e=String(e),"0000000".slice(e.length)+e}function Kc(e){if(e.length<16)yo(Number(e));else if(Mh())e=BigInt(e),ut=Number(e&BigInt(4294967295))>>>0,Lt=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");Lt=ut=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));Lt*=1e6,ut=1e6*ut+i,ut>=4294967296&&(Lt+=Math.trunc(ut/4294967296),Lt>>>=0,ut>>>=0)}if(t){const[r,s]=Oh(ut,Lt);ut=r,Lt=s}}}function Oh(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const $h=typeof BigInt=="function"?BigInt.asIntN:void 0,$x=typeof BigInt=="function"?BigInt.asUintN:void 0,no=Number.isSafeInteger,Qc=Number.isFinite,xc=Math.trunc;function Ks(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function hy(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const Dx=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Jc(e){switch(typeof e){case"bigint":return!0;case"number":return Qc(e);case"string":return Dx.test(e);default:return!1}}function bo(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Qc(e)?0|e:void 0}function py(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Qc(e)?e>>>0:void 0}function F1(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Dh(e){return e=xc(e),no(e)||(yo(e),e=Fh(ut,Lt)),e}function zh(e){var t=xc(Number(e));if(no(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if(Kc(e),e=ut,2147483648&(t=Lt))if(Mh())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=Oh(e,t);e="-"+Fa(n,r)}else e=Fa(e,t);return e}function Sc(e){return e==null?e:typeof e=="bigint"?(vf(e)?e=Number(e):(e=$h(64,e),e=vf(e)?Number(e):String(e)),e):Jc(e)?typeof e=="number"?Dh(e):zh(e):void 0}function zx(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String($x(64,e));if(Jc(e)){if(t==="string")return t=xc(Number(e)),no(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),F1(e)||(Kc(e),e=Fa(ut,Lt))),e;if(t==="number")return(e=xc(e))>=0&&no(e)?e:function(n){if(n<0){yo(n);var r=Fa(ut,Lt);return n=Number(r),no(n)?n:r}return F1(r=String(n))?r:(yo(n),Bh(ut,Lt))}(e)}}function my(e){if(typeof e!="string")throw Error();return e}function Mo(e){if(e!=null&&typeof e!="string")throw Error();return e}function vo(e){return e==null||typeof e=="string"?e:void 0}function Uh(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===Xa)return e;if(!Array.isArray(e))return n?2&r?((e=t[M1])||(No((e=new t).u),e=t[M1]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[Pe];return s===0&&(s|=32&r),s|=2&r,s!==n&&Ut(e,s),new t(e)}function Ux(e,t,n){if(t)e:{if(!Jc(t=e))throw gf("int64");switch(typeof t){case"string":t=zh(t);break e;case"bigint":if(e=t=$h(64,t),I1(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(Tx(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=Xc?BigInt(t):Ix(t)?t?"1":"0":I1(t)?t.trim()||"0":String(t);break e;default:t=Dh(t)}}else t=Sc(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&no(t=+n)?t:n}const Hx={};let Wx=function(){try{return Nh(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class ad{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const Gx=Wx?(Object.setPrototypeOf(ad.prototype,Map.prototype),Object.defineProperties(ad.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),ad):class extends Map{constructor(){super()}};function O1(e){return e}function ld(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var vr=class extends Gx{constructor(e,t,n=O1,r=O1){super();let s=0|e[Pe];s|=64,Ut(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?Vx:r;for(let i=0;i<e.length;i++){const a=e[i],c=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(c,d)}}na(e=$1){if(this.size!==0)return this.X(e)}X(e=$1){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){ld(this),super.clear()}delete(e){return ld(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new wc(e,Yx,this)}keys(){return this.Ha()}values(){var e=this.ma();return new wc(e,vr.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return ld(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Vx(e,t,n,r,s,i){return e=Uh(e,r,n,i),s&&(e=Zc(e)),e}function $1(e){return e}function Yx(e){return[e,this.get(e)]}let Xx,gy,Kx;function D1(){return Xx||(Xx=new vr(No([]),void 0,void 0,void 0,Hx))}function Hh(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=vc(e)?void 0:s&&2&(0|e[Pe])?e:Wh(e,t,n,r!==void 0,s);else if(Th(e)){const i={};for(let a in e)i[a]=Hh(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function Wh(e,t,n,r,s){const i=r||n?0|e[Pe]:0,a=r?!!(32&i):void 0;r=Ln(e);for(let c=0;c<r.length;c++)r[c]=Hh(r[c],t,n,a,s);return n&&((e=Rh(e))&&(r[go]=Ln(e)),n(i,r)),r}function Qx(e){return Hh(e,yy,void 0,void 0,!1)}function yy(e){return e.W===Xa?e.toJSON():e instanceof vr?e.na(Qx):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return vf(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(vc(t))return}else{if(Va(t))return N1(t);if(t instanceof os){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=N1(n)}if(t instanceof vr)return t.na()}}return t}(e)}function vy(e){return Wh(e,yy,void 0,void 0,!1)}function $s(e,t,n){return e=wy(e,t[0],t[1],n?1:2),t!==gy&&n&&Vc(e,16384),e}function wy(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[Pe]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(Th(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return Ut(e,s),e}function wf(e,t,n=yf){if(e!=null){if(sy&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[Pe];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?(Ut(e,-12293&(34|r)),e):Wh(e,wf,4&r?yf:n,!0,!0))}return e.W===Xa?e=2&(r=0|(n=e.u)[Pe])?e:new e.constructor(qc(n,r,!0)):e instanceof vr&&!(2&e.L)&&(n=No(e.X(wf)),e=new vr(n,e.S,e.R,e.Y)),e}}function qc(e,t,n){const r=n||2&t?yf:Mx,s=!!(32&t);return e=function(i,a,c){const d=Ln(i);var h=d.length;const g=256&a?d[h-1]:void 0;for(h+=g?-1:0,a=512&a?1:0;a<h;a++)d[a]=c(d[a]);if(g){a=d[a]={};for(const v in g)a[v]=c(g[v])}return(i=Rh(i))&&(d[go]=Ln(i)),d}(e,t,i=>wf(i,s,r)),Vc(e,32|(n?2:0)),e}function Zc(e){const t=e.u,n=0|t[Pe];return 2&n?new e.constructor(qc(t,n,!1)):e}function wo(e,t){return gs(e=e.u,0|e[Pe],t)}function gs(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&od!=null&&((s=(e=_x??(_x={}))[od]||0)>=4||(e[od]=s+1,ly(e=Error(),"incident"),function(a){gi.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function ft(e,t,n){const r=e.u;let s=0|r[Pe];return Xs(s),bt(r,s,t,n),e}function bt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},Ut(e,t|=256)):e[i]=r),t)}function Dl(e,t){let n=0|(e=e.u)[Pe];const r=gs(e,n,t),s=Ks(r);return s!=null&&s!==r&&bt(e,n,t,s),s}function xy(e){let t=0|(e=e.u)[Pe];const n=gs(e,t,1),r=Ih(n,!0);return r!=null&&r!==n&&bt(e,t,1,r),r}function oi(){return Px===void 0?2:4}function ai(e,t,n,r,s){const i=e.u,a=2&(e=0|i[Pe])?1:r;s=!!s;let c=0|(r=Gh(i,e,t))[Pe];if(!(4&c)){4&c&&(r=Ln(r),c=as(c,e),e=bt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const g=n(r[d]);g!=null&&(r[h++]=g)}h<d&&(r.length=h),c=Vh(c,e),n=-4097&(20|c),c=n&=-8193,Ut(r,c),2&c&&Object.freeze(r)}return a===1||a===4&&32&c?ss(c)||(s=c,c|=2,c!==s&&Ut(r,c),Object.freeze(r)):(a===2&&ss(c)&&(r=Ln(r),c=as(c,e),c=Ds(c,e,s),Ut(r,c),e=bt(i,e,t,r)),ss(c)||(t=c,c=Ds(c,e,s),c!==t&&Ut(r,c))),r}function Gh(e,t,n,r){return e=gs(e,t,n,r),Array.isArray(e)?e:Ph}function Vh(e,t){return e===0&&(e=as(e,t)),1|e}function ss(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function Sy(e){e=Ln(e);for(let t=0;t<e.length;t++){const n=e[t]=Ln(e[t]);Array.isArray(n[1])&&(n[1]=No(n[1]))}return e}function xf(e,t,n,r){let s=0|(e=e.u)[Pe];Xs(s),bt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function Po(e,t,n,r,s){Xs(t);var i=!(!(64&t)&&16384&t);const a=(s=Gh(e,t,n,s))!==Ph;if(i||!a){let c=i=a?0|s[Pe]:0;(!a||2&c||ss(c)||4&c&&!(32&c))&&(s=Ln(s),c=as(c,t),t=bt(e,t,n,s)),c=-13&Vh(c,t),c=Ds(r?-17&c:16|c,t,!0),c!==i&&Ut(s,c)}return s}function cd(e,t){var n=uv;return Xh(Yh(e=e.u),e,0|e[Pe],n)===t?t:-1}function Yh(e){if(Gc)return e[qo]??(e[qo]=new Map);if(qo in e)return e[qo];const t=new Map;return Object.defineProperty(e,qo,{value:t}),t}function ky(e,t,n,r){const s=Yh(e),i=Xh(s,e,t,n);return i!==r&&(i&&(t=bt(e,t,i)),s.set(n,r)),t}function Xh(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];gs(t,n,a)!=null&&(s!==0&&(n=bt(t,n,s)),s=a)}return e.set(r,s),s}function Kh(e,t,n,r){let s,i=0|e[Pe];if((r=gs(e,i,n,r))!=null&&r.W===Xa)return(t=Zc(r))!==r&&bt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[Pe];s=2&a?$s(qc(r,a,!1),t,!0):64&a?r:$s(s,t,!0)}else s=$s(void 0,t,!0);return s!==r&&bt(e,i,n,s),s}function Ay(e,t,n,r){let s=0|(e=e.u)[Pe];return(t=Uh(r=gs(e,s,n,r),t,!1,s))!==r&&t!=null&&bt(e,s,n,t),t}function tt(e,t,n,r=!1){if((t=Ay(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[Pe]))){const s=Zc(t);s!==t&&bt(e,r,n,t=s)}return t}function Ey(e,t,n,r,s,i,a){e=e.u;var c=!!(2&t);const d=c?1:s;i=!!i,a&&(a=!c);var h=0|(s=Gh(e,t,r))[Pe];if(!(c=!!(4&h))){var g=s,v=t;const w=!!(2&(h=Vh(h,t)));w&&(v|=2);let N=!w,D=!0,T=0,V=0;for(;T<g.length;T++){const j=Uh(g[T],n,!1,v);if(j instanceof n){if(!w){const y=!!(2&(0|j.u[Pe]));N&&(N=!y),D&&(D=y)}g[V++]=j}}V<T&&(g.length=V),h|=4,h=D?16|h:-17&h,Ut(g,h=N?8|h:-9&h),w&&Object.freeze(g)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(ss(h)&&(s=Ln(s),h=as(h,t),t=bt(e,t,r,s)),n=s,a=h,g=0;g<n.length;g++)(h=n[g])!==(v=Zc(h))&&(n[g]=v);a|=8,Ut(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?ss(h)||(t=h,(h|=!s.length||16&h&&(!c||32&h)?2:2048)!==t&&Ut(s,h),Object.freeze(s)):(d===2&&ss(h)&&(Ut(s=Ln(s),h=Ds(h=as(h,t),t,i)),t=bt(e,t,r,s)),ss(h)||(r=h,(h=Ds(h,t,i))!==r&&Ut(s,h))),s}function hs(e,t,n){const r=0|e.u[Pe];return Ey(e,r,t,n,oi(),!1,!(2&r))}function Ie(e,t,n,r){return r==null&&(r=void 0),ft(e,n,r)}function ga(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[Pe];if(Xs(s),r==null){const i=Yh(e);if(Xh(i,e,s,n)!==t)break e;i.set(n,0)}else s=ky(e,s,n,t);bt(e,s,t,r)}}function as(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function Ds(e,t,n){return 32&t&&n||(e&=-33),e}function kc(e,t,n,r){const s=0|e.u[Pe];Xs(s),e=Ey(e,s,n,t,2,!0),r=r??new n,e.push(r),e[Pe]=2&(0|r.u[Pe])?-9&e[Pe]:-17&e[Pe]}function pr(e,t){return bo(wo(e,t))}function wr(e,t){return vo(wo(e,t))}function Ft(e,t){return Dl(e,t)??0}function Oa(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);ft(e,t,n)}function Kr(e,t,n){if(n!=null){if(typeof n!="number"||!Qc(n))throw gf("int32");n|=0}ft(e,t,n)}function Ne(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);ft(e,t,n)}function Ac(e,t,n){{const a=e.u;let c=0|a[Pe];if(Xs(c),n==null)bt(a,c,t);else{var r=e=0|n[Pe],s=ss(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=Ln(n),r=0,e=Ds(e=as(e,c),c,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=my(d);Object.is(d,h)||(i&&(n=Ln(n),r=0,e=Ds(e=as(e,c),c,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=Ln(n),e=Ds(e=as(e,c),c,!0)),Ut(n,e)),bt(a,c,t,n)}}}function eu(e,t,n){Xs(0|e.u[Pe]),ai(e,t,vo,2,!0).push(my(n))}function Cy(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Qh(){return Error("Failed to read varint, encoding is invalid.")}function jy(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function Jh(e){if(typeof e=="string")return{buffer:oy(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===os)return{buffer:bh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function qh(e,t){let n,r=0,s=0,i=0;const a=e.h;let c=e.g;do n=a[c++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[c++],s|=(127&n)<<i;if(ui(e,c),n<128)return t(r>>>0,s>>>0);throw Qh()}function Zh(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return ui(e,n),!!(127&t)}throw Qh()}function Hs(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Qh();return ui(e,n),s}function ps(e){return Hs(e)>>>0}function Sf(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],ui(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function kf(e){var t=Sf(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function Jx(e){return Hs(e)}function ud(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=Jh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function ui(e,t){if(e.g=t,t>e.l)throw jy(e.l,t)}function _y(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw jy(t,e.l-n);return e.g=r,n}function Ny(e,t){if(t==0)return yi();var n=_y(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Ox?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?yi():new os(n,mo)}vr.prototype.toJSON=void 0,vr.prototype.Ia=dy;var z1=[];function by(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=ps(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw Cy(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function zl(e){switch(e.h){case 0:e.h!=0?zl(e):Zh(e.g);break;case 1:ui(e=e.g,e.g+8);break;case 2:if(e.h!=2)zl(e);else{var t=ps(e.g);ui(e=e.g,e.g+t)}break;case 5:ui(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!by(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}zl(e)}break;default:throw Cy(e.h,e.l)}}function Ka(e,t,n){const r=e.g.l,s=ps(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function ep(e){var t=ps(e.g),n=_y(e=e.g,t);if(e=e.h,wx){var r,s=e;(r=nd)||(r=nd=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(c){if(kl===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),kl=!0}catch{kl=!1}}throw!kl&&(nd=void 0),c}}else{t=(i=n)+t,n=[];let c,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?ei():(c=e[i++],a<194||(192&c)!=128?(i--,ei()):n.push((31&a)<<6|63&c)):a<240?i>=t-1?ei():(c=e[i++],(192&c)!=128||a===224&&c<160||a===237&&c>=160||(192&(r=e[i++]))!=128?(i--,ei()):n.push((15&a)<<12|(63&c)<<6|63&r)):a<=244?i>=t-2?ei():(c=e[i++],(192&c)!=128||c-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,ei()):(a=(7&a)<<18|(63&c)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):ei(),n.length>=8192&&(d=E1(d,n),n.length=0)}i=E1(d,n)}return i}function My(e){const t=ps(e.g);return Ny(e.g,t)}function tu(e,t,n){var r=ps(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var Al=[];function qx(e){return e}let ro;function Ir(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var _e=class{constructor(e,t){this.u=wy(e,t)}toJSON(){const e=!ro;try{return e&&(ro=vy),Py(this)}finally{e&&(ro=void 0)}}l(){var e=R5;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(qc(e,0|e[Pe],!1))}N(){return!!(2&(0|this.u[Pe]))}};function Py(e){var t=e.u;{t=(e=ro(t))!==t;let h=e.length;if(h){var n=e[h-1],r=Th(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,c=!1;if(a)for(let g in a)isNaN(+g)?(i??(i={}))[g]=a[g]:(r=a[g],Array.isArray(r)&&(vc(r)||P1(r)&&r.size===0)&&(r=null),r==null&&(c=!0),r!=null&&((i??(i={}))[g]=r));if(c||(i=a),i)for(let g in i){c=i;break e}c=null}a=c==null?n!=null:c!==n}for(;h>0&&((i=s[h-1])==null||vc(i)||P1(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||c)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),c&&s.push(c)),d=s}else d=e}return d}function U1(e){return e?/^\d+$/.test(e)?(Kc(e),new Af(ut,Lt)):null:Zx||(Zx=new Af(0,0))}_e.prototype.W=Xa,_e.prototype.toString=function(){try{return ro=qx,Py(this).toString()}finally{ro=void 0}};var Af=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Zx;function H1(e){return e?/^-?\d+$/.test(e)?(Kc(e),new Ef(ut,Lt)):null:e5||(e5=new Ef(0,0))}var Ef=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let e5;function so(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function To(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function nu(e,t){if(t>=0)To(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function $a(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function xo(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function nr(e,t,n){To(e.g,8*t+n)}function tp(e,t){return nr(e,t,2),t=e.g.end(),xo(e,t),t.push(e.h),t}function np(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function ru(e,t,n){nr(e,t,2),To(e.g,n.length),xo(e,e.g.end()),xo(e,n)}function Ec(e,t,n,r){n!=null&&(t=tp(e,t),r(n,e),np(e,t))}function Rr(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var rp=Rr(),Ty=Rr(),sp=Rr(),ip=Rr(),Iy=Rr(),Ry=Rr(),op=Rr(),Ly=Rr(),By=Rr(),Io=class{constructor(e,t,n){this.g=e,this.h=t,e=rp,this.l=!!e&&n===e||!1}};function su(e,t){return new Io(e,t,rp)}function Fy(e,t,n,r,s){Ec(e,n,zy(t,r),s)}const t5=su(function(e,t,n,r,s){return e.h===2&&(Ka(e,Kh(t,r,n),s),!0)},Fy),n5=su(function(e,t,n,r,s){return e.h===2&&(Ka(e,Kh(t,r,n,!0),s),!0)},Fy);var iu=Symbol(),ap=Symbol(),W1=Symbol(),G1=Symbol();let Oy,$y;function xi(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(v){switch(typeof v){case"boolean":return gy||(gy=[0,void 0,!0]);case"number":return v>0?void 0:v===0?Kx||(Kx=[0,void 0]):[-v,void 0];case"string":return[0,v];case"object":return v}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Oy??(Oy=i),$y??($y=r[a+1]),i=r[a+=2]));const c={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)c[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let v;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof Io?v=i:(v=t5,a--),v==null?void 0:v.l){i=r[++a],h=r;var g=a;typeof i=="function"&&(i=i(),h[g]=i),h=i}for(g=d+1,typeof(i=r[++a])=="number"&&i<0&&(g-=i,i=r[++a]);d<g;d++){const w=c[d];h?n(s,d,v,h,w):t(s,d,v,w)}}return r[e]=s}function Dy(e){return Array.isArray(e)?e[0]instanceof Io?e:[n5,e]:[e,void 0]}function zy(e,t){return e instanceof _e?e.u:Array.isArray(e)?$s(e,t,!1):void 0}function lp(e,t,n,r){const s=n.g;e[t]=r?(i,a,c)=>s(i,a,c,r):s}function cp(e,t,n,r,s){const i=n.g;let a,c;e[t]=(d,h,g)=>i(d,h,g,c||(c=xi(ap,lp,cp,r).V),a||(a=up(r)),s)}function up(e){let t=e[W1];if(t!=null)return t;const n=xi(ap,lp,cp,e);return t=n.la?(r,s)=>Oy(r,s,n):(r,s)=>{const i=0|r[Pe];for(;by(s)&&s.h!=4;){var a=s.m,c=n[a];if(c==null){var d=n.ga;d&&(d=d[a])&&(d=r5(d))!=null&&(c=n[a]=d)}c!=null&&c(s,r,a)||(a=(c=s).l,zl(c),c.fa?c=void 0:(d=c.g.g-a,c.g.g=a,c=Ny(c.g,d)),a=r,c&&((d=a[go])?d.push(c):a[go]=[c]))}return 16384&i&&No(r),!0},e[W1]=t}function r5(e){const t=(e=Dy(e))[0].g;if(e=e[1]){const n=up(e),r=xi(ap,lp,cp,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function ou(e,t,n){e[t]=n.h}function au(e,t,n,r){let s,i;const a=n.h;e[t]=(c,d,h)=>a(c,d,h,i||(i=xi(iu,ou,au,r).V),s||(s=Uy(r)))}function Uy(e){let t=e[G1];if(!t){const n=xi(iu,ou,au,e);t=(r,s)=>Hy(r,s,n),e[G1]=t}return t}function Hy(e,t,n){for(var r=0|e[Pe],s=512&r?0:-1,i=e.length,a=512&r?1:0,c=i+(256&r?-1:0);a<c;a++){const d=e[a];if(d==null)continue;const h=a-s,g=V1(n,h);g&&g(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(c=V1(n,s))&&c(t,i,s)}if(e=Rh(e))for(xo(t,t.g.end()),n=0;n<e.length;n++)xo(t,bh(e[n])||new Uint8Array(0))}function V1(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=Dy(n))[0].h;if(n=n[1]){const s=Uy(n),i=xi(iu,ou,au,n).V;n=e.la?$y(i,s):(a,c,d)=>r(a,c,d,i,s)}else n=r;return e[t]=n}}function Ro(e,t){if(Array.isArray(t)){var n=0|t[Pe];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),Ut(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function kn(e,t,n){return new Io(e,t,n)}function Lo(e,t,n){return new Io(e,t,n)}function An(e,t,n){bt(e,0|e[Pe],t,n)}var s5=su(function(e,t,n,r,s){return e.h===2&&(e=Ka(e,$s([void 0,void 0],r,!0),s),Xs(r=0|t[Pe]),(s=gs(t,r,n))instanceof vr?2&s.L?((s=s.X()).push(e),bt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[Pe])&&bt(t,r,n,s=Sy(s)),s.push(e)):bt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof vr)t.forEach((i,a)=>{Ec(e,n,$s([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&Ec(e,n,$s(a,r,!1),s)}});function Wy(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String($h(64,r));if(Jc(r)){if(s==="string")return zh(r);if(s==="number")return Dh(r)}}(t),t!=null&&(typeof t=="string"&&H1(t),t!=null))switch(nr(e,n,0),typeof t){case"number":e=e.g,yo(t),so(e,ut,Lt);break;case"bigint":n=BigInt.asUintN(64,t),n=new Ef(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),so(e.g,n.h,n.g);break;default:n=H1(t),so(e.g,n.h,n.g)}}function Gy(e,t,n){(t=bo(t))!=null&&t!=null&&(nr(e,n,0),nu(e.g,t))}function Vy(e,t,n){(t=hy(t))!=null&&(nr(e,n,0),e.g.g.push(t?1:0))}function Yy(e,t,n){(t=vo(t))!=null&&ru(e,n,ty(t))}function Xy(e,t,n,r,s){Ec(e,n,zy(t,r),s)}function Ky(e,t,n){(t=t==null||typeof t=="string"||Va(t)||t instanceof os?t:void 0)!=null&&ru(e,n,Jh(t).buffer)}function Qy(e,t,n){return(e.h===5||e.h===2)&&(t=Po(t,0|t[Pe],n,!1,!1),e.h==2?tu(e,kf,t):t.push(kf(e.g)),!0)}var es=kn(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=Sf(r);const s=Sf(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,An(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Ks(t))!=null&&(nr(e,n,1),e=e.g,(n=fy||(fy=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),ut=n.getUint32(0,!0),Lt=n.getUint32(4,!0),$a(e,ut),$a(e,Lt))},Rr()),Ht=kn(function(e,t,n){return e.h===5&&(An(t,n,kf(e.g)),!0)},function(e,t,n){(t=Ks(t))!=null&&(nr(e,n,5),e=e.g,Lh(t),$a(e,ut))},op),i5=Lo(Qy,function(e,t,n){if((t=Ro(Ks,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(nr(r,s,5),r=r.g,Lh(i),$a(r,ut))}},op),dp=Lo(Qy,function(e,t,n){if((t=Ro(Ks,t))!=null&&t.length){nr(e,n,2),To(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,Lh(t[r]),$a(n,ut)}},op),Ws=kn(function(e,t,n){return e.h===0&&(An(t,n,qh(e.g,Fh)),!0)},Wy,Ry),dd=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=qh(e.g,Fh))===0?void 0:e),!0)},Wy,Ry),o5=kn(function(e,t,n){return e.h===0&&(An(t,n,qh(e.g,Bh)),!0)},function(e,t,n){if((t=zx(t))!=null&&(typeof t=="string"&&U1(t),t!=null))switch(nr(e,n,0),typeof t){case"number":e=e.g,yo(t),so(e,ut,Lt);break;case"bigint":n=BigInt.asUintN(64,t),n=new Af(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),so(e.g,n.h,n.g);break;default:n=U1(t),so(e.g,n.h,n.g)}},Rr()),Bt=kn(function(e,t,n){return e.h===0&&(An(t,n,Hs(e.g)),!0)},Gy,ip),lu=Lo(function(e,t,n){return(e.h===0||e.h===2)&&(t=Po(t,0|t[Pe],n,!1,!1),e.h==2?tu(e,Hs,t):t.push(Hs(e.g)),!0)},function(e,t,n){if((t=Ro(bo,t))!=null&&t.length){n=tp(e,n);for(let r=0;r<t.length;r++)nu(e.g,t[r]);np(e,n)}},ip),Yi=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Hs(e.g))===0?void 0:e),!0)},Gy,ip),At=kn(function(e,t,n){return e.h===0&&(An(t,n,Zh(e.g)),!0)},Vy,Ty),io=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Zh(e.g))===!1?void 0:e),!0)},Vy,Ty),hn=Lo(function(e,t,n){return e.h===2&&(e=ep(e),Po(t,0|t[Pe],n,!1).push(e),!0)},function(e,t,n){if((t=Ro(vo,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&ru(r,s,ty(i))}},sp),Ns=kn(function(e,t,n){return e.h===2&&(An(t,n,(e=ep(e))===""?void 0:e),!0)},Yy,sp),it=kn(function(e,t,n){return e.h===2&&(An(t,n,ep(e)),!0)},Yy,sp),Vt=function(e,t,n=rp){return new Io(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=$s(void 0,r,!0),Po(t,0|t[Pe],n,!0).push(r),Ka(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)Xy(e,t[i],n,r,s)}),ot=su(function(e,t,n,r,s,i){return e.h===2&&(ky(t,0|t[Pe],i,n),Ka(e,t=Kh(t,r,n),s),!0)},Xy),Jy=kn(function(e,t,n){return e.h===2&&(An(t,n,My(e)),!0)},Ky,Ly),a5=Lo(function(e,t,n){return(e.h===0||e.h===2)&&(t=Po(t,0|t[Pe],n,!1,!1),e.h==2?tu(e,ps,t):t.push(ps(e.g)),!0)},function(e,t,n){if((t=Ro(py,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(nr(r,s,0),To(r.g,i))}},Iy),l5=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=ps(e.g))===0?void 0:e),!0)},function(e,t,n){(t=py(t))!=null&&t!=null&&(nr(e,n,0),To(e.g,t))},Iy),xr=kn(function(e,t,n){return e.h===0&&(An(t,n,Hs(e.g)),!0)},function(e,t,n){(t=bo(t))!=null&&(t=parseInt(t,10),nr(e,n,0),nu(e.g,t))},By);class c5{constructor(t,n){this.h=t,this.g=n,this.l=tt,this.m=Ie,this.defaultValue=void 0}}function Lr(e,t){return new c5(e,t)}function Qs(e,t){return(n,r)=>{if(Al.length){const i=Al.pop();i.o(r),ud(i.g,n,r),n=i}else n=new class{constructor(i,a){if(z1.length){const c=z1.pop();ud(c,i,a),i=c}else i=new class{constructor(c,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,ud(this,c,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;up(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,Al.length<100&&Al.push(n)}return s}}function cu(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};Hy(this.u,t,xi(iu,ou,au,e)),xo(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const c=r[a];n.set(c,i),i+=c.length}return t.l=[n],n}}var Y1=class extends _e{constructor(e){super(e)}},X1=[0,Ns,kn(function(e,t,n){return e.h===2&&(An(t,n,(e=My(e))===yi()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof _e){const r=t.Ra;return void(r&&(t=r(t),t!=null&&ru(e,n,Jh(t).buffer)))}if(Array.isArray(t))return}Ky(e,t,n)},Ly)];let fd,K1=globalThis.trustedTypes;function Q1(e){fd===void 0&&(fd=function(){let n=null;if(!K1)return n;try{const r=s=>s;n=K1.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=fd;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function u5(e,...t){if(t.length===0)return Q1(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return Q1(n)}var qy=[0,Bt,xr,At,-1,lu,xr,-1],d5=class extends _e{constructor(e){super(e)}},Zy=[0,At,it,At,xr,-1,Lo(function(e,t,n){return(e.h===0||e.h===2)&&(t=Po(t,0|t[Pe],n,!1,!1),e.h==2?tu(e,Jx,t):t.push(Hs(e.g)),!0)},function(e,t,n){if((t=Ro(bo,t))!=null&&t.length){n=tp(e,n);for(let r=0;r<t.length;r++)nu(e.g,t[r]);np(e,n)}},By),it,-1,[0,At,-1],xr,At,-1],ev=[0,it,-2],J1=class extends _e{constructor(e){super(e)}},tv=[0],nv=[0,Bt,At,1,At,-3],Zn=class extends _e{constructor(e){super(e,2)}},Wt={};Wt[336783863]=[0,it,At,-1,Bt,[0,[1,2,3,4,5,6,7,8],ot,tv,ot,Zy,ot,ev,ot,nv,ot,qy,ot,[0,it,-2],ot,[0,it,xr],ot,[0,xr,it]],[0,it],At,[0,[1,3],[2,4],ot,[0,lu],-1,ot,[0,hn],-1,Vt,[0,it,-1]],it];var q1=[0,dd,-1,io,-3,dd,lu,Ns,Yi,dd,-1,io,Yi,io,-2,Ns];function rr(e,t){xf(e,2,Mo(t),"")}function pt(e,t){eu(e,3,t)}function Je(e,t){eu(e,4,t)}var wn=class extends _e{constructor(e){super(e,500)}o(e){return Ie(this,0,7,e)}},ya=[-1,{}],Z1=[0,it,1,ya],e0=[0,it,hn,ya];function sr(e,t){kc(e,1,wn,t)}function wt(e,t){eu(e,10,t)}function st(e,t){eu(e,15,t)}var Fn=class extends _e{constructor(e){super(e,500)}o(e){return Ie(this,0,1001,e)}},rv=[-500,Vt,[-500,Ns,-1,hn,-3,[-2,Wt,At],Vt,X1,Yi,-1,Z1,e0,Vt,[0,Ns,io],Ns,q1,Yi,hn,987,hn],4,Vt,[-500,it,-1,[-1,{}],998,it],Vt,[-500,it,hn,-1,[-2,{},At],997,hn,-1],Yi,Vt,[-500,it,hn,ya,998,hn],hn,Yi,Z1,e0,Vt,[0,Ns,-1,ya],hn,-2,q1,Ns,-1,io,[0,io,l5],978,ya,Vt,X1];Fn.prototype.g=cu(rv);var f5=Qs(Fn,rv),h5=class extends _e{constructor(e){super(e)}},sv=class extends _e{constructor(e){super(e)}g(){return hs(this,h5,1)}},iv=[0,Vt,[0,Bt,Ht,it,-1]],uu=Qs(sv,iv),p5=class extends _e{constructor(e){super(e)}},m5=class extends _e{constructor(e){super(e)}},hd=class extends _e{constructor(e){super(e)}h(){return tt(this,p5,2)}g(){return hs(this,m5,5)}},ov=Qs(class extends _e{constructor(e){super(e)}},[0,hn,lu,dp,[0,xr,[0,Bt,-3],[0,Ht,-3],[0,Bt,-1,[0,Vt,[0,Bt,-2]]],Vt,[0,Ht,-1,it,Ht]],it,-1,Ws,Vt,[0,Bt,Ht],hn,Ws]),av=class extends _e{constructor(e){super(e)}},oo=Qs(class extends _e{constructor(e){super(e)}},[0,Vt,[0,Ht,-4]]),lv=class extends _e{constructor(e){super(e)}},Qa=Qs(class extends _e{constructor(e){super(e)}},[0,Vt,[0,Ht,-4]]),g5=class extends _e{constructor(e){super(e)}},y5=[0,Bt,-1,dp,xr],cv=class extends _e{constructor(e){super(e)}};cv.prototype.g=cu([0,Ht,-4,Ws]);var v5=class extends _e{constructor(e){super(e)}},w5=Qs(class extends _e{constructor(e){super(e)}},[0,Vt,[0,1,Bt,it,iv],Ws]),t0=class extends _e{constructor(e){super(e)}},x5=class extends _e{constructor(e){super(e)}oa(){const e=xy(this);return e??yi()}},S5=class extends _e{constructor(e){super(e)}},uv=[1,2],k5=Qs(class extends _e{constructor(e){super(e)}},[0,Vt,[0,uv,ot,[0,dp],ot,[0,Jy],Bt,it],Ws]),fp=class extends _e{constructor(e){super(e)}},dv=[0,it,Bt,Ht,hn,-1],n0=class extends _e{constructor(e){super(e)}},A5=[0,At,-1],r0=class extends _e{constructor(e){super(e)}},Ul=[1,2,3,4,5],Cc=class extends _e{constructor(e){super(e)}g(){return xy(this)!=null}h(){return wr(this,2)!=null}},Et=class extends _e{constructor(e){super(e)}g(){return hy(wo(this,2))??!1}},fv=[0,Jy,it,[0,Bt,Ws,-1],[0,o5,Ws]],$t=[0,fv,At,[0,Ul,ot,nv,ot,Zy,ot,qy,ot,tv,ot,ev],xr],du=class extends _e{constructor(e){super(e)}},hp=[0,$t,Ht,-1,Bt],E5=Lr(502141897,du);Wt[502141897]=hp;var C5=Qs(class extends _e{constructor(e){super(e)}},[0,[0,xr,-1,i5,a5],y5]),hv=class extends _e{constructor(e){super(e)}},pv=class extends _e{constructor(e){super(e)}},pp=[0,$t,Ht,[0,$t],At],mv=[0,$t,hp,pp,Ht,[0,[0,fv]]],j5=Lr(508968150,pv);Wt[508968150]=mv,Wt[508968149]=pp;var gv=class extends _e{constructor(e){super(e)}},_5=Lr(513916220,gv);Wt[513916220]=[0,$t,mv,Bt];var Ti=class extends _e{constructor(e){super(e)}h(){return tt(this,fp,2)}g(){ft(this,2)}},yv=[0,$t,dv];Wt[478825465]=yv;var N5=class extends _e{constructor(e){super(e)}},vv=class extends _e{constructor(e){super(e)}},mp=class extends _e{constructor(e){super(e)}},gp=class extends _e{constructor(e){super(e)}},wv=class extends _e{constructor(e){super(e)}},s0=[0,$t,[0,$t],yv,-1],xv=[0,$t,Ht,Bt],yp=[0,$t,Ht],Sv=[0,$t,xv,yp,Ht],b5=Lr(479097054,wv);Wt[479097054]=[0,$t,Sv,s0],Wt[463370452]=s0,Wt[464864288]=xv;var M5=Lr(462713202,gp);Wt[462713202]=Sv,Wt[474472470]=yp;var P5=class extends _e{constructor(e){super(e)}},kv=class extends _e{constructor(e){super(e)}},Av=class extends _e{constructor(e){super(e)}},Ev=class extends _e{constructor(e){super(e)}},vp=[0,$t,Ht,-1,Bt],Cf=[0,$t,Ht,At];Ev.prototype.g=cu([0,$t,yp,[0,$t],hp,pp,vp,Cf]);var Cv=class extends _e{constructor(e){super(e)}},T5=Lr(456383383,Cv);Wt[456383383]=[0,$t,dv];var jv=class extends _e{constructor(e){super(e)}},I5=Lr(476348187,jv);Wt[476348187]=[0,$t,A5];var _v=class extends _e{constructor(e){super(e)}},i0=class extends _e{constructor(e){super(e)}},Nv=[0,xr,-1],R5=Lr(458105876,class extends _e{constructor(e){super(e)}g(){var e=this.u;const t=0|e[Pe],n=2&t;return e=function(r,s,i){var a=i0;const c=2&s;let d=!1;if(i==null){if(c)return D1();i=[]}else if(i.constructor===vr){if(!(2&i.L)||c)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[Pe])):i=[];if(c){if(!i.length)return D1();d||(d=!0,No(i))}else d&&(d=!1,i=Sy(i));return d||(64&(0|i[Pe])?i[Pe]&=-33:32&s&&Vc(i,32)),bt(r,s,2,a=new vr(i,a,Ux,void 0)),a}(e,t,gs(e,t,2)),!n&&i0&&(e.ra=!0),e}});Wt[458105876]=[0,Nv,s5,[!0,Ws,[0,it,-1,hn]]];var wp=class extends _e{constructor(e){super(e)}},bv=Lr(458105758,wp);Wt[458105758]=[0,$t,it,Nv];var Mv=class extends _e{constructor(e){super(e)}},L5=Lr(443442058,Mv);Wt[443442058]=[0,$t,it,Bt,Ht,hn,-1,At,Ht],Wt[514774813]=vp;var Pv=class extends _e{constructor(e){super(e)}},B5=Lr(516587230,Pv);function jf(e,t){return t=t?t.clone():new fp,e.displayNamesLocale!==void 0?ft(t,1,Mo(e.displayNamesLocale)):e.displayNamesLocale===void 0&&ft(t,1),e.maxResults!==void 0?Kr(t,2,e.maxResults):"maxResults"in e&&ft(t,2),e.scoreThreshold!==void 0?Ne(t,3,e.scoreThreshold):"scoreThreshold"in e&&ft(t,3),e.categoryAllowlist!==void 0?Ac(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&ft(t,4),e.categoryDenylist!==void 0?Ac(t,5,e.categoryDenylist):"categoryDenylist"in e&&ft(t,5),t}function xp(e,t=-1,n=""){return{categories:e.map(r=>({index:pr(r,1)??0??-1,score:Ft(r,2)??0,categoryName:wr(r,3)??""??"",displayName:wr(r,4)??""??""})),headIndex:t,headName:n}}function Tv(e){var a,c;var t=ai(e,3,Ks,oi()),n=ai(e,2,bo,oi()),r=ai(e,1,vo,oi()),s=ai(e,9,vo,oi());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=tt(e,hd,4))==null?void 0:a.h())&&(i.boundingBox={originX:pr(t,1)??0,originY:pr(t,2)??0,width:pr(t,3)??0,height:pr(t,4)??0,angle:0}),(c=tt(e,hd,4))==null?void 0:c.g().length)for(const d of tt(e,hd,4).g())i.keypoints.push({x:Dl(d,1)??0,y:Dl(d,2)??0,score:Dl(d,4)??0,label:wr(d,3)??""});return i}function fu(e){const t=[];for(const n of hs(e,lv,1))t.push({x:Ft(n,1)??0,y:Ft(n,2)??0,z:Ft(n,3)??0,visibility:Ft(n,4)??0});return t}function va(e){const t=[];for(const n of hs(e,av,1))t.push({x:Ft(n,1)??0,y:Ft(n,2)??0,z:Ft(n,3)??0,visibility:Ft(n,4)??0});return t}function o0(e){return Array.from(e,t=>t>127?t-256:t)}function a0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let El;Wt[516587230]=[0,$t,vp,Cf,Ht],Wt[518928384]=Cf;const F5=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Iv(){if(El===void 0)try{await WebAssembly.instantiate(F5),El=!0}catch{El=!1}return El}async function Zo(e,t=u5``){const n=await Iv()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var Es=class{};function Rv(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function l0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function Lv(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function Me(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function c0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=Lv(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function u0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function zr(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function Ss(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}Es.forVisionTasks=function(e){return Zo("vision",e)},Es.forTextTasks=function(e){return Zo("text",e)},Es.forGenAiExperimentalTasks=function(e){return Zo("genai_experimental",e)},Es.forGenAiTasks=function(e){return Zo("genai",e)},Es.forAudioTasks=function(e){return Zo("audio",e)},Es.isSimdSupported=function(){return Iv()};async function O5(e,t,n,r){return e=await(async(s,i,a,c,d)=>{if(i&&await l0(i),!self.ModuleFactory||a&&(await l0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,c)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function pd(e,t){const n=tt(e.baseOptions,Cc,1)||new Cc;typeof t=="string"?(ft(n,2,Mo(t)),ft(n,1)):t instanceof Uint8Array&&(ft(n,1,Ih(t,!1)),ft(n,2)),Ie(e.baseOptions,0,1,n)}function d0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function Ee(e,t){e.B=Math.max(e.B,t)}function hu(e,t){e.A=new wn,rr(e.A,"PassThroughCalculator"),pt(e.A,"free_memory"),Je(e.A,"free_memory_unused_out"),wt(t,"free_memory"),sr(t,e.A)}function So(e,t){pt(e.A,t),Je(e.A,t+"_unused_out")}function pu(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var Hl=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,c;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=tt(this.baseOptions,Cc,1))!=null&&s.g()||(i=tt(this.baseOptions,Cc,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(c=e.baseOptions)!=null&&c.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,g){let v=tt(h.baseOptions,r0,3);if(!v){var w=v=new r0,N=new J1;ga(w,4,Ul,N)}"delegate"in g&&(g.delegate==="GPU"?(g=v,w=new d5,ga(g,2,Ul,w)):(g=v,w=new J1,ga(g,4,Ul,w))),Ie(h.baseOptions,0,3,v)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),pd(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)pd(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const g=[];for(var v=0;;){const{done:w,value:N}=await h.read();if(w)break;g.push(N),v+=N.length}if(g.length===0)return new Uint8Array(0);if(g.length===1)return g[0];h=new Uint8Array(v),v=0;for(const w of g)h.set(w,v),v+=w.length;return h}(d.modelAssetBuffer).then(h=>{pd(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=f5(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,d0(this)}finishProcessing(){this.g.finishProcessing(),d0(this)}close(){this.A=void 0,this.g.closeGraph()}};function ls(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Hl.prototype.close=Hl.prototype.close,function(e,t){e=e.split(".");var n,r=gi;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",Hl);class $5{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function f0(e,t,n){const r=e.g;if(n=ls(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function h0(e,t){const n=e.g,r=ls(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=ls(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=ls(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new $5(n,r,s,i)}function Sp(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function kp(e,t,n,r){return Sp(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=h0(e,!0)),n=e.s):(e.v||(e.v=h0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function mu(e,t,n){return Sp(e,t),e=ls(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function gu(e,t,n){Sp(e,t),e.A||(e.A=ls(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function Ap(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var Ep=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=ls(e.createProgram(),"Failed to create WebGL program"),this.aa=f0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=f0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function ts(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function _f(e){var t=ts(e,1);if(!t){if(t=ts(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=ko(e);var n=Cp(e);if(gu(n,r,Bv(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function Bv(e){let t=ts(e,2);if(!t){const n=ko(e);t=Ov(e);const r=_f(e),s=Fv(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),Nf(e)}return t}function ko(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ls(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Fv(e){if(e=ko(e),!Cl)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))Cl=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");Cl=e.R16F}return Cl}function Cp(e){return e.l||(e.l=new Ep),e.l}function Ov(e){const t=ko(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=ts(e,2);return n||(n=mu(Cp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Nf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var Cl,Jt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--p0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!ts(this,0)}ja(){return!!ts(this,1)}P(){return!!ts(this,2)}ia(){return(t=ts(e=this,0))||(t=_f(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return _f(this)}M(){return Bv(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=ko(this),s=Cp(this);r.activeTexture(r.TEXTURE1),n=mu(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=Fv(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),gu(s,r,n),kp(s,r,!1,()=>{Ov(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Nf(this)}),Ap(s),Nf(this)}}e.push(n)}return new Jt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&ko(this).deleteTexture(ts(this,2)),p0=-1}};Jt.prototype.close=Jt.prototype.close,Jt.prototype.clone=Jt.prototype.clone,Jt.prototype.getAsWebGLTexture=Jt.prototype.M,Jt.prototype.getAsFloat32Array=Jt.prototype.ha,Jt.prototype.getAsUint8Array=Jt.prototype.ia,Jt.prototype.hasWebGLTexture=Jt.prototype.P,Jt.prototype.hasFloat32Array=Jt.prototype.ja,Jt.prototype.hasUint8Array=Jt.prototype.Fa;var p0=250;function Gr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function $v(e){var t=Gr(e,0);if(!t){t=Ao(e);const n=yu(e),r=new Uint8Array(e.width*e.height*4);gu(n,t,Wl(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),Ap(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function Wl(e){let t=Gr(e,2);if(!t){const n=Ao(e);t=Gl(e);const r=Gr(e,1)||$v(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),ia(e)}return t}function Ao(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ls(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function yu(e){return e.l||(e.l=new Ep),e.l}function Gl(e){const t=Ao(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Gr(e,2);return n||(n=mu(yu(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function ia(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function m0(e){const t=Ao(e);return kp(yu(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var qt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--g0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Gr(this,0)}ka(){return!!Gr(this,1)}P(){return!!Gr(this,2)}Ca(){return $v(this)}Ba(){var e=Gr(this,1);return e||(Wl(this),Gl(this),e=m0(this),ia(this),this.g.push(e),this.j=!0),e}M(){return Wl(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=Ao(this),s=yu(this);r.activeTexture(r.TEXTURE1),n=mu(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),gu(s,r,n),kp(s,r,!1,()=>{Gl(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),ia(this)}),Ap(s),ia(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Wl(this),Gl(this),n=m0(this),ia(this)}e.push(n)}return new qt(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Gr(this,1).close(),this.m&&Ao(this).deleteTexture(Gr(this,2)),g0=-1}};qt.prototype.close=qt.prototype.close,qt.prototype.clone=qt.prototype.clone,qt.prototype.getAsWebGLTexture=qt.prototype.M,qt.prototype.getAsImageBitmap=qt.prototype.Ba,qt.prototype.getAsImageData=qt.prototype.Ca,qt.prototype.hasWebGLTexture=qt.prototype.P,qt.prototype.hasImageBitmap=qt.prototype.ka,qt.prototype.hasImageData=qt.prototype.Ea;var g0=250;function Br(...e){return e.map(([t,n])=>({start:t,end:n}))}const D5=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((y0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:Rv()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),Me(this,r||"input_audio",i=>{Me(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){zr(this,"__graph_config__",t=>{e(t)}),Me(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),Me(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){Me(this,t,r=>{const[s,i]=c0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){Me(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){Me(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){Me(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){Me(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){Me(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){Me(this,t,r=>{Me(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){Me(this,t,r=>{u0(this,Object.keys(e),s=>{u0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){Me(this,n,s=>{Me(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){Me(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){Me(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){Me(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){Me(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){Me(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){Me(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){Me(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)Me(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){Me(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){Me(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){Me(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){Me(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){Me(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){Me(this,t,n=>{Me(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){Me(this,n,r=>{Me(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){Me(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){Me(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){Me(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){Me(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){Me(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){Me(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)Me(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){zr(this,e,t),Me(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){Ss(this,e,t),Me(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){zr(this,e,t),Me(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){Ss(this,e,t),Me(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){zr(this,e,t),Me(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){Ss(this,e,t),Me(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){zr(this,e,t),Me(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){Ss(this,e,t),Me(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){zr(this,e,t),Me(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){Ss(this,e,t),Me(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){zr(this,e,t),Me(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){Ss(this,e,t),Me(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){zr(this,e,t),Me(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){Ss(this,e,t),Me(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),zr(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),Me(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends y0{get ea(){return this.i}qa(e,t,n){Me(this,t,r=>{const[s,i]=c0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){zr(this,e,t),Me(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){Ss(this,e,t),Me(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var y0,Sr=class extends D5{};async function Qe(e,t,n){return async function(r,s,i,a){return O5(r,s,i,a)}(e,n.canvas??(Rv()?void 0:document.createElement("canvas")),t,n)}function Dv(e,t,n,r){if(e.T){const i=new cv;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");Ne(i,1,(s.left+s.right)/2),Ne(i,2,(s.top+s.bottom)/2),Ne(i,4,s.right-s.left),Ne(i,3,s.bottom-s.top)}else Ne(i,1,.5),Ne(i,2,.5),Ne(i,4,1),Ne(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(Ne(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,c]=Lv(t);n=Ft(i,3)*c/a,s=Ft(i,4)*a/c,Ne(i,4,n),Ne(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function kr(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Dv(e,t,n,e.B+1)}function Qr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Dv(e,t,n,r)}function Eo(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new Jt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Bn=class extends Hl{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new Ep}l(e,t=!0){if("runningMode"in e&&Oa(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Bn.prototype.close=Bn.prototype.close;var ar=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Ie(e=this.h=new du,0,1,t=new Et),Ne(this.h,2,.5),Ne(this.h,3,.3)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&Ne(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&Ne(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},kr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Qr(this,e,n,t),this.j}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect_in"),st(e,"detections");const t=new Zn;Ir(t,E5,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect_in"),Je(n,"DETECTIONS:detections"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=ov(i),this.j.detections.push(Tv(r));Ee(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ar.prototype.detectForVideo=ar.prototype.F,ar.prototype.detect=ar.prototype.D,ar.prototype.setOptions=ar.prototype.o,ar.createFromModelPath=async function(e,t){return Qe(ar,e,{baseOptions:{modelAssetPath:t}})},ar.createFromModelBuffer=function(e,t){return Qe(ar,e,{baseOptions:{modelAssetBuffer:t}})},ar.createFromOptions=function(e,t){return Qe(ar,e,t)};var jp=Br([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),_p=Br([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),Np=Br([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),zv=Br([474,475],[475,476],[476,477],[477,474]),bp=Br([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),Mp=Br([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Uv=Br([469,470],[470,471],[471,472],[472,469]),Pp=Br([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),Hv=[...jp,..._p,...Np,...bp,...Mp,...Pp],Wv=Br([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function v0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var It=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Ie(e=this.h=new pv,0,1,t=new Et),this.v=new hv,Ie(this.h,0,3,this.v),this.s=new du,Ie(this.h,0,2,this.s),Kr(this.s,4,1),Ne(this.s,2,.5),Ne(this.v,2,.5),Ne(this.h,4,.5)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"numFaces"in e&&Kr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&Ne(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&Ne(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&Ne(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return v0(this),kr(this,e,t),this.j}F(e,t,n){return v0(this),Qr(this,e,n,t),this.j}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"face_landmarks");const t=new Zn;Ir(t,j5,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=Qa(i),this.j.faceLandmarks.push(fu(r));Ee(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{Ee(this,r)}),this.outputFaceBlendshapes&&(st(e,"blendshapes"),Je(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=uu(i),this.j.faceBlendshapes.push(xp(r.g()??[]));Ee(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{Ee(this,r)})),this.outputFacialTransformationMatrixes&&(st(e,"face_geometry"),Je(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=tt(C5(i),g5,2))&&this.j.facialTransformationMatrixes.push({rows:pr(r,1)??0??0,columns:pr(r,2)??0??0,data:ai(r,3,Ks,oi()).slice()??[]});Ee(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{Ee(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};It.prototype.detectForVideo=It.prototype.F,It.prototype.detect=It.prototype.D,It.prototype.setOptions=It.prototype.o,It.createFromModelPath=function(e,t){return Qe(It,e,{baseOptions:{modelAssetPath:t}})},It.createFromModelBuffer=function(e,t){return Qe(It,e,{baseOptions:{modelAssetBuffer:t}})},It.createFromOptions=function(e,t){return Qe(It,e,t)},It.FACE_LANDMARKS_LIPS=jp,It.FACE_LANDMARKS_LEFT_EYE=_p,It.FACE_LANDMARKS_LEFT_EYEBROW=Np,It.FACE_LANDMARKS_LEFT_IRIS=zv,It.FACE_LANDMARKS_RIGHT_EYE=bp,It.FACE_LANDMARKS_RIGHT_EYEBROW=Mp,It.FACE_LANDMARKS_RIGHT_IRIS=Uv,It.FACE_LANDMARKS_FACE_OVAL=Pp,It.FACE_LANDMARKS_CONTOURS=Hv,It.FACE_LANDMARKS_TESSELATION=Wv;var Ur=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!0),Ie(e=this.j=new gv,0,1,t=new Et)}get baseOptions(){return tt(this.j,Et,1)}set baseOptions(e){Ie(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,kr(this,e,r??{}),!this.h)return this.s}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"stylized_image");const t=new Zn;Ir(t,_5,this.j);const n=new wn;rr(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),sr(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,c=r.width;const d=c*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let g=0;g<d;++g)h[4*g]=a[3*g],h[4*g+1]=a[3*g+1],h[4*g+2]=a[3*g+2],h[4*g+3]=255;a=new ImageData(h,c,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),c,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);c=new qt([a],!1,!1,this.g.i.canvas,this.O,c,r),this.s=i=i?c.clone():c,this.h&&this.h(i),Ee(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ur.prototype.stylize=Ur.prototype.Oa,Ur.prototype.setOptions=Ur.prototype.o,Ur.createFromModelPath=function(e,t){return Qe(Ur,e,{baseOptions:{modelAssetPath:t}})},Ur.createFromModelBuffer=function(e,t){return Qe(Ur,e,{baseOptions:{modelAssetBuffer:t}})},Ur.createFromOptions=function(e,t){return Qe(Ur,e,t)};var Tp=Br([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function w0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function x0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function S0(e,t=!0){const n=[];for(const s of e){var r=uu(s);e=[];for(const i of r.g())r=t&&pr(i,1)!=null?pr(i,1)??0:-1,e.push({score:Ft(i,2)??0,index:r,categoryName:wr(i,3)??""??"",displayName:wr(i,4)??""??""});n.push(e)}return n}var Gn=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Ie(e=this.j=new wv,0,1,t=new Et),this.s=new gp,Ie(this.j,0,2,this.s),this.C=new mp,Ie(this.s,0,3,this.C),this.v=new vv,Ie(this.s,0,2,this.v),this.h=new N5,Ie(this.j,0,3,this.h),Ne(this.v,2,.5),Ne(this.s,4,.5),Ne(this.C,2,.5)}get baseOptions(){return tt(this.j,Et,1)}set baseOptions(e){Ie(this.j,0,1,e)}o(e){var s,i,a,c;if(Kr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&Ne(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Ne(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Ne(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new Ti,n=t,r=jf(e.cannedGesturesClassifierOptions,(s=tt(this.h,Ti,3))==null?void 0:s.h());Ie(n,0,2,r),Ie(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=tt(this.h,Ti,3))==null||i.g());return e.customGesturesClassifierOptions?(Ie(n=t=new Ti,0,2,r=jf(e.customGesturesClassifierOptions,(a=tt(this.h,Ti,4))==null?void 0:a.h())),Ie(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((c=tt(this.h,Ti,4))==null||c.g()),this.l(e)}Ja(e,t){return w0(this),kr(this,e,t),x0(this)}Ka(e,t,n){return w0(this),Qr(this,e,n,t),x0(this)}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"hand_gestures"),st(e,"hand_landmarks"),st(e,"world_hand_landmarks"),st(e,"handedness");const t=new Zn;Ir(t,b5,this.j);const n=new wn;rr(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"HAND_GESTURES:hand_gestures"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=Qa(i);const a=[];for(const c of hs(r,lv,1))a.push({x:Ft(c,1)??0,y:Ft(c,2)??0,z:Ft(c,3)??0,visibility:Ft(c,4)??0});this.landmarks.push(a)}Ee(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ee(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=oo(i);const a=[];for(const c of hs(r,av,1))a.push({x:Ft(c,1)??0,y:Ft(c,2)??0,z:Ft(c,3)??0,visibility:Ft(c,4)??0});this.worldLandmarks.push(a)}Ee(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ee(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...S0(r,!1)),Ee(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{Ee(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...S0(r)),Ee(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function k0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Gn.prototype.recognizeForVideo=Gn.prototype.Ka,Gn.prototype.recognize=Gn.prototype.Ja,Gn.prototype.setOptions=Gn.prototype.o,Gn.createFromModelPath=function(e,t){return Qe(Gn,e,{baseOptions:{modelAssetPath:t}})},Gn.createFromModelBuffer=function(e,t){return Qe(Gn,e,{baseOptions:{modelAssetBuffer:t}})},Gn.createFromOptions=function(e,t){return Qe(Gn,e,t)},Gn.HAND_CONNECTIONS=Tp;var Vn=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Ie(e=this.h=new gp,0,1,t=new Et),this.s=new mp,Ie(this.h,0,3,this.s),this.j=new vv,Ie(this.h,0,2,this.j),Kr(this.j,3,1),Ne(this.j,2,.5),Ne(this.s,2,.5),Ne(this.h,4,.5)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"numHands"in e&&Kr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&Ne(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Ne(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Ne(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],kr(this,e,t),k0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Qr(this,e,n,t),k0(this)}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"hand_landmarks"),st(e,"world_hand_landmarks"),st(e,"handedness");const t=new Zn;Ir(t,M5,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=Qa(i),this.landmarks.push(fu(r));Ee(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ee(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=oo(i),this.worldLandmarks.push(va(r));Ee(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ee(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const c=[];for(const d of r){r=uu(d);const h=[];for(const g of r.g())h.push({score:Ft(g,2)??0,index:pr(g,1)??0??-1,categoryName:wr(g,3)??""??"",displayName:wr(g,4)??""??""});c.push(h)}a.call(i,...c),Ee(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Vn.prototype.detectForVideo=Vn.prototype.F,Vn.prototype.detect=Vn.prototype.D,Vn.prototype.setOptions=Vn.prototype.o,Vn.createFromModelPath=function(e,t){return Qe(Vn,e,{baseOptions:{modelAssetPath:t}})},Vn.createFromModelBuffer=function(e,t){return Qe(Vn,e,{baseOptions:{modelAssetBuffer:t}})},Vn.createFromOptions=function(e,t){return Qe(Vn,e,t)},Vn.HAND_CONNECTIONS=Tp;var Gv=Br([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function A0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function E0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{pu(e)}}function jl(e,t){e=Qa(e),t.push(fu(e))}var St=class extends Bn{constructor(e,t){super(new Sr(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Ie(e=this.j=new Ev,0,1,t=new Et),this.J=new mp,Ie(this.j,0,2,this.J),this.Z=new P5,Ie(this.j,0,3,this.Z),this.s=new du,Ie(this.j,0,4,this.s),this.H=new hv,Ie(this.j,0,5,this.H),this.v=new kv,Ie(this.j,0,6,this.v),this.K=new Av,Ie(this.j,0,7,this.K),Ne(this.s,2,.5),Ne(this.s,3,.3),Ne(this.H,2,.5),Ne(this.v,2,.5),Ne(this.v,3,.3),Ne(this.K,2,.5),Ne(this.J,2,.5)}get baseOptions(){return tt(this.j,Et,1)}set baseOptions(e){Ie(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&Ne(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&Ne(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&Ne(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&Ne(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&Ne(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&Ne(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&Ne(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,A0(this),kr(this,e,r),E0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,A0(this),Qr(this,e,s,t),E0(this)}m(){var e=new Fn;wt(e,"input_frames_image"),st(e,"pose_landmarks"),st(e,"pose_world_landmarks"),st(e,"face_landmarks"),st(e,"left_hand_landmarks"),st(e,"left_hand_world_landmarks"),st(e,"right_hand_landmarks"),st(e,"right_hand_world_landmarks");const t=new Zn,n=new Y1;xf(n,1,Mo("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))ft(s,2,vy(i));else{if(!(typeof i=="string"||i instanceof os||Va(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");xf(s,2,Ih(i,!1),yi())}}(n,this.j.g());const r=new wn;rr(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),kc(r,8,Y1,n),pt(r,"IMAGE:input_frames_image"),Je(r,"POSE_LANDMARKS:pose_landmarks"),Je(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Je(r,"FACE_LANDMARKS:face_landmarks"),Je(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Je(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Je(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Je(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),sr(e,r),hu(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{jl(s,this.h.poseLandmarks),Ee(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{Ee(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=oo(s),a.push(va(s)),Ee(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{Ee(this,s)}),this.outputPoseSegmentationMasks&&(Je(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),So(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[Eo(this,s,!0,!this.C)],Ee(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],Ee(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{jl(s,this.h.faceLandmarks),Ee(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{Ee(this,s)}),this.outputFaceBlendshapes&&(st(e,"extra_blendshapes"),Je(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=uu(s),a.push(xp(s.g()??[]))),Ee(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{Ee(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{jl(s,this.h.leftHandLandmarks),Ee(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{Ee(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=oo(s),a.push(va(s)),Ee(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{Ee(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{jl(s,this.h.rightHandLandmarks),Ee(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{Ee(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=oo(s),a.push(va(s)),Ee(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{Ee(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};St.prototype.detectForVideo=St.prototype.F,St.prototype.detect=St.prototype.D,St.prototype.setOptions=St.prototype.o,St.createFromModelPath=function(e,t){return Qe(St,e,{baseOptions:{modelAssetPath:t}})},St.createFromModelBuffer=function(e,t){return Qe(St,e,{baseOptions:{modelAssetBuffer:t}})},St.createFromOptions=function(e,t){return Qe(St,e,t)},St.HAND_CONNECTIONS=Tp,St.POSE_CONNECTIONS=Gv,St.FACE_LANDMARKS_LIPS=jp,St.FACE_LANDMARKS_LEFT_EYE=_p,St.FACE_LANDMARKS_LEFT_EYEBROW=Np,St.FACE_LANDMARKS_LEFT_IRIS=zv,St.FACE_LANDMARKS_RIGHT_EYE=bp,St.FACE_LANDMARKS_RIGHT_EYEBROW=Mp,St.FACE_LANDMARKS_RIGHT_IRIS=Uv,St.FACE_LANDMARKS_FACE_OVAL=Pp,St.FACE_LANDMARKS_CONTOURS=Hv,St.FACE_LANDMARKS_TESSELATION=Wv;var lr=class extends Bn{constructor(e,t){super(new Sr(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Ie(e=this.h=new Cv,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return Ie(this.h,0,2,jf(e,tt(this.h,fp,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},kr(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},Qr(this,e,n,t),this.j}m(){var e=new Fn;wt(e,"input_image"),wt(e,"norm_rect"),st(e,"classifications");const t=new Zn;Ir(t,T5,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),pt(n,"IMAGE:input_image"),pt(n,"NORM_RECT:norm_rect"),Je(n,"CLASSIFICATIONS:classifications"),n.o(t),sr(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:hs(i,v5,1).map(c=>{var d;return xp(((d=tt(c,sv,4))==null?void 0:d.g())??[],pr(c,2)??0,wr(c,3)??"")})};return Sc(wo(i,2))!=null&&(a.timestampMs=Sc(wo(i,2))??0),a}(w5(r)),Ee(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};lr.prototype.classifyForVideo=lr.prototype.ta,lr.prototype.classify=lr.prototype.sa,lr.prototype.setOptions=lr.prototype.o,lr.createFromModelPath=function(e,t){return Qe(lr,e,{baseOptions:{modelAssetPath:t}})},lr.createFromModelBuffer=function(e,t){return Qe(lr,e,{baseOptions:{modelAssetBuffer:t}})},lr.createFromOptions=function(e,t){return Qe(lr,e,t)};var Yn=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!0),this.h=new jv,this.embeddings={embeddings:[]},Ie(e=this.h,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){var t=this.h,n=tt(this.h,n0,2);return n=n?n.clone():new n0,e.l2Normalize!==void 0?Oa(n,1,e.l2Normalize):"l2Normalize"in e&&ft(n,1),e.quantize!==void 0?Oa(n,2,e.quantize):"quantize"in e&&ft(n,2),Ie(t,0,2,n),this.l(e)}za(e,t){return kr(this,e,t),this.embeddings}Aa(e,t,n){return Qr(this,e,n,t),this.embeddings}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"embeddings_out");const t=new Zn;Ir(t,I5,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"EMBEDDINGS:embeddings_out"),n.o(t),sr(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=k5(r),this.embeddings=function(i){return{embeddings:hs(i,S5,1).map(a=>{var d,h;const c={headIndex:pr(a,3)??0??-1,headName:wr(a,4)??""??""};if(Ay(a,t0,cd(a,1))!==void 0)a=ai(a=tt(a,t0,cd(a,1)),1,Ks,oi()),c.floatEmbedding=a.slice();else{const g=new Uint8Array(0);c.quantizedEmbedding=((h=(d=tt(a,x5,cd(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??g}return c}),timestampMs:Sc(wo(i,2))??0}}(r),Ee(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Yn.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=a0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=a0(o0(e.quantizedEmbedding),o0(t.quantizedEmbedding))}return e},Yn.prototype.embedForVideo=Yn.prototype.Aa,Yn.prototype.embed=Yn.prototype.za,Yn.prototype.setOptions=Yn.prototype.o,Yn.createFromModelPath=function(e,t){return Qe(Yn,e,{baseOptions:{modelAssetPath:t}})},Yn.createFromModelBuffer=function(e,t){return Qe(Yn,e,{baseOptions:{modelAssetBuffer:t}})},Yn.createFromOptions=function(e,t){return Qe(Yn,e,t)};var bf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function C0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function j0(e){try{const t=new bf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{pu(e)}}bf.prototype.close=bf.prototype.close;var fn=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new wp,this.v=new _v,Ie(this.h,0,3,this.v),Ie(e=this.h,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,Mo(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=hs(e.da(),wn,1).filter(s=>(wr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=tt(t[0],Zn,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=wr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,C0(this),kr(this,e,r),j0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,C0(this),Qr(this,e,s,t),j0(this)}Da(){return this.s}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect");const t=new Zn;Ir(t,bv,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),n.o(t),sr(e,n),hu(this,e),this.outputConfidenceMasks&&(st(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),So(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>Eo(this,i,!0,!this.j)),Ee(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ee(this,r)})),this.outputCategoryMask&&(st(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),So(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=Eo(this,r,!1,!this.j),Ee(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ee(this,r)})),st(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ee(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};fn.prototype.getLabels=fn.prototype.Da,fn.prototype.segmentForVideo=fn.prototype.Ma,fn.prototype.segment=fn.prototype.segment,fn.prototype.setOptions=fn.prototype.o,fn.createFromModelPath=function(e,t){return Qe(fn,e,{baseOptions:{modelAssetPath:t}})},fn.createFromModelBuffer=function(e,t){return Qe(fn,e,{baseOptions:{modelAssetBuffer:t}})},fn.createFromOptions=function(e,t){return Qe(fn,e,t)};var Mf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};Mf.prototype.close=Mf.prototype.close;var z5=class extends _e{constructor(e){super(e)}},Ii=[0,Bt,-2],jc=[0,es,-3,At,es,-1],_0=[0,jc],N0=[0,jc,Bt,-1],md=class extends _e{constructor(e){super(e)}},b0=[0,es,-1,At],U5=class extends _e{constructor(e){super(e)}},M0=class extends _e{constructor(e){super(e)}},Pf=[1,2,3,4,5,6,7,8,9,10,14,15],Vv=class extends _e{constructor(e){super(e)}};Vv.prototype.g=cu([0,Vt,[0,Pf,ot,jc,ot,[0,jc,Ii],ot,_0,ot,[0,_0,Ii],ot,b0,ot,[0,es,-3,At,xr],ot,[0,es,-3,At],ot,[0,it,es,-2,At,Bt,At,-1,2,es,Ii],ot,N0,ot,[0,N0,Ii],es,Ii,it,ot,[0,es,-3,At,Ii,-1],ot,[0,Vt,b0]],it,[0,it,Bt,-1,At]]);var Hr=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new wp,this.s=new _v,Ie(this.h,0,3,this.s),Ie(e=this.h,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new Vv;const i=new M0;var a=new z5;if(Kr(a,1,255),Ie(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var c=new md;Oa(c,3,!0),Ne(c,1,t.keypoint.x),Ne(c,2,t.keypoint.y),ga(i,5,Pf,c)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(c of(a=new U5,t.scribble))Oa(t=new md,3,!0),Ne(t,1,c.x),Ne(t,2,c.y),kc(a,1,md,t);ga(i,15,Pf,a)}kc(r,1,M0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),kr(this,e,s);e:{try{const h=new Mf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{pu(this)}d=void 0}return d}m(){var e=new Fn;wt(e,"image_in"),wt(e,"roi_in"),wt(e,"norm_rect_in");const t=new Zn;Ir(t,bv,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"ROI:roi_in"),pt(n,"NORM_RECT:norm_rect_in"),n.o(t),sr(e,n),hu(this,e),this.outputConfidenceMasks&&(st(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),So(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>Eo(this,i,!0,!this.j)),Ee(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ee(this,r)})),this.outputCategoryMask&&(st(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),So(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=Eo(this,r,!1,!this.j),Ee(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ee(this,r)})),st(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ee(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Hr.prototype.segment=Hr.prototype.segment,Hr.prototype.setOptions=Hr.prototype.o,Hr.createFromModelPath=function(e,t){return Qe(Hr,e,{baseOptions:{modelAssetPath:t}})},Hr.createFromModelBuffer=function(e,t){return Qe(Hr,e,{baseOptions:{modelAssetBuffer:t}})},Hr.createFromOptions=function(e,t){return Qe(Hr,e,t)};var cr=class extends Bn{constructor(e,t){super(new Sr(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Ie(e=this.h=new Mv,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,Mo(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),e.maxResults!==void 0?Kr(this.h,3,e.maxResults):"maxResults"in e&&ft(this.h,3),e.scoreThreshold!==void 0?Ne(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&ft(this.h,4),e.categoryAllowlist!==void 0?Ac(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&ft(this.h,5),e.categoryDenylist!==void 0?Ac(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&ft(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},kr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Qr(this,e,n,t),this.j}m(){var e=new Fn;wt(e,"input_frame_gpu"),wt(e,"norm_rect"),st(e,"detections");const t=new Zn;Ir(t,L5,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),pt(n,"IMAGE:input_frame_gpu"),pt(n,"NORM_RECT:norm_rect"),Je(n,"DETECTIONS:detections"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=ov(i),this.j.detections.push(Tv(r));Ee(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ee(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};cr.prototype.detectForVideo=cr.prototype.F,cr.prototype.detect=cr.prototype.D,cr.prototype.setOptions=cr.prototype.o,cr.createFromModelPath=async function(e,t){return Qe(cr,e,{baseOptions:{modelAssetPath:t}})},cr.createFromModelBuffer=function(e,t){return Qe(cr,e,{baseOptions:{modelAssetBuffer:t}})},cr.createFromOptions=function(e,t){return Qe(cr,e,t)};var Tf=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function P0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function T0(e){try{const t=new Tf(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{pu(e)}}Tf.prototype.close=Tf.prototype.close;var Xn=class extends Bn{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Ie(e=this.h=new Pv,0,1,t=new Et),this.v=new Av,Ie(this.h,0,3,this.v),this.j=new kv,Ie(this.h,0,2,this.j),Kr(this.j,4,1),Ne(this.j,2,.5),Ne(this.v,2,.5),Ne(this.h,4,.5)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"numPoses"in e&&Kr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&Ne(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&Ne(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&Ne(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,P0(this),kr(this,e,r),T0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,P0(this),Qr(this,e,s,t),T0(this)}m(){var e=new Fn;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"normalized_landmarks"),st(e,"world_landmarks"),st(e,"segmentation_masks");const t=new Zn;Ir(t,B5,this.h);const n=new wn;rr(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:normalized_landmarks"),Je(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),sr(e,n),hu(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=Qa(i),this.landmarks.push(fu(r));Ee(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],Ee(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=oo(i),this.worldLandmarks.push(va(r));Ee(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],Ee(this,r)}),this.outputSegmentationMasks&&(Je(n,"SEGMENTATION_MASK:segmentation_masks"),So(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>Eo(this,i,!0,!this.s)),Ee(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],Ee(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Xn.prototype.detectForVideo=Xn.prototype.F,Xn.prototype.detect=Xn.prototype.D,Xn.prototype.setOptions=Xn.prototype.o,Xn.createFromModelPath=function(e,t){return Qe(Xn,e,{baseOptions:{modelAssetPath:t}})},Xn.createFromModelBuffer=function(e,t){return Qe(Xn,e,{baseOptions:{modelAssetBuffer:t}})},Xn.createFromOptions=function(e,t){return Qe(Xn,e,t)},Xn.POSE_CONNECTIONS=Gv;const Yv="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",H5=Yv,_c=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let c=0,d=0,h=0;t>=0&&t<60?(c=s,d=i,h=0):t<120?(c=i,d=s,h=0):t<180?(c=0,d=s,h=i):t<240?(c=0,d=i,h=s):t<300?(c=i,d=0,h=s):(c=s,d=0,h=i);const g=v=>Math.max(0,Math.min(255,Math.round((v+a)*255)));return{r:g(c),g:g(d),b:g(h)}}return null},Ip=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),I0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),R0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},Xv=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const c=e.canvas;return s=c.width,i=c.height,r=c.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(c){console.warn("[ColorDetector] Failed to extract category mask data:",c)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},W5=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=_c(t),a=_c(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:c="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:g=50,minGapRatio:v=.05}=r,w=new Image;w.crossOrigin="anonymous",w.onload=()=>{try{const N=w.width>d?d/w.width:1,D=Math.max(1,Math.round(w.width*N)),T=Math.max(1,Math.round(w.height*N)),V=document.createElement("canvas");V.width=D,V.height=T;const j=V.getContext("2d");if(!j){s({suggestion:"None",stats:{mode:"colorMask"}});return}j.drawImage(w,0,0,D,T);const y=j.getImageData(0,0,D,T),{data:k}=y,M=h*h,b={minY:T,maxY:-1,pixels:0},H={minY:T,maxY:-1,pixels:0},L=new Uint8Array(D*T);for(let J=0;J<T;J+=1)for(let re=0;re<D;re+=1){const fe=(J*D+re)*4,he=J*D+re,Se=k[fe],se=k[fe+1],ne=k[fe+2],Z=(Se-i.r)*(Se-i.r)+(se-i.g)*(se-i.g)+(ne-i.b)*(ne-i.b),pe=(Se-a.r)*(Se-a.r)+(se-a.g)*(se-a.g)+(ne-a.b)*(ne-a.b);Z<M&&Z<pe?(b.pixels+=1,J<b.minY&&(b.minY=J),J>b.maxY&&(b.maxY=J),L[he]=1):pe<M&&pe<Z&&(H.pixels+=1,J<H.minY&&(H.minY=J),J>H.maxY&&(H.maxY=J),L[he]=2)}const F={mode:"colorMask",pixelsA:b.pixels,pixelsB:H.pixels,minYA:b.pixels>0?b.minY:null,maxYA:b.pixels>0?b.maxY:null,minYB:H.pixels>0?H.minY:null,maxYB:H.pixels>0?H.maxY:null,width:D,height:T},z=b.pixels>=g,W=H.pixels>=g;let Y="None";if(z&&!W)Y="A";else if(!z&&W)Y="B";else if(z&&W){let J,re;c==="top"?(J=b.minY,re=H.minY):(J=b.maxY,re=H.maxY);const fe=Math.abs(J-re),he=T*v;fe>=he&&(Y=c==="top"?J<re?"A":"B":J>re?"A":"B")}let q=null;try{const J=document.createElement("canvas");J.width=D,J.height=T;const re=J.getContext("2d");re.drawImage(w,0,0,D,T);const fe=re.getImageData(0,0,D,T),he=fe.data,Se=(Z,pe)=>{he[Z]=Math.round(he[Z]*.3+pe.r*.7),he[Z+1]=Math.round(he[Z+1]*.3+pe.g*.7),he[Z+2]=Math.round(he[Z+2]*.3+pe.b*.7),he[Z+3]=255},se={r:255,g:82,b:97},ne={r:80,g:170,b:255};for(let Z=0;Z<L.length;Z+=1)L[Z]===1?Se(Z*4,se):L[Z]===2&&Se(Z*4,ne);re.putImageData(fe,0,0),q=J.toDataURL("image/png")}catch(J){console.warn("[ColorDetector] Failed generating preview",J)}s({suggestion:Y,stats:F,preview:q})}catch(N){console.error("[ColorDetector] Error processing frame:",N),s({suggestion:"None",stats:{mode:"colorMask"}})}},w.onerror=N=>{console.error("[ColorDetector] Failed to load frame image",N),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?w.src=e:typeof e=="string"?w.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),L0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const N of e){const D=N.y*t+N.x;D>=0&&D<i.length&&(i[D]=1)}const a=[],c=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const N of e){const D=N.y*t+N.x;if(D<0||D>=i.length||i[D]!==1)continue;let T=0;const V=[{x:N.x,y:N.y}];i[D]=2;const j=[];let y=0;for(;y<V.length;){const{x:k,y:M}=V[y++];T++,j.push({x:k,y:M});for(const b of c){const H=k+b.dx,L=M+b.dy;if(H>=0&&H<t&&L>=0&&L<n){const F=L*t+H;F>=0&&F<i.length&&i[F]===1&&(i[F]=2,V.push({x:H,y:L}))}}}a.push({size:T,pixels:j})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((N,D)=>D.size>N.size?D:N).size,g=Math.max(1,Math.floor(h*s));let v=0;const w=[];for(const N of a)N.size>=g&&(v+=N.size,w.push(...N.pixels));return{count:v,pixels:w,largestBlobSize:h,minBlobSize:g,totalBlobs:a.length,filteredBlobs:a.filter(N=>N.size>=g).length}},G5=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=_c(t),i=_c(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await Ip(e),c=a.naturalWidth||a.width,d=a.naturalHeight||a.height,g=(await Rp()).segment(a),{maskData:v,maskWidth:w,maskHeight:N,isRGBA:D}=Xv(g.categoryMask,c,d);if(!v)throw new Error("Failed to extract segmentation mask data");const T=new Uint8ClampedArray(c*d*4),V=c/w,j=d/N;for(let U=0;U<d;U++)for(let G=0;G<c;G++){const Q=Math.min(w-1,Math.floor(G/V)),O=(Math.min(N-1,Math.floor(U/j))*w+Q)*(D?4:1);let m=0;v&&O<v.length&&(m=v[O]);const P=m!==0&&m!==2?255:0,_=(U*c+G)*4;T[_]=P,T[_+1]=P,T[_+2]=P,T[_+3]=255}const y=document.createElement("canvas");y.width=c,y.height=d;const k=y.getContext("2d");k.drawImage(a,0,0,c,d);const M=k.getImageData(0,0,c,d).data,b=r.maskThreshold||100,H=r.colorThreshold??95,L=r.anchor||"top",F=H*H,z=r.scanDepth??1,W=r.stride||2;let Y=L==="top"?d:0,q=!1;if(L==="top")for(let U=0;U<d;U+=W){for(let G=0;G<c;G+=W)if(T[(U*c+G)*4]>=b){Y=U,q=!0;break}if(q)break}else for(let U=d-1;U>=0;U-=W){for(let G=0;G<c;G+=W)if(T[(U*c+G)*4]>=b){Y=U,q=!0;break}if(q)break}let J,re,fe;if(r.manualBounds&&L==="manually")J=r.manualBounds.topY,re=r.manualBounds.bottomY,fe=re-J,q||(Y=J);else{if(!q)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};fe=z?Math.floor(d*z):d,L==="top"?(J=Y,re=Math.min(d,Y+fe)):(J=Math.max(0,Y-fe),re=Y)}const he=[],Se=[];for(let U=J;U<re;U+=W)for(let G=0;G<c;G+=W){const Q=(U*c+G)*4;if(T[Q]<b)continue;const ee=M[Q],O=M[Q+1],m=M[Q+2],P=I0({r:ee,g:O,b:m},s),_=I0({r:ee,g:O,b:m},i);P<F&&P<_?he.push({x:G,y:U}):_<F&&_<P&&Se.push({x:G,y:U})}const se=r.minBlobRatio??.1,ne=L0(he,c,d,W,se),Z=L0(Se,c,d,W,se),pe=ne.count,ke=Z.count,ze=ne.pixels.map(U=>({...U,idx:(U.y*c+U.x)*4})),Ue=Z.pixels.map(U=>({...U,idx:(U.y*c+U.x)*4})),Te=50;let Fe="None",te=null;pe>Te&&pe>ke?(Fe="A",te={color:"A",pixelCount:pe,minY:J,maxY:re,anchorY:Y,rawPixels:he.length,largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize}):ke>Te&&ke>pe&&(Fe="B",te={color:"B",pixelCount:ke,minY:J,maxY:re,anchorY:Y,rawPixels:Se.length,largestBlobSize:Z.largestBlobSize,minBlobSize:Z.minBlobSize});let ue=null,we=null;try{const U=document.createElement("canvas");U.width=c,U.height=d;const G=U.getContext("2d");G.drawImage(a,0,0,c,d),G.fillStyle="rgba(0,0,0,0.6)",G.fillRect(0,0,c,d),G.globalCompositeOperation="destination-out",G.fillStyle="rgba(0,0,0,1)",G.fillRect(0,J,c,re-J),G.globalCompositeOperation="destination-over",G.drawImage(a,0,0,c,d),G.globalCompositeOperation="source-over";const Q=G.createImageData(c,d),ee=Q.data;for(let $=J;$<re;$+=1)for(let X=0;X<c;X+=1){const ie=($*c+X)*4;T[ie]>=b&&(ee[ie]=0,ee[ie+1]=255,ee[ie+2]=255,ee[ie+3]=90)}G.putImageData(Q,0,0);const O=G.createImageData(c,d),m=O.data;for(const $ of ze){const X=$.idx;X>=0&&X<m.length-3&&(m[X]=255,m[X+1]=0,m[X+2]=0,m[X+3]=180)}for(const $ of Ue){const X=$.idx;X>=0&&X<m.length-3&&(m[X]=0,m[X+1]=100,m[X+2]=255,m[X+3]=180)}G.putImageData(O,0,0),G.globalCompositeOperation="source-over",G.strokeStyle="#00FF00",G.lineWidth=3,G.setLineDash([]),G.beginPath(),G.moveTo(0,J),G.lineTo(c,J),G.stroke(),G.strokeStyle="#FFFF00",G.lineWidth=3,G.setLineDash([5,5]),G.beginPath(),G.moveTo(0,re),G.lineTo(c,re),G.stroke(),Y!==J&&Y!==re&&(G.strokeStyle="#FF00FF",G.lineWidth=2,G.setLineDash([2,2]),G.beginPath(),G.moveTo(0,Y),G.lineTo(c,Y),G.stroke()),ue=U.toDataURL("image/png");const P=document.createElement("canvas");P.width=c,P.height=d;const _=P.getContext("2d"),C=_.createImageData(c,d),I=C.data;for(let $=0;$<c*d;$+=1){const X=$*4,ge=T[$*4]>=b?255:0;I[X]=ge,I[X+1]=ge,I[X+2]=ge,I[X+3]=255}_.putImageData(C,0,0),we=P.toDataURL("image/png")}catch(U){console.warn("[ColorDetector] Failed generating preview",U)}const de={mode:"segmentation",width:c,height:d,pixelsA:pe,pixelsB:ke,rawPixelsA:he.length,rawPixelsB:Se.length,tipY:Y,scanDepth:fe,scanDepthRatio:z,anchor:L,bestArm:te,blobInfoA:{largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize,totalBlobs:ne.totalBlobs,filteredBlobs:ne.filteredBlobs,droppedPixels:he.length-pe},blobInfoB:{largestBlobSize:Z.largestBlobSize,minBlobSize:Z.minBlobSize,totalBlobs:Z.totalBlobs,filteredBlobs:Z.filteredBlobs,droppedPixels:Se.length-ke},minBlobRatio:se};return{suggestion:Fe,stats:de,preview:ue,maskPreview:we}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},V5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},Nc=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),Y5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,c=-1/0;for(const v of e){const w=Nc(v,i);w>c&&(c=w,a=v)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,g=!0;for(;g&&h<n;){g=!1;for(let N=0;N<e.length;N++){let D=0,T=1/0;for(let V=0;V<s.length;V++){const j=Nc(e[N],s[V]);j<T&&(T=j,D=V)}d[N]!==D&&(d[N]=D,g=!0)}const v=Array.from({length:s.length},()=>new Array(r).fill(0)),w=new Array(s.length).fill(0);e.forEach((N,D)=>{const T=d[D];w[T]+=1;for(let V=0;V<r;V++)v[T][V]+=N[V]});for(let N=0;N<s.length;N++)w[N]===0?s[N]=e[Math.floor(Math.random()*e.length)].slice():s[N]=v[N].map(D=>D/w[N]);h+=1}return{assignments:d,centroids:s}},X5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await Rp(),r=t.maxFrames||e.length,s=t.stride||2;t.minClothPixels;const i=t.manualBounds||null,a=e.slice(0,r),c=[];let d=0;for(const y of a)try{const k=await Ip(y.frameDataUrl),M=k.naturalWidth||k.width,b=k.naturalHeight||k.height,H=n.segment(k),{maskData:L,maskWidth:F,maskHeight:z,isRGBA:W}=Xv(H.categoryMask,M,b);if(!L){d+=1;continue}const Y=document.createElement("canvas");Y.width=M,Y.height=b;const q=Y.getContext("2d");q.drawImage(k,0,0,M,b);const J=q.getImageData(0,0,M,b).data,re=M/F,fe=b/z;let he,Se=0,se=1,ne=0,Z=M/2,pe=b/2;if(i){if(he=i.bottomY-i.topY,Se=i.rotation||0,Se!==0){const O=-Se*Math.PI/180;se=Math.cos(O),ne=Math.sin(O)}}else he=b;const ke=Math.floor(he/s),ze=Math.floor(M/s),Ue=ke*ze,Fe=Math.max(Math.floor(Ue*.005),20);let te=0,ue=0,we=0,de=0,U=0,G=0;for(let O=0;O<b;O+=s){if(i&&Se===0&&(O<i.topY||O>i.bottomY))continue;const m=Math.min(z-1,Math.floor(O/fe));for(let P=0;P<M;P+=s){if(i&&Se!==0){const $=P-Z,X=O-pe,ie=$*ne+X*se+pe;if(ie<i.topY||ie>i.bottomY)continue}const _=Math.min(F-1,Math.floor(P/re)),C=(m*F+_)*(W?4:1);if(L[C]===4){const $=(O*M+P)*4,X=J[$],ie=J[$+1],ge=J[$+2];te+=X,ue+=ie,we+=ge,de+=P,U+=O,G+=1}}}if(G<Fe){console.log(`[Cloth] Frame ${y.moveId} SKIPPED - cloth pixels: ${G}, threshold: ${Fe}, scan area: ${he}px, manual bounds: ${i?"YES":"NO"}`),d+=1;continue}console.log(`[Cloth] Frame ${y.moveId} ACCEPTED - cloth pixels: ${G}, threshold: ${Fe}, scan area: ${he}px, manual bounds: ${i?`Y:${i.topY}-${i.bottomY}`:"NO"}`);const Q={r:te/G,g:ue/G,b:we/G};let ee=null;try{const O=document.createElement("canvas");O.width=M,O.height=b;const m=O.getContext("2d");m.drawImage(k,0,0,M,b);const P=m.getImageData(0,0,M,b),_=P.data;for(let C=0;C<b;C+=1){const I=Math.min(z-1,Math.floor(C/fe));for(let $=0;$<M;$+=1){const X=Math.min(F-1,Math.floor($/re)),ie=(I*F+X)*(W?4:1);if(L[ie]===4){const Ce=(C*M+$)*4;_[Ce]=Math.round(_[Ce]*.5+50),_[Ce+1]=Math.round(_[Ce+1]*.5+255*.5),_[Ce+2]=Math.round(_[Ce+2]*.5+50)}}}m.putImageData(P,0,0),i&&(m.save(),Se!==0&&(m.translate(Z,pe),m.rotate(Se*Math.PI/180),m.translate(-Z,-pe)),m.strokeStyle="#00FF00",m.lineWidth=3,m.setLineDash([]),m.beginPath(),m.moveTo(-M,i.topY),m.lineTo(M*2,i.topY),m.stroke(),m.strokeStyle="#FFFF00",m.lineWidth=3,m.setLineDash([5,5]),m.beginPath(),m.moveTo(-M,i.bottomY),m.lineTo(M*2,i.bottomY),m.stroke(),m.fillStyle="rgba(0, 255, 0, 0.2)",m.fillRect(-M,i.topY,M*3,i.bottomY-i.topY),m.fillStyle="#00FF00",m.font="bold 16px Arial",m.fillText(`Manual Scan Area (${he}px)`,10,i.topY-10),m.restore()),m.fillStyle="rgba(0, 0, 0, 0.7)",m.fillRect(10,10,300,80),m.fillStyle="#FFFFFF",m.font="bold 14px Arial",m.fillText(`Cloth Pixels: ${G}`,20,30),m.fillText(`Threshold: ${Fe}`,20,50),m.fillText(`Mean Color: ${R0(Q.r,Q.g,Q.b)}`,20,70),ee=O.toDataURL("image/png")}catch(O){console.warn("[ColorDetector] Failed to generate debug preview:",O)}c.push({moveId:y.moveId,meanColor:Q,feature:[Q.r/255,Q.g/255,Q.b/255],centroidX:de/G/M,centroidY:U/G/b,pixelCount:G,existingPlayer:y.existingPlayer||null,debugPreview:ee})}catch(k){console.warn("[ColorDetector] Cloth analysis failed for frame",y.moveId,k),d+=1}if(c.length<2)throw new Error("Not enough frames with detectable clothing");const h=c.map(y=>y.feature),{assignments:g,centroids:v}=Y5(h,Math.min(2,c.length)),w=v.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));g.forEach((y,k)=>{const M=c[k],b=w[y];b.samples.push({moveId:M.moveId,centroidX:M.centroidX,centroidY:M.centroidY,pixelCount:M.pixelCount}),b.sumR+=M.meanColor.r,b.sumG+=M.meanColor.g,b.sumB+=M.meanColor.b,b.sumPixels+=M.pixelCount,b.sumBrightness+=(M.meanColor.r+M.meanColor.g+M.meanColor.b)/3,(M.existingPlayer==="Player A"||M.existingPlayer==="Player B")&&(b.labelCounts[M.existingPlayer]+=1)});const N={};w.forEach((y,k)=>{const M=y.labelCounts["Player A"],b=y.labelCounts["Player B"];M>b?N[k]="Player A":b>M&&(N[k]="Player B")});const D=w.map((y,k)=>{const M=y.sumR/Math.max(1,y.samples.length),b=y.sumG/Math.max(1,y.samples.length),H=y.sumB/Math.max(1,y.samples.length);return{idx:k,hue:V5(M,b,H),brightness:y.sumBrightness/Math.max(1,y.samples.length)}}).sort((y,k)=>y.hue-k.hue||y.brightness-k.brightness),T=["Player A","Player B"];D.forEach(({idx:y})=>{if(!N[y]){const k=Object.values(N),M=T.find(b=>!k.includes(b))||"Player A";N[y]=M}});const V={};g.forEach((y,k)=>{const M=c[k],b=N[y]||(y===0?"Player A":"Player B"),H=v[y],L=v[y===0?1:0],F=Nc(M.feature,H),z=L?Nc(M.feature,L):F,W=L?Math.max(0,1-F/(F+z+1e-6)):1;V[M.moveId]={player:b,clusterId:y,styleLabel:`Style ${y+1}`,confidence:W,stats:{meanColor:M.meanColor,pixelCount:M.pixelCount,debugPreview:M.debugPreview}}});const j=w.map((y,k)=>{const M=y.sumR/Math.max(1,y.samples.length),b=y.sumG/Math.max(1,y.samples.length),H=y.sumB/Math.max(1,y.samples.length),L=R0(M,b,H);return{id:k,styleLabel:`Style ${k+1}`,assignedPlayer:N[k]||(k===0?"Player A":"Player B"),hexColor:L,meanColor:{r:M,g:b,b:H},sampleCount:y.samples.length,avgPixels:y.sumPixels/Math.max(1,y.samples.length),avgBrightness:y.sumBrightness/Math.max(1,y.samples.length),knownAssignments:y.labelCounts}});return{assignments:V,clusters:j,analytics:{totalFrames:a.length,usedFrames:c.length,skippedFrames:d,clusters:j}}};let gd=null;const Rp=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!gd){const e=await Es.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");gd=await fn.createFromOptions(e,{baseOptions:{modelAssetPath:H5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return gd},K5=async e=>{try{const t=await Ip(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await Rp()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let c;if(i.categoryMask.getAsUint8Array)c=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(c=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,c.length===n*r*4){const g=new Uint8Array(n*r);for(let v=0;v<n*r;v++)g[v]=c[v*4];c=g}}else if(i.categoryMask instanceof Uint8Array)c=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const g=new Uint8Array(n*r);for(let v=0;v<n*r;v++)g[v]=h[v*4];c=g}else c=h}return await Promise.all(a.map(async h=>{const g=document.createElement("canvas");g.width=n,g.height=r;const v=g.getContext("2d");v.drawImage(t,0,0,n,r);const w=v.getImageData(0,0,n,r),N=w.data;let D=0;for(let T=0;T<c.length;T++)if(c[T]===h.id){D++;const V=T*4;h.id===0?(N[V]=N[V]*.25,N[V+1]=N[V+1]*.25,N[V+2]=N[V+2]*.25):(N[V]=(N[V]+h.color[0])/2,N[V+1]=(N[V+1]+h.color[1])/2,N[V+2]=(N[V+2]+h.color[2])/2)}return v.putImageData(w,0,0),{...h,pixelCount:D,preview:g.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},Q5=Yv,J5=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),Xi=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),q5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,c=-1/0;for(const v of e){const w=Xi(v,i);w>c&&(c=w,a=v)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,g=!0;for(;g&&h<n;){g=!1;for(let N=0;N<e.length;N++){let D=0,T=1/0;for(let V=0;V<s.length;V++){const j=Xi(e[N],s[V]);j<T&&(T=j,D=V)}d[N]!==D&&(d[N]=D,g=!0)}const v=Array.from({length:s.length},()=>new Array(r).fill(0)),w=new Array(s.length).fill(0);e.forEach((N,D)=>{const T=d[D];w[T]+=1;for(let V=0;V<r;V++)v[T][V]+=N[V]});for(let N=0;N<s.length;N++)w[N]===0?s[N]=e[Math.floor(Math.random()*e.length)].slice():s[N]=v[N].map(D=>D/w[N]);h+=1}return{assignments:d,centroids:s}},Z5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},B0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},F0=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null};let yd=null;const e6=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!yd){const e=await Es.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");yd=await fn.createFromOptions(e,{baseOptions:{modelAssetPath:Q5,delegate:"GPU"},outputCategoryMask:!1,outputConfidenceMasks:!0,runningMode:"IMAGE"})}return yd},t6=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for analysis");const n=await e6(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minPixels||5,a=t.manualBounds||null,c=t.playerColors||null,d=t.sensitivity||.8,h=e.slice(0,r),g=[];let v=0;for(const b of h)try{const H=await J5(b.frameDataUrl),L=H.naturalWidth||H.width,F=H.naturalHeight||H.height,z=n.segment(H),W=z.confidenceMasks[0].getAsFloat32Array(),Y=z.confidenceMasks[0].width,q=z.confidenceMasks[0].height,J=document.createElement("canvas");J.width=L,J.height=F;const re=J.getContext("2d");re.drawImage(H,0,0,L,F);const fe=re.getImageData(0,0,L,F).data,he=L/Y,Se=F/q;let se=0,ne=F,Z=0,pe=1,ke=0,ze=L/2,Ue=F/2;if(a)if(Z=a.rotation||0,Z!==0){const Q=-Z*Math.PI/180;pe=Math.cos(Q),ke=Math.sin(Q),se=0,ne=F}else se=Math.max(0,a.topY),ne=Math.min(F,a.bottomY);let Te=0,Fe=0,te=0,ue=0,we=0,de=0;for(let Q=se;Q<ne;Q+=s){const ee=Math.min(q-1,Math.floor(Q/Se));for(let O=0;O<L;O+=s){if(a&&Z!==0){const C=O-ze,I=Q-Ue,$=C*ke+I*pe+Ue;if($<a.topY||$>a.bottomY)continue}const m=Math.min(Y-1,Math.floor(O/he)),P=ee*Y+m;if(W[P]<d){const C=(Q*L+O)*4,I=fe[C],$=fe[C+1],X=fe[C+2];Te+=I,Fe+=$,te+=X,ue+=O,we+=Q,de+=1}}}if(de<i){v+=1;continue}const U={r:Te/de,g:Fe/de,b:te/de};let G=null;try{const Q=document.createElement("canvas");Q.width=L,Q.height=F;const ee=Q.getContext("2d");ee.drawImage(H,0,0,L,F);const O=ee.getImageData(0,0,L,F),m=O.data;for(let P=0;P<F;P+=1){const _=Math.min(q-1,Math.floor(P/Se));for(let C=0;C<L;C+=1){const I=Math.min(Y-1,Math.floor(C/he)),$=_*Y+I;if(W[$]<d){const ie=(P*L+C)*4;m[ie]=Math.min(255,m[ie]+50),m[ie+1]=Math.max(0,m[ie+1]-20),m[ie+2]=Math.max(0,m[ie+2]-20)}}}if(ee.putImageData(O,0,0),a){ee.save(),Z!==0&&(ee.translate(ze,Ue),ee.rotate(Z*Math.PI/180),ee.translate(-ze,-Ue)),ee.strokeStyle="#00FF00",ee.lineWidth=3,ee.setLineDash([]),ee.beginPath(),ee.moveTo(-L,a.topY),ee.lineTo(L*2,a.topY),ee.stroke(),ee.strokeStyle="#FFFF00",ee.lineWidth=3,ee.setLineDash([5,5]),ee.beginPath(),ee.moveTo(-L,a.bottomY),ee.lineTo(L*2,a.bottomY),ee.stroke(),ee.fillStyle="rgba(0, 255, 0, 0.2)",ee.fillRect(-L,a.topY,L*3,a.bottomY-a.topY);const P=a.bottomY-a.topY;ee.fillStyle="#00FF00",ee.font="bold 16px Arial",ee.fillText(`Manual Scan Area (${P}px)`,10,a.topY-10),ee.restore()}ee.fillStyle="rgba(0, 0, 0, 0.7)",ee.fillRect(10,10,300,80),ee.fillStyle="#FFFFFF",ee.font="bold 14px Arial",ee.fillText(`Non-BG Pixels: ${de}`,20,30),ee.fillText(`Threshold: ${i}`,20,50),ee.fillText(`Mean Color: ${B0(U.r,U.g,U.b)}`,20,70),G=Q.toDataURL("image/png")}catch(Q){console.warn("[ColorDetectorGeneral] Failed to generate debug preview:",Q)}g.push({moveId:b.moveId,meanColor:U,feature:[U.r/255,U.g/255,U.b/255],centroidX:ue/de/L,centroidY:we/de/F,pixelCount:de,existingPlayer:b.existingPlayer||null,debugPreview:G})}catch(H){console.warn("[ColorDetectorGeneral] Analysis failed for frame",b.moveId,H),v+=1}if(g.length<2)throw new Error("Not enough frames with detectable pixels (need at least 2)");const w=g.map(b=>b.feature),{assignments:N,centroids:D}=q5(w,Math.min(2,g.length)),T=D.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));N.forEach((b,H)=>{const L=g[H],F=T[b];F.samples.push({moveId:L.moveId,centroidX:L.centroidX,centroidY:L.centroidY,pixelCount:L.pixelCount}),F.sumR+=L.meanColor.r,F.sumG+=L.meanColor.g,F.sumB+=L.meanColor.b,F.sumPixels+=L.pixelCount,F.sumBrightness+=(L.meanColor.r+L.meanColor.g+L.meanColor.b)/3,(L.existingPlayer==="Player A"||L.existingPlayer==="Player B")&&(F.labelCounts[L.existingPlayer]+=1)});const V={};if(c&&c["Player A"]&&c["Player B"]){const b=F0(c["Player A"]),H=F0(c["Player B"]);if(b&&H){const L=T.map((F,z)=>{const W=F.sumR/Math.max(1,F.samples.length),Y=F.sumG/Math.max(1,F.samples.length),q=F.sumB/Math.max(1,F.samples.length),J=[W,Y,q];return{idx:z,distA:Xi(J,[b.r,b.g,b.b]),distB:Xi(J,[H.r,H.g,H.b])}});if(L.length===2){const F=L[0],z=L[1],W=F.distA+z.distB,Y=F.distB+z.distA;W<Y?(V[F.idx]="Player A",V[z.idx]="Player B"):(V[F.idx]="Player B",V[z.idx]="Player A")}else L.forEach(F=>{F.distA<F.distB?V[F.idx]="Player A":V[F.idx]="Player B"})}}T.forEach((b,H)=>{if(V[H])return;const L=b.labelCounts["Player A"],F=b.labelCounts["Player B"];L>F?V[H]="Player A":F>L&&(V[H]="Player B")});const j=T.map((b,H)=>{const L=b.sumR/Math.max(1,b.samples.length),F=b.sumG/Math.max(1,b.samples.length),z=b.sumB/Math.max(1,b.samples.length);return{idx:H,hue:Z5(L,F,z),brightness:b.sumBrightness/Math.max(1,b.samples.length)}}).sort((b,H)=>b.hue-H.hue||b.brightness-H.brightness),y=["Player A","Player B"];j.forEach(({idx:b})=>{if(!V[b]){const H=Object.values(V),L=y.find(F=>!H.includes(F))||"Player A";V[b]=L}});const k={};N.forEach((b,H)=>{const L=g[H],F=V[b]||(b===0?"Player A":"Player B"),z=D[b],W=D[b===0?1:0],Y=Xi(L.feature,z),q=W?Xi(L.feature,W):Y,J=W?Math.max(0,1-Y/(Y+q+1e-6)):1,re=T[b],fe=re.sumR/Math.max(1,re.samples.length),he=re.sumG/Math.max(1,re.samples.length),Se=re.sumB/Math.max(1,re.samples.length);k[L.moveId]={player:F,clusterId:b,styleLabel:`Style ${b+1}`,confidence:J,stats:{meanColor:{r:fe,g:he,b:Se},pixelCount:L.pixelCount,debugPreview:L.debugPreview}}});const M=T.map((b,H)=>{const L=b.sumR/Math.max(1,b.samples.length),F=b.sumG/Math.max(1,b.samples.length),z=b.sumB/Math.max(1,b.samples.length),W=B0(L,F,z);return{id:H,styleLabel:`Style ${H+1}`,assignedPlayer:V[H]||(H===0?"Player A":"Player B"),hexColor:W,meanColor:{r:L,g:F,b:z},sampleCount:b.samples.length,avgPixels:b.sumPixels/Math.max(1,b.samples.length),avgBrightness:b.sumBrightness/Math.max(1,b.samples.length),knownAssignments:b.labelCounts}});return{assignments:k,clusters:M,analytics:{totalFrames:h.length,usedFrames:g.length,skippedFrames:v,clusters:M}}},vd=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,n6=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function r6({colorPreview:e,onClose:t}){var N,D,T,V,j,y,k,M,b,H,L,F,z,W;const[n,r]=S.useState("overview"),[s,i]=S.useState(null),[a,c]=S.useState(!1),d=async()=>{if(e!=null&&e.original){c(!0);try{const Y=await K5(e.original);i(Y)}catch(Y){console.error("Failed to run multiclass segmentation:",Y)}finally{c(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,g=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,v=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",w=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return l.jsx("div",{className:"image-modal",onClick:t,children:l.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:Y=>Y.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:t,children:""}),l.jsxs("div",{className:"color-preview-tabs",children:[l.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),l.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"color-preview-grid",children:[l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Original Frame"}),l.jsx("img",{src:e.original,alt:"Original frame"})]}),l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Mask View"}),e.preview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((N=e.stats)==null?void 0:N.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((D=e.stats)==null?void 0:D.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),l.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((T=e.stats)==null?void 0:T.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),l.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):l.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&l.jsxs("div",{className:"color-preview-stats",children:[l.jsxs("div",{className:"color-preview-meta",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${g.toLocaleString()} px)`:""]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Method:"})," ",w]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Anchor:"})," ",v]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&l.jsxs("div",{children:[l.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&l.jsxs("div",{children:[l.jsx("strong",{children:"Person coverage:"})," ",n6(e.stats.personPixels)]}),e.stats.reason&&l.jsxs("div",{children:[l.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),l.jsxs("div",{className:"color-preview-calibration",children:[l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player A color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),l.jsx("code",{children:e.colorA||""}),e.calibrationA&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player B color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),l.jsx("code",{children:e.colorB||""}),e.calibrationB&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Scan Zone"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Depth:"})," ",((V=e.stats.scanDepth)==null?void 0:V.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color A Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((j=e.stats.pixelsA)==null?void 0:j.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((y=e.stats.rawPixelsA)==null?void 0:y.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((k=e.stats.blobInfoA.largestBlobSize)==null?void 0:k.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((M=e.stats.blobInfoA.minBlobSize)==null?void 0:M.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color B Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((b=e.stats.pixelsB)==null?void 0:b.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((H=e.stats.rawPixelsB)==null?void 0:H.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((L=e.stats.blobInfoB.largestBlobSize)==null?void 0:L.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((F=e.stats.blobInfoB.minBlobSize)==null?void 0:F.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&l.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[l.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixel Count:"})," ",((z=e.stats.bestArm.pixelCount)==null?void 0:z.toLocaleString())||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((W=e.stats.armRegions)==null?void 0:W.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((Y,q)=>{const J=e.stats.bestArm&&Y.category===e.stats.bestArm.category&&Y.dominantColor===e.stats.bestArm.dominantColor;return l.jsxs("div",{className:"segmentation-card",style:{border:J?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:J?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[l.jsxs("h4",{children:["Arm ",q+1,": ",Y.categoryName,J&&l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Dominant Color:"})," ",l.jsxs("span",{style:{color:Y.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",Y.dominantColor]})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels A:"})," ",Y.pixelsA||0," | ",l.jsx("strong",{children:"Pixels B:"})," ",Y.pixelsB||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Total arm pixels:"})," ",Y.pixelCount||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," Y=",Y.minY,"  ",Y.maxY," (Anchor Y: ",Y.anchorY,")"]})]},q)}):l.jsx("p",{children:"No arms detected with matching colors"})]}):l.jsxs("div",{className:"color-preview-breakdown",children:[l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player A band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",vd(e.stats.pixelsA,g),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player B band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",vd(e.stats.pixelsB,g),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):l.jsxs("div",{className:"multiclass-view",children:[l.jsxs("div",{className:"multiclass-header",children:[l.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),l.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&l.jsxs("div",{className:"loading-indicator",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&l.jsx("div",{className:"multiclass-grid",children:s.map(Y=>l.jsxs("div",{className:"multiclass-card",children:[l.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${Y.color.join(",")})`},children:[l.jsxs("h4",{children:[Y.id,". ",Y.name]}),l.jsx("span",{className:"multiclass-badge",children:vd(Y.pixelCount,g)})]}),l.jsx("p",{className:"multiclass-desc",children:Y.desc}),l.jsx("div",{className:"multiclass-preview-container",children:l.jsx("img",{src:Y.preview,alt:Y.name})}),l.jsxs("div",{className:"multiclass-footer",children:[Y.pixelCount.toLocaleString()," pixels"]})]},Y.id))}),!a&&!s&&l.jsxs("div",{className:"error-message",children:[l.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),l.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function s6({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=S.useState(0),[i,a]=S.useState(0),[c,d]=S.useState(0),[h,g]=S.useState(!1),[v,w]=S.useState(!1),N=S.useRef(null),[D,T]=S.useState(0),[V,j]=S.useState(0),y=S.useRef(null),k=K0.useCallback((z,W,Y,q,J,re,fe)=>{z.clearRect(0,0,J,re),fe&&z.drawImage(fe,0,0),z.save();const he=J/2,Se=re/2;z.translate(he,Se),z.rotate(q*Math.PI/180),z.translate(-he,-Se),z.fillStyle="rgba(0, 255, 0, 0.2)",z.fillRect(-J,W,J*3,Y-W),z.strokeStyle="#00FF00",z.lineWidth=3,z.setLineDash([]),z.beginPath(),z.moveTo(-J,W),z.lineTo(J*2,W),z.stroke(),z.strokeStyle="#FFFF00",z.setLineDash([]),z.beginPath(),z.moveTo(-J,Y),z.lineTo(J*2,Y),z.stroke(),z.fillStyle="#00FF00",z.font="16px Arial",z.fillText("Top",10,W-5),z.fillStyle="#FFFF00",z.fillText("Bottom",10,Y+20),z.restore()},[]);S.useEffect(()=>{if(!e||!N.current)return;const z=new Image;z.crossOrigin="anonymous",z.onload=()=>{const W=N.current,Y=W.getContext("2d");W.width=z.width,W.height=z.height,j(z.width),T(z.height),y.current=z;const q=Math.floor(z.height*.2),J=Math.floor(z.height*.8);s(q),a(J),k(Y,q,J,0,z.width,z.height,z)},e.startsWith("data:image")?z.src=e:z.src=`data:image/jpeg;base64,${e}`},[e,k]),S.useEffect(()=>{if(!N.current||D===0||!y.current)return;const z=N.current.getContext("2d");k(z,r,i,c,V,D,y.current)},[r,i,c,V,D,k]);const M=(z,W)=>{const Y=N.current,q=Y.getBoundingClientRect(),J=Y.width/q.width,re=Y.height/q.height,fe=(z-q.left)*J,he=(W-q.top)*re,Se=Y.width/2,se=Y.height/2,ne=fe-Se,Z=he-se,pe=-c*Math.PI/180;return ne*Math.sin(pe)+Z*Math.cos(pe)+se},b=z=>{const W=M(z.clientX,z.clientY);Math.abs(W-r)<10?g(!0):Math.abs(W-i)<10&&w(!0)},H=z=>{if(!h&&!v)return;const W=M(z.clientX,z.clientY),Y=Math.max(-D,Math.min(D*2,W));if(h){const q=Math.min(Y,i-10);s(q)}else if(v){const q=Math.max(Y,r+10);a(q)}},L=()=>{g(!1),w(!1)},F=()=>{t({topY:r,bottomY:i,rotation:c})};return l.jsx("div",{className:"image-modal",onClick:n,children:l.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:z=>z.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:n,children:""}),l.jsx("h2",{children:"Set Manual Scan Area"}),l.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines. Use slider to rotate."}),l.jsxs("div",{className:"scan-controls",style:{marginBottom:"10px",display:"flex",alignItems:"center",gap:"10px"},children:[l.jsxs("label",{children:["Rotation: ",c,""]}),l.jsx("input",{type:"range",min:"-45",max:"45",value:c,onChange:z=>d(Number(z.target.value)),style:{flex:1}})]}),l.jsx("canvas",{ref:N,onMouseDown:b,onMouseMove:H,onMouseUp:L,onMouseLeave:L,style:{cursor:h||v?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),l.jsx("div",{className:"manual-scan-info",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Top Y:"})," ",Math.round(r)," | ",l.jsx("strong",{children:"Bottom Y:"})," ",Math.round(i)," | ",l.jsx("strong",{children:"Height:"})," ",Math.round(i-r),"px"]})}),l.jsxs("div",{className:"manual-scan-actions",children:[l.jsx("button",{onClick:F,className:"save-btn",children:"Save Bounds"}),l.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const O0=Ga(),i6="adminPassword";function Kv({sessionGameId:e,onClose:t,initialFrames:n=[],clusterColors:r={}}){var O;const[s,i]=S.useState([]),[a,c]=S.useState(0),[d,h]=S.useState(!0),[g,v]=S.useState(null),[w,N]=S.useState(""),[D,T]=S.useState(null),[V,j]=S.useState(!1),[y,k]=S.useState({x:0,y:0}),[M,b]=S.useState({total:0,labeled:0,skipped:0}),[H,L]=S.useState([]),[F,z]=S.useState([]),[W,Y]=S.useState([]),[q,J]=S.useState(!1),[re,fe]=S.useState(null),he=S.useRef(null),Se=S.useRef({x:0,y:0}),se=S.useRef(null),ne=m=>r[m]?r[m]:m==="Player A"?"#FF5722":m==="Player B"?"#2196F3":"#9E9E9E";S.useEffect(()=>{const m=localStorage.getItem(i6);m&&N(m)},[]),S.useEffect(()=>{n&&n.length>0?(i(n),b({total:n.length,labeled:0,skipped:0}),h(!1)):e&&w&&Z()},[e,w,n]);const Z=async()=>{if(w){h(!0),v(null);try{const m=await fetch(`${O0}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":w}});if(!m.ok)throw new Error(`Failed to load session (${m.status})`);const I=((await m.json()).moves||[]).filter($=>$.camera_frame).filter($=>!$.player||$.player==="Unknown"||$.player==="None").map($=>({id:$._id,frameUrl:$.camera_frame,player:$.player||"Unknown",time:$.elapsed,confidence:null,type:$.type,phase:$.phase}));i(I),b({total:I.length,labeled:0,skipped:0})}catch(m){console.error("[SwipeView] Error loading session:",m),v(m.message)}finally{h(!1)}}};S.useCallback(async(m,P,_)=>!e||!m||!w?(console.error("[SwipeView]  Missing required data for update:",{sessionGameId:e,moveId:m,hasPassword:!!w}),!1):(console.log(`[SwipeView]  Frame #${_+1} queued: ${m}  ${P}`),!0),[e,w]);const pe=S.useCallback(async()=>{if(W.length===0)return console.log("[SwipeView] No decisions to save"),!0;if(!e||!w)return console.error("[SwipeView]  Missing sessionGameId or password"),!1;J(!0),fe(null);try{console.log(`[SwipeView]  Saving ${W.length} decisions in batch...`);const m=await fetch(`${O0}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":w},body:JSON.stringify({updates:W.map(_=>({moveId:_.moveId,player:_.player}))})});if(!m.ok)throw new Error(`Failed to save (${m.status})`);const P=await m.json();return console.log("[SwipeView]  Batch save successful:",P),!0}catch(m){return console.error("[SwipeView]  Batch save FAILED:",m.message),fe(m.message),!1}finally{J(!1)}},[W,e,w]),ke=S.useCallback(m=>{if(a>=s.length)return;const P=s[a],_=a;let C;m==="left"?C="Player A":m==="right"?C="Player B":C="None",T(m),b(I=>({...I,labeled:m!=="skip"?I.labeled+1:I.labeled,skipped:m==="skip"?I.skipped+1:I.skipped})),m==="skip"?z(I=>[...I,P.id]):L(I=>[...I,P.id]),Y(I=>[...I,{moveId:P.id,player:C,frameIndex:_}]),console.log(`[SwipeView]  Frame #${_+1}: ${P.id}  ${C}`),setTimeout(()=>{T(null),k({x:0,y:0}),c(I=>I+1)},200)},[a,s]),ze=S.useCallback(()=>{ke("skip")},[ke]),Ue=m=>{j(!0);const P=m.type.includes("touch")?m.touches[0].clientX:m.clientX,_=m.type.includes("touch")?m.touches[0].clientY:m.clientY;Se.current={x:P,y:_}},Te=S.useCallback(m=>{if(!V)return;const P=m.type.includes("touch")?m.touches[0].clientX:m.clientX,_=m.type.includes("touch")?m.touches[0].clientY:m.clientY,C=P-Se.current.x,I=_-Se.current.y;k({x:C,y:I})},[V]),Fe=S.useCallback(()=>{if(!V)return;j(!1);const m=100;y.x>m?ke("right"):y.x<-m?ke("left"):k({x:0,y:0})},[V,y,ke]);S.useEffect(()=>{const m=P=>{if(!(a>=s.length))switch(P.key){case"ArrowLeft":ke("left");break;case"ArrowRight":ke("right");break;case"ArrowDown":case" ":P.preventDefault(),ze();break;case"Escape":t&&t({labeledIds:H,skippedIds:F});break}};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[a,s.length,ke,ze,t,H,F]),S.useEffect(()=>(V&&(window.addEventListener("mousemove",Te),window.addEventListener("mouseup",Fe),window.addEventListener("touchmove",Te),window.addEventListener("touchend",Fe)),()=>{window.removeEventListener("mousemove",Te),window.removeEventListener("mouseup",Fe),window.removeEventListener("touchmove",Te),window.removeEventListener("touchend",Fe)}),[V,Te,Fe]);const te=s[a],ue=s.length>0?a/s.length*100:0,we=a>=s.length,[de,U]=S.useState(!1),G=y.x*.05,Q=Math.max(.5,1-Math.abs(y.x)/400);S.useEffect(()=>{we&&W.length>0&&!q&&!de&&!re&&(console.log("[SwipeView]  Completed! Triggering batch save..."),pe().then(m=>{m&&U(!0)}))},[we,W.length,q,de,re,pe]);const ee=S.useCallback(()=>{t&&t({labeledIds:H,skippedIds:F})},[t,H,F]);return d?l.jsx("div",{className:"swipe-view-container",children:l.jsxs("div",{className:"swipe-view-loading",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Loading frames..."})]})}):g?l.jsx("div",{className:"swipe-view-container",children:l.jsxs("div",{className:"swipe-view-error",children:[l.jsx("h2",{children:"Error"}),l.jsx("p",{children:g}),l.jsx("button",{onClick:ee,className:"close-btn",children:"Close"})]})}):s.length===0?l.jsx("div",{className:"swipe-view-container",children:l.jsxs("div",{className:"swipe-view-empty",children:[l.jsx("h2",{children:" All Done!"}),l.jsx("p",{children:"No frames need review."}),l.jsx("button",{onClick:ee,className:"close-btn",children:"Close"})]})}):l.jsxs("div",{className:"swipe-view-container",ref:se,children:[l.jsxs("header",{className:"swipe-view-header",children:[l.jsx("button",{className:"close-btn",onClick:ee,children:""}),l.jsxs("div",{className:"swipe-view-title",children:[l.jsx("h1",{children:"Swipe View"}),l.jsx("span",{className:"session-badge",children:e})]}),l.jsx("div",{className:"progress-info",children:l.jsxs("span",{children:[a," / ",s.length]})})]}),l.jsx("div",{className:"progress-bar-container",children:l.jsx("div",{className:"progress-bar",style:{width:`${ue}%`}})}),l.jsx("main",{className:"swipe-view-main",children:we?l.jsxs("div",{className:"swipe-complete",children:[l.jsx("div",{className:"complete-icon",children:""}),l.jsx("h2",{children:"All Done!"}),l.jsxs("div",{className:"complete-stats",children:[l.jsxs("div",{className:"stat",children:[l.jsx("span",{className:"stat-value",children:M.labeled}),l.jsx("span",{className:"stat-label",children:"Labeled"})]}),l.jsxs("div",{className:"stat",children:[l.jsx("span",{className:"stat-value",children:M.skipped}),l.jsx("span",{className:"stat-label",children:"Skipped"})]}),l.jsxs("div",{className:"stat",children:[l.jsx("span",{className:"stat-value",children:M.total}),l.jsx("span",{className:"stat-label",children:"Total"})]})]}),q&&l.jsxs("div",{style:{color:"#FFC107",marginTop:"16px",fontSize:"14px"},children:[" Saving ",W.length," changes..."]}),re&&l.jsxs("div",{style:{color:"#f44336",marginTop:"8px",fontSize:"14px"},children:[" Save failed: ",re,l.jsx("button",{onClick:()=>{fe(null),pe().then(m=>{m&&U(!0)})},style:{marginLeft:"8px",padding:"4px 8px",cursor:"pointer"},children:"Retry"})]}),de&&l.jsxs("div",{style:{color:"#4CAF50",marginTop:"16px",fontSize:"14px"},children:[" All ",W.length," changes saved!"]}),!q&&!re&&!de&&W.length===0&&l.jsx("div",{style:{color:"#4CAF50",marginTop:"16px",fontSize:"14px"},children:" Nothing to save"}),l.jsx("button",{onClick:ee,className:"done-btn",disabled:q,style:q?{opacity:.5,cursor:"wait"}:{},children:q?"Saving...":"Done"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"swipe-arrow left",onClick:()=>ke("left"),style:{backgroundColor:ne("Player A")},children:[l.jsx("span",{className:"arrow-icon",children:""}),l.jsx("span",{className:"arrow-label",children:"Player A"})]}),l.jsxs("div",{className:"swipe-card-container",children:[l.jsxs("div",{ref:he,className:`swipe-card ${D?`swiping-${D}`:""} ${V?"dragging":""}`,style:{transform:`translateX(${y.x}px) rotate(${G}deg)`,opacity:D?0:Q},onMouseDown:Ue,onTouchStart:Ue,children:[l.jsx("div",{className:"swipe-indicator left",style:{opacity:y.x<-30?Math.min(1,Math.abs(y.x)/100):0,backgroundColor:ne("Player A")},children:"Player A"}),l.jsx("div",{className:"swipe-indicator right",style:{opacity:y.x>30?Math.min(1,y.x/100):0,backgroundColor:ne("Player B")},children:"Player B"}),l.jsx("div",{className:"frame-image-container",children:l.jsx("img",{src:te.frameUrl,alt:`Frame ${a+1}`,draggable:!1})}),l.jsxs("div",{className:"frame-info",children:[l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Player:"}),l.jsx("span",{className:"info-value",children:te.player||"Unknown"})]}),l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Time:"}),l.jsxs("span",{className:"info-value",children:[((O=te.time)==null?void 0:O.toFixed(1))||"","s"]})]}),l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Confidence:"}),l.jsx("span",{className:"info-value",children:te.confidence!=null?`${Math.round(te.confidence*100)}%`:"Skipped"})]}),te.styleLabel&&l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Style:"}),l.jsx("span",{className:"info-value",children:te.styleLabel})]})]})]}),l.jsx("button",{className:"skip-btn",onClick:ze,children:"Skip (None)"})]}),l.jsxs("div",{className:"swipe-arrow right",onClick:()=>ke("right"),style:{backgroundColor:ne("Player B")},children:[l.jsx("span",{className:"arrow-icon",children:""}),l.jsx("span",{className:"arrow-label",children:"Player B"})]})]})}),l.jsxs("footer",{className:"swipe-view-footer",children:[l.jsxs("div",{className:"keyboard-hints",children:[l.jsx("span",{children:" Player A"}),l.jsx("span",{children:" or Space: Skip"}),l.jsx("span",{children:" Player B"}),l.jsx("span",{children:"Esc: Close"})]}),l.jsx("div",{className:"sync-status",style:{marginTop:"8px",display:"flex",justifyContent:"center",gap:"16px"},children:W.length>0&&l.jsxs("span",{style:{color:"#90CAF9",fontSize:"12px"},children:[" ",W.length," queued (saves at end)"]})})]})]})}const _l=Ga(),o6="adminPassword",Ri=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),a6=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function l6({sessionGameId:e}){var Fo,Ei,Ci,Oo,_n,Hn,vs,ji,_i,$o;const[t,n]=S.useState(null),[r,s]=S.useState(!0),[i,a]=S.useState(null),[c,d]=S.useState(null),[h,g]=S.useState(null),[v,w]=S.useState("all"),[N,D]=S.useState("all"),[T,V]=S.useState(""),[j,y]=S.useState(!1),[k,M]=S.useState({}),[b,H]=S.useState({current:0,total:0}),[L,F]=S.useState("#FF0000"),[z,W]=S.useState("#0000FF"),[Y,q]=S.useState(!1),[J,re]=S.useState(!1),[fe,he]=S.useState({}),[Se,se]=S.useState({current:0,total:0}),[ne,Z]=S.useState("bottom"),[pe,ke]=S.useState(100),[ze,Ue]=S.useState(null),[Te,Fe]=S.useState(null),[te,ue]=S.useState(!1),[we,de]=S.useState(null),[U,G]=S.useState(!1),[Q,ee]=S.useState(null),[O,m]=S.useState({}),[P,_]=S.useState(!1),[C,I]=S.useState(""),[$,X]=S.useState(!1),[ie,ge]=S.useState(null),[Ce,Re]=S.useState("chronological"),[Oe,nt]=S.useState(55),[qe,lt]=S.useState(!1),[ct,Ge]=S.useState({current:0,total:0}),[He,Ve]=S.useState(null),[Ze,Ct]=S.useState(!1),[On,mt]=S.useState([]),[Dt,Pt]=S.useState({}),tn=S.useCallback(async B=>{if(!B)return{suggestion:"None",stats:null};try{const le=await G5(B,L,z,{anchor:ne,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:ne==="manually"&&Te?null:pe/100,manualBounds:ne==="manually"?Te:null});if(le)return le}catch(le){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",le)}return W5(B,L,z,{anchor:ne})},[L,z,ne,pe,Te]);S.useEffect(()=>{const B=localStorage.getItem(o6);B&&V(B)},[]),S.useEffect(()=>{e&&T&&cn()},[e,T]);const ln=B=>{if(!B||typeof B.h>"u")return null;const le=(B.h||0)*2,me=(B.s||0)/255,ae=(B.v||0)/255,ve=ae*me,Be=ve*(1-Math.abs(le/60%2-1)),je=ae-ve;let We=0,Le=0,Ke=0;le>=0&&le<60?(We=ve,Le=Be,Ke=0):le<120?(We=Be,Le=ve,Ke=0):le<180?(We=0,Le=ve,Ke=Be):le<240?(We=0,Le=Be,Ke=ve):le<300?(We=Be,Le=0,Ke=ve):(We=ve,Le=0,Ke=Be);const Xt=ir=>{const Nn=Math.round((ir+je)*255).toString(16);return Nn.length===1?"0"+Nn:Nn};return`#${Xt(We)}${Xt(Le)}${Xt(Ke)}`.toUpperCase()},cn=async()=>{var B,le,me,ae;if(T){s(!0),a(null);try{const ve=await fetch(`${_l}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":T}});if(!ve.ok)throw new Error(`Failed to load session (${ve.status})`);const Be=await ve.json();n(Be);let je=null,We=null,Le="";if(Be.colorA&&Be.colorB?(je=Be.colorA,We=Be.colorB,Le="session root"):(le=(B=Be.metadata)==null?void 0:B.config)!=null&&le.colorA&&((ae=(me=Be.metadata)==null?void 0:me.config)!=null&&ae.colorB)&&(je=Be.metadata.config.colorA,We=Be.metadata.config.colorB,Le="session metadata"),je&&We)F(je),W(We),console.log(`[MoveHistoryEditor]  Loaded colors from ${Le}:`,je,We);else try{const Ke=JSON.parse(localStorage.getItem("calibrationA")||"null"),Xt=JSON.parse(localStorage.getItem("calibrationB")||"null");if(Ke&&Xt){const ir=ln(Ke),Nn=ln(Xt);ir&&Nn?(F(ir),W(Nn),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",ir,Nn)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch(Ke){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",Ke),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(ve){console.error("[MoveHistoryEditor] Error loading session:",ve),a(ve.message)}finally{s(!1)}}},En=async(B,le)=>{if(!(!e||!B||!T))try{const me=await fetch(`${_l}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent(B)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":T},body:JSON.stringify({player:le})});if(!me.ok)throw new Error(`Failed to update player (${me.status})`);n(ae=>ae&&{...ae,moves:ae.moves.map(ve=>ve._id===B?{...ve,player:le}:ve)}),M(ae=>{const ve={...ae};return delete ve[B],ve}),console.log("[MoveHistoryEditor] Player updated:",B,le)}catch(me){console.error("[MoveHistoryEditor] Error updating player:",me),alert("Failed to update player: "+me.message)}},Cn=async B=>{const le=k[B];le&&await En(B,le.player)},Jr=async B=>{const le=fe[B];le&&(await En(B,le.player),he(me=>{const ae={...me};return delete ae[B],ae}))},Fr=async B=>{if(!t||!Array.isArray(t.moves))return;const le=t.moves.find(me=>me._id===B);if(!le||!le.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${B}`);const me=await tn(le.camera_frame);if(!me){alert("Color-based identification failed for this move.");return}he(Be=>({...Be,[B]:{method:"color",player:me.suggestion==="A"?"Player A":me.suggestion==="B"?"Player B":"None",stats:me.stats,preview:me.preview}}));let ae=null,ve=null;try{ae=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{ae=null}try{ve=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{ve=null}Ue({moveId:B,original:le.camera_frame,preview:me.preview,maskPreview:me.maskPreview,stats:me.stats,suggestion:me.suggestion,colorA:L,colorB:z,calibrationA:ae,calibrationB:ve,anchor:ne})}catch(me){console.error("[MoveHistoryEditor] Error color-identifying move:",me),alert("Color-based identification failed: "+me.message)}},$n=S.useCallback(async({mode:B})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const le=t.moves.filter(ae=>ae.camera_frame);if(le.length===0){alert("No camera frames available for cloth-based identification.");return}const me=new Set(t.moves.filter(ae=>!ae.player||ae.player==="Unknown"||ae.player==="None").map(ae=>ae._id));if(B==="unknown"&&me.size===0){alert("All moves already have players assigned.");return}G(!0),ee(null);try{const ae=le.map(Le=>({moveId:Le._id,frameDataUrl:Le.camera_frame,existingPlayer:Le.player&&Le.player!=="Unknown"?Le.player:null})),ve=await X5(ae,{maxFrames:le.length,stride:2,minClothPixels:80,manualBounds:ne==="manually"?Te:null});ve!=null&&ve.analytics&&ee(ve.analytics);const Be={};ve!=null&&ve.assignments&&Object.entries(ve.assignments).forEach(([Le,Ke])=>{var Xt;(Xt=Ke.stats)!=null&&Xt.debugPreview&&(Be[Le]=Ke.stats.debugPreview)}),Object.keys(Be).length>0&&m(Be);const je={};ve!=null&&ve.assignments&&Object.entries(ve.assignments).forEach(([Le,Ke])=>{(B==="all"||me.has(Le))&&(je[Le]={method:"cloth",player:Ke.player,styleLabel:Ke.styleLabel,confidence:Ke.confidence,stats:Ke.stats})});const We=Object.keys(je).length;We===0?alert(`Cloth-based method did not find suggestions for any ${B==="all"?"moves":"unknown moves"}.`):(he(Ke=>({...Ke,...je})),alert(`Cloth-based method suggested players for ${We} ${B==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(ae){console.error("[MoveHistoryEditor] Cloth identification failed:",ae),alert("Cloth-based identification failed: "+ae.message)}finally{G(!1)}},[t,ne,Te]);S.useCallback(()=>{$n({mode:"all"})},[$n]),S.useCallback(()=>{$n({mode:"unknown"})},[$n]);const Dn=S.useCallback(async({mode:B})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const le=t.moves.filter(ae=>ae.camera_frame);if(le.length===0){alert("No camera frames available for All-All identification.");return}const me=new Set(t.moves.filter(ae=>!ae.player||ae.player==="Unknown"||ae.player==="None").map(ae=>ae._id));if(B==="unknown"&&me.size===0){alert("All moves already have players assigned.");return}X(!0),ge(null);try{const ae=le.map(Le=>({moveId:Le._id,frameDataUrl:Le.camera_frame,existingPlayer:Le.player&&Le.player!=="Unknown"&&Le.player!=="None"?Le.player:null})),ve=await t6(ae,{maxFrames:le.length,stride:2,minPixels:80,manualBounds:ne==="manually"?Te:null,playerColors:{"Player A":L,"Player B":z}});ve!=null&&ve.analytics&&ge(ve.analytics);const Be={};ve!=null&&ve.assignments&&Object.entries(ve.assignments).forEach(([Le,Ke])=>{var Xt;(Xt=Ke.stats)!=null&&Xt.debugPreview&&(Be[Le]=Ke.stats.debugPreview)}),Object.keys(Be).length>0&&m(Le=>({...Le,...Be}));const je={};ve!=null&&ve.assignments&&Object.entries(ve.assignments).forEach(([Le,Ke])=>{(B==="all"||me.has(Le))&&(je[Le]={method:"allall",player:Ke.player,styleLabel:Ke.styleLabel,confidence:Ke.confidence,stats:Ke.stats})});const We=Object.keys(je).length;We===0?alert(`All-All method did not find suggestions for any ${B==="all"?"moves":"unknown moves"}.`):(he(Ke=>({...Ke,...je})),alert(`All-All method suggested players for ${We} ${B==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(ae){console.error("[MoveHistoryEditor] All-All identification failed:",ae),alert("All-All identification failed: "+ae.message)}finally{X(!1)}},[t,ne,Te]),ys=S.useCallback(()=>{Dn({mode:"all"})},[Dn]),zn=S.useCallback(()=>{Dn({mode:"unknown"})},[Dn]),Si=async B=>{if(!(!e||!T))try{console.log(`[MoveHistoryEditor] Identifying single move: ${B}`);const le=await fetch(`${_l}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":T},body:JSON.stringify({sessionGameId:e,moveId:B,colorA:L,colorB:z,cameraPosition:ne==="top"||ne==="bottom"?ne:void 0})});if(le.ok){const me=await le.json();M(ae=>({...ae,[B]:{player:me.suggestion==="A"?"Player A":me.suggestion==="B"?"Player B":"None",confidence:me.confidence,rawResponse:me.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${me.suggestion}`)}else{const me=await le.json();alert(`Failed to identify move: ${me.message}`)}}catch(le){console.error("[MoveHistoryEditor] Error identifying move:",le),alert("AI identification failed: "+le.message)}},jn=((Fo=t==null?void 0:t.moves)==null?void 0:Fo.filter(B=>{let le=!0;v!=="all"&&(le=B.phase===v);let me=!0;return N!=="all"&&(N==="None"?me=!B.player||B.player==="None"||B.player==="Unknown":me=B.player===N),le&&me}))||[],Js=(()=>{const B=[...jn];return Ce==="chronological"?B:B.sort((le,me)=>{var We,Le;const ae=!!fe[le._id],ve=!!fe[me._id];if(ae&&!ve)return-1;if(!ae&&ve)return 1;if(!ae&&!ve)return 0;const Be=((We=fe[le._id])==null?void 0:We.confidence)||0,je=((Le=fe[me._id])==null?void 0:Le.confidence)||0;return Ce==="confidenceDesc"?je-Be:Ce==="confidenceAsc"?Be-je:0})})(),xt=async()=>{if(!e||!T)return;const B=Object.entries(fe).filter(([le,me])=>(me.confidence||0)*100>=Oe).map(([le,me])=>({moveId:le,player:me.player}));if(B.length===0){alert(`No moves found with confidence above ${Oe}%`);return}if(window.confirm(`Are you sure you want to confirm ${B.length} moves with confidence >= ${Oe}%?`)){lt(!0),Ge({current:0,total:B.length});try{const le=await fetch(`${_l}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":T},body:JSON.stringify({updates:B})});if(!le.ok)throw new Error(`Failed to update players (${le.status})`);const me=await le.json();console.log("[MoveHistoryEditor] Bulk update success:",me),n(ae=>{if(!ae)return ae;const ve=ae.moves.map(Be=>{const je=B.find(We=>We.moveId===Be._id);return je?{...Be,player:je.player}:Be});return{...ae,moves:ve}}),he(ae=>{const ve={...ae};return B.forEach(({moveId:Be})=>{delete ve[Be]}),ve}),alert(`Successfully confirmed ${B.length} moves.`)}catch(le){console.error("Failed to confirm moves:",le),alert("Failed to confirm moves: "+le.message)}finally{lt(!1),Ge({current:0,total:0})}}},Un=()=>{if(!t||!Array.isArray(t.moves))return;const B={};ie!=null&&ie.clusters?ie.clusters.forEach(je=>{je.assignedPlayer&&je.hexColor&&(B[je.assignedPlayer]=je.hexColor)}):Q!=null&&Q.clusters&&Q.clusters.forEach(je=>{je.assignedPlayer&&je.hexColor&&(B[je.assignedPlayer]=je.hexColor)}),B["Player A"]||(B["Player A"]=L),B["Player B"]||(B["Player B"]=z);const le=t.moves.filter(je=>je.camera_frame),me=le.filter(je=>{const We=fe[je._id];return We?(We.confidence||0)*100<Oe:!1}).map(je=>{const We=fe[je._id];return{id:je._id,frameUrl:je.camera_frame,player:je.player||"Unknown",time:je.elapsed,confidence:(We==null?void 0:We.confidence)||null,styleLabel:We==null?void 0:We.styleLabel,type:je.type,phase:je.phase,needsReview:!0}}),ae=new Set(me.map(je=>je.id)),ve=le.filter(je=>!ae.has(je._id)&&(!je.player||je.player==="Unknown"||je.player==="None")).map(je=>({id:je._id,frameUrl:je.camera_frame,player:je.player||"Unknown",time:je.elapsed,confidence:null,type:je.type,phase:je.phase,needsReview:!0})),Be=[...me,...ve];if(Be.length===0){alert("No frames need review! All frames are either confirmed or have high confidence.");return}mt(Be),Pt(B),Ct(!0)},Bo=B=>{Ct(!1),B!=null&&B.labeledIds&&B.labeledIds.length>0&&(he(le=>{const me={...le};return B.labeledIds.forEach(ae=>{delete me[ae]}),me}),M(le=>{const me={...le};return B.labeledIds.forEach(ae=>{delete me[ae]}),me})),cn()};if(r)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return l.jsx("div",{className:"move-editor-container",children:l.jsxs("div",{className:"move-editor-error",children:[l.jsx("h2",{children:"Error Loading Session"}),l.jsx("p",{children:i}),l.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-error",children:"Session not found"})});const vu=((Ei=t.moves)==null?void 0:Ei.filter(B=>B.phase==="practice").length)||0,ki=((Ci=t.moves)==null?void 0:Ci.filter(B=>B.phase==="experiment").length)||0,Ai=((Oo=t.moves)==null?void 0:Oo.filter(B=>B.player==="Player A").length)||0,qs=((_n=t.moves)==null?void 0:_n.filter(B=>B.player==="Player B").length)||0,Zs=((Hn=t.moves)==null?void 0:Hn.filter(B=>!B.player||B.player==="None"||B.player==="Unknown").length)||0;return l.jsxs("div",{className:"move-editor-container",children:[l.jsxs("header",{className:"move-editor-header",children:[l.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),l.jsxs("div",{className:"move-editor-title",children:[l.jsx("h1",{children:"Move History Editor"}),l.jsxs("div",{className:"session-info",children:[l.jsxs("span",{className:"session-id",children:["Session: ",e]}),l.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),l.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]}),l.jsxs("div",{className:"player-stats",style:{marginTop:"5px",fontSize:"0.9em"},children:[l.jsxs("span",{style:{marginRight:"15px",color:L,fontWeight:"bold"},children:["Player A: ",Ai]}),l.jsxs("span",{style:{color:z,fontWeight:"bold"},children:["Player B: ",qs]})]})]}),l.jsxs("div",{className:"header-center-group",children:[l.jsxs("div",{className:"phase-filter",children:[l.jsxs("button",{className:`filter-btn ${v==="all"?"active":""}`,onClick:()=>w("all"),children:["All (",((vs=t.moves)==null?void 0:vs.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${v==="practice"?"active":""}`,onClick:()=>w("practice"),children:["Practice (",vu,")"]}),l.jsxs("button",{className:`filter-btn ${v==="experiment"?"active":""}`,onClick:()=>w("experiment"),children:["Experiment (",ki,")"]})]}),l.jsxs("div",{className:"player-filter",style:{marginTop:"4px"},children:[l.jsxs("button",{className:`filter-btn ${N==="all"?"active":""}`,onClick:()=>D("all"),children:["All Players (",((ji=t.moves)==null?void 0:ji.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${N==="Player A"?"active":""}`,onClick:()=>D("Player A"),style:{borderColor:L,color:N==="Player A"?"white":L,backgroundColor:N==="Player A"?L:"transparent"},children:["Player A (",Ai,")"]}),l.jsxs("button",{className:`filter-btn ${N==="Player B"?"active":""}`,onClick:()=>D("Player B"),style:{borderColor:z,color:N==="Player B"?"white":z,backgroundColor:N==="Player B"?z:"transparent"},children:["Player B (",qs,")"]}),l.jsxs("button",{className:`filter-btn ${N==="None"?"active":""}`,onClick:()=>D("None"),children:["None/Unknown (",Zs,")"]})]})]}),l.jsxs("div",{className:"header-controls-group",children:[l.jsxs("div",{className:"bracelet-colors-controls",children:[l.jsx("button",{className:"color-picker-toggle",onClick:()=>q(!Y),children:"Bracelet Colors"}),Y&&l.jsxs("div",{className:"color-picker-panel",children:[l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player A:"}),l.jsx("input",{type:"color",value:L,onChange:B=>F(B.target.value)}),l.jsx("span",{children:L})]}),l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player B:"}),l.jsx("input",{type:"color",value:z,onChange:B=>W(B.target.value)}),l.jsx("span",{children:z})]})]})]}),l.jsxs("div",{className:"color-controls",children:[Object.keys(O).length>0&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:`ai-btn debug-btn ${P?"active":""}`,onClick:()=>_(!P),style:{backgroundColor:P?"#4CAF50":"#666",marginLeft:"20px"},children:P?" Debug View ON":" Show Debug View"}),l.jsx("button",{className:"ai-btn debug-btn",onClick:()=>{_(!1),m({})},style:{backgroundColor:"#ff5722"},children:" Clear Debug"})]}),l.jsx("button",{className:"ai-btn allall-btn",onClick:ys,disabled:$,children:$?" Identifying by All All...":" Identify by All All"}),l.jsx("button",{className:"ai-btn allall-btn",onClick:zn,disabled:$,children:$?" Identifying by All All...":" Identify by All Unknown"}),l.jsxs("button",{onClick:Un,style:{background:"linear-gradient(135deg, #9C27B0, #673AB7)",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px",boxShadow:"0 2px 8px rgba(156, 39, 176, 0.3)"},title:"Open Swipe View to review frames",children:[" Swipe View (",(()=>{const B=new Set(((t==null?void 0:t.moves)||[]).filter(me=>me.camera_frame&&(!me.player||me.player==="Unknown"||me.player==="None")).map(me=>me._id));return new Set(Object.entries(fe).filter(([,me])=>(me.confidence||0)*100<Oe).map(([me])=>me)).forEach(me=>B.add(me)),B.size})(),")"]}),l.jsxs("div",{className:"color-anchor-toggle",style:{display:"flex",alignItems:"center",gap:"10px"},children:[l.jsxs("div",{className:"scan-mode-radios",style:{display:"flex",gap:"10px",alignItems:"center"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("input",{type:"radio",name:"scanMode",checked:ne!=="manually",onChange:()=>{Z("bottom"),ue(!1),Fe(null),de(null)}}),"General"]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("input",{type:"radio",name:"scanMode",checked:ne==="manually",onChange:()=>{Z("manually");const B=(t==null?void 0:t.moves)||[];if(B.length>0){const le=B[Math.floor(Math.random()*B.length)];le!=null&&le.camera_frame?(de(le.camera_frame),ue(!0)):(alert("No frames available. Please ensure moves have camera frames."),Z("bottom"))}else alert("No moves available."),Z("bottom")}}),"Manual"]})]}),ne!=="manually"&&l.jsxs(l.Fragment,{children:[l.jsx("label",{children:"Scan area:"}),l.jsxs("select",{value:ne,onChange:B=>Z(B.target.value),style:{padding:"6px",borderRadius:"4px",background:"#222",color:"#fff",border:"1px solid #444"},children:[l.jsx("option",{value:"bottom",children:"Bottom"}),l.jsx("option",{value:"top",children:"Top"})]}),l.jsxs("div",{className:"color-scan-percentage",children:[l.jsxs("label",{children:[pe,"%"]}),l.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:pe,onChange:B=>ke(Number(B.target.value)),style:{width:"80px",marginLeft:"8px"}})]})]}),ne==="manually"&&l.jsxs("div",{className:"manual-bounds-info",style:{display:"flex",alignItems:"center",gap:"8px"},children:[Te?l.jsxs("span",{style:{fontSize:"12px",color:"#aaa"},children:["Y: ",Math.round(Te.topY),"",Math.round(Te.bottomY)]}):l.jsx("span",{style:{fontSize:"12px",color:"#f44336"},children:"Not set"}),l.jsx("button",{onClick:()=>{if(we)ue(!0);else{const B=(t==null?void 0:t.moves)||[],le=B[Math.floor(Math.random()*B.length)];le!=null&&le.camera_frame&&(de(le.camera_frame),ue(!0))}},className:"ai-btn",style:{padding:"4px 8px",fontSize:"12px",backgroundColor:"#2196F3"},children:"Change scan area"})]})]})]})]})]}),Q&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsx("div",{className:"cloth-analytics-header",children:l.jsxs("div",{children:[l.jsx("h3",{children:"Cloth Styles Analytics"}),l.jsxs("p",{children:["Frames analyzed: ",Q.usedFrames,"/",Q.totalFrames,"  Skipped:"," ",Q.skippedFrames]})]})}),l.jsx("div",{className:"cloth-style-grid",children:(_i=Q.clusters)==null?void 0:_i.map(B=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:B.styleLabel}),l.jsx("span",{className:"player-label",children:B.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:B.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",B.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",B.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Ri(B.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Ri(B.avgBrightness||0)]})]})]},B.id))})]}),ie&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsxs("div",{className:"cloth-analytics-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:" All-All Styles Analytics (Background Excluded)"}),l.jsxs("p",{children:["Frames analyzed: ",ie.usedFrames,"/",ie.totalFrames,"  Skipped:"," ",ie.skippedFrames]})]}),l.jsxs("div",{className:"analytics-controls",style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"15px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#f5f5f5",padding:"4px 8px",borderRadius:"4px"},children:[l.jsxs("label",{style:{fontSize:"14px"},children:["Confirm threshold: ",Oe,"%"]}),l.jsx("input",{type:"range",min:"50",max:"100",value:Oe,onChange:B=>nt(Number(B.target.value)),style:{width:"100px"}}),l.jsx("button",{onClick:xt,disabled:qe,style:{backgroundColor:qe?"#9E9E9E":"#4CAF50",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:qe?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",minWidth:"140px"},children:qe?`Saving ${ct.current}/${ct.total}...`:`Confirm All  ${Oe}% (${Object.values(fe).filter(B=>(B.confidence||0)*100>=Oe).length})`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("label",{children:"Sort by:"}),l.jsxs("select",{value:Ce,onChange:B=>Re(B.target.value),style:{padding:"4px",borderRadius:"4px"},children:[l.jsx("option",{value:"chronological",children:"Chronological"}),l.jsx("option",{value:"confidenceDesc",children:"Confidence (High to Low)"}),l.jsx("option",{value:"confidenceAsc",children:"Confidence (Low to High)"})]})]}),l.jsx("button",{onClick:Un,style:{background:"linear-gradient(135deg, #9C27B0, #673AB7)",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px",boxShadow:"0 2px 8px rgba(156, 39, 176, 0.3)"},title:"Open Swipe View to review unconfirmed frames",children:" Review Unconfirmed"})]})]}),l.jsx("div",{className:"cloth-style-grid",children:($o=ie.clusters)==null?void 0:$o.map(B=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:B.styleLabel}),l.jsx("span",{className:"player-label",children:B.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:B.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",B.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",B.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Ri(B.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Ri(B.avgBrightness||0)]})]})]},B.id))})]}),l.jsxs("div",{className:"move-editor-content",children:[l.jsx("div",{className:"moves-grid",children:Js.map((B,le)=>{var me;return l.jsxs("div",{className:`move-card ${(c==null?void 0:c._id)===B._id?"selected":""}`,onClick:()=>d(B),children:[l.jsxs("div",{className:"move-card-header",children:[l.jsxs("span",{className:"move-number",children:["#",le+1]}),l.jsx("span",{className:`move-phase ${B.phase}`,children:B.phase})]}),B.camera_frame&&l.jsxs("div",{className:"move-image",onClick:ae=>{ae.stopPropagation(),g(P&&O[B._id]?O[B._id]:B.camera_frame)},style:{position:"relative"},children:[l.jsx("img",{src:P&&O[B._id]?O[B._id]:B.camera_frame,alt:`Move ${le+1}`}),l.jsx("div",{className:"image-overlay",children:" Click to enlarge"}),P&&O[B._id]&&l.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(76, 175, 80, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:" DEBUG"})]}),l.jsxs("div",{className:"move-card-body",children:[l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Type:"}),l.jsx("span",{className:"value",children:B.type})]}),k[B._id]&&(()=>{const ae=k[B._id].player,Be=ae==="A"||ae==="Player A"?L:z;return l.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:Be,outline:`2px solid ${a6(Be,.25)}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:""}),l.jsxs("span",{className:"ai-text",children:["AI suggests: ",l.jsx("strong",{children:k[B._id].player})]})]}),l.jsx("button",{className:"ai-confirm-btn",onClick:je=>{je.stopPropagation(),Cn(B._id)},children:" Confirm"})]})})(),fe[B._id]&&(()=>{const ae=fe[B._id],je=ae.player==="Player A"?L:z,We=ae.method||"color",Le=We==="cloth"?"":We==="allall"?"":"",Ke=We==="cloth"?`Cloth suggests${ae.styleLabel?` (${ae.styleLabel})`:""}:`:We==="allall"?`All-All suggests${ae.styleLabel?` (${ae.styleLabel})`:""}:`:"Color suggests:",Xt=typeof ae.confidence=="number"?`  ${Math.round(ae.confidence*100)}% confidence`:"";let ir=je;if(ae.stats&&ae.stats.meanColor){const{r:Nn,g:Ja,b:qa}=ae.stats.meanColor,Kt=Za=>{const Ni=Math.round(Za).toString(16);return Ni.length===1?"0"+Ni:Ni};ir=`#${Kt(Nn)}${Kt(Ja)}${Kt(qa)}`}return l.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:ir,borderWidth:"2px",outline:`4px solid ${ir}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:Le}),l.jsxs("span",{className:"ai-text",children:[Ke," ",l.jsx("strong",{children:ae.player}),Xt]})]}),l.jsx("button",{className:"ai-confirm-btn",disabled:He===B._id,onClick:async Nn=>{Nn.stopPropagation(),Ve(B._id),await Jr(B._id),Ve(null)},children:He===B._id?"...":" Confirm"})]})})(),l.jsxs("div",{className:"move-info-row player-row",style:{borderColor:B.player==="Player A"?L:B.player==="Player B"?z:B.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("span",{className:"label",children:"Player:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[l.jsxs("select",{className:`player-select ${(me=B.player)==null?void 0:me.toLowerCase().replace(" ","-")}`,value:B.player||"Unknown",onChange:ae=>En(B._id,ae.target.value),onClick:ae=>ae.stopPropagation(),style:{flex:1,borderColor:B.player==="Player A"?L:B.player==="Player B"?z:B.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]}),B.camera_frame&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"ai-single-btn",onClick:ae=>{ae.stopPropagation(),Si(B._id)},title:"Identify this move with AI",children:""}),l.jsx("button",{className:"ai-single-btn color-single-btn",onClick:ae=>{ae.stopPropagation(),Fr(B._id)},title:"Identify this move by color",children:""})]})]})]}),B.blockId!==null&&B.blockId!==void 0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Block:"}),l.jsx("span",{className:"value",children:B.blockId})]}),Array.isArray(B.position)&&B.position.length===2&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Position:"}),l.jsxs("span",{className:"value",children:["(",B.position[0],", ",B.position[1],")"]})]}),l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Time:"}),l.jsxs("span",{className:"value",children:[Ri(B.elapsed,1),"s"]})]}),Number.isFinite(B.holdTime)&&B.holdTime>0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Hold:"}),l.jsxs("span",{className:"value",children:[Ri(B.holdTime,2),"s"]})]})]})]},B._id||le)})}),jn.length===0&&l.jsx("div",{className:"no-moves",children:l.jsx("p",{children:"No moves found for selected filter."})})]}),h&&l.jsx("div",{className:"image-modal",onClick:()=>g(null),children:l.jsxs("div",{className:"image-modal-content",onClick:B=>B.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:()=>g(null),children:""}),l.jsx("img",{src:h,alt:"Expanded view"})]})}),l.jsx(r6,{colorPreview:ze,onClose:()=>Ue(null)}),te&&we&&l.jsx(s6,{frameDataUrl:we,onSave:B=>{Fe(B),ue(!1)},onCancel:()=>{ue(!1),Z("bottom"),de(null)}}),Ze&&l.jsx(Kv,{sessionGameId:e,onClose:Bo,initialFrames:On,clusterColors:Dt})]})}const c6=!1;function u6(){const[e,t]=S.useState(!1),[n,r]=S.useState(null),[s,i]=S.useState(null),[a,c]=S.useState(window.location.hash),[d,h]=S.useState(!1);S.useEffect(()=>{const T=()=>{c(window.location.hash)};return window.addEventListener("hashchange",T),()=>window.removeEventListener("hashchange",T)},[]),S.useEffect(()=>(window.toggleInterface=T=>{h(T),console.log("[App] Interface "+(T?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const g=T=>{r(T),t(!0)},v=()=>{s&&!s.closed&&s.close();const T=window.location.origin+window.location.pathname+"#/detector",V=window.open(T,"BraceletDetector","width=700,height=600,left=100,top=100");i(V)};S.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),S.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(T){console.error("Error ending experience:",T),alert("Error ending experience: "+T.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let w=null;const N=a.match(/^#\/admin\/edit-moves\/(.+)$/),D=a.match(/^#\/admin\/swipe\/(.+)$/);if(a==="#/detector")w=l.jsx(w1,{});else if(a==="#/calibrate")w=l.jsx(px,{});else if(a==="#/detector2")w=l.jsx(mx,{});else if(a==="#/summary")w=l.jsx(ey,{});else if(a==="#/admin")w=l.jsx(yx,{});else if(a==="#/admin/upload")w=l.jsx(vx,{});else if(D){const T=decodeURIComponent(D[1]);w=l.jsx(Kv,{sessionGameId:T,onClose:()=>window.location.hash=`#/admin/edit-moves/${encodeURIComponent(T)}`},T)}else if(N){const T=decodeURIComponent(N[1]);w=l.jsx(l6,{sessionGameId:T},T)}else w=e?l.jsxs(l.Fragment,{children:[l.jsx(fx,{config:n,interfaceHidden:d}),l.jsx(w1,{hidden:d}),c6,!d&&l.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[l.jsx("button",{onClick:v,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),l.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),l.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&l.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:l.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):l.jsx(sx,{onStart:g});return l.jsx("div",{className:"App",children:w})}wd.createRoot(document.getElementById("root")).render(l.jsx(K0.StrictMode,{children:l.jsx(u6,{})}));
