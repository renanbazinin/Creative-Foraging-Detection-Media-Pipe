(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var fc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var L0={exports:{}},cu={},B0={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ka=Symbol.for("react.element"),j3=Symbol.for("react.portal"),N3=Symbol.for("react.fragment"),b3=Symbol.for("react.strict_mode"),M3=Symbol.for("react.profiler"),T3=Symbol.for("react.provider"),P3=Symbol.for("react.context"),I3=Symbol.for("react.forward_ref"),R3=Symbol.for("react.suspense"),L3=Symbol.for("react.memo"),B3=Symbol.for("react.lazy"),nm=Symbol.iterator;function F3(e){return e===null||typeof e!="object"?null:(e=nm&&e[nm]||e["@@iterator"],typeof e=="function"?e:null)}var F0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O0=Object.assign,$0={};function ao(e,t,n){this.props=e,this.context=t,this.refs=$0,this.updater=n||F0}ao.prototype.isReactComponent={};ao.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ao.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function D0(){}D0.prototype=ao.prototype;function wf(e,t,n){this.props=e,this.context=t,this.refs=$0,this.updater=n||F0}var xf=wf.prototype=new D0;xf.constructor=wf;O0(xf,ao.prototype);xf.isPureReactComponent=!0;var rm=Array.isArray,U0=Object.prototype.hasOwnProperty,Sf={current:null},z0={key:!0,ref:!0,__self:!0,__source:!0};function H0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)U0.call(t,r)&&!z0.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var d=Array(l),h=0;h<l;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ka,type:e,key:i,ref:a,props:s,_owner:Sf.current}}function O3(e,t){return{$$typeof:ka,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function kf(e){return typeof e=="object"&&e!==null&&e.$$typeof===ka}function $3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var sm=/\/+/g;function hc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$3(""+e.key):t.toString(36)}function ll(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ka:case j3:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+hc(a,0):r,rm(s)?(n="",e!=null&&(n=e.replace(sm,"$&/")+"/"),ll(s,t,n,"",function(h){return h})):s!=null&&(kf(s)&&(s=O3(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(sm,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",rm(e))for(var l=0;l<e.length;l++){i=e[l];var d=r+hc(i,l);a+=ll(i,t,n,d,s)}else if(d=F3(e),typeof d=="function")for(e=d.call(e),l=0;!(i=e.next()).done;)i=i.value,d=r+hc(i,l++),a+=ll(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Da(e,t,n){if(e==null)return e;var r=[],s=0;return ll(e,r,"","",function(i){return t.call(n,i,s++)}),r}function D3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xn={current:null},ul={transition:null},U3={ReactCurrentDispatcher:xn,ReactCurrentBatchConfig:ul,ReactCurrentOwner:Sf};function G0(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Da,forEach:function(e,t,n){Da(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Da(e,function(){t++}),t},toArray:function(e){return Da(e,function(t){return t})||[]},only:function(e){if(!kf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=ao;Ye.Fragment=N3;Ye.Profiler=M3;Ye.PureComponent=wf;Ye.StrictMode=b3;Ye.Suspense=R3;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U3;Ye.act=G0;Ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=O0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Sf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(d in t)U0.call(t,d)&&!z0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&l!==void 0?l[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){l=Array(d);for(var h=0;h<d;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:ka,type:e.type,key:s,ref:i,props:r,_owner:a}};Ye.createContext=function(e){return e={$$typeof:P3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:T3,_context:e},e.Consumer=e};Ye.createElement=H0;Ye.createFactory=function(e){var t=H0.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:I3,render:e}};Ye.isValidElement=kf;Ye.lazy=function(e){return{$$typeof:B3,_payload:{_status:-1,_result:e},_init:D3}};Ye.memo=function(e,t){return{$$typeof:L3,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=ul.transition;ul.transition={};try{e()}finally{ul.transition=t}};Ye.unstable_act=G0;Ye.useCallback=function(e,t){return xn.current.useCallback(e,t)};Ye.useContext=function(e){return xn.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return xn.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return xn.current.useEffect(e,t)};Ye.useId=function(){return xn.current.useId()};Ye.useImperativeHandle=function(e,t,n){return xn.current.useImperativeHandle(e,t,n)};Ye.useInsertionEffect=function(e,t){return xn.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return xn.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return xn.current.useMemo(e,t)};Ye.useReducer=function(e,t,n){return xn.current.useReducer(e,t,n)};Ye.useRef=function(e){return xn.current.useRef(e)};Ye.useState=function(e){return xn.current.useState(e)};Ye.useSyncExternalStore=function(e,t,n){return xn.current.useSyncExternalStore(e,t,n)};Ye.useTransition=function(){return xn.current.useTransition()};Ye.version="18.3.1";B0.exports=Ye;var M=B0.exports;const W0=_3(M);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z3=M,H3=Symbol.for("react.element"),G3=Symbol.for("react.fragment"),W3=Object.prototype.hasOwnProperty,V3=z3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y3={key:!0,ref:!0,__self:!0,__source:!0};function V0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)W3.call(t,r)&&!Y3.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:H3,type:e,key:i,ref:a,props:s,_owner:V3.current}}cu.Fragment=G3;cu.jsx=V0;cu.jsxs=V0;L0.exports=cu;var u=L0.exports,id={},Y0={exports:{}},Wn={},X0={exports:{}},K0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,oe){var ne=ee.length;ee.push(oe);e:for(;0<ne;){var we=ne-1>>>1,be=ee[we];if(0<s(be,oe))ee[we]=oe,ee[ne]=be,ne=we;else break e}}function n(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var oe=ee[0],ne=ee.pop();if(ne!==oe){ee[0]=ne;e:for(var we=0,be=ee.length,Ie=be>>>1;we<Ie;){var Fe=2*(we+1)-1,Be=ee[Fe],$e=Fe+1,Y=ee[$e];if(0>s(Be,ne))$e<be&&0>s(Y,Be)?(ee[we]=Y,ee[$e]=ne,we=$e):(ee[we]=Be,ee[Fe]=ne,we=Fe);else if($e<be&&0>s(Y,ne))ee[we]=Y,ee[$e]=ne,we=$e;else break e}}return oe}function s(ee,oe){var ne=ee.sortIndex-oe.sortIndex;return ne!==0?ne:ee.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var d=[],h=[],m=1,w=null,S=3,j=!1,L=!1,F=!1,X=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ee){for(var oe=n(h);oe!==null;){if(oe.callback===null)r(h);else if(oe.startTime<=ee)r(h),oe.sortIndex=oe.expirationTime,t(d,oe);else break;oe=n(h)}}function E(ee){if(F=!1,y(ee),!L)if(n(d)!==null)L=!0,ve(_);else{var oe=n(h);oe!==null&&ye(E,oe.startTime-ee)}}function _(ee,oe){L=!1,F&&(F=!1,C(H),H=-1),j=!0;var ne=S;try{for(y(oe),w=n(d);w!==null&&(!(w.expirationTime>oe)||ee&&!K());){var we=w.callback;if(typeof we=="function"){w.callback=null,S=w.priorityLevel;var be=we(w.expirationTime<=oe);oe=e.unstable_now(),typeof be=="function"?w.callback=be:w===n(d)&&r(d),y(oe)}else r(d);w=n(d)}if(w!==null)var Ie=!0;else{var Fe=n(h);Fe!==null&&ye(E,Fe.startTime-oe),Ie=!1}return Ie}finally{w=null,S=ne,j=!1}}var T=!1,D=null,H=-1,se=5,V=-1;function K(){return!(e.unstable_now()-V<se)}function re(){if(D!==null){var ee=e.unstable_now();V=ee;var oe=!0;try{oe=D(!0,ee)}finally{oe?q():(T=!1,D=null)}}else T=!1}var q;if(typeof g=="function")q=function(){g(re)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,Se=te.port2;te.port1.onmessage=re,q=function(){Se.postMessage(null)}}else q=function(){X(re,0)};function ve(ee){D=ee,T||(T=!0,q())}function ye(ee,oe){H=X(function(){ee(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){L||j||(L=!0,ve(_))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(ee){switch(S){case 1:case 2:case 3:var oe=3;break;default:oe=S}var ne=S;S=oe;try{return ee()}finally{S=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,oe){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ne=S;S=ee;try{return oe()}finally{S=ne}},e.unstable_scheduleCallback=function(ee,oe,ne){var we=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?we+ne:we):ne=we,ee){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=ne+be,ee={id:m++,callback:oe,priorityLevel:ee,startTime:ne,expirationTime:be,sortIndex:-1},ne>we?(ee.sortIndex=ne,t(h,ee),n(d)===null&&ee===n(h)&&(F?(C(H),H=-1):F=!0,ye(E,ne-we))):(ee.sortIndex=be,t(d,ee),L||j||(L=!0,ve(_))),ee},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(ee){var oe=S;return function(){var ne=S;S=oe;try{return ee.apply(this,arguments)}finally{S=ne}}}})(K0);X0.exports=K0;var X3=X0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K3=M,Hn=X3;function ae(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Q0=new Set,ta={};function ci(e,t){Gi(e,t),Gi(e+"Capture",t)}function Gi(e,t){for(ta[e]=t,e=0;e<t.length;e++)Q0.add(t[e])}var os=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),od=Object.prototype.hasOwnProperty,Q3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,im={},om={};function J3(e){return od.call(om,e)?!0:od.call(im,e)?!1:Q3.test(e)?om[e]=!0:(im[e]=!0,!1)}function q3(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Z3(e,t,n,r){if(t===null||typeof t>"u"||q3(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Sn(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){sn[e]=new Sn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];sn[t]=new Sn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){sn[e]=new Sn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){sn[e]=new Sn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){sn[e]=new Sn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){sn[e]=new Sn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){sn[e]=new Sn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){sn[e]=new Sn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){sn[e]=new Sn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Af=/[\-:]([a-z])/g;function Ef(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Af,Ef);sn[t]=new Sn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Af,Ef);sn[t]=new Sn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Af,Ef);sn[t]=new Sn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){sn[e]=new Sn(e,1,!1,e.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){sn[e]=new Sn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Cf(e,t,n,r){var s=sn.hasOwnProperty(t)?sn[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Z3(t,n,s,r)&&(n=null),r||s===null?J3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var fs=K3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ua=Symbol.for("react.element"),wi=Symbol.for("react.portal"),xi=Symbol.for("react.fragment"),_f=Symbol.for("react.strict_mode"),ad=Symbol.for("react.profiler"),J0=Symbol.for("react.provider"),q0=Symbol.for("react.context"),jf=Symbol.for("react.forward_ref"),ld=Symbol.for("react.suspense"),ud=Symbol.for("react.suspense_list"),Nf=Symbol.for("react.memo"),ys=Symbol.for("react.lazy"),Z0=Symbol.for("react.offscreen"),am=Symbol.iterator;function Eo(e){return e===null||typeof e!="object"?null:(e=am&&e[am]||e["@@iterator"],typeof e=="function"?e:null)}var Nt=Object.assign,pc;function Bo(e){if(pc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);pc=t&&t[1]||""}return`
`+pc+e}var mc=!1;function gc(e,t){if(!e||mc)return"";mc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=l);break}}}finally{mc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Bo(e):""}function e4(e){switch(e.tag){case 5:return Bo(e.type);case 16:return Bo("Lazy");case 13:return Bo("Suspense");case 19:return Bo("SuspenseList");case 0:case 2:case 15:return e=gc(e.type,!1),e;case 11:return e=gc(e.type.render,!1),e;case 1:return e=gc(e.type,!0),e;default:return""}}function cd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xi:return"Fragment";case wi:return"Portal";case ad:return"Profiler";case _f:return"StrictMode";case ld:return"Suspense";case ud:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case q0:return(e.displayName||"Context")+".Consumer";case J0:return(e._context.displayName||"Context")+".Provider";case jf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nf:return t=e.displayName||null,t!==null?t:cd(e.type)||"Memo";case ys:t=e._payload,e=e._init;try{return cd(e(t))}catch{}}return null}function t4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cd(t);case 8:return t===_f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Bs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function eg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function n4(e){var t=eg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function za(e){e._valueTracker||(e._valueTracker=n4(e))}function tg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=eg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function _l(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function dd(e,t){var n=t.checked;return Nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function lm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Bs(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ng(e,t){t=t.checked,t!=null&&Cf(e,"checked",t,!1)}function fd(e,t){ng(e,t);var n=Bs(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hd(e,t.type,n):t.hasOwnProperty("defaultValue")&&hd(e,t.type,Bs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function um(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function hd(e,t,n){(t!=="number"||_l(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Fo=Array.isArray;function Pi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Bs(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function pd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ae(92));if(Fo(n)){if(1<n.length)throw Error(ae(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Bs(n)}}function rg(e,t){var n=Bs(t.value),r=Bs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function dm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function md(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ha,ig=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ha=Ha||document.createElement("div"),Ha.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ha.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function na(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r4=["Webkit","ms","Moz","O"];Object.keys(zo).forEach(function(e){r4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zo[t]=zo[e]})});function og(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||zo.hasOwnProperty(e)&&zo[e]?(""+t).trim():t+"px"}function ag(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=og(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var s4=Nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gd(e,t){if(t){if(s4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ae(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ae(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ae(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ae(62))}}function yd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vd=null;function bf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wd=null,Ii=null,Ri=null;function fm(e){if(e=Ca(e)){if(typeof wd!="function")throw Error(ae(280));var t=e.stateNode;t&&(t=mu(t),wd(e.stateNode,e.type,t))}}function lg(e){Ii?Ri?Ri.push(e):Ri=[e]:Ii=e}function ug(){if(Ii){var e=Ii,t=Ri;if(Ri=Ii=null,fm(e),t)for(e=0;e<t.length;e++)fm(t[e])}}function cg(e,t){return e(t)}function dg(){}var yc=!1;function fg(e,t,n){if(yc)return e(t,n);yc=!0;try{return cg(e,t,n)}finally{yc=!1,(Ii!==null||Ri!==null)&&(dg(),ug())}}function ra(e,t){var n=e.stateNode;if(n===null)return null;var r=mu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ae(231,t,typeof n));return n}var xd=!1;if(os)try{var Co={};Object.defineProperty(Co,"passive",{get:function(){xd=!0}}),window.addEventListener("test",Co,Co),window.removeEventListener("test",Co,Co)}catch{xd=!1}function i4(e,t,n,r,s,i,a,l,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(m){this.onError(m)}}var Ho=!1,jl=null,Nl=!1,Sd=null,o4={onError:function(e){Ho=!0,jl=e}};function a4(e,t,n,r,s,i,a,l,d){Ho=!1,jl=null,i4.apply(o4,arguments)}function l4(e,t,n,r,s,i,a,l,d){if(a4.apply(this,arguments),Ho){if(Ho){var h=jl;Ho=!1,jl=null}else throw Error(ae(198));Nl||(Nl=!0,Sd=h)}}function di(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hm(e){if(di(e)!==e)throw Error(ae(188))}function u4(e){var t=e.alternate;if(!t){if(t=di(e),t===null)throw Error(ae(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return hm(s),e;if(i===r)return hm(s),t;i=i.sibling}throw Error(ae(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?e:t}function pg(e){return e=u4(e),e!==null?mg(e):null}function mg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mg(e);if(t!==null)return t;e=e.sibling}return null}var gg=Hn.unstable_scheduleCallback,pm=Hn.unstable_cancelCallback,c4=Hn.unstable_shouldYield,d4=Hn.unstable_requestPaint,$t=Hn.unstable_now,f4=Hn.unstable_getCurrentPriorityLevel,Mf=Hn.unstable_ImmediatePriority,yg=Hn.unstable_UserBlockingPriority,bl=Hn.unstable_NormalPriority,h4=Hn.unstable_LowPriority,vg=Hn.unstable_IdlePriority,du=null,Wr=null;function p4(e){if(Wr&&typeof Wr.onCommitFiberRoot=="function")try{Wr.onCommitFiberRoot(du,e,void 0,(e.current.flags&128)===128)}catch{}}var Cr=Math.clz32?Math.clz32:y4,m4=Math.log,g4=Math.LN2;function y4(e){return e>>>=0,e===0?32:31-(m4(e)/g4|0)|0}var Ga=64,Wa=4194304;function Oo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ml(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Oo(l):(i&=a,i!==0&&(r=Oo(i)))}else a=n&~s,a!==0?r=Oo(a):i!==0&&(r=Oo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Cr(t),s=1<<n,r|=e[n],t&=~s;return r}function v4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function w4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Cr(i),l=1<<a,d=s[a];d===-1?(!(l&n)||l&r)&&(s[a]=v4(l,t)):d<=t&&(e.expiredLanes|=l),i&=~l}}function kd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wg(){var e=Ga;return Ga<<=1,!(Ga&4194240)&&(Ga=64),e}function vc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Aa(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Cr(t),e[t]=n}function x4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Cr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Tf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Cr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function xg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Sg,Pf,kg,Ag,Eg,Ad=!1,Va=[],_s=null,js=null,Ns=null,sa=new Map,ia=new Map,xs=[],S4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mm(e,t){switch(e){case"focusin":case"focusout":_s=null;break;case"dragenter":case"dragleave":js=null;break;case"mouseover":case"mouseout":Ns=null;break;case"pointerover":case"pointerout":sa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ia.delete(t.pointerId)}}function _o(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ca(t),t!==null&&Pf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function k4(e,t,n,r,s){switch(t){case"focusin":return _s=_o(_s,e,t,n,r,s),!0;case"dragenter":return js=_o(js,e,t,n,r,s),!0;case"mouseover":return Ns=_o(Ns,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return sa.set(i,_o(sa.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ia.set(i,_o(ia.get(i)||null,e,t,n,r,s)),!0}return!1}function Cg(e){var t=Ks(e.target);if(t!==null){var n=di(t);if(n!==null){if(t=n.tag,t===13){if(t=hg(n),t!==null){e.blockedOn=t,Eg(e.priority,function(){kg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ed(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);vd=r,n.target.dispatchEvent(r),vd=null}else return t=Ca(n),t!==null&&Pf(t),e.blockedOn=n,!1;t.shift()}return!0}function gm(e,t,n){cl(e)&&n.delete(t)}function A4(){Ad=!1,_s!==null&&cl(_s)&&(_s=null),js!==null&&cl(js)&&(js=null),Ns!==null&&cl(Ns)&&(Ns=null),sa.forEach(gm),ia.forEach(gm)}function jo(e,t){e.blockedOn===t&&(e.blockedOn=null,Ad||(Ad=!0,Hn.unstable_scheduleCallback(Hn.unstable_NormalPriority,A4)))}function oa(e){function t(s){return jo(s,e)}if(0<Va.length){jo(Va[0],e);for(var n=1;n<Va.length;n++){var r=Va[n];r.blockedOn===e&&(r.blockedOn=null)}}for(_s!==null&&jo(_s,e),js!==null&&jo(js,e),Ns!==null&&jo(Ns,e),sa.forEach(t),ia.forEach(t),n=0;n<xs.length;n++)r=xs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<xs.length&&(n=xs[0],n.blockedOn===null);)Cg(n),n.blockedOn===null&&xs.shift()}var Li=fs.ReactCurrentBatchConfig,Tl=!0;function E4(e,t,n,r){var s=at,i=Li.transition;Li.transition=null;try{at=1,If(e,t,n,r)}finally{at=s,Li.transition=i}}function C4(e,t,n,r){var s=at,i=Li.transition;Li.transition=null;try{at=4,If(e,t,n,r)}finally{at=s,Li.transition=i}}function If(e,t,n,r){if(Tl){var s=Ed(e,t,n,r);if(s===null)Nc(e,t,r,Pl,n),mm(e,r);else if(k4(s,e,t,n,r))r.stopPropagation();else if(mm(e,r),t&4&&-1<S4.indexOf(e)){for(;s!==null;){var i=Ca(s);if(i!==null&&Sg(i),i=Ed(e,t,n,r),i===null&&Nc(e,t,r,Pl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Nc(e,t,r,null,n)}}var Pl=null;function Ed(e,t,n,r){if(Pl=null,e=bf(r),e=Ks(e),e!==null)if(t=di(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Pl=e,null}function _g(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(f4()){case Mf:return 1;case yg:return 4;case bl:case h4:return 16;case vg:return 536870912;default:return 16}default:return 16}}var Es=null,Rf=null,dl=null;function jg(){if(dl)return dl;var e,t=Rf,n=t.length,r,s="value"in Es?Es.value:Es.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return dl=s.slice(e,1<r?1-r:void 0)}function fl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ya(){return!0}function ym(){return!1}function Vn(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ya:ym,this.isPropagationStopped=ym,this}return Nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ya)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ya)},persist:function(){},isPersistent:Ya}),t}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lf=Vn(lo),Ea=Nt({},lo,{view:0,detail:0}),_4=Vn(Ea),wc,xc,No,fu=Nt({},Ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==No&&(No&&e.type==="mousemove"?(wc=e.screenX-No.screenX,xc=e.screenY-No.screenY):xc=wc=0,No=e),wc)},movementY:function(e){return"movementY"in e?e.movementY:xc}}),vm=Vn(fu),j4=Nt({},fu,{dataTransfer:0}),N4=Vn(j4),b4=Nt({},Ea,{relatedTarget:0}),Sc=Vn(b4),M4=Nt({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),T4=Vn(M4),P4=Nt({},lo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),I4=Vn(P4),R4=Nt({},lo,{data:0}),wm=Vn(R4),L4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},F4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=F4[e])?!!t[e]:!1}function Bf(){return O4}var $4=Nt({},Ea,{key:function(e){if(e.key){var t=L4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=fl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?B4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bf,charCode:function(e){return e.type==="keypress"?fl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?fl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),D4=Vn($4),U4=Nt({},fu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xm=Vn(U4),z4=Nt({},Ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bf}),H4=Vn(z4),G4=Nt({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),W4=Vn(G4),V4=Nt({},fu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Y4=Vn(V4),X4=[9,13,27,32],Ff=os&&"CompositionEvent"in window,Go=null;os&&"documentMode"in document&&(Go=document.documentMode);var K4=os&&"TextEvent"in window&&!Go,Ng=os&&(!Ff||Go&&8<Go&&11>=Go),Sm=" ",km=!1;function bg(e,t){switch(e){case"keyup":return X4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Si=!1;function Q4(e,t){switch(e){case"compositionend":return Mg(t);case"keypress":return t.which!==32?null:(km=!0,Sm);case"textInput":return e=t.data,e===Sm&&km?null:e;default:return null}}function J4(e,t){if(Si)return e==="compositionend"||!Ff&&bg(e,t)?(e=jg(),dl=Rf=Es=null,Si=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ng&&t.locale!=="ko"?null:t.data;default:return null}}var q4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Am(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!q4[e.type]:t==="textarea"}function Tg(e,t,n,r){lg(r),t=Il(t,"onChange"),0<t.length&&(n=new Lf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wo=null,aa=null;function Z4(e){zg(e,0)}function hu(e){var t=Ei(e);if(tg(t))return e}function ew(e,t){if(e==="change")return t}var Pg=!1;if(os){var kc;if(os){var Ac="oninput"in document;if(!Ac){var Em=document.createElement("div");Em.setAttribute("oninput","return;"),Ac=typeof Em.oninput=="function"}kc=Ac}else kc=!1;Pg=kc&&(!document.documentMode||9<document.documentMode)}function Cm(){Wo&&(Wo.detachEvent("onpropertychange",Ig),aa=Wo=null)}function Ig(e){if(e.propertyName==="value"&&hu(aa)){var t=[];Tg(t,aa,e,bf(e)),fg(Z4,t)}}function tw(e,t,n){e==="focusin"?(Cm(),Wo=t,aa=n,Wo.attachEvent("onpropertychange",Ig)):e==="focusout"&&Cm()}function nw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hu(aa)}function rw(e,t){if(e==="click")return hu(t)}function sw(e,t){if(e==="input"||e==="change")return hu(t)}function iw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jr=typeof Object.is=="function"?Object.is:iw;function la(e,t){if(jr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!od.call(t,s)||!jr(e[s],t[s]))return!1}return!0}function _m(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function jm(e,t){var n=_m(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_m(n)}}function Rg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Lg(){for(var e=window,t=_l();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=_l(e.document)}return t}function Of(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ow(e){var t=Lg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Rg(n.ownerDocument.documentElement,n)){if(r!==null&&Of(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=jm(n,i);var a=jm(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var aw=os&&"documentMode"in document&&11>=document.documentMode,ki=null,Cd=null,Vo=null,_d=!1;function Nm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_d||ki==null||ki!==_l(r)||(r=ki,"selectionStart"in r&&Of(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vo&&la(Vo,r)||(Vo=r,r=Il(Cd,"onSelect"),0<r.length&&(t=new Lf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ki)))}function Xa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ai={animationend:Xa("Animation","AnimationEnd"),animationiteration:Xa("Animation","AnimationIteration"),animationstart:Xa("Animation","AnimationStart"),transitionend:Xa("Transition","TransitionEnd")},Ec={},Bg={};os&&(Bg=document.createElement("div").style,"AnimationEvent"in window||(delete Ai.animationend.animation,delete Ai.animationiteration.animation,delete Ai.animationstart.animation),"TransitionEvent"in window||delete Ai.transitionend.transition);function pu(e){if(Ec[e])return Ec[e];if(!Ai[e])return e;var t=Ai[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Bg)return Ec[e]=t[n];return e}var Fg=pu("animationend"),Og=pu("animationiteration"),$g=pu("animationstart"),Dg=pu("transitionend"),Ug=new Map,bm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(e,t){Ug.set(e,t),ci(t,[e])}for(var Cc=0;Cc<bm.length;Cc++){var _c=bm[Cc],lw=_c.toLowerCase(),uw=_c[0].toUpperCase()+_c.slice(1);Ds(lw,"on"+uw)}Ds(Fg,"onAnimationEnd");Ds(Og,"onAnimationIteration");Ds($g,"onAnimationStart");Ds("dblclick","onDoubleClick");Ds("focusin","onFocus");Ds("focusout","onBlur");Ds(Dg,"onTransitionEnd");Gi("onMouseEnter",["mouseout","mouseover"]);Gi("onMouseLeave",["mouseout","mouseover"]);Gi("onPointerEnter",["pointerout","pointerover"]);Gi("onPointerLeave",["pointerout","pointerover"]);ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $o="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cw=new Set("cancel close invalid load scroll toggle".split(" ").concat($o));function Mm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,l4(r,t,void 0,e),e.currentTarget=null}function zg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var l=r[a],d=l.instance,h=l.currentTarget;if(l=l.listener,d!==i&&s.isPropagationStopped())break e;Mm(s,l,h),i=d}else for(a=0;a<r.length;a++){if(l=r[a],d=l.instance,h=l.currentTarget,l=l.listener,d!==i&&s.isPropagationStopped())break e;Mm(s,l,h),i=d}}}if(Nl)throw e=Sd,Nl=!1,Sd=null,e}function yt(e,t){var n=t[Td];n===void 0&&(n=t[Td]=new Set);var r=e+"__bubble";n.has(r)||(Hg(t,e,2,!1),n.add(r))}function jc(e,t,n){var r=0;t&&(r|=4),Hg(n,e,r,t)}var Ka="_reactListening"+Math.random().toString(36).slice(2);function ua(e){if(!e[Ka]){e[Ka]=!0,Q0.forEach(function(n){n!=="selectionchange"&&(cw.has(n)||jc(n,!1,e),jc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ka]||(t[Ka]=!0,jc("selectionchange",!1,t))}}function Hg(e,t,n,r){switch(_g(t)){case 1:var s=E4;break;case 4:s=C4;break;default:s=If}n=s.bind(null,t,n,e),s=void 0,!xd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Nc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Ks(l),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}l=l.parentNode}}r=r.return}fg(function(){var h=i,m=bf(n),w=[];e:{var S=Ug.get(e);if(S!==void 0){var j=Lf,L=e;switch(e){case"keypress":if(fl(n)===0)break e;case"keydown":case"keyup":j=D4;break;case"focusin":L="focus",j=Sc;break;case"focusout":L="blur",j=Sc;break;case"beforeblur":case"afterblur":j=Sc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=vm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=N4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=H4;break;case Fg:case Og:case $g:j=T4;break;case Dg:j=W4;break;case"scroll":j=_4;break;case"wheel":j=Y4;break;case"copy":case"cut":case"paste":j=I4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=xm}var F=(t&4)!==0,X=!F&&e==="scroll",C=F?S!==null?S+"Capture":null:S;F=[];for(var g=h,y;g!==null;){y=g;var E=y.stateNode;if(y.tag===5&&E!==null&&(y=E,C!==null&&(E=ra(g,C),E!=null&&F.push(ca(g,E,y)))),X)break;g=g.return}0<F.length&&(S=new j(S,L,null,n,m),w.push({event:S,listeners:F}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",S&&n!==vd&&(L=n.relatedTarget||n.fromElement)&&(Ks(L)||L[as]))break e;if((j||S)&&(S=m.window===m?m:(S=m.ownerDocument)?S.defaultView||S.parentWindow:window,j?(L=n.relatedTarget||n.toElement,j=h,L=L?Ks(L):null,L!==null&&(X=di(L),L!==X||L.tag!==5&&L.tag!==6)&&(L=null)):(j=null,L=h),j!==L)){if(F=vm,E="onMouseLeave",C="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(F=xm,E="onPointerLeave",C="onPointerEnter",g="pointer"),X=j==null?S:Ei(j),y=L==null?S:Ei(L),S=new F(E,g+"leave",j,n,m),S.target=X,S.relatedTarget=y,E=null,Ks(m)===h&&(F=new F(C,g+"enter",L,n,m),F.target=y,F.relatedTarget=X,E=F),X=E,j&&L)t:{for(F=j,C=L,g=0,y=F;y;y=mi(y))g++;for(y=0,E=C;E;E=mi(E))y++;for(;0<g-y;)F=mi(F),g--;for(;0<y-g;)C=mi(C),y--;for(;g--;){if(F===C||C!==null&&F===C.alternate)break t;F=mi(F),C=mi(C)}F=null}else F=null;j!==null&&Tm(w,S,j,F,!1),L!==null&&X!==null&&Tm(w,X,L,F,!0)}}e:{if(S=h?Ei(h):window,j=S.nodeName&&S.nodeName.toLowerCase(),j==="select"||j==="input"&&S.type==="file")var _=ew;else if(Am(S))if(Pg)_=sw;else{_=nw;var T=tw}else(j=S.nodeName)&&j.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(_=rw);if(_&&(_=_(e,h))){Tg(w,_,n,m);break e}T&&T(e,S,h),e==="focusout"&&(T=S._wrapperState)&&T.controlled&&S.type==="number"&&hd(S,"number",S.value)}switch(T=h?Ei(h):window,e){case"focusin":(Am(T)||T.contentEditable==="true")&&(ki=T,Cd=h,Vo=null);break;case"focusout":Vo=Cd=ki=null;break;case"mousedown":_d=!0;break;case"contextmenu":case"mouseup":case"dragend":_d=!1,Nm(w,n,m);break;case"selectionchange":if(aw)break;case"keydown":case"keyup":Nm(w,n,m)}var D;if(Ff)e:{switch(e){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else Si?bg(e,n)&&(H="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(H="onCompositionStart");H&&(Ng&&n.locale!=="ko"&&(Si||H!=="onCompositionStart"?H==="onCompositionEnd"&&Si&&(D=jg()):(Es=m,Rf="value"in Es?Es.value:Es.textContent,Si=!0)),T=Il(h,H),0<T.length&&(H=new wm(H,e,null,n,m),w.push({event:H,listeners:T}),D?H.data=D:(D=Mg(n),D!==null&&(H.data=D)))),(D=K4?Q4(e,n):J4(e,n))&&(h=Il(h,"onBeforeInput"),0<h.length&&(m=new wm("onBeforeInput","beforeinput",null,n,m),w.push({event:m,listeners:h}),m.data=D))}zg(w,t)})}function ca(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Il(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ra(e,n),i!=null&&r.unshift(ca(e,i,s)),i=ra(e,t),i!=null&&r.push(ca(e,i,s))),e=e.return}return r}function mi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Tm(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var l=n,d=l.alternate,h=l.stateNode;if(d!==null&&d===r)break;l.tag===5&&h!==null&&(l=h,s?(d=ra(n,i),d!=null&&a.unshift(ca(n,d,l))):s||(d=ra(n,i),d!=null&&a.push(ca(n,d,l)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var dw=/\r\n?/g,fw=/\u0000|\uFFFD/g;function Pm(e){return(typeof e=="string"?e:""+e).replace(dw,`
`).replace(fw,"")}function Qa(e,t,n){if(t=Pm(t),Pm(e)!==t&&n)throw Error(ae(425))}function Rl(){}var jd=null,Nd=null;function bd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Md=typeof setTimeout=="function"?setTimeout:void 0,hw=typeof clearTimeout=="function"?clearTimeout:void 0,Im=typeof Promise=="function"?Promise:void 0,pw=typeof queueMicrotask=="function"?queueMicrotask:typeof Im<"u"?function(e){return Im.resolve(null).then(e).catch(mw)}:Md;function mw(e){setTimeout(function(){throw e})}function bc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),oa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);oa(t)}function bs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Rm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var uo=Math.random().toString(36).slice(2),Gr="__reactFiber$"+uo,da="__reactProps$"+uo,as="__reactContainer$"+uo,Td="__reactEvents$"+uo,gw="__reactListeners$"+uo,yw="__reactHandles$"+uo;function Ks(e){var t=e[Gr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[as]||n[Gr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Rm(e);e!==null;){if(n=e[Gr])return n;e=Rm(e)}return t}e=n,n=e.parentNode}return null}function Ca(e){return e=e[Gr]||e[as],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ei(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ae(33))}function mu(e){return e[da]||null}var Pd=[],Ci=-1;function Us(e){return{current:e}}function vt(e){0>Ci||(e.current=Pd[Ci],Pd[Ci]=null,Ci--)}function ht(e,t){Ci++,Pd[Ci]=e.current,e.current=t}var Fs={},fn=Us(Fs),Nn=Us(!1),ri=Fs;function Wi(e,t){var n=e.type.contextTypes;if(!n)return Fs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function bn(e){return e=e.childContextTypes,e!=null}function Ll(){vt(Nn),vt(fn)}function Lm(e,t,n){if(fn.current!==Fs)throw Error(ae(168));ht(fn,t),ht(Nn,n)}function Gg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(ae(108,t4(e)||"Unknown",s));return Nt({},n,r)}function Bl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fs,ri=fn.current,ht(fn,e),ht(Nn,Nn.current),!0}function Bm(e,t,n){var r=e.stateNode;if(!r)throw Error(ae(169));n?(e=Gg(e,t,ri),r.__reactInternalMemoizedMergedChildContext=e,vt(Nn),vt(fn),ht(fn,e)):vt(Nn),ht(Nn,n)}var Qr=null,gu=!1,Mc=!1;function Wg(e){Qr===null?Qr=[e]:Qr.push(e)}function vw(e){gu=!0,Wg(e)}function zs(){if(!Mc&&Qr!==null){Mc=!0;var e=0,t=at;try{var n=Qr;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Qr=null,gu=!1}catch(s){throw Qr!==null&&(Qr=Qr.slice(e+1)),gg(Mf,zs),s}finally{at=t,Mc=!1}}return null}var _i=[],ji=0,Fl=null,Ol=0,tr=[],nr=0,si=null,Zr=1,es="";function Ys(e,t){_i[ji++]=Ol,_i[ji++]=Fl,Fl=e,Ol=t}function Vg(e,t,n){tr[nr++]=Zr,tr[nr++]=es,tr[nr++]=si,si=e;var r=Zr;e=es;var s=32-Cr(r)-1;r&=~(1<<s),n+=1;var i=32-Cr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Zr=1<<32-Cr(t)+s|n<<s|r,es=i+e}else Zr=1<<i|n<<s|r,es=e}function $f(e){e.return!==null&&(Ys(e,1),Vg(e,1,0))}function Df(e){for(;e===Fl;)Fl=_i[--ji],_i[ji]=null,Ol=_i[--ji],_i[ji]=null;for(;e===si;)si=tr[--nr],tr[nr]=null,es=tr[--nr],tr[nr]=null,Zr=tr[--nr],tr[nr]=null}var zn=null,Un=null,St=!1,Ar=null;function Yg(e,t){var n=sr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Fm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,zn=e,Un=bs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,zn=e,Un=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=si!==null?{id:Zr,overflow:es}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=sr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,zn=e,Un=null,!0):!1;default:return!1}}function Id(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rd(e){if(St){var t=Un;if(t){var n=t;if(!Fm(e,t)){if(Id(e))throw Error(ae(418));t=bs(n.nextSibling);var r=zn;t&&Fm(e,t)?Yg(r,n):(e.flags=e.flags&-4097|2,St=!1,zn=e)}}else{if(Id(e))throw Error(ae(418));e.flags=e.flags&-4097|2,St=!1,zn=e}}}function Om(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;zn=e}function Ja(e){if(e!==zn)return!1;if(!St)return Om(e),St=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!bd(e.type,e.memoizedProps)),t&&(t=Un)){if(Id(e))throw Xg(),Error(ae(418));for(;t;)Yg(e,t),t=bs(t.nextSibling)}if(Om(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ae(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Un=bs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Un=null}}else Un=zn?bs(e.stateNode.nextSibling):null;return!0}function Xg(){for(var e=Un;e;)e=bs(e.nextSibling)}function Vi(){Un=zn=null,St=!1}function Uf(e){Ar===null?Ar=[e]:Ar.push(e)}var ww=fs.ReactCurrentBatchConfig;function bo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,e))}return e}function qa(e,t){throw e=Object.prototype.toString.call(t),Error(ae(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $m(e){var t=e._init;return t(e._payload)}function Kg(e){function t(C,g){if(e){var y=C.deletions;y===null?(C.deletions=[g],C.flags|=16):y.push(g)}}function n(C,g){if(!e)return null;for(;g!==null;)t(C,g),g=g.sibling;return null}function r(C,g){for(C=new Map;g!==null;)g.key!==null?C.set(g.key,g):C.set(g.index,g),g=g.sibling;return C}function s(C,g){return C=Is(C,g),C.index=0,C.sibling=null,C}function i(C,g,y){return C.index=y,e?(y=C.alternate,y!==null?(y=y.index,y<g?(C.flags|=2,g):y):(C.flags|=2,g)):(C.flags|=1048576,g)}function a(C){return e&&C.alternate===null&&(C.flags|=2),C}function l(C,g,y,E){return g===null||g.tag!==6?(g=Fc(y,C.mode,E),g.return=C,g):(g=s(g,y),g.return=C,g)}function d(C,g,y,E){var _=y.type;return _===xi?m(C,g,y.props.children,E,y.key):g!==null&&(g.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ys&&$m(_)===g.type)?(E=s(g,y.props),E.ref=bo(C,g,y),E.return=C,E):(E=wl(y.type,y.key,y.props,null,C.mode,E),E.ref=bo(C,g,y),E.return=C,E)}function h(C,g,y,E){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Oc(y,C.mode,E),g.return=C,g):(g=s(g,y.children||[]),g.return=C,g)}function m(C,g,y,E,_){return g===null||g.tag!==7?(g=ti(y,C.mode,E,_),g.return=C,g):(g=s(g,y),g.return=C,g)}function w(C,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Fc(""+g,C.mode,y),g.return=C,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ua:return y=wl(g.type,g.key,g.props,null,C.mode,y),y.ref=bo(C,null,g),y.return=C,y;case wi:return g=Oc(g,C.mode,y),g.return=C,g;case ys:var E=g._init;return w(C,E(g._payload),y)}if(Fo(g)||Eo(g))return g=ti(g,C.mode,y,null),g.return=C,g;qa(C,g)}return null}function S(C,g,y,E){var _=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return _!==null?null:l(C,g,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ua:return y.key===_?d(C,g,y,E):null;case wi:return y.key===_?h(C,g,y,E):null;case ys:return _=y._init,S(C,g,_(y._payload),E)}if(Fo(y)||Eo(y))return _!==null?null:m(C,g,y,E,null);qa(C,y)}return null}function j(C,g,y,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return C=C.get(y)||null,l(g,C,""+E,_);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ua:return C=C.get(E.key===null?y:E.key)||null,d(g,C,E,_);case wi:return C=C.get(E.key===null?y:E.key)||null,h(g,C,E,_);case ys:var T=E._init;return j(C,g,y,T(E._payload),_)}if(Fo(E)||Eo(E))return C=C.get(y)||null,m(g,C,E,_,null);qa(g,E)}return null}function L(C,g,y,E){for(var _=null,T=null,D=g,H=g=0,se=null;D!==null&&H<y.length;H++){D.index>H?(se=D,D=null):se=D.sibling;var V=S(C,D,y[H],E);if(V===null){D===null&&(D=se);break}e&&D&&V.alternate===null&&t(C,D),g=i(V,g,H),T===null?_=V:T.sibling=V,T=V,D=se}if(H===y.length)return n(C,D),St&&Ys(C,H),_;if(D===null){for(;H<y.length;H++)D=w(C,y[H],E),D!==null&&(g=i(D,g,H),T===null?_=D:T.sibling=D,T=D);return St&&Ys(C,H),_}for(D=r(C,D);H<y.length;H++)se=j(D,C,H,y[H],E),se!==null&&(e&&se.alternate!==null&&D.delete(se.key===null?H:se.key),g=i(se,g,H),T===null?_=se:T.sibling=se,T=se);return e&&D.forEach(function(K){return t(C,K)}),St&&Ys(C,H),_}function F(C,g,y,E){var _=Eo(y);if(typeof _!="function")throw Error(ae(150));if(y=_.call(y),y==null)throw Error(ae(151));for(var T=_=null,D=g,H=g=0,se=null,V=y.next();D!==null&&!V.done;H++,V=y.next()){D.index>H?(se=D,D=null):se=D.sibling;var K=S(C,D,V.value,E);if(K===null){D===null&&(D=se);break}e&&D&&K.alternate===null&&t(C,D),g=i(K,g,H),T===null?_=K:T.sibling=K,T=K,D=se}if(V.done)return n(C,D),St&&Ys(C,H),_;if(D===null){for(;!V.done;H++,V=y.next())V=w(C,V.value,E),V!==null&&(g=i(V,g,H),T===null?_=V:T.sibling=V,T=V);return St&&Ys(C,H),_}for(D=r(C,D);!V.done;H++,V=y.next())V=j(D,C,H,V.value,E),V!==null&&(e&&V.alternate!==null&&D.delete(V.key===null?H:V.key),g=i(V,g,H),T===null?_=V:T.sibling=V,T=V);return e&&D.forEach(function(re){return t(C,re)}),St&&Ys(C,H),_}function X(C,g,y,E){if(typeof y=="object"&&y!==null&&y.type===xi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ua:e:{for(var _=y.key,T=g;T!==null;){if(T.key===_){if(_=y.type,_===xi){if(T.tag===7){n(C,T.sibling),g=s(T,y.props.children),g.return=C,C=g;break e}}else if(T.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ys&&$m(_)===T.type){n(C,T.sibling),g=s(T,y.props),g.ref=bo(C,T,y),g.return=C,C=g;break e}n(C,T);break}else t(C,T);T=T.sibling}y.type===xi?(g=ti(y.props.children,C.mode,E,y.key),g.return=C,C=g):(E=wl(y.type,y.key,y.props,null,C.mode,E),E.ref=bo(C,g,y),E.return=C,C=E)}return a(C);case wi:e:{for(T=y.key;g!==null;){if(g.key===T)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(C,g.sibling),g=s(g,y.children||[]),g.return=C,C=g;break e}else{n(C,g);break}else t(C,g);g=g.sibling}g=Oc(y,C.mode,E),g.return=C,C=g}return a(C);case ys:return T=y._init,X(C,g,T(y._payload),E)}if(Fo(y))return L(C,g,y,E);if(Eo(y))return F(C,g,y,E);qa(C,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(C,g.sibling),g=s(g,y),g.return=C,C=g):(n(C,g),g=Fc(y,C.mode,E),g.return=C,C=g),a(C)):n(C,g)}return X}var Yi=Kg(!0),Qg=Kg(!1),$l=Us(null),Dl=null,Ni=null,zf=null;function Hf(){zf=Ni=Dl=null}function Gf(e){var t=$l.current;vt($l),e._currentValue=t}function Ld(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Bi(e,t){Dl=e,zf=Ni=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(jn=!0),e.firstContext=null)}function ar(e){var t=e._currentValue;if(zf!==e)if(e={context:e,memoizedValue:t,next:null},Ni===null){if(Dl===null)throw Error(ae(308));Ni=e,Dl.dependencies={lanes:0,firstContext:e}}else Ni=Ni.next=e;return t}var Qs=null;function Wf(e){Qs===null?Qs=[e]:Qs.push(e)}function Jg(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Wf(t)):(n.next=s.next,s.next=n),t.interleaved=n,ls(e,r)}function ls(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var vs=!1;function Vf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ns(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ms(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ze&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,ls(e,n)}return s=r.interleaved,s===null?(t.next=t,Wf(r)):(t.next=s.next,s.next=t),r.interleaved=t,ls(e,n)}function hl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Tf(e,n)}}function Dm(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ul(e,t,n,r){var s=e.updateQueue;vs=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var d=l,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var m=e.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==a&&(l===null?m.firstBaseUpdate=h:l.next=h,m.lastBaseUpdate=d))}if(i!==null){var w=s.baseState;a=0,m=h=d=null,l=i;do{var S=l.lane,j=l.eventTime;if((r&S)===S){m!==null&&(m=m.next={eventTime:j,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var L=e,F=l;switch(S=t,j=n,F.tag){case 1:if(L=F.payload,typeof L=="function"){w=L.call(j,w,S);break e}w=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=F.payload,S=typeof L=="function"?L.call(j,w,S):L,S==null)break e;w=Nt({},w,S);break e;case 2:vs=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,S=s.effects,S===null?s.effects=[l]:S.push(l))}else j={eventTime:j,lane:S,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(h=m=j,d=w):m=m.next=j,a|=S;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;S=l,l=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(!0);if(m===null&&(d=w),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);oi|=a,e.lanes=a,e.memoizedState=w}}function Um(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ae(191,s));s.call(r)}}}var _a={},Vr=Us(_a),fa=Us(_a),ha=Us(_a);function Js(e){if(e===_a)throw Error(ae(174));return e}function Yf(e,t){switch(ht(ha,t),ht(fa,e),ht(Vr,_a),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:md(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=md(t,e)}vt(Vr),ht(Vr,t)}function Xi(){vt(Vr),vt(fa),vt(ha)}function Zg(e){Js(ha.current);var t=Js(Vr.current),n=md(t,e.type);t!==n&&(ht(fa,e),ht(Vr,n))}function Xf(e){fa.current===e&&(vt(Vr),vt(fa))}var Ct=Us(0);function zl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Tc=[];function Kf(){for(var e=0;e<Tc.length;e++)Tc[e]._workInProgressVersionPrimary=null;Tc.length=0}var pl=fs.ReactCurrentDispatcher,Pc=fs.ReactCurrentBatchConfig,ii=0,_t=null,Vt=null,qt=null,Hl=!1,Yo=!1,pa=0,xw=0;function an(){throw Error(ae(321))}function Qf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!jr(e[n],t[n]))return!1;return!0}function Jf(e,t,n,r,s,i){if(ii=i,_t=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pl.current=e===null||e.memoizedState===null?Ew:Cw,e=n(r,s),Yo){i=0;do{if(Yo=!1,pa=0,25<=i)throw Error(ae(301));i+=1,qt=Vt=null,t.updateQueue=null,pl.current=_w,e=n(r,s)}while(Yo)}if(pl.current=Gl,t=Vt!==null&&Vt.next!==null,ii=0,qt=Vt=_t=null,Hl=!1,t)throw Error(ae(300));return e}function qf(){var e=pa!==0;return pa=0,e}function zr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?_t.memoizedState=qt=e:qt=qt.next=e,qt}function lr(){if(Vt===null){var e=_t.alternate;e=e!==null?e.memoizedState:null}else e=Vt.next;var t=qt===null?_t.memoizedState:qt.next;if(t!==null)qt=t,Vt=e;else{if(e===null)throw Error(ae(310));Vt=e,e={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},qt===null?_t.memoizedState=qt=e:qt=qt.next=e}return qt}function ma(e,t){return typeof t=="function"?t(e):t}function Ic(e){var t=lr(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=Vt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,d=null,h=i;do{var m=h.lane;if((ii&m)===m)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var w={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(l=d=w,a=r):d=d.next=w,_t.lanes|=m,oi|=m}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=l,jr(r,t.memoizedState)||(jn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,_t.lanes|=i,oi|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Rc(e){var t=lr(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);jr(i,t.memoizedState)||(jn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function e2(){}function t2(e,t){var n=_t,r=lr(),s=t(),i=!jr(r.memoizedState,s);if(i&&(r.memoizedState=s,jn=!0),r=r.queue,Zf(s2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||qt!==null&&qt.memoizedState.tag&1){if(n.flags|=2048,ga(9,r2.bind(null,n,r,s,t),void 0,null),Zt===null)throw Error(ae(349));ii&30||n2(n,t,s)}return s}function n2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function r2(e,t,n,r){t.value=n,t.getSnapshot=r,i2(t)&&o2(e)}function s2(e,t,n){return n(function(){i2(t)&&o2(e)})}function i2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!jr(e,n)}catch{return!0}}function o2(e){var t=ls(e,1);t!==null&&_r(t,e,1,-1)}function zm(e){var t=zr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:e},t.queue=e,e=e.dispatch=Aw.bind(null,_t,e),[t.memoizedState,e]}function ga(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=_t.updateQueue,t===null?(t={lastEffect:null,stores:null},_t.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function a2(){return lr().memoizedState}function ml(e,t,n,r){var s=zr();_t.flags|=e,s.memoizedState=ga(1|t,n,void 0,r===void 0?null:r)}function yu(e,t,n,r){var s=lr();r=r===void 0?null:r;var i=void 0;if(Vt!==null){var a=Vt.memoizedState;if(i=a.destroy,r!==null&&Qf(r,a.deps)){s.memoizedState=ga(t,n,i,r);return}}_t.flags|=e,s.memoizedState=ga(1|t,n,i,r)}function Hm(e,t){return ml(8390656,8,e,t)}function Zf(e,t){return yu(2048,8,e,t)}function l2(e,t){return yu(4,2,e,t)}function u2(e,t){return yu(4,4,e,t)}function c2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function d2(e,t,n){return n=n!=null?n.concat([e]):null,yu(4,4,c2.bind(null,t,e),n)}function eh(){}function f2(e,t){var n=lr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Qf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function h2(e,t){var n=lr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Qf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function p2(e,t,n){return ii&21?(jr(n,t)||(n=wg(),_t.lanes|=n,oi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,jn=!0),e.memoizedState=n)}function Sw(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=Pc.transition;Pc.transition={};try{e(!1),t()}finally{at=n,Pc.transition=r}}function m2(){return lr().memoizedState}function kw(e,t,n){var r=Ps(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},g2(e))y2(t,n);else if(n=Jg(e,t,n,r),n!==null){var s=vn();_r(n,e,r,s),v2(n,t,r)}}function Aw(e,t,n){var r=Ps(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(g2(e))y2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,jr(l,a)){var d=t.interleaved;d===null?(s.next=s,Wf(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=Jg(e,t,s,r),n!==null&&(s=vn(),_r(n,e,r,s),v2(n,t,r))}}function g2(e){var t=e.alternate;return e===_t||t!==null&&t===_t}function y2(e,t){Yo=Hl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function v2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Tf(e,n)}}var Gl={readContext:ar,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useInsertionEffect:an,useLayoutEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useMutableSource:an,useSyncExternalStore:an,useId:an,unstable_isNewReconciler:!1},Ew={readContext:ar,useCallback:function(e,t){return zr().memoizedState=[e,t===void 0?null:t],e},useContext:ar,useEffect:Hm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ml(4194308,4,c2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ml(4194308,4,e,t)},useInsertionEffect:function(e,t){return ml(4,2,e,t)},useMemo:function(e,t){var n=zr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=zr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=kw.bind(null,_t,e),[r.memoizedState,e]},useRef:function(e){var t=zr();return e={current:e},t.memoizedState=e},useState:zm,useDebugValue:eh,useDeferredValue:function(e){return zr().memoizedState=e},useTransition:function(){var e=zm(!1),t=e[0];return e=Sw.bind(null,e[1]),zr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=_t,s=zr();if(St){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=t(),Zt===null)throw Error(ae(349));ii&30||n2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Hm(s2.bind(null,r,i,e),[e]),r.flags|=2048,ga(9,r2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=zr(),t=Zt.identifierPrefix;if(St){var n=es,r=Zr;n=(r&~(1<<32-Cr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=pa++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=xw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Cw={readContext:ar,useCallback:f2,useContext:ar,useEffect:Zf,useImperativeHandle:d2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:h2,useReducer:Ic,useRef:a2,useState:function(){return Ic(ma)},useDebugValue:eh,useDeferredValue:function(e){var t=lr();return p2(t,Vt.memoizedState,e)},useTransition:function(){var e=Ic(ma)[0],t=lr().memoizedState;return[e,t]},useMutableSource:e2,useSyncExternalStore:t2,useId:m2,unstable_isNewReconciler:!1},_w={readContext:ar,useCallback:f2,useContext:ar,useEffect:Zf,useImperativeHandle:d2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:h2,useReducer:Rc,useRef:a2,useState:function(){return Rc(ma)},useDebugValue:eh,useDeferredValue:function(e){var t=lr();return Vt===null?t.memoizedState=e:p2(t,Vt.memoizedState,e)},useTransition:function(){var e=Rc(ma)[0],t=lr().memoizedState;return[e,t]},useMutableSource:e2,useSyncExternalStore:t2,useId:m2,unstable_isNewReconciler:!1};function Sr(e,t){if(e&&e.defaultProps){t=Nt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Bd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Nt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var vu={isMounted:function(e){return(e=e._reactInternals)?di(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Ps(e),i=ns(r,s);i.payload=t,n!=null&&(i.callback=n),t=Ms(e,i,s),t!==null&&(_r(t,e,s,r),hl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Ps(e),i=ns(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ms(e,i,s),t!==null&&(_r(t,e,s,r),hl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=vn(),r=Ps(e),s=ns(n,r);s.tag=2,t!=null&&(s.callback=t),t=Ms(e,s,r),t!==null&&(_r(t,e,r,n),hl(t,e,r))}};function Gm(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!la(n,r)||!la(s,i):!0}function w2(e,t,n){var r=!1,s=Fs,i=t.contextType;return typeof i=="object"&&i!==null?i=ar(i):(s=bn(t)?ri:fn.current,r=t.contextTypes,i=(r=r!=null)?Wi(e,s):Fs),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=vu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Wm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vu.enqueueReplaceState(t,t.state,null)}function Fd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Vf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=ar(i):(i=bn(t)?ri:fn.current,s.context=Wi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Bd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&vu.enqueueReplaceState(s,s.state,null),Ul(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ki(e,t){try{var n="",r=t;do n+=e4(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Lc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Od(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var jw=typeof WeakMap=="function"?WeakMap:Map;function x2(e,t,n){n=ns(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vl||(Vl=!0,Xd=r),Od(e,t)},n}function S2(e,t,n){n=ns(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Od(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Od(e,t),typeof r!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Vm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new jw;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Uw.bind(null,e,t,n),t.then(e,e))}function Ym(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Xm(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ns(-1,1),t.tag=2,Ms(n,t,1))),n.lanes|=1),e)}var Nw=fs.ReactCurrentOwner,jn=!1;function yn(e,t,n,r){t.child=e===null?Qg(t,null,n,r):Yi(t,e.child,n,r)}function Km(e,t,n,r,s){n=n.render;var i=t.ref;return Bi(t,s),r=Jf(e,t,n,r,i,s),n=qf(),e!==null&&!jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,us(e,t,s)):(St&&n&&$f(t),t.flags|=1,yn(e,t,r,s),t.child)}function Qm(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!lh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,k2(e,t,i,r,s)):(e=wl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:la,n(a,r)&&e.ref===t.ref)return us(e,t,s)}return t.flags|=1,e=Is(i,r),e.ref=t.ref,e.return=t,t.child=e}function k2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(la(i,r)&&e.ref===t.ref)if(jn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(jn=!0);else return t.lanes=e.lanes,us(e,t,s)}return $d(e,t,n,r,s)}function A2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(Mi,Dn),Dn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(Mi,Dn),Dn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ht(Mi,Dn),Dn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,ht(Mi,Dn),Dn|=r;return yn(e,t,s,n),t.child}function E2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function $d(e,t,n,r,s){var i=bn(n)?ri:fn.current;return i=Wi(t,i),Bi(t,s),n=Jf(e,t,n,r,i,s),r=qf(),e!==null&&!jn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,us(e,t,s)):(St&&r&&$f(t),t.flags|=1,yn(e,t,n,s),t.child)}function Jm(e,t,n,r,s){if(bn(n)){var i=!0;Bl(t)}else i=!1;if(Bi(t,s),t.stateNode===null)gl(e,t),w2(t,n,r),Fd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=ar(h):(h=bn(n)?ri:fn.current,h=Wi(t,h));var m=n.getDerivedStateFromProps,w=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||d!==h)&&Wm(t,a,r,h),vs=!1;var S=t.memoizedState;a.state=S,Ul(t,r,a,s),d=t.memoizedState,l!==r||S!==d||Nn.current||vs?(typeof m=="function"&&(Bd(t,n,m,r),d=t.memoizedState),(l=vs||Gm(t,n,l,r,S,d,h))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,qg(e,t),l=t.memoizedProps,h=t.type===t.elementType?l:Sr(t.type,l),a.props=h,w=t.pendingProps,S=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=ar(d):(d=bn(n)?ri:fn.current,d=Wi(t,d));var j=n.getDerivedStateFromProps;(m=typeof j=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==w||S!==d)&&Wm(t,a,r,d),vs=!1,S=t.memoizedState,a.state=S,Ul(t,r,a,s);var L=t.memoizedState;l!==w||S!==L||Nn.current||vs?(typeof j=="function"&&(Bd(t,n,j,r),L=t.memoizedState),(h=vs||Gm(t,n,h,r,S,L,d)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,L,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,L,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),a.props=r,a.state=L,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),r=!1)}return Dd(e,t,n,r,i,s)}function Dd(e,t,n,r,s,i){E2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&Bm(t,n,!1),us(e,t,i);r=t.stateNode,Nw.current=t;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Yi(t,e.child,null,i),t.child=Yi(t,null,l,i)):yn(e,t,l,i),t.memoizedState=r.state,s&&Bm(t,n,!0),t.child}function C2(e){var t=e.stateNode;t.pendingContext?Lm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lm(e,t.context,!1),Yf(e,t.containerInfo)}function qm(e,t,n,r,s){return Vi(),Uf(s),t.flags|=256,yn(e,t,n,r),t.child}var Ud={dehydrated:null,treeContext:null,retryLane:0};function zd(e){return{baseLanes:e,cachePool:null,transitions:null}}function _2(e,t,n){var r=t.pendingProps,s=Ct.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ht(Ct,s&1),e===null)return Rd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Su(a,r,0,null),e=ti(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=zd(n),t.memoizedState=Ud,e):th(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return bw(e,t,a,r,l,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,l=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Is(s,d),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Is(l,i):(i=ti(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?zd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Ud,r}return i=e.child,e=i.sibling,r=Is(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function th(e,t){return t=Su({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Za(e,t,n,r){return r!==null&&Uf(r),Yi(t,e.child,null,n),e=th(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function bw(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Lc(Error(ae(422))),Za(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Su({mode:"visible",children:r.children},s,0,null),i=ti(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Yi(t,e.child,null,a),t.child.memoizedState=zd(a),t.memoizedState=Ud,i);if(!(t.mode&1))return Za(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(ae(419)),r=Lc(i,r,void 0),Za(e,t,a,r)}if(l=(a&e.childLanes)!==0,jn||l){if(r=Zt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ls(e,s),_r(r,e,s,-1))}return ah(),r=Lc(Error(ae(421))),Za(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=zw.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Un=bs(s.nextSibling),zn=t,St=!0,Ar=null,e!==null&&(tr[nr++]=Zr,tr[nr++]=es,tr[nr++]=si,Zr=e.id,es=e.overflow,si=t),t=th(t,r.children),t.flags|=4096,t)}function Zm(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ld(e.return,t,n)}function Bc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function j2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(yn(e,t,r.children,n),r=Ct.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zm(e,n,t);else if(e.tag===19)Zm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ht(Ct,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&zl(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Bc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&zl(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Bc(t,!0,n,null,i);break;case"together":Bc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function gl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function us(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),oi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ae(153));if(t.child!==null){for(e=t.child,n=Is(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Is(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Mw(e,t,n){switch(t.tag){case 3:C2(t),Vi();break;case 5:Zg(t);break;case 1:bn(t.type)&&Bl(t);break;case 4:Yf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ht($l,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ht(Ct,Ct.current&1),t.flags|=128,null):n&t.child.childLanes?_2(e,t,n):(ht(Ct,Ct.current&1),e=us(e,t,n),e!==null?e.sibling:null);ht(Ct,Ct.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return j2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ht(Ct,Ct.current),r)break;return null;case 22:case 23:return t.lanes=0,A2(e,t,n)}return us(e,t,n)}var N2,Hd,b2,M2;N2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hd=function(){};b2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Js(Vr.current);var i=null;switch(n){case"input":s=dd(e,s),r=dd(e,r),i=[];break;case"select":s=Nt({},s,{value:void 0}),r=Nt({},r,{value:void 0}),i=[];break;case"textarea":s=pd(e,s),r=pd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Rl)}gd(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ta.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==l&&(d!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&l[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,l=l?l.__html:void 0,d!=null&&l!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(ta.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&yt("scroll",e),i||l===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};M2=function(e,t,n,r){n!==r&&(t.flags|=4)};function Mo(e,t){if(!St)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ln(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Tw(e,t,n){var r=t.pendingProps;switch(Df(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(t),null;case 1:return bn(t.type)&&Ll(),ln(t),null;case 3:return r=t.stateNode,Xi(),vt(Nn),vt(fn),Kf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ja(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ar!==null&&(Jd(Ar),Ar=null))),Hd(e,t),ln(t),null;case 5:Xf(t);var s=Js(ha.current);if(n=t.type,e!==null&&t.stateNode!=null)b2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ae(166));return ln(t),null}if(e=Js(Vr.current),Ja(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Gr]=t,r[da]=i,e=(t.mode&1)!==0,n){case"dialog":yt("cancel",r),yt("close",r);break;case"iframe":case"object":case"embed":yt("load",r);break;case"video":case"audio":for(s=0;s<$o.length;s++)yt($o[s],r);break;case"source":yt("error",r);break;case"img":case"image":case"link":yt("error",r),yt("load",r);break;case"details":yt("toggle",r);break;case"input":lm(r,i),yt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},yt("invalid",r);break;case"textarea":cm(r,i),yt("invalid",r)}gd(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,l,e),s=["children",""+l]):ta.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&yt("scroll",r)}switch(n){case"input":za(r),um(r,i,!0);break;case"textarea":za(r),dm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Rl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Gr]=t,e[da]=r,N2(e,t,!1,!1),t.stateNode=e;e:{switch(a=yd(n,r),n){case"dialog":yt("cancel",e),yt("close",e),s=r;break;case"iframe":case"object":case"embed":yt("load",e),s=r;break;case"video":case"audio":for(s=0;s<$o.length;s++)yt($o[s],e);s=r;break;case"source":yt("error",e),s=r;break;case"img":case"image":case"link":yt("error",e),yt("load",e),s=r;break;case"details":yt("toggle",e),s=r;break;case"input":lm(e,r),s=dd(e,r),yt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Nt({},r,{value:void 0}),yt("invalid",e);break;case"textarea":cm(e,r),s=pd(e,r),yt("invalid",e);break;default:s=r}gd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var d=l[i];i==="style"?ag(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&ig(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&na(e,d):typeof d=="number"&&na(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ta.hasOwnProperty(i)?d!=null&&i==="onScroll"&&yt("scroll",e):d!=null&&Cf(e,i,d,a))}switch(n){case"input":za(e),um(e,r,!1);break;case"textarea":za(e),dm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Bs(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Pi(e,!!r.multiple,i,!1):r.defaultValue!=null&&Pi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Rl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ln(t),null;case 6:if(e&&t.stateNode!=null)M2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ae(166));if(n=Js(ha.current),Js(Vr.current),Ja(t)){if(r=t.stateNode,n=t.memoizedProps,r[Gr]=t,(i=r.nodeValue!==n)&&(e=zn,e!==null))switch(e.tag){case 3:Qa(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qa(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gr]=t,t.stateNode=r}return ln(t),null;case 13:if(vt(Ct),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(St&&Un!==null&&t.mode&1&&!(t.flags&128))Xg(),Vi(),t.flags|=98560,i=!1;else if(i=Ja(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ae(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ae(317));i[Gr]=t}else Vi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ln(t),i=!1}else Ar!==null&&(Jd(Ar),Ar=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ct.current&1?Xt===0&&(Xt=3):ah())),t.updateQueue!==null&&(t.flags|=4),ln(t),null);case 4:return Xi(),Hd(e,t),e===null&&ua(t.stateNode.containerInfo),ln(t),null;case 10:return Gf(t.type._context),ln(t),null;case 17:return bn(t.type)&&Ll(),ln(t),null;case 19:if(vt(Ct),i=t.memoizedState,i===null)return ln(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Mo(i,!1);else{if(Xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=zl(e),a!==null){for(t.flags|=128,Mo(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ht(Ct,Ct.current&1|2),t.child}e=e.sibling}i.tail!==null&&$t()>Qi&&(t.flags|=128,r=!0,Mo(i,!1),t.lanes=4194304)}else{if(!r)if(e=zl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Mo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!St)return ln(t),null}else 2*$t()-i.renderingStartTime>Qi&&n!==1073741824&&(t.flags|=128,r=!0,Mo(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$t(),t.sibling=null,n=Ct.current,ht(Ct,r?n&1|2:n&1),t):(ln(t),null);case 22:case 23:return oh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Dn&1073741824&&(ln(t),t.subtreeFlags&6&&(t.flags|=8192)):ln(t),null;case 24:return null;case 25:return null}throw Error(ae(156,t.tag))}function Pw(e,t){switch(Df(t),t.tag){case 1:return bn(t.type)&&Ll(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Xi(),vt(Nn),vt(fn),Kf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Xf(t),null;case 13:if(vt(Ct),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ae(340));Vi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vt(Ct),null;case 4:return Xi(),null;case 10:return Gf(t.type._context),null;case 22:case 23:return oh(),null;case 24:return null;default:return null}}var el=!1,dn=!1,Iw=typeof WeakSet=="function"?WeakSet:Set,ke=null;function bi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Rt(e,t,r)}else n.current=null}function Gd(e,t,n){try{n()}catch(r){Rt(e,t,r)}}var e1=!1;function Rw(e,t){if(jd=Tl,e=Lg(),Of(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,d=-1,h=0,m=0,w=e,S=null;t:for(;;){for(var j;w!==n||s!==0&&w.nodeType!==3||(l=a+s),w!==i||r!==0&&w.nodeType!==3||(d=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(j=w.firstChild)!==null;)S=w,w=j;for(;;){if(w===e)break t;if(S===n&&++h===s&&(l=a),S===i&&++m===r&&(d=a),(j=w.nextSibling)!==null)break;w=S,S=w.parentNode}w=j}n=l===-1||d===-1?null:{start:l,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nd={focusedElem:e,selectionRange:n},Tl=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var F=L.memoizedProps,X=L.memoizedState,C=t.stateNode,g=C.getSnapshotBeforeUpdate(t.elementType===t.type?F:Sr(t.type,F),X);C.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(E){Rt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return L=e1,e1=!1,L}function Xo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Gd(t,n,i)}s=s.next}while(s!==r)}}function wu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Wd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function T2(e){var t=e.alternate;t!==null&&(e.alternate=null,T2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gr],delete t[da],delete t[Td],delete t[gw],delete t[yw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function P2(e){return e.tag===5||e.tag===3||e.tag===4}function t1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||P2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Rl));else if(r!==4&&(e=e.child,e!==null))for(Vd(e,t,n),e=e.sibling;e!==null;)Vd(e,t,n),e=e.sibling}function Yd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Yd(e,t,n),e=e.sibling;e!==null;)Yd(e,t,n),e=e.sibling}var nn=null,kr=!1;function ms(e,t,n){for(n=n.child;n!==null;)I2(e,t,n),n=n.sibling}function I2(e,t,n){if(Wr&&typeof Wr.onCommitFiberUnmount=="function")try{Wr.onCommitFiberUnmount(du,n)}catch{}switch(n.tag){case 5:dn||bi(n,t);case 6:var r=nn,s=kr;nn=null,ms(e,t,n),nn=r,kr=s,nn!==null&&(kr?(e=nn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):nn.removeChild(n.stateNode));break;case 18:nn!==null&&(kr?(e=nn,n=n.stateNode,e.nodeType===8?bc(e.parentNode,n):e.nodeType===1&&bc(e,n),oa(e)):bc(nn,n.stateNode));break;case 4:r=nn,s=kr,nn=n.stateNode.containerInfo,kr=!0,ms(e,t,n),nn=r,kr=s;break;case 0:case 11:case 14:case 15:if(!dn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Gd(n,t,a),s=s.next}while(s!==r)}ms(e,t,n);break;case 1:if(!dn&&(bi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Rt(n,t,l)}ms(e,t,n);break;case 21:ms(e,t,n);break;case 22:n.mode&1?(dn=(r=dn)||n.memoizedState!==null,ms(e,t,n),dn=r):ms(e,t,n);break;default:ms(e,t,n)}}function n1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Iw),t.forEach(function(r){var s=Hw.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function xr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:nn=l.stateNode,kr=!1;break e;case 3:nn=l.stateNode.containerInfo,kr=!0;break e;case 4:nn=l.stateNode.containerInfo,kr=!0;break e}l=l.return}if(nn===null)throw Error(ae(160));I2(i,a,s),nn=null,kr=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){Rt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)R2(t,e),t=t.sibling}function R2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xr(t,e),Br(e),r&4){try{Xo(3,e,e.return),wu(3,e)}catch(F){Rt(e,e.return,F)}try{Xo(5,e,e.return)}catch(F){Rt(e,e.return,F)}}break;case 1:xr(t,e),Br(e),r&512&&n!==null&&bi(n,n.return);break;case 5:if(xr(t,e),Br(e),r&512&&n!==null&&bi(n,n.return),e.flags&32){var s=e.stateNode;try{na(s,"")}catch(F){Rt(e,e.return,F)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,l=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&ng(s,i),yd(l,a);var h=yd(l,i);for(a=0;a<d.length;a+=2){var m=d[a],w=d[a+1];m==="style"?ag(s,w):m==="dangerouslySetInnerHTML"?ig(s,w):m==="children"?na(s,w):Cf(s,m,w,h)}switch(l){case"input":fd(s,i);break;case"textarea":rg(s,i);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var j=i.value;j!=null?Pi(s,!!i.multiple,j,!1):S!==!!i.multiple&&(i.defaultValue!=null?Pi(s,!!i.multiple,i.defaultValue,!0):Pi(s,!!i.multiple,i.multiple?[]:"",!1))}s[da]=i}catch(F){Rt(e,e.return,F)}}break;case 6:if(xr(t,e),Br(e),r&4){if(e.stateNode===null)throw Error(ae(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(F){Rt(e,e.return,F)}}break;case 3:if(xr(t,e),Br(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{oa(t.containerInfo)}catch(F){Rt(e,e.return,F)}break;case 4:xr(t,e),Br(e);break;case 13:xr(t,e),Br(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(sh=$t())),r&4&&n1(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(dn=(h=dn)||m,xr(t,e),dn=h):xr(t,e),Br(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!m&&e.mode&1)for(ke=e,m=e.child;m!==null;){for(w=ke=m;ke!==null;){switch(S=ke,j=S.child,S.tag){case 0:case 11:case 14:case 15:Xo(4,S,S.return);break;case 1:bi(S,S.return);var L=S.stateNode;if(typeof L.componentWillUnmount=="function"){r=S,n=S.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(F){Rt(r,n,F)}}break;case 5:bi(S,S.return);break;case 22:if(S.memoizedState!==null){s1(w);continue}}j!==null?(j.return=S,ke=j):s1(w)}m=m.sibling}e:for(m=null,w=e;;){if(w.tag===5){if(m===null){m=w;try{s=w.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=w.stateNode,d=w.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,l.style.display=og("display",a))}catch(F){Rt(e,e.return,F)}}}else if(w.tag===6){if(m===null)try{w.stateNode.nodeValue=h?"":w.memoizedProps}catch(F){Rt(e,e.return,F)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===e)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===e)break e;for(;w.sibling===null;){if(w.return===null||w.return===e)break e;m===w&&(m=null),w=w.return}m===w&&(m=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:xr(t,e),Br(e),r&4&&n1(e);break;case 21:break;default:xr(t,e),Br(e)}}function Br(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(P2(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(na(s,""),r.flags&=-33);var i=t1(e);Yd(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=t1(e);Vd(e,l,a);break;default:throw Error(ae(161))}}catch(d){Rt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Lw(e,t,n){ke=e,L2(e)}function L2(e,t,n){for(var r=(e.mode&1)!==0;ke!==null;){var s=ke,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||el;if(!a){var l=s.alternate,d=l!==null&&l.memoizedState!==null||dn;l=el;var h=dn;if(el=a,(dn=d)&&!h)for(ke=s;ke!==null;)a=ke,d=a.child,a.tag===22&&a.memoizedState!==null?i1(s):d!==null?(d.return=a,ke=d):i1(s);for(;i!==null;)ke=i,L2(i),i=i.sibling;ke=s,el=l,dn=h}r1(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ke=i):r1(e)}}function r1(e){for(;ke!==null;){var t=ke;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dn||wu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!dn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Sr(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Um(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Um(t,a,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var w=m.dehydrated;w!==null&&oa(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}dn||t.flags&512&&Wd(t)}catch(S){Rt(t,t.return,S)}}if(t===e){ke=null;break}if(n=t.sibling,n!==null){n.return=t.return,ke=n;break}ke=t.return}}function s1(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ke=n;break}ke=t.return}}function i1(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{wu(4,t)}catch(d){Rt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){Rt(t,s,d)}}var i=t.return;try{Wd(t)}catch(d){Rt(t,i,d)}break;case 5:var a=t.return;try{Wd(t)}catch(d){Rt(t,a,d)}}}catch(d){Rt(t,t.return,d)}if(t===e){ke=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ke=l;break}ke=t.return}}var Bw=Math.ceil,Wl=fs.ReactCurrentDispatcher,nh=fs.ReactCurrentOwner,or=fs.ReactCurrentBatchConfig,Ze=0,Zt=null,zt=null,rn=0,Dn=0,Mi=Us(0),Xt=0,ya=null,oi=0,xu=0,rh=0,Ko=null,_n=null,sh=0,Qi=1/0,Kr=null,Vl=!1,Xd=null,Ts=null,tl=!1,Cs=null,Yl=0,Qo=0,Kd=null,yl=-1,vl=0;function vn(){return Ze&6?$t():yl!==-1?yl:yl=$t()}function Ps(e){return e.mode&1?Ze&2&&rn!==0?rn&-rn:ww.transition!==null?(vl===0&&(vl=wg()),vl):(e=at,e!==0||(e=window.event,e=e===void 0?16:_g(e.type)),e):1}function _r(e,t,n,r){if(50<Qo)throw Qo=0,Kd=null,Error(ae(185));Aa(e,n,r),(!(Ze&2)||e!==Zt)&&(e===Zt&&(!(Ze&2)&&(xu|=n),Xt===4&&Ss(e,rn)),Mn(e,r),n===1&&Ze===0&&!(t.mode&1)&&(Qi=$t()+500,gu&&zs()))}function Mn(e,t){var n=e.callbackNode;w4(e,t);var r=Ml(e,e===Zt?rn:0);if(r===0)n!==null&&pm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&pm(n),t===1)e.tag===0?vw(o1.bind(null,e)):Wg(o1.bind(null,e)),pw(function(){!(Ze&6)&&zs()}),n=null;else{switch(xg(r)){case 1:n=Mf;break;case 4:n=yg;break;case 16:n=bl;break;case 536870912:n=vg;break;default:n=bl}n=H2(n,B2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function B2(e,t){if(yl=-1,vl=0,Ze&6)throw Error(ae(327));var n=e.callbackNode;if(Fi()&&e.callbackNode!==n)return null;var r=Ml(e,e===Zt?rn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Xl(e,r);else{t=r;var s=Ze;Ze|=2;var i=O2();(Zt!==e||rn!==t)&&(Kr=null,Qi=$t()+500,ei(e,t));do try{$w();break}catch(l){F2(e,l)}while(!0);Hf(),Wl.current=i,Ze=s,zt!==null?t=0:(Zt=null,rn=0,t=Xt)}if(t!==0){if(t===2&&(s=kd(e),s!==0&&(r=s,t=Qd(e,s))),t===1)throw n=ya,ei(e,0),Ss(e,r),Mn(e,$t()),n;if(t===6)Ss(e,r);else{if(s=e.current.alternate,!(r&30)&&!Fw(s)&&(t=Xl(e,r),t===2&&(i=kd(e),i!==0&&(r=i,t=Qd(e,i))),t===1))throw n=ya,ei(e,0),Ss(e,r),Mn(e,$t()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(ae(345));case 2:Xs(e,_n,Kr);break;case 3:if(Ss(e,r),(r&130023424)===r&&(t=sh+500-$t(),10<t)){if(Ml(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){vn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Md(Xs.bind(null,e,_n,Kr),t);break}Xs(e,_n,Kr);break;case 4:if(Ss(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Cr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Bw(r/1960))-r,10<r){e.timeoutHandle=Md(Xs.bind(null,e,_n,Kr),r);break}Xs(e,_n,Kr);break;case 5:Xs(e,_n,Kr);break;default:throw Error(ae(329))}}}return Mn(e,$t()),e.callbackNode===n?B2.bind(null,e):null}function Qd(e,t){var n=Ko;return e.current.memoizedState.isDehydrated&&(ei(e,t).flags|=256),e=Xl(e,t),e!==2&&(t=_n,_n=n,t!==null&&Jd(t)),e}function Jd(e){_n===null?_n=e:_n.push.apply(_n,e)}function Fw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!jr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ss(e,t){for(t&=~rh,t&=~xu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Cr(t),r=1<<n;e[n]=-1,t&=~r}}function o1(e){if(Ze&6)throw Error(ae(327));Fi();var t=Ml(e,0);if(!(t&1))return Mn(e,$t()),null;var n=Xl(e,t);if(e.tag!==0&&n===2){var r=kd(e);r!==0&&(t=r,n=Qd(e,r))}if(n===1)throw n=ya,ei(e,0),Ss(e,t),Mn(e,$t()),n;if(n===6)throw Error(ae(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xs(e,_n,Kr),Mn(e,$t()),null}function ih(e,t){var n=Ze;Ze|=1;try{return e(t)}finally{Ze=n,Ze===0&&(Qi=$t()+500,gu&&zs())}}function ai(e){Cs!==null&&Cs.tag===0&&!(Ze&6)&&Fi();var t=Ze;Ze|=1;var n=or.transition,r=at;try{if(or.transition=null,at=1,e)return e()}finally{at=r,or.transition=n,Ze=t,!(Ze&6)&&zs()}}function oh(){Dn=Mi.current,vt(Mi)}function ei(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,hw(n)),zt!==null)for(n=zt.return;n!==null;){var r=n;switch(Df(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ll();break;case 3:Xi(),vt(Nn),vt(fn),Kf();break;case 5:Xf(r);break;case 4:Xi();break;case 13:vt(Ct);break;case 19:vt(Ct);break;case 10:Gf(r.type._context);break;case 22:case 23:oh()}n=n.return}if(Zt=e,zt=e=Is(e.current,null),rn=Dn=t,Xt=0,ya=null,rh=xu=oi=0,_n=Ko=null,Qs!==null){for(t=0;t<Qs.length;t++)if(n=Qs[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Qs=null}return e}function F2(e,t){do{var n=zt;try{if(Hf(),pl.current=Gl,Hl){for(var r=_t.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Hl=!1}if(ii=0,qt=Vt=_t=null,Yo=!1,pa=0,nh.current=null,n===null||n.return===null){Xt=1,ya=t,zt=null;break}e:{var i=e,a=n.return,l=n,d=t;if(t=rn,l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,m=l,w=m.tag;if(!(m.mode&1)&&(w===0||w===11||w===15)){var S=m.alternate;S?(m.updateQueue=S.updateQueue,m.memoizedState=S.memoizedState,m.lanes=S.lanes):(m.updateQueue=null,m.memoizedState=null)}var j=Ym(a);if(j!==null){j.flags&=-257,Xm(j,a,l,i,t),j.mode&1&&Vm(i,h,t),t=j,d=h;var L=t.updateQueue;if(L===null){var F=new Set;F.add(d),t.updateQueue=F}else L.add(d);break e}else{if(!(t&1)){Vm(i,h,t),ah();break e}d=Error(ae(426))}}else if(St&&l.mode&1){var X=Ym(a);if(X!==null){!(X.flags&65536)&&(X.flags|=256),Xm(X,a,l,i,t),Uf(Ki(d,l));break e}}i=d=Ki(d,l),Xt!==4&&(Xt=2),Ko===null?Ko=[i]:Ko.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var C=x2(i,d,t);Dm(i,C);break e;case 1:l=d;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ts===null||!Ts.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var E=S2(i,l,t);Dm(i,E);break e}}i=i.return}while(i!==null)}D2(n)}catch(_){t=_,zt===n&&n!==null&&(zt=n=n.return);continue}break}while(!0)}function O2(){var e=Wl.current;return Wl.current=Gl,e===null?Gl:e}function ah(){(Xt===0||Xt===3||Xt===2)&&(Xt=4),Zt===null||!(oi&268435455)&&!(xu&268435455)||Ss(Zt,rn)}function Xl(e,t){var n=Ze;Ze|=2;var r=O2();(Zt!==e||rn!==t)&&(Kr=null,ei(e,t));do try{Ow();break}catch(s){F2(e,s)}while(!0);if(Hf(),Ze=n,Wl.current=r,zt!==null)throw Error(ae(261));return Zt=null,rn=0,Xt}function Ow(){for(;zt!==null;)$2(zt)}function $w(){for(;zt!==null&&!c4();)$2(zt)}function $2(e){var t=z2(e.alternate,e,Dn);e.memoizedProps=e.pendingProps,t===null?D2(e):zt=t,nh.current=null}function D2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Pw(n,t),n!==null){n.flags&=32767,zt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xt=6,zt=null;return}}else if(n=Tw(n,t,Dn),n!==null){zt=n;return}if(t=t.sibling,t!==null){zt=t;return}zt=t=e}while(t!==null);Xt===0&&(Xt=5)}function Xs(e,t,n){var r=at,s=or.transition;try{or.transition=null,at=1,Dw(e,t,n,r)}finally{or.transition=s,at=r}return null}function Dw(e,t,n,r){do Fi();while(Cs!==null);if(Ze&6)throw Error(ae(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ae(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(x4(e,i),e===Zt&&(zt=Zt=null,rn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||tl||(tl=!0,H2(bl,function(){return Fi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=or.transition,or.transition=null;var a=at;at=1;var l=Ze;Ze|=4,nh.current=null,Rw(e,n),R2(n,e),ow(Nd),Tl=!!jd,Nd=jd=null,e.current=n,Lw(n),d4(),Ze=l,at=a,or.transition=i}else e.current=n;if(tl&&(tl=!1,Cs=e,Yl=s),i=e.pendingLanes,i===0&&(Ts=null),p4(n.stateNode),Mn(e,$t()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Vl)throw Vl=!1,e=Xd,Xd=null,e;return Yl&1&&e.tag!==0&&Fi(),i=e.pendingLanes,i&1?e===Kd?Qo++:(Qo=0,Kd=e):Qo=0,zs(),null}function Fi(){if(Cs!==null){var e=xg(Yl),t=or.transition,n=at;try{if(or.transition=null,at=16>e?16:e,Cs===null)var r=!1;else{if(e=Cs,Cs=null,Yl=0,Ze&6)throw Error(ae(331));var s=Ze;for(Ze|=4,ke=e.current;ke!==null;){var i=ke,a=i.child;if(ke.flags&16){var l=i.deletions;if(l!==null){for(var d=0;d<l.length;d++){var h=l[d];for(ke=h;ke!==null;){var m=ke;switch(m.tag){case 0:case 11:case 15:Xo(8,m,i)}var w=m.child;if(w!==null)w.return=m,ke=w;else for(;ke!==null;){m=ke;var S=m.sibling,j=m.return;if(T2(m),m===h){ke=null;break}if(S!==null){S.return=j,ke=S;break}ke=j}}}var L=i.alternate;if(L!==null){var F=L.child;if(F!==null){L.child=null;do{var X=F.sibling;F.sibling=null,F=X}while(F!==null)}}ke=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ke=a;else e:for(;ke!==null;){if(i=ke,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xo(9,i,i.return)}var C=i.sibling;if(C!==null){C.return=i.return,ke=C;break e}ke=i.return}}var g=e.current;for(ke=g;ke!==null;){a=ke;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,ke=y;else e:for(a=g;ke!==null;){if(l=ke,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:wu(9,l)}}catch(_){Rt(l,l.return,_)}if(l===a){ke=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,ke=E;break e}ke=l.return}}if(Ze=s,zs(),Wr&&typeof Wr.onPostCommitFiberRoot=="function")try{Wr.onPostCommitFiberRoot(du,e)}catch{}r=!0}return r}finally{at=n,or.transition=t}}return!1}function a1(e,t,n){t=Ki(n,t),t=x2(e,t,1),e=Ms(e,t,1),t=vn(),e!==null&&(Aa(e,1,t),Mn(e,t))}function Rt(e,t,n){if(e.tag===3)a1(e,e,n);else for(;t!==null;){if(t.tag===3){a1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ts===null||!Ts.has(r))){e=Ki(n,e),e=S2(t,e,1),t=Ms(t,e,1),e=vn(),t!==null&&(Aa(t,1,e),Mn(t,e));break}}t=t.return}}function Uw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=vn(),e.pingedLanes|=e.suspendedLanes&n,Zt===e&&(rn&n)===n&&(Xt===4||Xt===3&&(rn&130023424)===rn&&500>$t()-sh?ei(e,0):rh|=n),Mn(e,t)}function U2(e,t){t===0&&(e.mode&1?(t=Wa,Wa<<=1,!(Wa&130023424)&&(Wa=4194304)):t=1);var n=vn();e=ls(e,t),e!==null&&(Aa(e,t,n),Mn(e,n))}function zw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),U2(e,n)}function Hw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(t),U2(e,n)}var z2;z2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nn.current)jn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return jn=!1,Mw(e,t,n);jn=!!(e.flags&131072)}else jn=!1,St&&t.flags&1048576&&Vg(t,Ol,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;gl(e,t),e=t.pendingProps;var s=Wi(t,fn.current);Bi(t,n),s=Jf(null,t,r,e,s,n);var i=qf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bn(r)?(i=!0,Bl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Vf(t),s.updater=vu,t.stateNode=s,s._reactInternals=t,Fd(t,r,e,n),t=Dd(null,t,r,!0,i,n)):(t.tag=0,St&&i&&$f(t),yn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(gl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Ww(r),e=Sr(r,e),s){case 0:t=$d(null,t,r,e,n);break e;case 1:t=Jm(null,t,r,e,n);break e;case 11:t=Km(null,t,r,e,n);break e;case 14:t=Qm(null,t,r,Sr(r.type,e),n);break e}throw Error(ae(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Sr(r,s),$d(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Sr(r,s),Jm(e,t,r,s,n);case 3:e:{if(C2(t),e===null)throw Error(ae(387));r=t.pendingProps,i=t.memoizedState,s=i.element,qg(e,t),Ul(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Ki(Error(ae(423)),t),t=qm(e,t,r,n,s);break e}else if(r!==s){s=Ki(Error(ae(424)),t),t=qm(e,t,r,n,s);break e}else for(Un=bs(t.stateNode.containerInfo.firstChild),zn=t,St=!0,Ar=null,n=Qg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Vi(),r===s){t=us(e,t,n);break e}yn(e,t,r,n)}t=t.child}return t;case 5:return Zg(t),e===null&&Rd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,bd(r,s)?a=null:i!==null&&bd(r,i)&&(t.flags|=32),E2(e,t),yn(e,t,a,n),t.child;case 6:return e===null&&Rd(t),null;case 13:return _2(e,t,n);case 4:return Yf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Yi(t,null,r,n):yn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Sr(r,s),Km(e,t,r,s,n);case 7:return yn(e,t,t.pendingProps,n),t.child;case 8:return yn(e,t,t.pendingProps.children,n),t.child;case 12:return yn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,ht($l,r._currentValue),r._currentValue=a,i!==null)if(jr(i.value,a)){if(i.children===s.children&&!Nn.current){t=us(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var d=l.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=ns(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?d.next=d:(d.next=m.next,m.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),Ld(i.return,n,t),l.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ae(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Ld(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}yn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Bi(t,n),s=ar(s),r=r(s),t.flags|=1,yn(e,t,r,n),t.child;case 14:return r=t.type,s=Sr(r,t.pendingProps),s=Sr(r.type,s),Qm(e,t,r,s,n);case 15:return k2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Sr(r,s),gl(e,t),t.tag=1,bn(r)?(e=!0,Bl(t)):e=!1,Bi(t,n),w2(t,r,s),Fd(t,r,s,n),Dd(null,t,r,!0,e,n);case 19:return j2(e,t,n);case 22:return A2(e,t,n)}throw Error(ae(156,t.tag))};function H2(e,t){return gg(e,t)}function Gw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sr(e,t,n,r){return new Gw(e,t,n,r)}function lh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ww(e){if(typeof e=="function")return lh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===jf)return 11;if(e===Nf)return 14}return 2}function Is(e,t){var n=e.alternate;return n===null?(n=sr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function wl(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")lh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case xi:return ti(n.children,s,i,t);case _f:a=8,s|=8;break;case ad:return e=sr(12,n,t,s|2),e.elementType=ad,e.lanes=i,e;case ld:return e=sr(13,n,t,s),e.elementType=ld,e.lanes=i,e;case ud:return e=sr(19,n,t,s),e.elementType=ud,e.lanes=i,e;case Z0:return Su(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case J0:a=10;break e;case q0:a=9;break e;case jf:a=11;break e;case Nf:a=14;break e;case ys:a=16,r=null;break e}throw Error(ae(130,e==null?e:typeof e,""))}return t=sr(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ti(e,t,n,r){return e=sr(7,e,r,t),e.lanes=n,e}function Su(e,t,n,r){return e=sr(22,e,r,t),e.elementType=Z0,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return e=sr(6,e,null,t),e.lanes=n,e}function Oc(e,t,n){return t=sr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vw(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vc(0),this.expirationTimes=vc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function uh(e,t,n,r,s,i,a,l,d){return e=new Vw(e,t,n,l,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=sr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vf(i),e}function Yw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function G2(e){if(!e)return Fs;e=e._reactInternals;e:{if(di(e)!==e||e.tag!==1)throw Error(ae(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ae(171))}if(e.tag===1){var n=e.type;if(bn(n))return Gg(e,n,t)}return t}function W2(e,t,n,r,s,i,a,l,d){return e=uh(n,r,!0,e,s,i,a,l,d),e.context=G2(null),n=e.current,r=vn(),s=Ps(n),i=ns(r,s),i.callback=t??null,Ms(n,i,s),e.current.lanes=s,Aa(e,s,r),Mn(e,r),e}function ku(e,t,n,r){var s=t.current,i=vn(),a=Ps(s);return n=G2(n),t.context===null?t.context=n:t.pendingContext=n,t=ns(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ms(s,t,a),e!==null&&(_r(e,s,a,i),hl(e,s,a)),a}function Kl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function l1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ch(e,t){l1(e,t),(e=e.alternate)&&l1(e,t)}function Xw(){return null}var V2=typeof reportError=="function"?reportError:function(e){console.error(e)};function dh(e){this._internalRoot=e}Au.prototype.render=dh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ae(409));ku(e,t,null,null)};Au.prototype.unmount=dh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ai(function(){ku(null,e,null,null)}),t[as]=null}};function Au(e){this._internalRoot=e}Au.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ag();e={blockedOn:null,target:e,priority:t};for(var n=0;n<xs.length&&t!==0&&t<xs[n].priority;n++);xs.splice(n,0,e),n===0&&Cg(e)}};function fh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Eu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function u1(){}function Kw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=Kl(a);i.call(h)}}var a=W2(t,r,e,0,null,!1,!1,"",u1);return e._reactRootContainer=a,e[as]=a.current,ua(e.nodeType===8?e.parentNode:e),ai(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=Kl(d);l.call(h)}}var d=uh(e,0,!1,null,null,!1,!1,"",u1);return e._reactRootContainer=d,e[as]=d.current,ua(e.nodeType===8?e.parentNode:e),ai(function(){ku(t,d,n,r)}),d}function Cu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var d=Kl(a);l.call(d)}}ku(t,a,e,s)}else a=Kw(n,t,e,s,r);return Kl(a)}Sg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Oo(t.pendingLanes);n!==0&&(Tf(t,n|1),Mn(t,$t()),!(Ze&6)&&(Qi=$t()+500,zs()))}break;case 13:ai(function(){var r=ls(e,1);if(r!==null){var s=vn();_r(r,e,1,s)}}),ch(e,1)}};Pf=function(e){if(e.tag===13){var t=ls(e,134217728);if(t!==null){var n=vn();_r(t,e,134217728,n)}ch(e,134217728)}};kg=function(e){if(e.tag===13){var t=Ps(e),n=ls(e,t);if(n!==null){var r=vn();_r(n,e,t,r)}ch(e,t)}};Ag=function(){return at};Eg=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};wd=function(e,t,n){switch(t){case"input":if(fd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=mu(r);if(!s)throw Error(ae(90));tg(r),fd(r,s)}}}break;case"textarea":rg(e,n);break;case"select":t=n.value,t!=null&&Pi(e,!!n.multiple,t,!1)}};cg=ih;dg=ai;var Qw={usingClientEntryPoint:!1,Events:[Ca,Ei,mu,lg,ug,ih]},To={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jw={bundleType:To.bundleType,version:To.version,rendererPackageName:To.rendererPackageName,rendererConfig:To.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pg(e),e===null?null:e.stateNode},findFiberByHostInstance:To.findFiberByHostInstance||Xw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nl.isDisabled&&nl.supportsFiber)try{du=nl.inject(Jw),Wr=nl}catch{}}Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qw;Wn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fh(t))throw Error(ae(200));return Yw(e,t,null,n)};Wn.createRoot=function(e,t){if(!fh(e))throw Error(ae(299));var n=!1,r="",s=V2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=uh(e,1,!1,null,null,n,!1,r,s),e[as]=t.current,ua(e.nodeType===8?e.parentNode:e),new dh(t)};Wn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ae(188)):(e=Object.keys(e).join(","),Error(ae(268,e)));return e=pg(t),e=e===null?null:e.stateNode,e};Wn.flushSync=function(e){return ai(e)};Wn.hydrate=function(e,t,n){if(!Eu(t))throw Error(ae(200));return Cu(null,e,t,!0,n)};Wn.hydrateRoot=function(e,t,n){if(!fh(e))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=V2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=W2(t,null,e,1,n??null,s,!1,i,a),e[as]=t.current,ua(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Au(t)};Wn.render=function(e,t,n){if(!Eu(t))throw Error(ae(200));return Cu(null,e,t,!1,n)};Wn.unmountComponentAtNode=function(e){if(!Eu(e))throw Error(ae(40));return e._reactRootContainer?(ai(function(){Cu(null,null,e,!1,function(){e._reactRootContainer=null,e[as]=null})}),!0):!1};Wn.unstable_batchedUpdates=ih;Wn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Eu(n))throw Error(ae(200));if(e==null||e._reactInternals===void 0)throw Error(ae(38));return Cu(e,t,n,!1,r)};Wn.version="18.3.1-next-f1338f8080-20240426";function Y2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Y2)}catch(e){console.error(e)}}Y2(),Y0.exports=Wn;var qw=Y0.exports,c1=qw;id.createRoot=c1.createRoot,id.hydrateRoot=c1.hydrateRoot;const Oi={},X2="production",d1={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-server.onrender.com/api",healthUrl:"https://cfg-server.onrender.com/health"}},K2=d1[X2]||d1.development,_u=()=>{if(!(Oi!=null&&Oi.VITE_API_BASE_URL))return K2.baseUrl},Zw=()=>{if(!(Oi!=null&&Oi.VITE_HEALTH_URL))return K2.healthUrl},ex=async()=>{try{const e=await fetch(Zw(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},tx=()=>X2;function nx({onStart:e}){const[t,n]=M.useState("1"),[r,s]=M.useState("individual"),[i,a]=M.useState("15"),[l,d]=M.useState({status:"checking",version:"...",commit:"...",healthy:!1});M.useEffect(()=>{const S=async()=>{const L=await ex();d(L),console.log("[StartDialog] Server health:",L)};S();const j=setInterval(S,3e4);return()=>clearInterval(j)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const S={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(S)},m=()=>{window.close()},w=()=>l.status==="checking"?"checking":l.healthy?"healthy":"unhealthy";return u.jsx("div",{className:"dialog-overlay",children:u.jsxs("div",{className:"dialog-box",children:[u.jsxs("div",{className:"dialog-header",children:[u.jsx("h2",{children:"The Creative Game"}),u.jsxs("div",{className:`server-health-indicator ${w()}`,title:`Server: ${l.status}
Version: ${l.version}
Commit: ${l.commit}
Environment: ${tx()}`,children:[u.jsx("span",{className:"health-light"}),u.jsx("span",{className:"health-text",children:"Server"})]})]}),u.jsxs("div",{className:"dialog-field",children:[u.jsx("label",{children:"ID:"}),u.jsx("input",{type:"text",value:t,onChange:S=>n(S.target.value)})]}),u.jsxs("div",{className:"dialog-field",children:[u.jsx("label",{children:"Condition:"}),u.jsxs("select",{value:r,onChange:S=>s(S.target.value),children:[u.jsx("option",{value:"individual",children:"individual"}),u.jsx("option",{value:"group",children:"group"})]})]}),u.jsxs("div",{className:"dialog-field",children:[u.jsx("label",{children:"Time (in minutes):"}),u.jsx("input",{type:"number",value:i,onChange:S=>a(S.target.value),min:"1"})]}),u.jsxs("div",{className:"dialog-buttons",children:[u.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),u.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),u.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),u.jsx("button",{className:"dialog-button cancel",onClick:m,children:"Cancel"})]})]})})}class f1{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const rx=.035;class sx{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=_u(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),l=s-i;let d=0,h=0,m=0;n>=0&&n<60?(d=i,h=a,m=0):n<120?(d=a,h=i,m=0):n<180?(d=0,h=i,m=a):n<240?(d=0,h=a,m=i):n<300?(d=a,h=0,m=i):(d=i,h=0,m=a);const w=S=>{const j=Math.round((S+l)*255).toString(16);return j.length===1?"0"+j:j};return`#${w(d)}${w(h)}${w(m)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const l=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${l}

Please choose a different Session ID.`),this.stop(),new Error(l)):new Error(l)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/rx,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),l=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(S=>this.relativeToGrid(S)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:l,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:l,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(S=>this.relativeToGrid(S)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(S=>this.relativeToGrid(S)):null)),this.moves.push(h),this.persistMove(h).catch(S=>{console.error("[GameTracker] Failed to persist move to server:",S)});const m=this.getCurrentBraceletStatus(),w=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:l,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:m,lastKnownPlayer:w,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(S=>({status:S.status,elapsed:S.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(l=>l.timestamp>=s&&l.timestamp<=i);if(a.length>0){const l={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(l[h.status]=(l[h.status]||0)+1)});const d=Object.keys(l).reduce((h,m)=>l[h]>l[m]?h:m,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let $c=null;const h1=()=>($c||($c=new sx),$c),Er=.07,Jo=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),Et=e=>Math.round(e*1e3)/1e3,ix=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[Et(i.position[0]-Er),Et(i.position[1])],[Et(i.position[0]+Er),Et(i.position[1])],[Et(i.position[0]),Et(i.position[1]-Er)],[Et(i.position[0]),Et(i.position[1]+Er)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},ox=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},qd=e=>e.map(t=>{const n=[],r=[[Et(t.position[0]-Er),Et(t.position[1])],[Et(t.position[0]+Er),Et(t.position[1])],[Et(t.position[0]),Et(t.position[1]-Er)],[Et(t.position[0]),Et(t.position[1]+Er)]];return e.forEach(s=>{r.forEach(i=>{Et(s.position[0])===i[0]&&Et(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),ax=e=>{const t=new Set;if(e.forEach((a,l)=>{a.forEach((d,h)=>{d&&t.add(`${l},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,l]=i.shift(),d=`${a},${l}`;s.has(d)||(s.add(d),n.forEach(([h,m])=>{const w=`${a+h},${l+m}`;t.has(w)&&!s.has(w)&&i.push([a+h,l+m])}))}return s.size===t.size},lx=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=Er)n.push(Et(i));const r=[];for(let i=-.7;i<0;i+=Er)r.push(Et(i));for(let i=0;i<=.77;i+=Er)r.push(Et(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const l=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);l!==-1&&d!==-1&&(s[d][l]=!0)}}),ax(s)},Zd=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=lx(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},p1=e=>{if(e.length===0)return null;try{const t=e.map(m=>m[0]),n=e.map(m=>m[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(m=>{const w=Math.sqrt(Math.pow(m[0]-r,2)+Math.pow(m[1]-s,2));w<i&&(i=w,a=m)});const l=-a[0],d=-a[1],h=e.map(m=>[Et(m[0]+l),Et(m[1]+d)]);return h.sort((m,w)=>m[0]-w[0]||m[1]-w[1]),h}catch{return null}},ux=60,m1=.07,Dc=120;function cx({config:e,interfaceHidden:t=!1}){const[n,r]=M.useState(Jo()),[s,i]=M.useState(null),[a,l]=M.useState({x:0,y:0}),[d,h]=M.useState(!0),[m,w]=M.useState(e.timeSeconds),[S,j]=M.useState(0),[L,F]=M.useState(null),[X,C]=M.useState(!0),[g,y]=M.useState(""),[E,_]=M.useState(!1),[T,D]=M.useState({blockSize:ux,bottomPadding:Dc}),H=M.useRef(null),se=M.useRef(new f1(e)),V=M.useRef(h1()),K=M.useRef(null),re=M.useRef(Date.now()),q=M.useRef(Dc),te=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,Se=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,ve="The experiment is done. Thank you very much for your participation!",ye=M.useCallback(()=>{const P=H.current;if(!P)return;const U=P.offsetWidth,J=P.offsetHeight;if(!U||!J)return;const ce=q.current||Dc;let $=Math.max(1,Math.min(U,J-ce)),v=Math.max(38,Math.min($*m1*.95,$/4)),R=Math.max(v*2.5,110);$=Math.max(1,Math.min(U,J-R)),v=Math.max(38,Math.min($*m1*.95,$/4)),R=Math.max(v*2.5,110),q.current=R,D(N=>{const b=Math.abs(N.blockSize-v),B=Math.abs(N.bottomPadding-R);return b<.5&&B<.5?N:{blockSize:v,bottomPadding:R}})},[]);M.useEffect(()=>(y(te),(async()=>{try{V.current.start(),await V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(U){console.error("[GameCanvas] Failed to initialize tracker:",U),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{C(!0),y(ve),_(!0),V.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,V.current.stop()}),[]),M.useEffect(()=>{ye()},[ye,t]),M.useEffect(()=>{const P=()=>{ye()};return P(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[ye]),M.useEffect(()=>{if(!d&&m>0){const P=setInterval(()=>{w(U=>U<=1?(clearInterval(P),C(!0),y(ve),_(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):U-1)},1e3);return()=>clearInterval(P)}},[d,m]),M.useEffect(()=>{r(P=>Zd(qd(P),d))},[d]);const ee=()=>(Date.now()-re.current)/1e3,oe=(P,U)=>{const J=H.current;if(!J)return 0;const ce=J.offsetHeight-q.current,$=Math.min(J.offsetWidth,ce),v=U==="x"?(J.offsetWidth-$)/2:(J.offsetHeight-q.current-$)/2;return(P-v)/$-.5},ne=(P,U)=>{const J=H.current;if(!J)return 0;const ce=J.offsetHeight-q.current,$=Math.min(J.offsetWidth,ce),v=U==="x"?(J.offsetWidth-$)/2:(J.offsetHeight-q.current-$)/2;return(P+.5)*$+v},we=P=>{var $,v,R,N;const U=H.current.getBoundingClientRect(),J=P.clientX!==void 0?P.clientX:(v=($=P.touches)==null?void 0:$[0])==null?void 0:v.clientX,ce=P.clientY!==void 0?P.clientY:(N=(R=P.touches)==null?void 0:R[0])==null?void 0:N.clientY;return{x:J-U.left,y:ce-U.top}},be=(P,U)=>{const J=n.find(R=>R.id===U);if(!J||!J.canMove)return;P.preventDefault();const ce=we(P),$=ne(J.position[0],"x"),v=ne(J.position[1],"y");K.current=Date.now(),i(U),l({x:ce.x-$,y:ce.y-v})},Ie=P=>{if(s===null)return;P.preventDefault();const U=we(P),J=oe(U.x-a.x,"x"),ce=oe(U.y-a.y,"y");r($=>$.map(v=>v.id===s?{...v,position:[J,ce]}:v))},Fe=()=>{try{const P=window.braceletDetectorVideo;if(!P||!P.videoWidth||P.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const U=document.createElement("canvas"),J=640,ce=480;let $=P.videoWidth,v=P.videoHeight;const R=$/v;return $>J&&($=J,v=$/R),v>ce&&(v=ce,$=v*R),U.width=Math.floor($),U.height=Math.floor(v),U.getContext("2d").drawImage(P,0,0,U.width,U.height),U.toDataURL("image/jpeg",.6)}catch(P){return console.error("[GameCanvas] Error capturing camera frame:",P),null}},Be=()=>{if(s===null)return;const P=n.find(b=>b.id===s),U=ix(n,s),J=ox(U,P.position),ce=K.current?(Date.now()-K.current)/1e3:0,$=n.map(b=>b.id===s?{...b,position:J}:b),v=Fe(),R=window.currentBraceletStatus||"Unknown",N={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:ee(),unit:s,end_position:J,all_positions:$.map(b=>b.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:v,player:R};se.current.write(N),V.current.recordMove(N,ce,v),r(b=>{const B=b.map(z=>z.id===s?{...z,position:J}:z);return Zd(qd(B),d)}),i(null),K.current=null},$e=()=>{const P=n.map(N=>N.position),U=p1(P),J=S+1,ce=Fe(),$=window.currentBraceletStatus||"Unknown",v={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:ee(),unit:null,end_position:null,all_positions:null,gallery_shape_number:J,gallery:P,gallery_normalized:U,camera_frame:ce,player:$};se.current.write(v),V.current.recordMove(v,0,ce);const R=Y();F(R),j(J)},Y=()=>{const P=document.createElement("canvas");P.width=400,P.height=400;const U=P.getContext("2d");U.fillStyle="#000",U.fillRect(0,0,400,400);const J=n.map($=>$.position),ce=p1(J);return ce&&ce.forEach($=>{const v=($[0]+.5)*400,R=($[1]+.5)*400;U.fillStyle="green",U.fillRect(v-15,R-15,30,30)}),P.toDataURL()},Q=M.useCallback(P=>{P.key==="p"&&d?(h(!1),C(!0),y(Se),re.current=Date.now(),r(Jo()),F(null),j(0),se.current=new f1(e),V.current.stop(),V.current=h1(),V.current.start(),V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):P.key==="q"&&!d&&(C(!0),y(ve),_(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);M.useEffect(()=>(window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)),[Q]);const ge=()=>{if(E&&g===ve){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&g===Se)try{const P=new(window.AudioContext||window.webkitAudioContext),U=P.createOscillator(),J=P.createGain();U.connect(J),J.connect(P.destination),U.frequency.setValueAtTime(800,P.currentTime),U.frequency.setValueAtTime(600,P.currentTime+.15),J.gain.setValueAtTime(.3,P.currentTime),J.gain.exponentialRampToValueAtTime(.01,P.currentTime+.3),U.start(P.currentTime),U.stop(P.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(P){console.error("[GameCanvas] Error playing sound:",P)}C(!1)},le=P=>{P.preventDefault()};return u.jsxs("div",{className:"game-canvas",ref:H,style:{"--block-size":`${T.blockSize}px`,"--bottom-padding":`${T.bottomPadding}px`},onMouseMove:Ie,onMouseUp:Be,onMouseLeave:Be,onTouchMove:Ie,onTouchEnd:Be,onTouchCancel:Be,onContextMenu:le,children:[u.jsx("div",{className:"gallery",onClick:$e,children:u.jsx("div",{className:"gallery-frame",children:L?u.jsx("img",{src:L,alt:"Gallery",className:"gallery-image"}):u.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&u.jsxs("div",{className:"timer",children:["Time: ",Math.floor(m/60),":",(m%60).toString().padStart(2,"0")]}),n.map(P=>u.jsx("div",{className:`block ${P.canMove?"movable":""}`,style:{left:`${ne(P.position[0],"x")}px`,top:`${ne(P.position[1],"y")}px`,backgroundColor:P.color||"green",cursor:P.canMove?"grab":"default"},onMouseDown:U=>be(U,P.id),onTouchStart:U=>be(U,P.id)},P.id)),X&&u.jsx("div",{className:"message-overlay",onClick:ge,children:u.jsxs("div",{className:"message-box",children:[g,u.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var Ql={};(function(){var e;function t(o){var c=0;return function(){return c<o.length?{done:!1,value:o[c++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof fc=="object"&&fc];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,c){if(c)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var x=o[p];if(!(x in f))break e;f=f[x]}o=o[o.length-1],p=f[o],c=c(p),c!=p&&c!=null&&n(f,o,{configurable:!0,writable:!0,value:c})}}i("Symbol",function(o){function c(A){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new f(p+(A||"")+"_"+x++,A)}function f(A,k){this.h=A,n(this,"description",{configurable:!0,writable:!0,value:k})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",x=0;return c}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<c.length;f++){var p=s[c[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function l(o){var c=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return c?c.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=l(o);for(var c,f=[];!(c=o.next()).done;)f.push(c.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,c){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(o[x]=p[x])}return o};i("Object.assign",function(o){return o||h});var m=typeof Object.create=="function"?Object.create:function(o){function c(){}return c.prototype=o,new c},w;if(typeof Object.setPrototypeOf=="function")w=Object.setPrototypeOf;else{var S;e:{var j={a:!0},L={};try{L.__proto__=j,S=L.a;break e}catch{}S=!1}w=S?function(o,c){if(o.__proto__=c,o.__proto__!==c)throw new TypeError(o+" is not extensible");return o}:null}var F=w;function X(o,c){if(o.prototype=m(c.prototype),o.prototype.constructor=o,F)F(o,c);else for(var f in c)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(c,f);p&&Object.defineProperty(o,f,p)}else o[f]=c[f];o.ya=c.prototype}function C(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function g(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}C.prototype.u=function(o){this.i=o};function y(o,c){o.l={ma:c,na:!0},o.h=o.s||o.v}C.prototype.return=function(o){this.l={return:o},this.h=this.v};function E(o,c,f){return o.h=f,{value:c}}function _(o){this.h=new C,this.i=o}function T(o,c){g(o.h);var f=o.h.j;return f?D(o,"return"in f?f.return:function(p){return{value:p,done:!0}},c,o.h.return):(o.h.return(c),H(o))}function D(o,c,f,p){try{var x=c.call(o.h.j,f);if(!(x instanceof Object))throw new TypeError("Iterator result "+x+" is not an object");if(!x.done)return o.h.m=!1,x;var A=x.value}catch(k){return o.h.j=null,y(o.h,k),H(o)}return o.h.j=null,p.call(o.h,A),H(o)}function H(o){for(;o.h.h;)try{var c=o.i(o.h);if(c)return o.h.m=!1,{value:c.value,done:!1}}catch(f){o.h.i=void 0,y(o.h,f)}if(o.h.m=!1,o.h.l){if(c=o.h.l,o.h.l=null,c.na)throw c.ma;return{value:c.return,done:!0}}return{value:void 0,done:!0}}function se(o){this.next=function(c){return g(o.h),o.h.j?c=D(o,o.h.j.next,c,o.h.u):(o.h.u(c),c=H(o)),c},this.throw=function(c){return g(o.h),o.h.j?c=D(o,o.h.j.throw,c,o.h.u):(y(o.h,c),c=H(o)),c},this.return=function(c){return T(o,c)},this[Symbol.iterator]=function(){return this}}function V(o){function c(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,x){function A(k){k.done?p(k.value):Promise.resolve(k.value).then(c,f).then(A,x)}A(o.next())})}function K(o){return V(new se(new _(o)))}i("Promise",function(o){function c(k){this.i=0,this.j=void 0,this.h=[],this.u=!1;var I=this.l();try{k(I.resolve,I.reject)}catch(G){I.reject(G)}}function f(){this.h=null}function p(k){return k instanceof c?k:new c(function(I){I(k)})}if(o)return o;f.prototype.i=function(k){if(this.h==null){this.h=[];var I=this;this.j(function(){I.m()})}this.h.push(k)};var x=s.setTimeout;f.prototype.j=function(k){x(k,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var k=this.h;this.h=[];for(var I=0;I<k.length;++I){var G=k[I];k[I]=null;try{G()}catch(ie){this.l(ie)}}}this.h=null},f.prototype.l=function(k){this.j(function(){throw k})},c.prototype.l=function(){function k(ie){return function(pe){G||(G=!0,ie.call(I,pe))}}var I=this,G=!1;return{resolve:k(this.I),reject:k(this.m)}},c.prototype.I=function(k){if(k===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(k instanceof c)this.L(k);else{e:switch(typeof k){case"object":var I=k!=null;break e;case"function":I=!0;break e;default:I=!1}I?this.F(k):this.s(k)}},c.prototype.F=function(k){var I=void 0;try{I=k.then}catch(G){this.m(G);return}typeof I=="function"?this.M(I,k):this.s(k)},c.prototype.m=function(k){this.v(2,k)},c.prototype.s=function(k){this.v(1,k)},c.prototype.v=function(k,I){if(this.i!=0)throw Error("Cannot settle("+k+", "+I+"): Promise already settled in state"+this.i);this.i=k,this.j=I,this.i===2&&this.K(),this.H()},c.prototype.K=function(){var k=this;x(function(){if(k.D()){var I=s.console;typeof I<"u"&&I.error(k.j)}},1)},c.prototype.D=function(){if(this.u)return!1;var k=s.CustomEvent,I=s.Event,G=s.dispatchEvent;return typeof G>"u"?!0:(typeof k=="function"?k=new k("unhandledrejection",{cancelable:!0}):typeof I=="function"?k=new I("unhandledrejection",{cancelable:!0}):(k=s.document.createEvent("CustomEvent"),k.initCustomEvent("unhandledrejection",!1,!0,k)),k.promise=this,k.reason=this.j,G(k))},c.prototype.H=function(){if(this.h!=null){for(var k=0;k<this.h.length;++k)A.i(this.h[k]);this.h=null}};var A=new f;return c.prototype.L=function(k){var I=this.l();k.T(I.resolve,I.reject)},c.prototype.M=function(k,I){var G=this.l();try{k.call(I,G.resolve,G.reject)}catch(ie){G.reject(ie)}},c.prototype.then=function(k,I){function G(_e,xe){return typeof _e=="function"?function(Le){try{ie(_e(Le))}catch(We){pe(We)}}:xe}var ie,pe,Re=new c(function(_e,xe){ie=_e,pe=xe});return this.T(G(k,ie),G(I,pe)),Re},c.prototype.catch=function(k){return this.then(void 0,k)},c.prototype.T=function(k,I){function G(){switch(ie.i){case 1:k(ie.j);break;case 2:I(ie.j);break;default:throw Error("Unexpected state: "+ie.i)}}var ie=this;this.h==null?A.i(G):this.h.push(G),this.u=!0},c.resolve=p,c.reject=function(k){return new c(function(I,G){G(k)})},c.race=function(k){return new c(function(I,G){for(var ie=l(k),pe=ie.next();!pe.done;pe=ie.next())p(pe.value).T(I,G)})},c.all=function(k){var I=l(k),G=I.next();return G.done?p([]):new c(function(ie,pe){function Re(Le){return function(We){_e[Le]=We,xe--,xe==0&&ie(_e)}}var _e=[],xe=0;do _e.push(void 0),xe++,p(G.value).T(Re(_e.length-1),pe),G=I.next();while(!G.done)})},c});function re(o,c){o instanceof String&&(o+="");var f=0,p=!1,x={next:function(){if(!p&&f<o.length){var A=f++;return{value:c(A,o[A]),done:!1}}return p=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.keys",function(o){return o||function(){return re(this,function(c){return c})}}),i("Array.prototype.fill",function(o){return o||function(c,f,p){var x=this.length||0;for(0>f&&(f=Math.max(0,x+f)),(p==null||p>x)&&(p=x),p=Number(p),0>p&&(p=Math.max(0,x+p)),f=Number(f||0);f<p;f++)this[f]=c;return this}});function q(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",q),i("Uint8Array.prototype.fill",q),i("Uint8ClampedArray.prototype.fill",q),i("Int16Array.prototype.fill",q),i("Uint16Array.prototype.fill",q),i("Int32Array.prototype.fill",q),i("Uint32Array.prototype.fill",q),i("Float32Array.prototype.fill",q),i("Float64Array.prototype.fill",q),i("Object.is",function(o){return o||function(c,f){return c===f?c!==0||1/c===1/f:c!==c&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(c,f){var p=this;p instanceof String&&(p=String(p));var x=p.length;for(f=f||0,0>f&&(f=Math.max(f+x,0));f<x;f++){var A=p[f];if(A===c||Object.is(A,c))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(c,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(c,f||0)!==-1}});var te=this||self;function Se(o,c){o=o.split(".");var f=te;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||c===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=c}function ve(o){var c;e:{if((c=te.navigator)&&(c=c.userAgent))break e;c=""}return c.indexOf(o)!=-1}var ye=Array.prototype.map?function(o,c){return Array.prototype.map.call(o,c,void 0)}:function(o,c){for(var f=o.length,p=Array(f),x=typeof o=="string"?o.split(""):o,A=0;A<f;A++)A in x&&(p[A]=c.call(void 0,x[A],A,o));return p},ee={},oe=null;function ne(o){var c=o.length,f=3*c/4;f%3?f=Math.floor(f):"=.".indexOf(o[c-1])!=-1&&(f="=.".indexOf(o[c-2])!=-1?f-2:f-1);var p=new Uint8Array(f),x=0;return we(o,function(A){p[x++]=A}),x!==f?p.subarray(0,x):p}function we(o,c){function f(G){for(;p<o.length;){var ie=o.charAt(p++),pe=oe[ie];if(pe!=null)return pe;if(!/^[\s\xa0]*$/.test(ie))throw Error("Unknown base64 encoding at char: "+ie)}return G}be();for(var p=0;;){var x=f(-1),A=f(0),k=f(64),I=f(64);if(I===64&&x===-1)break;c(x<<2|A>>4),k!=64&&(c(A<<4&240|k>>2),I!=64&&c(k<<6&192|I))}}function be(){if(!oe){oe={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(c[f].split(""));ee[f]=p;for(var x=0;x<p.length;x++){var A=p[x];oe[A]===void 0&&(oe[A]=x)}}}}var Ie=typeof Uint8Array<"u",Fe=!(ve("Trident")||ve("MSIE"))&&typeof te.btoa=="function";function Be(o){if(!Fe){var c;c===void 0&&(c=0),be(),c=ee[c];for(var f=Array(Math.floor(o.length/3)),p=c[64]||"",x=0,A=0;x<o.length-2;x+=3){var k=o[x],I=o[x+1],G=o[x+2],ie=c[k>>2];k=c[(k&3)<<4|I>>4],I=c[(I&15)<<2|G>>6],G=c[G&63],f[A++]=ie+k+I+G}switch(ie=0,G=p,o.length-x){case 2:ie=o[x+1],G=c[(ie&15)<<2]||p;case 1:o=o[x],f[A]=c[o>>2]+c[(o&3)<<4|ie>>4]+G+p}return f.join("")}for(c="";10240<o.length;)c+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return c+=String.fromCharCode.apply(null,o),btoa(c)}var $e=RegExp("[-_.]","g");function Y(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Q(o){if(!Fe)return ne(o);$e.test(o)&&(o=o.replace($e,Y)),o=atob(o);for(var c=new Uint8Array(o.length),f=0;f<o.length;f++)c[f]=o.charCodeAt(f);return c}var ge;function le(){return ge||(ge=new Uint8Array(0))}var P={},U=typeof Uint8Array.prototype.slice=="function",J=0,ce=0;function $(o){var c=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),c&&(f=l(R(f,o)),c=f.next().value,o=f.next().value,f=c),J=f>>>0,ce=o>>>0}var v=typeof BigInt=="function";function R(o,c){return c=~c,o?o=~o+1:c+=1,[o,c]}function N(o,c){this.i=o>>>0,this.h=c>>>0}function b(o){if(!o)return B||(B=new N(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)$(Number(o));else if(v)o=BigInt(o),J=Number(o&BigInt(4294967295))>>>0,ce=Number(o>>BigInt(32)&BigInt(4294967295));else{var c=+(o[0]==="-");ce=J=0;for(var f=o.length,p=c,x=(f-c)%6+c;x<=f;p=x,x+=6)p=Number(o.slice(p,x)),ce*=1e6,J=1e6*J+p,4294967296<=J&&(ce+=J/4294967296|0,J%=4294967296);c&&(c=l(R(J,ce)),o=c.next().value,c=c.next().value,J=o,ce=c)}return new N(J,ce)}var B;function z(o,c){return Error("Invalid wire type: "+o+" (at position "+c+")")}function W(){return Error("Failed to read varint, encoding is invalid.")}function fe(o,c){return Error("Tried to read past the end of the data "+c+" > "+o)}function me(){throw Error("Invalid UTF8")}function Pe(o,c){return c=String.fromCharCode.apply(null,c),o==null?c:o+c}var Me=void 0,Ge,tt=typeof TextDecoder<"u",st,lt=typeof TextEncoder<"u",ut;function Ve(o){if(o!==P)throw Error("illegal external caller")}function ze(o,c){if(Ve(c),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function He(){return ut||(ut=new ze(null,P))}function qe(o){Ve(P);var c=o.V;return c=c==null||Ie&&c!=null&&c instanceof Uint8Array?c:typeof c=="string"?Q(c):null,c==null?c:o.V=c}function bt(o){if(typeof o=="string")return{buffer:Q(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===ze)return{buffer:qe(o)||le(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function on(o,c){this.i=null,this.m=!1,this.h=this.j=this.l=0,mt(this,o,c)}function mt(o,c,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,c&&(c=bt(c),o.i=c.buffer,o.m=c.C,o.l=0,o.j=o.i.length,o.h=o.l)}on.prototype.reset=function(){this.h=this.l};function Ut(o,c){if(o.h=c,c>o.j)throw fe(o.j,c)}function Mt(o){var c=o.i,f=o.h,p=c[f++],x=p&127;if(p&128&&(p=c[f++],x|=(p&127)<<7,p&128&&(p=c[f++],x|=(p&127)<<14,p&128&&(p=c[f++],x|=(p&127)<<21,p&128&&(p=c[f++],x|=p<<28,p&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128)))))throw W();return Ut(o,f),x}function Tt(o,c){if(0>c)throw Error("Tried to read a negative byte length: "+c);var f=o.h,p=f+c;if(p>o.j)throw fe(c,o.j-f);return o.h=p,f}var hn=[];function pn(){this.h=[]}pn.prototype.length=function(){return this.h.length},pn.prototype.end=function(){var o=this.h;return this.h=[],o};function Rn(o,c,f){for(;0<f||127<c;)o.h.push(c&127|128),c=(c>>>7|f<<25)>>>0,f>>>=7;o.h.push(c)}function mn(o,c){for(;127<c;)o.h.push(c&127|128),c>>>=7;o.h.push(c)}function Pr(o,c){if(hn.length){var f=hn.pop();mt(f,o,c),o=f}else o=new on(o,c);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(c)}Pr.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},Pr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function pr(o){var c=o.h;if(c.h==c.j)return!1;o.j=o.h.h;var f=Mt(o.h)>>>0;if(c=f>>>3,f&=7,!(0<=f&&5>=f))throw z(f,o.j);if(1>c)throw Error("Invalid field number: "+c+" (at position "+o.j+")");return o.l=c,o.i=f,!0}function mr(o){switch(o.i){case 0:if(o.i!=0)mr(o);else e:{o=o.h;for(var c=o.h,f=c+10,p=o.i;c<f;)if(!(p[c++]&128)){Ut(o,c);break e}throw W()}break;case 1:o=o.h,Ut(o,o.h+8);break;case 2:o.i!=2?mr(o):(c=Mt(o.h)>>>0,o=o.h,Ut(o,o.h+c));break;case 5:o=o.h,Ut(o,o.h+4);break;case 3:c=o.l;do{if(!pr(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=c)throw Error("Unmatched end-group tag");break}mr(o)}while(!0);break;default:throw z(o.i,o.j)}}var gr=[];function O(){this.j=[],this.i=0,this.h=new pn}function ue(o,c){c.length!==0&&(o.j.push(c),o.i+=c.length)}function de(o,c){if(c=c.R){ue(o,o.h.end());for(var f=0;f<c.length;f++)ue(o,qe(c[f])||le())}}var Z=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function he(o,c){return Z?o[Z]|=c:o.A!==void 0?o.A|=c:(Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}}),c)}function Ue(o,c){Z?o[Z]&&(o[Z]&=~c):o.A!==void 0&&(o.A&=~c)}function De(o){var c;return Z?c=o[Z]:c=o.A,c??0}function Qe(o,c){Z?o[Z]=c:o.A!==void 0?o.A=c:Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}})}function Oe(o){return he(o,1),o}function Xe(o,c){Qe(c,(o|0)&-51)}function Ft(o,c){Qe(c,(o|18)&-41)}var yr={};function Qn(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var wo,Sp=[];Qe(Sp,23),wo=Object.freeze(Sp);function ec(o){if(De(o.o)&2)throw Error("Cannot mutate an immutable Message")}function tc(o){var c=o.length;(c=c?o[c-1]:void 0)&&Qn(c)?c.g=1:(c={},o.push((c.g=1,c)))}function kp(o){var c=o.i+o.G;return o.B||(o.B=o.o[c]={})}function vr(o,c){return c===-1?null:c>=o.i?o.B?o.B[c]:void 0:o.o[c+o.G]}function Ir(o,c,f,p){ec(o),xo(o,c,f,p)}function xo(o,c,f,p){o.j&&(o.j=void 0),c>=o.i||p?kp(o)[c]=f:(o.o[c+o.G]=f,(o=o.B)&&c in o&&delete o[c])}function nc(o,c,f,p){var x=vr(o,c);Array.isArray(x)||(x=wo);var A=De(x);if(A&1||Oe(x),p)A&2||he(x,2),f&1||Object.freeze(x);else{p=!(f&2);var k=A&2;f&1||!k?p&&A&16&&!k&&Ue(x,16):(x=Oe(Array.prototype.slice.call(x)),xo(o,c,x))}return x}function rc(o,c){var f=vr(o,c),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&xo(o,c,p),p}function Ap(o,c,f,p,x){o.h||(o.h={});var A=o.h[f],k=nc(o,f,3,x);if(!A){var I=k;A=[];var G=!!(De(o.o)&16);k=!!(De(I)&2);var ie=I;!x&&k&&(I=Array.prototype.slice.call(I));for(var pe=k,Re=0;Re<I.length;Re++){var _e=I[Re],xe=c,Le=!1;if(Le=Le===void 0?!1:Le,_e=Array.isArray(_e)?new xe(_e):Le?new xe:void 0,_e!==void 0){xe=_e.o;var We=Le=De(xe);k&&(We|=2),G&&(We|=16),We!=Le&&Qe(xe,We),xe=We,pe=pe||!!(2&xe),A.push(_e)}}return o.h[f]=A,G=De(I),c=G|33,c=pe?c&-9:c|8,G!=c&&(pe=I,Object.isFrozen(pe)&&(pe=Array.prototype.slice.call(pe)),Qe(pe,c),I=pe),ie!==I&&xo(o,f,I),(x||p&&k)&&he(A,2),p&&Object.freeze(A),A}return x||(x=Object.isFrozen(A),p&&!x?Object.freeze(A):!p&&x&&(A=Array.prototype.slice.call(A),o.h[f]=A)),A}function Pa(o,c,f){var p=!!(De(o.o)&2);if(c=Ap(o,c,f,p,p),o=nc(o,f,3,p),!(p||De(o)&8)){for(p=0;p<c.length;p++){if(f=c[p],De(f.o)&2){var x=bp(f,!1);x.j=f}else x=f;f!==x&&(c[p]=x,o[p]=x.o)}he(o,8)}return c}function Rr(o,c,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);Ir(o,c,f)}function Ep(o,c,f,p,x){ec(o);var A=Ap(o,f,c,!1,!1);return f=p??new f,o=nc(o,c,2,!1),x!=null?(A.splice(x,0,f),o.splice(x,0,f.o)):(A.push(f),o.push(f.o)),f.C()&&Ue(o,8),f}function Ia(o,c){return o??c}function Lr(o,c,f){return f=f===void 0?0:f,Ia(rc(o,c),f)}var Ra;function Wv(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(De(o)&128)return o=Array.prototype.slice.call(o),tc(o),o}else{if(Ie&&o!=null&&o instanceof Uint8Array)return Be(o);if(o instanceof ze){var c=o.V;return c==null?"":typeof c=="string"?c:o.V=Be(c)}}}return o}function Cp(o,c,f,p){if(o!=null){if(Array.isArray(o))o=sc(o,c,f,p!==void 0);else if(Qn(o)){var x={},A;for(A in o)x[A]=Cp(o[A],c,f,p);o=x}else o=c(o,p);return o}}function sc(o,c,f,p){var x=De(o);p=p?!!(x&16):void 0,o=Array.prototype.slice.call(o);for(var A=0;A<o.length;A++)o[A]=Cp(o[A],c,f,p);return f(x,o),o}function Vv(o){return o.ja===yr?o.toJSON():Wv(o)}function Yv(o,c){o&128&&tc(c)}function _p(o,c,f){if(f=f===void 0?Ft:f,o!=null){if(Ie&&o instanceof Uint8Array)return o.length?new ze(new Uint8Array(o),P):He();if(Array.isArray(o)){var p=De(o);return p&2?o:c&&!(p&32)&&(p&16||p===0)?(Qe(o,p|2),o):(o=sc(o,_p,p&4?Ft:f,!0),c=De(o),c&4&&c&2&&Object.freeze(o),o)}return o.ja===yr?Np(o):o}}function jp(o,c,f,p,x,A,k){if(o=o.h&&o.h[f]){if(p=De(o),p&2?p=o:(A=ye(o,Np),Ft(p,A),Object.freeze(A),p=A),ec(c),k=p==null?wo:Oe([]),p!=null){for(A=!!p.length,o=0;o<p.length;o++){var I=p[o];A=A&&!(De(I.o)&2),k[o]=I.o}A=(A?8:0)|1,o=De(k),(o&A)!==A&&(Object.isFrozen(k)&&(k=Array.prototype.slice.call(k)),Qe(k,o|A)),c.h||(c.h={}),c.h[f]=p}else c.h&&(c.h[f]=void 0);xo(c,f,k,x)}else Ir(c,f,_p(p,A,k),x)}function Np(o){return De(o.o)&2||(o=bp(o,!0),he(o.o,2)),o}function bp(o,c){var f=o.o,p=[];he(p,16);var x=o.constructor.h;if(x&&p.push(x),x=o.B,x){p.length=f.length,p.fill(void 0,p.length,f.length);var A={};p[p.length-1]=A}De(f)&128&&tc(p),c=c||o.C()?Ft:Xe,A=o.constructor,Ra=p,p=new A(p),Ra=void 0,o.R&&(p.R=o.R.slice()),A=!!(De(f)&16);for(var k=x?f.length-1:f.length,I=0;I<k;I++)jp(o,p,I-o.G,f[I],!1,A,c);if(x)for(var G in x)jp(o,p,+G,x[G],!0,A,c);return p}function En(o,c,f){o==null&&(o=Ra),Ra=void 0;var p=this.constructor.i||0,x=0<p,A=this.constructor.h,k=!1;if(o==null){o=A?[A]:[];var I=48,G=!0;x&&(p=0,I|=128),Qe(o,I)}else{if(!Array.isArray(o)||A&&A!==o[0])throw Error();var ie=I=he(o,0);if((G=(16&ie)!==0)&&((k=(32&ie)!==0)||(ie|=32)),x){if(128&ie)p=0;else if(0<o.length){var pe=o[o.length-1];if(Qn(pe)&&"g"in pe){p=0,ie|=128,delete pe.g;var Re=!0,_e;for(_e in pe){Re=!1;break}Re&&o.pop()}}}else if(128&ie)throw Error();I!==ie&&Qe(o,ie)}this.G=(A?0:-1)-p,this.h=void 0,this.o=o;e:{if(A=this.o.length,p=A-1,A&&(A=this.o[p],Qn(A))){this.B=A,this.i=p-this.G;break e}c!==void 0&&-1<c?(this.i=Math.max(c,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!x&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){c=G&&!k&&!0,x=this.i;var xe;for(G=0;G<f.length;G++)k=f[G],k<x?(k+=this.G,(p=o[k])?Mp(p,c):o[k]=wo):(xe||(xe=kp(this)),(p=xe[k])?Mp(p,c):xe[k]=wo)}}En.prototype.toJSON=function(){return sc(this.o,Vv,Yv)},En.prototype.C=function(){return!!(De(this.o)&2)};function Mp(o,c){if(Array.isArray(o)){var f=De(o),p=1;!c||f&2||(p|=16),(f&p)!==p&&Qe(o,f|p)}}En.prototype.ja=yr,En.prototype.toString=function(){return this.o.toString()};function Tp(o,c,f){if(f){var p={},x;for(x in f){var A=f[x],k=A.qa;k||(p.J=A.wa||A.oa.W,A.ia?(p.aa=Bp(A.ia),k=function(I){return function(G,ie,pe){return I.J(G,ie,pe,I.aa)}}(p)):A.ka?(p.Z=Fp(A.da.P,A.ka),k=function(I){return function(G,ie,pe){return I.J(G,ie,pe,I.Z)}}(p)):k=p.J,A.qa=k),k(c,o,A.da),p={J:p.J,aa:p.aa,Z:p.Z}}}de(c,o)}var La=Symbol();function Pp(o,c,f){return o[La]||(o[La]=function(p,x){return c(p,x,f)})}function Ip(o){var c=o[La];if(!c){var f=oc(o);c=function(p,x){return Op(p,x,f)},o[La]=c}return c}function Xv(o){var c=o.ia;if(c)return Ip(c);if(c=o.va)return Pp(o.da.P,c,o.ka)}function Kv(o){var c=Xv(o),f=o.da,p=o.oa.U;return c?function(x,A){return p(x,A,f,c)}:function(x,A){return p(x,A,f)}}function Rp(o,c){var f=o[c];return typeof f=="function"&&f.length===0&&(f=f(),o[c]=f),Array.isArray(f)&&(ko in f||So in f||0<f.length&&typeof f[0]=="function")?f:void 0}function Lp(o,c,f,p,x,A){c.P=o[0];var k=1;if(o.length>k&&typeof o[k]!="number"){var I=o[k++];f(c,I)}for(;k<o.length;){f=o[k++];for(var G=k+1;G<o.length&&typeof o[G]!="number";)G++;switch(I=o[k++],G-=k,G){case 0:p(c,f,I);break;case 1:(G=Rp(o,k))?(k++,x(c,f,I,G)):p(c,f,I,o[k++]);break;case 2:G=k++,G=Rp(o,G),x(c,f,I,G,o[k++]);break;case 3:A(c,f,I,o[k++],o[k++],o[k++]);break;case 4:A(c,f,I,o[k++],o[k++],o[k++],o[k++]);break;default:throw Error("unexpected number of binary field arguments: "+G)}}return c}var Ba=Symbol();function Bp(o){var c=o[Ba];if(!c){var f=ic(o);c=function(p,x){return $p(p,x,f)},o[Ba]=c}return c}function Fp(o,c){var f=o[Ba];return f||(f=function(p,x){return Tp(p,x,c)},o[Ba]=f),f}var So=Symbol();function Qv(o,c){o.push(c)}function Jv(o,c,f){o.push(c,f.W)}function qv(o,c,f,p){var x=Bp(p),A=ic(p).P,k=f.W;o.push(c,function(I,G,ie){return k(I,G,ie,A,x)})}function Zv(o,c,f,p,x,A){var k=Fp(p,A),I=f.W;o.push(c,function(G,ie,pe){return I(G,ie,pe,p,k)})}function ic(o){var c=o[So];return c||(c=Lp(o,o[So]=[],Qv,Jv,qv,Zv),ko in o&&So in o&&(o.length=0),c)}var ko=Symbol();function e3(o,c){o[0]=c}function t3(o,c,f,p){var x=f.U;o[c]=p?function(A,k,I){return x(A,k,I,p)}:x}function n3(o,c,f,p,x){var A=f.U,k=Ip(p),I=oc(p).P;o[c]=function(G,ie,pe){return A(G,ie,pe,I,k,x)}}function r3(o,c,f,p,x,A,k){var I=f.U,G=Pp(p,x,A);o[c]=function(ie,pe,Re){return I(ie,pe,Re,p,G,k)}}function oc(o){var c=o[ko];return c||(c=Lp(o,o[ko]={},e3,t3,n3,r3),ko in o&&So in o&&(o.length=0),c)}function Op(o,c,f){for(;pr(c)&&c.i!=4;){var p=c.l,x=f[p];if(!x){var A=f[0];A&&(A=A[p])&&(x=f[p]=Kv(A))}if(!x||!x(c,o,p)){x=c,p=o,A=x.j,mr(x);var k=x;if(!k.ca){if(x=k.h.h-A,k.h.h=A,k=k.h,x==0)x=He();else{if(A=Tt(k,x),k.S&&k.m)x=k.i.subarray(A,A+x);else{k=k.i;var I=A;x=A+x,x=I===x?le():U?k.slice(I,x):new Uint8Array(k.subarray(I,x))}x=x.length==0?He():new ze(x,P)}(A=p.R)?A.push(x):p.R=[x]}}}return o}function $p(o,c,f){for(var p=f.length,x=p%2==1,A=x?1:0;A<p;A+=2)(0,f[A+1])(c,o,f[A]);Tp(o,c,x?f[0]:void 0)}function Ao(o,c){return{U:o,W:c}}var wr=Ao(function(o,c,f){if(o.i!==5)return!1;o=o.h;var p=o.i,x=o.h,A=p[x],k=p[x+1],I=p[x+2];return p=p[x+3],Ut(o,o.h+4),k=(A<<0|k<<8|I<<16|p<<24)>>>0,o=2*(k>>31)+1,A=k>>>23&255,k&=8388607,Ir(c,f,A==255?k?NaN:1/0*o:A==0?o*Math.pow(2,-149)*k:o*Math.pow(2,A-150)*(k+Math.pow(2,23))),!0},function(o,c,f){if(c=rc(c,f),c!=null){mn(o.h,8*f+5),o=o.h;var p=+c;p===0?0<1/p?J=ce=0:(ce=0,J=2147483648):isNaN(p)?(ce=0,J=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(ce=0,J=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),ce=0,J=(f|p)>>>0):(c=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-c),p=Math.round(8388608*p),16777216<=p&&++c,ce=0,J=(f|c+127<<23|p&8388607)>>>0)),f=J,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),s3=Ao(function(o,c,f){if(o.i!==0)return!1;var p=o.h,x=0,A=o=0,k=p.i,I=p.h;do{var G=k[I++];x|=(G&127)<<A,A+=7}while(32>A&&G&128);for(32<A&&(o|=(G&127)>>4),A=3;32>A&&G&128;A+=7)G=k[I++],o|=(G&127)<<A;if(Ut(p,I),128>G)p=x>>>0,G=o>>>0,(o=G&2147483648)&&(p=~p+1>>>0,G=~G>>>0,p==0&&(G=G+1>>>0)),p=4294967296*G+(p>>>0);else throw W();return Ir(c,f,o?-p:p),!0},function(o,c,f){c=vr(c,f),c!=null&&(typeof c=="string"&&b(c),c!=null&&(mn(o.h,8*f),typeof c=="number"?(o=o.h,$(c),Rn(o,J,ce)):(f=b(c),Rn(o.h,f.i,f.h))))}),i3=Ao(function(o,c,f){return o.i!==0?!1:(Ir(c,f,Mt(o.h)),!0)},function(o,c,f){if(c=vr(c,f),c!=null&&c!=null)if(mn(o.h,8*f),o=o.h,f=c,0<=f)mn(o,f);else{for(c=0;9>c;c++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),Dp=Ao(function(o,c,f){if(o.i!==2)return!1;var p=Mt(o.h)>>>0;o=o.h;var x=Tt(o,p);if(o=o.i,tt){var A=o,k;(k=Ge)||(k=Ge=new TextDecoder("utf-8",{fatal:!0})),o=x+p,A=x===0&&o===A.length?A:A.subarray(x,o);try{var I=k.decode(A)}catch(Re){if(Me===void 0){try{k.decode(new Uint8Array([128]))}catch{}try{k.decode(new Uint8Array([97])),Me=!0}catch{Me=!1}}throw!Me&&(Ge=void 0),Re}}else{I=x,p=I+p,x=[];for(var G=null,ie,pe;I<p;)ie=o[I++],128>ie?x.push(ie):224>ie?I>=p?me():(pe=o[I++],194>ie||(pe&192)!==128?(I--,me()):x.push((ie&31)<<6|pe&63)):240>ie?I>=p-1?me():(pe=o[I++],(pe&192)!==128||ie===224&&160>pe||ie===237&&160<=pe||((A=o[I++])&192)!==128?(I--,me()):x.push((ie&15)<<12|(pe&63)<<6|A&63)):244>=ie?I>=p-2?me():(pe=o[I++],(pe&192)!==128||(ie<<28)+(pe-144)>>30||((A=o[I++])&192)!==128||((k=o[I++])&192)!==128?(I--,me()):(ie=(ie&7)<<18|(pe&63)<<12|(A&63)<<6|k&63,ie-=65536,x.push((ie>>10&1023)+55296,(ie&1023)+56320))):me(),8192<=x.length&&(G=Pe(G,x),x.length=0);I=Pe(G,x)}return Ir(c,f,I),!0},function(o,c,f){if(c=vr(c,f),c!=null){var p=!1;if(p=p===void 0?!1:p,lt){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(c))throw Error("Found an unpaired surrogate");c=(st||(st=new TextEncoder)).encode(c)}else{for(var x=0,A=new Uint8Array(3*c.length),k=0;k<c.length;k++){var I=c.charCodeAt(k);if(128>I)A[x++]=I;else{if(2048>I)A[x++]=I>>6|192;else{if(55296<=I&&57343>=I){if(56319>=I&&k<c.length){var G=c.charCodeAt(++k);if(56320<=G&&57343>=G){I=1024*(I-55296)+G-56320+65536,A[x++]=I>>18|240,A[x++]=I>>12&63|128,A[x++]=I>>6&63|128,A[x++]=I&63|128;continue}else k--}if(p)throw Error("Found an unpaired surrogate");I=65533}A[x++]=I>>12|224,A[x++]=I>>6&63|128}A[x++]=I&63|128}}c=x===A.length?A:A.subarray(0,x)}mn(o.h,8*f+2),mn(o.h,c.length),ue(o,o.h.end()),ue(o,c)}}),Up=Ao(function(o,c,f,p,x){if(o.i!==2)return!1;c=Ep(c,f,p),f=o.h.j,p=Mt(o.h)>>>0;var A=o.h.h+p,k=A-f;if(0>=k&&(o.h.j=A,x(c,o,void 0,void 0,void 0),k=A-o.h.h),k)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-k)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=A,o.h.j=f,!0},function(o,c,f,p,x){if(c=Pa(c,p,f),c!=null)for(p=0;p<c.length;p++){var A=o;mn(A.h,8*f+2);var k=A.h.end();ue(A,k),k.push(A.i),A=k,x(c[p],o),k=o;var I=A.pop();for(I=k.i+k.h.length()-I;127<I;)A.push(I&127|128),I>>>=7,k.i++;A.push(I),k.i++}});function ac(o){return function(c,f){e:{if(gr.length){var p=gr.pop();p.setOptions(f),mt(p.h,c,f),c=p}else c=new Pr(c,f);try{var x=oc(o),A=Op(new x.P,c,x);break e}finally{x=c.h,x.i=null,x.m=!1,x.l=0,x.j=0,x.h=0,x.S=!1,c.l=-1,c.i=-1,100>gr.length&&gr.push(c)}A=void 0}return A}}function lc(o){return function(){var c=new O;$p(this,c,ic(o)),ue(c,c.h.end());for(var f=new Uint8Array(c.i),p=c.j,x=p.length,A=0,k=0;k<x;k++){var I=p[k];f.set(I,A),A+=I.length}return c.j=[f],f}}function hi(o){En.call(this,o)}X(hi,En);var zp=[hi,1,i3,2,wr,3,Dp,4,Dp];hi.prototype.l=lc(zp);function uc(o){En.call(this,o,-1,o3)}X(uc,En),uc.prototype.addClassification=function(o,c){return Ep(this,1,hi,o,c),this};var o3=[1],Hp=ac([uc,1,Up,zp]);function pi(o){En.call(this,o)}X(pi,En);var Gp=[pi,1,wr,2,wr,3,wr,4,wr,5,wr];pi.prototype.l=lc(Gp);function Wp(o){En.call(this,o,-1,a3)}X(Wp,En);var a3=[1],Vp=ac([Wp,1,Up,Gp]);function Fa(o){En.call(this,o)}X(Fa,En);var Yp=[Fa,1,wr,2,wr,3,wr,4,wr,5,wr,6,s3],l3=ac(Yp);Fa.prototype.l=lc(Yp);function Xp(o,c,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function Kp(o){return Pa(o,hi,1).map(function(c){var f=vr(c,1);return{index:f??0,score:Lr(c,2),label:vr(c,3)!=null?Ia(vr(c,3),""):void 0,displayName:vr(c,4)!=null?Ia(vr(c,4),""):void 0}})}function Qp(o){return{x:Lr(o,1),y:Lr(o,2),z:Lr(o,3),visibility:rc(o,4)!=null?Lr(o,4):void 0}}function Jp(o){return o.map(function(c){return Pa(Vp(c),pi,1).map(Qp)})}function cc(o,c){this.i=o,this.h=c,this.m=0}function qp(o,c,f){return u3(o,c),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function u3(o,c){var f=o.h;if(o.s===void 0){var p=Xp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),x=Xp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),A=f.createProgram();if(f.attachShader(A,p),f.attachShader(A,x),f.linkProgram(A),!f.getProgramParameter(A,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(A));p=o.s=A,f.useProgram(p),x=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:x},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(x,0)}p=o.l,f.useProgram(o.s),f.canvas.width=c.width,f.canvas.height=c.height,f.viewport(0,0,c.width,c.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(c.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function c3(o){this.h=o}var d3=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function f3(o,c){return c+o}function Zp(o,c){window[o]=c}function h3(o){var c=document.createElement("script");return c.setAttribute("src",o),c.setAttribute("crossorigin","anonymous"),new Promise(function(f){c.addEventListener("load",function(){f()},!1),c.addEventListener("error",function(){f()},!1),document.body.appendChild(c)})}function p3(){return K(function(o){switch(o.h){case 1:return o.s=2,E(o,WebAssembly.instantiate(d3),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function dc(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||f3,typeof window=="object")var c=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")c=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=c,o.options){c=l(Object.keys(o.options));for(var f=c.next();!f.done;f=c.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=dc.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function m3(o){var c,f,p,x,A,k,I,G,ie,pe,Re;return K(function(_e){switch(_e.h){case 1:return o.ga?(c=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,E(_e,p3(),2)):_e.return();case 2:if(f=_e.i,typeof window=="object")return Zp("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),Zp("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),k=c.filter(function(xe){return xe.data!==void 0}),I=c.filter(function(xe){return xe.data===void 0}),G=Promise.all(k.map(function(xe){var Le=Oa(o,xe.url);if(xe.path!==void 0){var We=xe.path;Le=Le.then(function(gt){return o.overrideFile(We,gt),Promise.resolve(gt)})}return Le})),ie=Promise.all(I.map(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f?h3(o.locateFile(xe.url,o.ha)):Promise.resolve()})).then(function(){var xe,Le,We;return K(function(gt){if(gt.h==1)return xe=window.createMediapipeSolutionsWasm,Le=window.createMediapipeSolutionsPackedAssets,We=o,E(gt,xe(Le),2);We.i=gt.i,gt.h=0})}),pe=function(){return K(function(xe){return o.h.graph&&o.h.graph.url?xe=E(xe,Oa(o,o.h.graph.url),0):(xe.h=0,xe=void 0),xe})}(),E(_e,Promise.all([ie,G,pe]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=c.filter(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f}).map(function(xe){return o.locateFile(xe.url,o.ha)}),importScripts.apply(null,d(p)),x=o,E(_e,createMediapipeSolutionsWasm(Module),6);case 6:x.i=_e.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,A=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(A),_e.h=4;break;case 7:if(o.m=document.createElement("canvas"),Re=o.m.getContext("webgl2",{}),!Re&&(Re=o.m.getContext("webgl",{}),!Re))return alert("Failed to create WebGL canvas context when passing video frame."),_e.return();o.K=Re,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,_e.h=0}})}function g3(o){var c,f,p,x,A,k,I,G;return K(function(ie){if(ie.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return ie.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){ie.h=2;return}return o.fa=o.h.graph.url,E(ie,Oa(o,o.h.graph.url),3)}for(ie.h!=2&&(c=ie.i,o.j.loadGraph(c)),f=l(Object.keys(o.D)),p=f.next();!p.done;p=f.next())x=p.value,o.j.overrideFile(x,o.D[x]);if(o.D={},o.h.listeners)for(A=l(o.h.listeners),k=A.next();!k.done;k=A.next())I=k.value,x3(o,I);G=o.l,o.l={},o.setOptions(G),ie.h=0})}e.reset=function(){var o=this;return K(function(c){o.j&&(o.j.reset(),o.s={},o.v={}),c.h=0})},e.setOptions=function(o,c){var f=this;if(c=c||this.h.options){for(var p=[],x=[],A={},k=l(Object.keys(o)),I=k.next();!I.done;A={X:A.X,Y:A.Y},I=k.next())if(I=I.value,!(I in this.l&&this.l[I]===o[I])){this.l[I]=o[I];var G=c[I];G!==void 0&&(G.onChange&&(A.X=G.onChange,A.Y=o[I],p.push(function(ie){return function(){var pe;return K(function(Re){if(Re.h==1)return E(Re,ie.X(ie.Y),2);pe=Re.i,pe===!0&&(f.u=!0),Re.h=0})}}(A))),G.graphOptionXref&&(I=Object.assign({},{calculatorName:"",calculatorIndex:0},G.graphOptionXref,{valueNumber:G.type===1?o[I]:0,valueBoolean:G.type===0?o[I]:!1,valueString:G.type===2?o[I]:""}),x.push(I)))}(p.length!==0||x.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(x),this.F=(this.F===void 0?[]:this.F).concat(p))}};function y3(o){var c,f,p,x,A,k,I;return K(function(G){switch(G.h){case 1:if(!o.u)return G.return();if(!o.F){G.h=2;break}c=l(o.F),f=c.next();case 3:if(f.done){G.h=5;break}return p=f.value,E(G,p(),4);case 4:f=c.next(),G.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(x=new o.i.GraphOptionChangeRequestList,A=l(o.H),k=A.next();!k.done;k=A.next())I=k.value,x.push_back(I);o.j.changeOptions(x),x.delete(),o.H=void 0}o.u=!1,G.h=0}})}e.initialize=function(){var o=this;return K(function(c){return c.h==1?E(c,m3(o),2):c.h!=3?E(c,g3(o),3):E(c,y3(o),0)})};function Oa(o,c){var f,p;return K(function(x){return c in o.L?x.return(o.L[c]):(f=o.locateFile(c,""),p=fetch(f).then(function(A){return A.arrayBuffer()}),o.L[c]=p,x.return(p))})}e.overrideFile=function(o,c){this.j?this.j.overrideFile(o,c):this.D[o]=c},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,c){var f=this,p,x,A,k,I,G,ie,pe,Re;return K(function(_e){switch(_e.h){case 1:return f.h.inputs?(p=1e3*(c??performance.now()),E(_e,f.I,2)):_e.return();case 2:return E(_e,f.initialize(),3);case 3:for(x=new f.i.PacketDataList,A=l(Object.keys(o)),k=A.next();!k.done;k=A.next())if(I=k.value,G=f.h.inputs[I]){e:{var xe=o[I];switch(G.type){case"video":var Le=f.s[G.stream];if(Le||(Le=new cc(f.i,f.K),f.s[G.stream]=Le),Le.m===0&&(Le.m=Le.i.createTexture()),typeof HTMLVideoElement<"u"&&xe instanceof HTMLVideoElement)var We=xe.videoWidth,gt=xe.videoHeight;else typeof HTMLImageElement<"u"&&xe instanceof HTMLImageElement?(We=xe.naturalWidth,gt=xe.naturalHeight):(We=xe.width,gt=xe.height);gt={glName:Le.m,width:We,height:gt},We=Le.h,We.canvas.width=gt.width,We.canvas.height=gt.height,We.activeTexture(We.TEXTURE0),Le.i.bindTexture2d(Le.m),We.texImage2D(We.TEXTURE_2D,0,We.RGBA,We.RGBA,We.UNSIGNED_BYTE,xe),Le.i.bindTexture2d(0),Le=gt;break e;case"detections":for(Le=f.s[G.stream],Le||(Le=new c3(f.i),f.s[G.stream]=Le),Le.data||(Le.data=new Le.h.DetectionListData),Le.data.reset(xe.length),gt=0;gt<xe.length;++gt){We=xe[gt];var dt=Le.data,en=dt.setBoundingBox,Jn=gt,Cn=We.la,nt=new Fa;if(Rr(nt,1,Cn.ra),Rr(nt,2,Cn.sa),Rr(nt,3,Cn.height),Rr(nt,4,Cn.width),Rr(nt,5,Cn.rotation),Ir(nt,6,Cn.pa),Cn=nt.l(),en.call(dt,Jn,Cn),We.ea)for(dt=0;dt<We.ea.length;++dt){nt=We.ea[dt],en=Le.data,Jn=en.addNormalizedLandmark,Cn=gt,nt=Object.assign({},nt,{visibility:nt.visibility?nt.visibility:0});var tn=new pi;Rr(tn,1,nt.x),Rr(tn,2,nt.y),Rr(tn,3,nt.z),nt.visibility&&Rr(tn,4,nt.visibility),nt=tn.l(),Jn.call(en,Cn,nt)}if(We.ba)for(dt=0;dt<We.ba.length;++dt)en=Le.data,Jn=en.addClassification,Cn=gt,nt=We.ba[dt],tn=new hi,Rr(tn,2,nt.score),nt.index&&Ir(tn,1,nt.index),nt.label&&Ir(tn,3,nt.label),nt.displayName&&Ir(tn,4,nt.displayName),nt=tn.l(),Jn.call(en,Cn,nt)}Le=Le.data;break e;default:Le={}}}switch(ie=Le,pe=G.stream,G.type){case"video":x.pushTexture2d(Object.assign({},ie,{stream:pe,timestamp:p}));break;case"detections":Re=ie,Re.stream=pe,Re.timestamp=p,x.pushDetectionList(Re);break;default:throw Error("Unknown input config type: '"+G.type+"'")}}return f.j.send(x),E(_e,f.I,4);case 4:x.delete(),_e.h=0}})};function v3(o,c,f){var p,x,A,k,I,G,ie,pe,Re,_e,xe,Le,We,gt;return K(function(dt){switch(dt.h){case 1:if(!f)return dt.return(c);for(p={},x=0,A=l(Object.keys(f)),k=A.next();!k.done;k=A.next())I=k.value,G=f[I],typeof G!="string"&&G.type==="texture"&&c[G.stream]!==void 0&&++x;1<x&&(o.M=!1),ie=l(Object.keys(f)),k=ie.next();case 2:if(k.done){dt.h=4;break}if(pe=k.value,Re=f[pe],typeof Re=="string")return We=p,gt=pe,E(dt,w3(o,pe,c[Re]),14);if(_e=c[Re.stream],Re.type==="detection_list"){if(_e){for(var en=_e.getRectList(),Jn=_e.getLandmarksList(),Cn=_e.getClassificationsList(),nt=[],tn=0;tn<en.size();++tn){var ps=l3(en.get(tn)),S3=Lr(ps,1),k3=Lr(ps,2),A3=Lr(ps,3),E3=Lr(ps,4),C3=Lr(ps,5,0),$a=void 0;$a=$a===void 0?0:$a,ps={la:{ra:S3,sa:k3,height:A3,width:E3,rotation:C3,pa:Ia(vr(ps,6),$a)},ea:Pa(Vp(Jn.get(tn)),pi,1).map(Qp),ba:Kp(Hp(Cn.get(tn)))},nt.push(ps)}en=nt}else en=[];p[pe]=en,dt.h=7;break}if(Re.type==="proto_list"){if(_e){for(en=Array(_e.size()),Jn=0;Jn<_e.size();Jn++)en[Jn]=_e.get(Jn);_e.delete()}else en=[];p[pe]=en,dt.h=7;break}if(_e===void 0){dt.h=3;break}if(Re.type==="float_list"){p[pe]=_e,dt.h=7;break}if(Re.type==="proto"){p[pe]=_e,dt.h=7;break}if(Re.type!=="texture")throw Error("Unknown output config type: '"+Re.type+"'");return xe=o.v[pe],xe||(xe=new cc(o.i,o.K),o.v[pe]=xe),E(dt,qp(xe,_e,o.M),13);case 13:Le=dt.i,p[pe]=Le;case 7:Re.transform&&p[pe]&&(p[pe]=Re.transform(p[pe])),dt.h=3;break;case 14:We[gt]=dt.i;case 3:k=ie.next(),dt.h=2;break;case 4:return dt.return(p)}})}function w3(o,c,f){var p;return K(function(x){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?x.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[c],p||(p=new cc(o.i,o.K),o.v[c]=p),x.return(qp(p,f,o.M))):x.return(void 0)})}function x3(o,c){for(var f=c.name||"$",p=[].concat(d(c.wants)),x=new o.i.StringList,A=l(c.wants),k=A.next();!k.done;k=A.next())x.push_back(k.value);A=o.i.PacketListener.implement({onResults:function(I){for(var G={},ie=0;ie<c.wants.length;++ie)G[p[ie]]=I.get(ie);var pe=o.listeners[f];pe&&(o.I=v3(o,G,c.outs).then(function(Re){Re=pe(Re);for(var _e=0;_e<c.wants.length;++_e){var xe=G[p[_e]];typeof xe=="object"&&xe.hasOwnProperty&&xe.hasOwnProperty("delete")&&xe.delete()}Re&&(o.I=Re)}))}}),o.j.attachMultiListener(x,A),x.delete()}e.onResults=function(o,c){this.listeners[c||"$"]=o},Se("Solution",dc),Se("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function em(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function tm(o){var c=this;o=o||{},this.h=new dc({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:em(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:Jp},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:Jp},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return Kp(Hp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,x,A;return K(function(k){return k.h==1?(p=em(f),x="third_party/mediapipe/modules/hand_landmark/"+p,E(k,Oa(c.h,p),2)):(A=k.i,c.h.overrideFile(x,A),k.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=tm.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return K(function(c){return E(c,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var c=this;return K(function(f){return E(f,c.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},Se("Hands",tm),Se("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),Se("VERSION","0.4.1675469240")}).call(fc);const Ln=(...e)=>{},Fr={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},Pt={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function g1({hidden:e=!1}){const t=M.useRef(null),n=M.useRef(null),r=M.useRef(null),s=M.useRef(null),[i,a]=M.useState(!1),[l,d]=M.useState("None"),[h,m]=M.useState([]),[w,S]=M.useState(null),[j,L]=M.useState(null),[F,X]=M.useState(null),[C,g]=M.useState({a:null,b:null}),y=M.useRef(null),E=M.useRef(null),_=($,v)=>{const R=localStorage.getItem($);if(R===null)return v;const N=parseFloat(R);return Number.isFinite(N)?N:v},[T,D]=M.useState(()=>({roiSize:(()=>{const $=_(Pt.roiSize,44);return $>10?$:44})(),hueWeight:_(Pt.hueWeight,4),satWeight:_(Pt.satWeight,2),valWeight:_(Pt.valWeight,1),sensitivity:_(Pt.sensitivity,0)})),H=M.useRef(T),se=M.useRef(null),V=M.useRef(!1),K=M.useRef(0),re=M.useRef(null),[q,te]=M.useState([]),Se=M.useRef([]),[ve,ye]=M.useState(()=>localStorage.getItem(Pt.selectedCamera)||""),ee=M.useCallback(async()=>{try{const v=(await navigator.mediaDevices.enumerateDevices()).filter(R=>R.kind==="videoinput");return te(v),Se.current=v,v}catch{return[]}},[]),oe=M.useCallback($=>{},[Ln]),ne=M.useCallback(async($=null)=>{const v=t.current;if(!v)return;se.current&&(se.current.getTracks().forEach(b=>b.stop()),se.current=null),P();const R=++K.current;re.current=null;const N=$!==null?$:ve;try{const b=N?{video:{deviceId:{exact:N}}}:{video:!0};if(N){const W=Se.current.find(fe=>fe.deviceId===N);console.log("[Detector]  Loading SELECTED camera:",{deviceId:N,label:(W==null?void 0:W.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const B=await navigator.mediaDevices.getUserMedia(b);if(!V.current||R!==K.current){Ln("Stale camera request (unmounted or superseded). Stopping stream."),B.getTracks().forEach(W=>W.stop());return}se.current=B;const z=B.getVideoTracks();if(Ln("getUserMedia success. Tracks:",z),z.length>0){const W=z[0];console.log("[Detector]  Camera loaded successfully:",{label:W.label,deviceId:W.getSettings().deviceId,resolution:`${W.getSettings().width}x${W.getSettings().height}`,frameRate:W.getSettings().frameRate})}if(v.srcObject=B,await new Promise(W=>{if(v.readyState>=1&&v.videoWidth>0&&v.videoHeight>0)return W();const me=()=>{v.removeEventListener("loadedmetadata",me),W()};v.addEventListener("loadedmetadata",me,{once:!0}),setTimeout(()=>{v.removeEventListener("loadedmetadata",me),W()},1500)}),!V.current||R!==K.current){Ln("Stale request before play(). Stopping stream."),B.getTracks().forEach(W=>W.stop());return}try{await v.play(),Ln("video.play() promise resolved. Video should be playing.")}catch(W){if(console.error("[Detector] video.play() promise rejected:",W),Ln("video.play() promise rejected:",W.name,W.message),R!==K.current){Ln("play() aborted due to newer request."),B.getTracks().forEach(fe=>fe.stop());return}}if(re.current!==R&&(re.current=R,Ln("Initializing MediaPipe for request id",R),Be()),V.current){const W=await ee();if(!N||!$){const fe=W.find(me=>me.deviceId);fe&&fe.deviceId&&fe.deviceId!==ve&&(ye(fe.deviceId),localStorage.setItem(Pt.selectedCamera,fe.deviceId))}}}catch(b){console.error("[Detector] Error accessing camera:",b),Ln("getUserMedia error:",b.name,b.message)}},[Ln,ee,oe,ve]),we=($,v,R)=>{const N=($||0)*2,b=(v||0)/255,B=(R||0)/255,z=B*b,W=z*(1-Math.abs(N/60%2-1)),fe=B-z;let me=0,Pe=0,Me=0;N>=0&&N<60?(me=z,Pe=W,Me=0):N<120?(me=W,Pe=z,Me=0):N<180?(me=0,Pe=z,Me=W):N<240?(me=0,Pe=W,Me=z):N<300?(me=W,Pe=0,Me=z):(me=z,Pe=0,Me=W);const Ge=Math.round((me+fe)*255),tt=Math.round((Pe+fe)*255),st=Math.round((Me+fe)*255);return`rgb(${Ge}, ${tt}, ${st})`},be=$=>$?we($.h,$.s,$.v):"#ffffff",Ie=$=>$==="Player A"&&j?be(j):$==="Player B"&&F?be(F):$==="Red"?"#ff0000":$==="Blue"?"#0000ff":"#ffffff";M.useEffect(()=>{V.current=!0;const $=()=>{try{const N=JSON.parse(localStorage.getItem("calibrationA")||"null"),b=JSON.parse(localStorage.getItem("calibrationB")||"null");N&&L({h:N.h,s:N.s,v:N.v}),b&&X({h:b.h,s:b.s,v:b.v})}catch{}},v=N=>{!N||!N.key||(["calibrationA","calibrationB"].includes(N.key)&&$(),[Pt.roiSize,Pt.hueWeight,Pt.satWeight,Pt.valWeight,Pt.sensitivity].includes(N.key)&&D(b=>({roiSize:(()=>{const B=_(Pt.roiSize,(b==null?void 0:b.roiSize)??44);return B>10?B:(b==null?void 0:b.roiSize)??44})(),hueWeight:_(Pt.hueWeight,(b==null?void 0:b.hueWeight)??4),satWeight:_(Pt.satWeight,(b==null?void 0:b.satWeight)??2),valWeight:_(Pt.valWeight,(b==null?void 0:b.valWeight)??1),sensitivity:_(Pt.sensitivity,(b==null?void 0:b.sensitivity)??0)})))};return(async()=>{const N=await ee();if(!V.current)return;const b=localStorage.getItem(Pt.selectedCamera);let B="";if(b&&N.some(z=>z.deviceId&&z.deviceId===b)){const z=N.find(W=>W.deviceId===b);B=b,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:b,label:(z==null?void 0:z.label)||"Unknown"})}else{b&&localStorage.removeItem(Pt.selectedCamera);const z=N.find(W=>W.deviceId);z&&z.deviceId?(B=z.deviceId,localStorage.setItem(Pt.selectedCamera,z.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:z.deviceId,label:z.label||"Unknown",savedCameraWas:b||"none"}),Ln("Saved camera not found, using default camera:",z.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}ye(B?z=>z===B?z:B:z=>z||""),$()})(),window.addEventListener("storage",v),()=>{V.current=!1,K.current+=1,re.current=null,s.current&&(s.current.stop(),s.current=null),se.current&&(se.current.getTracks().forEach(b=>b.stop()),se.current=null);const N=t.current;N&&(N.srcObject=null,oe(N)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",v)}},[]),M.useEffect(()=>{y.current=j},[j]),M.useEffect(()=>{E.current=F},[F]),M.useEffect(()=>{H.current=T},[T]),M.useEffect(()=>{ne(ve||null)},[ve,ne]),M.useEffect(()=>{const $=setInterval(()=>{d(v=>(Fe(v),v))},1e3);return()=>clearInterval($)},[]);const Fe=$=>{const R={timestamp:new Date().toISOString(),status:$};m(b=>[...b,R]);const N=JSON.parse(localStorage.getItem("braceletDetections")||"[]");N.push(R),localStorage.setItem("braceletDetections",JSON.stringify(N))},Be=async()=>{try{const $=await(async()=>{try{if(typeof Ql.Hands=="function")return Ql.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((R,N)=>{const b="mp-hands-cdn-script";if(document.getElementById(b))return R();const B=document.createElement("script");B.id=b,B.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",B.async=!0,B.onload=()=>R(),B.onerror=z=>N(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(B)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),v=new $({locateFile:R=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${R}`});if(v.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),v.onResults($e),r.current=v,t.current){const R=t.current;console.log("[Detector]  Starting manual frame capture from video element");let N;const b=async()=>{if(R.readyState>=2&&R.videoWidth>0)try{await v.send({image:R})}catch(B){console.error("[Detector] Error sending frame to MediaPipe:",B)}N=requestAnimationFrame(b)};b(),s.current={stop:()=>{N&&(cancelAnimationFrame(N),console.log("[Detector]  Stopped frame capture"))}}}}catch($){console.error("MediaPipe initialization error:",$),S(`MediaPipe error: ${$.message}`)}},$e=$=>{var z;const v=n.current,R=t.current;if(!v||!R)return;const N=v.getContext("2d");v.width=R.videoWidth,v.height=R.videoHeight,N.drawImage(R,0,0,v.width,v.height);let b="None";if($.multiHandLandmarks&&$.multiHandLandmarks.length>0){Ln("onResults: hands=",$.multiHandLandmarks.length);let W=null,fe=0;if($.multiHandLandmarks.forEach(me=>{const Pe=me[0];Pe.y>fe&&(fe=Pe.y,W=me)}),$.multiHandLandmarks.forEach(me=>{Y(N,me,v.width,v.height)}),W){const me=W[0],Pe=me.x*v.width,Me=me.y*v.height;N.fillStyle="lime",N.beginPath(),N.arc(Pe,Me,10,0,2*Math.PI),N.fill(),N.fillStyle="lime",N.font="16px Arial",N.fillText("SELECTED",Pe-40,Me-15);const tt=Math.max(10,Math.min(300,Math.floor(((z=H.current)==null?void 0:z.roiSize)||60)))/2,st=Math.max(0,Pe-tt),lt=Math.max(0,Me-tt),ut=Math.min(v.width,Pe+tt),Ve=Math.min(v.height,Me+tt);N.strokeStyle="lime",N.lineWidth=3,N.strokeRect(st,lt,ut-st,Ve-lt);const ze=ut-st,He=Ve-lt;if(ze>0&&He>0)try{const qe=N.getImageData(st,lt,ze,He),bt=y.current,on=E.current,mt=ge(qe,bt,on);b=mt.status,g({a:mt.percentA,b:mt.percentB}),Ln("Detection result:",b,{roi:{x1:st,y1:lt,w:ze,h:He}})}catch(qe){console.warn("[Detector] Failed to get ROI image data:",qe.message),b="None",g({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:ze,height:He}),b="None",g({a:null,b:null})}}let B="#ffffff";b==="Player A"&&y.current?B=be(y.current):b==="Player B"&&E.current&&(B=be(E.current)),N.fillStyle=B,N.font="bold 32px Arial",N.fillText(`Status: ${b}`,10,40),d(b),typeof window<"u"&&(window.currentBraceletStatus=b,window.braceletDetectorCanvas=v,window.braceletDetectorVideo=R)},Y=($,v,R,N)=>{$.strokeStyle="white",$.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([B,z])=>{const W=v[B],fe=v[z];$.beginPath(),$.moveTo(W.x*R,W.y*N),$.lineTo(fe.x*R,fe.y*N),$.stroke()}),v.forEach(B=>{$.fillStyle="red",$.beginPath(),$.arc(B.x*R,B.y*N,5,0,2*Math.PI),$.fill()})},Q=$=>{const v=$.data;let R=0,N=0;for(let b=0;b<v.length;b+=4){const B=v[b],z=v[b+1],W=v[b+2],fe=le(B,z,W);(fe[0]>=Fr.red.lower1[0]&&fe[0]<=Fr.red.upper1[0]||fe[0]>=Fr.red.lower2[0]&&fe[0]<=Fr.red.upper2[0])&&fe[1]>=Fr.red.lower1[1]&&fe[2]>=Fr.red.lower1[2]&&R++,fe[0]>=Fr.blue.lower[0]&&fe[0]<=Fr.blue.upper[0]&&fe[1]>=Fr.blue.lower[1]&&fe[2]>=Fr.blue.lower[2]&&N++}return{redCount:R,blueCount:N}},ge=($,v,R)=>{var tt,st,lt,ut;const N=$.data;if(v&&!R)return{status:"Player A",percentA:null,percentB:null};if(R&&!v)return{status:"Player B",percentA:null,percentB:null};const b=((tt=H.current)==null?void 0:tt.hueWeight)??4,B=((st=H.current)==null?void 0:st.satWeight)??2,z=((lt=H.current)==null?void 0:lt.valWeight)??1,W=((ut=H.current)==null?void 0:ut.sensitivity)??0;if(v&&R){let Ve=0,ze=0,He=0;for(let mt=0;mt<N.length;mt+=4){const Ut=N[mt],Mt=N[mt+1],Tt=N[mt+2],[hn,pn,Rn]=le(Ut,Mt,Tt),mn=Math.min(1,Math.max(0,pn/255)),Pr=Math.min(1,Math.max(0,Rn/255)),pr=Math.max(.05,.5*mn+.5*Pr),mr=Math.min(Math.abs(hn-v.h),180-Math.abs(hn-v.h)),gr=Math.min(Math.abs(hn-R.h),180-Math.abs(hn-R.h)),O=Math.abs(pn-v.s),ue=Math.abs(pn-R.s),de=Math.abs(Rn-v.v),Z=Math.abs(Rn-R.v),he=mr*b+O*B+de*z,Ue=gr*b+ue*B+Z*z;Math.min(he,Ue)>180||(he<=Ue?Ve+=pr:ze+=pr,He+=pr)}if(He===0)return{status:"None",percentA:0,percentB:0};const qe=Ve/Math.max(1e-6,He),bt=ze/Math.max(1e-6,He),on=.12*(1+.8*Math.max(0,Math.min(1,W)));return qe>=on&&qe>=bt?{status:"Player A",percentA:qe,percentB:bt}:bt>=on&&bt>qe?{status:"Player B",percentA:qe,percentB:bt}:{status:"None",percentA:qe,percentB:bt}}const{redCount:fe,blueCount:me}=Q($),Pe=fe+me;if(Pe===0)return{status:"None",percentA:0,percentB:0};const Me=fe/Pe,Ge=me/Pe;return Me>=.15&&Me>=Ge?{status:"Player A",percentA:Me,percentB:Ge}:Ge>=.15&&Ge>Me?{status:"Player B",percentA:Me,percentB:Ge}:{status:"None",percentA:Me,percentB:Ge}},le=($,v,R)=>{$/=255,v/=255,R/=255;const N=Math.max($,v,R),b=Math.min($,v,R),B=N-b;let z=0;B!==0&&(N===$?z=60*((v-R)/B%6):N===v?z=60*((R-$)/B+2):z=60*(($-v)/B+4)),z<0&&(z+=360);const W=N===0?0:B/N*255,fe=N*255;return[z/2,W,fe]},P=$=>{},U=$=>{ye($),$?localStorage.setItem(Pt.selectedCamera,$):localStorage.removeItem(Pt.selectedCamera)},J=()=>{const $=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),v=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),R=URL.createObjectURL(v),N=document.createElement("a");N.href=R,N.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,N.click();const b=$.map(fe=>`${fe.timestamp}: ${fe.status}`).join(`
`),B=new Blob([b],{type:"text/plain"}),z=URL.createObjectURL(B),W=document.createElement("a");W.href=z,W.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,W.click()},ce=()=>{localStorage.removeItem("braceletDetections"),m([])};return u.jsx(u.Fragment,{children:u.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[u.jsxs("div",{className:"detector-header",children:[u.jsx("span",{children:"Bracelet Detector"}),u.jsxs("div",{className:"detector-controls",children:[u.jsx("button",{onClick:J,title:"Download Logs",children:""}),u.jsx("button",{onClick:ce,title:"Clear Logs",children:""}),u.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),u.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[u.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{children:"Camera:"}),u.jsxs("select",{value:ve,onChange:$=>U($.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[u.jsx("option",{value:"",children:"System Default"}),q.map(($,v)=>{var W;const R=!!$.deviceId,N=R?$.deviceId:"",b=R?$.deviceId:`camera-${v}`,B=((W=$.label)==null?void 0:W.trim())||`Camera ${v+1}`,z=R?`  ${$.deviceId.slice(0,8)}`:" (needs permission)";return u.jsxs("option",{value:N,disabled:!R,children:[B,z]},b)})]})]}),u.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),u.jsx("canvas",{ref:n,className:"output_canvas"}),u.jsxs("div",{className:"detector-info",children:[u.jsxs("div",{className:"status-display",children:["Status: ",u.jsx("span",{style:{color:Ie(l),fontWeight:700},children:l})]}),u.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),u.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:j?be(j):"#444"}}),u.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:C.a==null?"":`${Math.round(Math.max(0,Math.min(1,C.a))*100)}%`})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),u.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:F?be(F):"#444"}}),u.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:C.b==null?"":`${Math.round(Math.max(0,Math.min(1,C.b))*100)}%`})]})]}),u.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),u.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[u.jsxs("div",{children:["A: ",j?`h${Math.round(j.h)} s${Math.round(j.s)} v${Math.round(j.v)}`:""]}),u.jsxs("div",{children:["B: ",F?`h${Math.round(F.h)} s${Math.round(F.s)} v${Math.round(F.v)}`:""]})]})]})]})]})})}const Uc=(...e)=>{console.log("[Calibrate]",...e)},Or={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},dx=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,l=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,m=0,w=0;r>=0&&r<60?(h=a,m=l,w=0):r<120?(h=l,m=a,w=0):r<180?(h=0,m=a,w=l):r<240?(h=0,m=l,w=a):r<300?(h=l,m=0,w=a):(h=a,m=0,w=l);const S=Math.round((h+d)*255),j=Math.round((m+d)*255),L=Math.round((w+d)*255);return`rgb(${S}, ${j}, ${L})`},y1=e=>e?dx(e.h,e.s,e.v):"#444";function fx(){const e=M.useRef(null),t=M.useRef(null),n=M.useRef(null),r=M.useRef(!1),s=M.useRef(0),[i,a]=M.useState(!1),[l,d]=M.useState(""),[h,m]=M.useState(null),[w,S]=M.useState(null),j=(Y,Q)=>{const ge=localStorage.getItem(Y);if(ge===null)return Q;const le=parseFloat(ge);return Number.isFinite(le)?le:Q},[L,F]=M.useState(()=>{const Y=j(Or.roiSize,44);return Y>10?Y:44}),[X,C]=M.useState(()=>j(Or.hueWeight,4)),[g,y]=M.useState(()=>j(Or.satWeight,2)),[E,_]=M.useState(()=>j(Or.valWeight,1)),[T,D]=M.useState(()=>j(Or.sensitivity,0)),[H,se]=M.useState(!1),[V,K]=M.useState("idle"),[re,q]=M.useState(5),te=M.useRef({A:[],B:[]});M.useEffect(()=>{r.current=!0;try{const Y=JSON.parse(localStorage.getItem("calibrationA")||"null"),Q=JSON.parse(localStorage.getItem("calibrationB")||"null");Y&&m(Y),Q&&S(Q)}catch{}return(async()=>await Se())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(Q=>Q.stop()),n.current=null);const Y=e.current;Y&&(Y.srcObject=null)}},[]),M.useEffect(()=>{localStorage.setItem(Or.roiSize,String(L))},[L]),M.useEffect(()=>{localStorage.setItem(Or.hueWeight,String(X))},[X]),M.useEffect(()=>{localStorage.setItem(Or.satWeight,String(g))},[g]),M.useEffect(()=>{localStorage.setItem(Or.valWeight,String(E))},[E]),M.useEffect(()=>{localStorage.setItem(Or.sensitivity,String(T))},[T]);const Se=M.useCallback(async()=>{const Y=e.current;if(!Y)return;n.current&&(n.current.getTracks().forEach(ge=>ge.stop()),n.current=null);const Q=++s.current;a(!1),d("Requesting camera...");try{const ge=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||Q!==s.current){ge.getTracks().forEach(le=>le.stop());return}if(n.current=ge,Y.srcObject=ge,await new Promise(le=>{if(Y.readyState>=1&&Y.videoWidth>0)return le();const U=()=>{Y.removeEventListener("loadedmetadata",U),le()};Y.addEventListener("loadedmetadata",U,{once:!0}),setTimeout(()=>{Y.removeEventListener("loadedmetadata",U),le()},1500)}),!r.current||Q!==s.current){ge.getTracks().forEach(le=>le.stop());return}try{await Y.play(),Uc("video.play resolved")}catch(le){Uc("video.play rejected",le)}a(!0),d("")}catch(ge){d(`Camera error: ${(ge==null?void 0:ge.message)||ge}`),Uc("getUserMedia error",ge)}},[]),ve=(Y,Q,ge)=>{Y/=255,Q/=255,ge/=255;const le=Math.max(Y,Q,ge),P=Math.min(Y,Q,ge),U=le-P;let J=0;U!==0&&(le===Y?J=60*((Q-ge)/U%6):le===Q?J=60*((ge-Y)/U+2):J=60*((Y-Q)/U+4)),J<0&&(J+=360);const ce=le===0?0:U/le*255,$=le*255;return[J/2,ce,$]},ye=()=>{const Y=e.current,Q=t.current;if(!Y||!Q||Y.videoWidth===0)return null;const ge=Y.videoWidth,le=Y.videoHeight;Q.width=ge,Q.height=le;const P=Q.getContext("2d");P.drawImage(Y,0,0,ge,le);const U=Math.max(10,Math.min(300,Math.floor(L))),J=Math.floor(ge/2-U/2),ce=Math.floor(le/2-U/2),v=P.getImageData(J,ce,U,U).data;let R=0,N=0,b=0,B=0,z=0;for(let st=0;st<v.length;st+=4){const[lt,ut,Ve]=ve(v[st],v[st+1],v[st+2]),ze=lt*2*(Math.PI/180);R+=Math.cos(ze),N+=Math.sin(ze),b+=ut,B+=Ve,z++}if(z===0)return null;const W=b/z,fe=B/z,me=R/z,Pe=N/z;let Ge=Math.atan2(Pe,me)*(180/Math.PI);return Ge<0&&(Ge+=360),{h:Ge/2,s:W,v:fe}},ee=Y=>{const Q=ye();if(!Q){d("Could not sample video frame.");return}Y==="A"?(localStorage.setItem("calibrationA",JSON.stringify(Q)),m(Q),d(`Saved Player A: h${Q.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(Q)),S(Q),d(`Saved Player B: h${Q.h.toFixed(0)}`))},oe=Y=>{Y==="A"?(localStorage.removeItem("calibrationA"),m(null)):(localStorage.removeItem("calibrationB"),S(null)),d("Cleared")},ne=()=>{se(!0),K("playerA"),q(5),te.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};M.useEffect(()=>{if(!(!H||V==="idle"||V==="optimizing"||V==="complete"))if(re>0){const Y=setTimeout(()=>{q(re-1)},1e3);return()=>clearTimeout(Y)}else V==="playerA"?(K("switching"),q(3),d("Switch to Player B... Get ready!")):V==="switching"?(K("playerB"),q(5),d("Hold Player B bracelet in center square...")):V==="playerB"&&(K("optimizing"),we())},[H,V,re]),M.useEffect(()=>{if(!H||V==="idle"||V==="switching"||V==="optimizing"||V==="complete")return;const Y=setInterval(()=>{const Q=ye();Q&&(V==="playerA"?te.current.A.push(Q):V==="playerB"&&te.current.B.push(Q))},200);return()=>clearInterval(Y)},[H,V]);const we=()=>{d("Optimizing parameters...");const Y=te.current.A,Q=te.current.B;if(Y.length===0||Q.length===0){d("Error: Not enough samples collected!"),se(!1),K("idle");return}const ge=be(Y),le=be(Q),P=Math.min(Math.abs(ge.h-le.h),180-Math.abs(ge.h-le.h)),U=Math.abs(ge.s-le.s),J=Math.abs(ge.v-le.v),ce=P/90,$=U/255,v=J/255,R=Ie(Y),N=Ie(Q),b={h:(R.h+N.h)/2,s:(R.s+N.s)/2,v:(R.v+N.v)/2},B=ce+$+v,z=B>0?ce/B*(1/(1+b.h/20))*6:2,W=B>0?$/B*(1/(1+b.s/50))*4:1,fe=B>0?v/B*(1/(1+b.v/50))*3:.5;C(Math.max(.5,Math.min(6,z))),y(Math.max(.1,Math.min(4,W))),_(Math.max(.1,Math.min(3,fe)));const me=Fe(Y,Q,ge,le),Pe=Math.max(0,Math.min(.8,me*.5));D(Pe),localStorage.setItem("calibrationA",JSON.stringify(ge)),localStorage.setItem("calibrationB",JSON.stringify(le)),m(ge),S(le),K("complete"),d(` Auto-calibration complete! Collected ${Y.length+Q.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{se(!1),K("idle")},3e3)},be=Y=>{const Q=Y.map(N=>N.h),ge=Y.map(N=>N.s).sort((N,b)=>N-b),le=Y.map(N=>N.v).sort((N,b)=>N-b);let P=0,U=0;Q.forEach(N=>{const b=N*2*(Math.PI/180);P+=Math.cos(b),U+=Math.sin(b)});let ce=Math.atan2(U/Q.length,P/Q.length)*(180/Math.PI);ce<0&&(ce+=360);const $=ce/2,v=ge[Math.floor(ge.length/2)],R=le[Math.floor(le.length/2)];return{h:$,s:v,v:R}},Ie=Y=>{const Q=Y.reduce((le,P)=>({h:le.h+P.h,s:le.s+P.s,v:le.v+P.v}),{h:0,s:0,v:0});Q.h/=Y.length,Q.s/=Y.length,Q.v/=Y.length;const ge=Y.reduce((le,P)=>({h:le.h+Math.pow(P.h-Q.h,2),s:le.s+Math.pow(P.s-Q.s,2),v:le.v+Math.pow(P.v-Q.v,2)}),{h:0,s:0,v:0});return{h:ge.h/Y.length,s:ge.s/Y.length,v:ge.v/Y.length}},Fe=(Y,Q,ge,le)=>{let P=0;const U=Math.min(Y.length,Q.length)*2;return Y.forEach(J=>{const ce=Be(J,ge);Be(J,le)<ce*1.5&&P++}),Q.forEach(J=>{const ce=Be(J,ge),$=Be(J,le);ce<$*1.5&&P++}),P/U},Be=(Y,Q)=>{const ge=Math.min(Math.abs(Y.h-Q.h),180-Math.abs(Y.h-Q.h)),le=Math.abs(Y.s-Q.s),P=Math.abs(Y.v-Q.v);return Math.sqrt(ge*ge+le*le+P*P)},$e=()=>{se(!1),K("idle"),q(5),d("Generic mode cancelled")};return u.jsxs("div",{className:"calib-root",children:[u.jsxs("div",{className:"calib-header",children:[u.jsx("h2",{children:"Color Calibration"}),u.jsxs("div",{className:"calib-actions",children:[u.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),u.jsx("button",{onClick:Se,children:"Restart Camera"})]})]}),l&&u.jsx("div",{className:"calib-message",children:l}),u.jsxs("div",{className:"calib-content",children:[u.jsx("div",{children:u.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[u.jsx("div",{className:"label",children:"Live Preview"}),u.jsx("div",{className:"value",style:{marginBottom:8},children:H?`Generic Mode Active: ${V==="playerA"?"Player A":V==="switching"?"Switching...":V==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),u.jsxs("div",{className:"calib-video-wrap",children:[u.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),u.jsx("div",{className:"calib-center-box",style:{width:L,height:L,borderColor:"#22d3ee",borderWidth:H?"4px":"3px",boxShadow:H?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),H&&re>0&&u.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:re})]})]})}),u.jsxs("div",{className:"calib-controls",children:[u.jsxs("div",{className:"calib-block",style:{background:H?"#1a2332":"#0f172a",border:H?"2px solid #22d3ee":"1px solid #1f2937"},children:[u.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),u.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),H?u.jsxs("div",{style:{marginTop:8},children:[u.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[V==="playerA"&&`Player A: Hold bracelet steady... ${re}s`,V==="switching"&&`Switch hands! Get Player B ready... ${re}s`,V==="playerB"&&`Player B: Hold bracelet steady... ${re}s`,V==="optimizing"&&"Optimizing parameters...",V==="complete"&&" Complete!"]}),u.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[V==="playerA"&&`Samples collected: ${te.current.A.length}`,V==="switching"&&`Player A: ${te.current.A.length} samples collected`,V==="playerB"&&`Samples collected: ${te.current.B.length}`]}),V!=="complete"&&u.jsx("button",{onClick:$e,style:{background:"#ef4444"},children:"Cancel"})]}):u.jsx("div",{className:"buttons",children:u.jsx("button",{onClick:ne,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),u.jsxs("div",{className:"calib-block",children:[u.jsx("div",{className:"label",children:"Detector Settings"}),u.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Detection square size"}),u.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:L,onChange:Y=>F(Number(Y.target.value))}),u.jsxs("span",{style:{textAlign:"right"},children:[L,"px"]})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Hue weight"}),u.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:X,onChange:Y=>C(Number(Y.target.value))}),u.jsx("span",{style:{textAlign:"right"},children:X.toFixed(1)})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Saturation weight"}),u.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:g,onChange:Y=>y(Number(Y.target.value))}),u.jsx("span",{style:{textAlign:"right"},children:g.toFixed(1)})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Value weight"}),u.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:E,onChange:Y=>_(Number(Y.target.value))}),u.jsx("span",{style:{textAlign:"right"},children:E.toFixed(1)})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),u.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:T,onChange:Y=>D(Number(Y.target.value))}),u.jsxs("span",{style:{textAlign:"right"},children:[(T*100).toFixed(0),"%"]})]}),u.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),u.jsxs("div",{className:"calib-block",children:[u.jsx("div",{className:"label",children:"Player A"}),u.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:y1(h)}}),u.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),u.jsxs("div",{className:"buttons",children:[u.jsx("button",{onClick:()=>ee("A"),disabled:!i,children:"Save A"}),u.jsx("button",{onClick:()=>oe("A"),children:"Clear A"})]})]}),u.jsxs("div",{className:"calib-block",children:[u.jsx("div",{className:"label",children:"Player B"}),u.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:y1(w)}}),u.jsx("span",{children:w?`h${w.h.toFixed(0)} s${w.s.toFixed(0)} v${w.v.toFixed(0)}`:""})]}),u.jsxs("div",{className:"buttons",children:[u.jsx("button",{onClick:()=>ee("B"),disabled:!i,children:"Save B"}),u.jsx("button",{onClick:()=>oe("B"),children:"Clear B"})]})]})]})]}),u.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function Q2({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var $;const[a,l]=M.useState(e),[d,h]=M.useState(0),[m,w]=M.useState(!1),[S,j]=M.useState(1),[L,F]=M.useState(Jo()),[X,C]=M.useState(!0),[g,y]=M.useState([]),[E,_]=M.useState(null),[T,D]=M.useState(!1),H=M.useRef(null),se=M.useRef(null),V=M.useRef(null),K=n&&!e,re=["summary-container",r].filter(Boolean).join(" "),q=(v,R)=>{const N=V.current;if(!N)return 0;const b=N.offsetHeight;return(v+.5)*b},te=M.useCallback((v,R=null)=>{const N=R||a;if(!N)return;let b=Jo(),B=!0;const z=[];let W=null;for(let fe=0;fe<=v&&fe<N.moves.length;fe++){const me=N.moves[fe];me.phase==="experiment"&&B&&(B=!1,b=Jo());const Pe=me.all_positions||(me.allPositions?me.allPositions.map(Me=>[Me[0]*.07,Me[1]*.07]):null);if(me.type==="moveblock"&&Pe)Pe.length===10&&b.length===10?b=b.map((Me,Ge)=>{const tt=Pe[Ge];return tt&&Array.isArray(tt)&&tt.length===2?{...Me,position:[tt[0],tt[1]]}:Me}):console.warn(`Position count mismatch: blocks=${b.length}, positions=${Pe==null?void 0:Pe.length}`),b=Zd(qd(b),B),W=me.blockId!==void 0?me.blockId:me.unit;else if(me.type==="added shape to gallery"&&me.gallery_normalized){const Me=document.createElement("canvas");Me.width=400,Me.height=400;const Ge=Me.getContext("2d");Ge.fillStyle="#000",Ge.fillRect(0,0,400,400),me.gallery_normalized.forEach(tt=>{const st=(tt[0]+.5)*400,lt=(tt[1]+.5)*400;Ge.fillStyle="green";const ut=60;Ge.fillRect(st-ut/2,lt-ut/2,ut,ut)}),z.push({number:me.gallery_shape_number,image:Me.toDataURL()}),W=null}}F(b),C(B),y(z),_(W)},[a]),Se=v=>{l(v),h(0),w(!1),setTimeout(()=>{te(0,v)},0)},ve=v=>{if(!K)return;const R=v.target.files[0];if(!R)return;const N=new FileReader;N.onload=b=>{try{const B=JSON.parse(b.target.result);Se(B)}catch(B){alert("Failed to parse JSON file: "+B.message)}},N.readAsText(R)};M.useEffect(()=>{e&&Se(e)},[e]),M.useEffect(()=>{a&&d>=0&&te(d)},[a,d,te]),M.useEffect(()=>{const v=()=>{a&&d>=0&&setTimeout(()=>{te(d)},100)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[a,d,te]);const ye=v=>{a&&(v<0||v>=a.moves.length||(te(v),h(v)))},ee=()=>{if(!a||m)return;w(!0),h(0),te(0);let v=0;se.current=setInterval(()=>{if(v>=a.moves.length){oe();return}v++,te(v),h(v)},1e3/S)},oe=()=>{se.current&&(clearInterval(se.current),se.current=null),w(!1)};if(M.useEffect(()=>()=>{se.current&&clearInterval(se.current)},[]),M.useEffect(()=>{if(m&&se.current){clearInterval(se.current),se.current=null;const v=d;h(0),w(!1),setTimeout(()=>{h(v),ee()},0)}},[S]),!a)return K?u.jsx("div",{className:re,children:u.jsxs("div",{className:"summary-upload",children:[u.jsx("h1",{children:t}),u.jsx("p",{children:"Load a game session JSON file to view the replay"}),u.jsx("input",{ref:H,type:"file",accept:".json",onChange:ve,style:{display:"none"}}),u.jsx("button",{onClick:()=>{var v;return(v=H.current)==null?void 0:v.click()},children:"Load JSON File"})]})}):null;const ne=a.moves[d],we=a.moves.length,be=(($=a.summary)==null?void 0:$.movesByPlayer)||{},Ie=Object.entries(be||{}),Fe=(v,R=1)=>Number.isFinite(v)?v.toFixed(R):"",Be=a.sessionInfo||{},$e=Be.subjectId||Be.id||a.subjectId||a.id||null,Y=Be.sessionGameId||a.sessionGameId||$e||null,Q=Be.condition||a.condition||null,ge=a.startTime||Be.startedAt||Be.date||null,le=a.endTime||Be.endedAt||null,P=v=>{if(!v)return null;try{const R=new Date(v);if(!Number.isNaN(R.getTime()))return R.toLocaleString()}catch{}return v},U=[];Y&&U.push({label:"Session ID",value:Y}),$e&&$e!==Y&&U.push({label:"Participant",value:$e}),Q&&U.push({label:"Condition",value:Q});const J=P(ge);J&&U.push({label:"Start",value:J});const ce=P(le);return ce&&U.push({label:"End",value:ce}),u.jsxs("div",{className:re,children:[u.jsxs("div",{className:"summary-header",children:[u.jsx("h1",{children:t}),U.length>0&&u.jsx("div",{className:"summary-session-info",children:U.map(v=>u.jsxs("div",{className:"summary-session-info-item",children:[u.jsx("span",{className:"summary-session-info-label",children:v.label}),u.jsx("span",{className:"summary-session-info-value",children:v.value})]},`${v.label}-${v.value}`))})]}),u.jsxs("div",{className:"summary-main",children:[u.jsxs("div",{className:"summary-left",children:[u.jsx("div",{className:"summary-game-area",children:u.jsxs("div",{className:"game-canvas",ref:V,children:[u.jsx("div",{className:"gallery",children:u.jsx("div",{className:"gallery-frame",children:g.length>0?u.jsx("img",{src:g[g.length-1].image,alt:"Gallery",className:"gallery-image"}):u.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),L.map((v,R)=>{const N=v.position||[0,0];return!Array.isArray(N)||N.length!==2||!Number.isFinite(N[0])||!Number.isFinite(N[1])?(console.warn(`Invalid position for block ${v.id}:`,N),null):u.jsx("div",{className:`block ${v.canMove?"movable":""} ${v.id===E?"highlighted":""}`,style:{left:`${q(N[0])}px`,top:`${q(N[1])}px`,backgroundColor:v.color||"green",cursor:v.canMove?"grab":"default",zIndex:v.id===E?20:R+1}},v.id)})]})}),u.jsxs("div",{className:"summary-progress",children:[u.jsx("input",{type:"range",min:"0",max:Math.max(0,we-1),value:d,onChange:v=>ye(parseInt(v.target.value)),style:{width:"100%"}}),u.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",we,ne&&u.jsxs("span",{className:"move-info",children:[" "," Player: ",ne.player,Array.isArray(ne.position)&&ne.position.length===2&&`  Position: (${ne.position[0]}, ${ne.position[1]})`,Number.isFinite(ne.holdTime)&&`  Hold: ${Fe(ne.holdTime,2)}s`," "," Time: ",Fe(ne.elapsed,1),"s"]})]})]})]}),u.jsxs("div",{className:"summary-right",children:[u.jsxs("div",{className:"summary-stats",children:[u.jsxs("div",{className:"summary-stats-row",children:[u.jsx("span",{className:"summary-stats-label",children:"Duration"}),u.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),u.jsxs("div",{className:"summary-stats-row",children:[u.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),u.jsx("span",{className:"summary-stats-value",children:we})]}),u.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[u.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),u.jsx("div",{className:"summary-stats-value",children:Ie.length===0?u.jsx("span",{children:""}):Ie.map(([v,R])=>u.jsxs("div",{children:[v,": ",R]},v))})]})]}),u.jsxs("div",{className:"summary-controls",children:[u.jsx("button",{onClick:()=>ye(0),disabled:d===0,children:" First"}),u.jsx("button",{onClick:()=>ye(d-1),disabled:d===0,children:" Previous"}),u.jsx("button",{onClick:m?oe:ee,children:m?" Pause":" Play"}),u.jsx("button",{onClick:()=>ye(d+1),disabled:d>=we-1,children:" Next"}),u.jsx("button",{onClick:()=>ye(we-1),disabled:d>=we-1,children:" Last"}),u.jsxs("div",{className:"speed-control",children:[u.jsx("label",{children:"Speed:"}),u.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:S,onChange:v=>j(parseFloat(v.target.value))}),u.jsxs("span",{children:[S,"x"]})]}),K&&u.jsxs(u.Fragment,{children:[u.jsx("input",{ref:H,type:"file",accept:".json",onChange:ve,style:{display:"none"}}),u.jsx("button",{onClick:()=>{var v;return(v=H.current)==null?void 0:v.click()},children:" Load New File"})]})]}),u.jsxs("div",{className:"summary-moves-list",children:[u.jsxs("div",{className:"move-list-header",children:[u.jsx("h2",{children:"Move History"}),i&&u.jsx("button",{className:`edit-mode-toggle ${T?"active":""}`,onClick:()=>D(!T),children:T?" Done Editing":"Edit Players"})]}),u.jsx("div",{className:"moves-scroll",children:a.moves.map((v,R)=>u.jsxs("div",{className:`move-item ${R===d?"active":""} ${T?"edit-mode":""}`,onClick:()=>!T&&ye(R),children:[u.jsx("div",{className:"move-number",children:R+1}),v.camera_frame&&u.jsx("div",{className:"move-camera-frame",children:u.jsx("img",{src:v.camera_frame,alt:`Camera frame for move ${R+1}`,className:"camera-frame-thumbnail"})}),u.jsxs("div",{className:"move-details",children:[u.jsx("div",{className:"move-type",children:v.type}),T&&i?u.jsxs("div",{className:"move-player-edit",children:[u.jsx("label",{children:"Player:"}),u.jsxs("select",{value:v.player||"Unknown",onChange:N=>{const b=N.target.value;i(v._id,b)},onClick:N=>N.stopPropagation(),children:[u.jsx("option",{value:"Player A",children:"Player A"}),u.jsx("option",{value:"Player B",children:"Player B"}),u.jsx("option",{value:"None",children:"None"}),u.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):u.jsxs("div",{className:"move-player",children:["Player: ",v.player]}),v.blockId!==null&&v.blockId!==void 0||v.unit!==null&&v.unit!==void 0?u.jsxs("div",{className:"move-unit",children:["Block: ",v.blockId!==void 0?v.blockId:v.unit]}):null,Array.isArray(v.position)&&v.position.length===2&&u.jsxs("div",{className:"move-position",children:["Position: (",v.position[0],", ",v.position[1],")"]}),Number.isFinite(v.holdTime)&&v.holdTime>0&&u.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",Fe(v.holdTime,2),"s"]}),u.jsxs("div",{className:"move-time",children:["Time: ",Fe(v.elapsed,1),"s"]})]})]},R))})]})]})]})]})}const Kt=(...e)=>{console.log("[Detector2]",...e)},gn={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function hx(){const e=M.useRef(null),t=M.useRef(null),n=M.useRef(null),r=M.useRef(null),s=M.useRef(null),i=M.useRef(null),a=M.useRef(null),l=M.useRef(null),d=M.useRef(null),[h,m]=M.useState(""),[w,S]=M.useState(!1),[j,L]=M.useState({camA:"None",camB:"None",merged:"None"}),[F,X]=M.useState(!0),[C,g]=M.useState(null),[y,E]=M.useState(null),_=M.useRef(null),T=M.useRef(null),D=(v,R)=>{const N=localStorage.getItem(v);if(N===null)return R;const b=parseFloat(N);return Number.isFinite(b)?b:R},[H,se]=M.useState(()=>({roiSize:(()=>{const v=D(gn.roiSize,44);return v>10?v:44})(),hueWeight:D(gn.hueWeight,4),satWeight:D(gn.satWeight,2),valWeight:D(gn.valWeight,1),sensitivity:D(gn.sensitivity,0)})),V=M.useRef(H),[K,re]=M.useState([]),[q,te]=M.useState(""),[Se,ve]=M.useState("");M.useEffect(()=>{let v=!0;(async()=>{try{const B=(await navigator.mediaDevices.enumerateDevices()).filter(W=>W.kind==="videoinput");if(B.length===0){m("No cameras found");return}re(B);const z=B.slice(0,2).map(W=>W.deviceId);te(z[0]||""),ve(z[1]||z[0]||""),await ye(z[0],e,l),z[1]?await ye(z[1],t,d):await ye(z[0],t,d),await Fe(),await Be("A",e,i),await Be("B",t,a)}catch(b){if(!v)return;m((b==null?void 0:b.message)||String(b))}})();const R=()=>{try{const b=JSON.parse(localStorage.getItem("calibrationA")||"null"),B=JSON.parse(localStorage.getItem("calibrationB")||"null");b&&g({h:b.h,s:b.s,v:b.v}),B&&E({h:B.h,s:B.s,v:B.v})}catch{Kt("No existing calibrations")}};R();const N=b=>{!b||!b.key||(["calibrationA","calibrationB"].includes(b.key)&&R(),[gn.roiSize,gn.hueWeight,gn.satWeight,gn.valWeight,gn.sensitivity].includes(b.key)&&se(B=>({roiSize:(()=>{const z=D(gn.roiSize,(B==null?void 0:B.roiSize)??44);return z>10?z:(B==null?void 0:B.roiSize)??44})(),hueWeight:D(gn.hueWeight,(B==null?void 0:B.hueWeight)??4),satWeight:D(gn.satWeight,(B==null?void 0:B.satWeight)??2),valWeight:D(gn.valWeight,(B==null?void 0:B.valWeight)??1),sensitivity:D(gn.sensitivity,(B==null?void 0:B.sensitivity)??0)})))};return window.addEventListener("storage",N),()=>{if(v=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),l.current&&(l.current.getTracks().forEach(z=>z.stop()),l.current=null),d.current&&(d.current.getTracks().forEach(z=>z.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const b=e.current;b&&(b.srcObject=null);const B=t.current;B&&(B.srcObject=null),window.removeEventListener("storage",N)}},[]);const ye=async(v,R,N)=>{const b={video:{deviceId:{exact:v}}};Kt("Starting camera with deviceId:",v);const B=await navigator.mediaDevices.getUserMedia(b);N.current=B;const z=R.current;if(!z){Kt("Video element not found!");return}z.srcObject=B,Kt("Stream assigned to video element, waiting for metadata..."),await new Promise(W=>{if(z.readyState>=2&&z.videoWidth>0&&z.videoHeight>0)return Kt("Video already ready:",z.videoWidth,"x",z.videoHeight),W();const me=()=>{Kt("loadedmetadata event fired:",z.videoWidth,"x",z.videoHeight),z.removeEventListener("loadedmetadata",me),W()};z.addEventListener("loadedmetadata",me,{once:!0}),setTimeout(()=>{Kt("Metadata timeout - proceeding anyway"),z.removeEventListener("loadedmetadata",me),W()},2e3)});try{await z.play(),Kt("Video play() succeeded")}catch(W){Kt("Video play() failed:",W)}},ee=M.useRef(null),oe=M.useRef(null),ne=M.useRef(null),we=M.useRef(!1),be=async()=>{if(!we.current){we.current=!0;try{for(;oe.current||ne.current;){const v=s.current;if(!v)break;let R=null,N=null;if(oe.current?(R="A",N=oe.current,oe.current=null):ne.current&&(R="B",N=ne.current,ne.current=null),!!N){ee.current=R;try{await v.send({image:N})}catch(b){console.error("[Detector2] hands.send error:",b);break}}}}finally{we.current=!1}}},Ie=(v,R)=>{v==="A"?oe.current=R:ne.current=R,Promise.resolve().then(be)},Fe=async()=>{if(s.current)return s.current;try{const v=await(async()=>{try{if(typeof Ql.Hands=="function")return Ql.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const N=document.getElementById("mp-hands-cdn-script");if(N&&(await new Promise(b=>{if(window.Hands&&typeof window.Hands=="function")return b();const B=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(B),b())},50);setTimeout(()=>{clearInterval(B),b()},3e3)}),window.Hands&&typeof window.Hands=="function")||(N||await new Promise((b,B)=>{const z=document.createElement("script");z.id="mp-hands-cdn-script",z.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",z.async=!0,z.onload=()=>b(),z.onerror=W=>B(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(z)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),R=new v({locateFile:N=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${N}`});return R.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),R.onResults(N=>{const b=ee.current;b==="A"?Q(N):b==="B"&&ge(N)}),s.current=R,R}catch(v){return console.error("MediaPipe initialization error:",v),m(`MediaPipe error: ${v.message}`),null}},Be=async(v,R,N)=>{if(!await Fe())return;const B=R.current;if(!B){Kt(`Video ref for ${v} not found`);return}Kt(`Initializing manual frame capture for camera ${v}, video dimensions:`,B.videoWidth,"x",B.videoHeight);let z=null;const W=()=>{const fe=R.current;fe&&fe.readyState>=2&&fe.videoWidth>0&&Ie(v,fe),z=requestAnimationFrame(W)};z=requestAnimationFrame(W),N.current={stop:()=>{z&&(cancelAnimationFrame(z),z=null,Kt(`Stopped manual frame capture for camera ${v}`))}},Kt(`Manual frame capture started for camera ${v}`)},$e=M.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),Y=M.useRef({wristY:null,player:"None",landmarks:null,wristX:null});M.useEffect(()=>{_.current=C},[C]),M.useEffect(()=>{T.current=y},[y]),M.useEffect(()=>{V.current=H},[H]);const Q=v=>le(v,n,"A"),ge=v=>le(v,r,"B"),le=(v,R,N)=>{var ut;const b=R.current;if(!b)return;const B=b.getContext("2d");if(!B)return;const z=N==="A"?e.current:t.current;if(!z||z.videoWidth===0||z.videoHeight===0){N==="A"?$e.current={wristY:null,wristX:null,landmarks:null,player:"None"}:Y.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}b.width=z.videoWidth,b.height=z.videoHeight,B.drawImage(z,0,0,b.width,b.height),B.fillStyle="rgba(0, 0, 0, 0.6)",B.fillRect(b.width-80,5,75,20),B.fillStyle="white",B.font="bold 14px Arial",B.fillText(`Camera ${N}`,b.width-75,20);let W=null,fe=null,me=null,Pe=[];if(v.multiHandLandmarks&&v.multiHandLandmarks.length>0)for(const Ve of v.multiHandLandmarks){const ze=Ve[0],He=ze.x*b.width,qe=ze.y*b.height;Pe.push({x:He,y:qe,landmarks:Ve}),(W===null||(F?qe<W:qe>W))&&(W=qe,fe=Ve,me=He)}Pe.forEach(({x:Ve,y:ze})=>{B.fillStyle="orange",B.beginPath(),B.arc(Ve,ze,8,0,Math.PI*2),B.fill()});let Me="None";if(fe){B.fillStyle="lime",B.beginPath(),B.arc(me,W,10,0,2*Math.PI),B.fill(),B.fillStyle="lime",B.font="16px Arial",B.fillText("SELECTED",me-40,W-15);const ze=Math.max(10,Math.min(300,Math.floor(((ut=V.current)==null?void 0:ut.roiSize)||60)))/2,He=Math.max(0,me-ze),qe=Math.max(0,W-ze),bt=Math.min(b.width,me+ze),on=Math.min(b.height,W+ze),mt=Math.max(0,Math.floor(He)),Ut=Math.max(0,Math.floor(qe));let Mt=Math.floor(bt-He),Tt=Math.floor(on-qe);if(Mt=Math.max(1,Mt),Tt=Math.max(1,Tt),Mt=Math.min(Mt,b.width-mt),Tt=Math.min(Tt,b.height-Ut),Mt>0&&Tt>0){B.strokeStyle="lime",B.lineWidth=3,B.strokeRect(mt,Ut,Mt,Tt);try{const hn=B.getImageData(mt,Ut,Mt,Tt),pn=_.current,Rn=T.current;Me=U(hn,pn,Rn).status}catch(hn){console.warn("[Detector2] ROI sampling failed:",hn),Me="None"}}else Kt("ROI skipped due to zero width/height",{width:Mt,height:Tt,left:mt,top:Ut})}if(Pe.length>=1){let Ve=Pe[0].y,ze=Pe[0].y;Pe.forEach(bt=>{bt.y<Ve&&(Ve=bt.y),bt.y>ze&&(ze=bt.y)}),B.strokeStyle="yellow",B.setLineDash([6,4]),B.beginPath(),B.moveTo(0,F?Ve:ze),B.lineTo(b.width,F?Ve:ze),B.stroke(),B.strokeStyle="cyan",B.beginPath(),B.moveTo(0,F?ze:Ve),B.lineTo(b.width,F?ze:Ve),B.stroke(),B.setLineDash([]);const He=F?"A (top)":"A (bottom)",qe=F?"B (bottom)":"B (top)";B.fillStyle="lime",B.font="16px Arial",B.fillText(He,6,Math.max(14,(F?Ve:ze)-6)),B.fillStyle="dodgerblue",B.fillText(qe,6,Math.min(b.height-6,(F?ze:Ve)+18))}const Ge={wristY:W,wristX:me,landmarks:fe,player:Me};N==="A"?$e.current=Ge:Y.current=Ge;const tt=$e.current.wristY,st=Y.current.wristY;let lt="None";if(tt!=null||st!=null){const Ve=F?(He,qe)=>He==null?qe:Math.min(He,qe):(He,qe)=>He==null?qe:Math.max(He,qe);[tt,st].filter(He=>He!=null).reduce(Ve,null)===tt?lt=$e.current.player:lt=Y.current.player}L({camA:$e.current.player,camB:Y.current.player,merged:lt})},P=(v,R,N)=>{v/=255,R/=255,N/=255;const b=Math.max(v,R,N),B=Math.min(v,R,N),z=b-B;let W=0;z!==0&&(b===v?W=60*((R-N)/z%6):b===R?W=60*((N-v)/z+2):W=60*((v-R)/z+4)),W<0&&(W+=360);const fe=b===0?0:z/b*255,me=b*255;return[W/2,fe,me]},U=(v,R,N)=>{var me,Pe,Me,Ge;const b=v.data;if(R&&!N)return{status:"Player A",percentA:null,percentB:null};if(N&&!R)return{status:"Player B",percentA:null,percentB:null};const B=((me=V.current)==null?void 0:me.hueWeight)??4,z=((Pe=V.current)==null?void 0:Pe.satWeight)??2,W=((Me=V.current)==null?void 0:Me.valWeight)??1,fe=((Ge=V.current)==null?void 0:Ge.sensitivity)??0;if(R&&N){let tt=0,st=0,lt=0;for(let He=0;He<b.length;He+=4){const qe=b[He],bt=b[He+1],on=b[He+2],[mt,Ut,Mt]=P(qe,bt,on),Tt=Math.min(1,Math.max(0,Ut/255)),hn=Math.min(1,Math.max(0,Mt/255)),pn=Math.max(.05,.5*Tt+.5*hn),Rn=Math.min(Math.abs(mt-R.h),180-Math.abs(mt-R.h)),mn=Math.min(Math.abs(mt-N.h),180-Math.abs(mt-N.h)),Pr=Math.abs(Ut-R.s),pr=Math.abs(Ut-N.s),mr=Math.abs(Mt-R.v),gr=Math.abs(Mt-N.v),O=Rn*B+Pr*z+mr*W,ue=mn*B+pr*z+gr*W;Math.min(O,ue)>180||(O<=ue?tt+=pn:st+=pn,lt+=pn)}if(lt===0)return{status:"None",percentA:0,percentB:0};const ut=tt/Math.max(1e-6,lt),Ve=st/Math.max(1e-6,lt),ze=.12*(1+.8*Math.max(0,Math.min(1,fe)));return ut>=ze&&ut>=Ve?{status:"Player A",percentA:ut,percentB:Ve}:Ve>=ze&&Ve>ut?{status:"Player B",percentA:ut,percentB:Ve}:{status:"None",percentA:ut,percentB:Ve}}return{status:"None",percentA:0,percentB:0}},J=(v,R,N)=>{const b=(v||0)*2,B=(R||0)/255,z=(N||0)/255,W=z*B,fe=W*(1-Math.abs(b/60%2-1)),me=z-W;let Pe=0,Me=0,Ge=0;b>=0&&b<60?(Pe=W,Me=fe,Ge=0):b<120?(Pe=fe,Me=W,Ge=0):b<180?(Pe=0,Me=W,Ge=fe):b<240?(Pe=0,Me=fe,Ge=W):b<300?(Pe=fe,Me=0,Ge=W):(Pe=W,Me=0,Ge=fe);const tt=Math.round((Pe+me)*255),st=Math.round((Me+me)*255),lt=Math.round((Ge+me)*255);return`rgb(${tt}, ${st}, ${lt})`},ce=v=>v?J(v.h,v.s,v.v):"#ffffff",$=async(v,R)=>{try{if(v==="A"){if(te(R),i.current){try{i.current.stop()}catch(b){Kt("Stop camA error:",b)}i.current=null}l.current&&(l.current.getTracks().forEach(b=>b.stop()),l.current=null);const N=e.current;N&&(N.srcObject=null),await new Promise(b=>setTimeout(b,100)),await ye(R,e,l),await new Promise(b=>setTimeout(b,200)),await Fe(),await Be("A",e,i),Kt("Camera A switched to:",R)}else{if(ve(R),a.current){try{a.current.stop()}catch(b){Kt("Stop camB error:",b)}a.current=null}d.current&&(d.current.getTracks().forEach(b=>b.stop()),d.current=null);const N=t.current;N&&(N.srcObject=null),await new Promise(b=>setTimeout(b,100)),await ye(R,t,d),await new Promise(b=>setTimeout(b,200)),await Fe(),await Be("B",t,a),Kt("Camera B switched to:",R)}}catch(N){console.error("[Detector2] Camera switch error:",N),m(`Camera switch error: ${N.message}`)}};return u.jsxs("div",{className:`detector-window ${w?"minimized":""}`,children:[u.jsxs("div",{className:"detector-header",children:[u.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),u.jsxs("div",{className:"detector-controls",children:[u.jsx("button",{onClick:()=>S(!w),children:w?"":""}),u.jsx("button",{onClick:()=>X(!F),title:"Toggle A criterion",children:F?"A=Top":"A=Bottom"})]})]}),u.jsxs("div",{className:"detector-content",style:{display:w?"none":"block"},children:[u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsxs("div",{style:{flex:1},children:[u.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[u.jsx("span",{children:"Camera A:"}),u.jsx("select",{value:q,onChange:v=>$("A",v.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(v=>u.jsx("option",{value:v.deviceId,children:v.label||`Camera ${v.deviceId.slice(0,8)}`},v.deviceId))})]}),u.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),u.jsx("canvas",{ref:n,className:"output_canvas"})]}),u.jsxs("div",{style:{flex:1},children:[u.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[u.jsx("span",{children:"Camera B:"}),u.jsx("select",{value:Se,onChange:v=>$("B",v.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(v=>u.jsx("option",{value:v.deviceId,children:v.label||`Camera ${v.deviceId.slice(0,8)}`},v.deviceId))})]}),u.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),u.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),u.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[u.jsxs("div",{className:"status-display",children:["Merged: ",u.jsx("strong",{children:j.merged})]}),u.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),u.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:C?ce(C):"#444"}})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),u.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:y?ce(y):"#444"}})]})]}),u.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[u.jsxs("div",{children:["A: ",C?`h${Math.round(C.h)} s${Math.round(C.s)} v${Math.round(C.v)}`:""]}),u.jsxs("div",{children:["B: ",y?`h${Math.round(y.h)} s${Math.round(y.s)} v${Math.round(y.v)}`:""]})]}),h&&u.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),u.jsxs("div",{style:{fontSize:12,marginTop:6},children:[u.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const Po=_u(),v1=e=>{var i,a,l,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((m,w)=>typeof w.elapsed=="number"&&w.elapsed>m?w.elapsed:m,0),r={},s={};return t.forEach(m=>{const w=(m==null?void 0:m.player)||"Unknown";r[w]=(r[w]||0)+1;const S=(m==null?void 0:m.phase)||"unknown";s[S]=(s[S]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((l=(a=e.metadata)==null?void 0:a.config)==null?void 0:l.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},px=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},w1="adminPassword";function mx(){var K;const[e,t]=M.useState([]),[n,r]=M.useState(!0),[s,i]=M.useState(null),[a,l]=M.useState(null),[d,h]=M.useState(null),[m,w]=M.useState(!1),[S,j]=M.useState(null),[L,F]=M.useState(!1),[X,C]=M.useState(""),[g,y]=M.useState(!1);M.useEffect(()=>{const re=localStorage.getItem(w1);re&&C(re)},[]);const E=M.useCallback(async()=>{if(!X){i("Password required"),r(!1);return}r(!0),i(null),y(!1);try{const re=await fetch(`${Po}/sessions`,{headers:{"x-admin-password":X}});if(re.status===401||re.status===403)throw y(!0),new Error("Invalid password");if(!re.ok)throw new Error(`Failed to load sessions (${re.status})`);const q=await re.json(),te=Array.isArray(q)?q:[];localStorage.setItem(w1,X),t(te),l(Se=>Se&&te.some(ve=>ve.sessionGameId===Se)?Se:te.length>0?te[0].sessionGameId:null)}catch(re){console.error("[Admin] Error fetching sessions:",re),i(re.message||"Failed to load sessions"),t([]),l(null)}finally{r(!1)}},[X]);M.useEffect(()=>{E()},[E]),M.useEffect(()=>{if(!a){h(null);return}let re=!1;return(async()=>{if(X){w(!0),j(null);try{const te=await fetch(`${Po}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":X}});if(!te.ok)throw te.status===404?new Error("Session not found"):new Error(`Failed to load session (${te.status})`);const Se=await te.json();re||h(v1(Se))}catch(te){console.error("[Admin] Error fetching session detail:",te),re||(j(te.message||"Failed to load session"),h(null))}finally{re||w(!1)}}})(),()=>{re=!0}},[a]);const _=re=>{l(re),F(!1)},T=async()=>{if(!a||!X)return;const re=!L;F(re),w(!0),j(null);try{const q=re?`${Po}/sessions/${encodeURIComponent(a)}/experiment-only`:`${Po}/sessions/${encodeURIComponent(a)}`,te=await fetch(q,{headers:{"x-admin-password":X}});if(!te.ok)throw new Error(`Failed to load session data (${te.status})`);const Se=await te.json();h(v1(Se))}catch(q){console.error("[Admin] Error loading session data:",q),j(q.message||"Failed to load session data"),F(!re)}finally{w(!1)}},D=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},H=()=>{if(!d)return;const re=JSON.stringify(d,null,2),q=new Blob([re],{type:"application/json"}),te=URL.createObjectURL(q),Se=document.createElement("a");Se.href=te;const ve=`${a}_${new Date().toISOString().split("T")[0]}.json`;Se.download=ve,Se.click(),URL.revokeObjectURL(te),console.log("[Admin] Downloaded JSON:",ve)},se=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const re=new Set;d.moves.forEach(ne=>{Object.keys(ne).forEach(we=>{we!=="camera_frame"&&we!=="__v"&&re.add(we)})});const q=Array.from(re),te=[q.join(",")];d.moves.forEach(ne=>{const we=q.map(be=>{const Ie=ne[be];return Ie==null||Ie===""?"":Array.isArray(Ie)||typeof Ie=="object"?`"${JSON.stringify(Ie).replace(/"/g,'""')}"`:`"${String(Ie).replace(/"/g,'""')}"`});te.push(we.join(","))});const Se=te.join(`
`),ve=new Blob([Se],{type:"text/csv;charset=utf-8;"}),ye=URL.createObjectURL(ve),ee=document.createElement("a");ee.href=ye;const oe=`${a}_${new Date().toISOString().split("T")[0]}.csv`;ee.download=oe,ee.click(),URL.revokeObjectURL(ye),console.log("[Admin] Downloaded CSV:",oe)},V=async(re,q)=>{if(!(!a||!re||!X))try{const te=await fetch(`${Po}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(re)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":X},body:JSON.stringify({player:q})});if(!te.ok)throw new Error(`Failed to update player (${te.status})`);h(Se=>Se&&{...Se,moves:Se.moves.map(ve=>ve._id===re?{...ve,player:q}:ve)}),console.log("[Admin] Player updated:",re,q)}catch(te){console.error("[Admin] Error updating player:",te),alert("Failed to update player: "+te.message)}};return u.jsxs("div",{className:"admin-container",children:[u.jsxs("aside",{className:"admin-sidebar",children:[u.jsxs("div",{className:"admin-sidebar-header",children:[u.jsx("h1",{children:"Admin"}),u.jsxs("div",{className:"admin-password-row",children:[u.jsx("input",{type:"password",className:`admin-password-input ${g?"error":""}`,placeholder:"Password",value:X,onChange:re=>C(re.target.value),onKeyPress:re=>{re.key==="Enter"&&E()}}),u.jsx("button",{className:"admin-refresh-button",onClick:E,disabled:n||!X,children:n?"Refreshing":"Refresh"})]})]}),s&&u.jsx("div",{className:"admin-error",children:s}),u.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&u.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&u.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(re=>{const q=typeof re.movesCount=="number"?re.movesCount:Array.isArray(re.moves)?re.moves.length:0,te=re.sessionGameId===a;return u.jsxs("button",{className:`admin-session-card ${te?"active":""}`,onClick:()=>_(re.sessionGameId),children:[u.jsx("div",{className:"admin-session-id",children:re.sessionGameId}),u.jsxs("div",{className:"admin-session-meta",children:[u.jsxs("span",{children:["Participant: ",re.subjectId||""]}),u.jsxs("span",{children:["Condition: ",re.condition||""]})]}),u.jsxs("div",{className:"admin-session-meta",children:[u.jsxs("span",{children:["Moves: ",q]}),u.jsxs("span",{children:["Updated: ",px(re.updatedAt)]})]})]},re.sessionGameId)})]})]}),u.jsxs("main",{className:"admin-content",children:[m&&u.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),S&&u.jsx("div",{className:"admin-error admin-error--content",children:S}),!m&&!S&&d&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"admin-toolbar",children:[u.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[u.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),u.jsx("button",{className:`admin-toolbar-button experiment-toggle ${L?"active":""}`,onClick:T,title:L?"Show all moves (including practice)":"Show only experiment phase moves",children:L?"Show All Moves":"Experiment Only"}),u.jsx("button",{className:"admin-toolbar-button edit-players",onClick:D,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),u.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[u.jsx("button",{className:"admin-toolbar-button download-json",onClick:H,title:"Download session data as JSON",children:"Download JSON"}),u.jsx("button",{className:"admin-toolbar-button download-csv",onClick:se,title:"Download moves as CSV",children:"Download CSV"})]})]}),u.jsx("div",{className:"admin-summary-wrapper",children:u.jsx(Q2,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((K=d.sessionInfo)==null?void 0:K.sessionGameId)||a||""}${L?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:V})})]}),!m&&!S&&!d&&u.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const x1="adminPassword";function gx(){const[e,t]=M.useState(null),[n,r]=M.useState(!1),[s,i]=M.useState(null),[a,l]=M.useState(null),[d,h]=M.useState(null),[m,w]=M.useState(""),[S,j]=M.useState(!1);M.useEffect(()=>{const X=localStorage.getItem(x1);X&&w(X)},[]);const L=X=>{const C=X.target.files[0];if(!C)return;if(!C.name.endsWith(".json")){l("Please select a JSON file"),t(null);return}t(C),l(null),i(null);const g=new FileReader;g.onload=y=>{var E;try{const _=JSON.parse(y.target.result);h({sessionGameId:_.sessionGameId||"N/A",subjectId:_.subjectId||"N/A",condition:_.condition||"N/A",date:_.date||"N/A",movesCount:((E=_.moves)==null?void 0:E.length)||0,hasColorA:!!_.colorA,hasColorB:!!_.colorB})}catch(_){l("Invalid JSON file: "+_.message),h(null)}},g.readAsText(C)},F=async()=>{var X;if(!e){l("Please select a file first");return}r(!0),l(null),i(null);try{const C=await new Promise((T,D)=>{const H=new FileReader;H.onload=se=>T(se.target.result),H.onerror=D,H.readAsText(e)}),g=JSON.parse(C);if(!g.sessionGameId||!g.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!m)throw new Error("Admin password is required. Please enter it below.");const y=await fetch(`${_u()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":m},body:JSON.stringify(g)}),E=await y.json();if(y.status===401||y.status===403)throw j(!0),new Error(E.message||"Invalid admin password");if(!y.ok)throw new Error(E.message||"Upload failed");localStorage.setItem(x1,m),j(!1),i(` Successfully uploaded session "${g.sessionGameId}" with ${((X=g.moves)==null?void 0:X.length)||0} moves`),t(null),h(null);const _=document.getElementById("json-file-input");_&&(_.value="")}catch(C){l(C.message||"Failed to upload file")}finally{r(!1)}};return u.jsx("div",{className:"admin-upload-container",children:u.jsxs("div",{className:"admin-upload-card",children:[u.jsx("h1",{children:"Admin: Upload Session JSON"}),u.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),u.jsxs("div",{className:"admin-upload-form",children:[u.jsxs("div",{className:"password-input-wrapper",children:[u.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),u.jsx("input",{id:"admin-password",type:"password",value:m,onChange:X=>{w(X.target.value),j(!1)},placeholder:"Enter admin password",className:S?"error":""}),S&&u.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),u.jsxs("div",{className:"file-input-wrapper",children:[u.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:L,disabled:n}),u.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&u.jsxs("div",{className:"file-preview",children:[u.jsx("h3",{children:"File Preview"}),u.jsxs("div",{className:"preview-grid",children:[u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Condition:"})," ",d.condition]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Date:"})," ",d.date]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&u.jsxs("div",{className:"error-message",children:[u.jsx("strong",{children:"Error:"})," ",a]}),s&&u.jsx("div",{className:"success-message",children:s}),u.jsx("button",{className:"upload-button",onClick:F,disabled:!e||!m||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var li=typeof self<"u"?self:{};function Vs(){throw Error("Invalid UTF8")}function S1(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let rl,zc;const yx=typeof TextDecoder<"u";let vx;const wx=typeof TextEncoder<"u";function J2(e){if(wx)e=(vx||(vx=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var hh,Jl;e:{for(var k1=["CLOSURE_FLAGS"],Hc=li,Gc=0;Gc<k1.length;Gc++)if((Hc=Hc[k1[Gc]])==null){Jl=null;break e}Jl=Hc}var va,A1=Jl&&Jl[610401301];hh=A1!=null&&A1;const E1=li.navigator;function ef(e){return!!hh&&!!va&&va.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function rr(e){var t;return(t=li.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function ks(){return!!hh&&!!va&&va.brands.length>0}function Wc(){return ks()?ef("Chromium"):(rr("Chrome")||rr("CriOS"))&&!(!ks()&&rr("Edge"))||rr("Silk")}function ph(e){return ph[" "](e),e}va=E1&&E1.userAgentData||null,ph[" "]=function(){};var xx=!ks()&&(rr("Trident")||rr("MSIE"));!rr("Android")||Wc(),Wc(),rr("Safari")&&(Wc()||!ks()&&rr("Coast")||!ks()&&rr("Opera")||!ks()&&rr("Edge")||(ks()?ef("Microsoft Edge"):rr("Edg/"))||ks()&&ef("Opera"));var q2={},Do=null;function Sx(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function l(h){for(;d<i.length;){const m=i.charAt(d++),w=Do[m];if(w!=null)return w;if(!/^[\s\xa0]*$/.test(m))throw Error("Unknown base64 encoding at char: "+m)}return h}Z2();let d=0;for(;;){const h=l(-1),m=l(0),w=l(64),S=l(64);if(S===64&&h===-1)break;a(h<<2|m>>4),w!=64&&(a(m<<4&240|w>>2),S!=64&&a(w<<6&192|S))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function Z2(){if(!Do){Do={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));q2[n]=r;for(let s=0;s<r.length;s++){const i=r[s];Do[i]===void 0&&(Do[i]=s)}}}}var ey=typeof Uint8Array<"u",ty=!xx&&typeof btoa=="function";function C1(e){if(!ty){var t;t===void 0&&(t=0),Z2(),t=q2[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],l=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=l+s+i+a}switch(l=0,a=r,e.length-d){case 2:a=t[(15&(l=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|l>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const _1=/[-_.]/g,kx={"-":"+",_:"/",".":"="};function Ax(e){return kx[e]||""}function ny(e){if(!ty)return Sx(e);_1.test(e)&&(e=e.replace(_1,Ax)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function ja(e){return ey&&e!=null&&e instanceof Uint8Array}var Ji={};function ui(){return Ex||(Ex=new rs(null,Ji))}function mh(e){ry(Ji);var t=e.g;return(t=t==null||ja(t)?t:typeof t=="string"?ny(t):null)==null?t:e.g=t}var rs=class{h(){return new Uint8Array(mh(this)||0)}constructor(e,t){if(ry(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let Ex,Cx;function ry(e){if(e!==Ji)throw Error("illegal external caller")}function sy(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function tf(e){return sy(e=Error(e),"warning"),e}var ju=typeof Symbol=="function"&&typeof Symbol()=="symbol",_x=new Set;function Na(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&_x.add(e),e}var jx=Na("jas",void 0,!0,!0),j1=Na(void 0,"0di"),Vc=Na(void 0,"2ex"),Io=Na(void 0,"1oa",!0),qi=Na(void 0,Symbol(),!0);const Ne=ju?jx:"Ga",iy={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},oy=Object.defineProperties;function Nu(e,t){ju||Ne in e||oy(e,iy),e[Ne]|=t}function Ht(e,t){ju||Ne in e||oy(e,iy),e[Ne]=t}function co(e){return Nu(e,34),e}function Nx(e,t){Ht(t,-30975&(0|e))}function nf(e,t){Ht(t,-30941&(34|e))}function gh(){return typeof BigInt=="function"}function Tn(e){return Array.prototype.slice.call(e)}var yh,ba={},ay={};function N1(e){return!(!e||typeof e!="object"||e.Ia!==ay)}function vh(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function wh(e,t){if(e!=null){if(typeof e=="string")e=e?new rs(e,Ji):ui();else if(e.constructor!==rs)if(ja(e))e=e.length?new rs(new Uint8Array(e),Ji):ui();else{if(!t)throw Error();e=void 0}}return e}function ql(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[Ne]))}const b1=[];function Hs(e){if(2&e)throw Error()}Ht(b1,55),yh=Object.freeze(b1);class Zl{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new Zl(this.g,this.h,this.m)}}function xh(e){return qi?e[qi]:void 0}var bx=Object.freeze({});function bu(e){return e.Qa=!0,e}var Mx=bu(e=>typeof e=="number"),M1=bu(e=>typeof e=="string"),Tx=bu(e=>typeof e=="boolean"),Mu=typeof li.BigInt=="function"&&typeof li.BigInt(0)=="bigint",rf=bu(e=>Mu?e>=Ix&&e<=Lx:e[0]==="-"?T1(e,Px):T1(e,Rx));const Px=Number.MIN_SAFE_INTEGER.toString(),Ix=Mu?BigInt(Number.MIN_SAFE_INTEGER):void 0,Rx=Number.MAX_SAFE_INTEGER.toString(),Lx=Mu?BigInt(Number.MAX_SAFE_INTEGER):void 0;function T1(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const Bx=typeof Uint8Array.prototype.slice=="function";let ly,ct=0,Lt=0;function P1(e){const t=e>>>0;ct=t,Lt=(e-t)/4294967296>>>0}function Zi(e){if(e<0){P1(-e);const[t,n]=Eh(ct,Lt);ct=t>>>0,Lt=n>>>0}else P1(e)}function Sh(e){const t=ly||(ly=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),Lt=0,ct=t.getUint32(0,!0)}function kh(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:wa(e,t)}function Ah(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=kh(e,t))=="number"?n?-e:e:n?"-"+e:e}function wa(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else gh()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+I1(n)+I1(e));return n}function I1(e){return e=String(e),"0000000".slice(e.length)+e}function Tu(e){if(e.length<16)Zi(Number(e));else if(gh())e=BigInt(e),ct=Number(e&BigInt(4294967295))>>>0,Lt=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");Lt=ct=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));Lt*=1e6,ct=1e6*ct+i,ct>=4294967296&&(Lt+=Math.trunc(ct/4294967296),Lt>>>=0,ct>>>=0)}if(t){const[r,s]=Eh(ct,Lt);ct=r,Lt=s}}}function Eh(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const Ch=typeof BigInt=="function"?BigInt.asIntN:void 0,Fx=typeof BigInt=="function"?BigInt.asUintN:void 0,$i=Number.isSafeInteger,Pu=Number.isFinite,eu=Math.trunc;function Gs(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function uy(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const Ox=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Iu(e){switch(typeof e){case"bigint":return!0;case"number":return Pu(e);case"string":return Ox.test(e);default:return!1}}function fo(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Pu(e)?0|e:void 0}function cy(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Pu(e)?e>>>0:void 0}function R1(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function _h(e){return e=eu(e),$i(e)||(Zi(e),e=Ah(ct,Lt)),e}function jh(e){var t=eu(Number(e));if($i(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if(Tu(e),e=ct,2147483648&(t=Lt))if(gh())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=Eh(e,t);e="-"+wa(n,r)}else e=wa(e,t);return e}function tu(e){return e==null?e:typeof e=="bigint"?(rf(e)?e=Number(e):(e=Ch(64,e),e=rf(e)?Number(e):String(e)),e):Iu(e)?typeof e=="number"?_h(e):jh(e):void 0}function $x(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(Fx(64,e));if(Iu(e)){if(t==="string")return t=eu(Number(e)),$i(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),R1(e)||(Tu(e),e=wa(ct,Lt))),e;if(t==="number")return(e=eu(e))>=0&&$i(e)?e:function(n){if(n<0){Zi(n);var r=wa(ct,Lt);return n=Number(r),$i(n)?n:r}return R1(r=String(n))?r:(Zi(n),kh(ct,Lt))}(e)}}function dy(e){if(typeof e!="string")throw Error();return e}function ho(e){if(e!=null&&typeof e!="string")throw Error();return e}function eo(e){return e==null||typeof e=="string"?e:void 0}function Nh(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===ba)return e;if(!Array.isArray(e))return n?2&r?((e=t[j1])||(co((e=new t).u),e=t[j1]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[Ne];return s===0&&(s|=32&r),s|=2&r,s!==n&&Ht(e,s),new t(e)}function Dx(e,t,n){if(t)e:{if(!Iu(t=e))throw tf("int64");switch(typeof t){case"string":t=jh(t);break e;case"bigint":if(e=t=Ch(64,t),M1(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(Mx(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=Mu?BigInt(t):Tx(t)?t?"1":"0":M1(t)?t.trim()||"0":String(t);break e;default:t=_h(t)}}else t=tu(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&$i(t=+n)?t:n}const Ux={};let zx=function(){try{return ph(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class Yc{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const Hx=zx?(Object.setPrototypeOf(Yc.prototype,Map.prototype),Object.defineProperties(Yc.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),Yc):class extends Map{constructor(){super()}};function L1(e){return e}function Xc(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var ur=class extends Hx{constructor(e,t,n=L1,r=L1){super();let s=0|e[Ne];s|=64,Ht(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?Gx:r;for(let i=0;i<e.length;i++){const a=e[i],l=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(l,d)}}na(e=B1){if(this.size!==0)return this.X(e)}X(e=B1){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){Xc(this),super.clear()}delete(e){return Xc(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new Zl(e,Wx,this)}keys(){return this.Ha()}values(){var e=this.ma();return new Zl(e,ur.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return Xc(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Gx(e,t,n,r,s,i){return e=Nh(e,r,n,i),s&&(e=Lu(e)),e}function B1(e){return e}function Wx(e){return[e,this.get(e)]}let Vx,fy,Yx;function F1(){return Vx||(Vx=new ur(co([]),void 0,void 0,void 0,Ux))}function bh(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=ql(e)?void 0:s&&2&(0|e[Ne])?e:Mh(e,t,n,r!==void 0,s);else if(vh(e)){const i={};for(let a in e)i[a]=bh(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function Mh(e,t,n,r,s){const i=r||n?0|e[Ne]:0,a=r?!!(32&i):void 0;r=Tn(e);for(let l=0;l<r.length;l++)r[l]=bh(r[l],t,n,a,s);return n&&((e=xh(e))&&(r[qi]=Tn(e)),n(i,r)),r}function Xx(e){return bh(e,hy,void 0,void 0,!1)}function hy(e){return e.W===ba?e.toJSON():e instanceof ur?e.na(Xx):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return rf(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(ql(t))return}else{if(ja(t))return C1(t);if(t instanceof rs){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=C1(n)}if(t instanceof ur)return t.na()}}return t}(e)}function py(e){return Mh(e,hy,void 0,void 0,!1)}function Rs(e,t,n){return e=my(e,t[0],t[1],n?1:2),t!==fy&&n&&Nu(e,16384),e}function my(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[Ne]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(vh(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return Ht(e,s),e}function sf(e,t,n=nf){if(e!=null){if(ey&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[Ne];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?(Ht(e,-12293&(34|r)),e):Mh(e,sf,4&r?nf:n,!0,!0))}return e.W===ba?e=2&(r=0|(n=e.u)[Ne])?e:new e.constructor(Ru(n,r,!0)):e instanceof ur&&!(2&e.L)&&(n=co(e.X(sf)),e=new ur(n,e.S,e.R,e.Y)),e}}function Ru(e,t,n){const r=n||2&t?nf:Nx,s=!!(32&t);return e=function(i,a,l){const d=Tn(i);var h=d.length;const m=256&a?d[h-1]:void 0;for(h+=m?-1:0,a=512&a?1:0;a<h;a++)d[a]=l(d[a]);if(m){a=d[a]={};for(const w in m)a[w]=l(m[w])}return(i=xh(i))&&(d[qi]=Tn(i)),d}(e,t,i=>sf(i,s,r)),Nu(e,32|(n?2:0)),e}function Lu(e){const t=e.u,n=0|t[Ne];return 2&n?new e.constructor(Ru(t,n,!1)):e}function to(e,t){return hs(e=e.u,0|e[Ne],t)}function hs(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&Vc!=null&&((s=(e=Cx??(Cx={}))[Vc]||0)>=4||(e[Vc]=s+1,sy(e=Error(),"incident"),function(a){li.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function ft(e,t,n){const r=e.u;let s=0|r[Ne];return Hs(s),jt(r,s,t,n),e}function jt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},Ht(e,t|=256)):e[i]=r),t)}function xl(e,t){let n=0|(e=e.u)[Ne];const r=hs(e,n,t),s=Gs(r);return s!=null&&s!==r&&jt(e,n,t,s),s}function gy(e){let t=0|(e=e.u)[Ne];const n=hs(e,t,1),r=wh(n,!0);return r!=null&&r!==n&&jt(e,t,1,r),r}function qs(){return bx===void 0?2:4}function Zs(e,t,n,r,s){const i=e.u,a=2&(e=0|i[Ne])?1:r;s=!!s;let l=0|(r=Th(i,e,t))[Ne];if(!(4&l)){4&l&&(r=Tn(r),l=ss(l,e),e=jt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const m=n(r[d]);m!=null&&(r[h++]=m)}h<d&&(r.length=h),l=Ph(l,e),n=-4097&(20|l),l=n&=-8193,Ht(r,l),2&l&&Object.freeze(r)}return a===1||a===4&&32&l?ts(l)||(s=l,l|=2,l!==s&&Ht(r,l),Object.freeze(r)):(a===2&&ts(l)&&(r=Tn(r),l=ss(l,e),l=Ls(l,e,s),Ht(r,l),e=jt(i,e,t,r)),ts(l)||(t=l,l=Ls(l,e,s),l!==t&&Ht(r,l))),r}function Th(e,t,n,r){return e=hs(e,t,n,r),Array.isArray(e)?e:yh}function Ph(e,t){return e===0&&(e=ss(e,t)),1|e}function ts(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function yy(e){e=Tn(e);for(let t=0;t<e.length;t++){const n=e[t]=Tn(e[t]);Array.isArray(n[1])&&(n[1]=co(n[1]))}return e}function of(e,t,n,r){let s=0|(e=e.u)[Ne];Hs(s),jt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function po(e,t,n,r,s){Hs(t);var i=!(!(64&t)&&16384&t);const a=(s=Th(e,t,n,s))!==yh;if(i||!a){let l=i=a?0|s[Ne]:0;(!a||2&l||ts(l)||4&l&&!(32&l))&&(s=Tn(s),l=ss(l,t),t=jt(e,t,n,s)),l=-13&Ph(l,t),l=Ls(r?-17&l:16|l,t,!0),l!==i&&Ht(s,l)}return s}function Kc(e,t){var n=ov;return Rh(Ih(e=e.u),e,0|e[Ne],n)===t?t:-1}function Ih(e){if(ju)return e[Io]??(e[Io]=new Map);if(Io in e)return e[Io];const t=new Map;return Object.defineProperty(e,Io,{value:t}),t}function vy(e,t,n,r){const s=Ih(e),i=Rh(s,e,t,n);return i!==r&&(i&&(t=jt(e,t,i)),s.set(n,r)),t}function Rh(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];hs(t,n,a)!=null&&(s!==0&&(n=jt(t,n,s)),s=a)}return e.set(r,s),s}function Lh(e,t,n,r){let s,i=0|e[Ne];if((r=hs(e,i,n,r))!=null&&r.W===ba)return(t=Lu(r))!==r&&jt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[Ne];s=2&a?Rs(Ru(r,a,!1),t,!0):64&a?r:Rs(s,t,!0)}else s=Rs(void 0,t,!0);return s!==r&&jt(e,i,n,s),s}function wy(e,t,n,r){let s=0|(e=e.u)[Ne];return(t=Nh(r=hs(e,s,n,r),t,!1,s))!==r&&t!=null&&jt(e,s,n,t),t}function et(e,t,n,r=!1){if((t=wy(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[Ne]))){const s=Lu(t);s!==t&&jt(e,r,n,t=s)}return t}function xy(e,t,n,r,s,i,a){e=e.u;var l=!!(2&t);const d=l?1:s;i=!!i,a&&(a=!l);var h=0|(s=Th(e,t,r))[Ne];if(!(l=!!(4&h))){var m=s,w=t;const S=!!(2&(h=Ph(h,t)));S&&(w|=2);let j=!S,L=!0,F=0,X=0;for(;F<m.length;F++){const C=Nh(m[F],n,!1,w);if(C instanceof n){if(!S){const g=!!(2&(0|C.u[Ne]));j&&(j=!g),L&&(L=g)}m[X++]=C}}X<F&&(m.length=X),h|=4,h=L?16|h:-17&h,Ht(m,h=j?8|h:-9&h),S&&Object.freeze(m)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(ts(h)&&(s=Tn(s),h=ss(h,t),t=jt(e,t,r,s)),n=s,a=h,m=0;m<n.length;m++)(h=n[m])!==(w=Lu(h))&&(n[m]=w);a|=8,Ht(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?ts(h)||(t=h,(h|=!s.length||16&h&&(!l||32&h)?2:2048)!==t&&Ht(s,h),Object.freeze(s)):(d===2&&ts(h)&&(Ht(s=Tn(s),h=Ls(h=ss(h,t),t,i)),t=jt(e,t,r,s)),ts(h)||(r=h,(h=Ls(h,t,i))!==r&&Ht(s,h))),s}function cs(e,t,n){const r=0|e.u[Ne];return xy(e,r,t,n,qs(),!1,!(2&r))}function Te(e,t,n,r){return r==null&&(r=void 0),ft(e,n,r)}function qo(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[Ne];if(Hs(s),r==null){const i=Ih(e);if(Rh(i,e,s,n)!==t)break e;i.set(n,0)}else s=vy(e,s,n,t);jt(e,s,t,r)}}function ss(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function Ls(e,t,n){return 32&t&&n||(e&=-33),e}function nu(e,t,n,r){const s=0|e.u[Ne];Hs(s),e=xy(e,s,n,t,2,!0),r=r??new n,e.push(r),e[Ne]=2&(0|r.u[Ne])?-9&e[Ne]:-17&e[Ne]}function ir(e,t){return fo(to(e,t))}function cr(e,t){return eo(to(e,t))}function Ot(e,t){return xl(e,t)??0}function xa(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);ft(e,t,n)}function Yr(e,t,n){if(n!=null){if(typeof n!="number"||!Pu(n))throw tf("int32");n|=0}ft(e,t,n)}function Ce(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);ft(e,t,n)}function ru(e,t,n){{const a=e.u;let l=0|a[Ne];if(Hs(l),n==null)jt(a,l,t);else{var r=e=0|n[Ne],s=ts(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=Tn(n),r=0,e=Ls(e=ss(e,l),l,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=dy(d);Object.is(d,h)||(i&&(n=Tn(n),r=0,e=Ls(e=ss(e,l),l,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=Tn(n),e=Ls(e=ss(e,l),l,!0)),Ht(n,e)),jt(a,l,t,n)}}}function Bu(e,t,n){Hs(0|e.u[Ne]),Zs(e,t,eo,2,!0).push(dy(n))}function Sy(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Bh(){return Error("Failed to read varint, encoding is invalid.")}function ky(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function Fh(e){if(typeof e=="string")return{buffer:ny(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===rs)return{buffer:mh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Oh(e,t){let n,r=0,s=0,i=0;const a=e.h;let l=e.g;do n=a[l++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[l++],s|=(127&n)<<i;if(ni(e,l),n<128)return t(r>>>0,s>>>0);throw Bh()}function $h(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return ni(e,n),!!(127&t)}throw Bh()}function Os(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Bh();return ni(e,n),s}function ds(e){return Os(e)>>>0}function af(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],ni(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function lf(e){var t=af(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function Kx(e){return Os(e)}function Qc(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=Fh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function ni(e,t){if(e.g=t,t>e.l)throw ky(e.l,t)}function Ay(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw ky(t,e.l-n);return e.g=r,n}function Ey(e,t){if(t==0)return ui();var n=Ay(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Bx?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?ui():new rs(n,Ji)}ur.prototype.toJSON=void 0,ur.prototype.Ia=ay;var O1=[];function Cy(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=ds(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw Sy(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function Sl(e){switch(e.h){case 0:e.h!=0?Sl(e):$h(e.g);break;case 1:ni(e=e.g,e.g+8);break;case 2:if(e.h!=2)Sl(e);else{var t=ds(e.g);ni(e=e.g,e.g+t)}break;case 5:ni(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!Cy(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}Sl(e)}break;default:throw Sy(e.h,e.l)}}function Ma(e,t,n){const r=e.g.l,s=ds(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function Dh(e){var t=ds(e.g),n=Ay(e=e.g,t);if(e=e.h,yx){var r,s=e;(r=zc)||(r=zc=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(l){if(rl===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),rl=!0}catch{rl=!1}}throw!rl&&(zc=void 0),l}}else{t=(i=n)+t,n=[];let l,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?Vs():(l=e[i++],a<194||(192&l)!=128?(i--,Vs()):n.push((31&a)<<6|63&l)):a<240?i>=t-1?Vs():(l=e[i++],(192&l)!=128||a===224&&l<160||a===237&&l>=160||(192&(r=e[i++]))!=128?(i--,Vs()):n.push((15&a)<<12|(63&l)<<6|63&r)):a<=244?i>=t-2?Vs():(l=e[i++],(192&l)!=128||l-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,Vs()):(a=(7&a)<<18|(63&l)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):Vs(),n.length>=8192&&(d=S1(d,n),n.length=0)}i=S1(d,n)}return i}function _y(e){const t=ds(e.g);return Ey(e.g,t)}function Fu(e,t,n){var r=ds(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var sl=[];function Qx(e){return e}let Di;function Nr(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var Ee=class{constructor(e,t){this.u=my(e,t)}toJSON(){const e=!Di;try{return e&&(Di=py),jy(this)}finally{e&&(Di=void 0)}}l(){var e=P5;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(Ru(e,0|e[Ne],!1))}N(){return!!(2&(0|this.u[Ne]))}};function jy(e){var t=e.u;{t=(e=Di(t))!==t;let h=e.length;if(h){var n=e[h-1],r=vh(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,l=!1;if(a)for(let m in a)isNaN(+m)?(i??(i={}))[m]=a[m]:(r=a[m],Array.isArray(r)&&(ql(r)||N1(r)&&r.size===0)&&(r=null),r==null&&(l=!0),r!=null&&((i??(i={}))[m]=r));if(l||(i=a),i)for(let m in i){l=i;break e}l=null}a=l==null?n!=null:l!==n}for(;h>0&&((i=s[h-1])==null||ql(i)||N1(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||l)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),l&&s.push(l)),d=s}else d=e}return d}function $1(e){return e?/^\d+$/.test(e)?(Tu(e),new uf(ct,Lt)):null:Jx||(Jx=new uf(0,0))}Ee.prototype.W=ba,Ee.prototype.toString=function(){try{return Di=Qx,jy(this).toString()}finally{Di=void 0}};var uf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Jx;function D1(e){return e?/^-?\d+$/.test(e)?(Tu(e),new cf(ct,Lt)):null:qx||(qx=new cf(0,0))}var cf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let qx;function Ui(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function mo(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function Ou(e,t){if(t>=0)mo(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function Sa(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function no(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function Yn(e,t,n){mo(e.g,8*t+n)}function Uh(e,t){return Yn(e,t,2),t=e.g.end(),no(e,t),t.push(e.h),t}function zh(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function $u(e,t,n){Yn(e,t,2),mo(e.g,n.length),no(e,e.g.end()),no(e,n)}function su(e,t,n,r){n!=null&&(t=Uh(e,t),r(n,e),zh(e,t))}function br(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var Hh=br(),Ny=br(),Gh=br(),Wh=br(),by=br(),My=br(),Vh=br(),Ty=br(),Py=br(),go=class{constructor(e,t,n){this.g=e,this.h=t,e=Hh,this.l=!!e&&n===e||!1}};function Du(e,t){return new go(e,t,Hh)}function Iy(e,t,n,r,s){su(e,n,Fy(t,r),s)}const Zx=Du(function(e,t,n,r,s){return e.h===2&&(Ma(e,Lh(t,r,n),s),!0)},Iy),e5=Du(function(e,t,n,r,s){return e.h===2&&(Ma(e,Lh(t,r,n,!0),s),!0)},Iy);var Uu=Symbol(),Yh=Symbol(),U1=Symbol(),z1=Symbol();let Ry,Ly;function fi(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(w){switch(typeof w){case"boolean":return fy||(fy=[0,void 0,!0]);case"number":return w>0?void 0:w===0?Yx||(Yx=[0,void 0]):[-w,void 0];case"string":return[0,w];case"object":return w}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Ry??(Ry=i),Ly??(Ly=r[a+1]),i=r[a+=2]));const l={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)l[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let w;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof go?w=i:(w=Zx,a--),w==null?void 0:w.l){i=r[++a],h=r;var m=a;typeof i=="function"&&(i=i(),h[m]=i),h=i}for(m=d+1,typeof(i=r[++a])=="number"&&i<0&&(m-=i,i=r[++a]);d<m;d++){const S=l[d];h?n(s,d,w,h,S):t(s,d,w,S)}}return r[e]=s}function By(e){return Array.isArray(e)?e[0]instanceof go?e:[e5,e]:[e,void 0]}function Fy(e,t){return e instanceof Ee?e.u:Array.isArray(e)?Rs(e,t,!1):void 0}function Xh(e,t,n,r){const s=n.g;e[t]=r?(i,a,l)=>s(i,a,l,r):s}function Kh(e,t,n,r,s){const i=n.g;let a,l;e[t]=(d,h,m)=>i(d,h,m,l||(l=fi(Yh,Xh,Kh,r).V),a||(a=Qh(r)),s)}function Qh(e){let t=e[U1];if(t!=null)return t;const n=fi(Yh,Xh,Kh,e);return t=n.la?(r,s)=>Ry(r,s,n):(r,s)=>{const i=0|r[Ne];for(;Cy(s)&&s.h!=4;){var a=s.m,l=n[a];if(l==null){var d=n.ga;d&&(d=d[a])&&(d=t5(d))!=null&&(l=n[a]=d)}l!=null&&l(s,r,a)||(a=(l=s).l,Sl(l),l.fa?l=void 0:(d=l.g.g-a,l.g.g=a,l=Ey(l.g,d)),a=r,l&&((d=a[qi])?d.push(l):a[qi]=[l]))}return 16384&i&&co(r),!0},e[U1]=t}function t5(e){const t=(e=By(e))[0].g;if(e=e[1]){const n=Qh(e),r=fi(Yh,Xh,Kh,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function zu(e,t,n){e[t]=n.h}function Hu(e,t,n,r){let s,i;const a=n.h;e[t]=(l,d,h)=>a(l,d,h,i||(i=fi(Uu,zu,Hu,r).V),s||(s=Oy(r)))}function Oy(e){let t=e[z1];if(!t){const n=fi(Uu,zu,Hu,e);t=(r,s)=>$y(r,s,n),e[z1]=t}return t}function $y(e,t,n){for(var r=0|e[Ne],s=512&r?0:-1,i=e.length,a=512&r?1:0,l=i+(256&r?-1:0);a<l;a++){const d=e[a];if(d==null)continue;const h=a-s,m=H1(n,h);m&&m(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(l=H1(n,s))&&l(t,i,s)}if(e=xh(e))for(no(t,t.g.end()),n=0;n<e.length;n++)no(t,mh(e[n])||new Uint8Array(0))}function H1(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=By(n))[0].h;if(n=n[1]){const s=Oy(n),i=fi(Uu,zu,Hu,n).V;n=e.la?Ly(i,s):(a,l,d)=>r(a,l,d,i,s)}else n=r;return e[t]=n}}function yo(e,t){if(Array.isArray(t)){var n=0|t[Ne];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),Ht(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function kn(e,t,n){return new go(e,t,n)}function vo(e,t,n){return new go(e,t,n)}function An(e,t,n){jt(e,0|e[Ne],t,n)}var n5=Du(function(e,t,n,r,s){return e.h===2&&(e=Ma(e,Rs([void 0,void 0],r,!0),s),Hs(r=0|t[Ne]),(s=hs(t,r,n))instanceof ur?2&s.L?((s=s.X()).push(e),jt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[Ne])&&jt(t,r,n,s=yy(s)),s.push(e)):jt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof ur)t.forEach((i,a)=>{su(e,n,Rs([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&su(e,n,Rs(a,r,!1),s)}});function Dy(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String(Ch(64,r));if(Iu(r)){if(s==="string")return jh(r);if(s==="number")return _h(r)}}(t),t!=null&&(typeof t=="string"&&D1(t),t!=null))switch(Yn(e,n,0),typeof t){case"number":e=e.g,Zi(t),Ui(e,ct,Lt);break;case"bigint":n=BigInt.asUintN(64,t),n=new cf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ui(e.g,n.h,n.g);break;default:n=D1(t),Ui(e.g,n.h,n.g)}}function Uy(e,t,n){(t=fo(t))!=null&&t!=null&&(Yn(e,n,0),Ou(e.g,t))}function zy(e,t,n){(t=uy(t))!=null&&(Yn(e,n,0),e.g.g.push(t?1:0))}function Hy(e,t,n){(t=eo(t))!=null&&$u(e,n,J2(t))}function Gy(e,t,n,r,s){su(e,n,Fy(t,r),s)}function Wy(e,t,n){(t=t==null||typeof t=="string"||ja(t)||t instanceof rs?t:void 0)!=null&&$u(e,n,Fh(t).buffer)}function Vy(e,t,n){return(e.h===5||e.h===2)&&(t=po(t,0|t[Ne],n,!1,!1),e.h==2?Fu(e,lf,t):t.push(lf(e.g)),!0)}var Jr=kn(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=af(r);const s=af(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,An(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Gs(t))!=null&&(Yn(e,n,1),e=e.g,(n=ly||(ly=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),ct=n.getUint32(0,!0),Lt=n.getUint32(4,!0),Sa(e,ct),Sa(e,Lt))},br()),Gt=kn(function(e,t,n){return e.h===5&&(An(t,n,lf(e.g)),!0)},function(e,t,n){(t=Gs(t))!=null&&(Yn(e,n,5),e=e.g,Sh(t),Sa(e,ct))},Vh),r5=vo(Vy,function(e,t,n){if((t=yo(Gs,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(Yn(r,s,5),r=r.g,Sh(i),Sa(r,ct))}},Vh),Jh=vo(Vy,function(e,t,n){if((t=yo(Gs,t))!=null&&t.length){Yn(e,n,2),mo(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,Sh(t[r]),Sa(n,ct)}},Vh),$s=kn(function(e,t,n){return e.h===0&&(An(t,n,Oh(e.g,Ah)),!0)},Dy,My),Jc=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Oh(e.g,Ah))===0?void 0:e),!0)},Dy,My),s5=kn(function(e,t,n){return e.h===0&&(An(t,n,Oh(e.g,kh)),!0)},function(e,t,n){if((t=$x(t))!=null&&(typeof t=="string"&&$1(t),t!=null))switch(Yn(e,n,0),typeof t){case"number":e=e.g,Zi(t),Ui(e,ct,Lt);break;case"bigint":n=BigInt.asUintN(64,t),n=new uf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ui(e.g,n.h,n.g);break;default:n=$1(t),Ui(e.g,n.h,n.g)}},br()),Bt=kn(function(e,t,n){return e.h===0&&(An(t,n,Os(e.g)),!0)},Uy,Wh),Gu=vo(function(e,t,n){return(e.h===0||e.h===2)&&(t=po(t,0|t[Ne],n,!1,!1),e.h==2?Fu(e,Os,t):t.push(Os(e.g)),!0)},function(e,t,n){if((t=yo(fo,t))!=null&&t.length){n=Uh(e,n);for(let r=0;r<t.length;r++)Ou(e.g,t[r]);zh(e,n)}},Wh),Ti=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Os(e.g))===0?void 0:e),!0)},Uy,Wh),kt=kn(function(e,t,n){return e.h===0&&(An(t,n,$h(e.g)),!0)},zy,Ny),zi=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=$h(e.g))===!1?void 0:e),!0)},zy,Ny),cn=vo(function(e,t,n){return e.h===2&&(e=Dh(e),po(t,0|t[Ne],n,!1).push(e),!0)},function(e,t,n){if((t=yo(eo,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&$u(r,s,J2(i))}},Gh),As=kn(function(e,t,n){return e.h===2&&(An(t,n,(e=Dh(e))===""?void 0:e),!0)},Hy,Gh),it=kn(function(e,t,n){return e.h===2&&(An(t,n,Dh(e)),!0)},Hy,Gh),Yt=function(e,t,n=Hh){return new go(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=Rs(void 0,r,!0),po(t,0|t[Ne],n,!0).push(r),Ma(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)Gy(e,t[i],n,r,s)}),ot=Du(function(e,t,n,r,s,i){return e.h===2&&(vy(t,0|t[Ne],i,n),Ma(e,t=Lh(t,r,n),s),!0)},Gy),Yy=kn(function(e,t,n){return e.h===2&&(An(t,n,_y(e)),!0)},Wy,Ty),i5=vo(function(e,t,n){return(e.h===0||e.h===2)&&(t=po(t,0|t[Ne],n,!1,!1),e.h==2?Fu(e,ds,t):t.push(ds(e.g)),!0)},function(e,t,n){if((t=yo(cy,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(Yn(r,s,0),mo(r.g,i))}},by),o5=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=ds(e.g))===0?void 0:e),!0)},function(e,t,n){(t=cy(t))!=null&&t!=null&&(Yn(e,n,0),mo(e.g,t))},by),dr=kn(function(e,t,n){return e.h===0&&(An(t,n,Os(e.g)),!0)},function(e,t,n){(t=fo(t))!=null&&(t=parseInt(t,10),Yn(e,n,0),Ou(e.g,t))},Py);class a5{constructor(t,n){this.h=t,this.g=n,this.l=et,this.m=Te,this.defaultValue=void 0}}function Mr(e,t){return new a5(e,t)}function Ws(e,t){return(n,r)=>{if(sl.length){const i=sl.pop();i.o(r),Qc(i.g,n,r),n=i}else n=new class{constructor(i,a){if(O1.length){const l=O1.pop();Qc(l,i,a),i=l}else i=new class{constructor(l,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,Qc(this,l,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;Qh(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,sl.length<100&&sl.push(n)}return s}}function Wu(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};$y(this.u,t,fi(Uu,zu,Hu,e)),no(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const l=r[a];n.set(l,i),i+=l.length}return t.l=[n],n}}var G1=class extends Ee{constructor(e){super(e)}},W1=[0,As,kn(function(e,t,n){return e.h===2&&(An(t,n,(e=_y(e))===ui()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof Ee){const r=t.Ra;return void(r&&(t=r(t),t!=null&&$u(e,n,Fh(t).buffer)))}if(Array.isArray(t))return}Wy(e,t,n)},Ty)];let qc,V1=globalThis.trustedTypes;function Y1(e){qc===void 0&&(qc=function(){let n=null;if(!V1)return n;try{const r=s=>s;n=V1.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=qc;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function l5(e,...t){if(t.length===0)return Y1(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return Y1(n)}var Xy=[0,Bt,dr,kt,-1,Gu,dr,-1],u5=class extends Ee{constructor(e){super(e)}},Ky=[0,kt,it,kt,dr,-1,vo(function(e,t,n){return(e.h===0||e.h===2)&&(t=po(t,0|t[Ne],n,!1,!1),e.h==2?Fu(e,Kx,t):t.push(Os(e.g)),!0)},function(e,t,n){if((t=yo(fo,t))!=null&&t.length){n=Uh(e,n);for(let r=0;r<t.length;r++)Ou(e.g,t[r]);zh(e,n)}},Py),it,-1,[0,kt,-1],dr,kt,-1],Qy=[0,it,-2],X1=class extends Ee{constructor(e){super(e)}},Jy=[0],qy=[0,Bt,kt,1,kt,-3],Gn=class extends Ee{constructor(e){super(e,2)}},Wt={};Wt[336783863]=[0,it,kt,-1,Bt,[0,[1,2,3,4,5,6,7,8],ot,Jy,ot,Ky,ot,Qy,ot,qy,ot,Xy,ot,[0,it,-2],ot,[0,it,dr],ot,[0,dr,it]],[0,it],kt,[0,[1,3],[2,4],ot,[0,Gu],-1,ot,[0,cn],-1,Yt,[0,it,-1]],it];var K1=[0,Jc,-1,zi,-3,Jc,Gu,As,Ti,Jc,-1,zi,Ti,zi,-2,As];function Xn(e,t){of(e,2,ho(t),"")}function pt(e,t){Bu(e,3,t)}function Je(e,t){Bu(e,4,t)}var wn=class extends Ee{constructor(e){super(e,500)}o(e){return Te(this,0,7,e)}},Zo=[-1,{}],Q1=[0,it,1,Zo],J1=[0,it,cn,Zo];function Kn(e,t){nu(e,1,wn,t)}function wt(e,t){Bu(e,10,t)}function rt(e,t){Bu(e,15,t)}var In=class extends Ee{constructor(e){super(e,500)}o(e){return Te(this,0,1001,e)}},Zy=[-500,Yt,[-500,As,-1,cn,-3,[-2,Wt,kt],Yt,W1,Ti,-1,Q1,J1,Yt,[0,As,zi],As,K1,Ti,cn,987,cn],4,Yt,[-500,it,-1,[-1,{}],998,it],Yt,[-500,it,cn,-1,[-2,{},kt],997,cn,-1],Ti,Yt,[-500,it,cn,Zo,998,cn],cn,Ti,Q1,J1,Yt,[0,As,-1,Zo],cn,-2,K1,As,-1,zi,[0,zi,o5],978,Zo,Yt,W1];In.prototype.g=Wu(Zy);var c5=Ws(In,Zy),d5=class extends Ee{constructor(e){super(e)}},ev=class extends Ee{constructor(e){super(e)}g(){return cs(this,d5,1)}},tv=[0,Yt,[0,Bt,Gt,it,-1]],Vu=Ws(ev,tv),f5=class extends Ee{constructor(e){super(e)}},h5=class extends Ee{constructor(e){super(e)}},Zc=class extends Ee{constructor(e){super(e)}h(){return et(this,f5,2)}g(){return cs(this,h5,5)}},nv=Ws(class extends Ee{constructor(e){super(e)}},[0,cn,Gu,Jh,[0,dr,[0,Bt,-3],[0,Gt,-3],[0,Bt,-1,[0,Yt,[0,Bt,-2]]],Yt,[0,Gt,-1,it,Gt]],it,-1,$s,Yt,[0,Bt,Gt],cn,$s]),rv=class extends Ee{constructor(e){super(e)}},Hi=Ws(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,Gt,-4]]),sv=class extends Ee{constructor(e){super(e)}},Ta=Ws(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,Gt,-4]]),p5=class extends Ee{constructor(e){super(e)}},m5=[0,Bt,-1,Jh,dr],iv=class extends Ee{constructor(e){super(e)}};iv.prototype.g=Wu([0,Gt,-4,$s]);var g5=class extends Ee{constructor(e){super(e)}},y5=Ws(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,1,Bt,it,tv],$s]),q1=class extends Ee{constructor(e){super(e)}},v5=class extends Ee{constructor(e){super(e)}oa(){const e=gy(this);return e??ui()}},w5=class extends Ee{constructor(e){super(e)}},ov=[1,2],x5=Ws(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,ov,ot,[0,Jh],ot,[0,Yy],Bt,it],$s]),qh=class extends Ee{constructor(e){super(e)}},av=[0,it,Bt,Gt,cn,-1],Z1=class extends Ee{constructor(e){super(e)}},S5=[0,kt,-1],e0=class extends Ee{constructor(e){super(e)}},kl=[1,2,3,4,5],iu=class extends Ee{constructor(e){super(e)}g(){return gy(this)!=null}h(){return cr(this,2)!=null}},At=class extends Ee{constructor(e){super(e)}g(){return uy(to(this,2))??!1}},lv=[0,Yy,it,[0,Bt,$s,-1],[0,s5,$s]],Dt=[0,lv,kt,[0,kl,ot,qy,ot,Ky,ot,Xy,ot,Jy,ot,Qy],dr],Yu=class extends Ee{constructor(e){super(e)}},Zh=[0,Dt,Gt,-1,Bt],k5=Mr(502141897,Yu);Wt[502141897]=Zh;var A5=Ws(class extends Ee{constructor(e){super(e)}},[0,[0,dr,-1,r5,i5],m5]),uv=class extends Ee{constructor(e){super(e)}},cv=class extends Ee{constructor(e){super(e)}},ep=[0,Dt,Gt,[0,Dt],kt],dv=[0,Dt,Zh,ep,Gt,[0,[0,lv]]],E5=Mr(508968150,cv);Wt[508968150]=dv,Wt[508968149]=ep;var fv=class extends Ee{constructor(e){super(e)}},C5=Mr(513916220,fv);Wt[513916220]=[0,Dt,dv,Bt];var gi=class extends Ee{constructor(e){super(e)}h(){return et(this,qh,2)}g(){ft(this,2)}},hv=[0,Dt,av];Wt[478825465]=hv;var _5=class extends Ee{constructor(e){super(e)}},pv=class extends Ee{constructor(e){super(e)}},tp=class extends Ee{constructor(e){super(e)}},np=class extends Ee{constructor(e){super(e)}},mv=class extends Ee{constructor(e){super(e)}},t0=[0,Dt,[0,Dt],hv,-1],gv=[0,Dt,Gt,Bt],rp=[0,Dt,Gt],yv=[0,Dt,gv,rp,Gt],j5=Mr(479097054,mv);Wt[479097054]=[0,Dt,yv,t0],Wt[463370452]=t0,Wt[464864288]=gv;var N5=Mr(462713202,np);Wt[462713202]=yv,Wt[474472470]=rp;var b5=class extends Ee{constructor(e){super(e)}},vv=class extends Ee{constructor(e){super(e)}},wv=class extends Ee{constructor(e){super(e)}},xv=class extends Ee{constructor(e){super(e)}},sp=[0,Dt,Gt,-1,Bt],df=[0,Dt,Gt,kt];xv.prototype.g=Wu([0,Dt,rp,[0,Dt],Zh,ep,sp,df]);var Sv=class extends Ee{constructor(e){super(e)}},M5=Mr(456383383,Sv);Wt[456383383]=[0,Dt,av];var kv=class extends Ee{constructor(e){super(e)}},T5=Mr(476348187,kv);Wt[476348187]=[0,Dt,S5];var Av=class extends Ee{constructor(e){super(e)}},n0=class extends Ee{constructor(e){super(e)}},Ev=[0,dr,-1],P5=Mr(458105876,class extends Ee{constructor(e){super(e)}g(){var e=this.u;const t=0|e[Ne],n=2&t;return e=function(r,s,i){var a=n0;const l=2&s;let d=!1;if(i==null){if(l)return F1();i=[]}else if(i.constructor===ur){if(!(2&i.L)||l)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[Ne])):i=[];if(l){if(!i.length)return F1();d||(d=!0,co(i))}else d&&(d=!1,i=yy(i));return d||(64&(0|i[Ne])?i[Ne]&=-33:32&s&&Nu(i,32)),jt(r,s,2,a=new ur(i,a,Dx,void 0)),a}(e,t,hs(e,t,2)),!n&&n0&&(e.ra=!0),e}});Wt[458105876]=[0,Ev,n5,[!0,$s,[0,it,-1,cn]]];var ip=class extends Ee{constructor(e){super(e)}},Cv=Mr(458105758,ip);Wt[458105758]=[0,Dt,it,Ev];var _v=class extends Ee{constructor(e){super(e)}},I5=Mr(443442058,_v);Wt[443442058]=[0,Dt,it,Bt,Gt,cn,-1,kt,Gt],Wt[514774813]=sp;var jv=class extends Ee{constructor(e){super(e)}},R5=Mr(516587230,jv);function ff(e,t){return t=t?t.clone():new qh,e.displayNamesLocale!==void 0?ft(t,1,ho(e.displayNamesLocale)):e.displayNamesLocale===void 0&&ft(t,1),e.maxResults!==void 0?Yr(t,2,e.maxResults):"maxResults"in e&&ft(t,2),e.scoreThreshold!==void 0?Ce(t,3,e.scoreThreshold):"scoreThreshold"in e&&ft(t,3),e.categoryAllowlist!==void 0?ru(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&ft(t,4),e.categoryDenylist!==void 0?ru(t,5,e.categoryDenylist):"categoryDenylist"in e&&ft(t,5),t}function op(e,t=-1,n=""){return{categories:e.map(r=>({index:ir(r,1)??0??-1,score:Ot(r,2)??0,categoryName:cr(r,3)??""??"",displayName:cr(r,4)??""??""})),headIndex:t,headName:n}}function Nv(e){var a,l;var t=Zs(e,3,Gs,qs()),n=Zs(e,2,fo,qs()),r=Zs(e,1,eo,qs()),s=Zs(e,9,eo,qs());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=et(e,Zc,4))==null?void 0:a.h())&&(i.boundingBox={originX:ir(t,1)??0,originY:ir(t,2)??0,width:ir(t,3)??0,height:ir(t,4)??0,angle:0}),(l=et(e,Zc,4))==null?void 0:l.g().length)for(const d of et(e,Zc,4).g())i.keypoints.push({x:xl(d,1)??0,y:xl(d,2)??0,score:xl(d,4)??0,label:cr(d,3)??""});return i}function Xu(e){const t=[];for(const n of cs(e,sv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function ea(e){const t=[];for(const n of cs(e,rv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function r0(e){return Array.from(e,t=>t>127?t-256:t)}function s0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let il;Wt[516587230]=[0,Dt,sp,df,Gt],Wt[518928384]=df;const L5=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function bv(){if(il===void 0)try{await WebAssembly.instantiate(L5),il=!0}catch{il=!1}return il}async function Ro(e,t=l5``){const n=await bv()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var ws=class{};function Mv(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function i0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function Tv(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function je(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function o0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=Tv(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function a0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function $r(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function gs(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}ws.forVisionTasks=function(e){return Ro("vision",e)},ws.forTextTasks=function(e){return Ro("text",e)},ws.forGenAiExperimentalTasks=function(e){return Ro("genai_experimental",e)},ws.forGenAiTasks=function(e){return Ro("genai",e)},ws.forAudioTasks=function(e){return Ro("audio",e)},ws.isSimdSupported=function(){return bv()};async function B5(e,t,n,r){return e=await(async(s,i,a,l,d)=>{if(i&&await i0(i),!self.ModuleFactory||a&&(await i0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,l)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function ed(e,t){const n=et(e.baseOptions,iu,1)||new iu;typeof t=="string"?(ft(n,2,ho(t)),ft(n,1)):t instanceof Uint8Array&&(ft(n,1,wh(t,!1)),ft(n,2)),Te(e.baseOptions,0,1,n)}function l0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function Ae(e,t){e.B=Math.max(e.B,t)}function Ku(e,t){e.A=new wn,Xn(e.A,"PassThroughCalculator"),pt(e.A,"free_memory"),Je(e.A,"free_memory_unused_out"),wt(t,"free_memory"),Kn(t,e.A)}function ro(e,t){pt(e.A,t),Je(e.A,t+"_unused_out")}function Qu(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var Al=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,l;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=et(this.baseOptions,iu,1))!=null&&s.g()||(i=et(this.baseOptions,iu,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(l=e.baseOptions)!=null&&l.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,m){let w=et(h.baseOptions,e0,3);if(!w){var S=w=new e0,j=new X1;qo(S,4,kl,j)}"delegate"in m&&(m.delegate==="GPU"?(m=w,S=new u5,qo(m,2,kl,S)):(m=w,S=new X1,qo(m,4,kl,S))),Te(h.baseOptions,0,3,w)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),ed(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)ed(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const m=[];for(var w=0;;){const{done:S,value:j}=await h.read();if(S)break;m.push(j),w+=j.length}if(m.length===0)return new Uint8Array(0);if(m.length===1)return m[0];h=new Uint8Array(w),w=0;for(const S of m)h.set(S,w),w+=S.length;return h}(d.modelAssetBuffer).then(h=>{ed(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=c5(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,l0(this)}finishProcessing(){this.g.finishProcessing(),l0(this)}close(){this.A=void 0,this.g.closeGraph()}};function is(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Al.prototype.close=Al.prototype.close,function(e,t){e=e.split(".");var n,r=li;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",Al);class F5{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function u0(e,t,n){const r=e.g;if(n=is(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function c0(e,t){const n=e.g,r=is(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=is(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=is(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new F5(n,r,s,i)}function ap(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function lp(e,t,n,r){return ap(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=c0(e,!0)),n=e.s):(e.v||(e.v=c0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function Ju(e,t,n){return ap(e,t),e=is(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function qu(e,t,n){ap(e,t),e.A||(e.A=is(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function up(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var cp=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=is(e.createProgram(),"Failed to create WebGL program"),this.aa=u0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=u0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function qr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function hf(e){var t=qr(e,1);if(!t){if(t=qr(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=so(e);var n=dp(e);if(qu(n,r,Pv(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function Pv(e){let t=qr(e,2);if(!t){const n=so(e);t=Rv(e);const r=hf(e),s=Iv(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),pf(e)}return t}function so(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=is(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Iv(e){if(e=so(e),!ol)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))ol=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");ol=e.R16F}return ol}function dp(e){return e.l||(e.l=new cp),e.l}function Rv(e){const t=so(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=qr(e,2);return n||(n=Ju(dp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function pf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var ol,Qt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--d0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!qr(this,0)}ja(){return!!qr(this,1)}P(){return!!qr(this,2)}ia(){return(t=qr(e=this,0))||(t=hf(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return hf(this)}M(){return Pv(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=so(this),s=dp(this);r.activeTexture(r.TEXTURE1),n=Ju(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=Iv(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),qu(s,r,n),lp(s,r,!1,()=>{Rv(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),pf(this)}),up(s),pf(this)}}e.push(n)}return new Qt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&so(this).deleteTexture(qr(this,2)),d0=-1}};Qt.prototype.close=Qt.prototype.close,Qt.prototype.clone=Qt.prototype.clone,Qt.prototype.getAsWebGLTexture=Qt.prototype.M,Qt.prototype.getAsFloat32Array=Qt.prototype.ha,Qt.prototype.getAsUint8Array=Qt.prototype.ia,Qt.prototype.hasWebGLTexture=Qt.prototype.P,Qt.prototype.hasFloat32Array=Qt.prototype.ja,Qt.prototype.hasUint8Array=Qt.prototype.Fa;var d0=250;function Hr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function Lv(e){var t=Hr(e,0);if(!t){t=io(e);const n=Zu(e),r=new Uint8Array(e.width*e.height*4);qu(n,t,El(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),up(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function El(e){let t=Hr(e,2);if(!t){const n=io(e);t=Cl(e);const r=Hr(e,1)||Lv(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),Uo(e)}return t}function io(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=is(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Zu(e){return e.l||(e.l=new cp),e.l}function Cl(e){const t=io(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Hr(e,2);return n||(n=Ju(Zu(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Uo(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function f0(e){const t=io(e);return lp(Zu(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var Jt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--h0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Hr(this,0)}ka(){return!!Hr(this,1)}P(){return!!Hr(this,2)}Ca(){return Lv(this)}Ba(){var e=Hr(this,1);return e||(El(this),Cl(this),e=f0(this),Uo(this),this.g.push(e),this.j=!0),e}M(){return El(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=io(this),s=Zu(this);r.activeTexture(r.TEXTURE1),n=Ju(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),qu(s,r,n),lp(s,r,!1,()=>{Cl(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Uo(this)}),up(s),Uo(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);El(this),Cl(this),n=f0(this),Uo(this)}e.push(n)}return new Jt(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Hr(this,1).close(),this.m&&io(this).deleteTexture(Hr(this,2)),h0=-1}};Jt.prototype.close=Jt.prototype.close,Jt.prototype.clone=Jt.prototype.clone,Jt.prototype.getAsWebGLTexture=Jt.prototype.M,Jt.prototype.getAsImageBitmap=Jt.prototype.Ba,Jt.prototype.getAsImageData=Jt.prototype.Ca,Jt.prototype.hasWebGLTexture=Jt.prototype.P,Jt.prototype.hasImageBitmap=Jt.prototype.ka,Jt.prototype.hasImageData=Jt.prototype.Ea;var h0=250;function Tr(...e){return e.map(([t,n])=>({start:t,end:n}))}const O5=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((p0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:Mv()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),je(this,r||"input_audio",i=>{je(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){$r(this,"__graph_config__",t=>{e(t)}),je(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),je(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){je(this,t,r=>{const[s,i]=o0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){je(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){je(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){je(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){je(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){je(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){je(this,t,r=>{je(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){je(this,t,r=>{a0(this,Object.keys(e),s=>{a0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){je(this,n,s=>{je(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){je(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)je(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){je(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){je(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){je(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){je(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){je(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){je(this,t,n=>{je(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){je(this,n,r=>{je(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)je(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){$r(this,e,t),je(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){gs(this,e,t),je(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){$r(this,e,t),je(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){gs(this,e,t),je(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){$r(this,e,t),je(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){gs(this,e,t),je(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){$r(this,e,t),je(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){gs(this,e,t),je(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){$r(this,e,t),je(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){gs(this,e,t),je(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){$r(this,e,t),je(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){gs(this,e,t),je(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){$r(this,e,t),je(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){gs(this,e,t),je(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),$r(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),je(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends p0{get ea(){return this.i}qa(e,t,n){je(this,t,r=>{const[s,i]=o0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){$r(this,e,t),je(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){gs(this,e,t),je(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var p0,fr=class extends O5{};async function Ke(e,t,n){return async function(r,s,i,a){return B5(r,s,i,a)}(e,n.canvas??(Mv()?void 0:document.createElement("canvas")),t,n)}function Bv(e,t,n,r){if(e.T){const i=new iv;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");Ce(i,1,(s.left+s.right)/2),Ce(i,2,(s.top+s.bottom)/2),Ce(i,4,s.right-s.left),Ce(i,3,s.bottom-s.top)}else Ce(i,1,.5),Ce(i,2,.5),Ce(i,4,1),Ce(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(Ce(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,l]=Tv(t);n=Ot(i,3)*l/a,s=Ot(i,4)*a/l,Ce(i,4,n),Ce(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function hr(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Bv(e,t,n,e.B+1)}function Xr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Bv(e,t,n,r)}function oo(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new Qt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Pn=class extends Al{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new cp}l(e,t=!0){if("runningMode"in e&&xa(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Pn.prototype.close=Pn.prototype.close;var qn=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Te(e=this.h=new Yu,0,1,t=new At),Ce(this.h,2,.5),Ce(this.h,3,.3)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&Ce(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&Ce(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},hr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Xr(this,e,n,t),this.j}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect_in"),rt(e,"detections");const t=new Gn;Nr(t,k5,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect_in"),Je(n,"DETECTIONS:detections"),n.o(t),Kn(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=nv(i),this.j.detections.push(Nv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};qn.prototype.detectForVideo=qn.prototype.F,qn.prototype.detect=qn.prototype.D,qn.prototype.setOptions=qn.prototype.o,qn.createFromModelPath=async function(e,t){return Ke(qn,e,{baseOptions:{modelAssetPath:t}})},qn.createFromModelBuffer=function(e,t){return Ke(qn,e,{baseOptions:{modelAssetBuffer:t}})},qn.createFromOptions=function(e,t){return Ke(qn,e,t)};var fp=Tr([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),hp=Tr([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),pp=Tr([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),Fv=Tr([474,475],[475,476],[476,477],[477,474]),mp=Tr([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),gp=Tr([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Ov=Tr([469,470],[470,471],[471,472],[472,469]),yp=Tr([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),$v=[...fp,...hp,...pp,...mp,...gp,...yp],Dv=Tr([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function m0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var It=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Te(e=this.h=new cv,0,1,t=new At),this.v=new uv,Te(this.h,0,3,this.v),this.s=new Yu,Te(this.h,0,2,this.s),Yr(this.s,4,1),Ce(this.s,2,.5),Ce(this.v,2,.5),Ce(this.h,4,.5)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numFaces"in e&&Yr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&Ce(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&Ce(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&Ce(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return m0(this),hr(this,e,t),this.j}F(e,t,n){return m0(this),Xr(this,e,n,t),this.j}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"face_landmarks");const t=new Gn;Nr(t,E5,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),Kn(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=Ta(i),this.j.faceLandmarks.push(Xu(r));Ae(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{Ae(this,r)}),this.outputFaceBlendshapes&&(rt(e,"blendshapes"),Je(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=Vu(i),this.j.faceBlendshapes.push(op(r.g()??[]));Ae(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{Ae(this,r)})),this.outputFacialTransformationMatrixes&&(rt(e,"face_geometry"),Je(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=et(A5(i),p5,2))&&this.j.facialTransformationMatrixes.push({rows:ir(r,1)??0??0,columns:ir(r,2)??0??0,data:Zs(r,3,Gs,qs()).slice()??[]});Ae(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};It.prototype.detectForVideo=It.prototype.F,It.prototype.detect=It.prototype.D,It.prototype.setOptions=It.prototype.o,It.createFromModelPath=function(e,t){return Ke(It,e,{baseOptions:{modelAssetPath:t}})},It.createFromModelBuffer=function(e,t){return Ke(It,e,{baseOptions:{modelAssetBuffer:t}})},It.createFromOptions=function(e,t){return Ke(It,e,t)},It.FACE_LANDMARKS_LIPS=fp,It.FACE_LANDMARKS_LEFT_EYE=hp,It.FACE_LANDMARKS_LEFT_EYEBROW=pp,It.FACE_LANDMARKS_LEFT_IRIS=Fv,It.FACE_LANDMARKS_RIGHT_EYE=mp,It.FACE_LANDMARKS_RIGHT_EYEBROW=gp,It.FACE_LANDMARKS_RIGHT_IRIS=Ov,It.FACE_LANDMARKS_FACE_OVAL=yp,It.FACE_LANDMARKS_CONTOURS=$v,It.FACE_LANDMARKS_TESSELATION=Dv;var Dr=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect",!0),Te(e=this.j=new fv,0,1,t=new At)}get baseOptions(){return et(this.j,At,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,hr(this,e,r??{}),!this.h)return this.s}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"stylized_image");const t=new Gn;Nr(t,C5,this.j);const n=new wn;Xn(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),Kn(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,l=r.width;const d=l*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let m=0;m<d;++m)h[4*m]=a[3*m],h[4*m+1]=a[3*m+1],h[4*m+2]=a[3*m+2],h[4*m+3]=255;a=new ImageData(h,l,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),l,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);l=new Jt([a],!1,!1,this.g.i.canvas,this.O,l,r),this.s=i=i?l.clone():l,this.h&&this.h(i),Ae(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Dr.prototype.stylize=Dr.prototype.Oa,Dr.prototype.setOptions=Dr.prototype.o,Dr.createFromModelPath=function(e,t){return Ke(Dr,e,{baseOptions:{modelAssetPath:t}})},Dr.createFromModelBuffer=function(e,t){return Ke(Dr,e,{baseOptions:{modelAssetBuffer:t}})},Dr.createFromOptions=function(e,t){return Ke(Dr,e,t)};var vp=Tr([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function g0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function y0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function v0(e,t=!0){const n=[];for(const s of e){var r=Vu(s);e=[];for(const i of r.g())r=t&&ir(i,1)!=null?ir(i,1)??0:-1,e.push({score:Ot(i,2)??0,index:r,categoryName:cr(i,3)??""??"",displayName:cr(i,4)??""??""});n.push(e)}return n}var Bn=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Te(e=this.j=new mv,0,1,t=new At),this.s=new np,Te(this.j,0,2,this.s),this.C=new tp,Te(this.s,0,3,this.C),this.v=new pv,Te(this.s,0,2,this.v),this.h=new _5,Te(this.j,0,3,this.h),Ce(this.v,2,.5),Ce(this.s,4,.5),Ce(this.C,2,.5)}get baseOptions(){return et(this.j,At,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){var s,i,a,l;if(Yr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&Ce(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Ce(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Ce(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new gi,n=t,r=ff(e.cannedGesturesClassifierOptions,(s=et(this.h,gi,3))==null?void 0:s.h());Te(n,0,2,r),Te(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=et(this.h,gi,3))==null||i.g());return e.customGesturesClassifierOptions?(Te(n=t=new gi,0,2,r=ff(e.customGesturesClassifierOptions,(a=et(this.h,gi,4))==null?void 0:a.h())),Te(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((l=et(this.h,gi,4))==null||l.g()),this.l(e)}Ja(e,t){return g0(this),hr(this,e,t),y0(this)}Ka(e,t,n){return g0(this),Xr(this,e,n,t),y0(this)}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"hand_gestures"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Gn;Nr(t,j5,this.j);const n=new wn;Xn(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"HAND_GESTURES:hand_gestures"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),Kn(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=Ta(i);const a=[];for(const l of cs(r,sv,1))a.push({x:Ot(l,1)??0,y:Ot(l,2)??0,z:Ot(l,3)??0,visibility:Ot(l,4)??0});this.landmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=Hi(i);const a=[];for(const l of cs(r,rv,1))a.push({x:Ot(l,1)??0,y:Ot(l,2)??0,z:Ot(l,3)??0,visibility:Ot(l,4)??0});this.worldLandmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...v0(r,!1)),Ae(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...v0(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function w0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Bn.prototype.recognizeForVideo=Bn.prototype.Ka,Bn.prototype.recognize=Bn.prototype.Ja,Bn.prototype.setOptions=Bn.prototype.o,Bn.createFromModelPath=function(e,t){return Ke(Bn,e,{baseOptions:{modelAssetPath:t}})},Bn.createFromModelBuffer=function(e,t){return Ke(Bn,e,{baseOptions:{modelAssetBuffer:t}})},Bn.createFromOptions=function(e,t){return Ke(Bn,e,t)},Bn.HAND_CONNECTIONS=vp;var Fn=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Te(e=this.h=new np,0,1,t=new At),this.s=new tp,Te(this.h,0,3,this.s),this.j=new pv,Te(this.h,0,2,this.j),Yr(this.j,3,1),Ce(this.j,2,.5),Ce(this.s,2,.5),Ce(this.h,4,.5)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numHands"in e&&Yr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&Ce(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Ce(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Ce(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],hr(this,e,t),w0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Xr(this,e,n,t),w0(this)}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Gn;Nr(t,N5,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),Kn(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=Ta(i),this.landmarks.push(Xu(r));Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=Hi(i),this.worldLandmarks.push(ea(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const l=[];for(const d of r){r=Vu(d);const h=[];for(const m of r.g())h.push({score:Ot(m,2)??0,index:ir(m,1)??0??-1,categoryName:cr(m,3)??""??"",displayName:cr(m,4)??""??""});l.push(h)}a.call(i,...l),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Fn.prototype.detectForVideo=Fn.prototype.F,Fn.prototype.detect=Fn.prototype.D,Fn.prototype.setOptions=Fn.prototype.o,Fn.createFromModelPath=function(e,t){return Ke(Fn,e,{baseOptions:{modelAssetPath:t}})},Fn.createFromModelBuffer=function(e,t){return Ke(Fn,e,{baseOptions:{modelAssetBuffer:t}})},Fn.createFromOptions=function(e,t){return Ke(Fn,e,t)},Fn.HAND_CONNECTIONS=vp;var Uv=Tr([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function x0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function S0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{Qu(e)}}function al(e,t){e=Ta(e),t.push(Xu(e))}var xt=class extends Pn{constructor(e,t){super(new fr(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Te(e=this.j=new xv,0,1,t=new At),this.J=new tp,Te(this.j,0,2,this.J),this.Z=new b5,Te(this.j,0,3,this.Z),this.s=new Yu,Te(this.j,0,4,this.s),this.H=new uv,Te(this.j,0,5,this.H),this.v=new vv,Te(this.j,0,6,this.v),this.K=new wv,Te(this.j,0,7,this.K),Ce(this.s,2,.5),Ce(this.s,3,.3),Ce(this.H,2,.5),Ce(this.v,2,.5),Ce(this.v,3,.3),Ce(this.K,2,.5),Ce(this.J,2,.5)}get baseOptions(){return et(this.j,At,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&Ce(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&Ce(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&Ce(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&Ce(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&Ce(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&Ce(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&Ce(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,x0(this),hr(this,e,r),S0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,x0(this),Xr(this,e,s,t),S0(this)}m(){var e=new In;wt(e,"input_frames_image"),rt(e,"pose_landmarks"),rt(e,"pose_world_landmarks"),rt(e,"face_landmarks"),rt(e,"left_hand_landmarks"),rt(e,"left_hand_world_landmarks"),rt(e,"right_hand_landmarks"),rt(e,"right_hand_world_landmarks");const t=new Gn,n=new G1;of(n,1,ho("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))ft(s,2,py(i));else{if(!(typeof i=="string"||i instanceof rs||ja(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");of(s,2,wh(i,!1),ui())}}(n,this.j.g());const r=new wn;Xn(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),nu(r,8,G1,n),pt(r,"IMAGE:input_frames_image"),Je(r,"POSE_LANDMARKS:pose_landmarks"),Je(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Je(r,"FACE_LANDMARKS:face_landmarks"),Je(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Je(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Je(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Je(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),Kn(e,r),Ku(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{al(s,this.h.poseLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=Hi(s),a.push(ea(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{Ae(this,s)}),this.outputPoseSegmentationMasks&&(Je(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),ro(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[oo(this,s,!0,!this.C)],Ae(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],Ae(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{al(s,this.h.faceLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{Ae(this,s)}),this.outputFaceBlendshapes&&(rt(e,"extra_blendshapes"),Je(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=Vu(s),a.push(op(s.g()??[]))),Ae(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{Ae(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{al(s,this.h.leftHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=Hi(s),a.push(ea(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{al(s,this.h.rightHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=Hi(s),a.push(ea(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{Ae(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};xt.prototype.detectForVideo=xt.prototype.F,xt.prototype.detect=xt.prototype.D,xt.prototype.setOptions=xt.prototype.o,xt.createFromModelPath=function(e,t){return Ke(xt,e,{baseOptions:{modelAssetPath:t}})},xt.createFromModelBuffer=function(e,t){return Ke(xt,e,{baseOptions:{modelAssetBuffer:t}})},xt.createFromOptions=function(e,t){return Ke(xt,e,t)},xt.HAND_CONNECTIONS=vp,xt.POSE_CONNECTIONS=Uv,xt.FACE_LANDMARKS_LIPS=fp,xt.FACE_LANDMARKS_LEFT_EYE=hp,xt.FACE_LANDMARKS_LEFT_EYEBROW=pp,xt.FACE_LANDMARKS_LEFT_IRIS=Fv,xt.FACE_LANDMARKS_RIGHT_EYE=mp,xt.FACE_LANDMARKS_RIGHT_EYEBROW=gp,xt.FACE_LANDMARKS_RIGHT_IRIS=Ov,xt.FACE_LANDMARKS_FACE_OVAL=yp,xt.FACE_LANDMARKS_CONTOURS=$v,xt.FACE_LANDMARKS_TESSELATION=Dv;var Zn=class extends Pn{constructor(e,t){super(new fr(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Te(e=this.h=new Sv,0,1,t=new At)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return Te(this.h,0,2,ff(e,et(this.h,qh,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},hr(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},Xr(this,e,n,t),this.j}m(){var e=new In;wt(e,"input_image"),wt(e,"norm_rect"),rt(e,"classifications");const t=new Gn;Nr(t,M5,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),pt(n,"IMAGE:input_image"),pt(n,"NORM_RECT:norm_rect"),Je(n,"CLASSIFICATIONS:classifications"),n.o(t),Kn(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:cs(i,g5,1).map(l=>{var d;return op(((d=et(l,ev,4))==null?void 0:d.g())??[],ir(l,2)??0,cr(l,3)??"")})};return tu(to(i,2))!=null&&(a.timestampMs=tu(to(i,2))??0),a}(y5(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Zn.prototype.classifyForVideo=Zn.prototype.ta,Zn.prototype.classify=Zn.prototype.sa,Zn.prototype.setOptions=Zn.prototype.o,Zn.createFromModelPath=function(e,t){return Ke(Zn,e,{baseOptions:{modelAssetPath:t}})},Zn.createFromModelBuffer=function(e,t){return Ke(Zn,e,{baseOptions:{modelAssetBuffer:t}})},Zn.createFromOptions=function(e,t){return Ke(Zn,e,t)};var On=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect",!0),this.h=new kv,this.embeddings={embeddings:[]},Te(e=this.h,0,1,t=new At)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){var t=this.h,n=et(this.h,Z1,2);return n=n?n.clone():new Z1,e.l2Normalize!==void 0?xa(n,1,e.l2Normalize):"l2Normalize"in e&&ft(n,1),e.quantize!==void 0?xa(n,2,e.quantize):"quantize"in e&&ft(n,2),Te(t,0,2,n),this.l(e)}za(e,t){return hr(this,e,t),this.embeddings}Aa(e,t,n){return Xr(this,e,n,t),this.embeddings}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"embeddings_out");const t=new Gn;Nr(t,T5,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"EMBEDDINGS:embeddings_out"),n.o(t),Kn(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=x5(r),this.embeddings=function(i){return{embeddings:cs(i,w5,1).map(a=>{var d,h;const l={headIndex:ir(a,3)??0??-1,headName:cr(a,4)??""??""};if(wy(a,q1,Kc(a,1))!==void 0)a=Zs(a=et(a,q1,Kc(a,1)),1,Gs,qs()),l.floatEmbedding=a.slice();else{const m=new Uint8Array(0);l.quantizedEmbedding=((h=(d=et(a,v5,Kc(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??m}return l}),timestampMs:tu(to(i,2))??0}}(r),Ae(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};On.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=s0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=s0(r0(e.quantizedEmbedding),r0(t.quantizedEmbedding))}return e},On.prototype.embedForVideo=On.prototype.Aa,On.prototype.embed=On.prototype.za,On.prototype.setOptions=On.prototype.o,On.createFromModelPath=function(e,t){return Ke(On,e,{baseOptions:{modelAssetPath:t}})},On.createFromModelBuffer=function(e,t){return Ke(On,e,{baseOptions:{modelAssetBuffer:t}})},On.createFromOptions=function(e,t){return Ke(On,e,t)};var mf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function k0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function A0(e){try{const t=new mf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{Qu(e)}}mf.prototype.close=mf.prototype.close;var un=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new ip,this.v=new Av,Te(this.h,0,3,this.v),Te(e=this.h,0,1,t=new At)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,ho(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=cs(e.da(),wn,1).filter(s=>(cr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=et(t[0],Gn,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=cr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,k0(this),hr(this,e,r),A0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,k0(this),Xr(this,e,s,t),A0(this)}Da(){return this.s}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect");const t=new Gn;Nr(t,Cv,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),n.o(t),Kn(e,n),Ku(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),ro(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>oo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),ro(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=oo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),rt(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};un.prototype.getLabels=un.prototype.Da,un.prototype.segmentForVideo=un.prototype.Ma,un.prototype.segment=un.prototype.segment,un.prototype.setOptions=un.prototype.o,un.createFromModelPath=function(e,t){return Ke(un,e,{baseOptions:{modelAssetPath:t}})},un.createFromModelBuffer=function(e,t){return Ke(un,e,{baseOptions:{modelAssetBuffer:t}})},un.createFromOptions=function(e,t){return Ke(un,e,t)};var gf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};gf.prototype.close=gf.prototype.close;var $5=class extends Ee{constructor(e){super(e)}},yi=[0,Bt,-2],ou=[0,Jr,-3,kt,Jr,-1],E0=[0,ou],C0=[0,ou,Bt,-1],td=class extends Ee{constructor(e){super(e)}},_0=[0,Jr,-1,kt],D5=class extends Ee{constructor(e){super(e)}},j0=class extends Ee{constructor(e){super(e)}},yf=[1,2,3,4,5,6,7,8,9,10,14,15],zv=class extends Ee{constructor(e){super(e)}};zv.prototype.g=Wu([0,Yt,[0,yf,ot,ou,ot,[0,ou,yi],ot,E0,ot,[0,E0,yi],ot,_0,ot,[0,Jr,-3,kt,dr],ot,[0,Jr,-3,kt],ot,[0,it,Jr,-2,kt,Bt,kt,-1,2,Jr,yi],ot,C0,ot,[0,C0,yi],Jr,yi,it,ot,[0,Jr,-3,kt,yi,-1],ot,[0,Yt,_0]],it,[0,it,Bt,-1,kt]]);var Ur=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new ip,this.s=new Av,Te(this.h,0,3,this.s),Te(e=this.h,0,1,t=new At)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new zv;const i=new j0;var a=new $5;if(Yr(a,1,255),Te(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var l=new td;xa(l,3,!0),Ce(l,1,t.keypoint.x),Ce(l,2,t.keypoint.y),qo(i,5,yf,l)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(l of(a=new D5,t.scribble))xa(t=new td,3,!0),Ce(t,1,l.x),Ce(t,2,l.y),nu(a,1,td,t);qo(i,15,yf,a)}nu(r,1,j0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),hr(this,e,s);e:{try{const h=new gf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{Qu(this)}d=void 0}return d}m(){var e=new In;wt(e,"image_in"),wt(e,"roi_in"),wt(e,"norm_rect_in");const t=new Gn;Nr(t,Cv,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"ROI:roi_in"),pt(n,"NORM_RECT:norm_rect_in"),n.o(t),Kn(e,n),Ku(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),ro(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>oo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),ro(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=oo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),rt(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ur.prototype.segment=Ur.prototype.segment,Ur.prototype.setOptions=Ur.prototype.o,Ur.createFromModelPath=function(e,t){return Ke(Ur,e,{baseOptions:{modelAssetPath:t}})},Ur.createFromModelBuffer=function(e,t){return Ke(Ur,e,{baseOptions:{modelAssetBuffer:t}})},Ur.createFromOptions=function(e,t){return Ke(Ur,e,t)};var er=class extends Pn{constructor(e,t){super(new fr(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Te(e=this.h=new _v,0,1,t=new At)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,ho(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),e.maxResults!==void 0?Yr(this.h,3,e.maxResults):"maxResults"in e&&ft(this.h,3),e.scoreThreshold!==void 0?Ce(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&ft(this.h,4),e.categoryAllowlist!==void 0?ru(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&ft(this.h,5),e.categoryDenylist!==void 0?ru(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&ft(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},hr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Xr(this,e,n,t),this.j}m(){var e=new In;wt(e,"input_frame_gpu"),wt(e,"norm_rect"),rt(e,"detections");const t=new Gn;Nr(t,I5,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),pt(n,"IMAGE:input_frame_gpu"),pt(n,"NORM_RECT:norm_rect"),Je(n,"DETECTIONS:detections"),n.o(t),Kn(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=nv(i),this.j.detections.push(Nv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};er.prototype.detectForVideo=er.prototype.F,er.prototype.detect=er.prototype.D,er.prototype.setOptions=er.prototype.o,er.createFromModelPath=async function(e,t){return Ke(er,e,{baseOptions:{modelAssetPath:t}})},er.createFromModelBuffer=function(e,t){return Ke(er,e,{baseOptions:{modelAssetBuffer:t}})},er.createFromOptions=function(e,t){return Ke(er,e,t)};var vf=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function N0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function b0(e){try{const t=new vf(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{Qu(e)}}vf.prototype.close=vf.prototype.close;var $n=class extends Pn{constructor(e,t){super(new fr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Te(e=this.h=new jv,0,1,t=new At),this.v=new wv,Te(this.h,0,3,this.v),this.j=new vv,Te(this.h,0,2,this.j),Yr(this.j,4,1),Ce(this.j,2,.5),Ce(this.v,2,.5),Ce(this.h,4,.5)}get baseOptions(){return et(this.h,At,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numPoses"in e&&Yr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&Ce(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&Ce(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&Ce(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,N0(this),hr(this,e,r),b0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,N0(this),Xr(this,e,s,t),b0(this)}m(){var e=new In;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"normalized_landmarks"),rt(e,"world_landmarks"),rt(e,"segmentation_masks");const t=new Gn;Nr(t,R5,this.h);const n=new wn;Xn(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:normalized_landmarks"),Je(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),Kn(e,n),Ku(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=Ta(i),this.landmarks.push(Xu(r));Ae(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],Ae(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=Hi(i),this.worldLandmarks.push(ea(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],Ae(this,r)}),this.outputSegmentationMasks&&(Je(n,"SEGMENTATION_MASK:segmentation_masks"),ro(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>oo(this,i,!0,!this.s)),Ae(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};$n.prototype.detectForVideo=$n.prototype.F,$n.prototype.detect=$n.prototype.D,$n.prototype.setOptions=$n.prototype.o,$n.createFromModelPath=function(e,t){return Ke($n,e,{baseOptions:{modelAssetPath:t}})},$n.createFromModelBuffer=function(e,t){return Ke($n,e,{baseOptions:{modelAssetBuffer:t}})},$n.createFromOptions=function(e,t){return Ke($n,e,t)},$n.POSE_CONNECTIONS=Uv;const Hv="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",U5=Hv,au=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let l=0,d=0,h=0;t>=0&&t<60?(l=s,d=i,h=0):t<120?(l=i,d=s,h=0):t<180?(l=0,d=s,h=i):t<240?(l=0,d=i,h=s):t<300?(l=i,d=0,h=s):(l=s,d=0,h=i);const m=w=>Math.max(0,Math.min(255,Math.round((w+a)*255)));return{r:m(l),g:m(d),b:m(h)}}return null},wp=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),M0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),T0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},Gv=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const l=e.canvas;return s=l.width,i=l.height,r=l.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(l){console.warn("[ColorDetector] Failed to extract category mask data:",l)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},z5=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=au(t),a=au(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:l="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:m=50,minGapRatio:w=.05}=r,S=new Image;S.crossOrigin="anonymous",S.onload=()=>{try{const j=S.width>d?d/S.width:1,L=Math.max(1,Math.round(S.width*j)),F=Math.max(1,Math.round(S.height*j)),X=document.createElement("canvas");X.width=L,X.height=F;const C=X.getContext("2d");if(!C){s({suggestion:"None",stats:{mode:"colorMask"}});return}C.drawImage(S,0,0,L,F);const g=C.getImageData(0,0,L,F),{data:y}=g,E=h*h,_={minY:F,maxY:-1,pixels:0},T={minY:F,maxY:-1,pixels:0},D=new Uint8Array(L*F);for(let q=0;q<F;q+=1)for(let te=0;te<L;te+=1){const Se=(q*L+te)*4,ve=q*L+te,ye=y[Se],ee=y[Se+1],oe=y[Se+2],ne=(ye-i.r)*(ye-i.r)+(ee-i.g)*(ee-i.g)+(oe-i.b)*(oe-i.b),we=(ye-a.r)*(ye-a.r)+(ee-a.g)*(ee-a.g)+(oe-a.b)*(oe-a.b);ne<E&&ne<we?(_.pixels+=1,q<_.minY&&(_.minY=q),q>_.maxY&&(_.maxY=q),D[ve]=1):we<E&&we<ne&&(T.pixels+=1,q<T.minY&&(T.minY=q),q>T.maxY&&(T.maxY=q),D[ve]=2)}const H={mode:"colorMask",pixelsA:_.pixels,pixelsB:T.pixels,minYA:_.pixels>0?_.minY:null,maxYA:_.pixels>0?_.maxY:null,minYB:T.pixels>0?T.minY:null,maxYB:T.pixels>0?T.maxY:null,width:L,height:F},se=_.pixels>=m,V=T.pixels>=m;let K="None";if(se&&!V)K="A";else if(!se&&V)K="B";else if(se&&V){let q,te;l==="top"?(q=_.minY,te=T.minY):(q=_.maxY,te=T.maxY);const Se=Math.abs(q-te),ve=F*w;Se>=ve&&(K=l==="top"?q<te?"A":"B":q>te?"A":"B")}let re=null;try{const q=document.createElement("canvas");q.width=L,q.height=F;const te=q.getContext("2d");te.drawImage(S,0,0,L,F);const Se=te.getImageData(0,0,L,F),ve=Se.data,ye=(ne,we)=>{ve[ne]=Math.round(ve[ne]*.3+we.r*.7),ve[ne+1]=Math.round(ve[ne+1]*.3+we.g*.7),ve[ne+2]=Math.round(ve[ne+2]*.3+we.b*.7),ve[ne+3]=255},ee={r:255,g:82,b:97},oe={r:80,g:170,b:255};for(let ne=0;ne<D.length;ne+=1)D[ne]===1?ye(ne*4,ee):D[ne]===2&&ye(ne*4,oe);te.putImageData(Se,0,0),re=q.toDataURL("image/png")}catch(q){console.warn("[ColorDetector] Failed generating preview",q)}s({suggestion:K,stats:H,preview:re})}catch(j){console.error("[ColorDetector] Error processing frame:",j),s({suggestion:"None",stats:{mode:"colorMask"}})}},S.onerror=j=>{console.error("[ColorDetector] Failed to load frame image",j),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?S.src=e:typeof e=="string"?S.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),P0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const j of e){const L=j.y*t+j.x;L>=0&&L<i.length&&(i[L]=1)}const a=[],l=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const j of e){const L=j.y*t+j.x;if(L<0||L>=i.length||i[L]!==1)continue;let F=0;const X=[{x:j.x,y:j.y}];i[L]=2;const C=[];let g=0;for(;g<X.length;){const{x:y,y:E}=X[g++];F++,C.push({x:y,y:E});for(const _ of l){const T=y+_.dx,D=E+_.dy;if(T>=0&&T<t&&D>=0&&D<n){const H=D*t+T;H>=0&&H<i.length&&i[H]===1&&(i[H]=2,X.push({x:T,y:D}))}}}a.push({size:F,pixels:C})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((j,L)=>L.size>j.size?L:j).size,m=Math.max(1,Math.floor(h*s));let w=0;const S=[];for(const j of a)j.size>=m&&(w+=j.size,S.push(...j.pixels));return{count:w,pixels:S,largestBlobSize:h,minBlobSize:m,totalBlobs:a.length,filteredBlobs:a.filter(j=>j.size>=m).length}},H5=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=au(t),i=au(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await wp(e),l=a.naturalWidth||a.width,d=a.naturalHeight||a.height,m=(await xp()).segment(a),{maskData:w,maskWidth:S,maskHeight:j,isRGBA:L}=Gv(m.categoryMask,l,d);if(!w)throw new Error("Failed to extract segmentation mask data");const F=new Uint8ClampedArray(l*d*4),X=l/S,C=d/j;for(let P=0;P<d;P++)for(let U=0;U<l;U++){const J=Math.min(S-1,Math.floor(U/X)),$=(Math.min(j-1,Math.floor(P/C))*S+J)*(L?4:1);let v=0;w&&$<w.length&&(v=w[$]);const R=v!==0&&v!==2?255:0,N=(P*l+U)*4;F[N]=R,F[N+1]=R,F[N+2]=R,F[N+3]=255}const g=document.createElement("canvas");g.width=l,g.height=d;const y=g.getContext("2d");y.drawImage(a,0,0,l,d);const E=y.getImageData(0,0,l,d).data,_=r.maskThreshold||100,T=r.colorThreshold??95,D=r.anchor||"top",H=T*T,se=r.scanDepth??1,V=r.stride||2;let K=D==="top"?d:0,re=!1;if(D==="top")for(let P=0;P<d;P+=V){for(let U=0;U<l;U+=V)if(F[(P*l+U)*4]>=_){K=P,re=!0;break}if(re)break}else for(let P=d-1;P>=0;P-=V){for(let U=0;U<l;U+=V)if(F[(P*l+U)*4]>=_){K=P,re=!0;break}if(re)break}let q,te,Se;if(r.manualBounds&&D==="manually")q=r.manualBounds.topY,te=r.manualBounds.bottomY,Se=te-q,re||(K=q);else{if(!re)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};Se=se?Math.floor(d*se):d,D==="top"?(q=K,te=Math.min(d,K+Se)):(q=Math.max(0,K-Se),te=K)}const ve=[],ye=[];for(let P=q;P<te;P+=V)for(let U=0;U<l;U+=V){const J=(P*l+U)*4;if(F[J]<_)continue;const ce=E[J],$=E[J+1],v=E[J+2],R=M0({r:ce,g:$,b:v},s),N=M0({r:ce,g:$,b:v},i);R<H&&R<N?ve.push({x:U,y:P}):N<H&&N<R&&ye.push({x:U,y:P})}const ee=r.minBlobRatio??.1,oe=P0(ve,l,d,V,ee),ne=P0(ye,l,d,V,ee),we=oe.count,be=ne.count,Ie=oe.pixels.map(P=>({...P,idx:(P.y*l+P.x)*4})),Fe=ne.pixels.map(P=>({...P,idx:(P.y*l+P.x)*4})),Be=50;let $e="None",Y=null;we>Be&&we>be?($e="A",Y={color:"A",pixelCount:we,minY:q,maxY:te,anchorY:K,rawPixels:ve.length,largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize}):be>Be&&be>we&&($e="B",Y={color:"B",pixelCount:be,minY:q,maxY:te,anchorY:K,rawPixels:ye.length,largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize});let Q=null,ge=null;try{const P=document.createElement("canvas");P.width=l,P.height=d;const U=P.getContext("2d");U.drawImage(a,0,0,l,d),U.fillStyle="rgba(0,0,0,0.6)",U.fillRect(0,0,l,d),U.globalCompositeOperation="destination-out",U.fillStyle="rgba(0,0,0,1)",U.fillRect(0,q,l,te-q),U.globalCompositeOperation="destination-over",U.drawImage(a,0,0,l,d),U.globalCompositeOperation="source-over";const J=U.createImageData(l,d),ce=J.data;for(let z=q;z<te;z+=1)for(let W=0;W<l;W+=1){const fe=(z*l+W)*4;F[fe]>=_&&(ce[fe]=0,ce[fe+1]=255,ce[fe+2]=255,ce[fe+3]=90)}U.putImageData(J,0,0);const $=U.createImageData(l,d),v=$.data;for(const z of Ie){const W=z.idx;W>=0&&W<v.length-3&&(v[W]=255,v[W+1]=0,v[W+2]=0,v[W+3]=180)}for(const z of Fe){const W=z.idx;W>=0&&W<v.length-3&&(v[W]=0,v[W+1]=100,v[W+2]=255,v[W+3]=180)}U.putImageData($,0,0),U.globalCompositeOperation="source-over",U.strokeStyle="#00FF00",U.lineWidth=3,U.setLineDash([]),U.beginPath(),U.moveTo(0,q),U.lineTo(l,q),U.stroke(),U.strokeStyle="#FFFF00",U.lineWidth=3,U.setLineDash([5,5]),U.beginPath(),U.moveTo(0,te),U.lineTo(l,te),U.stroke(),K!==q&&K!==te&&(U.strokeStyle="#FF00FF",U.lineWidth=2,U.setLineDash([2,2]),U.beginPath(),U.moveTo(0,K),U.lineTo(l,K),U.stroke()),Q=P.toDataURL("image/png");const R=document.createElement("canvas");R.width=l,R.height=d;const N=R.getContext("2d"),b=N.createImageData(l,d),B=b.data;for(let z=0;z<l*d;z+=1){const W=z*4,me=F[z*4]>=_?255:0;B[W]=me,B[W+1]=me,B[W+2]=me,B[W+3]=255}N.putImageData(b,0,0),ge=R.toDataURL("image/png")}catch(P){console.warn("[ColorDetector] Failed generating preview",P)}const le={mode:"segmentation",width:l,height:d,pixelsA:we,pixelsB:be,rawPixelsA:ve.length,rawPixelsB:ye.length,tipY:K,scanDepth:Se,scanDepthRatio:se,anchor:D,bestArm:Y,blobInfoA:{largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize,totalBlobs:oe.totalBlobs,filteredBlobs:oe.filteredBlobs,droppedPixels:ve.length-we},blobInfoB:{largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize,totalBlobs:ne.totalBlobs,filteredBlobs:ne.filteredBlobs,droppedPixels:ye.length-be},minBlobRatio:ee};return{suggestion:$e,stats:le,preview:Q,maskPreview:ge}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},G5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},lu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),W5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,l=-1/0;for(const w of e){const S=lu(w,i);S>l&&(l=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let j=0;j<e.length;j++){let L=0,F=1/0;for(let X=0;X<s.length;X++){const C=lu(e[j],s[X]);C<F&&(F=C,L=X)}d[j]!==L&&(d[j]=L,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((j,L)=>{const F=d[L];S[F]+=1;for(let X=0;X<r;X++)w[F][X]+=j[X]});for(let j=0;j<s.length;j++)S[j]===0?s[j]=e[Math.floor(Math.random()*e.length)].slice():s[j]=w[j].map(L=>L/S[j]);h+=1}return{assignments:d,centroids:s}},V5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await xp(),r=t.maxFrames||e.length,s=t.stride||2;t.minClothPixels;const i=t.manualBounds||null,a=e.slice(0,r),l=[];let d=0;for(const g of a)try{const y=await wp(g.frameDataUrl),E=y.naturalWidth||y.width,_=y.naturalHeight||y.height,T=n.segment(y),{maskData:D,maskWidth:H,maskHeight:se,isRGBA:V}=Gv(T.categoryMask,E,_);if(!D){d+=1;continue}const K=document.createElement("canvas");K.width=E,K.height=_;const re=K.getContext("2d");re.drawImage(y,0,0,E,_);const q=re.getImageData(0,0,E,_).data,te=E/H,Se=_/se;let ve;i?ve=i.bottomY-i.topY:ve=_;const ye=Math.floor(ve/s),ee=Math.floor(E/s),oe=ye*ee,we=Math.max(Math.floor(oe*.005),20);let be=0,Ie=0,Fe=0,Be=0,$e=0,Y=0;for(let le=0;le<_;le+=s){if(i&&(le<i.topY||le>i.bottomY))continue;const P=Math.min(se-1,Math.floor(le/Se));for(let U=0;U<E;U+=s){const J=Math.min(H-1,Math.floor(U/te)),ce=(P*H+J)*(V?4:1);if(D[ce]===4){const v=(le*E+U)*4,R=q[v],N=q[v+1],b=q[v+2];be+=R,Ie+=N,Fe+=b,Be+=U,$e+=le,Y+=1}}}if(Y<we){console.log(`[Cloth] Frame ${g.moveId} SKIPPED - cloth pixels: ${Y}, threshold: ${we}, scan area: ${ve}px, manual bounds: ${i?"YES":"NO"}`),d+=1;continue}console.log(`[Cloth] Frame ${g.moveId} ACCEPTED - cloth pixels: ${Y}, threshold: ${we}, scan area: ${ve}px, manual bounds: ${i?`Y:${i.topY}-${i.bottomY}`:"NO"}`);const Q={r:be/Y,g:Ie/Y,b:Fe/Y};let ge=null;try{const le=document.createElement("canvas");le.width=E,le.height=_;const P=le.getContext("2d");P.drawImage(y,0,0,E,_);const U=P.getImageData(0,0,E,_),J=U.data;for(let ce=0;ce<_;ce+=1){const $=Math.min(se-1,Math.floor(ce/Se));for(let v=0;v<E;v+=1){const R=Math.min(H-1,Math.floor(v/te)),N=($*H+R)*(V?4:1);if(D[N]===4){const B=(ce*E+v)*4;J[B]=Math.round(J[B]*.5+50),J[B+1]=Math.round(J[B+1]*.5+255*.5),J[B+2]=Math.round(J[B+2]*.5+50)}}}P.putImageData(U,0,0),i&&(P.fillStyle="rgba(0, 0, 0, 0.5)",P.fillRect(0,0,E,i.topY),P.fillRect(0,i.bottomY,E,_-i.bottomY),P.strokeStyle="#00FF00",P.lineWidth=3,P.setLineDash([]),P.beginPath(),P.moveTo(0,i.topY),P.lineTo(E,i.topY),P.stroke(),P.strokeStyle="#FFFF00",P.lineWidth=3,P.setLineDash([5,5]),P.beginPath(),P.moveTo(0,i.bottomY),P.lineTo(E,i.bottomY),P.stroke(),P.fillStyle="#00FF00",P.font="bold 16px Arial",P.fillText(`Manual Scan Area (${ve}px)`,10,i.topY-10)),P.fillStyle="rgba(0, 0, 0, 0.7)",P.fillRect(10,10,300,80),P.fillStyle="#FFFFFF",P.font="bold 14px Arial",P.fillText(`Cloth Pixels: ${Y}`,20,30),P.fillText(`Threshold: ${we}`,20,50),P.fillText(`Mean Color: ${T0(Q.r,Q.g,Q.b)}`,20,70),ge=le.toDataURL("image/png")}catch(le){console.warn("[ColorDetector] Failed to generate debug preview:",le)}l.push({moveId:g.moveId,meanColor:Q,feature:[Q.r/255,Q.g/255,Q.b/255],centroidX:Be/Y/E,centroidY:$e/Y/_,pixelCount:Y,existingPlayer:g.existingPlayer||null,debugPreview:ge})}catch(y){console.warn("[ColorDetector] Cloth analysis failed for frame",g.moveId,y),d+=1}if(l.length<2)throw new Error("Not enough frames with detectable clothing");const h=l.map(g=>g.feature),{assignments:m,centroids:w}=W5(h,Math.min(2,l.length)),S=w.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));m.forEach((g,y)=>{const E=l[y],_=S[g];_.samples.push({moveId:E.moveId,centroidX:E.centroidX,centroidY:E.centroidY,pixelCount:E.pixelCount}),_.sumR+=E.meanColor.r,_.sumG+=E.meanColor.g,_.sumB+=E.meanColor.b,_.sumPixels+=E.pixelCount,_.sumBrightness+=(E.meanColor.r+E.meanColor.g+E.meanColor.b)/3,(E.existingPlayer==="Player A"||E.existingPlayer==="Player B")&&(_.labelCounts[E.existingPlayer]+=1)});const j={};S.forEach((g,y)=>{const E=g.labelCounts["Player A"],_=g.labelCounts["Player B"];E>_?j[y]="Player A":_>E&&(j[y]="Player B")});const L=S.map((g,y)=>{const E=g.sumR/Math.max(1,g.samples.length),_=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length);return{idx:y,hue:G5(E,_,T),brightness:g.sumBrightness/Math.max(1,g.samples.length)}}).sort((g,y)=>g.hue-y.hue||g.brightness-y.brightness),F=["Player A","Player B"];L.forEach(({idx:g})=>{if(!j[g]){const y=Object.values(j),E=F.find(_=>!y.includes(_))||"Player A";j[g]=E}});const X={};m.forEach((g,y)=>{const E=l[y],_=j[g]||(g===0?"Player A":"Player B"),T=w[g],D=w[g===0?1:0],H=lu(E.feature,T),se=D?lu(E.feature,D):H,V=D?Math.max(0,1-H/(H+se+1e-6)):1;X[E.moveId]={player:_,clusterId:g,styleLabel:`Style ${g+1}`,confidence:V,stats:{meanColor:E.meanColor,pixelCount:E.pixelCount,debugPreview:E.debugPreview}}});const C=S.map((g,y)=>{const E=g.sumR/Math.max(1,g.samples.length),_=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length),D=T0(E,_,T);return{id:y,styleLabel:`Style ${y+1}`,assignedPlayer:j[y]||(y===0?"Player A":"Player B"),hexColor:D,meanColor:{r:E,g:_,b:T},sampleCount:g.samples.length,avgPixels:g.sumPixels/Math.max(1,g.samples.length),avgBrightness:g.sumBrightness/Math.max(1,g.samples.length),knownAssignments:g.labelCounts}});return{assignments:X,clusters:C,analytics:{totalFrames:a.length,usedFrames:l.length,skippedFrames:d,clusters:C}}};let nd=null;const xp=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!nd){const e=await ws.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");nd=await un.createFromOptions(e,{baseOptions:{modelAssetPath:U5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return nd},Y5=async e=>{try{const t=await wp(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await xp()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let l;if(i.categoryMask.getAsUint8Array)l=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(l=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,l.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=l[w*4];l=m}}else if(i.categoryMask instanceof Uint8Array)l=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=h[w*4];l=m}else l=h}return await Promise.all(a.map(async h=>{const m=document.createElement("canvas");m.width=n,m.height=r;const w=m.getContext("2d");w.drawImage(t,0,0,n,r);const S=w.getImageData(0,0,n,r),j=S.data;let L=0;for(let F=0;F<l.length;F++)if(l[F]===h.id){L++;const X=F*4;h.id===0?(j[X]=j[X]*.25,j[X+1]=j[X+1]*.25,j[X+2]=j[X+2]*.25):(j[X]=(j[X]+h.color[0])/2,j[X+1]=(j[X+1]+h.color[1])/2,j[X+2]=(j[X+2]+h.color[2])/2)}return w.putImageData(S,0,0),{...h,pixelCount:L,preview:m.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},X5=Hv,K5=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),Q5=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const l=e.canvas;return s=l.width,i=l.height,r=l.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(l){console.warn("[ColorDetectorGeneral] Failed to extract category mask data:",l)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},uu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),J5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,l=-1/0;for(const w of e){const S=uu(w,i);S>l&&(l=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let j=0;j<e.length;j++){let L=0,F=1/0;for(let X=0;X<s.length;X++){const C=uu(e[j],s[X]);C<F&&(F=C,L=X)}d[j]!==L&&(d[j]=L,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((j,L)=>{const F=d[L];S[F]+=1;for(let X=0;X<r;X++)w[F][X]+=j[X]});for(let j=0;j<s.length;j++)S[j]===0?s[j]=e[Math.floor(Math.random()*e.length)].slice():s[j]=w[j].map(L=>L/S[j]);h+=1}return{assignments:d,centroids:s}},q5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},I0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()};let rd=null;const Z5=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!rd){const e=await ws.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");rd=await un.createFromOptions(e,{baseOptions:{modelAssetPath:X5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return rd},e6=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for analysis");const n=await Z5(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minPixels||80,a=t.manualBounds||null,l=e.slice(0,r),d=[];let h=0;for(const y of l)try{const E=await K5(y.frameDataUrl),_=E.naturalWidth||E.width,T=E.naturalHeight||E.height,D=n.segment(E),{maskData:H,maskWidth:se,maskHeight:V,isRGBA:K}=Q5(D.categoryMask,_,T);if(!H){h+=1;continue}const re=document.createElement("canvas");re.width=_,re.height=T;const q=re.getContext("2d");q.drawImage(E,0,0,_,T);const te=q.getImageData(0,0,_,T).data,Se=_/se,ve=T/V;let ye=0,ee=T;a&&(ye=Math.max(0,a.topY),ee=Math.min(T,a.bottomY));let oe=0,ne=0,we=0,be=0,Ie=0,Fe=0;for(let Y=ye;Y<ee;Y+=s){const Q=Math.min(V-1,Math.floor(Y/ve));for(let ge=0;ge<_;ge+=s){const le=Math.min(se-1,Math.floor(ge/Se)),P=(Q*se+le)*(K?4:1);if(H[P]!==0){const J=(Y*_+ge)*4,ce=te[J],$=te[J+1],v=te[J+2];oe+=ce,ne+=$,we+=v,be+=ge,Ie+=Y,Fe+=1}}}if(Fe<i){h+=1;continue}const Be={r:oe/Fe,g:ne/Fe,b:we/Fe};let $e=null;try{const Y=document.createElement("canvas");Y.width=_,Y.height=T;const Q=Y.getContext("2d");Q.drawImage(E,0,0,_,T);const ge=Q.getImageData(0,0,_,T),le=ge.data;for(let P=0;P<T;P+=1){const U=Math.min(V-1,Math.floor(P/ve));for(let J=0;J<_;J+=1){const ce=Math.min(se-1,Math.floor(J/Se)),$=(U*se+ce)*(K?4:1);if(H[$]!==0){const R=(P*_+J)*4;le[R]=Math.round(le[R]*.5+50),le[R+1]=Math.round(le[R+1]*.5+100),le[R+2]=Math.round(le[R+2]*.5+255*.5)}}}if(Q.putImageData(ge,0,0),a){Q.fillStyle="rgba(0, 0, 0, 0.5)",Q.fillRect(0,0,_,a.topY),Q.fillRect(0,a.bottomY,_,T-a.bottomY),Q.strokeStyle="#00FF00",Q.lineWidth=3,Q.setLineDash([]),Q.beginPath(),Q.moveTo(0,a.topY),Q.lineTo(_,a.topY),Q.stroke(),Q.strokeStyle="#FFFF00",Q.lineWidth=3,Q.setLineDash([5,5]),Q.beginPath(),Q.moveTo(0,a.bottomY),Q.lineTo(_,a.bottomY),Q.stroke();const P=a.bottomY-a.topY;Q.fillStyle="#00FF00",Q.font="bold 16px Arial",Q.fillText(`Manual Scan Area (${P}px)`,10,a.topY-10)}Q.fillStyle="rgba(0, 0, 0, 0.7)",Q.fillRect(10,10,300,80),Q.fillStyle="#FFFFFF",Q.font="bold 14px Arial",Q.fillText(`Non-BG Pixels: ${Fe}`,20,30),Q.fillText(`Threshold: ${i}`,20,50),Q.fillText(`Mean Color: ${I0(Be.r,Be.g,Be.b)}`,20,70),$e=Y.toDataURL("image/png")}catch(Y){console.warn("[ColorDetectorGeneral] Failed to generate debug preview:",Y)}d.push({moveId:y.moveId,meanColor:Be,feature:[Be.r/255,Be.g/255,Be.b/255],centroidX:be/Fe/_,centroidY:Ie/Fe/T,pixelCount:Fe,existingPlayer:y.existingPlayer||null,debugPreview:$e})}catch(E){console.warn("[ColorDetectorGeneral] Analysis failed for frame",y.moveId,E),h+=1}if(d.length<2)throw new Error("Not enough frames with detectable pixels (need at least 2)");const m=d.map(y=>y.feature),{assignments:w,centroids:S}=J5(m,Math.min(2,d.length)),j=S.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));w.forEach((y,E)=>{const _=d[E],T=j[y];T.samples.push({moveId:_.moveId,centroidX:_.centroidX,centroidY:_.centroidY,pixelCount:_.pixelCount}),T.sumR+=_.meanColor.r,T.sumG+=_.meanColor.g,T.sumB+=_.meanColor.b,T.sumPixels+=_.pixelCount,T.sumBrightness+=(_.meanColor.r+_.meanColor.g+_.meanColor.b)/3,(_.existingPlayer==="Player A"||_.existingPlayer==="Player B")&&(T.labelCounts[_.existingPlayer]+=1)});const L={};j.forEach((y,E)=>{const _=y.labelCounts["Player A"],T=y.labelCounts["Player B"];_>T?L[E]="Player A":T>_&&(L[E]="Player B")});const F=j.map((y,E)=>{const _=y.sumR/Math.max(1,y.samples.length),T=y.sumG/Math.max(1,y.samples.length),D=y.sumB/Math.max(1,y.samples.length);return{idx:E,hue:q5(_,T,D),brightness:y.sumBrightness/Math.max(1,y.samples.length)}}).sort((y,E)=>y.hue-E.hue||y.brightness-E.brightness),X=["Player A","Player B"];F.forEach(({idx:y})=>{if(!L[y]){const E=Object.values(L),_=X.find(T=>!E.includes(T))||"Player A";L[y]=_}});const C={};w.forEach((y,E)=>{const _=d[E],T=L[y]||(y===0?"Player A":"Player B"),D=S[y],H=S[y===0?1:0],se=uu(_.feature,D),V=H?uu(_.feature,H):se,K=H?Math.max(0,1-se/(se+V+1e-6)):1;C[_.moveId]={player:T,clusterId:y,styleLabel:`Style ${y+1}`,confidence:K,stats:{meanColor:_.meanColor,pixelCount:_.pixelCount,debugPreview:_.debugPreview}}});const g=j.map((y,E)=>{const _=y.sumR/Math.max(1,y.samples.length),T=y.sumG/Math.max(1,y.samples.length),D=y.sumB/Math.max(1,y.samples.length),H=I0(_,T,D);return{id:E,styleLabel:`Style ${E+1}`,assignedPlayer:L[E]||(E===0?"Player A":"Player B"),hexColor:H,meanColor:{r:_,g:T,b:D},sampleCount:y.samples.length,avgPixels:y.sumPixels/Math.max(1,y.samples.length),avgBrightness:y.sumBrightness/Math.max(1,y.samples.length),knownAssignments:y.labelCounts}});return{assignments:C,clusters:g,analytics:{totalFrames:l.length,usedFrames:d.length,skippedFrames:h,clusters:g}}},sd=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,t6=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function n6({colorPreview:e,onClose:t}){var j,L,F,X,C,g,y,E,_,T,D,H,se,V;const[n,r]=M.useState("overview"),[s,i]=M.useState(null),[a,l]=M.useState(!1),d=async()=>{if(e!=null&&e.original){l(!0);try{const K=await Y5(e.original);i(K)}catch(K){console.error("Failed to run multiclass segmentation:",K)}finally{l(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,m=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,w=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",S=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return u.jsx("div",{className:"image-modal",onClick:t,children:u.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:K=>K.stopPropagation(),children:[u.jsx("button",{className:"close-modal",onClick:t,children:""}),u.jsxs("div",{className:"color-preview-tabs",children:[u.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),u.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"color-preview-grid",children:[u.jsxs("div",{className:"color-preview-panel",children:[u.jsx("h3",{children:"Original Frame"}),u.jsx("img",{src:e.original,alt:"Original frame"})]}),u.jsxs("div",{className:"color-preview-panel",children:[u.jsx("h3",{children:"Mask View"}),e.preview?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mask-label",children:((j=e.stats)==null?void 0:j.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((L=e.stats)==null?void 0:L.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),u.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mask-label",children:((F=e.stats)==null?void 0:F.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),u.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):u.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&u.jsxs("div",{className:"color-preview-stats",children:[u.jsxs("div",{className:"color-preview-meta",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${m.toLocaleString()} px)`:""]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Method:"})," ",S]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Anchor:"})," ",w]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&u.jsxs("div",{children:[u.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&u.jsxs("div",{children:[u.jsx("strong",{children:"Person coverage:"})," ",t6(e.stats.personPixels)]}),e.stats.reason&&u.jsxs("div",{children:[u.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),u.jsxs("div",{className:"color-preview-calibration",children:[u.jsxs("div",{className:"calibration-card",children:[u.jsxs("div",{className:"calibration-header",children:[u.jsx("span",{className:"player-label",children:"Player A color"}),u.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),u.jsx("code",{children:e.colorA||""}),e.calibrationA&&u.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),u.jsxs("div",{className:"calibration-card",children:[u.jsxs("div",{className:"calibration-header",children:[u.jsx("span",{className:"player-label",children:"Player B color"}),u.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),u.jsx("code",{children:e.colorB||""}),e.calibrationB&&u.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?u.jsxs("div",{className:"segmentation-breakdown",children:[u.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),u.jsxs("div",{className:"segmentation-card",children:[u.jsx("h4",{children:"Scan Zone"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Scan Depth:"})," ",((X=e.stats.scanDepth)==null?void 0:X.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&u.jsxs("p",{children:[u.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),u.jsxs("div",{className:"segmentation-card",children:[u.jsx("h4",{children:"Color A Pixels"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Filtered:"})," ",((C=e.stats.pixelsA)==null?void 0:C.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&u.jsxs("p",{children:[u.jsx("strong",{children:"Raw (before blob filter):"})," ",((g=e.stats.rawPixelsA)==null?void 0:g.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Largest blob:"})," ",((y=e.stats.blobInfoA.largestBlobSize)==null?void 0:y.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Min blob size:"})," ",((E=e.stats.blobInfoA.minBlobSize)==null?void 0:E.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),u.jsxs("div",{className:"segmentation-card",children:[u.jsx("h4",{children:"Color B Pixels"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Filtered:"})," ",((_=e.stats.pixelsB)==null?void 0:_.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&u.jsxs("p",{children:[u.jsx("strong",{children:"Raw (before blob filter):"})," ",((T=e.stats.rawPixelsB)==null?void 0:T.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Largest blob:"})," ",((D=e.stats.blobInfoB.largestBlobSize)==null?void 0:D.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Min blob size:"})," ",((H=e.stats.blobInfoB.minBlobSize)==null?void 0:H.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&u.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[u.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,u.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixel Count:"})," ",((se=e.stats.bestArm.pixelCount)==null?void 0:se.toLocaleString())||0]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?u.jsxs("div",{className:"segmentation-breakdown",children:[u.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((V=e.stats.armRegions)==null?void 0:V.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((K,re)=>{const q=e.stats.bestArm&&K.category===e.stats.bestArm.category&&K.dominantColor===e.stats.bestArm.dominantColor;return u.jsxs("div",{className:"segmentation-card",style:{border:q?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:q?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[u.jsxs("h4",{children:["Arm ",re+1,": ",K.categoryName,q&&u.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Dominant Color:"})," ",u.jsxs("span",{style:{color:K.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",K.dominantColor]})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixels A:"})," ",K.pixelsA||0," | ",u.jsx("strong",{children:"Pixels B:"})," ",K.pixelsB||0]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Total arm pixels:"})," ",K.pixelCount||0]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Vertical span:"})," Y=",K.minY,"  ",K.maxY," (Anchor Y: ",K.anchorY,")"]})]},re)}):u.jsx("p",{children:"No arms detected with matching colors"})]}):u.jsxs("div",{className:"color-preview-breakdown",children:[u.jsxs("div",{className:"breakdown-card",children:[u.jsx("h4",{children:"Player A band"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",sd(e.stats.pixelsA,m),")"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),u.jsxs("div",{className:"breakdown-card",children:[u.jsx("h4",{children:"Player B band"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",sd(e.stats.pixelsB,m),")"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):u.jsxs("div",{className:"multiclass-view",children:[u.jsxs("div",{className:"multiclass-header",children:[u.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),u.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&u.jsxs("div",{className:"loading-indicator",children:[u.jsx("div",{className:"spinner"}),u.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&u.jsx("div",{className:"multiclass-grid",children:s.map(K=>u.jsxs("div",{className:"multiclass-card",children:[u.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${K.color.join(",")})`},children:[u.jsxs("h4",{children:[K.id,". ",K.name]}),u.jsx("span",{className:"multiclass-badge",children:sd(K.pixelCount,m)})]}),u.jsx("p",{className:"multiclass-desc",children:K.desc}),u.jsx("div",{className:"multiclass-preview-container",children:u.jsx("img",{src:K.preview,alt:K.name})}),u.jsxs("div",{className:"multiclass-footer",children:[K.pixelCount.toLocaleString()," pixels"]})]},K.id))}),!a&&!s&&u.jsxs("div",{className:"error-message",children:[u.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),u.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function r6({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=M.useState(0),[i,a]=M.useState(0),[l,d]=M.useState(!1),[h,m]=M.useState(!1),w=M.useRef(null),[S,j]=M.useState(0),[L,F]=M.useState(0),X=M.useRef(null),C=W0.useCallback((T,D,H,se,V,K)=>{T.clearRect(0,0,se,V),K&&T.drawImage(K,0,0),T.fillStyle="rgba(0, 255, 0, 0.2)",T.fillRect(0,D,se,H-D),T.strokeStyle="#00FF00",T.lineWidth=3,T.setLineDash([]),T.beginPath(),T.moveTo(0,D),T.lineTo(se,D),T.stroke(),T.strokeStyle="#FFFF00",T.setLineDash([]),T.beginPath(),T.moveTo(0,H),T.lineTo(se,H),T.stroke(),T.fillStyle="#00FF00",T.font="16px Arial",T.fillText("Top",10,D-5),T.fillStyle="#FFFF00",T.fillText("Bottom",10,H+20)},[]);M.useEffect(()=>{if(!e||!w.current)return;const T=new Image;T.crossOrigin="anonymous",T.onload=()=>{const D=w.current,H=D.getContext("2d");D.width=T.width,D.height=T.height,F(T.width),j(T.height),X.current=T;const se=Math.floor(T.height*.2),V=Math.floor(T.height*.8);s(se),a(V),C(H,se,V,T.width,T.height,T)},e.startsWith("data:image")?T.src=e:T.src=`data:image/jpeg;base64,${e}`},[e]),M.useEffect(()=>{if(!w.current||S===0||!X.current)return;const T=w.current.getContext("2d");C(T,r,i,L,S,X.current)},[r,i,L,S]);const g=T=>{const D=w.current,H=D.getBoundingClientRect(),se=Math.floor((T.clientY-H.top)*(D.height/H.height));Math.abs(se-r)<10?d(!0):Math.abs(se-i)<10&&m(!0)},y=T=>{if(!l&&!h)return;const D=w.current,H=D.getBoundingClientRect(),se=Math.floor((T.clientY-H.top)*(D.height/H.height)),V=Math.max(0,Math.min(D.height,se));if(l){const K=Math.min(V,i-10);s(K)}else if(h){const K=Math.max(V,r+10);a(K)}},E=()=>{d(!1),m(!1)},_=()=>{t({topY:r,bottomY:i})};return u.jsx("div",{className:"image-modal",onClick:n,children:u.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:T=>T.stopPropagation(),children:[u.jsx("button",{className:"close-modal",onClick:n,children:""}),u.jsx("h2",{children:"Set Manual Scan Area"}),u.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines to define the scan area"}),u.jsx("canvas",{ref:w,onMouseDown:g,onMouseMove:y,onMouseUp:E,onMouseLeave:E,style:{cursor:l||h?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),u.jsx("div",{className:"manual-scan-info",children:u.jsxs("p",{children:[u.jsx("strong",{children:"Top Y:"})," ",r," | ",u.jsx("strong",{children:"Bottom Y:"})," ",i," | ",u.jsx("strong",{children:"Height:"})," ",i-r,"px"]})}),u.jsxs("div",{className:"manual-scan-actions",children:[u.jsx("button",{onClick:_,className:"save-btn",children:"Save Bounds"}),u.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const Lo=_u(),s6="adminPassword",vi=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),R0=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function i6({sessionGameId:e}){var Rn,mn,Pr,pr,mr,gr;const[t,n]=M.useState(null),[r,s]=M.useState(!0),[i,a]=M.useState(null),[l,d]=M.useState(null),[h,m]=M.useState(null),[w,S]=M.useState("all"),[j,L]=M.useState(""),[F,X]=M.useState(!1),[C,g]=M.useState({}),[y,E]=M.useState({current:0,total:0}),[_,T]=M.useState("#FF0000"),[D,H]=M.useState("#0000FF"),[se,V]=M.useState(!1),[K,re]=M.useState(!1),[q,te]=M.useState({}),[Se,ve]=M.useState({current:0,total:0}),[ye,ee]=M.useState("bottom"),[oe,ne]=M.useState(100),[we,be]=M.useState(null),[Ie,Fe]=M.useState(null),[Be,$e]=M.useState(!1),[Y,Q]=M.useState(null),[ge,le]=M.useState(!1),[P,U]=M.useState(null),[J,ce]=M.useState({}),[$,v]=M.useState(!1),[R,N]=M.useState(""),[b,B]=M.useState(!1),[z,W]=M.useState(null),fe=M.useCallback(async O=>{if(!O)return{suggestion:"None",stats:null};try{const ue=await H5(O,_,D,{anchor:ye,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:ye==="manually"&&Ie?null:oe/100,manualBounds:ye==="manually"?Ie:null});if(ue)return ue}catch(ue){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",ue)}return z5(O,_,D,{anchor:ye})},[_,D,ye,oe,Ie]);M.useEffect(()=>{const O=localStorage.getItem(s6);O&&L(O)},[]),M.useEffect(()=>{e&&j&&Pe()},[e,j]);const me=O=>{if(!O||typeof O.h>"u")return null;const ue=(O.h||0)*2,de=(O.s||0)/255,Z=(O.v||0)/255,he=Z*de,Ue=he*(1-Math.abs(ue/60%2-1)),De=Z-he;let Qe=0,Oe=0,Xe=0;ue>=0&&ue<60?(Qe=he,Oe=Ue,Xe=0):ue<120?(Qe=Ue,Oe=he,Xe=0):ue<180?(Qe=0,Oe=he,Xe=Ue):ue<240?(Qe=0,Oe=Ue,Xe=he):ue<300?(Qe=Ue,Oe=0,Xe=he):(Qe=he,Oe=0,Xe=Ue);const Ft=yr=>{const Qn=Math.round((yr+De)*255).toString(16);return Qn.length===1?"0"+Qn:Qn};return`#${Ft(Qe)}${Ft(Oe)}${Ft(Xe)}`.toUpperCase()},Pe=async()=>{var O,ue,de,Z;if(j){s(!0),a(null);try{const he=await fetch(`${Lo}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":j}});if(!he.ok)throw new Error(`Failed to load session (${he.status})`);const Ue=await he.json();n(Ue);let De=null,Qe=null,Oe="";if(Ue.colorA&&Ue.colorB?(De=Ue.colorA,Qe=Ue.colorB,Oe="session root"):(ue=(O=Ue.metadata)==null?void 0:O.config)!=null&&ue.colorA&&((Z=(de=Ue.metadata)==null?void 0:de.config)!=null&&Z.colorB)&&(De=Ue.metadata.config.colorA,Qe=Ue.metadata.config.colorB,Oe="session metadata"),De&&Qe)T(De),H(Qe),console.log(`[MoveHistoryEditor]  Loaded colors from ${Oe}:`,De,Qe);else try{const Xe=JSON.parse(localStorage.getItem("calibrationA")||"null"),Ft=JSON.parse(localStorage.getItem("calibrationB")||"null");if(Xe&&Ft){const yr=me(Xe),Qn=me(Ft);yr&&Qn?(T(yr),H(Qn),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",yr,Qn)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch(Xe){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",Xe),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(he){console.error("[MoveHistoryEditor] Error loading session:",he),a(he.message)}finally{s(!1)}}},Me=async(O,ue)=>{if(!(!e||!O||!j))try{const de=await fetch(`${Lo}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent(O)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":j},body:JSON.stringify({player:ue})});if(!de.ok)throw new Error(`Failed to update player (${de.status})`);n(Z=>Z&&{...Z,moves:Z.moves.map(he=>he._id===O?{...he,player:ue}:he)}),g(Z=>{const he={...Z};return delete he[O],he}),console.log("[MoveHistoryEditor] Player updated:",O,ue)}catch(de){console.error("[MoveHistoryEditor] Error updating player:",de),alert("Failed to update player: "+de.message)}},Ge=async()=>{if(!(!e||!j)){X(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",_,"Player B:",D);const O=Tt.filter(de=>de.camera_frame);if(O.length===0){alert("No moves with camera frames to process");return}E({current:0,total:O.length}),console.log(`[MoveHistoryEditor] Processing ${O.length} moves one by one...`);let ue=0;for(const de of O){E({current:ue+1,total:O.length});try{const Z=await fetch(`${Lo}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":j},body:JSON.stringify({sessionGameId:e,moveId:de._id,colorA:_,colorB:D,cameraPosition:ye==="top"||ye==="bottom"?ye:void 0})});if(Z.ok){const he=await Z.json();N(""),g(Ue=>({...Ue,[de._id]:{player:he.suggestion==="A"?"Player A":he.suggestion==="B"?"Player B":"None",confidence:he.confidence,rawResponse:he.rawResponse}})),ue++,console.log(`[MoveHistoryEditor]  Processed ${ue}/${O.length}: ${he.suggestion}`)}else Z.status===503?N(" Retrying..."):N(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${de._id}`)}catch(Z){N(""),console.error(`[MoveHistoryEditor] Error processing move ${de._id}:`,Z)}}console.log("[MoveHistoryEditor] AI identification complete:",ue,"moves processed"),alert(`AI identified ${ue} moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in AI identification:",O),alert("AI identification failed: "+O.message)}finally{X(!1),E({current:0,total:0}),N("")}}},tt=async()=>{if(!(!e||!j)){X(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",_,"Player B:",D);const O=Tt.filter(de=>de.camera_frame&&(!de.player||de.player==="Unknown"||de.player==="None"));if(O.length===0){alert("No unknown moves with camera frames to process");return}E({current:0,total:O.length}),console.log(`[MoveHistoryEditor] Processing ${O.length} unknown moves one by one...`);let ue=0;for(const de of O){E({current:ue+1,total:O.length});try{const Z=await fetch(`${Lo}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":j},body:JSON.stringify({sessionGameId:e,moveId:de._id,colorA:_,colorB:D,cameraPosition:ye==="top"||ye==="bottom"?ye:void 0})});if(Z.ok){const he=await Z.json();N(""),g(Ue=>({...Ue,[de._id]:{player:he.suggestion==="A"?"Player A":he.suggestion==="B"?"Player B":"None",confidence:he.confidence,rawResponse:he.rawResponse}})),ue++,console.log(`[MoveHistoryEditor]  Processed ${ue}/${O.length}: ${he.suggestion}`)}else Z.status===503?N(" Retrying..."):N(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${de._id}`)}catch(Z){N(""),console.error(`[MoveHistoryEditor] Error processing move ${de._id}:`,Z)}}console.log("[MoveHistoryEditor] AI identification complete:",ue,"unknown moves processed"),alert(`AI identified ${ue} unknown moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in AI identification:",O),alert("AI identification failed: "+O.message)}finally{X(!1),E({current:0,total:0}),N("")}}},st=async O=>{const ue=C[O];ue&&await Me(O,ue.player)},lt=async()=>{if(!(!t||!Array.isArray(t.moves))){re(!0),te({});try{console.log("[MoveHistoryEditor] Starting color identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",_,"Player B:",D);const O=Tt.filter(de=>de.camera_frame);if(O.length===0){alert("No moves with camera frames to process (color)");return}ve({current:0,total:O.length});let ue=0;for(const de of O){ve({current:ue+1,total:O.length});try{const Z=await fe(de.camera_frame);if(!Z)continue;te(he=>({...he,[de._id]:{method:"color",player:Z.suggestion==="A"?"Player A":Z.suggestion==="B"?"Player B":"None",stats:Z.stats,preview:Z.preview}})),ue+=1}catch(Z){console.error(`[MoveHistoryEditor] Color identify error for move ${de._id}:`,Z)}}console.log("[MoveHistoryEditor] Color identification complete:",ue,"moves processed"),alert(`Color-based method suggested players for ${ue} moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in color identification:",O),alert("Color-based identification failed: "+O.message)}finally{re(!1),ve({current:0,total:0})}}},ut=async()=>{if(!(!t||!Array.isArray(t.moves))){re(!0),te({});try{console.log("[MoveHistoryEditor] Starting color identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",_,"Player B:",D);const O=Tt.filter(de=>de.camera_frame&&(!de.player||de.player==="Unknown"||de.player==="None"));if(O.length===0){alert("No unknown moves with camera frames to process (color)");return}ve({current:0,total:O.length});let ue=0;for(const de of O){ve({current:ue+1,total:O.length});try{const Z=await fe(de.camera_frame);if(!Z)continue;te(he=>({...he,[de._id]:{method:"color",player:Z.suggestion==="A"?"Player A":Z.suggestion==="B"?"Player B":"None",stats:Z.stats,preview:Z.preview}})),ue+=1}catch(Z){console.error(`[MoveHistoryEditor] Color identify error for move ${de._id}:`,Z)}}console.log("[MoveHistoryEditor] Color identification complete:",ue,"unknown moves processed"),alert(`Color-based method suggested players for ${ue} unknown moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in color identification:",O),alert("Color-based identification failed: "+O.message)}finally{re(!1),ve({current:0,total:0})}}},Ve=async O=>{const ue=q[O];ue&&(await Me(O,ue.player),te(de=>{const Z={...de};return delete Z[O],Z}))},ze=async O=>{if(!t||!Array.isArray(t.moves))return;const ue=t.moves.find(de=>de._id===O);if(!ue||!ue.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${O}`);const de=await fe(ue.camera_frame);if(!de){alert("Color-based identification failed for this move.");return}te(Ue=>({...Ue,[O]:{method:"color",player:de.suggestion==="A"?"Player A":de.suggestion==="B"?"Player B":"None",stats:de.stats,preview:de.preview}}));let Z=null,he=null;try{Z=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{Z=null}try{he=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{he=null}be({moveId:O,original:ue.camera_frame,preview:de.preview,maskPreview:de.maskPreview,stats:de.stats,suggestion:de.suggestion,colorA:_,colorB:D,calibrationA:Z,calibrationB:he,anchor:ye})}catch(de){console.error("[MoveHistoryEditor] Error color-identifying move:",de),alert("Color-based identification failed: "+de.message)}},He=M.useCallback(async({mode:O})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ue=t.moves.filter(Z=>Z.camera_frame);if(ue.length===0){alert("No camera frames available for cloth-based identification.");return}const de=new Set(t.moves.filter(Z=>!Z.player||Z.player==="Unknown"||Z.player==="None").map(Z=>Z._id));if(O==="unknown"&&de.size===0){alert("All moves already have players assigned.");return}le(!0),U(null);try{const Z=ue.map(Oe=>({moveId:Oe._id,frameDataUrl:Oe.camera_frame,existingPlayer:Oe.player&&Oe.player!=="Unknown"?Oe.player:null})),he=await V5(Z,{maxFrames:ue.length,stride:2,minClothPixels:80,manualBounds:ye==="manually"?Ie:null});he!=null&&he.analytics&&U(he.analytics);const Ue={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Oe,Xe])=>{var Ft;(Ft=Xe.stats)!=null&&Ft.debugPreview&&(Ue[Oe]=Xe.stats.debugPreview)}),Object.keys(Ue).length>0&&ce(Ue);const De={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Oe,Xe])=>{(O==="all"||de.has(Oe))&&(De[Oe]={method:"cloth",player:Xe.player,styleLabel:Xe.styleLabel,confidence:Xe.confidence,stats:Xe.stats})});const Qe=Object.keys(De).length;Qe===0?alert(`Cloth-based method did not find suggestions for any ${O==="all"?"moves":"unknown moves"}.`):(te(Xe=>({...Xe,...De})),alert(`Cloth-based method suggested players for ${Qe} ${O==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(Z){console.error("[MoveHistoryEditor] Cloth identification failed:",Z),alert("Cloth-based identification failed: "+Z.message)}finally{le(!1)}},[t,ye,Ie]),qe=M.useCallback(()=>{He({mode:"all"})},[He]),bt=M.useCallback(()=>{He({mode:"unknown"})},[He]),on=M.useCallback(async({mode:O})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ue=t.moves.filter(Z=>Z.camera_frame);if(ue.length===0){alert("No camera frames available for All-All identification.");return}const de=new Set(t.moves.filter(Z=>!Z.player||Z.player==="Unknown"||Z.player==="None").map(Z=>Z._id));if(O==="unknown"&&de.size===0){alert("All moves already have players assigned.");return}B(!0),W(null);try{const Z=ue.map(Oe=>({moveId:Oe._id,frameDataUrl:Oe.camera_frame,existingPlayer:Oe.player&&Oe.player!=="Unknown"?Oe.player:null})),he=await e6(Z,{maxFrames:ue.length,stride:2,minPixels:80,manualBounds:ye==="manually"?Ie:null});he!=null&&he.analytics&&W(he.analytics);const Ue={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Oe,Xe])=>{var Ft;(Ft=Xe.stats)!=null&&Ft.debugPreview&&(Ue[Oe]=Xe.stats.debugPreview)}),Object.keys(Ue).length>0&&ce(Oe=>({...Oe,...Ue}));const De={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Oe,Xe])=>{(O==="all"||de.has(Oe))&&(De[Oe]={method:"allall",player:Xe.player,styleLabel:Xe.styleLabel,confidence:Xe.confidence,stats:Xe.stats})});const Qe=Object.keys(De).length;Qe===0?alert(`All-All method did not find suggestions for any ${O==="all"?"moves":"unknown moves"}.`):(te(Xe=>({...Xe,...De})),alert(`All-All method suggested players for ${Qe} ${O==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(Z){console.error("[MoveHistoryEditor] All-All identification failed:",Z),alert("All-All identification failed: "+Z.message)}finally{B(!1)}},[t,ye,Ie]),mt=M.useCallback(()=>{on({mode:"all"})},[on]),Ut=M.useCallback(()=>{on({mode:"unknown"})},[on]),Mt=async O=>{if(!(!e||!j))try{console.log(`[MoveHistoryEditor] Identifying single move: ${O}`);const ue=await fetch(`${Lo}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":j},body:JSON.stringify({sessionGameId:e,moveId:O,colorA:_,colorB:D,cameraPosition:ye==="top"||ye==="bottom"?ye:void 0})});if(ue.ok){const de=await ue.json();g(Z=>({...Z,[O]:{player:de.suggestion==="A"?"Player A":de.suggestion==="B"?"Player B":"None",confidence:de.confidence,rawResponse:de.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${de.suggestion}`)}else{const de=await ue.json();alert(`Failed to identify move: ${de.message}`)}}catch(ue){console.error("[MoveHistoryEditor] Error identifying move:",ue),alert("AI identification failed: "+ue.message)}},Tt=((Rn=t==null?void 0:t.moves)==null?void 0:Rn.filter(O=>w==="all"?!0:O.phase===w))||[];if(r)return u.jsx("div",{className:"move-editor-container",children:u.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return u.jsx("div",{className:"move-editor-container",children:u.jsxs("div",{className:"move-editor-error",children:[u.jsx("h2",{children:"Error Loading Session"}),u.jsx("p",{children:i}),u.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return u.jsx("div",{className:"move-editor-container",children:u.jsx("div",{className:"move-editor-error",children:"Session not found"})});const hn=((mn=t.moves)==null?void 0:mn.filter(O=>O.phase==="practice").length)||0,pn=((Pr=t.moves)==null?void 0:Pr.filter(O=>O.phase==="experiment").length)||0;return u.jsxs("div",{className:"move-editor-container",children:[u.jsxs("header",{className:"move-editor-header",children:[u.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),u.jsxs("div",{className:"move-editor-title",children:[u.jsx("h1",{children:"Move History Editor"}),u.jsxs("div",{className:"session-info",children:[u.jsxs("span",{className:"session-id",children:["Session: ",e]}),u.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),u.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]})]}),u.jsxs("div",{className:"phase-filter",children:[u.jsxs("button",{className:`filter-btn ${w==="all"?"active":""}`,onClick:()=>S("all"),children:["All (",((pr=t.moves)==null?void 0:pr.length)||0,")"]}),u.jsxs("button",{className:`filter-btn ${w==="practice"?"active":""}`,onClick:()=>S("practice"),children:["Practice (",hn,")"]}),u.jsxs("button",{className:`filter-btn ${w==="experiment"?"active":""}`,onClick:()=>S("experiment"),children:["Experiment (",pn,")"]})]}),u.jsxs("div",{className:"bracelet-colors-controls",children:[u.jsx("button",{className:"color-picker-toggle",onClick:()=>V(!se),children:"Bracelet Colors"}),se&&u.jsxs("div",{className:"color-picker-panel",children:[u.jsxs("div",{className:"color-input-group",children:[u.jsx("label",{children:"Player A:"}),u.jsx("input",{type:"color",value:_,onChange:O=>T(O.target.value)}),u.jsx("span",{children:_})]}),u.jsxs("div",{className:"color-input-group",children:[u.jsx("label",{children:"Player B:"}),u.jsx("input",{type:"color",value:D,onChange:O=>H(O.target.value)}),u.jsx("span",{children:D})]})]})]}),u.jsxs("div",{className:"ai-controls",children:[u.jsx("button",{className:"ai-btn ai-btn-all",onClick:Ge,disabled:F,children:F&&y.total>0?R?`${R} ${y.current}/${y.total}`:`Processing ${y.current}/${y.total}...`:"AI Identify All"}),u.jsx("button",{className:"ai-btn ai-btn-unknown",onClick:tt,disabled:F,children:F&&y.total>0?R?`${R} ${y.current}/${y.total}`:`Processing ${y.current}/${y.total}...`:"AI Identify Unknown"})]}),u.jsxs("div",{className:"color-controls",children:[u.jsx("button",{className:"ai-btn color-btn-all",onClick:lt,disabled:K,children:K&&Se.total>0?` Color ${Se.current}/${Se.total}...`:" Color Identify All"}),u.jsx("button",{className:"ai-btn ai-btn-unknown color-btn-unknown",onClick:ut,disabled:K,children:K&&Se.total>0?` Color Unknown ${Se.current}/${Se.total}...`:" Color Identify Unknown"}),u.jsx("button",{className:"ai-btn cloth-btn",onClick:qe,disabled:ge,children:ge?" Identifying by Cloth...":" Identify by Cloth All"}),u.jsx("button",{className:"ai-btn cloth-btn",onClick:bt,disabled:ge,children:ge?" Identifying by Cloth...":" Identify by Cloth Unknown"}),Object.keys(J).length>0&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:`ai-btn debug-btn ${$?"active":""}`,onClick:()=>v(!$),style:{backgroundColor:$?"#4CAF50":"#666",marginLeft:"20px"},children:$?" Debug View ON":" Show Debug View"}),u.jsx("button",{className:"ai-btn debug-btn",onClick:()=>{v(!1),ce({})},style:{backgroundColor:"#ff5722"},children:" Clear Debug"})]}),u.jsx("button",{className:"ai-btn allall-btn",onClick:mt,disabled:b,children:b?" Identifying by All All...":" Identify by All All"}),u.jsx("button",{className:"ai-btn allall-btn",onClick:Ut,disabled:b,children:b?" Identifying by All All...":" Identify by All Unknown"}),u.jsxs("div",{className:"color-anchor-toggle",children:[u.jsx("label",{children:"Color anchor:"}),u.jsxs("select",{value:ye,onChange:O=>{if(ee(O.target.value),O.target.value==="manually"){const ue=(t==null?void 0:t.moves)||[];if(ue.length>0){const de=ue[Math.floor(Math.random()*ue.length)];de!=null&&de.camera_frame?(Q(de.camera_frame),$e(!0)):(alert("No frames available. Please ensure moves have camera frames."),ee("bottom"))}else alert("No moves available."),ee("bottom")}else $e(!1),Fe(null),Q(null)},children:[u.jsx("option",{value:"bottom",children:"Bottom"}),u.jsx("option",{value:"top",children:"Top"}),u.jsx("option",{value:"manually",children:"Manually"})]})]}),ye!=="manually"&&u.jsxs("div",{className:"color-scan-percentage",children:[u.jsxs("label",{children:["Scan area: ",oe,"%"]}),u.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:oe,onChange:O=>ne(Number(O.target.value)),style:{width:"120px",marginLeft:"8px"}})]}),ye==="manually"&&Ie&&u.jsxs("div",{className:"manual-bounds-info",children:[u.jsxs("span",{children:["Manual: Y=",Ie.topY,"  ",Ie.bottomY]}),u.jsx("button",{onClick:()=>$e(!0),style:{marginLeft:"8px",padding:"4px 8px"},children:"Edit"})]})]})]}),P&&u.jsxs("section",{className:"cloth-analytics",children:[u.jsx("div",{className:"cloth-analytics-header",children:u.jsxs("div",{children:[u.jsx("h3",{children:"Cloth Styles Analytics"}),u.jsxs("p",{children:["Frames analyzed: ",P.usedFrames,"/",P.totalFrames,"  Skipped:"," ",P.skippedFrames]})]})}),u.jsx("div",{className:"cloth-style-grid",children:(mr=P.clusters)==null?void 0:mr.map(O=>u.jsxs("div",{className:"cloth-style-card",children:[u.jsxs("div",{className:"cloth-style-card-header",children:[u.jsx("span",{className:"style-label",children:O.styleLabel}),u.jsx("span",{className:"player-label",children:O.assignedPlayer})]}),u.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:O.hexColor}}),u.jsxs("div",{className:"cloth-style-stats",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Mean color:"})," ",O.hexColor]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Frames:"})," ",O.sampleCount]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg pixels:"})," ",vi(O.avgPixels||0)]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg brightness:"})," ",vi(O.avgBrightness||0)]})]})]},O.id))})]}),z&&u.jsxs("section",{className:"cloth-analytics",children:[u.jsx("div",{className:"cloth-analytics-header",children:u.jsxs("div",{children:[u.jsx("h3",{children:" All-All Styles Analytics (Background Excluded)"}),u.jsxs("p",{children:["Frames analyzed: ",z.usedFrames,"/",z.totalFrames,"  Skipped:"," ",z.skippedFrames]})]})}),u.jsx("div",{className:"cloth-style-grid",children:(gr=z.clusters)==null?void 0:gr.map(O=>u.jsxs("div",{className:"cloth-style-card",children:[u.jsxs("div",{className:"cloth-style-card-header",children:[u.jsx("span",{className:"style-label",children:O.styleLabel}),u.jsx("span",{className:"player-label",children:O.assignedPlayer})]}),u.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:O.hexColor}}),u.jsxs("div",{className:"cloth-style-stats",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Mean color:"})," ",O.hexColor]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Frames:"})," ",O.sampleCount]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg pixels:"})," ",vi(O.avgPixels||0)]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg brightness:"})," ",vi(O.avgBrightness||0)]})]})]},O.id))})]}),u.jsxs("div",{className:"move-editor-content",children:[u.jsx("div",{className:"moves-grid",children:Tt.map((O,ue)=>{var de;return u.jsxs("div",{className:`move-card ${(l==null?void 0:l._id)===O._id?"selected":""}`,onClick:()=>d(O),children:[u.jsxs("div",{className:"move-card-header",children:[u.jsxs("span",{className:"move-number",children:["#",ue+1]}),u.jsx("span",{className:`move-phase ${O.phase}`,children:O.phase})]}),O.camera_frame&&u.jsxs("div",{className:"move-image",onClick:Z=>{Z.stopPropagation(),m($&&J[O._id]?J[O._id]:O.camera_frame)},style:{position:"relative"},children:[u.jsx("img",{src:$&&J[O._id]?J[O._id]:O.camera_frame,alt:`Move ${ue+1}`}),u.jsx("div",{className:"image-overlay",children:" Click to enlarge"}),$&&J[O._id]&&u.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(76, 175, 80, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:" DEBUG"})]}),u.jsxs("div",{className:"move-card-body",children:[u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Type:"}),u.jsx("span",{className:"value",children:O.type})]}),C[O._id]&&(()=>{const Z=C[O._id].player,Ue=Z==="A"||Z==="Player A"?_:D;return u.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:Ue,outline:`2px solid ${R0(Ue,.25)}`,outlineOffset:"2px"},children:[u.jsxs("div",{className:"ai-suggestion-content",children:[u.jsx("span",{className:"ai-icon",children:""}),u.jsxs("span",{className:"ai-text",children:["AI suggests: ",u.jsx("strong",{children:C[O._id].player})]})]}),u.jsx("button",{className:"ai-confirm-btn",onClick:De=>{De.stopPropagation(),st(O._id)},children:" Confirm"})]})})(),q[O._id]&&(()=>{const Z=q[O._id],De=Z.player==="Player A"?_:D,Qe=Z.method||"color",Oe=Qe==="cloth"?"":Qe==="allall"?"":"",Xe=Qe==="cloth"?`Cloth suggests${Z.styleLabel?` (${Z.styleLabel})`:""}:`:Qe==="allall"?`All-All suggests${Z.styleLabel?` (${Z.styleLabel})`:""}:`:"Color suggests:",Ft=typeof Z.confidence=="number"?`  ${Math.round(Z.confidence*100)}% confidence`:"";return u.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:De,outline:`2px solid ${R0(De,.25)}`,outlineOffset:"2px"},children:[u.jsxs("div",{className:"ai-suggestion-content",children:[u.jsx("span",{className:"ai-icon",children:Oe}),u.jsxs("span",{className:"ai-text",children:[Xe," ",u.jsx("strong",{children:Z.player}),Ft]})]}),u.jsx("button",{className:"ai-confirm-btn",onClick:yr=>{yr.stopPropagation(),Ve(O._id)},children:" Confirm"})]})})(),u.jsxs("div",{className:"move-info-row player-row",style:{borderColor:O.player==="Player A"?_:O.player==="Player B"?D:O.player==="None"?"#9E9E9E":"#FFC107"},children:[u.jsx("span",{className:"label",children:"Player:"}),u.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[u.jsxs("select",{className:`player-select ${(de=O.player)==null?void 0:de.toLowerCase().replace(" ","-")}`,value:O.player||"Unknown",onChange:Z=>Me(O._id,Z.target.value),onClick:Z=>Z.stopPropagation(),style:{flex:1,borderColor:O.player==="Player A"?_:O.player==="Player B"?D:O.player==="None"?"#9E9E9E":"#FFC107"},children:[u.jsx("option",{value:"Player A",children:"Player A"}),u.jsx("option",{value:"Player B",children:"Player B"}),u.jsx("option",{value:"None",children:"None"}),u.jsx("option",{value:"Unknown",children:"Unknown"})]}),O.camera_frame&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"ai-single-btn",onClick:Z=>{Z.stopPropagation(),Mt(O._id)},title:"Identify this move with AI",children:""}),u.jsx("button",{className:"ai-single-btn color-single-btn",onClick:Z=>{Z.stopPropagation(),ze(O._id)},title:"Identify this move by color",children:""})]})]})]}),O.blockId!==null&&O.blockId!==void 0&&u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Block:"}),u.jsx("span",{className:"value",children:O.blockId})]}),Array.isArray(O.position)&&O.position.length===2&&u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Position:"}),u.jsxs("span",{className:"value",children:["(",O.position[0],", ",O.position[1],")"]})]}),u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Time:"}),u.jsxs("span",{className:"value",children:[vi(O.elapsed,1),"s"]})]}),Number.isFinite(O.holdTime)&&O.holdTime>0&&u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Hold:"}),u.jsxs("span",{className:"value",children:[vi(O.holdTime,2),"s"]})]})]})]},O._id||ue)})}),Tt.length===0&&u.jsx("div",{className:"no-moves",children:u.jsx("p",{children:"No moves found for selected filter."})})]}),h&&u.jsx("div",{className:"image-modal",onClick:()=>m(null),children:u.jsxs("div",{className:"image-modal-content",onClick:O=>O.stopPropagation(),children:[u.jsx("button",{className:"close-modal",onClick:()=>m(null),children:""}),u.jsx("img",{src:h,alt:"Expanded view"})]})}),u.jsx(n6,{colorPreview:we,onClose:()=>be(null)}),Be&&Y&&u.jsx(r6,{frameDataUrl:Y,onSave:O=>{Fe(O),$e(!1)},onCancel:()=>{$e(!1),ee("bottom"),Q(null)}})]})}const o6=!1;function a6(){const[e,t]=M.useState(!1),[n,r]=M.useState(null),[s,i]=M.useState(null),[a,l]=M.useState(window.location.hash),[d,h]=M.useState(!1);M.useEffect(()=>{const L=()=>{l(window.location.hash)};return window.addEventListener("hashchange",L),()=>window.removeEventListener("hashchange",L)},[]),M.useEffect(()=>(window.toggleInterface=L=>{h(L),console.log("[App] Interface "+(L?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const m=L=>{r(L),t(!0)},w=()=>{s&&!s.closed&&s.close();const L=window.location.origin+window.location.pathname+"#/detector",F=window.open(L,"BraceletDetector","width=700,height=600,left=100,top=100");i(F)};M.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),M.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(L){console.error("Error ending experience:",L),alert("Error ending experience: "+L.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let S=null;const j=a.match(/^#\/admin\/edit-moves\/(.+)$/);if(a==="#/detector")S=u.jsx(g1,{});else if(a==="#/calibrate")S=u.jsx(fx,{});else if(a==="#/detector2")S=u.jsx(hx,{});else if(a==="#/summary")S=u.jsx(Q2,{});else if(a==="#/admin")S=u.jsx(mx,{});else if(a==="#/admin/upload")S=u.jsx(gx,{});else if(j){const L=decodeURIComponent(j[1]);S=u.jsx(i6,{sessionGameId:L},L)}else S=e?u.jsxs(u.Fragment,{children:[u.jsx(cx,{config:n,interfaceHidden:d}),u.jsx(g1,{hidden:d}),o6,!d&&u.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[u.jsx("button",{onClick:w,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),u.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),u.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&u.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:u.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):u.jsx(nx,{onStart:m});return u.jsx("div",{className:"App",children:S})}id.createRoot(document.getElementById("root")).render(u.jsx(W0.StrictMode,{children:u.jsx(a6,{})}));
