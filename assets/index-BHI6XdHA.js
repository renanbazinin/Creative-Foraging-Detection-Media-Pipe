(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var R0={exports:{}},vu={},L0={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ma=Symbol.for("react.element"),_3=Symbol.for("react.portal"),j3=Symbol.for("react.fragment"),N3=Symbol.for("react.strict_mode"),b3=Symbol.for("react.profiler"),M3=Symbol.for("react.provider"),T3=Symbol.for("react.context"),P3=Symbol.for("react.forward_ref"),I3=Symbol.for("react.suspense"),R3=Symbol.for("react.memo"),L3=Symbol.for("react.lazy"),nm=Symbol.iterator;function B3(e){return e===null||typeof e!="object"?null:(e=nm&&e[nm]||e["@@iterator"],typeof e=="function"?e:null)}var B0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F0=Object.assign,O0={};function vo(e,t,n){this.props=e,this.context=t,this.refs=O0,this.updater=n||B0}vo.prototype.isReactComponent={};vo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};vo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $0(){}$0.prototype=vo.prototype;function Af(e,t,n){this.props=e,this.context=t,this.refs=O0,this.updater=n||B0}var Ef=Af.prototype=new $0;Ef.constructor=Af;F0(Ef,vo.prototype);Ef.isPureReactComponent=!0;var rm=Array.isArray,D0=Object.prototype.hasOwnProperty,Cf={current:null},z0={key:!0,ref:!0,__self:!0,__source:!0};function U0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)D0.call(t,r)&&!z0.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var d=Array(l),h=0;h<l;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ma,type:e,key:i,ref:a,props:s,_owner:Cf.current}}function F3(e,t){return{$$typeof:Ma,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function _f(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ma}function O3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var sm=/\/+/g;function yc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?O3(""+e.key):t.toString(36)}function gl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ma:case _3:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+yc(a,0):r,rm(s)?(n="",e!=null&&(n=e.replace(sm,"$&/")+"/"),gl(s,t,n,"",function(h){return h})):s!=null&&(_f(s)&&(s=F3(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(sm,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",rm(e))for(var l=0;l<e.length;l++){i=e[l];var d=r+yc(i,l);a+=gl(i,t,n,d,s)}else if(d=B3(e),typeof d=="function")for(e=d.call(e),l=0;!(i=e.next()).done;)i=i.value,d=r+yc(i,l++),a+=gl(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Xa(e,t,n){if(e==null)return e;var r=[],s=0;return gl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function $3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Sn={current:null},yl={transition:null},D3={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:yl,ReactCurrentOwner:Cf};function H0(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Xa,forEach:function(e,t,n){Xa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Xa(e,function(){t++}),t},toArray:function(e){return Xa(e,function(t){return t})||[]},only:function(e){if(!_f(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=vo;Ye.Fragment=j3;Ye.Profiler=b3;Ye.PureComponent=Af;Ye.StrictMode=N3;Ye.Suspense=I3;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D3;Ye.act=H0;Ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=F0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Cf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(d in t)D0.call(t,d)&&!z0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&l!==void 0?l[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){l=Array(d);for(var h=0;h<d;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:Ma,type:e.type,key:s,ref:i,props:r,_owner:a}};Ye.createContext=function(e){return e={$$typeof:T3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:M3,_context:e},e.Consumer=e};Ye.createElement=U0;Ye.createFactory=function(e){var t=U0.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:P3,render:e}};Ye.isValidElement=_f;Ye.lazy=function(e){return{$$typeof:L3,_payload:{_status:-1,_result:e},_init:$3}};Ye.memo=function(e,t){return{$$typeof:R3,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=yl.transition;yl.transition={};try{e()}finally{yl.transition=t}};Ye.unstable_act=H0;Ye.useCallback=function(e,t){return Sn.current.useCallback(e,t)};Ye.useContext=function(e){return Sn.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return Sn.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return Sn.current.useEffect(e,t)};Ye.useId=function(){return Sn.current.useId()};Ye.useImperativeHandle=function(e,t,n){return Sn.current.useImperativeHandle(e,t,n)};Ye.useInsertionEffect=function(e,t){return Sn.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return Sn.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return Sn.current.useMemo(e,t)};Ye.useReducer=function(e,t,n){return Sn.current.useReducer(e,t,n)};Ye.useRef=function(e){return Sn.current.useRef(e)};Ye.useState=function(e){return Sn.current.useState(e)};Ye.useSyncExternalStore=function(e,t,n){return Sn.current.useSyncExternalStore(e,t,n)};Ye.useTransition=function(){return Sn.current.useTransition()};Ye.version="18.3.1";L0.exports=Ye;var N=L0.exports;const G0=C3(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z3=N,U3=Symbol.for("react.element"),H3=Symbol.for("react.fragment"),G3=Object.prototype.hasOwnProperty,W3=z3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V3={key:!0,ref:!0,__self:!0,__source:!0};function W0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)G3.call(t,r)&&!V3.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:U3,type:e,key:i,ref:a,props:s,_owner:W3.current}}vu.Fragment=H3;vu.jsx=W0;vu.jsxs=W0;R0.exports=vu;var u=R0.exports,ud={},V0={exports:{}},qn={},Y0={exports:{}},X0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,oe){var ne=Z.length;Z.push(oe);e:for(;0<ne;){var ve=ne-1>>>1,Me=Z[ve];if(0<s(Me,oe))Z[ve]=oe,Z[ne]=Me,ne=ve;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var oe=Z[0],ne=Z.pop();if(ne!==oe){Z[0]=ne;e:for(var ve=0,Me=Z.length,Ie=Me>>>1;ve<Ie;){var De=2*(ve+1)-1,Oe=Z[De],ze=De+1,Y=Z[ze];if(0>s(Oe,ne))ze<Me&&0>s(Y,Oe)?(Z[ve]=Y,Z[ze]=ne,ve=ze):(Z[ve]=Oe,Z[De]=ne,ve=De);else if(ze<Me&&0>s(Y,ne))Z[ve]=Y,Z[ze]=ne,ve=ze;else break e}}return oe}function s(Z,oe){var ne=Z.sortIndex-oe.sortIndex;return ne!==0?ne:Z.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var d=[],h=[],m=1,w=null,S=3,_=!1,L=!1,F=!1,X=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Z){for(var oe=n(h);oe!==null;){if(oe.callback===null)r(h);else if(oe.startTime<=Z)r(h),oe.sortIndex=oe.expirationTime,t(d,oe);else break;oe=n(h)}}function E(Z){if(F=!1,y(Z),!L)if(n(d)!==null)L=!0,xe(j);else{var oe=n(h);oe!==null&&ge(E,oe.startTime-Z)}}function j(Z,oe){L=!1,F&&(F=!1,C(H),H=-1),_=!0;var ne=S;try{for(y(oe),w=n(d);w!==null&&(!(w.expirationTime>oe)||Z&&!K());){var ve=w.callback;if(typeof ve=="function"){w.callback=null,S=w.priorityLevel;var Me=ve(w.expirationTime<=oe);oe=e.unstable_now(),typeof Me=="function"?w.callback=Me:w===n(d)&&r(d),y(oe)}else r(d);w=n(d)}if(w!==null)var Ie=!0;else{var De=n(h);De!==null&&ge(E,De.startTime-oe),Ie=!1}return Ie}finally{w=null,S=ne,_=!1}}var T=!1,D=null,H=-1,se=5,V=-1;function K(){return!(e.unstable_now()-V<se)}function ee(){if(D!==null){var Z=e.unstable_now();V=Z;var oe=!0;try{oe=D(!0,Z)}finally{oe?q():(T=!1,D=null)}}else T=!1}var q;if(typeof g=="function")q=function(){g(ee)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,Ae=te.port2;te.port1.onmessage=ee,q=function(){Ae.postMessage(null)}}else q=function(){X(ee,0)};function xe(Z){D=Z,T||(T=!0,q())}function ge(Z,oe){H=X(function(){Z(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){L||_||(L=!0,xe(j))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(Z){switch(S){case 1:case 2:case 3:var oe=3;break;default:oe=S}var ne=S;S=oe;try{return Z()}finally{S=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,oe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ne=S;S=Z;try{return oe()}finally{S=ne}},e.unstable_scheduleCallback=function(Z,oe,ne){var ve=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ve+ne:ve):ne=ve,Z){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=ne+Me,Z={id:m++,callback:oe,priorityLevel:Z,startTime:ne,expirationTime:Me,sortIndex:-1},ne>ve?(Z.sortIndex=ne,t(h,Z),n(d)===null&&Z===n(h)&&(F?(C(H),H=-1):F=!0,ge(E,ne-ve))):(Z.sortIndex=Me,t(d,Z),L||_||(L=!0,xe(j))),Z},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(Z){var oe=S;return function(){var ne=S;S=oe;try{return Z.apply(this,arguments)}finally{S=ne}}}})(X0);Y0.exports=X0;var Y3=Y0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X3=N,Qn=Y3;function ae(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K0=new Set,ua={};function gi(e,t){eo(e,t),eo(e+"Capture",t)}function eo(e,t){for(ua[e]=t,e=0;e<t.length;e++)K0.add(t[e])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cd=Object.prototype.hasOwnProperty,K3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,im={},om={};function Q3(e){return cd.call(om,e)?!0:cd.call(im,e)?!1:K3.test(e)?om[e]=!0:(im[e]=!0,!1)}function J3(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function q3(e,t,n,r){if(t===null||typeof t>"u"||J3(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function kn(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ln[e]=new kn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ln[t]=new kn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ln[e]=new kn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ln[e]=new kn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ln[e]=new kn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ln[e]=new kn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ln[e]=new kn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ln[e]=new kn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ln[e]=new kn(e,5,!1,e.toLowerCase(),null,!1,!1)});var jf=/[\-:]([a-z])/g;function Nf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(jf,Nf);ln[t]=new kn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(jf,Nf);ln[t]=new kn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(jf,Nf);ln[t]=new kn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ln[e]=new kn(e,1,!1,e.toLowerCase(),null,!1,!1)});ln.xlinkHref=new kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ln[e]=new kn(e,1,!1,e.toLowerCase(),null,!0,!0)});function bf(e,t,n,r){var s=ln.hasOwnProperty(t)?ln[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(q3(t,n,s,r)&&(n=null),r||s===null?Q3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ms=X3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ka=Symbol.for("react.element"),bi=Symbol.for("react.portal"),Mi=Symbol.for("react.fragment"),Mf=Symbol.for("react.strict_mode"),dd=Symbol.for("react.profiler"),Q0=Symbol.for("react.provider"),J0=Symbol.for("react.context"),Tf=Symbol.for("react.forward_ref"),fd=Symbol.for("react.suspense"),hd=Symbol.for("react.suspense_list"),Pf=Symbol.for("react.memo"),As=Symbol.for("react.lazy"),q0=Symbol.for("react.offscreen"),am=Symbol.iterator;function Io(e){return e===null||typeof e!="object"?null:(e=am&&e[am]||e["@@iterator"],typeof e=="function"?e:null)}var Tt=Object.assign,vc;function Go(e){if(vc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);vc=t&&t[1]||""}return`
`+vc+e}var wc=!1;function xc(e,t){if(!e||wc)return"";wc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=l);break}}}finally{wc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Go(e):""}function Z3(e){switch(e.tag){case 5:return Go(e.type);case 16:return Go("Lazy");case 13:return Go("Suspense");case 19:return Go("SuspenseList");case 0:case 2:case 15:return e=xc(e.type,!1),e;case 11:return e=xc(e.type.render,!1),e;case 1:return e=xc(e.type,!0),e;default:return""}}function pd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mi:return"Fragment";case bi:return"Portal";case dd:return"Profiler";case Mf:return"StrictMode";case fd:return"Suspense";case hd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case J0:return(e.displayName||"Context")+".Consumer";case Q0:return(e._context.displayName||"Context")+".Provider";case Tf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Pf:return t=e.displayName||null,t!==null?t:pd(e.type)||"Memo";case As:t=e._payload,e=e._init;try{return pd(e(t))}catch{}}return null}function e4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pd(t);case 8:return t===Mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Us(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Z0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function t4(e){var t=Z0(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Qa(e){e._valueTracker||(e._valueTracker=t4(e))}function eg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Z0(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Rl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function md(e,t){var n=t.checked;return Tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function lm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Us(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tg(e,t){t=t.checked,t!=null&&bf(e,"checked",t,!1)}function gd(e,t){tg(e,t);var n=Us(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?yd(e,t.type,n):t.hasOwnProperty("defaultValue")&&yd(e,t.type,Us(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function um(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function yd(e,t,n){(t!=="number"||Rl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Wo=Array.isArray;function Ui(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Us(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function vd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ae(92));if(Wo(n)){if(1<n.length)throw Error(ae(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Us(n)}}function ng(e,t){var n=Us(t.value),r=Us(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function dm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ja,sg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ja=Ja||document.createElement("div"),Ja.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ja.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ca(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Qo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},n4=["Webkit","ms","Moz","O"];Object.keys(Qo).forEach(function(e){n4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Qo[t]=Qo[e]})});function ig(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Qo.hasOwnProperty(e)&&Qo[e]?(""+t).trim():t+"px"}function og(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ig(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var r4=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xd(e,t){if(t){if(r4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ae(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ae(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ae(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ae(62))}}function Sd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kd=null;function If(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ad=null,Hi=null,Gi=null;function fm(e){if(e=Ia(e)){if(typeof Ad!="function")throw Error(ae(280));var t=e.stateNode;t&&(t=Au(t),Ad(e.stateNode,e.type,t))}}function ag(e){Hi?Gi?Gi.push(e):Gi=[e]:Hi=e}function lg(){if(Hi){var e=Hi,t=Gi;if(Gi=Hi=null,fm(e),t)for(e=0;e<t.length;e++)fm(t[e])}}function ug(e,t){return e(t)}function cg(){}var Sc=!1;function dg(e,t,n){if(Sc)return e(t,n);Sc=!0;try{return ug(e,t,n)}finally{Sc=!1,(Hi!==null||Gi!==null)&&(cg(),lg())}}function da(e,t){var n=e.stateNode;if(n===null)return null;var r=Au(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ae(231,t,typeof n));return n}var Ed=!1;if(us)try{var Ro={};Object.defineProperty(Ro,"passive",{get:function(){Ed=!0}}),window.addEventListener("test",Ro,Ro),window.removeEventListener("test",Ro,Ro)}catch{Ed=!1}function s4(e,t,n,r,s,i,a,l,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(m){this.onError(m)}}var Jo=!1,Ll=null,Bl=!1,Cd=null,i4={onError:function(e){Jo=!0,Ll=e}};function o4(e,t,n,r,s,i,a,l,d){Jo=!1,Ll=null,s4.apply(i4,arguments)}function a4(e,t,n,r,s,i,a,l,d){if(o4.apply(this,arguments),Jo){if(Jo){var h=Ll;Jo=!1,Ll=null}else throw Error(ae(198));Bl||(Bl=!0,Cd=h)}}function yi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function fg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hm(e){if(yi(e)!==e)throw Error(ae(188))}function l4(e){var t=e.alternate;if(!t){if(t=yi(e),t===null)throw Error(ae(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return hm(s),e;if(i===r)return hm(s),t;i=i.sibling}throw Error(ae(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?e:t}function hg(e){return e=l4(e),e!==null?pg(e):null}function pg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pg(e);if(t!==null)return t;e=e.sibling}return null}var mg=Qn.unstable_scheduleCallback,pm=Qn.unstable_cancelCallback,u4=Qn.unstable_shouldYield,c4=Qn.unstable_requestPaint,$t=Qn.unstable_now,d4=Qn.unstable_getCurrentPriorityLevel,Rf=Qn.unstable_ImmediatePriority,gg=Qn.unstable_UserBlockingPriority,Fl=Qn.unstable_NormalPriority,f4=Qn.unstable_LowPriority,yg=Qn.unstable_IdlePriority,wu=null,Vr=null;function h4(e){if(Vr&&typeof Vr.onCommitFiberRoot=="function")try{Vr.onCommitFiberRoot(wu,e,void 0,(e.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:g4,p4=Math.log,m4=Math.LN2;function g4(e){return e>>>=0,e===0?32:31-(p4(e)/m4|0)|0}var qa=64,Za=4194304;function Vo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ol(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Vo(l):(i&=a,i!==0&&(r=Vo(i)))}else a=n&~s,a!==0?r=Vo(a):i!==0&&(r=Vo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Nr(t),s=1<<n,r|=e[n],t&=~s;return r}function y4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Nr(i),l=1<<a,d=s[a];d===-1?(!(l&n)||l&r)&&(s[a]=y4(l,t)):d<=t&&(e.expiredLanes|=l),i&=~l}}function _d(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function vg(){var e=qa;return qa<<=1,!(qa&4194240)&&(qa=64),e}function kc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ta(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nr(t),e[t]=n}function w4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Nr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Lf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Nr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function wg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xg,Bf,Sg,kg,Ag,jd=!1,el=[],Ps=null,Is=null,Rs=null,fa=new Map,ha=new Map,_s=[],x4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mm(e,t){switch(e){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Is=null;break;case"mouseover":case"mouseout":Rs=null;break;case"pointerover":case"pointerout":fa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ha.delete(t.pointerId)}}function Lo(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ia(t),t!==null&&Bf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function S4(e,t,n,r,s){switch(t){case"focusin":return Ps=Lo(Ps,e,t,n,r,s),!0;case"dragenter":return Is=Lo(Is,e,t,n,r,s),!0;case"mouseover":return Rs=Lo(Rs,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return fa.set(i,Lo(fa.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ha.set(i,Lo(ha.get(i)||null,e,t,n,r,s)),!0}return!1}function Eg(e){var t=ti(e.target);if(t!==null){var n=yi(t);if(n!==null){if(t=n.tag,t===13){if(t=fg(n),t!==null){e.blockedOn=t,Ag(e.priority,function(){Sg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Nd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);kd=r,n.target.dispatchEvent(r),kd=null}else return t=Ia(n),t!==null&&Bf(t),e.blockedOn=n,!1;t.shift()}return!0}function gm(e,t,n){vl(e)&&n.delete(t)}function k4(){jd=!1,Ps!==null&&vl(Ps)&&(Ps=null),Is!==null&&vl(Is)&&(Is=null),Rs!==null&&vl(Rs)&&(Rs=null),fa.forEach(gm),ha.forEach(gm)}function Bo(e,t){e.blockedOn===t&&(e.blockedOn=null,jd||(jd=!0,Qn.unstable_scheduleCallback(Qn.unstable_NormalPriority,k4)))}function pa(e){function t(s){return Bo(s,e)}if(0<el.length){Bo(el[0],e);for(var n=1;n<el.length;n++){var r=el[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ps!==null&&Bo(Ps,e),Is!==null&&Bo(Is,e),Rs!==null&&Bo(Rs,e),fa.forEach(t),ha.forEach(t),n=0;n<_s.length;n++)r=_s[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<_s.length&&(n=_s[0],n.blockedOn===null);)Eg(n),n.blockedOn===null&&_s.shift()}var Wi=ms.ReactCurrentBatchConfig,$l=!0;function A4(e,t,n,r){var s=at,i=Wi.transition;Wi.transition=null;try{at=1,Ff(e,t,n,r)}finally{at=s,Wi.transition=i}}function E4(e,t,n,r){var s=at,i=Wi.transition;Wi.transition=null;try{at=4,Ff(e,t,n,r)}finally{at=s,Wi.transition=i}}function Ff(e,t,n,r){if($l){var s=Nd(e,t,n,r);if(s===null)Pc(e,t,r,Dl,n),mm(e,r);else if(S4(s,e,t,n,r))r.stopPropagation();else if(mm(e,r),t&4&&-1<x4.indexOf(e)){for(;s!==null;){var i=Ia(s);if(i!==null&&xg(i),i=Nd(e,t,n,r),i===null&&Pc(e,t,r,Dl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Pc(e,t,r,null,n)}}var Dl=null;function Nd(e,t,n,r){if(Dl=null,e=If(r),e=ti(e),e!==null)if(t=yi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=fg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Dl=e,null}function Cg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(d4()){case Rf:return 1;case gg:return 4;case Fl:case f4:return 16;case yg:return 536870912;default:return 16}default:return 16}}var Ms=null,Of=null,wl=null;function _g(){if(wl)return wl;var e,t=Of,n=t.length,r,s="value"in Ms?Ms.value:Ms.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return wl=s.slice(e,1<r?1-r:void 0)}function xl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function tl(){return!0}function ym(){return!1}function Zn(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?tl:ym,this.isPropagationStopped=ym,this}return Tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=tl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=tl)},persist:function(){},isPersistent:tl}),t}var wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$f=Zn(wo),Pa=Tt({},wo,{view:0,detail:0}),C4=Zn(Pa),Ac,Ec,Fo,xu=Tt({},Pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Df,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Fo&&(Fo&&e.type==="mousemove"?(Ac=e.screenX-Fo.screenX,Ec=e.screenY-Fo.screenY):Ec=Ac=0,Fo=e),Ac)},movementY:function(e){return"movementY"in e?e.movementY:Ec}}),vm=Zn(xu),_4=Tt({},xu,{dataTransfer:0}),j4=Zn(_4),N4=Tt({},Pa,{relatedTarget:0}),Cc=Zn(N4),b4=Tt({},wo,{animationName:0,elapsedTime:0,pseudoElement:0}),M4=Zn(b4),T4=Tt({},wo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),P4=Zn(T4),I4=Tt({},wo,{data:0}),wm=Zn(I4),R4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=B4[e])?!!t[e]:!1}function Df(){return F4}var O4=Tt({},Pa,{key:function(e){if(e.key){var t=R4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?L4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Df,charCode:function(e){return e.type==="keypress"?xl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$4=Zn(O4),D4=Tt({},xu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xm=Zn(D4),z4=Tt({},Pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Df}),U4=Zn(z4),H4=Tt({},wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),G4=Zn(H4),W4=Tt({},xu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),V4=Zn(W4),Y4=[9,13,27,32],zf=us&&"CompositionEvent"in window,qo=null;us&&"documentMode"in document&&(qo=document.documentMode);var X4=us&&"TextEvent"in window&&!qo,jg=us&&(!zf||qo&&8<qo&&11>=qo),Sm=" ",km=!1;function Ng(e,t){switch(e){case"keyup":return Y4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ti=!1;function K4(e,t){switch(e){case"compositionend":return bg(t);case"keypress":return t.which!==32?null:(km=!0,Sm);case"textInput":return e=t.data,e===Sm&&km?null:e;default:return null}}function Q4(e,t){if(Ti)return e==="compositionend"||!zf&&Ng(e,t)?(e=_g(),wl=Of=Ms=null,Ti=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jg&&t.locale!=="ko"?null:t.data;default:return null}}var J4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Am(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!J4[e.type]:t==="textarea"}function Mg(e,t,n,r){ag(r),t=zl(t,"onChange"),0<t.length&&(n=new $f("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Zo=null,ma=null;function q4(e){zg(e,0)}function Su(e){var t=Ri(e);if(eg(t))return e}function Z4(e,t){if(e==="change")return t}var Tg=!1;if(us){var _c;if(us){var jc="oninput"in document;if(!jc){var Em=document.createElement("div");Em.setAttribute("oninput","return;"),jc=typeof Em.oninput=="function"}_c=jc}else _c=!1;Tg=_c&&(!document.documentMode||9<document.documentMode)}function Cm(){Zo&&(Zo.detachEvent("onpropertychange",Pg),ma=Zo=null)}function Pg(e){if(e.propertyName==="value"&&Su(ma)){var t=[];Mg(t,ma,e,If(e)),dg(q4,t)}}function ew(e,t,n){e==="focusin"?(Cm(),Zo=t,ma=n,Zo.attachEvent("onpropertychange",Pg)):e==="focusout"&&Cm()}function tw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Su(ma)}function nw(e,t){if(e==="click")return Su(t)}function rw(e,t){if(e==="input"||e==="change")return Su(t)}function sw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mr=typeof Object.is=="function"?Object.is:sw;function ga(e,t){if(Mr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!cd.call(t,s)||!Mr(e[s],t[s]))return!1}return!0}function _m(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function jm(e,t){var n=_m(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_m(n)}}function Ig(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ig(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Rg(){for(var e=window,t=Rl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Rl(e.document)}return t}function Uf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function iw(e){var t=Rg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ig(n.ownerDocument.documentElement,n)){if(r!==null&&Uf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=jm(n,i);var a=jm(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ow=us&&"documentMode"in document&&11>=document.documentMode,Pi=null,bd=null,ea=null,Md=!1;function Nm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Md||Pi==null||Pi!==Rl(r)||(r=Pi,"selectionStart"in r&&Uf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ea&&ga(ea,r)||(ea=r,r=zl(bd,"onSelect"),0<r.length&&(t=new $f("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Pi)))}function nl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ii={animationend:nl("Animation","AnimationEnd"),animationiteration:nl("Animation","AnimationIteration"),animationstart:nl("Animation","AnimationStart"),transitionend:nl("Transition","TransitionEnd")},Nc={},Lg={};us&&(Lg=document.createElement("div").style,"AnimationEvent"in window||(delete Ii.animationend.animation,delete Ii.animationiteration.animation,delete Ii.animationstart.animation),"TransitionEvent"in window||delete Ii.transitionend.transition);function ku(e){if(Nc[e])return Nc[e];if(!Ii[e])return e;var t=Ii[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Lg)return Nc[e]=t[n];return e}var Bg=ku("animationend"),Fg=ku("animationiteration"),Og=ku("animationstart"),$g=ku("transitionend"),Dg=new Map,bm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vs(e,t){Dg.set(e,t),gi(t,[e])}for(var bc=0;bc<bm.length;bc++){var Mc=bm[bc],aw=Mc.toLowerCase(),lw=Mc[0].toUpperCase()+Mc.slice(1);Vs(aw,"on"+lw)}Vs(Bg,"onAnimationEnd");Vs(Fg,"onAnimationIteration");Vs(Og,"onAnimationStart");Vs("dblclick","onDoubleClick");Vs("focusin","onFocus");Vs("focusout","onBlur");Vs($g,"onTransitionEnd");eo("onMouseEnter",["mouseout","mouseover"]);eo("onMouseLeave",["mouseout","mouseover"]);eo("onPointerEnter",["pointerout","pointerover"]);eo("onPointerLeave",["pointerout","pointerover"]);gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yo));function Mm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,a4(r,t,void 0,e),e.currentTarget=null}function zg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var l=r[a],d=l.instance,h=l.currentTarget;if(l=l.listener,d!==i&&s.isPropagationStopped())break e;Mm(s,l,h),i=d}else for(a=0;a<r.length;a++){if(l=r[a],d=l.instance,h=l.currentTarget,l=l.listener,d!==i&&s.isPropagationStopped())break e;Mm(s,l,h),i=d}}}if(Bl)throw e=Cd,Bl=!1,Cd=null,e}function wt(e,t){var n=t[Ld];n===void 0&&(n=t[Ld]=new Set);var r=e+"__bubble";n.has(r)||(Ug(t,e,2,!1),n.add(r))}function Tc(e,t,n){var r=0;t&&(r|=4),Ug(n,e,r,t)}var rl="_reactListening"+Math.random().toString(36).slice(2);function ya(e){if(!e[rl]){e[rl]=!0,K0.forEach(function(n){n!=="selectionchange"&&(uw.has(n)||Tc(n,!1,e),Tc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[rl]||(t[rl]=!0,Tc("selectionchange",!1,t))}}function Ug(e,t,n,r){switch(Cg(t)){case 1:var s=A4;break;case 4:s=E4;break;default:s=Ff}n=s.bind(null,t,n,e),s=void 0,!Ed||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Pc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ti(l),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}l=l.parentNode}}r=r.return}dg(function(){var h=i,m=If(n),w=[];e:{var S=Dg.get(e);if(S!==void 0){var _=$f,L=e;switch(e){case"keypress":if(xl(n)===0)break e;case"keydown":case"keyup":_=$4;break;case"focusin":L="focus",_=Cc;break;case"focusout":L="blur",_=Cc;break;case"beforeblur":case"afterblur":_=Cc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=vm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=j4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=U4;break;case Bg:case Fg:case Og:_=M4;break;case $g:_=G4;break;case"scroll":_=C4;break;case"wheel":_=V4;break;case"copy":case"cut":case"paste":_=P4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=xm}var F=(t&4)!==0,X=!F&&e==="scroll",C=F?S!==null?S+"Capture":null:S;F=[];for(var g=h,y;g!==null;){y=g;var E=y.stateNode;if(y.tag===5&&E!==null&&(y=E,C!==null&&(E=da(g,C),E!=null&&F.push(va(g,E,y)))),X)break;g=g.return}0<F.length&&(S=new _(S,L,null,n,m),w.push({event:S,listeners:F}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",S&&n!==kd&&(L=n.relatedTarget||n.fromElement)&&(ti(L)||L[cs]))break e;if((_||S)&&(S=m.window===m?m:(S=m.ownerDocument)?S.defaultView||S.parentWindow:window,_?(L=n.relatedTarget||n.toElement,_=h,L=L?ti(L):null,L!==null&&(X=yi(L),L!==X||L.tag!==5&&L.tag!==6)&&(L=null)):(_=null,L=h),_!==L)){if(F=vm,E="onMouseLeave",C="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(F=xm,E="onPointerLeave",C="onPointerEnter",g="pointer"),X=_==null?S:Ri(_),y=L==null?S:Ri(L),S=new F(E,g+"leave",_,n,m),S.target=X,S.relatedTarget=y,E=null,ti(m)===h&&(F=new F(C,g+"enter",L,n,m),F.target=y,F.relatedTarget=X,E=F),X=E,_&&L)t:{for(F=_,C=L,g=0,y=F;y;y=Ei(y))g++;for(y=0,E=C;E;E=Ei(E))y++;for(;0<g-y;)F=Ei(F),g--;for(;0<y-g;)C=Ei(C),y--;for(;g--;){if(F===C||C!==null&&F===C.alternate)break t;F=Ei(F),C=Ei(C)}F=null}else F=null;_!==null&&Tm(w,S,_,F,!1),L!==null&&X!==null&&Tm(w,X,L,F,!0)}}e:{if(S=h?Ri(h):window,_=S.nodeName&&S.nodeName.toLowerCase(),_==="select"||_==="input"&&S.type==="file")var j=Z4;else if(Am(S))if(Tg)j=rw;else{j=tw;var T=ew}else(_=S.nodeName)&&_.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(j=nw);if(j&&(j=j(e,h))){Mg(w,j,n,m);break e}T&&T(e,S,h),e==="focusout"&&(T=S._wrapperState)&&T.controlled&&S.type==="number"&&yd(S,"number",S.value)}switch(T=h?Ri(h):window,e){case"focusin":(Am(T)||T.contentEditable==="true")&&(Pi=T,bd=h,ea=null);break;case"focusout":ea=bd=Pi=null;break;case"mousedown":Md=!0;break;case"contextmenu":case"mouseup":case"dragend":Md=!1,Nm(w,n,m);break;case"selectionchange":if(ow)break;case"keydown":case"keyup":Nm(w,n,m)}var D;if(zf)e:{switch(e){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else Ti?Ng(e,n)&&(H="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(H="onCompositionStart");H&&(jg&&n.locale!=="ko"&&(Ti||H!=="onCompositionStart"?H==="onCompositionEnd"&&Ti&&(D=_g()):(Ms=m,Of="value"in Ms?Ms.value:Ms.textContent,Ti=!0)),T=zl(h,H),0<T.length&&(H=new wm(H,e,null,n,m),w.push({event:H,listeners:T}),D?H.data=D:(D=bg(n),D!==null&&(H.data=D)))),(D=X4?K4(e,n):Q4(e,n))&&(h=zl(h,"onBeforeInput"),0<h.length&&(m=new wm("onBeforeInput","beforeinput",null,n,m),w.push({event:m,listeners:h}),m.data=D))}zg(w,t)})}function va(e,t,n){return{instance:e,listener:t,currentTarget:n}}function zl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=da(e,n),i!=null&&r.unshift(va(e,i,s)),i=da(e,t),i!=null&&r.push(va(e,i,s))),e=e.return}return r}function Ei(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Tm(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var l=n,d=l.alternate,h=l.stateNode;if(d!==null&&d===r)break;l.tag===5&&h!==null&&(l=h,s?(d=da(n,i),d!=null&&a.unshift(va(n,d,l))):s||(d=da(n,i),d!=null&&a.push(va(n,d,l)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var cw=/\r\n?/g,dw=/\u0000|\uFFFD/g;function Pm(e){return(typeof e=="string"?e:""+e).replace(cw,`
`).replace(dw,"")}function sl(e,t,n){if(t=Pm(t),Pm(e)!==t&&n)throw Error(ae(425))}function Ul(){}var Td=null,Pd=null;function Id(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Rd=typeof setTimeout=="function"?setTimeout:void 0,fw=typeof clearTimeout=="function"?clearTimeout:void 0,Im=typeof Promise=="function"?Promise:void 0,hw=typeof queueMicrotask=="function"?queueMicrotask:typeof Im<"u"?function(e){return Im.resolve(null).then(e).catch(pw)}:Rd;function pw(e){setTimeout(function(){throw e})}function Ic(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),pa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);pa(t)}function Ls(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Rm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var xo=Math.random().toString(36).slice(2),Wr="__reactFiber$"+xo,wa="__reactProps$"+xo,cs="__reactContainer$"+xo,Ld="__reactEvents$"+xo,mw="__reactListeners$"+xo,gw="__reactHandles$"+xo;function ti(e){var t=e[Wr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[cs]||n[Wr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Rm(e);e!==null;){if(n=e[Wr])return n;e=Rm(e)}return t}e=n,n=e.parentNode}return null}function Ia(e){return e=e[Wr]||e[cs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ri(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ae(33))}function Au(e){return e[wa]||null}var Bd=[],Li=-1;function Ys(e){return{current:e}}function xt(e){0>Li||(e.current=Bd[Li],Bd[Li]=null,Li--)}function pt(e,t){Li++,Bd[Li]=e.current,e.current=t}var Hs={},pn=Ys(Hs),Tn=Ys(!1),ui=Hs;function to(e,t){var n=e.type.contextTypes;if(!n)return Hs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pn(e){return e=e.childContextTypes,e!=null}function Hl(){xt(Tn),xt(pn)}function Lm(e,t,n){if(pn.current!==Hs)throw Error(ae(168));pt(pn,t),pt(Tn,n)}function Hg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(ae(108,e4(e)||"Unknown",s));return Tt({},n,r)}function Gl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Hs,ui=pn.current,pt(pn,e),pt(Tn,Tn.current),!0}function Bm(e,t,n){var r=e.stateNode;if(!r)throw Error(ae(169));n?(e=Hg(e,t,ui),r.__reactInternalMemoizedMergedChildContext=e,xt(Tn),xt(pn),pt(pn,e)):xt(Tn),pt(Tn,n)}var Zr=null,Eu=!1,Rc=!1;function Gg(e){Zr===null?Zr=[e]:Zr.push(e)}function yw(e){Eu=!0,Gg(e)}function Xs(){if(!Rc&&Zr!==null){Rc=!0;var e=0,t=at;try{var n=Zr;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Zr=null,Eu=!1}catch(s){throw Zr!==null&&(Zr=Zr.slice(e+1)),mg(Rf,Xs),s}finally{at=t,Rc=!1}}return null}var Bi=[],Fi=0,Wl=null,Vl=0,ur=[],cr=0,ci=null,ns=1,rs="";function Zs(e,t){Bi[Fi++]=Vl,Bi[Fi++]=Wl,Wl=e,Vl=t}function Wg(e,t,n){ur[cr++]=ns,ur[cr++]=rs,ur[cr++]=ci,ci=e;var r=ns;e=rs;var s=32-Nr(r)-1;r&=~(1<<s),n+=1;var i=32-Nr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ns=1<<32-Nr(t)+s|n<<s|r,rs=i+e}else ns=1<<i|n<<s|r,rs=e}function Hf(e){e.return!==null&&(Zs(e,1),Wg(e,1,0))}function Gf(e){for(;e===Wl;)Wl=Bi[--Fi],Bi[Fi]=null,Vl=Bi[--Fi],Bi[Fi]=null;for(;e===ci;)ci=ur[--cr],ur[cr]=null,rs=ur[--cr],ur[cr]=null,ns=ur[--cr],ur[cr]=null}var Kn=null,Xn=null,Et=!1,_r=null;function Vg(e,t){var n=fr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Fm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Kn=e,Xn=Ls(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Kn=e,Xn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ci!==null?{id:ns,overflow:rs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=fr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Kn=e,Xn=null,!0):!1;default:return!1}}function Fd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Od(e){if(Et){var t=Xn;if(t){var n=t;if(!Fm(e,t)){if(Fd(e))throw Error(ae(418));t=Ls(n.nextSibling);var r=Kn;t&&Fm(e,t)?Vg(r,n):(e.flags=e.flags&-4097|2,Et=!1,Kn=e)}}else{if(Fd(e))throw Error(ae(418));e.flags=e.flags&-4097|2,Et=!1,Kn=e}}}function Om(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kn=e}function il(e){if(e!==Kn)return!1;if(!Et)return Om(e),Et=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Id(e.type,e.memoizedProps)),t&&(t=Xn)){if(Fd(e))throw Yg(),Error(ae(418));for(;t;)Vg(e,t),t=Ls(t.nextSibling)}if(Om(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ae(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Xn=Ls(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Xn=null}}else Xn=Kn?Ls(e.stateNode.nextSibling):null;return!0}function Yg(){for(var e=Xn;e;)e=Ls(e.nextSibling)}function no(){Xn=Kn=null,Et=!1}function Wf(e){_r===null?_r=[e]:_r.push(e)}var vw=ms.ReactCurrentBatchConfig;function Oo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,e))}return e}function ol(e,t){throw e=Object.prototype.toString.call(t),Error(ae(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $m(e){var t=e._init;return t(e._payload)}function Xg(e){function t(C,g){if(e){var y=C.deletions;y===null?(C.deletions=[g],C.flags|=16):y.push(g)}}function n(C,g){if(!e)return null;for(;g!==null;)t(C,g),g=g.sibling;return null}function r(C,g){for(C=new Map;g!==null;)g.key!==null?C.set(g.key,g):C.set(g.index,g),g=g.sibling;return C}function s(C,g){return C=$s(C,g),C.index=0,C.sibling=null,C}function i(C,g,y){return C.index=y,e?(y=C.alternate,y!==null?(y=y.index,y<g?(C.flags|=2,g):y):(C.flags|=2,g)):(C.flags|=1048576,g)}function a(C){return e&&C.alternate===null&&(C.flags|=2),C}function l(C,g,y,E){return g===null||g.tag!==6?(g=zc(y,C.mode,E),g.return=C,g):(g=s(g,y),g.return=C,g)}function d(C,g,y,E){var j=y.type;return j===Mi?m(C,g,y.props.children,E,y.key):g!==null&&(g.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===As&&$m(j)===g.type)?(E=s(g,y.props),E.ref=Oo(C,g,y),E.return=C,E):(E=jl(y.type,y.key,y.props,null,C.mode,E),E.ref=Oo(C,g,y),E.return=C,E)}function h(C,g,y,E){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Uc(y,C.mode,E),g.return=C,g):(g=s(g,y.children||[]),g.return=C,g)}function m(C,g,y,E,j){return g===null||g.tag!==7?(g=ai(y,C.mode,E,j),g.return=C,g):(g=s(g,y),g.return=C,g)}function w(C,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=zc(""+g,C.mode,y),g.return=C,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ka:return y=jl(g.type,g.key,g.props,null,C.mode,y),y.ref=Oo(C,null,g),y.return=C,y;case bi:return g=Uc(g,C.mode,y),g.return=C,g;case As:var E=g._init;return w(C,E(g._payload),y)}if(Wo(g)||Io(g))return g=ai(g,C.mode,y,null),g.return=C,g;ol(C,g)}return null}function S(C,g,y,E){var j=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return j!==null?null:l(C,g,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ka:return y.key===j?d(C,g,y,E):null;case bi:return y.key===j?h(C,g,y,E):null;case As:return j=y._init,S(C,g,j(y._payload),E)}if(Wo(y)||Io(y))return j!==null?null:m(C,g,y,E,null);ol(C,y)}return null}function _(C,g,y,E,j){if(typeof E=="string"&&E!==""||typeof E=="number")return C=C.get(y)||null,l(g,C,""+E,j);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ka:return C=C.get(E.key===null?y:E.key)||null,d(g,C,E,j);case bi:return C=C.get(E.key===null?y:E.key)||null,h(g,C,E,j);case As:var T=E._init;return _(C,g,y,T(E._payload),j)}if(Wo(E)||Io(E))return C=C.get(y)||null,m(g,C,E,j,null);ol(g,E)}return null}function L(C,g,y,E){for(var j=null,T=null,D=g,H=g=0,se=null;D!==null&&H<y.length;H++){D.index>H?(se=D,D=null):se=D.sibling;var V=S(C,D,y[H],E);if(V===null){D===null&&(D=se);break}e&&D&&V.alternate===null&&t(C,D),g=i(V,g,H),T===null?j=V:T.sibling=V,T=V,D=se}if(H===y.length)return n(C,D),Et&&Zs(C,H),j;if(D===null){for(;H<y.length;H++)D=w(C,y[H],E),D!==null&&(g=i(D,g,H),T===null?j=D:T.sibling=D,T=D);return Et&&Zs(C,H),j}for(D=r(C,D);H<y.length;H++)se=_(D,C,H,y[H],E),se!==null&&(e&&se.alternate!==null&&D.delete(se.key===null?H:se.key),g=i(se,g,H),T===null?j=se:T.sibling=se,T=se);return e&&D.forEach(function(K){return t(C,K)}),Et&&Zs(C,H),j}function F(C,g,y,E){var j=Io(y);if(typeof j!="function")throw Error(ae(150));if(y=j.call(y),y==null)throw Error(ae(151));for(var T=j=null,D=g,H=g=0,se=null,V=y.next();D!==null&&!V.done;H++,V=y.next()){D.index>H?(se=D,D=null):se=D.sibling;var K=S(C,D,V.value,E);if(K===null){D===null&&(D=se);break}e&&D&&K.alternate===null&&t(C,D),g=i(K,g,H),T===null?j=K:T.sibling=K,T=K,D=se}if(V.done)return n(C,D),Et&&Zs(C,H),j;if(D===null){for(;!V.done;H++,V=y.next())V=w(C,V.value,E),V!==null&&(g=i(V,g,H),T===null?j=V:T.sibling=V,T=V);return Et&&Zs(C,H),j}for(D=r(C,D);!V.done;H++,V=y.next())V=_(D,C,H,V.value,E),V!==null&&(e&&V.alternate!==null&&D.delete(V.key===null?H:V.key),g=i(V,g,H),T===null?j=V:T.sibling=V,T=V);return e&&D.forEach(function(ee){return t(C,ee)}),Et&&Zs(C,H),j}function X(C,g,y,E){if(typeof y=="object"&&y!==null&&y.type===Mi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ka:e:{for(var j=y.key,T=g;T!==null;){if(T.key===j){if(j=y.type,j===Mi){if(T.tag===7){n(C,T.sibling),g=s(T,y.props.children),g.return=C,C=g;break e}}else if(T.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===As&&$m(j)===T.type){n(C,T.sibling),g=s(T,y.props),g.ref=Oo(C,T,y),g.return=C,C=g;break e}n(C,T);break}else t(C,T);T=T.sibling}y.type===Mi?(g=ai(y.props.children,C.mode,E,y.key),g.return=C,C=g):(E=jl(y.type,y.key,y.props,null,C.mode,E),E.ref=Oo(C,g,y),E.return=C,C=E)}return a(C);case bi:e:{for(T=y.key;g!==null;){if(g.key===T)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(C,g.sibling),g=s(g,y.children||[]),g.return=C,C=g;break e}else{n(C,g);break}else t(C,g);g=g.sibling}g=Uc(y,C.mode,E),g.return=C,C=g}return a(C);case As:return T=y._init,X(C,g,T(y._payload),E)}if(Wo(y))return L(C,g,y,E);if(Io(y))return F(C,g,y,E);ol(C,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(C,g.sibling),g=s(g,y),g.return=C,C=g):(n(C,g),g=zc(y,C.mode,E),g.return=C,C=g),a(C)):n(C,g)}return X}var ro=Xg(!0),Kg=Xg(!1),Yl=Ys(null),Xl=null,Oi=null,Vf=null;function Yf(){Vf=Oi=Xl=null}function Xf(e){var t=Yl.current;xt(Yl),e._currentValue=t}function $d(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Vi(e,t){Xl=e,Vf=Oi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Mn=!0),e.firstContext=null)}function mr(e){var t=e._currentValue;if(Vf!==e)if(e={context:e,memoizedValue:t,next:null},Oi===null){if(Xl===null)throw Error(ae(308));Oi=e,Xl.dependencies={lanes:0,firstContext:e}}else Oi=Oi.next=e;return t}var ni=null;function Kf(e){ni===null?ni=[e]:ni.push(e)}function Qg(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Kf(t)):(n.next=s.next,s.next=n),t.interleaved=n,ds(e,r)}function ds(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Es=!1;function Qf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function is(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ze&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,ds(e,n)}return s=r.interleaved,s===null?(t.next=t,Kf(r)):(t.next=s.next,s.next=t),r.interleaved=t,ds(e,n)}function Sl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Lf(e,n)}}function Dm(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Kl(e,t,n,r){var s=e.updateQueue;Es=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var d=l,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var m=e.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==a&&(l===null?m.firstBaseUpdate=h:l.next=h,m.lastBaseUpdate=d))}if(i!==null){var w=s.baseState;a=0,m=h=d=null,l=i;do{var S=l.lane,_=l.eventTime;if((r&S)===S){m!==null&&(m=m.next={eventTime:_,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var L=e,F=l;switch(S=t,_=n,F.tag){case 1:if(L=F.payload,typeof L=="function"){w=L.call(_,w,S);break e}w=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=F.payload,S=typeof L=="function"?L.call(_,w,S):L,S==null)break e;w=Tt({},w,S);break e;case 2:Es=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,S=s.effects,S===null?s.effects=[l]:S.push(l))}else _={eventTime:_,lane:S,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(h=m=_,d=w):m=m.next=_,a|=S;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;S=l,l=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(!0);if(m===null&&(d=w),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);fi|=a,e.lanes=a,e.memoizedState=w}}function zm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ae(191,s));s.call(r)}}}var Ra={},Yr=Ys(Ra),xa=Ys(Ra),Sa=Ys(Ra);function ri(e){if(e===Ra)throw Error(ae(174));return e}function Jf(e,t){switch(pt(Sa,t),pt(xa,e),pt(Yr,Ra),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:wd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=wd(t,e)}xt(Yr),pt(Yr,t)}function so(){xt(Yr),xt(xa),xt(Sa)}function qg(e){ri(Sa.current);var t=ri(Yr.current),n=wd(t,e.type);t!==n&&(pt(xa,e),pt(Yr,n))}function qf(e){xa.current===e&&(xt(Yr),xt(xa))}var Nt=Ys(0);function Ql(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Lc=[];function Zf(){for(var e=0;e<Lc.length;e++)Lc[e]._workInProgressVersionPrimary=null;Lc.length=0}var kl=ms.ReactCurrentDispatcher,Bc=ms.ReactCurrentBatchConfig,di=0,bt=null,Vt=null,en=null,Jl=!1,ta=!1,ka=0,ww=0;function un(){throw Error(ae(321))}function eh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Mr(e[n],t[n]))return!1;return!0}function th(e,t,n,r,s,i){if(di=i,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,kl.current=e===null||e.memoizedState===null?Aw:Ew,e=n(r,s),ta){i=0;do{if(ta=!1,ka=0,25<=i)throw Error(ae(301));i+=1,en=Vt=null,t.updateQueue=null,kl.current=Cw,e=n(r,s)}while(ta)}if(kl.current=ql,t=Vt!==null&&Vt.next!==null,di=0,en=Vt=bt=null,Jl=!1,t)throw Error(ae(300));return e}function nh(){var e=ka!==0;return ka=0,e}function Hr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?bt.memoizedState=en=e:en=en.next=e,en}function gr(){if(Vt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Vt.next;var t=en===null?bt.memoizedState:en.next;if(t!==null)en=t,Vt=e;else{if(e===null)throw Error(ae(310));Vt=e,e={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},en===null?bt.memoizedState=en=e:en=en.next=e}return en}function Aa(e,t){return typeof t=="function"?t(e):t}function Fc(e){var t=gr(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=Vt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,d=null,h=i;do{var m=h.lane;if((di&m)===m)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var w={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(l=d=w,a=r):d=d.next=w,bt.lanes|=m,fi|=m}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=l,Mr(r,t.memoizedState)||(Mn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,bt.lanes|=i,fi|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Oc(e){var t=gr(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Mr(i,t.memoizedState)||(Mn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Zg(){}function e2(e,t){var n=bt,r=gr(),s=t(),i=!Mr(r.memoizedState,s);if(i&&(r.memoizedState=s,Mn=!0),r=r.queue,rh(r2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||en!==null&&en.memoizedState.tag&1){if(n.flags|=2048,Ea(9,n2.bind(null,n,r,s,t),void 0,null),tn===null)throw Error(ae(349));di&30||t2(n,t,s)}return s}function t2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function n2(e,t,n,r){t.value=n,t.getSnapshot=r,s2(t)&&i2(e)}function r2(e,t,n){return n(function(){s2(t)&&i2(e)})}function s2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Mr(e,n)}catch{return!0}}function i2(e){var t=ds(e,1);t!==null&&br(t,e,1,-1)}function Um(e){var t=Hr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:e},t.queue=e,e=e.dispatch=kw.bind(null,bt,e),[t.memoizedState,e]}function Ea(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function o2(){return gr().memoizedState}function Al(e,t,n,r){var s=Hr();bt.flags|=e,s.memoizedState=Ea(1|t,n,void 0,r===void 0?null:r)}function Cu(e,t,n,r){var s=gr();r=r===void 0?null:r;var i=void 0;if(Vt!==null){var a=Vt.memoizedState;if(i=a.destroy,r!==null&&eh(r,a.deps)){s.memoizedState=Ea(t,n,i,r);return}}bt.flags|=e,s.memoizedState=Ea(1|t,n,i,r)}function Hm(e,t){return Al(8390656,8,e,t)}function rh(e,t){return Cu(2048,8,e,t)}function a2(e,t){return Cu(4,2,e,t)}function l2(e,t){return Cu(4,4,e,t)}function u2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function c2(e,t,n){return n=n!=null?n.concat([e]):null,Cu(4,4,u2.bind(null,t,e),n)}function sh(){}function d2(e,t){var n=gr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&eh(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function f2(e,t){var n=gr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&eh(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function h2(e,t,n){return di&21?(Mr(n,t)||(n=vg(),bt.lanes|=n,fi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Mn=!0),e.memoizedState=n)}function xw(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=Bc.transition;Bc.transition={};try{e(!1),t()}finally{at=n,Bc.transition=r}}function p2(){return gr().memoizedState}function Sw(e,t,n){var r=Os(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},m2(e))g2(t,n);else if(n=Qg(e,t,n,r),n!==null){var s=wn();br(n,e,r,s),y2(n,t,r)}}function kw(e,t,n){var r=Os(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(m2(e))g2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Mr(l,a)){var d=t.interleaved;d===null?(s.next=s,Kf(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=Qg(e,t,s,r),n!==null&&(s=wn(),br(n,e,r,s),y2(n,t,r))}}function m2(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function g2(e,t){ta=Jl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function y2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Lf(e,n)}}var ql={readContext:mr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},Aw={readContext:mr,useCallback:function(e,t){return Hr().memoizedState=[e,t===void 0?null:t],e},useContext:mr,useEffect:Hm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Al(4194308,4,u2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Al(4194308,4,e,t)},useInsertionEffect:function(e,t){return Al(4,2,e,t)},useMemo:function(e,t){var n=Hr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Sw.bind(null,bt,e),[r.memoizedState,e]},useRef:function(e){var t=Hr();return e={current:e},t.memoizedState=e},useState:Um,useDebugValue:sh,useDeferredValue:function(e){return Hr().memoizedState=e},useTransition:function(){var e=Um(!1),t=e[0];return e=xw.bind(null,e[1]),Hr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=bt,s=Hr();if(Et){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=t(),tn===null)throw Error(ae(349));di&30||t2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Hm(r2.bind(null,r,i,e),[e]),r.flags|=2048,Ea(9,n2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Hr(),t=tn.identifierPrefix;if(Et){var n=rs,r=ns;n=(r&~(1<<32-Nr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ka++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ww++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ew={readContext:mr,useCallback:d2,useContext:mr,useEffect:rh,useImperativeHandle:c2,useInsertionEffect:a2,useLayoutEffect:l2,useMemo:f2,useReducer:Fc,useRef:o2,useState:function(){return Fc(Aa)},useDebugValue:sh,useDeferredValue:function(e){var t=gr();return h2(t,Vt.memoizedState,e)},useTransition:function(){var e=Fc(Aa)[0],t=gr().memoizedState;return[e,t]},useMutableSource:Zg,useSyncExternalStore:e2,useId:p2,unstable_isNewReconciler:!1},Cw={readContext:mr,useCallback:d2,useContext:mr,useEffect:rh,useImperativeHandle:c2,useInsertionEffect:a2,useLayoutEffect:l2,useMemo:f2,useReducer:Oc,useRef:o2,useState:function(){return Oc(Aa)},useDebugValue:sh,useDeferredValue:function(e){var t=gr();return Vt===null?t.memoizedState=e:h2(t,Vt.memoizedState,e)},useTransition:function(){var e=Oc(Aa)[0],t=gr().memoizedState;return[e,t]},useMutableSource:Zg,useSyncExternalStore:e2,useId:p2,unstable_isNewReconciler:!1};function Er(e,t){if(e&&e.defaultProps){t=Tt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Dd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Tt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var _u={isMounted:function(e){return(e=e._reactInternals)?yi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=wn(),s=Os(e),i=is(r,s);i.payload=t,n!=null&&(i.callback=n),t=Bs(e,i,s),t!==null&&(br(t,e,s,r),Sl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=wn(),s=Os(e),i=is(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Bs(e,i,s),t!==null&&(br(t,e,s,r),Sl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=wn(),r=Os(e),s=is(n,r);s.tag=2,t!=null&&(s.callback=t),t=Bs(e,s,r),t!==null&&(br(t,e,r,n),Sl(t,e,r))}};function Gm(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!ga(n,r)||!ga(s,i):!0}function v2(e,t,n){var r=!1,s=Hs,i=t.contextType;return typeof i=="object"&&i!==null?i=mr(i):(s=Pn(t)?ui:pn.current,r=t.contextTypes,i=(r=r!=null)?to(e,s):Hs),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_u,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Wm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&_u.enqueueReplaceState(t,t.state,null)}function zd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Qf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=mr(i):(i=Pn(t)?ui:pn.current,s.context=to(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Dd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&_u.enqueueReplaceState(s,s.state,null),Kl(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function io(e,t){try{var n="",r=t;do n+=Z3(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function $c(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ud(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _w=typeof WeakMap=="function"?WeakMap:Map;function w2(e,t,n){n=is(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){eu||(eu=!0,qd=r),Ud(e,t)},n}function x2(e,t,n){n=is(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Ud(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ud(e,t),typeof r!="function"&&(Fs===null?Fs=new Set([this]):Fs.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Vm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new _w;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Dw.bind(null,e,t,n),t.then(e,e))}function Ym(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Xm(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=is(-1,1),t.tag=2,Bs(n,t,1))),n.lanes|=1),e)}var jw=ms.ReactCurrentOwner,Mn=!1;function vn(e,t,n,r){t.child=e===null?Kg(t,null,n,r):ro(t,e.child,n,r)}function Km(e,t,n,r,s){n=n.render;var i=t.ref;return Vi(t,s),r=th(e,t,n,r,i,s),n=nh(),e!==null&&!Mn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fs(e,t,s)):(Et&&n&&Hf(t),t.flags|=1,vn(e,t,r,s),t.child)}function Qm(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!fh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,S2(e,t,i,r,s)):(e=jl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ga,n(a,r)&&e.ref===t.ref)return fs(e,t,s)}return t.flags|=1,e=$s(i,r),e.ref=t.ref,e.return=t,t.child=e}function S2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(ga(i,r)&&e.ref===t.ref)if(Mn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Mn=!0);else return t.lanes=e.lanes,fs(e,t,s)}return Hd(e,t,n,r,s)}function k2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(Di,Yn),Yn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,pt(Di,Yn),Yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,pt(Di,Yn),Yn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,pt(Di,Yn),Yn|=r;return vn(e,t,s,n),t.child}function A2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Hd(e,t,n,r,s){var i=Pn(n)?ui:pn.current;return i=to(t,i),Vi(t,s),n=th(e,t,n,r,i,s),r=nh(),e!==null&&!Mn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fs(e,t,s)):(Et&&r&&Hf(t),t.flags|=1,vn(e,t,n,s),t.child)}function Jm(e,t,n,r,s){if(Pn(n)){var i=!0;Gl(t)}else i=!1;if(Vi(t,s),t.stateNode===null)El(e,t),v2(t,n,r),zd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=mr(h):(h=Pn(n)?ui:pn.current,h=to(t,h));var m=n.getDerivedStateFromProps,w=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||d!==h)&&Wm(t,a,r,h),Es=!1;var S=t.memoizedState;a.state=S,Kl(t,r,a,s),d=t.memoizedState,l!==r||S!==d||Tn.current||Es?(typeof m=="function"&&(Dd(t,n,m,r),d=t.memoizedState),(l=Es||Gm(t,n,l,r,S,d,h))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Jg(e,t),l=t.memoizedProps,h=t.type===t.elementType?l:Er(t.type,l),a.props=h,w=t.pendingProps,S=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=mr(d):(d=Pn(n)?ui:pn.current,d=to(t,d));var _=n.getDerivedStateFromProps;(m=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==w||S!==d)&&Wm(t,a,r,d),Es=!1,S=t.memoizedState,a.state=S,Kl(t,r,a,s);var L=t.memoizedState;l!==w||S!==L||Tn.current||Es?(typeof _=="function"&&(Dd(t,n,_,r),L=t.memoizedState),(h=Es||Gm(t,n,h,r,S,L,d)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,L,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,L,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=L),a.props=r,a.state=L,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),r=!1)}return Gd(e,t,n,r,i,s)}function Gd(e,t,n,r,s,i){A2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&Bm(t,n,!1),fs(e,t,i);r=t.stateNode,jw.current=t;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=ro(t,e.child,null,i),t.child=ro(t,null,l,i)):vn(e,t,l,i),t.memoizedState=r.state,s&&Bm(t,n,!0),t.child}function E2(e){var t=e.stateNode;t.pendingContext?Lm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lm(e,t.context,!1),Jf(e,t.containerInfo)}function qm(e,t,n,r,s){return no(),Wf(s),t.flags|=256,vn(e,t,n,r),t.child}var Wd={dehydrated:null,treeContext:null,retryLane:0};function Vd(e){return{baseLanes:e,cachePool:null,transitions:null}}function C2(e,t,n){var r=t.pendingProps,s=Nt.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),pt(Nt,s&1),e===null)return Od(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=bu(a,r,0,null),e=ai(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Vd(n),t.memoizedState=Wd,e):ih(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Nw(e,t,a,r,l,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,l=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=$s(s,d),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=$s(l,i):(i=ai(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Vd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Wd,r}return i=e.child,e=i.sibling,r=$s(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function ih(e,t){return t=bu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function al(e,t,n,r){return r!==null&&Wf(r),ro(t,e.child,null,n),e=ih(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Nw(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=$c(Error(ae(422))),al(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=bu({mode:"visible",children:r.children},s,0,null),i=ai(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&ro(t,e.child,null,a),t.child.memoizedState=Vd(a),t.memoizedState=Wd,i);if(!(t.mode&1))return al(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(ae(419)),r=$c(i,r,void 0),al(e,t,a,r)}if(l=(a&e.childLanes)!==0,Mn||l){if(r=tn,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ds(e,s),br(r,e,s,-1))}return dh(),r=$c(Error(ae(421))),al(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=zw.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Xn=Ls(s.nextSibling),Kn=t,Et=!0,_r=null,e!==null&&(ur[cr++]=ns,ur[cr++]=rs,ur[cr++]=ci,ns=e.id,rs=e.overflow,ci=t),t=ih(t,r.children),t.flags|=4096,t)}function Zm(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),$d(e.return,t,n)}function Dc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function _2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(vn(e,t,r.children,n),r=Nt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zm(e,n,t);else if(e.tag===19)Zm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(pt(Nt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Ql(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Dc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ql(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Dc(t,!0,n,null,i);break;case"together":Dc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function El(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),fi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ae(153));if(t.child!==null){for(e=t.child,n=$s(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=$s(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function bw(e,t,n){switch(t.tag){case 3:E2(t),no();break;case 5:qg(t);break;case 1:Pn(t.type)&&Gl(t);break;case 4:Jf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;pt(Yl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(pt(Nt,Nt.current&1),t.flags|=128,null):n&t.child.childLanes?C2(e,t,n):(pt(Nt,Nt.current&1),e=fs(e,t,n),e!==null?e.sibling:null);pt(Nt,Nt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return _2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),pt(Nt,Nt.current),r)break;return null;case 22:case 23:return t.lanes=0,k2(e,t,n)}return fs(e,t,n)}var j2,Yd,N2,b2;j2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Yd=function(){};N2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ri(Yr.current);var i=null;switch(n){case"input":s=md(e,s),r=md(e,r),i=[];break;case"select":s=Tt({},s,{value:void 0}),r=Tt({},r,{value:void 0}),i=[];break;case"textarea":s=vd(e,s),r=vd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ul)}xd(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ua.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==l&&(d!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&l[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,l=l?l.__html:void 0,d!=null&&l!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(ua.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&wt("scroll",e),i||l===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};b2=function(e,t,n,r){n!==r&&(t.flags|=4)};function $o(e,t){if(!Et)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Mw(e,t,n){var r=t.pendingProps;switch(Gf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(t),null;case 1:return Pn(t.type)&&Hl(),cn(t),null;case 3:return r=t.stateNode,so(),xt(Tn),xt(pn),Zf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(il(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_r!==null&&(tf(_r),_r=null))),Yd(e,t),cn(t),null;case 5:qf(t);var s=ri(Sa.current);if(n=t.type,e!==null&&t.stateNode!=null)N2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ae(166));return cn(t),null}if(e=ri(Yr.current),il(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Wr]=t,r[wa]=i,e=(t.mode&1)!==0,n){case"dialog":wt("cancel",r),wt("close",r);break;case"iframe":case"object":case"embed":wt("load",r);break;case"video":case"audio":for(s=0;s<Yo.length;s++)wt(Yo[s],r);break;case"source":wt("error",r);break;case"img":case"image":case"link":wt("error",r),wt("load",r);break;case"details":wt("toggle",r);break;case"input":lm(r,i),wt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},wt("invalid",r);break;case"textarea":cm(r,i),wt("invalid",r)}xd(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&sl(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&sl(r.textContent,l,e),s=["children",""+l]):ua.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&wt("scroll",r)}switch(n){case"input":Qa(r),um(r,i,!0);break;case"textarea":Qa(r),dm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ul)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Wr]=t,e[wa]=r,j2(e,t,!1,!1),t.stateNode=e;e:{switch(a=Sd(n,r),n){case"dialog":wt("cancel",e),wt("close",e),s=r;break;case"iframe":case"object":case"embed":wt("load",e),s=r;break;case"video":case"audio":for(s=0;s<Yo.length;s++)wt(Yo[s],e);s=r;break;case"source":wt("error",e),s=r;break;case"img":case"image":case"link":wt("error",e),wt("load",e),s=r;break;case"details":wt("toggle",e),s=r;break;case"input":lm(e,r),s=md(e,r),wt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Tt({},r,{value:void 0}),wt("invalid",e);break;case"textarea":cm(e,r),s=vd(e,r),wt("invalid",e);break;default:s=r}xd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var d=l[i];i==="style"?og(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&sg(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&ca(e,d):typeof d=="number"&&ca(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ua.hasOwnProperty(i)?d!=null&&i==="onScroll"&&wt("scroll",e):d!=null&&bf(e,i,d,a))}switch(n){case"input":Qa(e),um(e,r,!1);break;case"textarea":Qa(e),dm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Us(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ui(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ui(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ul)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return cn(t),null;case 6:if(e&&t.stateNode!=null)b2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ae(166));if(n=ri(Sa.current),ri(Yr.current),il(t)){if(r=t.stateNode,n=t.memoizedProps,r[Wr]=t,(i=r.nodeValue!==n)&&(e=Kn,e!==null))switch(e.tag){case 3:sl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&sl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wr]=t,t.stateNode=r}return cn(t),null;case 13:if(xt(Nt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Et&&Xn!==null&&t.mode&1&&!(t.flags&128))Yg(),no(),t.flags|=98560,i=!1;else if(i=il(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ae(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ae(317));i[Wr]=t}else no(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;cn(t),i=!1}else _r!==null&&(tf(_r),_r=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Nt.current&1?Xt===0&&(Xt=3):dh())),t.updateQueue!==null&&(t.flags|=4),cn(t),null);case 4:return so(),Yd(e,t),e===null&&ya(t.stateNode.containerInfo),cn(t),null;case 10:return Xf(t.type._context),cn(t),null;case 17:return Pn(t.type)&&Hl(),cn(t),null;case 19:if(xt(Nt),i=t.memoizedState,i===null)return cn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)$o(i,!1);else{if(Xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ql(e),a!==null){for(t.flags|=128,$o(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return pt(Nt,Nt.current&1|2),t.child}e=e.sibling}i.tail!==null&&$t()>oo&&(t.flags|=128,r=!0,$o(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ql(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),$o(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Et)return cn(t),null}else 2*$t()-i.renderingStartTime>oo&&n!==1073741824&&(t.flags|=128,r=!0,$o(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$t(),t.sibling=null,n=Nt.current,pt(Nt,r?n&1|2:n&1),t):(cn(t),null);case 22:case 23:return ch(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Yn&1073741824&&(cn(t),t.subtreeFlags&6&&(t.flags|=8192)):cn(t),null;case 24:return null;case 25:return null}throw Error(ae(156,t.tag))}function Tw(e,t){switch(Gf(t),t.tag){case 1:return Pn(t.type)&&Hl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return so(),xt(Tn),xt(pn),Zf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return qf(t),null;case 13:if(xt(Nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ae(340));no()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xt(Nt),null;case 4:return so(),null;case 10:return Xf(t.type._context),null;case 22:case 23:return ch(),null;case 24:return null;default:return null}}var ll=!1,hn=!1,Pw=typeof WeakSet=="function"?WeakSet:Set,Se=null;function $i(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Lt(e,t,r)}else n.current=null}function Xd(e,t,n){try{n()}catch(r){Lt(e,t,r)}}var e1=!1;function Iw(e,t){if(Td=$l,e=Rg(),Uf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,d=-1,h=0,m=0,w=e,S=null;t:for(;;){for(var _;w!==n||s!==0&&w.nodeType!==3||(l=a+s),w!==i||r!==0&&w.nodeType!==3||(d=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(_=w.firstChild)!==null;)S=w,w=_;for(;;){if(w===e)break t;if(S===n&&++h===s&&(l=a),S===i&&++m===r&&(d=a),(_=w.nextSibling)!==null)break;w=S,S=w.parentNode}w=_}n=l===-1||d===-1?null:{start:l,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pd={focusedElem:e,selectionRange:n},$l=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var L=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var F=L.memoizedProps,X=L.memoizedState,C=t.stateNode,g=C.getSnapshotBeforeUpdate(t.elementType===t.type?F:Er(t.type,F),X);C.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(E){Lt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return L=e1,e1=!1,L}function na(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Xd(t,n,i)}s=s.next}while(s!==r)}}function ju(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Kd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function M2(e){var t=e.alternate;t!==null&&(e.alternate=null,M2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Wr],delete t[wa],delete t[Ld],delete t[mw],delete t[gw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function T2(e){return e.tag===5||e.tag===3||e.tag===4}function t1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||T2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Qd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ul));else if(r!==4&&(e=e.child,e!==null))for(Qd(e,t,n),e=e.sibling;e!==null;)Qd(e,t,n),e=e.sibling}function Jd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Jd(e,t,n),e=e.sibling;e!==null;)Jd(e,t,n),e=e.sibling}var on=null,Cr=!1;function Ss(e,t,n){for(n=n.child;n!==null;)P2(e,t,n),n=n.sibling}function P2(e,t,n){if(Vr&&typeof Vr.onCommitFiberUnmount=="function")try{Vr.onCommitFiberUnmount(wu,n)}catch{}switch(n.tag){case 5:hn||$i(n,t);case 6:var r=on,s=Cr;on=null,Ss(e,t,n),on=r,Cr=s,on!==null&&(Cr?(e=on,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):on.removeChild(n.stateNode));break;case 18:on!==null&&(Cr?(e=on,n=n.stateNode,e.nodeType===8?Ic(e.parentNode,n):e.nodeType===1&&Ic(e,n),pa(e)):Ic(on,n.stateNode));break;case 4:r=on,s=Cr,on=n.stateNode.containerInfo,Cr=!0,Ss(e,t,n),on=r,Cr=s;break;case 0:case 11:case 14:case 15:if(!hn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Xd(n,t,a),s=s.next}while(s!==r)}Ss(e,t,n);break;case 1:if(!hn&&($i(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Lt(n,t,l)}Ss(e,t,n);break;case 21:Ss(e,t,n);break;case 22:n.mode&1?(hn=(r=hn)||n.memoizedState!==null,Ss(e,t,n),hn=r):Ss(e,t,n);break;default:Ss(e,t,n)}}function n1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Pw),t.forEach(function(r){var s=Uw.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ar(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:on=l.stateNode,Cr=!1;break e;case 3:on=l.stateNode.containerInfo,Cr=!0;break e;case 4:on=l.stateNode.containerInfo,Cr=!0;break e}l=l.return}if(on===null)throw Error(ae(160));P2(i,a,s),on=null,Cr=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){Lt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)I2(t,e),t=t.sibling}function I2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ar(t,e),Fr(e),r&4){try{na(3,e,e.return),ju(3,e)}catch(F){Lt(e,e.return,F)}try{na(5,e,e.return)}catch(F){Lt(e,e.return,F)}}break;case 1:Ar(t,e),Fr(e),r&512&&n!==null&&$i(n,n.return);break;case 5:if(Ar(t,e),Fr(e),r&512&&n!==null&&$i(n,n.return),e.flags&32){var s=e.stateNode;try{ca(s,"")}catch(F){Lt(e,e.return,F)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,l=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&tg(s,i),Sd(l,a);var h=Sd(l,i);for(a=0;a<d.length;a+=2){var m=d[a],w=d[a+1];m==="style"?og(s,w):m==="dangerouslySetInnerHTML"?sg(s,w):m==="children"?ca(s,w):bf(s,m,w,h)}switch(l){case"input":gd(s,i);break;case"textarea":ng(s,i);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Ui(s,!!i.multiple,_,!1):S!==!!i.multiple&&(i.defaultValue!=null?Ui(s,!!i.multiple,i.defaultValue,!0):Ui(s,!!i.multiple,i.multiple?[]:"",!1))}s[wa]=i}catch(F){Lt(e,e.return,F)}}break;case 6:if(Ar(t,e),Fr(e),r&4){if(e.stateNode===null)throw Error(ae(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(F){Lt(e,e.return,F)}}break;case 3:if(Ar(t,e),Fr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{pa(t.containerInfo)}catch(F){Lt(e,e.return,F)}break;case 4:Ar(t,e),Fr(e);break;case 13:Ar(t,e),Fr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(lh=$t())),r&4&&n1(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(hn=(h=hn)||m,Ar(t,e),hn=h):Ar(t,e),Fr(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!m&&e.mode&1)for(Se=e,m=e.child;m!==null;){for(w=Se=m;Se!==null;){switch(S=Se,_=S.child,S.tag){case 0:case 11:case 14:case 15:na(4,S,S.return);break;case 1:$i(S,S.return);var L=S.stateNode;if(typeof L.componentWillUnmount=="function"){r=S,n=S.return;try{t=r,L.props=t.memoizedProps,L.state=t.memoizedState,L.componentWillUnmount()}catch(F){Lt(r,n,F)}}break;case 5:$i(S,S.return);break;case 22:if(S.memoizedState!==null){s1(w);continue}}_!==null?(_.return=S,Se=_):s1(w)}m=m.sibling}e:for(m=null,w=e;;){if(w.tag===5){if(m===null){m=w;try{s=w.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=w.stateNode,d=w.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,l.style.display=ig("display",a))}catch(F){Lt(e,e.return,F)}}}else if(w.tag===6){if(m===null)try{w.stateNode.nodeValue=h?"":w.memoizedProps}catch(F){Lt(e,e.return,F)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===e)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===e)break e;for(;w.sibling===null;){if(w.return===null||w.return===e)break e;m===w&&(m=null),w=w.return}m===w&&(m=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Ar(t,e),Fr(e),r&4&&n1(e);break;case 21:break;default:Ar(t,e),Fr(e)}}function Fr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(T2(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ca(s,""),r.flags&=-33);var i=t1(e);Jd(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=t1(e);Qd(e,l,a);break;default:throw Error(ae(161))}}catch(d){Lt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Rw(e,t,n){Se=e,R2(e)}function R2(e,t,n){for(var r=(e.mode&1)!==0;Se!==null;){var s=Se,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||ll;if(!a){var l=s.alternate,d=l!==null&&l.memoizedState!==null||hn;l=ll;var h=hn;if(ll=a,(hn=d)&&!h)for(Se=s;Se!==null;)a=Se,d=a.child,a.tag===22&&a.memoizedState!==null?i1(s):d!==null?(d.return=a,Se=d):i1(s);for(;i!==null;)Se=i,R2(i),i=i.sibling;Se=s,ll=l,hn=h}r1(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Se=i):r1(e)}}function r1(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:hn||ju(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!hn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Er(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&zm(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}zm(t,a,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var w=m.dehydrated;w!==null&&pa(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}hn||t.flags&512&&Kd(t)}catch(S){Lt(t,t.return,S)}}if(t===e){Se=null;break}if(n=t.sibling,n!==null){n.return=t.return,Se=n;break}Se=t.return}}function s1(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Se=n;break}Se=t.return}}function i1(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ju(4,t)}catch(d){Lt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){Lt(t,s,d)}}var i=t.return;try{Kd(t)}catch(d){Lt(t,i,d)}break;case 5:var a=t.return;try{Kd(t)}catch(d){Lt(t,a,d)}}}catch(d){Lt(t,t.return,d)}if(t===e){Se=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Se=l;break}Se=t.return}}var Lw=Math.ceil,Zl=ms.ReactCurrentDispatcher,oh=ms.ReactCurrentOwner,pr=ms.ReactCurrentBatchConfig,Ze=0,tn=null,Ut=null,an=0,Yn=0,Di=Ys(0),Xt=0,Ca=null,fi=0,Nu=0,ah=0,ra=null,bn=null,lh=0,oo=1/0,qr=null,eu=!1,qd=null,Fs=null,ul=!1,Ts=null,tu=0,sa=0,Zd=null,Cl=-1,_l=0;function wn(){return Ze&6?$t():Cl!==-1?Cl:Cl=$t()}function Os(e){return e.mode&1?Ze&2&&an!==0?an&-an:vw.transition!==null?(_l===0&&(_l=vg()),_l):(e=at,e!==0||(e=window.event,e=e===void 0?16:Cg(e.type)),e):1}function br(e,t,n,r){if(50<sa)throw sa=0,Zd=null,Error(ae(185));Ta(e,n,r),(!(Ze&2)||e!==tn)&&(e===tn&&(!(Ze&2)&&(Nu|=n),Xt===4&&js(e,an)),In(e,r),n===1&&Ze===0&&!(t.mode&1)&&(oo=$t()+500,Eu&&Xs()))}function In(e,t){var n=e.callbackNode;v4(e,t);var r=Ol(e,e===tn?an:0);if(r===0)n!==null&&pm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&pm(n),t===1)e.tag===0?yw(o1.bind(null,e)):Gg(o1.bind(null,e)),hw(function(){!(Ze&6)&&Xs()}),n=null;else{switch(wg(r)){case 1:n=Rf;break;case 4:n=gg;break;case 16:n=Fl;break;case 536870912:n=yg;break;default:n=Fl}n=U2(n,L2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function L2(e,t){if(Cl=-1,_l=0,Ze&6)throw Error(ae(327));var n=e.callbackNode;if(Yi()&&e.callbackNode!==n)return null;var r=Ol(e,e===tn?an:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=nu(e,r);else{t=r;var s=Ze;Ze|=2;var i=F2();(tn!==e||an!==t)&&(qr=null,oo=$t()+500,oi(e,t));do try{Ow();break}catch(l){B2(e,l)}while(!0);Yf(),Zl.current=i,Ze=s,Ut!==null?t=0:(tn=null,an=0,t=Xt)}if(t!==0){if(t===2&&(s=_d(e),s!==0&&(r=s,t=ef(e,s))),t===1)throw n=Ca,oi(e,0),js(e,r),In(e,$t()),n;if(t===6)js(e,r);else{if(s=e.current.alternate,!(r&30)&&!Bw(s)&&(t=nu(e,r),t===2&&(i=_d(e),i!==0&&(r=i,t=ef(e,i))),t===1))throw n=Ca,oi(e,0),js(e,r),In(e,$t()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(ae(345));case 2:ei(e,bn,qr);break;case 3:if(js(e,r),(r&130023424)===r&&(t=lh+500-$t(),10<t)){if(Ol(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){wn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Rd(ei.bind(null,e,bn,qr),t);break}ei(e,bn,qr);break;case 4:if(js(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Nr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lw(r/1960))-r,10<r){e.timeoutHandle=Rd(ei.bind(null,e,bn,qr),r);break}ei(e,bn,qr);break;case 5:ei(e,bn,qr);break;default:throw Error(ae(329))}}}return In(e,$t()),e.callbackNode===n?L2.bind(null,e):null}function ef(e,t){var n=ra;return e.current.memoizedState.isDehydrated&&(oi(e,t).flags|=256),e=nu(e,t),e!==2&&(t=bn,bn=n,t!==null&&tf(t)),e}function tf(e){bn===null?bn=e:bn.push.apply(bn,e)}function Bw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Mr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function js(e,t){for(t&=~ah,t&=~Nu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Nr(t),r=1<<n;e[n]=-1,t&=~r}}function o1(e){if(Ze&6)throw Error(ae(327));Yi();var t=Ol(e,0);if(!(t&1))return In(e,$t()),null;var n=nu(e,t);if(e.tag!==0&&n===2){var r=_d(e);r!==0&&(t=r,n=ef(e,r))}if(n===1)throw n=Ca,oi(e,0),js(e,t),In(e,$t()),n;if(n===6)throw Error(ae(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ei(e,bn,qr),In(e,$t()),null}function uh(e,t){var n=Ze;Ze|=1;try{return e(t)}finally{Ze=n,Ze===0&&(oo=$t()+500,Eu&&Xs())}}function hi(e){Ts!==null&&Ts.tag===0&&!(Ze&6)&&Yi();var t=Ze;Ze|=1;var n=pr.transition,r=at;try{if(pr.transition=null,at=1,e)return e()}finally{at=r,pr.transition=n,Ze=t,!(Ze&6)&&Xs()}}function ch(){Yn=Di.current,xt(Di)}function oi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,fw(n)),Ut!==null)for(n=Ut.return;n!==null;){var r=n;switch(Gf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Hl();break;case 3:so(),xt(Tn),xt(pn),Zf();break;case 5:qf(r);break;case 4:so();break;case 13:xt(Nt);break;case 19:xt(Nt);break;case 10:Xf(r.type._context);break;case 22:case 23:ch()}n=n.return}if(tn=e,Ut=e=$s(e.current,null),an=Yn=t,Xt=0,Ca=null,ah=Nu=fi=0,bn=ra=null,ni!==null){for(t=0;t<ni.length;t++)if(n=ni[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ni=null}return e}function B2(e,t){do{var n=Ut;try{if(Yf(),kl.current=ql,Jl){for(var r=bt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Jl=!1}if(di=0,en=Vt=bt=null,ta=!1,ka=0,oh.current=null,n===null||n.return===null){Xt=1,Ca=t,Ut=null;break}e:{var i=e,a=n.return,l=n,d=t;if(t=an,l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,m=l,w=m.tag;if(!(m.mode&1)&&(w===0||w===11||w===15)){var S=m.alternate;S?(m.updateQueue=S.updateQueue,m.memoizedState=S.memoizedState,m.lanes=S.lanes):(m.updateQueue=null,m.memoizedState=null)}var _=Ym(a);if(_!==null){_.flags&=-257,Xm(_,a,l,i,t),_.mode&1&&Vm(i,h,t),t=_,d=h;var L=t.updateQueue;if(L===null){var F=new Set;F.add(d),t.updateQueue=F}else L.add(d);break e}else{if(!(t&1)){Vm(i,h,t),dh();break e}d=Error(ae(426))}}else if(Et&&l.mode&1){var X=Ym(a);if(X!==null){!(X.flags&65536)&&(X.flags|=256),Xm(X,a,l,i,t),Wf(io(d,l));break e}}i=d=io(d,l),Xt!==4&&(Xt=2),ra===null?ra=[i]:ra.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var C=w2(i,d,t);Dm(i,C);break e;case 1:l=d;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Fs===null||!Fs.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var E=x2(i,l,t);Dm(i,E);break e}}i=i.return}while(i!==null)}$2(n)}catch(j){t=j,Ut===n&&n!==null&&(Ut=n=n.return);continue}break}while(!0)}function F2(){var e=Zl.current;return Zl.current=ql,e===null?ql:e}function dh(){(Xt===0||Xt===3||Xt===2)&&(Xt=4),tn===null||!(fi&268435455)&&!(Nu&268435455)||js(tn,an)}function nu(e,t){var n=Ze;Ze|=2;var r=F2();(tn!==e||an!==t)&&(qr=null,oi(e,t));do try{Fw();break}catch(s){B2(e,s)}while(!0);if(Yf(),Ze=n,Zl.current=r,Ut!==null)throw Error(ae(261));return tn=null,an=0,Xt}function Fw(){for(;Ut!==null;)O2(Ut)}function Ow(){for(;Ut!==null&&!u4();)O2(Ut)}function O2(e){var t=z2(e.alternate,e,Yn);e.memoizedProps=e.pendingProps,t===null?$2(e):Ut=t,oh.current=null}function $2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Tw(n,t),n!==null){n.flags&=32767,Ut=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xt=6,Ut=null;return}}else if(n=Mw(n,t,Yn),n!==null){Ut=n;return}if(t=t.sibling,t!==null){Ut=t;return}Ut=t=e}while(t!==null);Xt===0&&(Xt=5)}function ei(e,t,n){var r=at,s=pr.transition;try{pr.transition=null,at=1,$w(e,t,n,r)}finally{pr.transition=s,at=r}return null}function $w(e,t,n,r){do Yi();while(Ts!==null);if(Ze&6)throw Error(ae(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ae(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(w4(e,i),e===tn&&(Ut=tn=null,an=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ul||(ul=!0,U2(Fl,function(){return Yi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=pr.transition,pr.transition=null;var a=at;at=1;var l=Ze;Ze|=4,oh.current=null,Iw(e,n),I2(n,e),iw(Pd),$l=!!Td,Pd=Td=null,e.current=n,Rw(n),c4(),Ze=l,at=a,pr.transition=i}else e.current=n;if(ul&&(ul=!1,Ts=e,tu=s),i=e.pendingLanes,i===0&&(Fs=null),h4(n.stateNode),In(e,$t()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(eu)throw eu=!1,e=qd,qd=null,e;return tu&1&&e.tag!==0&&Yi(),i=e.pendingLanes,i&1?e===Zd?sa++:(sa=0,Zd=e):sa=0,Xs(),null}function Yi(){if(Ts!==null){var e=wg(tu),t=pr.transition,n=at;try{if(pr.transition=null,at=16>e?16:e,Ts===null)var r=!1;else{if(e=Ts,Ts=null,tu=0,Ze&6)throw Error(ae(331));var s=Ze;for(Ze|=4,Se=e.current;Se!==null;){var i=Se,a=i.child;if(Se.flags&16){var l=i.deletions;if(l!==null){for(var d=0;d<l.length;d++){var h=l[d];for(Se=h;Se!==null;){var m=Se;switch(m.tag){case 0:case 11:case 15:na(8,m,i)}var w=m.child;if(w!==null)w.return=m,Se=w;else for(;Se!==null;){m=Se;var S=m.sibling,_=m.return;if(M2(m),m===h){Se=null;break}if(S!==null){S.return=_,Se=S;break}Se=_}}}var L=i.alternate;if(L!==null){var F=L.child;if(F!==null){L.child=null;do{var X=F.sibling;F.sibling=null,F=X}while(F!==null)}}Se=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Se=a;else e:for(;Se!==null;){if(i=Se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:na(9,i,i.return)}var C=i.sibling;if(C!==null){C.return=i.return,Se=C;break e}Se=i.return}}var g=e.current;for(Se=g;Se!==null;){a=Se;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,Se=y;else e:for(a=g;Se!==null;){if(l=Se,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ju(9,l)}}catch(j){Lt(l,l.return,j)}if(l===a){Se=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,Se=E;break e}Se=l.return}}if(Ze=s,Xs(),Vr&&typeof Vr.onPostCommitFiberRoot=="function")try{Vr.onPostCommitFiberRoot(wu,e)}catch{}r=!0}return r}finally{at=n,pr.transition=t}}return!1}function a1(e,t,n){t=io(n,t),t=w2(e,t,1),e=Bs(e,t,1),t=wn(),e!==null&&(Ta(e,1,t),In(e,t))}function Lt(e,t,n){if(e.tag===3)a1(e,e,n);else for(;t!==null;){if(t.tag===3){a1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fs===null||!Fs.has(r))){e=io(n,e),e=x2(t,e,1),t=Bs(t,e,1),e=wn(),t!==null&&(Ta(t,1,e),In(t,e));break}}t=t.return}}function Dw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=wn(),e.pingedLanes|=e.suspendedLanes&n,tn===e&&(an&n)===n&&(Xt===4||Xt===3&&(an&130023424)===an&&500>$t()-lh?oi(e,0):ah|=n),In(e,t)}function D2(e,t){t===0&&(e.mode&1?(t=Za,Za<<=1,!(Za&130023424)&&(Za=4194304)):t=1);var n=wn();e=ds(e,t),e!==null&&(Ta(e,t,n),In(e,n))}function zw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),D2(e,n)}function Uw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(t),D2(e,n)}var z2;z2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Tn.current)Mn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Mn=!1,bw(e,t,n);Mn=!!(e.flags&131072)}else Mn=!1,Et&&t.flags&1048576&&Wg(t,Vl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;El(e,t),e=t.pendingProps;var s=to(t,pn.current);Vi(t,n),s=th(null,t,r,e,s,n);var i=nh();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pn(r)?(i=!0,Gl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Qf(t),s.updater=_u,t.stateNode=s,s._reactInternals=t,zd(t,r,e,n),t=Gd(null,t,r,!0,i,n)):(t.tag=0,Et&&i&&Hf(t),vn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(El(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Gw(r),e=Er(r,e),s){case 0:t=Hd(null,t,r,e,n);break e;case 1:t=Jm(null,t,r,e,n);break e;case 11:t=Km(null,t,r,e,n);break e;case 14:t=Qm(null,t,r,Er(r.type,e),n);break e}throw Error(ae(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Hd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Jm(e,t,r,s,n);case 3:e:{if(E2(t),e===null)throw Error(ae(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Jg(e,t),Kl(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=io(Error(ae(423)),t),t=qm(e,t,r,n,s);break e}else if(r!==s){s=io(Error(ae(424)),t),t=qm(e,t,r,n,s);break e}else for(Xn=Ls(t.stateNode.containerInfo.firstChild),Kn=t,Et=!0,_r=null,n=Kg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(no(),r===s){t=fs(e,t,n);break e}vn(e,t,r,n)}t=t.child}return t;case 5:return qg(t),e===null&&Od(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Id(r,s)?a=null:i!==null&&Id(r,i)&&(t.flags|=32),A2(e,t),vn(e,t,a,n),t.child;case 6:return e===null&&Od(t),null;case 13:return C2(e,t,n);case 4:return Jf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ro(t,null,r,n):vn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Km(e,t,r,s,n);case 7:return vn(e,t,t.pendingProps,n),t.child;case 8:return vn(e,t,t.pendingProps.children,n),t.child;case 12:return vn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,pt(Yl,r._currentValue),r._currentValue=a,i!==null)if(Mr(i.value,a)){if(i.children===s.children&&!Tn.current){t=fs(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var d=l.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=is(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?d.next=d:(d.next=m.next,m.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),$d(i.return,n,t),l.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ae(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),$d(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}vn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Vi(t,n),s=mr(s),r=r(s),t.flags|=1,vn(e,t,r,n),t.child;case 14:return r=t.type,s=Er(r,t.pendingProps),s=Er(r.type,s),Qm(e,t,r,s,n);case 15:return S2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),El(e,t),t.tag=1,Pn(r)?(e=!0,Gl(t)):e=!1,Vi(t,n),v2(t,r,s),zd(t,r,s,n),Gd(null,t,r,!0,e,n);case 19:return _2(e,t,n);case 22:return k2(e,t,n)}throw Error(ae(156,t.tag))};function U2(e,t){return mg(e,t)}function Hw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(e,t,n,r){return new Hw(e,t,n,r)}function fh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gw(e){if(typeof e=="function")return fh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Tf)return 11;if(e===Pf)return 14}return 2}function $s(e,t){var n=e.alternate;return n===null?(n=fr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jl(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")fh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Mi:return ai(n.children,s,i,t);case Mf:a=8,s|=8;break;case dd:return e=fr(12,n,t,s|2),e.elementType=dd,e.lanes=i,e;case fd:return e=fr(13,n,t,s),e.elementType=fd,e.lanes=i,e;case hd:return e=fr(19,n,t,s),e.elementType=hd,e.lanes=i,e;case q0:return bu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Q0:a=10;break e;case J0:a=9;break e;case Tf:a=11;break e;case Pf:a=14;break e;case As:a=16,r=null;break e}throw Error(ae(130,e==null?e:typeof e,""))}return t=fr(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ai(e,t,n,r){return e=fr(7,e,r,t),e.lanes=n,e}function bu(e,t,n,r){return e=fr(22,e,r,t),e.elementType=q0,e.lanes=n,e.stateNode={isHidden:!1},e}function zc(e,t,n){return e=fr(6,e,null,t),e.lanes=n,e}function Uc(e,t,n){return t=fr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ww(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kc(0),this.expirationTimes=kc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function hh(e,t,n,r,s,i,a,l,d){return e=new Ww(e,t,n,l,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=fr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qf(i),e}function Vw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function H2(e){if(!e)return Hs;e=e._reactInternals;e:{if(yi(e)!==e||e.tag!==1)throw Error(ae(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ae(171))}if(e.tag===1){var n=e.type;if(Pn(n))return Hg(e,n,t)}return t}function G2(e,t,n,r,s,i,a,l,d){return e=hh(n,r,!0,e,s,i,a,l,d),e.context=H2(null),n=e.current,r=wn(),s=Os(n),i=is(r,s),i.callback=t??null,Bs(n,i,s),e.current.lanes=s,Ta(e,s,r),In(e,r),e}function Mu(e,t,n,r){var s=t.current,i=wn(),a=Os(s);return n=H2(n),t.context===null?t.context=n:t.pendingContext=n,t=is(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Bs(s,t,a),e!==null&&(br(e,s,a,i),Sl(e,s,a)),a}function ru(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function l1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ph(e,t){l1(e,t),(e=e.alternate)&&l1(e,t)}function Yw(){return null}var W2=typeof reportError=="function"?reportError:function(e){console.error(e)};function mh(e){this._internalRoot=e}Tu.prototype.render=mh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ae(409));Mu(e,t,null,null)};Tu.prototype.unmount=mh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hi(function(){Mu(null,e,null,null)}),t[cs]=null}};function Tu(e){this._internalRoot=e}Tu.prototype.unstable_scheduleHydration=function(e){if(e){var t=kg();e={blockedOn:null,target:e,priority:t};for(var n=0;n<_s.length&&t!==0&&t<_s[n].priority;n++);_s.splice(n,0,e),n===0&&Eg(e)}};function gh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Pu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function u1(){}function Xw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=ru(a);i.call(h)}}var a=G2(t,r,e,0,null,!1,!1,"",u1);return e._reactRootContainer=a,e[cs]=a.current,ya(e.nodeType===8?e.parentNode:e),hi(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=ru(d);l.call(h)}}var d=hh(e,0,!1,null,null,!1,!1,"",u1);return e._reactRootContainer=d,e[cs]=d.current,ya(e.nodeType===8?e.parentNode:e),hi(function(){Mu(t,d,n,r)}),d}function Iu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var d=ru(a);l.call(d)}}Mu(t,a,e,s)}else a=Xw(n,t,e,s,r);return ru(a)}xg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Vo(t.pendingLanes);n!==0&&(Lf(t,n|1),In(t,$t()),!(Ze&6)&&(oo=$t()+500,Xs()))}break;case 13:hi(function(){var r=ds(e,1);if(r!==null){var s=wn();br(r,e,1,s)}}),ph(e,1)}};Bf=function(e){if(e.tag===13){var t=ds(e,134217728);if(t!==null){var n=wn();br(t,e,134217728,n)}ph(e,134217728)}};Sg=function(e){if(e.tag===13){var t=Os(e),n=ds(e,t);if(n!==null){var r=wn();br(n,e,t,r)}ph(e,t)}};kg=function(){return at};Ag=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Ad=function(e,t,n){switch(t){case"input":if(gd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Au(r);if(!s)throw Error(ae(90));eg(r),gd(r,s)}}}break;case"textarea":ng(e,n);break;case"select":t=n.value,t!=null&&Ui(e,!!n.multiple,t,!1)}};ug=uh;cg=hi;var Kw={usingClientEntryPoint:!1,Events:[Ia,Ri,Au,ag,lg,uh]},Do={findFiberByHostInstance:ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qw={bundleType:Do.bundleType,version:Do.version,rendererPackageName:Do.rendererPackageName,rendererConfig:Do.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hg(e),e===null?null:e.stateNode},findFiberByHostInstance:Do.findFiberByHostInstance||Yw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cl.isDisabled&&cl.supportsFiber)try{wu=cl.inject(Qw),Vr=cl}catch{}}qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kw;qn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gh(t))throw Error(ae(200));return Vw(e,t,null,n)};qn.createRoot=function(e,t){if(!gh(e))throw Error(ae(299));var n=!1,r="",s=W2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=hh(e,1,!1,null,null,n,!1,r,s),e[cs]=t.current,ya(e.nodeType===8?e.parentNode:e),new mh(t)};qn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ae(188)):(e=Object.keys(e).join(","),Error(ae(268,e)));return e=hg(t),e=e===null?null:e.stateNode,e};qn.flushSync=function(e){return hi(e)};qn.hydrate=function(e,t,n){if(!Pu(t))throw Error(ae(200));return Iu(null,e,t,!0,n)};qn.hydrateRoot=function(e,t,n){if(!gh(e))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=W2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=G2(t,null,e,1,n??null,s,!1,i,a),e[cs]=t.current,ya(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Tu(t)};qn.render=function(e,t,n){if(!Pu(t))throw Error(ae(200));return Iu(null,e,t,!1,n)};qn.unmountComponentAtNode=function(e){if(!Pu(e))throw Error(ae(40));return e._reactRootContainer?(hi(function(){Iu(null,null,e,!1,function(){e._reactRootContainer=null,e[cs]=null})}),!0):!1};qn.unstable_batchedUpdates=uh;qn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Pu(n))throw Error(ae(200));if(e==null||e._reactInternals===void 0)throw Error(ae(38));return Iu(e,t,n,!1,r)};qn.version="18.3.1-next-f1338f8080-20240426";function V2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V2)}catch(e){console.error(e)}}V2(),V0.exports=qn;var Jw=V0.exports,c1=Jw;ud.createRoot=c1.createRoot,ud.hydrateRoot=c1.hydrateRoot;const Xi={},Y2="production",d1={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-server.onrender.com/api",healthUrl:"https://cfg-server.onrender.com/health"}},X2=d1[Y2]||d1.development,Ru=()=>{if(!(Xi!=null&&Xi.VITE_API_BASE_URL))return X2.baseUrl},qw=()=>{if(!(Xi!=null&&Xi.VITE_HEALTH_URL))return X2.healthUrl},Zw=async()=>{try{const e=await fetch(qw(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},ex=()=>Y2;function tx({onStart:e}){const[t,n]=N.useState("1"),[r,s]=N.useState("individual"),[i,a]=N.useState("15"),[l,d]=N.useState({status:"checking",version:"...",commit:"...",healthy:!1});N.useEffect(()=>{const S=async()=>{const L=await Zw();d(L),console.log("[StartDialog] Server health:",L)};S();const _=setInterval(S,3e4);return()=>clearInterval(_)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const S={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(S)},m=()=>{window.close()},w=()=>l.status==="checking"?"checking":l.healthy?"healthy":"unhealthy";return u.jsx("div",{className:"dialog-overlay",children:u.jsxs("div",{className:"dialog-box",children:[u.jsxs("div",{className:"dialog-header",children:[u.jsx("h2",{children:"The Creative Game"}),u.jsxs("div",{className:`server-health-indicator ${w()}`,title:`Server: ${l.status}
Version: ${l.version}
Commit: ${l.commit}
Environment: ${ex()}`,children:[u.jsx("span",{className:"health-light"}),u.jsx("span",{className:"health-text",children:"Server"})]})]}),u.jsxs("div",{className:"dialog-field",children:[u.jsx("label",{children:"ID:"}),u.jsx("input",{type:"text",value:t,onChange:S=>n(S.target.value)})]}),u.jsxs("div",{className:"dialog-field",children:[u.jsx("label",{children:"Condition:"}),u.jsxs("select",{value:r,onChange:S=>s(S.target.value),children:[u.jsx("option",{value:"individual",children:"individual"}),u.jsx("option",{value:"group",children:"group"})]})]}),u.jsxs("div",{className:"dialog-field",children:[u.jsx("label",{children:"Time (in minutes):"}),u.jsx("input",{type:"number",value:i,onChange:S=>a(S.target.value),min:"1"})]}),u.jsxs("div",{className:"dialog-buttons",children:[u.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),u.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),u.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),u.jsx("button",{className:"dialog-button cancel",onClick:m,children:"Cancel"})]})]})})}class f1{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const nx=.035;class rx{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=Ru(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),l=s-i;let d=0,h=0,m=0;n>=0&&n<60?(d=i,h=a,m=0):n<120?(d=a,h=i,m=0):n<180?(d=0,h=i,m=a):n<240?(d=0,h=a,m=i):n<300?(d=a,h=0,m=i):(d=i,h=0,m=a);const w=S=>{const _=Math.round((S+l)*255).toString(16);return _.length===1?"0"+_:_};return`#${w(d)}${w(h)}${w(m)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const l=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${l}

Please choose a different Session ID.`),this.stop(),new Error(l)):new Error(l)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/nx,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),l=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(S=>this.relativeToGrid(S)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:l,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:l,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(S=>this.relativeToGrid(S)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(S=>this.relativeToGrid(S)):null)),this.moves.push(h),this.persistMove(h).catch(S=>{console.error("[GameTracker] Failed to persist move to server:",S)});const m=this.getCurrentBraceletStatus(),w=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:l,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:m,lastKnownPlayer:w,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(S=>({status:S.status,elapsed:S.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(l=>l.timestamp>=s&&l.timestamp<=i);if(a.length>0){const l={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(l[h.status]=(l[h.status]||0)+1)});const d=Object.keys(l).reduce((h,m)=>l[h]>l[m]?h:m,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let Hc=null;const h1=()=>(Hc||(Hc=new rx),Hc),jr=.07,ia=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),jt=e=>Math.round(e*1e3)/1e3,sx=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[jt(i.position[0]-jr),jt(i.position[1])],[jt(i.position[0]+jr),jt(i.position[1])],[jt(i.position[0]),jt(i.position[1]-jr)],[jt(i.position[0]),jt(i.position[1]+jr)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},ix=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},nf=e=>e.map(t=>{const n=[],r=[[jt(t.position[0]-jr),jt(t.position[1])],[jt(t.position[0]+jr),jt(t.position[1])],[jt(t.position[0]),jt(t.position[1]-jr)],[jt(t.position[0]),jt(t.position[1]+jr)]];return e.forEach(s=>{r.forEach(i=>{jt(s.position[0])===i[0]&&jt(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),ox=e=>{const t=new Set;if(e.forEach((a,l)=>{a.forEach((d,h)=>{d&&t.add(`${l},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,l]=i.shift(),d=`${a},${l}`;s.has(d)||(s.add(d),n.forEach(([h,m])=>{const w=`${a+h},${l+m}`;t.has(w)&&!s.has(w)&&i.push([a+h,l+m])}))}return s.size===t.size},ax=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=jr)n.push(jt(i));const r=[];for(let i=-.7;i<0;i+=jr)r.push(jt(i));for(let i=0;i<=.77;i+=jr)r.push(jt(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const l=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);l!==-1&&d!==-1&&(s[d][l]=!0)}}),ox(s)},rf=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=ax(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},p1=e=>{if(e.length===0)return null;try{const t=e.map(m=>m[0]),n=e.map(m=>m[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(m=>{const w=Math.sqrt(Math.pow(m[0]-r,2)+Math.pow(m[1]-s,2));w<i&&(i=w,a=m)});const l=-a[0],d=-a[1],h=e.map(m=>[jt(m[0]+l),jt(m[1]+d)]);return h.sort((m,w)=>m[0]-w[0]||m[1]-w[1]),h}catch{return null}},lx=60,m1=.07,Gc=120;function ux({config:e,interfaceHidden:t=!1}){const[n,r]=N.useState(ia()),[s,i]=N.useState(null),[a,l]=N.useState({x:0,y:0}),[d,h]=N.useState(!0),[m,w]=N.useState(e.timeSeconds),[S,_]=N.useState(0),[L,F]=N.useState(null),[X,C]=N.useState(!0),[g,y]=N.useState(""),[E,j]=N.useState(!1),[T,D]=N.useState({blockSize:lx,bottomPadding:Gc}),H=N.useRef(null),se=N.useRef(new f1(e)),V=N.useRef(h1()),K=N.useRef(null),ee=N.useRef(Date.now()),q=N.useRef(Gc),te=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,Ae=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,xe="The experiment is done. Thank you very much for your participation!",ge=N.useCallback(()=>{const P=H.current;if(!P)return;const z=P.offsetWidth,J=P.offsetHeight;if(!z||!J)return;const ue=q.current||Gc;let $=Math.max(1,Math.min(z,J-ue)),v=Math.max(38,Math.min($*m1*.95,$/4)),R=Math.max(v*2.5,110);$=Math.max(1,Math.min(z,J-R)),v=Math.max(38,Math.min($*m1*.95,$/4)),R=Math.max(v*2.5,110),q.current=R,D(b=>{const M=Math.abs(b.blockSize-v),B=Math.abs(b.bottomPadding-R);return M<.5&&B<.5?b:{blockSize:v,bottomPadding:R}})},[]);N.useEffect(()=>(y(te),(async()=>{try{V.current.start(),await V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(z){console.error("[GameCanvas] Failed to initialize tracker:",z),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{C(!0),y(xe),j(!0),V.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,V.current.stop()}),[]),N.useEffect(()=>{ge()},[ge,t]),N.useEffect(()=>{const P=()=>{ge()};return P(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[ge]),N.useEffect(()=>{if(!d&&m>0){const P=setInterval(()=>{w(z=>z<=1?(clearInterval(P),C(!0),y(xe),j(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):z-1)},1e3);return()=>clearInterval(P)}},[d,m]),N.useEffect(()=>{r(P=>rf(nf(P),d))},[d]);const Z=()=>(Date.now()-ee.current)/1e3,oe=(P,z)=>{const J=H.current;if(!J)return 0;const ue=J.offsetHeight-q.current,$=Math.min(J.offsetWidth,ue),v=z==="x"?(J.offsetWidth-$)/2:(J.offsetHeight-q.current-$)/2;return(P-v)/$-.5},ne=(P,z)=>{const J=H.current;if(!J)return 0;const ue=J.offsetHeight-q.current,$=Math.min(J.offsetWidth,ue),v=z==="x"?(J.offsetWidth-$)/2:(J.offsetHeight-q.current-$)/2;return(P+.5)*$+v},ve=P=>{var $,v,R,b;const z=H.current.getBoundingClientRect(),J=P.clientX!==void 0?P.clientX:(v=($=P.touches)==null?void 0:$[0])==null?void 0:v.clientX,ue=P.clientY!==void 0?P.clientY:(b=(R=P.touches)==null?void 0:R[0])==null?void 0:b.clientY;return{x:J-z.left,y:ue-z.top}},Me=(P,z)=>{const J=n.find(R=>R.id===z);if(!J||!J.canMove)return;P.preventDefault();const ue=ve(P),$=ne(J.position[0],"x"),v=ne(J.position[1],"y");K.current=Date.now(),i(z),l({x:ue.x-$,y:ue.y-v})},Ie=P=>{if(s===null)return;P.preventDefault();const z=ve(P),J=oe(z.x-a.x,"x"),ue=oe(z.y-a.y,"y");r($=>$.map(v=>v.id===s?{...v,position:[J,ue]}:v))},De=()=>{try{const P=window.braceletDetectorVideo;if(!P||!P.videoWidth||P.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const z=document.createElement("canvas"),J=640,ue=480;let $=P.videoWidth,v=P.videoHeight;const R=$/v;return $>J&&($=J,v=$/R),v>ue&&(v=ue,$=v*R),z.width=Math.floor($),z.height=Math.floor(v),z.getContext("2d").drawImage(P,0,0,z.width,z.height),z.toDataURL("image/jpeg",.6)}catch(P){return console.error("[GameCanvas] Error capturing camera frame:",P),null}},Oe=()=>{if(s===null)return;const P=n.find(M=>M.id===s),z=sx(n,s),J=ix(z,P.position),ue=K.current?(Date.now()-K.current)/1e3:0,$=n.map(M=>M.id===s?{...M,position:J}:M),v=De(),R=window.currentBraceletStatus||"Unknown",b={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:Z(),unit:s,end_position:J,all_positions:$.map(M=>M.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:v,player:R};se.current.write(b),V.current.recordMove(b,ue,v),r(M=>{const B=M.map(U=>U.id===s?{...U,position:J}:U);return rf(nf(B),d)}),i(null),K.current=null},ze=()=>{const P=n.map(b=>b.position),z=p1(P),J=S+1,ue=De(),$=window.currentBraceletStatus||"Unknown",v={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:Z(),unit:null,end_position:null,all_positions:null,gallery_shape_number:J,gallery:P,gallery_normalized:z,camera_frame:ue,player:$};se.current.write(v),V.current.recordMove(v,0,ue);const R=Y();F(R),_(J)},Y=()=>{const P=document.createElement("canvas");P.width=400,P.height=400;const z=P.getContext("2d");z.fillStyle="#000",z.fillRect(0,0,400,400);const J=n.map($=>$.position),ue=p1(J);return ue&&ue.forEach($=>{const v=($[0]+.5)*400,R=($[1]+.5)*400;z.fillStyle="green",z.fillRect(v-15,R-15,30,30)}),P.toDataURL()},Q=N.useCallback(P=>{P.key==="p"&&d?(h(!1),C(!0),y(Ae),ee.current=Date.now(),r(ia()),F(null),_(0),se.current=new f1(e),V.current.stop(),V.current=h1(),V.current.start(),V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):P.key==="q"&&!d&&(C(!0),y(xe),j(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);N.useEffect(()=>(window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)),[Q]);const ye=()=>{if(E&&g===xe){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&g===Ae)try{const P=new(window.AudioContext||window.webkitAudioContext),z=P.createOscillator(),J=P.createGain();z.connect(J),J.connect(P.destination),z.frequency.setValueAtTime(800,P.currentTime),z.frequency.setValueAtTime(600,P.currentTime+.15),J.gain.setValueAtTime(.3,P.currentTime),J.gain.exponentialRampToValueAtTime(.01,P.currentTime+.3),z.start(P.currentTime),z.stop(P.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(P){console.error("[GameCanvas] Error playing sound:",P)}C(!1)},le=P=>{P.preventDefault()};return u.jsxs("div",{className:"game-canvas",ref:H,style:{"--block-size":`${T.blockSize}px`,"--bottom-padding":`${T.bottomPadding}px`},onMouseMove:Ie,onMouseUp:Oe,onMouseLeave:Oe,onTouchMove:Ie,onTouchEnd:Oe,onTouchCancel:Oe,onContextMenu:le,children:[u.jsx("div",{className:"gallery",onClick:ze,children:u.jsx("div",{className:"gallery-frame",children:L?u.jsx("img",{src:L,alt:"Gallery",className:"gallery-image"}):u.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&u.jsxs("div",{className:"timer",children:["Time: ",Math.floor(m/60),":",(m%60).toString().padStart(2,"0")]}),n.map(P=>u.jsx("div",{className:`block ${P.canMove?"movable":""}`,style:{left:`${ne(P.position[0],"x")}px`,top:`${ne(P.position[1],"y")}px`,backgroundColor:P.color||"green",cursor:P.canMove?"grab":"default"},onMouseDown:z=>Me(z,P.id),onTouchStart:z=>Me(z,P.id)},P.id)),X&&u.jsx("div",{className:"message-overlay",onClick:ye,children:u.jsxs("div",{className:"message-box",children:[g,u.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var su={};(function(){var e;function t(o){var c=0;return function(){return c<o.length?{done:!1,value:o[c++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof gc=="object"&&gc];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,c){if(c)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var x=o[p];if(!(x in f))break e;f=f[x]}o=o[o.length-1],p=f[o],c=c(p),c!=p&&c!=null&&n(f,o,{configurable:!0,writable:!0,value:c})}}i("Symbol",function(o){function c(A){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new f(p+(A||"")+"_"+x++,A)}function f(A,k){this.h=A,n(this,"description",{configurable:!0,writable:!0,value:k})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",x=0;return c}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<c.length;f++){var p=s[c[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function l(o){var c=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return c?c.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=l(o);for(var c,f=[];!(c=o.next()).done;)f.push(c.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,c){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(o[x]=p[x])}return o};i("Object.assign",function(o){return o||h});var m=typeof Object.create=="function"?Object.create:function(o){function c(){}return c.prototype=o,new c},w;if(typeof Object.setPrototypeOf=="function")w=Object.setPrototypeOf;else{var S;e:{var _={a:!0},L={};try{L.__proto__=_,S=L.a;break e}catch{}S=!1}w=S?function(o,c){if(o.__proto__=c,o.__proto__!==c)throw new TypeError(o+" is not extensible");return o}:null}var F=w;function X(o,c){if(o.prototype=m(c.prototype),o.prototype.constructor=o,F)F(o,c);else for(var f in c)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(c,f);p&&Object.defineProperty(o,f,p)}else o[f]=c[f];o.ya=c.prototype}function C(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function g(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}C.prototype.u=function(o){this.i=o};function y(o,c){o.l={ma:c,na:!0},o.h=o.s||o.v}C.prototype.return=function(o){this.l={return:o},this.h=this.v};function E(o,c,f){return o.h=f,{value:c}}function j(o){this.h=new C,this.i=o}function T(o,c){g(o.h);var f=o.h.j;return f?D(o,"return"in f?f.return:function(p){return{value:p,done:!0}},c,o.h.return):(o.h.return(c),H(o))}function D(o,c,f,p){try{var x=c.call(o.h.j,f);if(!(x instanceof Object))throw new TypeError("Iterator result "+x+" is not an object");if(!x.done)return o.h.m=!1,x;var A=x.value}catch(k){return o.h.j=null,y(o.h,k),H(o)}return o.h.j=null,p.call(o.h,A),H(o)}function H(o){for(;o.h.h;)try{var c=o.i(o.h);if(c)return o.h.m=!1,{value:c.value,done:!1}}catch(f){o.h.i=void 0,y(o.h,f)}if(o.h.m=!1,o.h.l){if(c=o.h.l,o.h.l=null,c.na)throw c.ma;return{value:c.return,done:!0}}return{value:void 0,done:!0}}function se(o){this.next=function(c){return g(o.h),o.h.j?c=D(o,o.h.j.next,c,o.h.u):(o.h.u(c),c=H(o)),c},this.throw=function(c){return g(o.h),o.h.j?c=D(o,o.h.j.throw,c,o.h.u):(y(o.h,c),c=H(o)),c},this.return=function(c){return T(o,c)},this[Symbol.iterator]=function(){return this}}function V(o){function c(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,x){function A(k){k.done?p(k.value):Promise.resolve(k.value).then(c,f).then(A,x)}A(o.next())})}function K(o){return V(new se(new j(o)))}i("Promise",function(o){function c(k){this.i=0,this.j=void 0,this.h=[],this.u=!1;var I=this.l();try{k(I.resolve,I.reject)}catch(G){I.reject(G)}}function f(){this.h=null}function p(k){return k instanceof c?k:new c(function(I){I(k)})}if(o)return o;f.prototype.i=function(k){if(this.h==null){this.h=[];var I=this;this.j(function(){I.m()})}this.h.push(k)};var x=s.setTimeout;f.prototype.j=function(k){x(k,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var k=this.h;this.h=[];for(var I=0;I<k.length;++I){var G=k[I];k[I]=null;try{G()}catch(ie){this.l(ie)}}}this.h=null},f.prototype.l=function(k){this.j(function(){throw k})},c.prototype.l=function(){function k(ie){return function(he){G||(G=!0,ie.call(I,he))}}var I=this,G=!1;return{resolve:k(this.I),reject:k(this.m)}},c.prototype.I=function(k){if(k===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(k instanceof c)this.L(k);else{e:switch(typeof k){case"object":var I=k!=null;break e;case"function":I=!0;break e;default:I=!1}I?this.F(k):this.s(k)}},c.prototype.F=function(k){var I=void 0;try{I=k.then}catch(G){this.m(G);return}typeof I=="function"?this.M(I,k):this.s(k)},c.prototype.m=function(k){this.v(2,k)},c.prototype.s=function(k){this.v(1,k)},c.prototype.v=function(k,I){if(this.i!=0)throw Error("Cannot settle("+k+", "+I+"): Promise already settled in state"+this.i);this.i=k,this.j=I,this.i===2&&this.K(),this.H()},c.prototype.K=function(){var k=this;x(function(){if(k.D()){var I=s.console;typeof I<"u"&&I.error(k.j)}},1)},c.prototype.D=function(){if(this.u)return!1;var k=s.CustomEvent,I=s.Event,G=s.dispatchEvent;return typeof G>"u"?!0:(typeof k=="function"?k=new k("unhandledrejection",{cancelable:!0}):typeof I=="function"?k=new I("unhandledrejection",{cancelable:!0}):(k=s.document.createEvent("CustomEvent"),k.initCustomEvent("unhandledrejection",!1,!0,k)),k.promise=this,k.reason=this.j,G(k))},c.prototype.H=function(){if(this.h!=null){for(var k=0;k<this.h.length;++k)A.i(this.h[k]);this.h=null}};var A=new f;return c.prototype.L=function(k){var I=this.l();k.T(I.resolve,I.reject)},c.prototype.M=function(k,I){var G=this.l();try{k.call(I,G.resolve,G.reject)}catch(ie){G.reject(ie)}},c.prototype.then=function(k,I){function G(je,we){return typeof je=="function"?function(Fe){try{ie(je(Fe))}catch(Ve){he(Ve)}}:we}var ie,he,Be=new c(function(je,we){ie=je,he=we});return this.T(G(k,ie),G(I,he)),Be},c.prototype.catch=function(k){return this.then(void 0,k)},c.prototype.T=function(k,I){function G(){switch(ie.i){case 1:k(ie.j);break;case 2:I(ie.j);break;default:throw Error("Unexpected state: "+ie.i)}}var ie=this;this.h==null?A.i(G):this.h.push(G),this.u=!0},c.resolve=p,c.reject=function(k){return new c(function(I,G){G(k)})},c.race=function(k){return new c(function(I,G){for(var ie=l(k),he=ie.next();!he.done;he=ie.next())p(he.value).T(I,G)})},c.all=function(k){var I=l(k),G=I.next();return G.done?p([]):new c(function(ie,he){function Be(Fe){return function(Ve){je[Fe]=Ve,we--,we==0&&ie(je)}}var je=[],we=0;do je.push(void 0),we++,p(G.value).T(Be(je.length-1),he),G=I.next();while(!G.done)})},c});function ee(o,c){o instanceof String&&(o+="");var f=0,p=!1,x={next:function(){if(!p&&f<o.length){var A=f++;return{value:c(A,o[A]),done:!1}}return p=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.keys",function(o){return o||function(){return ee(this,function(c){return c})}}),i("Array.prototype.fill",function(o){return o||function(c,f,p){var x=this.length||0;for(0>f&&(f=Math.max(0,x+f)),(p==null||p>x)&&(p=x),p=Number(p),0>p&&(p=Math.max(0,x+p)),f=Number(f||0);f<p;f++)this[f]=c;return this}});function q(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",q),i("Uint8Array.prototype.fill",q),i("Uint8ClampedArray.prototype.fill",q),i("Int16Array.prototype.fill",q),i("Uint16Array.prototype.fill",q),i("Int32Array.prototype.fill",q),i("Uint32Array.prototype.fill",q),i("Float32Array.prototype.fill",q),i("Float64Array.prototype.fill",q),i("Object.is",function(o){return o||function(c,f){return c===f?c!==0||1/c===1/f:c!==c&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(c,f){var p=this;p instanceof String&&(p=String(p));var x=p.length;for(f=f||0,0>f&&(f=Math.max(f+x,0));f<x;f++){var A=p[f];if(A===c||Object.is(A,c))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(c,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(c,f||0)!==-1}});var te=this||self;function Ae(o,c){o=o.split(".");var f=te;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||c===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=c}function xe(o){var c;e:{if((c=te.navigator)&&(c=c.userAgent))break e;c=""}return c.indexOf(o)!=-1}var ge=Array.prototype.map?function(o,c){return Array.prototype.map.call(o,c,void 0)}:function(o,c){for(var f=o.length,p=Array(f),x=typeof o=="string"?o.split(""):o,A=0;A<f;A++)A in x&&(p[A]=c.call(void 0,x[A],A,o));return p},Z={},oe=null;function ne(o){var c=o.length,f=3*c/4;f%3?f=Math.floor(f):"=.".indexOf(o[c-1])!=-1&&(f="=.".indexOf(o[c-2])!=-1?f-2:f-1);var p=new Uint8Array(f),x=0;return ve(o,function(A){p[x++]=A}),x!==f?p.subarray(0,x):p}function ve(o,c){function f(G){for(;p<o.length;){var ie=o.charAt(p++),he=oe[ie];if(he!=null)return he;if(!/^[\s\xa0]*$/.test(ie))throw Error("Unknown base64 encoding at char: "+ie)}return G}Me();for(var p=0;;){var x=f(-1),A=f(0),k=f(64),I=f(64);if(I===64&&x===-1)break;c(x<<2|A>>4),k!=64&&(c(A<<4&240|k>>2),I!=64&&c(k<<6&192|I))}}function Me(){if(!oe){oe={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(c[f].split(""));Z[f]=p;for(var x=0;x<p.length;x++){var A=p[x];oe[A]===void 0&&(oe[A]=x)}}}}var Ie=typeof Uint8Array<"u",De=!(xe("Trident")||xe("MSIE"))&&typeof te.btoa=="function";function Oe(o){if(!De){var c;c===void 0&&(c=0),Me(),c=Z[c];for(var f=Array(Math.floor(o.length/3)),p=c[64]||"",x=0,A=0;x<o.length-2;x+=3){var k=o[x],I=o[x+1],G=o[x+2],ie=c[k>>2];k=c[(k&3)<<4|I>>4],I=c[(I&15)<<2|G>>6],G=c[G&63],f[A++]=ie+k+I+G}switch(ie=0,G=p,o.length-x){case 2:ie=o[x+1],G=c[(ie&15)<<2]||p;case 1:o=o[x],f[A]=c[o>>2]+c[(o&3)<<4|ie>>4]+G+p}return f.join("")}for(c="";10240<o.length;)c+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return c+=String.fromCharCode.apply(null,o),btoa(c)}var ze=RegExp("[-_.]","g");function Y(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Q(o){if(!De)return ne(o);ze.test(o)&&(o=o.replace(ze,Y)),o=atob(o);for(var c=new Uint8Array(o.length),f=0;f<o.length;f++)c[f]=o.charCodeAt(f);return c}var ye;function le(){return ye||(ye=new Uint8Array(0))}var P={},z=typeof Uint8Array.prototype.slice=="function",J=0,ue=0;function $(o){var c=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),c&&(f=l(R(f,o)),c=f.next().value,o=f.next().value,f=c),J=f>>>0,ue=o>>>0}var v=typeof BigInt=="function";function R(o,c){return c=~c,o?o=~o+1:c+=1,[o,c]}function b(o,c){this.i=o>>>0,this.h=c>>>0}function M(o){if(!o)return B||(B=new b(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)$(Number(o));else if(v)o=BigInt(o),J=Number(o&BigInt(4294967295))>>>0,ue=Number(o>>BigInt(32)&BigInt(4294967295));else{var c=+(o[0]==="-");ue=J=0;for(var f=o.length,p=c,x=(f-c)%6+c;x<=f;p=x,x+=6)p=Number(o.slice(p,x)),ue*=1e6,J=1e6*J+p,4294967296<=J&&(ue+=J/4294967296|0,J%=4294967296);c&&(c=l(R(J,ue)),o=c.next().value,c=c.next().value,J=o,ue=c)}return new b(J,ue)}var B;function U(o,c){return Error("Invalid wire type: "+o+" (at position "+c+")")}function W(){return Error("Failed to read varint, encoding is invalid.")}function ce(o,c){return Error("Tried to read past the end of the data "+c+" > "+o)}function me(){throw Error("Invalid UTF8")}function Ce(o,c){return c=String.fromCharCode.apply(null,c),o==null?c:o+c}var Pe=void 0,Ue,Je=typeof TextDecoder<"u",tt,lt=typeof TextEncoder<"u",ut;function Ge(o){if(o!==P)throw Error("illegal external caller")}function He(o,c){if(Ge(c),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function We(){return ut||(ut=new He(null,P))}function Qe(o){Ge(P);var c=o.V;return c=c==null||Ie&&c!=null&&c instanceof Uint8Array?c:typeof c=="string"?Q(c):null,c==null?c:o.V=c}function kt(o){if(typeof o=="string")return{buffer:Q(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===He)return{buffer:Qe(o)||le(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Fn(o,c){this.i=null,this.m=!1,this.h=this.j=this.l=0,gt(this,o,c)}function gt(o,c,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,c&&(c=kt(c),o.i=c.buffer,o.m=c.C,o.l=0,o.j=o.i.length,o.h=o.l)}Fn.prototype.reset=function(){this.h=this.l};function zt(o,c){if(o.h=c,c>o.j)throw ce(o.j,c)}function Pt(o){var c=o.i,f=o.h,p=c[f++],x=p&127;if(p&128&&(p=c[f++],x|=(p&127)<<7,p&128&&(p=c[f++],x|=(p&127)<<14,p&128&&(p=c[f++],x|=(p&127)<<21,p&128&&(p=c[f++],x|=p<<28,p&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128)))))throw W();return zt(o,f),x}function nn(o,c){if(0>c)throw Error("Tried to read a negative byte length: "+c);var f=o.h,p=f+c;if(p>o.j)throw ce(c,o.j-f);return o.h=p,f}var Kt=[];function Qt(){this.h=[]}Qt.prototype.length=function(){return this.h.length},Qt.prototype.end=function(){var o=this.h;return this.h=[],o};function rr(o,c,f){for(;0<f||127<c;)o.h.push(c&127|128),c=(c>>>7|f<<25)>>>0,f>>>=7;o.h.push(c)}function Cn(o,c){for(;127<c;)o.h.push(c&127|128),c>>>=7;o.h.push(c)}function Qr(o,c){if(Kt.length){var f=Kt.pop();gt(f,o,c),o=f}else o=new Fn(o,c);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(c)}Qr.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},Qr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function On(o){var c=o.h;if(c.h==c.j)return!1;o.j=o.h.h;var f=Pt(o.h)>>>0;if(c=f>>>3,f&=7,!(0<=f&&5>=f))throw U(f,o.j);if(1>c)throw Error("Invalid field number: "+c+" (at position "+o.j+")");return o.l=c,o.i=f,!0}function Jr(o){switch(o.i){case 0:if(o.i!=0)Jr(o);else e:{o=o.h;for(var c=o.h,f=c+10,p=o.i;c<f;)if(!(p[c++]&128)){zt(o,c);break e}throw W()}break;case 1:o=o.h,zt(o,o.h+8);break;case 2:o.i!=2?Jr(o):(c=Pt(o.h)>>>0,o=o.h,zt(o,o.h+c));break;case 5:o=o.h,zt(o,o.h+4);break;case 3:c=o.l;do{if(!On(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=c)throw Error("Unmatched end-group tag");break}Jr(o)}while(!0);break;default:throw U(o.i,o.j)}}var Lr=[];function ys(){this.j=[],this.i=0,this.h=new Qt}function $n(o,c){c.length!==0&&(o.j.push(c),o.i+=c.length)}function wi(o,c){if(c=c.R){$n(o,o.h.end());for(var f=0;f<c.length;f++)$n(o,Qe(c[f])||le())}}var _n=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Dn(o,c){return _n?o[_n]|=c:o.A!==void 0?o.A|=c:(Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}}),c)}function vs(o,c){_n?o[_n]&&(o[_n]&=~c):o.A!==void 0&&(o.A&=~c)}function yt(o){var c;return _n?c=o[_n]:c=o.A,c??0}function zn(o,c){_n?o[_n]=c:o.A!==void 0?o.A=c:Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}})}function xi(o){return Dn(o,1),o}function O(o,c){zn(c,(o|0)&-51)}function de(o,c){zn(c,(o|18)&-41)}var pe={};function re(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var fe,Re=[];zn(Re,23),fe=Object.freeze(Re);function it(o){if(yt(o.o)&2)throw Error("Cannot mutate an immutable Message")}function qe(o){var c=o.length;(c=c?o[c-1]:void 0)&&re(c)?c.g=1:(c={},o.push((c.g=1,c)))}function Le(o){var c=o.i+o.G;return o.B||(o.B=o.o[c]={})}function $e(o,c){return c===-1?null:c>=o.i?o.B?o.B[c]:void 0:o.o[c+o.G]}function ct(o,c,f,p){it(o),mn(o,c,f,p)}function mn(o,c,f,p){o.j&&(o.j=void 0),c>=o.i||p?Le(o)[c]=f:(o.o[c+o.G]=f,(o=o.B)&&c in o&&delete o[c])}function gn(o,c,f,p){var x=$e(o,c);Array.isArray(x)||(x=fe);var A=yt(x);if(A&1||xi(x),p)A&2||Dn(x,2),f&1||Object.freeze(x);else{p=!(f&2);var k=A&2;f&1||!k?p&&A&16&&!k&&vs(x,16):(x=xi(Array.prototype.slice.call(x)),mn(o,c,x))}return x}function bo(o,c){var f=$e(o,c),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&mn(o,c,p),p}function Da(o,c,f,p,x){o.h||(o.h={});var A=o.h[f],k=gn(o,f,3,x);if(!A){var I=k;A=[];var G=!!(yt(o.o)&16);k=!!(yt(I)&2);var ie=I;!x&&k&&(I=Array.prototype.slice.call(I));for(var he=k,Be=0;Be<I.length;Be++){var je=I[Be],we=c,Fe=!1;if(Fe=Fe===void 0?!1:Fe,je=Array.isArray(je)?new we(je):Fe?new we:void 0,je!==void 0){we=je.o;var Ve=Fe=yt(we);k&&(Ve|=2),G&&(Ve|=16),Ve!=Fe&&zn(we,Ve),we=Ve,he=he||!!(2&we),A.push(je)}}return o.h[f]=A,G=yt(I),c=G|33,c=he?c&-9:c|8,G!=c&&(he=I,Object.isFrozen(he)&&(he=Array.prototype.slice.call(he)),zn(he,c),I=he),ie!==I&&mn(o,f,I),(x||p&&k)&&Dn(A,2),p&&Object.freeze(A),A}return x||(x=Object.isFrozen(A),p&&!x?Object.freeze(A):!p&&x&&(A=Array.prototype.slice.call(A),o.h[f]=A)),A}function ws(o,c,f){var p=!!(yt(o.o)&2);if(c=Da(o,c,f,p,p),o=gn(o,f,3,p),!(p||yt(o)&8)){for(p=0;p<c.length;p++){if(f=c[p],yt(f.o)&2){var x=bp(f,!1);x.j=f}else x=f;f!==x&&(c[p]=x,o[p]=x.o)}Dn(o,8)}return c}function sr(o,c,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);ct(o,c,f)}function Si(o,c,f,p,x){it(o);var A=Da(o,f,c,!1,!1);return f=p??new f,o=gn(o,c,2,!1),x!=null?(A.splice(x,0,f),o.splice(x,0,f.o)):(A.push(f),o.push(f.o)),f.C()&&vs(o,8),f}function za(o,c){return o??c}function Br(o,c,f){return f=f===void 0?0:f,za(bo(o,c),f)}var Ua;function Gv(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(yt(o)&128)return o=Array.prototype.slice.call(o),qe(o),o}else{if(Ie&&o!=null&&o instanceof Uint8Array)return Oe(o);if(o instanceof He){var c=o.V;return c==null?"":typeof c=="string"?c:o.V=Oe(c)}}}return o}function Cp(o,c,f,p){if(o!=null){if(Array.isArray(o))o=lc(o,c,f,p!==void 0);else if(re(o)){var x={},A;for(A in o)x[A]=Cp(o[A],c,f,p);o=x}else o=c(o,p);return o}}function lc(o,c,f,p){var x=yt(o);p=p?!!(x&16):void 0,o=Array.prototype.slice.call(o);for(var A=0;A<o.length;A++)o[A]=Cp(o[A],c,f,p);return f(x,o),o}function Wv(o){return o.ja===pe?o.toJSON():Gv(o)}function Vv(o,c){o&128&&qe(c)}function _p(o,c,f){if(f=f===void 0?de:f,o!=null){if(Ie&&o instanceof Uint8Array)return o.length?new He(new Uint8Array(o),P):We();if(Array.isArray(o)){var p=yt(o);return p&2?o:c&&!(p&32)&&(p&16||p===0)?(zn(o,p|2),o):(o=lc(o,_p,p&4?de:f,!0),c=yt(o),c&4&&c&2&&Object.freeze(o),o)}return o.ja===pe?Np(o):o}}function jp(o,c,f,p,x,A,k){if(o=o.h&&o.h[f]){if(p=yt(o),p&2?p=o:(A=ge(o,Np),de(p,A),Object.freeze(A),p=A),it(c),k=p==null?fe:xi([]),p!=null){for(A=!!p.length,o=0;o<p.length;o++){var I=p[o];A=A&&!(yt(I.o)&2),k[o]=I.o}A=(A?8:0)|1,o=yt(k),(o&A)!==A&&(Object.isFrozen(k)&&(k=Array.prototype.slice.call(k)),zn(k,o|A)),c.h||(c.h={}),c.h[f]=p}else c.h&&(c.h[f]=void 0);mn(c,f,k,x)}else ct(c,f,_p(p,A,k),x)}function Np(o){return yt(o.o)&2||(o=bp(o,!0),Dn(o.o,2)),o}function bp(o,c){var f=o.o,p=[];Dn(p,16);var x=o.constructor.h;if(x&&p.push(x),x=o.B,x){p.length=f.length,p.fill(void 0,p.length,f.length);var A={};p[p.length-1]=A}yt(f)&128&&qe(p),c=c||o.C()?de:O,A=o.constructor,Ua=p,p=new A(p),Ua=void 0,o.R&&(p.R=o.R.slice()),A=!!(yt(f)&16);for(var k=x?f.length-1:f.length,I=0;I<k;I++)jp(o,p,I-o.G,f[I],!1,A,c);if(x)for(var G in x)jp(o,p,+G,x[G],!0,A,c);return p}function jn(o,c,f){o==null&&(o=Ua),Ua=void 0;var p=this.constructor.i||0,x=0<p,A=this.constructor.h,k=!1;if(o==null){o=A?[A]:[];var I=48,G=!0;x&&(p=0,I|=128),zn(o,I)}else{if(!Array.isArray(o)||A&&A!==o[0])throw Error();var ie=I=Dn(o,0);if((G=(16&ie)!==0)&&((k=(32&ie)!==0)||(ie|=32)),x){if(128&ie)p=0;else if(0<o.length){var he=o[o.length-1];if(re(he)&&"g"in he){p=0,ie|=128,delete he.g;var Be=!0,je;for(je in he){Be=!1;break}Be&&o.pop()}}}else if(128&ie)throw Error();I!==ie&&zn(o,ie)}this.G=(A?0:-1)-p,this.h=void 0,this.o=o;e:{if(A=this.o.length,p=A-1,A&&(A=this.o[p],re(A))){this.B=A,this.i=p-this.G;break e}c!==void 0&&-1<c?(this.i=Math.max(c,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!x&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){c=G&&!k&&!0,x=this.i;var we;for(G=0;G<f.length;G++)k=f[G],k<x?(k+=this.G,(p=o[k])?Mp(p,c):o[k]=fe):(we||(we=Le(this)),(p=we[k])?Mp(p,c):we[k]=fe)}}jn.prototype.toJSON=function(){return lc(this.o,Wv,Vv)},jn.prototype.C=function(){return!!(yt(this.o)&2)};function Mp(o,c){if(Array.isArray(o)){var f=yt(o),p=1;!c||f&2||(p|=16),(f&p)!==p&&zn(o,f|p)}}jn.prototype.ja=pe,jn.prototype.toString=function(){return this.o.toString()};function Tp(o,c,f){if(f){var p={},x;for(x in f){var A=f[x],k=A.qa;k||(p.J=A.wa||A.oa.W,A.ia?(p.aa=Bp(A.ia),k=function(I){return function(G,ie,he){return I.J(G,ie,he,I.aa)}}(p)):A.ka?(p.Z=Fp(A.da.P,A.ka),k=function(I){return function(G,ie,he){return I.J(G,ie,he,I.Z)}}(p)):k=p.J,A.qa=k),k(c,o,A.da),p={J:p.J,aa:p.aa,Z:p.Z}}}wi(c,o)}var Ha=Symbol();function Pp(o,c,f){return o[Ha]||(o[Ha]=function(p,x){return c(p,x,f)})}function Ip(o){var c=o[Ha];if(!c){var f=cc(o);c=function(p,x){return Op(p,x,f)},o[Ha]=c}return c}function Yv(o){var c=o.ia;if(c)return Ip(c);if(c=o.va)return Pp(o.da.P,c,o.ka)}function Xv(o){var c=Yv(o),f=o.da,p=o.oa.U;return c?function(x,A){return p(x,A,f,c)}:function(x,A){return p(x,A,f)}}function Rp(o,c){var f=o[c];return typeof f=="function"&&f.length===0&&(f=f(),o[c]=f),Array.isArray(f)&&(To in f||Mo in f||0<f.length&&typeof f[0]=="function")?f:void 0}function Lp(o,c,f,p,x,A){c.P=o[0];var k=1;if(o.length>k&&typeof o[k]!="number"){var I=o[k++];f(c,I)}for(;k<o.length;){f=o[k++];for(var G=k+1;G<o.length&&typeof o[G]!="number";)G++;switch(I=o[k++],G-=k,G){case 0:p(c,f,I);break;case 1:(G=Rp(o,k))?(k++,x(c,f,I,G)):p(c,f,I,o[k++]);break;case 2:G=k++,G=Rp(o,G),x(c,f,I,G,o[k++]);break;case 3:A(c,f,I,o[k++],o[k++],o[k++]);break;case 4:A(c,f,I,o[k++],o[k++],o[k++],o[k++]);break;default:throw Error("unexpected number of binary field arguments: "+G)}}return c}var Ga=Symbol();function Bp(o){var c=o[Ga];if(!c){var f=uc(o);c=function(p,x){return $p(p,x,f)},o[Ga]=c}return c}function Fp(o,c){var f=o[Ga];return f||(f=function(p,x){return Tp(p,x,c)},o[Ga]=f),f}var Mo=Symbol();function Kv(o,c){o.push(c)}function Qv(o,c,f){o.push(c,f.W)}function Jv(o,c,f,p){var x=Bp(p),A=uc(p).P,k=f.W;o.push(c,function(I,G,ie){return k(I,G,ie,A,x)})}function qv(o,c,f,p,x,A){var k=Fp(p,A),I=f.W;o.push(c,function(G,ie,he){return I(G,ie,he,p,k)})}function uc(o){var c=o[Mo];return c||(c=Lp(o,o[Mo]=[],Kv,Qv,Jv,qv),To in o&&Mo in o&&(o.length=0),c)}var To=Symbol();function Zv(o,c){o[0]=c}function e3(o,c,f,p){var x=f.U;o[c]=p?function(A,k,I){return x(A,k,I,p)}:x}function t3(o,c,f,p,x){var A=f.U,k=Ip(p),I=cc(p).P;o[c]=function(G,ie,he){return A(G,ie,he,I,k,x)}}function n3(o,c,f,p,x,A,k){var I=f.U,G=Pp(p,x,A);o[c]=function(ie,he,Be){return I(ie,he,Be,p,G,k)}}function cc(o){var c=o[To];return c||(c=Lp(o,o[To]={},Zv,e3,t3,n3),To in o&&Mo in o&&(o.length=0),c)}function Op(o,c,f){for(;On(c)&&c.i!=4;){var p=c.l,x=f[p];if(!x){var A=f[0];A&&(A=A[p])&&(x=f[p]=Xv(A))}if(!x||!x(c,o,p)){x=c,p=o,A=x.j,Jr(x);var k=x;if(!k.ca){if(x=k.h.h-A,k.h.h=A,k=k.h,x==0)x=We();else{if(A=nn(k,x),k.S&&k.m)x=k.i.subarray(A,A+x);else{k=k.i;var I=A;x=A+x,x=I===x?le():z?k.slice(I,x):new Uint8Array(k.subarray(I,x))}x=x.length==0?We():new He(x,P)}(A=p.R)?A.push(x):p.R=[x]}}}return o}function $p(o,c,f){for(var p=f.length,x=p%2==1,A=x?1:0;A<p;A+=2)(0,f[A+1])(c,o,f[A]);Tp(o,c,x?f[0]:void 0)}function Po(o,c){return{U:o,W:c}}var kr=Po(function(o,c,f){if(o.i!==5)return!1;o=o.h;var p=o.i,x=o.h,A=p[x],k=p[x+1],I=p[x+2];return p=p[x+3],zt(o,o.h+4),k=(A<<0|k<<8|I<<16|p<<24)>>>0,o=2*(k>>31)+1,A=k>>>23&255,k&=8388607,ct(c,f,A==255?k?NaN:1/0*o:A==0?o*Math.pow(2,-149)*k:o*Math.pow(2,A-150)*(k+Math.pow(2,23))),!0},function(o,c,f){if(c=bo(c,f),c!=null){Cn(o.h,8*f+5),o=o.h;var p=+c;p===0?0<1/p?J=ue=0:(ue=0,J=2147483648):isNaN(p)?(ue=0,J=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(ue=0,J=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),ue=0,J=(f|p)>>>0):(c=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-c),p=Math.round(8388608*p),16777216<=p&&++c,ue=0,J=(f|c+127<<23|p&8388607)>>>0)),f=J,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),r3=Po(function(o,c,f){if(o.i!==0)return!1;var p=o.h,x=0,A=o=0,k=p.i,I=p.h;do{var G=k[I++];x|=(G&127)<<A,A+=7}while(32>A&&G&128);for(32<A&&(o|=(G&127)>>4),A=3;32>A&&G&128;A+=7)G=k[I++],o|=(G&127)<<A;if(zt(p,I),128>G)p=x>>>0,G=o>>>0,(o=G&2147483648)&&(p=~p+1>>>0,G=~G>>>0,p==0&&(G=G+1>>>0)),p=4294967296*G+(p>>>0);else throw W();return ct(c,f,o?-p:p),!0},function(o,c,f){c=$e(c,f),c!=null&&(typeof c=="string"&&M(c),c!=null&&(Cn(o.h,8*f),typeof c=="number"?(o=o.h,$(c),rr(o,J,ue)):(f=M(c),rr(o.h,f.i,f.h))))}),s3=Po(function(o,c,f){return o.i!==0?!1:(ct(c,f,Pt(o.h)),!0)},function(o,c,f){if(c=$e(c,f),c!=null&&c!=null)if(Cn(o.h,8*f),o=o.h,f=c,0<=f)Cn(o,f);else{for(c=0;9>c;c++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),Dp=Po(function(o,c,f){if(o.i!==2)return!1;var p=Pt(o.h)>>>0;o=o.h;var x=nn(o,p);if(o=o.i,Je){var A=o,k;(k=Ue)||(k=Ue=new TextDecoder("utf-8",{fatal:!0})),o=x+p,A=x===0&&o===A.length?A:A.subarray(x,o);try{var I=k.decode(A)}catch(Be){if(Pe===void 0){try{k.decode(new Uint8Array([128]))}catch{}try{k.decode(new Uint8Array([97])),Pe=!0}catch{Pe=!1}}throw!Pe&&(Ue=void 0),Be}}else{I=x,p=I+p,x=[];for(var G=null,ie,he;I<p;)ie=o[I++],128>ie?x.push(ie):224>ie?I>=p?me():(he=o[I++],194>ie||(he&192)!==128?(I--,me()):x.push((ie&31)<<6|he&63)):240>ie?I>=p-1?me():(he=o[I++],(he&192)!==128||ie===224&&160>he||ie===237&&160<=he||((A=o[I++])&192)!==128?(I--,me()):x.push((ie&15)<<12|(he&63)<<6|A&63)):244>=ie?I>=p-2?me():(he=o[I++],(he&192)!==128||(ie<<28)+(he-144)>>30||((A=o[I++])&192)!==128||((k=o[I++])&192)!==128?(I--,me()):(ie=(ie&7)<<18|(he&63)<<12|(A&63)<<6|k&63,ie-=65536,x.push((ie>>10&1023)+55296,(ie&1023)+56320))):me(),8192<=x.length&&(G=Ce(G,x),x.length=0);I=Ce(G,x)}return ct(c,f,I),!0},function(o,c,f){if(c=$e(c,f),c!=null){var p=!1;if(p=p===void 0?!1:p,lt){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(c))throw Error("Found an unpaired surrogate");c=(tt||(tt=new TextEncoder)).encode(c)}else{for(var x=0,A=new Uint8Array(3*c.length),k=0;k<c.length;k++){var I=c.charCodeAt(k);if(128>I)A[x++]=I;else{if(2048>I)A[x++]=I>>6|192;else{if(55296<=I&&57343>=I){if(56319>=I&&k<c.length){var G=c.charCodeAt(++k);if(56320<=G&&57343>=G){I=1024*(I-55296)+G-56320+65536,A[x++]=I>>18|240,A[x++]=I>>12&63|128,A[x++]=I>>6&63|128,A[x++]=I&63|128;continue}else k--}if(p)throw Error("Found an unpaired surrogate");I=65533}A[x++]=I>>12|224,A[x++]=I>>6&63|128}A[x++]=I&63|128}}c=x===A.length?A:A.subarray(0,x)}Cn(o.h,8*f+2),Cn(o.h,c.length),$n(o,o.h.end()),$n(o,c)}}),zp=Po(function(o,c,f,p,x){if(o.i!==2)return!1;c=Si(c,f,p),f=o.h.j,p=Pt(o.h)>>>0;var A=o.h.h+p,k=A-f;if(0>=k&&(o.h.j=A,x(c,o,void 0,void 0,void 0),k=A-o.h.h),k)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-k)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=A,o.h.j=f,!0},function(o,c,f,p,x){if(c=ws(c,p,f),c!=null)for(p=0;p<c.length;p++){var A=o;Cn(A.h,8*f+2);var k=A.h.end();$n(A,k),k.push(A.i),A=k,x(c[p],o),k=o;var I=A.pop();for(I=k.i+k.h.length()-I;127<I;)A.push(I&127|128),I>>>=7,k.i++;A.push(I),k.i++}});function dc(o){return function(c,f){e:{if(Lr.length){var p=Lr.pop();p.setOptions(f),gt(p.h,c,f),c=p}else c=new Qr(c,f);try{var x=cc(o),A=Op(new x.P,c,x);break e}finally{x=c.h,x.i=null,x.m=!1,x.l=0,x.j=0,x.h=0,x.S=!1,c.l=-1,c.i=-1,100>Lr.length&&Lr.push(c)}A=void 0}return A}}function fc(o){return function(){var c=new ys;$p(this,c,uc(o)),$n(c,c.h.end());for(var f=new Uint8Array(c.i),p=c.j,x=p.length,A=0,k=0;k<x;k++){var I=p[k];f.set(I,A),A+=I.length}return c.j=[f],f}}function ki(o){jn.call(this,o)}X(ki,jn);var Up=[ki,1,s3,2,kr,3,Dp,4,Dp];ki.prototype.l=fc(Up);function hc(o){jn.call(this,o,-1,i3)}X(hc,jn),hc.prototype.addClassification=function(o,c){return Si(this,1,ki,o,c),this};var i3=[1],Hp=dc([hc,1,zp,Up]);function Ai(o){jn.call(this,o)}X(Ai,jn);var Gp=[Ai,1,kr,2,kr,3,kr,4,kr,5,kr];Ai.prototype.l=fc(Gp);function Wp(o){jn.call(this,o,-1,o3)}X(Wp,jn);var o3=[1],Vp=dc([Wp,1,zp,Gp]);function Wa(o){jn.call(this,o)}X(Wa,jn);var Yp=[Wa,1,kr,2,kr,3,kr,4,kr,5,kr,6,r3],a3=dc(Yp);Wa.prototype.l=fc(Yp);function Xp(o,c,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function Kp(o){return ws(o,ki,1).map(function(c){var f=$e(c,1);return{index:f??0,score:Br(c,2),label:$e(c,3)!=null?za($e(c,3),""):void 0,displayName:$e(c,4)!=null?za($e(c,4),""):void 0}})}function Qp(o){return{x:Br(o,1),y:Br(o,2),z:Br(o,3),visibility:bo(o,4)!=null?Br(o,4):void 0}}function Jp(o){return o.map(function(c){return ws(Vp(c),Ai,1).map(Qp)})}function pc(o,c){this.i=o,this.h=c,this.m=0}function qp(o,c,f){return l3(o,c),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function l3(o,c){var f=o.h;if(o.s===void 0){var p=Xp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),x=Xp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),A=f.createProgram();if(f.attachShader(A,p),f.attachShader(A,x),f.linkProgram(A),!f.getProgramParameter(A,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(A));p=o.s=A,f.useProgram(p),x=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:x},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(x,0)}p=o.l,f.useProgram(o.s),f.canvas.width=c.width,f.canvas.height=c.height,f.viewport(0,0,c.width,c.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(c.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function u3(o){this.h=o}var c3=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function d3(o,c){return c+o}function Zp(o,c){window[o]=c}function f3(o){var c=document.createElement("script");return c.setAttribute("src",o),c.setAttribute("crossorigin","anonymous"),new Promise(function(f){c.addEventListener("load",function(){f()},!1),c.addEventListener("error",function(){f()},!1),document.body.appendChild(c)})}function h3(){return K(function(o){switch(o.h){case 1:return o.s=2,E(o,WebAssembly.instantiate(c3),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function mc(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||d3,typeof window=="object")var c=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")c=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=c,o.options){c=l(Object.keys(o.options));for(var f=c.next();!f.done;f=c.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=mc.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function p3(o){var c,f,p,x,A,k,I,G,ie,he,Be;return K(function(je){switch(je.h){case 1:return o.ga?(c=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,E(je,h3(),2)):je.return();case 2:if(f=je.i,typeof window=="object")return Zp("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),Zp("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),k=c.filter(function(we){return we.data!==void 0}),I=c.filter(function(we){return we.data===void 0}),G=Promise.all(k.map(function(we){var Fe=Va(o,we.url);if(we.path!==void 0){var Ve=we.path;Fe=Fe.then(function(vt){return o.overrideFile(Ve,vt),Promise.resolve(vt)})}return Fe})),ie=Promise.all(I.map(function(we){return we.simd===void 0||we.simd&&f||!we.simd&&!f?f3(o.locateFile(we.url,o.ha)):Promise.resolve()})).then(function(){var we,Fe,Ve;return K(function(vt){if(vt.h==1)return we=window.createMediapipeSolutionsWasm,Fe=window.createMediapipeSolutionsPackedAssets,Ve=o,E(vt,we(Fe),2);Ve.i=vt.i,vt.h=0})}),he=function(){return K(function(we){return o.h.graph&&o.h.graph.url?we=E(we,Va(o,o.h.graph.url),0):(we.h=0,we=void 0),we})}(),E(je,Promise.all([ie,G,he]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=c.filter(function(we){return we.simd===void 0||we.simd&&f||!we.simd&&!f}).map(function(we){return o.locateFile(we.url,o.ha)}),importScripts.apply(null,d(p)),x=o,E(je,createMediapipeSolutionsWasm(Module),6);case 6:x.i=je.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,A=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(A),je.h=4;break;case 7:if(o.m=document.createElement("canvas"),Be=o.m.getContext("webgl2",{}),!Be&&(Be=o.m.getContext("webgl",{}),!Be))return alert("Failed to create WebGL canvas context when passing video frame."),je.return();o.K=Be,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,je.h=0}})}function m3(o){var c,f,p,x,A,k,I,G;return K(function(ie){if(ie.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return ie.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){ie.h=2;return}return o.fa=o.h.graph.url,E(ie,Va(o,o.h.graph.url),3)}for(ie.h!=2&&(c=ie.i,o.j.loadGraph(c)),f=l(Object.keys(o.D)),p=f.next();!p.done;p=f.next())x=p.value,o.j.overrideFile(x,o.D[x]);if(o.D={},o.h.listeners)for(A=l(o.h.listeners),k=A.next();!k.done;k=A.next())I=k.value,w3(o,I);G=o.l,o.l={},o.setOptions(G),ie.h=0})}e.reset=function(){var o=this;return K(function(c){o.j&&(o.j.reset(),o.s={},o.v={}),c.h=0})},e.setOptions=function(o,c){var f=this;if(c=c||this.h.options){for(var p=[],x=[],A={},k=l(Object.keys(o)),I=k.next();!I.done;A={X:A.X,Y:A.Y},I=k.next())if(I=I.value,!(I in this.l&&this.l[I]===o[I])){this.l[I]=o[I];var G=c[I];G!==void 0&&(G.onChange&&(A.X=G.onChange,A.Y=o[I],p.push(function(ie){return function(){var he;return K(function(Be){if(Be.h==1)return E(Be,ie.X(ie.Y),2);he=Be.i,he===!0&&(f.u=!0),Be.h=0})}}(A))),G.graphOptionXref&&(I=Object.assign({},{calculatorName:"",calculatorIndex:0},G.graphOptionXref,{valueNumber:G.type===1?o[I]:0,valueBoolean:G.type===0?o[I]:!1,valueString:G.type===2?o[I]:""}),x.push(I)))}(p.length!==0||x.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(x),this.F=(this.F===void 0?[]:this.F).concat(p))}};function g3(o){var c,f,p,x,A,k,I;return K(function(G){switch(G.h){case 1:if(!o.u)return G.return();if(!o.F){G.h=2;break}c=l(o.F),f=c.next();case 3:if(f.done){G.h=5;break}return p=f.value,E(G,p(),4);case 4:f=c.next(),G.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(x=new o.i.GraphOptionChangeRequestList,A=l(o.H),k=A.next();!k.done;k=A.next())I=k.value,x.push_back(I);o.j.changeOptions(x),x.delete(),o.H=void 0}o.u=!1,G.h=0}})}e.initialize=function(){var o=this;return K(function(c){return c.h==1?E(c,p3(o),2):c.h!=3?E(c,m3(o),3):E(c,g3(o),0)})};function Va(o,c){var f,p;return K(function(x){return c in o.L?x.return(o.L[c]):(f=o.locateFile(c,""),p=fetch(f).then(function(A){return A.arrayBuffer()}),o.L[c]=p,x.return(p))})}e.overrideFile=function(o,c){this.j?this.j.overrideFile(o,c):this.D[o]=c},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,c){var f=this,p,x,A,k,I,G,ie,he,Be;return K(function(je){switch(je.h){case 1:return f.h.inputs?(p=1e3*(c??performance.now()),E(je,f.I,2)):je.return();case 2:return E(je,f.initialize(),3);case 3:for(x=new f.i.PacketDataList,A=l(Object.keys(o)),k=A.next();!k.done;k=A.next())if(I=k.value,G=f.h.inputs[I]){e:{var we=o[I];switch(G.type){case"video":var Fe=f.s[G.stream];if(Fe||(Fe=new pc(f.i,f.K),f.s[G.stream]=Fe),Fe.m===0&&(Fe.m=Fe.i.createTexture()),typeof HTMLVideoElement<"u"&&we instanceof HTMLVideoElement)var Ve=we.videoWidth,vt=we.videoHeight;else typeof HTMLImageElement<"u"&&we instanceof HTMLImageElement?(Ve=we.naturalWidth,vt=we.naturalHeight):(Ve=we.width,vt=we.height);vt={glName:Fe.m,width:Ve,height:vt},Ve=Fe.h,Ve.canvas.width=vt.width,Ve.canvas.height=vt.height,Ve.activeTexture(Ve.TEXTURE0),Fe.i.bindTexture2d(Fe.m),Ve.texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,Ve.RGBA,Ve.UNSIGNED_BYTE,we),Fe.i.bindTexture2d(0),Fe=vt;break e;case"detections":for(Fe=f.s[G.stream],Fe||(Fe=new u3(f.i),f.s[G.stream]=Fe),Fe.data||(Fe.data=new Fe.h.DetectionListData),Fe.data.reset(we.length),vt=0;vt<we.length;++vt){Ve=we[vt];var ft=Fe.data,rn=ft.setBoundingBox,ir=vt,Nn=Ve.la,nt=new Wa;if(sr(nt,1,Nn.ra),sr(nt,2,Nn.sa),sr(nt,3,Nn.height),sr(nt,4,Nn.width),sr(nt,5,Nn.rotation),ct(nt,6,Nn.pa),Nn=nt.l(),rn.call(ft,ir,Nn),Ve.ea)for(ft=0;ft<Ve.ea.length;++ft){nt=Ve.ea[ft],rn=Fe.data,ir=rn.addNormalizedLandmark,Nn=vt,nt=Object.assign({},nt,{visibility:nt.visibility?nt.visibility:0});var sn=new Ai;sr(sn,1,nt.x),sr(sn,2,nt.y),sr(sn,3,nt.z),nt.visibility&&sr(sn,4,nt.visibility),nt=sn.l(),ir.call(rn,Nn,nt)}if(Ve.ba)for(ft=0;ft<Ve.ba.length;++ft)rn=Fe.data,ir=rn.addClassification,Nn=vt,nt=Ve.ba[ft],sn=new ki,sr(sn,2,nt.score),nt.index&&ct(sn,1,nt.index),nt.label&&ct(sn,3,nt.label),nt.displayName&&ct(sn,4,nt.displayName),nt=sn.l(),ir.call(rn,Nn,nt)}Fe=Fe.data;break e;default:Fe={}}}switch(ie=Fe,he=G.stream,G.type){case"video":x.pushTexture2d(Object.assign({},ie,{stream:he,timestamp:p}));break;case"detections":Be=ie,Be.stream=he,Be.timestamp=p,x.pushDetectionList(Be);break;default:throw Error("Unknown input config type: '"+G.type+"'")}}return f.j.send(x),E(je,f.I,4);case 4:x.delete(),je.h=0}})};function y3(o,c,f){var p,x,A,k,I,G,ie,he,Be,je,we,Fe,Ve,vt;return K(function(ft){switch(ft.h){case 1:if(!f)return ft.return(c);for(p={},x=0,A=l(Object.keys(f)),k=A.next();!k.done;k=A.next())I=k.value,G=f[I],typeof G!="string"&&G.type==="texture"&&c[G.stream]!==void 0&&++x;1<x&&(o.M=!1),ie=l(Object.keys(f)),k=ie.next();case 2:if(k.done){ft.h=4;break}if(he=k.value,Be=f[he],typeof Be=="string")return Ve=p,vt=he,E(ft,v3(o,he,c[Be]),14);if(je=c[Be.stream],Be.type==="detection_list"){if(je){for(var rn=je.getRectList(),ir=je.getLandmarksList(),Nn=je.getClassificationsList(),nt=[],sn=0;sn<rn.size();++sn){var xs=a3(rn.get(sn)),x3=Br(xs,1),S3=Br(xs,2),k3=Br(xs,3),A3=Br(xs,4),E3=Br(xs,5,0),Ya=void 0;Ya=Ya===void 0?0:Ya,xs={la:{ra:x3,sa:S3,height:k3,width:A3,rotation:E3,pa:za($e(xs,6),Ya)},ea:ws(Vp(ir.get(sn)),Ai,1).map(Qp),ba:Kp(Hp(Nn.get(sn)))},nt.push(xs)}rn=nt}else rn=[];p[he]=rn,ft.h=7;break}if(Be.type==="proto_list"){if(je){for(rn=Array(je.size()),ir=0;ir<je.size();ir++)rn[ir]=je.get(ir);je.delete()}else rn=[];p[he]=rn,ft.h=7;break}if(je===void 0){ft.h=3;break}if(Be.type==="float_list"){p[he]=je,ft.h=7;break}if(Be.type==="proto"){p[he]=je,ft.h=7;break}if(Be.type!=="texture")throw Error("Unknown output config type: '"+Be.type+"'");return we=o.v[he],we||(we=new pc(o.i,o.K),o.v[he]=we),E(ft,qp(we,je,o.M),13);case 13:Fe=ft.i,p[he]=Fe;case 7:Be.transform&&p[he]&&(p[he]=Be.transform(p[he])),ft.h=3;break;case 14:Ve[vt]=ft.i;case 3:k=ie.next(),ft.h=2;break;case 4:return ft.return(p)}})}function v3(o,c,f){var p;return K(function(x){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?x.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[c],p||(p=new pc(o.i,o.K),o.v[c]=p),x.return(qp(p,f,o.M))):x.return(void 0)})}function w3(o,c){for(var f=c.name||"$",p=[].concat(d(c.wants)),x=new o.i.StringList,A=l(c.wants),k=A.next();!k.done;k=A.next())x.push_back(k.value);A=o.i.PacketListener.implement({onResults:function(I){for(var G={},ie=0;ie<c.wants.length;++ie)G[p[ie]]=I.get(ie);var he=o.listeners[f];he&&(o.I=y3(o,G,c.outs).then(function(Be){Be=he(Be);for(var je=0;je<c.wants.length;++je){var we=G[p[je]];typeof we=="object"&&we.hasOwnProperty&&we.hasOwnProperty("delete")&&we.delete()}Be&&(o.I=Be)}))}}),o.j.attachMultiListener(x,A),x.delete()}e.onResults=function(o,c){this.listeners[c||"$"]=o},Ae("Solution",mc),Ae("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function em(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function tm(o){var c=this;o=o||{},this.h=new mc({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:em(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:Jp},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:Jp},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return Kp(Hp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,x,A;return K(function(k){return k.h==1?(p=em(f),x="third_party/mediapipe/modules/hand_landmark/"+p,E(k,Va(c.h,p),2)):(A=k.i,c.h.overrideFile(x,A),k.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=tm.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return K(function(c){return E(c,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var c=this;return K(function(f){return E(f,c.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},Ae("Hands",tm),Ae("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),Ae("VERSION","0.4.1675469240")}).call(gc);const Un=(...e)=>{},Or={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},It={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function g1({hidden:e=!1}){const t=N.useRef(null),n=N.useRef(null),r=N.useRef(null),s=N.useRef(null),[i,a]=N.useState(!1),[l,d]=N.useState("None"),[h,m]=N.useState([]),[w,S]=N.useState(null),[_,L]=N.useState(null),[F,X]=N.useState(null),[C,g]=N.useState({a:null,b:null}),y=N.useRef(null),E=N.useRef(null),j=($,v)=>{const R=localStorage.getItem($);if(R===null)return v;const b=parseFloat(R);return Number.isFinite(b)?b:v},[T,D]=N.useState(()=>({roiSize:(()=>{const $=j(It.roiSize,44);return $>10?$:44})(),hueWeight:j(It.hueWeight,4),satWeight:j(It.satWeight,2),valWeight:j(It.valWeight,1),sensitivity:j(It.sensitivity,0)})),H=N.useRef(T),se=N.useRef(null),V=N.useRef(!1),K=N.useRef(0),ee=N.useRef(null),[q,te]=N.useState([]),Ae=N.useRef([]),[xe,ge]=N.useState(()=>localStorage.getItem(It.selectedCamera)||""),Z=N.useCallback(async()=>{try{const v=(await navigator.mediaDevices.enumerateDevices()).filter(R=>R.kind==="videoinput");return te(v),Ae.current=v,v}catch{return[]}},[]),oe=N.useCallback($=>{},[Un]),ne=N.useCallback(async($=null)=>{const v=t.current;if(!v)return;se.current&&(se.current.getTracks().forEach(M=>M.stop()),se.current=null),P();const R=++K.current;ee.current=null;const b=$!==null?$:xe;try{const M=b?{video:{deviceId:{exact:b}}}:{video:!0};if(b){const W=Ae.current.find(ce=>ce.deviceId===b);console.log("[Detector]  Loading SELECTED camera:",{deviceId:b,label:(W==null?void 0:W.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const B=await navigator.mediaDevices.getUserMedia(M);if(!V.current||R!==K.current){Un("Stale camera request (unmounted or superseded). Stopping stream."),B.getTracks().forEach(W=>W.stop());return}se.current=B;const U=B.getVideoTracks();if(Un("getUserMedia success. Tracks:",U),U.length>0){const W=U[0];console.log("[Detector]  Camera loaded successfully:",{label:W.label,deviceId:W.getSettings().deviceId,resolution:`${W.getSettings().width}x${W.getSettings().height}`,frameRate:W.getSettings().frameRate})}if(v.srcObject=B,await new Promise(W=>{if(v.readyState>=1&&v.videoWidth>0&&v.videoHeight>0)return W();const me=()=>{v.removeEventListener("loadedmetadata",me),W()};v.addEventListener("loadedmetadata",me,{once:!0}),setTimeout(()=>{v.removeEventListener("loadedmetadata",me),W()},1500)}),!V.current||R!==K.current){Un("Stale request before play(). Stopping stream."),B.getTracks().forEach(W=>W.stop());return}try{await v.play(),Un("video.play() promise resolved. Video should be playing.")}catch(W){if(console.error("[Detector] video.play() promise rejected:",W),Un("video.play() promise rejected:",W.name,W.message),R!==K.current){Un("play() aborted due to newer request."),B.getTracks().forEach(ce=>ce.stop());return}}if(ee.current!==R&&(ee.current=R,Un("Initializing MediaPipe for request id",R),Oe()),V.current){const W=await Z();if(!b||!$){const ce=W.find(me=>me.deviceId);ce&&ce.deviceId&&ce.deviceId!==xe&&(ge(ce.deviceId),localStorage.setItem(It.selectedCamera,ce.deviceId))}}}catch(M){console.error("[Detector] Error accessing camera:",M),Un("getUserMedia error:",M.name,M.message)}},[Un,Z,oe,xe]),ve=($,v,R)=>{const b=($||0)*2,M=(v||0)/255,B=(R||0)/255,U=B*M,W=U*(1-Math.abs(b/60%2-1)),ce=B-U;let me=0,Ce=0,Pe=0;b>=0&&b<60?(me=U,Ce=W,Pe=0):b<120?(me=W,Ce=U,Pe=0):b<180?(me=0,Ce=U,Pe=W):b<240?(me=0,Ce=W,Pe=U):b<300?(me=W,Ce=0,Pe=U):(me=U,Ce=0,Pe=W);const Ue=Math.round((me+ce)*255),Je=Math.round((Ce+ce)*255),tt=Math.round((Pe+ce)*255);return`rgb(${Ue}, ${Je}, ${tt})`},Me=$=>$?ve($.h,$.s,$.v):"#ffffff",Ie=$=>$==="Player A"&&_?Me(_):$==="Player B"&&F?Me(F):$==="Red"?"#ff0000":$==="Blue"?"#0000ff":"#ffffff";N.useEffect(()=>{V.current=!0;const $=()=>{try{const b=JSON.parse(localStorage.getItem("calibrationA")||"null"),M=JSON.parse(localStorage.getItem("calibrationB")||"null");b&&L({h:b.h,s:b.s,v:b.v}),M&&X({h:M.h,s:M.s,v:M.v})}catch{}},v=b=>{!b||!b.key||(["calibrationA","calibrationB"].includes(b.key)&&$(),[It.roiSize,It.hueWeight,It.satWeight,It.valWeight,It.sensitivity].includes(b.key)&&D(M=>({roiSize:(()=>{const B=j(It.roiSize,(M==null?void 0:M.roiSize)??44);return B>10?B:(M==null?void 0:M.roiSize)??44})(),hueWeight:j(It.hueWeight,(M==null?void 0:M.hueWeight)??4),satWeight:j(It.satWeight,(M==null?void 0:M.satWeight)??2),valWeight:j(It.valWeight,(M==null?void 0:M.valWeight)??1),sensitivity:j(It.sensitivity,(M==null?void 0:M.sensitivity)??0)})))};return(async()=>{const b=await Z();if(!V.current)return;const M=localStorage.getItem(It.selectedCamera);let B="";if(M&&b.some(U=>U.deviceId&&U.deviceId===M)){const U=b.find(W=>W.deviceId===M);B=M,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:M,label:(U==null?void 0:U.label)||"Unknown"})}else{M&&localStorage.removeItem(It.selectedCamera);const U=b.find(W=>W.deviceId);U&&U.deviceId?(B=U.deviceId,localStorage.setItem(It.selectedCamera,U.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:U.deviceId,label:U.label||"Unknown",savedCameraWas:M||"none"}),Un("Saved camera not found, using default camera:",U.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}ge(B?U=>U===B?U:B:U=>U||""),$()})(),window.addEventListener("storage",v),()=>{V.current=!1,K.current+=1,ee.current=null,s.current&&(s.current.stop(),s.current=null),se.current&&(se.current.getTracks().forEach(M=>M.stop()),se.current=null);const b=t.current;b&&(b.srcObject=null,oe(b)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",v)}},[]),N.useEffect(()=>{y.current=_},[_]),N.useEffect(()=>{E.current=F},[F]),N.useEffect(()=>{H.current=T},[T]),N.useEffect(()=>{ne(xe||null)},[xe,ne]),N.useEffect(()=>{const $=setInterval(()=>{d(v=>(De(v),v))},1e3);return()=>clearInterval($)},[]);const De=$=>{const R={timestamp:new Date().toISOString(),status:$};m(M=>[...M,R]);const b=JSON.parse(localStorage.getItem("braceletDetections")||"[]");b.push(R),localStorage.setItem("braceletDetections",JSON.stringify(b))},Oe=async()=>{try{const $=await(async()=>{try{if(typeof su.Hands=="function")return su.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((R,b)=>{const M="mp-hands-cdn-script";if(document.getElementById(M))return R();const B=document.createElement("script");B.id=M,B.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",B.async=!0,B.onload=()=>R(),B.onerror=U=>b(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(B)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),v=new $({locateFile:R=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${R}`});if(v.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),v.onResults(ze),r.current=v,t.current){const R=t.current;console.log("[Detector]  Starting manual frame capture from video element");let b;const M=async()=>{if(R.readyState>=2&&R.videoWidth>0)try{await v.send({image:R})}catch(B){console.error("[Detector] Error sending frame to MediaPipe:",B)}b=requestAnimationFrame(M)};M(),s.current={stop:()=>{b&&(cancelAnimationFrame(b),console.log("[Detector]  Stopped frame capture"))}}}}catch($){console.error("MediaPipe initialization error:",$),S(`MediaPipe error: ${$.message}`)}},ze=$=>{var U;const v=n.current,R=t.current;if(!v||!R)return;const b=v.getContext("2d");v.width=R.videoWidth,v.height=R.videoHeight,b.drawImage(R,0,0,v.width,v.height);let M="None";if($.multiHandLandmarks&&$.multiHandLandmarks.length>0){Un("onResults: hands=",$.multiHandLandmarks.length);let W=null,ce=0;if($.multiHandLandmarks.forEach(me=>{const Ce=me[0];Ce.y>ce&&(ce=Ce.y,W=me)}),$.multiHandLandmarks.forEach(me=>{Y(b,me,v.width,v.height)}),W){const me=W[0],Ce=me.x*v.width,Pe=me.y*v.height;b.fillStyle="lime",b.beginPath(),b.arc(Ce,Pe,10,0,2*Math.PI),b.fill(),b.fillStyle="lime",b.font="16px Arial",b.fillText("SELECTED",Ce-40,Pe-15);const Je=Math.max(10,Math.min(300,Math.floor(((U=H.current)==null?void 0:U.roiSize)||60)))/2,tt=Math.max(0,Ce-Je),lt=Math.max(0,Pe-Je),ut=Math.min(v.width,Ce+Je),Ge=Math.min(v.height,Pe+Je);b.strokeStyle="lime",b.lineWidth=3,b.strokeRect(tt,lt,ut-tt,Ge-lt);const He=ut-tt,We=Ge-lt;if(He>0&&We>0)try{const Qe=b.getImageData(tt,lt,He,We),kt=y.current,Fn=E.current,gt=ye(Qe,kt,Fn);M=gt.status,g({a:gt.percentA,b:gt.percentB}),Un("Detection result:",M,{roi:{x1:tt,y1:lt,w:He,h:We}})}catch(Qe){console.warn("[Detector] Failed to get ROI image data:",Qe.message),M="None",g({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:He,height:We}),M="None",g({a:null,b:null})}}let B="#ffffff";M==="Player A"&&y.current?B=Me(y.current):M==="Player B"&&E.current&&(B=Me(E.current)),b.fillStyle=B,b.font="bold 32px Arial",b.fillText(`Status: ${M}`,10,40),d(M),typeof window<"u"&&(window.currentBraceletStatus=M,window.braceletDetectorCanvas=v,window.braceletDetectorVideo=R)},Y=($,v,R,b)=>{$.strokeStyle="white",$.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([B,U])=>{const W=v[B],ce=v[U];$.beginPath(),$.moveTo(W.x*R,W.y*b),$.lineTo(ce.x*R,ce.y*b),$.stroke()}),v.forEach(B=>{$.fillStyle="red",$.beginPath(),$.arc(B.x*R,B.y*b,5,0,2*Math.PI),$.fill()})},Q=$=>{const v=$.data;let R=0,b=0;for(let M=0;M<v.length;M+=4){const B=v[M],U=v[M+1],W=v[M+2],ce=le(B,U,W);(ce[0]>=Or.red.lower1[0]&&ce[0]<=Or.red.upper1[0]||ce[0]>=Or.red.lower2[0]&&ce[0]<=Or.red.upper2[0])&&ce[1]>=Or.red.lower1[1]&&ce[2]>=Or.red.lower1[2]&&R++,ce[0]>=Or.blue.lower[0]&&ce[0]<=Or.blue.upper[0]&&ce[1]>=Or.blue.lower[1]&&ce[2]>=Or.blue.lower[2]&&b++}return{redCount:R,blueCount:b}},ye=($,v,R)=>{var Je,tt,lt,ut;const b=$.data;if(v&&!R)return{status:"Player A",percentA:null,percentB:null};if(R&&!v)return{status:"Player B",percentA:null,percentB:null};const M=((Je=H.current)==null?void 0:Je.hueWeight)??4,B=((tt=H.current)==null?void 0:tt.satWeight)??2,U=((lt=H.current)==null?void 0:lt.valWeight)??1,W=((ut=H.current)==null?void 0:ut.sensitivity)??0;if(v&&R){let Ge=0,He=0,We=0;for(let gt=0;gt<b.length;gt+=4){const zt=b[gt],Pt=b[gt+1],nn=b[gt+2],[Kt,Qt,rr]=le(zt,Pt,nn),Cn=Math.min(1,Math.max(0,Qt/255)),Qr=Math.min(1,Math.max(0,rr/255)),On=Math.max(.05,.5*Cn+.5*Qr),Jr=Math.min(Math.abs(Kt-v.h),180-Math.abs(Kt-v.h)),Lr=Math.min(Math.abs(Kt-R.h),180-Math.abs(Kt-R.h)),ys=Math.abs(Qt-v.s),$n=Math.abs(Qt-R.s),wi=Math.abs(rr-v.v),_n=Math.abs(rr-R.v),Dn=Jr*M+ys*B+wi*U,vs=Lr*M+$n*B+_n*U;Math.min(Dn,vs)>180||(Dn<=vs?Ge+=On:He+=On,We+=On)}if(We===0)return{status:"None",percentA:0,percentB:0};const Qe=Ge/Math.max(1e-6,We),kt=He/Math.max(1e-6,We),Fn=.12*(1+.8*Math.max(0,Math.min(1,W)));return Qe>=Fn&&Qe>=kt?{status:"Player A",percentA:Qe,percentB:kt}:kt>=Fn&&kt>Qe?{status:"Player B",percentA:Qe,percentB:kt}:{status:"None",percentA:Qe,percentB:kt}}const{redCount:ce,blueCount:me}=Q($),Ce=ce+me;if(Ce===0)return{status:"None",percentA:0,percentB:0};const Pe=ce/Ce,Ue=me/Ce;return Pe>=.15&&Pe>=Ue?{status:"Player A",percentA:Pe,percentB:Ue}:Ue>=.15&&Ue>Pe?{status:"Player B",percentA:Pe,percentB:Ue}:{status:"None",percentA:Pe,percentB:Ue}},le=($,v,R)=>{$/=255,v/=255,R/=255;const b=Math.max($,v,R),M=Math.min($,v,R),B=b-M;let U=0;B!==0&&(b===$?U=60*((v-R)/B%6):b===v?U=60*((R-$)/B+2):U=60*(($-v)/B+4)),U<0&&(U+=360);const W=b===0?0:B/b*255,ce=b*255;return[U/2,W,ce]},P=$=>{},z=$=>{ge($),$?localStorage.setItem(It.selectedCamera,$):localStorage.removeItem(It.selectedCamera)},J=()=>{const $=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),v=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),R=URL.createObjectURL(v),b=document.createElement("a");b.href=R,b.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,b.click();const M=$.map(ce=>`${ce.timestamp}: ${ce.status}`).join(`
`),B=new Blob([M],{type:"text/plain"}),U=URL.createObjectURL(B),W=document.createElement("a");W.href=U,W.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,W.click()},ue=()=>{localStorage.removeItem("braceletDetections"),m([])};return u.jsx(u.Fragment,{children:u.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[u.jsxs("div",{className:"detector-header",children:[u.jsx("span",{children:"Bracelet Detector"}),u.jsxs("div",{className:"detector-controls",children:[u.jsx("button",{onClick:J,title:"Download Logs",children:""}),u.jsx("button",{onClick:ue,title:"Clear Logs",children:""}),u.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),u.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[u.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{children:"Camera:"}),u.jsxs("select",{value:xe,onChange:$=>z($.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[u.jsx("option",{value:"",children:"System Default"}),q.map(($,v)=>{var W;const R=!!$.deviceId,b=R?$.deviceId:"",M=R?$.deviceId:`camera-${v}`,B=((W=$.label)==null?void 0:W.trim())||`Camera ${v+1}`,U=R?`  ${$.deviceId.slice(0,8)}`:" (needs permission)";return u.jsxs("option",{value:b,disabled:!R,children:[B,U]},M)})]})]}),u.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),u.jsx("canvas",{ref:n,className:"output_canvas"}),u.jsxs("div",{className:"detector-info",children:[u.jsxs("div",{className:"status-display",children:["Status: ",u.jsx("span",{style:{color:Ie(l),fontWeight:700},children:l})]}),u.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),u.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:_?Me(_):"#444"}}),u.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:C.a==null?"":`${Math.round(Math.max(0,Math.min(1,C.a))*100)}%`})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),u.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:F?Me(F):"#444"}}),u.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:C.b==null?"":`${Math.round(Math.max(0,Math.min(1,C.b))*100)}%`})]})]}),u.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),u.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[u.jsxs("div",{children:["A: ",_?`h${Math.round(_.h)} s${Math.round(_.s)} v${Math.round(_.v)}`:""]}),u.jsxs("div",{children:["B: ",F?`h${Math.round(F.h)} s${Math.round(F.s)} v${Math.round(F.v)}`:""]})]})]})]})]})})}const Wc=(...e)=>{console.log("[Calibrate]",...e)},$r={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},cx=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,l=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,m=0,w=0;r>=0&&r<60?(h=a,m=l,w=0):r<120?(h=l,m=a,w=0):r<180?(h=0,m=a,w=l):r<240?(h=0,m=l,w=a):r<300?(h=l,m=0,w=a):(h=a,m=0,w=l);const S=Math.round((h+d)*255),_=Math.round((m+d)*255),L=Math.round((w+d)*255);return`rgb(${S}, ${_}, ${L})`},y1=e=>e?cx(e.h,e.s,e.v):"#444";function dx(){const e=N.useRef(null),t=N.useRef(null),n=N.useRef(null),r=N.useRef(!1),s=N.useRef(0),[i,a]=N.useState(!1),[l,d]=N.useState(""),[h,m]=N.useState(null),[w,S]=N.useState(null),_=(Y,Q)=>{const ye=localStorage.getItem(Y);if(ye===null)return Q;const le=parseFloat(ye);return Number.isFinite(le)?le:Q},[L,F]=N.useState(()=>{const Y=_($r.roiSize,44);return Y>10?Y:44}),[X,C]=N.useState(()=>_($r.hueWeight,4)),[g,y]=N.useState(()=>_($r.satWeight,2)),[E,j]=N.useState(()=>_($r.valWeight,1)),[T,D]=N.useState(()=>_($r.sensitivity,0)),[H,se]=N.useState(!1),[V,K]=N.useState("idle"),[ee,q]=N.useState(5),te=N.useRef({A:[],B:[]});N.useEffect(()=>{r.current=!0;try{const Y=JSON.parse(localStorage.getItem("calibrationA")||"null"),Q=JSON.parse(localStorage.getItem("calibrationB")||"null");Y&&m(Y),Q&&S(Q)}catch{}return(async()=>await Ae())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(Q=>Q.stop()),n.current=null);const Y=e.current;Y&&(Y.srcObject=null)}},[]),N.useEffect(()=>{localStorage.setItem($r.roiSize,String(L))},[L]),N.useEffect(()=>{localStorage.setItem($r.hueWeight,String(X))},[X]),N.useEffect(()=>{localStorage.setItem($r.satWeight,String(g))},[g]),N.useEffect(()=>{localStorage.setItem($r.valWeight,String(E))},[E]),N.useEffect(()=>{localStorage.setItem($r.sensitivity,String(T))},[T]);const Ae=N.useCallback(async()=>{const Y=e.current;if(!Y)return;n.current&&(n.current.getTracks().forEach(ye=>ye.stop()),n.current=null);const Q=++s.current;a(!1),d("Requesting camera...");try{const ye=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||Q!==s.current){ye.getTracks().forEach(le=>le.stop());return}if(n.current=ye,Y.srcObject=ye,await new Promise(le=>{if(Y.readyState>=1&&Y.videoWidth>0)return le();const z=()=>{Y.removeEventListener("loadedmetadata",z),le()};Y.addEventListener("loadedmetadata",z,{once:!0}),setTimeout(()=>{Y.removeEventListener("loadedmetadata",z),le()},1500)}),!r.current||Q!==s.current){ye.getTracks().forEach(le=>le.stop());return}try{await Y.play(),Wc("video.play resolved")}catch(le){Wc("video.play rejected",le)}a(!0),d("")}catch(ye){d(`Camera error: ${(ye==null?void 0:ye.message)||ye}`),Wc("getUserMedia error",ye)}},[]),xe=(Y,Q,ye)=>{Y/=255,Q/=255,ye/=255;const le=Math.max(Y,Q,ye),P=Math.min(Y,Q,ye),z=le-P;let J=0;z!==0&&(le===Y?J=60*((Q-ye)/z%6):le===Q?J=60*((ye-Y)/z+2):J=60*((Y-Q)/z+4)),J<0&&(J+=360);const ue=le===0?0:z/le*255,$=le*255;return[J/2,ue,$]},ge=()=>{const Y=e.current,Q=t.current;if(!Y||!Q||Y.videoWidth===0)return null;const ye=Y.videoWidth,le=Y.videoHeight;Q.width=ye,Q.height=le;const P=Q.getContext("2d");P.drawImage(Y,0,0,ye,le);const z=Math.max(10,Math.min(300,Math.floor(L))),J=Math.floor(ye/2-z/2),ue=Math.floor(le/2-z/2),v=P.getImageData(J,ue,z,z).data;let R=0,b=0,M=0,B=0,U=0;for(let tt=0;tt<v.length;tt+=4){const[lt,ut,Ge]=xe(v[tt],v[tt+1],v[tt+2]),He=lt*2*(Math.PI/180);R+=Math.cos(He),b+=Math.sin(He),M+=ut,B+=Ge,U++}if(U===0)return null;const W=M/U,ce=B/U,me=R/U,Ce=b/U;let Ue=Math.atan2(Ce,me)*(180/Math.PI);return Ue<0&&(Ue+=360),{h:Ue/2,s:W,v:ce}},Z=Y=>{const Q=ge();if(!Q){d("Could not sample video frame.");return}Y==="A"?(localStorage.setItem("calibrationA",JSON.stringify(Q)),m(Q),d(`Saved Player A: h${Q.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(Q)),S(Q),d(`Saved Player B: h${Q.h.toFixed(0)}`))},oe=Y=>{Y==="A"?(localStorage.removeItem("calibrationA"),m(null)):(localStorage.removeItem("calibrationB"),S(null)),d("Cleared")},ne=()=>{se(!0),K("playerA"),q(5),te.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};N.useEffect(()=>{if(!(!H||V==="idle"||V==="optimizing"||V==="complete"))if(ee>0){const Y=setTimeout(()=>{q(ee-1)},1e3);return()=>clearTimeout(Y)}else V==="playerA"?(K("switching"),q(3),d("Switch to Player B... Get ready!")):V==="switching"?(K("playerB"),q(5),d("Hold Player B bracelet in center square...")):V==="playerB"&&(K("optimizing"),ve())},[H,V,ee]),N.useEffect(()=>{if(!H||V==="idle"||V==="switching"||V==="optimizing"||V==="complete")return;const Y=setInterval(()=>{const Q=ge();Q&&(V==="playerA"?te.current.A.push(Q):V==="playerB"&&te.current.B.push(Q))},200);return()=>clearInterval(Y)},[H,V]);const ve=()=>{d("Optimizing parameters...");const Y=te.current.A,Q=te.current.B;if(Y.length===0||Q.length===0){d("Error: Not enough samples collected!"),se(!1),K("idle");return}const ye=Me(Y),le=Me(Q),P=Math.min(Math.abs(ye.h-le.h),180-Math.abs(ye.h-le.h)),z=Math.abs(ye.s-le.s),J=Math.abs(ye.v-le.v),ue=P/90,$=z/255,v=J/255,R=Ie(Y),b=Ie(Q),M={h:(R.h+b.h)/2,s:(R.s+b.s)/2,v:(R.v+b.v)/2},B=ue+$+v,U=B>0?ue/B*(1/(1+M.h/20))*6:2,W=B>0?$/B*(1/(1+M.s/50))*4:1,ce=B>0?v/B*(1/(1+M.v/50))*3:.5;C(Math.max(.5,Math.min(6,U))),y(Math.max(.1,Math.min(4,W))),j(Math.max(.1,Math.min(3,ce)));const me=De(Y,Q,ye,le),Ce=Math.max(0,Math.min(.8,me*.5));D(Ce),localStorage.setItem("calibrationA",JSON.stringify(ye)),localStorage.setItem("calibrationB",JSON.stringify(le)),m(ye),S(le),K("complete"),d(` Auto-calibration complete! Collected ${Y.length+Q.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{se(!1),K("idle")},3e3)},Me=Y=>{const Q=Y.map(b=>b.h),ye=Y.map(b=>b.s).sort((b,M)=>b-M),le=Y.map(b=>b.v).sort((b,M)=>b-M);let P=0,z=0;Q.forEach(b=>{const M=b*2*(Math.PI/180);P+=Math.cos(M),z+=Math.sin(M)});let ue=Math.atan2(z/Q.length,P/Q.length)*(180/Math.PI);ue<0&&(ue+=360);const $=ue/2,v=ye[Math.floor(ye.length/2)],R=le[Math.floor(le.length/2)];return{h:$,s:v,v:R}},Ie=Y=>{const Q=Y.reduce((le,P)=>({h:le.h+P.h,s:le.s+P.s,v:le.v+P.v}),{h:0,s:0,v:0});Q.h/=Y.length,Q.s/=Y.length,Q.v/=Y.length;const ye=Y.reduce((le,P)=>({h:le.h+Math.pow(P.h-Q.h,2),s:le.s+Math.pow(P.s-Q.s,2),v:le.v+Math.pow(P.v-Q.v,2)}),{h:0,s:0,v:0});return{h:ye.h/Y.length,s:ye.s/Y.length,v:ye.v/Y.length}},De=(Y,Q,ye,le)=>{let P=0;const z=Math.min(Y.length,Q.length)*2;return Y.forEach(J=>{const ue=Oe(J,ye);Oe(J,le)<ue*1.5&&P++}),Q.forEach(J=>{const ue=Oe(J,ye),$=Oe(J,le);ue<$*1.5&&P++}),P/z},Oe=(Y,Q)=>{const ye=Math.min(Math.abs(Y.h-Q.h),180-Math.abs(Y.h-Q.h)),le=Math.abs(Y.s-Q.s),P=Math.abs(Y.v-Q.v);return Math.sqrt(ye*ye+le*le+P*P)},ze=()=>{se(!1),K("idle"),q(5),d("Generic mode cancelled")};return u.jsxs("div",{className:"calib-root",children:[u.jsxs("div",{className:"calib-header",children:[u.jsx("h2",{children:"Color Calibration"}),u.jsxs("div",{className:"calib-actions",children:[u.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),u.jsx("button",{onClick:Ae,children:"Restart Camera"})]})]}),l&&u.jsx("div",{className:"calib-message",children:l}),u.jsxs("div",{className:"calib-content",children:[u.jsx("div",{children:u.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[u.jsx("div",{className:"label",children:"Live Preview"}),u.jsx("div",{className:"value",style:{marginBottom:8},children:H?`Generic Mode Active: ${V==="playerA"?"Player A":V==="switching"?"Switching...":V==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),u.jsxs("div",{className:"calib-video-wrap",children:[u.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),u.jsx("div",{className:"calib-center-box",style:{width:L,height:L,borderColor:"#22d3ee",borderWidth:H?"4px":"3px",boxShadow:H?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),H&&ee>0&&u.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:ee})]})]})}),u.jsxs("div",{className:"calib-controls",children:[u.jsxs("div",{className:"calib-block",style:{background:H?"#1a2332":"#0f172a",border:H?"2px solid #22d3ee":"1px solid #1f2937"},children:[u.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),u.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),H?u.jsxs("div",{style:{marginTop:8},children:[u.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[V==="playerA"&&`Player A: Hold bracelet steady... ${ee}s`,V==="switching"&&`Switch hands! Get Player B ready... ${ee}s`,V==="playerB"&&`Player B: Hold bracelet steady... ${ee}s`,V==="optimizing"&&"Optimizing parameters...",V==="complete"&&" Complete!"]}),u.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[V==="playerA"&&`Samples collected: ${te.current.A.length}`,V==="switching"&&`Player A: ${te.current.A.length} samples collected`,V==="playerB"&&`Samples collected: ${te.current.B.length}`]}),V!=="complete"&&u.jsx("button",{onClick:ze,style:{background:"#ef4444"},children:"Cancel"})]}):u.jsx("div",{className:"buttons",children:u.jsx("button",{onClick:ne,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),u.jsxs("div",{className:"calib-block",children:[u.jsx("div",{className:"label",children:"Detector Settings"}),u.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Detection square size"}),u.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:L,onChange:Y=>F(Number(Y.target.value))}),u.jsxs("span",{style:{textAlign:"right"},children:[L,"px"]})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Hue weight"}),u.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:X,onChange:Y=>C(Number(Y.target.value))}),u.jsx("span",{style:{textAlign:"right"},children:X.toFixed(1)})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Saturation weight"}),u.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:g,onChange:Y=>y(Number(Y.target.value))}),u.jsx("span",{style:{textAlign:"right"},children:g.toFixed(1)})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Value weight"}),u.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:E,onChange:Y=>j(Number(Y.target.value))}),u.jsx("span",{style:{textAlign:"right"},children:E.toFixed(1)})]}),u.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[u.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),u.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:T,onChange:Y=>D(Number(Y.target.value))}),u.jsxs("span",{style:{textAlign:"right"},children:[(T*100).toFixed(0),"%"]})]}),u.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),u.jsxs("div",{className:"calib-block",children:[u.jsx("div",{className:"label",children:"Player A"}),u.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:y1(h)}}),u.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),u.jsxs("div",{className:"buttons",children:[u.jsx("button",{onClick:()=>Z("A"),disabled:!i,children:"Save A"}),u.jsx("button",{onClick:()=>oe("A"),children:"Clear A"})]})]}),u.jsxs("div",{className:"calib-block",children:[u.jsx("div",{className:"label",children:"Player B"}),u.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[u.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:y1(w)}}),u.jsx("span",{children:w?`h${w.h.toFixed(0)} s${w.s.toFixed(0)} v${w.v.toFixed(0)}`:""})]}),u.jsxs("div",{className:"buttons",children:[u.jsx("button",{onClick:()=>Z("B"),disabled:!i,children:"Save B"}),u.jsx("button",{onClick:()=>oe("B"),children:"Clear B"})]})]})]})]}),u.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function K2({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var $;const[a,l]=N.useState(e),[d,h]=N.useState(0),[m,w]=N.useState(!1),[S,_]=N.useState(1),[L,F]=N.useState(ia()),[X,C]=N.useState(!0),[g,y]=N.useState([]),[E,j]=N.useState(null),[T,D]=N.useState(!1),H=N.useRef(null),se=N.useRef(null),V=N.useRef(null),K=n&&!e,ee=["summary-container",r].filter(Boolean).join(" "),q=(v,R)=>{const b=V.current;if(!b)return 0;const M=b.offsetHeight;return(v+.5)*M},te=N.useCallback((v,R=null)=>{const b=R||a;if(!b)return;let M=ia(),B=!0;const U=[];let W=null;for(let ce=0;ce<=v&&ce<b.moves.length;ce++){const me=b.moves[ce];me.phase==="experiment"&&B&&(B=!1,M=ia());const Ce=me.all_positions||(me.allPositions?me.allPositions.map(Pe=>[Pe[0]*.07,Pe[1]*.07]):null);if(me.type==="moveblock"&&Ce)Ce.length===10&&M.length===10?M=M.map((Pe,Ue)=>{const Je=Ce[Ue];return Je&&Array.isArray(Je)&&Je.length===2?{...Pe,position:[Je[0],Je[1]]}:Pe}):console.warn(`Position count mismatch: blocks=${M.length}, positions=${Ce==null?void 0:Ce.length}`),M=rf(nf(M),B),W=me.blockId!==void 0?me.blockId:me.unit;else if(me.type==="added shape to gallery"&&me.gallery_normalized){const Pe=document.createElement("canvas");Pe.width=400,Pe.height=400;const Ue=Pe.getContext("2d");Ue.fillStyle="#000",Ue.fillRect(0,0,400,400),me.gallery_normalized.forEach(Je=>{const tt=(Je[0]+.5)*400,lt=(Je[1]+.5)*400;Ue.fillStyle="green";const ut=60;Ue.fillRect(tt-ut/2,lt-ut/2,ut,ut)}),U.push({number:me.gallery_shape_number,image:Pe.toDataURL()}),W=null}}F(M),C(B),y(U),j(W)},[a]),Ae=v=>{l(v),h(0),w(!1),setTimeout(()=>{te(0,v)},0)},xe=v=>{if(!K)return;const R=v.target.files[0];if(!R)return;const b=new FileReader;b.onload=M=>{try{const B=JSON.parse(M.target.result);Ae(B)}catch(B){alert("Failed to parse JSON file: "+B.message)}},b.readAsText(R)};N.useEffect(()=>{e&&Ae(e)},[e]),N.useEffect(()=>{a&&d>=0&&te(d)},[a,d,te]),N.useEffect(()=>{const v=()=>{a&&d>=0&&setTimeout(()=>{te(d)},100)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[a,d,te]);const ge=v=>{a&&(v<0||v>=a.moves.length||(te(v),h(v)))},Z=()=>{if(!a||m)return;w(!0),h(0),te(0);let v=0;se.current=setInterval(()=>{if(v>=a.moves.length){oe();return}v++,te(v),h(v)},1e3/S)},oe=()=>{se.current&&(clearInterval(se.current),se.current=null),w(!1)};if(N.useEffect(()=>()=>{se.current&&clearInterval(se.current)},[]),N.useEffect(()=>{if(m&&se.current){clearInterval(se.current),se.current=null;const v=d;h(0),w(!1),setTimeout(()=>{h(v),Z()},0)}},[S]),!a)return K?u.jsx("div",{className:ee,children:u.jsxs("div",{className:"summary-upload",children:[u.jsx("h1",{children:t}),u.jsx("p",{children:"Load a game session JSON file to view the replay"}),u.jsx("input",{ref:H,type:"file",accept:".json",onChange:xe,style:{display:"none"}}),u.jsx("button",{onClick:()=>{var v;return(v=H.current)==null?void 0:v.click()},children:"Load JSON File"})]})}):null;const ne=a.moves[d],ve=a.moves.length,Me=(($=a.summary)==null?void 0:$.movesByPlayer)||{},Ie=Object.entries(Me||{}),De=(v,R=1)=>Number.isFinite(v)?v.toFixed(R):"",Oe=a.sessionInfo||{},ze=Oe.subjectId||Oe.id||a.subjectId||a.id||null,Y=Oe.sessionGameId||a.sessionGameId||ze||null,Q=Oe.condition||a.condition||null,ye=a.startTime||Oe.startedAt||Oe.date||null,le=a.endTime||Oe.endedAt||null,P=v=>{if(!v)return null;try{const R=new Date(v);if(!Number.isNaN(R.getTime()))return R.toLocaleString()}catch{}return v},z=[];Y&&z.push({label:"Session ID",value:Y}),ze&&ze!==Y&&z.push({label:"Participant",value:ze}),Q&&z.push({label:"Condition",value:Q});const J=P(ye);J&&z.push({label:"Start",value:J});const ue=P(le);return ue&&z.push({label:"End",value:ue}),u.jsxs("div",{className:ee,children:[u.jsxs("div",{className:"summary-header",children:[u.jsx("h1",{children:t}),z.length>0&&u.jsx("div",{className:"summary-session-info",children:z.map(v=>u.jsxs("div",{className:"summary-session-info-item",children:[u.jsx("span",{className:"summary-session-info-label",children:v.label}),u.jsx("span",{className:"summary-session-info-value",children:v.value})]},`${v.label}-${v.value}`))})]}),u.jsxs("div",{className:"summary-main",children:[u.jsxs("div",{className:"summary-left",children:[u.jsx("div",{className:"summary-game-area",children:u.jsxs("div",{className:"game-canvas",ref:V,children:[u.jsx("div",{className:"gallery",children:u.jsx("div",{className:"gallery-frame",children:g.length>0?u.jsx("img",{src:g[g.length-1].image,alt:"Gallery",className:"gallery-image"}):u.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),L.map((v,R)=>{const b=v.position||[0,0];return!Array.isArray(b)||b.length!==2||!Number.isFinite(b[0])||!Number.isFinite(b[1])?(console.warn(`Invalid position for block ${v.id}:`,b),null):u.jsx("div",{className:`block ${v.canMove?"movable":""} ${v.id===E?"highlighted":""}`,style:{left:`${q(b[0])}px`,top:`${q(b[1])}px`,backgroundColor:v.color||"green",cursor:v.canMove?"grab":"default",zIndex:v.id===E?20:R+1}},v.id)})]})}),u.jsxs("div",{className:"summary-progress",children:[u.jsx("input",{type:"range",min:"0",max:Math.max(0,ve-1),value:d,onChange:v=>ge(parseInt(v.target.value)),style:{width:"100%"}}),u.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",ve,ne&&u.jsxs("span",{className:"move-info",children:[" "," Player: ",ne.player,Array.isArray(ne.position)&&ne.position.length===2&&`  Position: (${ne.position[0]}, ${ne.position[1]})`,Number.isFinite(ne.holdTime)&&`  Hold: ${De(ne.holdTime,2)}s`," "," Time: ",De(ne.elapsed,1),"s"]})]})]})]}),u.jsxs("div",{className:"summary-right",children:[u.jsxs("div",{className:"summary-stats",children:[u.jsxs("div",{className:"summary-stats-row",children:[u.jsx("span",{className:"summary-stats-label",children:"Duration"}),u.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),u.jsxs("div",{className:"summary-stats-row",children:[u.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),u.jsx("span",{className:"summary-stats-value",children:ve})]}),u.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[u.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),u.jsx("div",{className:"summary-stats-value",children:Ie.length===0?u.jsx("span",{children:""}):Ie.map(([v,R])=>u.jsxs("div",{children:[v,": ",R]},v))})]})]}),u.jsxs("div",{className:"summary-controls",children:[u.jsx("button",{onClick:()=>ge(0),disabled:d===0,children:" First"}),u.jsx("button",{onClick:()=>ge(d-1),disabled:d===0,children:" Previous"}),u.jsx("button",{onClick:m?oe:Z,children:m?" Pause":" Play"}),u.jsx("button",{onClick:()=>ge(d+1),disabled:d>=ve-1,children:" Next"}),u.jsx("button",{onClick:()=>ge(ve-1),disabled:d>=ve-1,children:" Last"}),u.jsxs("div",{className:"speed-control",children:[u.jsx("label",{children:"Speed:"}),u.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:S,onChange:v=>_(parseFloat(v.target.value))}),u.jsxs("span",{children:[S,"x"]})]}),K&&u.jsxs(u.Fragment,{children:[u.jsx("input",{ref:H,type:"file",accept:".json",onChange:xe,style:{display:"none"}}),u.jsx("button",{onClick:()=>{var v;return(v=H.current)==null?void 0:v.click()},children:" Load New File"})]})]}),u.jsxs("div",{className:"summary-moves-list",children:[u.jsxs("div",{className:"move-list-header",children:[u.jsx("h2",{children:"Move History"}),i&&u.jsx("button",{className:`edit-mode-toggle ${T?"active":""}`,onClick:()=>D(!T),children:T?" Done Editing":"Edit Players"})]}),u.jsx("div",{className:"moves-scroll",children:a.moves.map((v,R)=>u.jsxs("div",{className:`move-item ${R===d?"active":""} ${T?"edit-mode":""}`,onClick:()=>!T&&ge(R),children:[u.jsx("div",{className:"move-number",children:R+1}),v.camera_frame&&u.jsx("div",{className:"move-camera-frame",children:u.jsx("img",{src:v.camera_frame,alt:`Camera frame for move ${R+1}`,className:"camera-frame-thumbnail"})}),u.jsxs("div",{className:"move-details",children:[u.jsx("div",{className:"move-type",children:v.type}),T&&i?u.jsxs("div",{className:"move-player-edit",children:[u.jsx("label",{children:"Player:"}),u.jsxs("select",{value:v.player||"Unknown",onChange:b=>{const M=b.target.value;i(v._id,M)},onClick:b=>b.stopPropagation(),children:[u.jsx("option",{value:"Player A",children:"Player A"}),u.jsx("option",{value:"Player B",children:"Player B"}),u.jsx("option",{value:"None",children:"None"}),u.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):u.jsxs("div",{className:"move-player",children:["Player: ",v.player]}),v.blockId!==null&&v.blockId!==void 0||v.unit!==null&&v.unit!==void 0?u.jsxs("div",{className:"move-unit",children:["Block: ",v.blockId!==void 0?v.blockId:v.unit]}):null,Array.isArray(v.position)&&v.position.length===2&&u.jsxs("div",{className:"move-position",children:["Position: (",v.position[0],", ",v.position[1],")"]}),Number.isFinite(v.holdTime)&&v.holdTime>0&&u.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",De(v.holdTime,2),"s"]}),u.jsxs("div",{className:"move-time",children:["Time: ",De(v.elapsed,1),"s"]})]})]},R))})]})]})]})]})}const Jt=(...e)=>{console.log("[Detector2]",...e)},yn={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function fx(){const e=N.useRef(null),t=N.useRef(null),n=N.useRef(null),r=N.useRef(null),s=N.useRef(null),i=N.useRef(null),a=N.useRef(null),l=N.useRef(null),d=N.useRef(null),[h,m]=N.useState(""),[w,S]=N.useState(!1),[_,L]=N.useState({camA:"None",camB:"None",merged:"None"}),[F,X]=N.useState(!0),[C,g]=N.useState(null),[y,E]=N.useState(null),j=N.useRef(null),T=N.useRef(null),D=(v,R)=>{const b=localStorage.getItem(v);if(b===null)return R;const M=parseFloat(b);return Number.isFinite(M)?M:R},[H,se]=N.useState(()=>({roiSize:(()=>{const v=D(yn.roiSize,44);return v>10?v:44})(),hueWeight:D(yn.hueWeight,4),satWeight:D(yn.satWeight,2),valWeight:D(yn.valWeight,1),sensitivity:D(yn.sensitivity,0)})),V=N.useRef(H),[K,ee]=N.useState([]),[q,te]=N.useState(""),[Ae,xe]=N.useState("");N.useEffect(()=>{let v=!0;(async()=>{try{const B=(await navigator.mediaDevices.enumerateDevices()).filter(W=>W.kind==="videoinput");if(B.length===0){m("No cameras found");return}ee(B);const U=B.slice(0,2).map(W=>W.deviceId);te(U[0]||""),xe(U[1]||U[0]||""),await ge(U[0],e,l),U[1]?await ge(U[1],t,d):await ge(U[0],t,d),await De(),await Oe("A",e,i),await Oe("B",t,a)}catch(M){if(!v)return;m((M==null?void 0:M.message)||String(M))}})();const R=()=>{try{const M=JSON.parse(localStorage.getItem("calibrationA")||"null"),B=JSON.parse(localStorage.getItem("calibrationB")||"null");M&&g({h:M.h,s:M.s,v:M.v}),B&&E({h:B.h,s:B.s,v:B.v})}catch{Jt("No existing calibrations")}};R();const b=M=>{!M||!M.key||(["calibrationA","calibrationB"].includes(M.key)&&R(),[yn.roiSize,yn.hueWeight,yn.satWeight,yn.valWeight,yn.sensitivity].includes(M.key)&&se(B=>({roiSize:(()=>{const U=D(yn.roiSize,(B==null?void 0:B.roiSize)??44);return U>10?U:(B==null?void 0:B.roiSize)??44})(),hueWeight:D(yn.hueWeight,(B==null?void 0:B.hueWeight)??4),satWeight:D(yn.satWeight,(B==null?void 0:B.satWeight)??2),valWeight:D(yn.valWeight,(B==null?void 0:B.valWeight)??1),sensitivity:D(yn.sensitivity,(B==null?void 0:B.sensitivity)??0)})))};return window.addEventListener("storage",b),()=>{if(v=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),l.current&&(l.current.getTracks().forEach(U=>U.stop()),l.current=null),d.current&&(d.current.getTracks().forEach(U=>U.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const M=e.current;M&&(M.srcObject=null);const B=t.current;B&&(B.srcObject=null),window.removeEventListener("storage",b)}},[]);const ge=async(v,R,b)=>{const M={video:{deviceId:{exact:v}}};Jt("Starting camera with deviceId:",v);const B=await navigator.mediaDevices.getUserMedia(M);b.current=B;const U=R.current;if(!U){Jt("Video element not found!");return}U.srcObject=B,Jt("Stream assigned to video element, waiting for metadata..."),await new Promise(W=>{if(U.readyState>=2&&U.videoWidth>0&&U.videoHeight>0)return Jt("Video already ready:",U.videoWidth,"x",U.videoHeight),W();const me=()=>{Jt("loadedmetadata event fired:",U.videoWidth,"x",U.videoHeight),U.removeEventListener("loadedmetadata",me),W()};U.addEventListener("loadedmetadata",me,{once:!0}),setTimeout(()=>{Jt("Metadata timeout - proceeding anyway"),U.removeEventListener("loadedmetadata",me),W()},2e3)});try{await U.play(),Jt("Video play() succeeded")}catch(W){Jt("Video play() failed:",W)}},Z=N.useRef(null),oe=N.useRef(null),ne=N.useRef(null),ve=N.useRef(!1),Me=async()=>{if(!ve.current){ve.current=!0;try{for(;oe.current||ne.current;){const v=s.current;if(!v)break;let R=null,b=null;if(oe.current?(R="A",b=oe.current,oe.current=null):ne.current&&(R="B",b=ne.current,ne.current=null),!!b){Z.current=R;try{await v.send({image:b})}catch(M){console.error("[Detector2] hands.send error:",M);break}}}}finally{ve.current=!1}}},Ie=(v,R)=>{v==="A"?oe.current=R:ne.current=R,Promise.resolve().then(Me)},De=async()=>{if(s.current)return s.current;try{const v=await(async()=>{try{if(typeof su.Hands=="function")return su.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const b=document.getElementById("mp-hands-cdn-script");if(b&&(await new Promise(M=>{if(window.Hands&&typeof window.Hands=="function")return M();const B=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(B),M())},50);setTimeout(()=>{clearInterval(B),M()},3e3)}),window.Hands&&typeof window.Hands=="function")||(b||await new Promise((M,B)=>{const U=document.createElement("script");U.id="mp-hands-cdn-script",U.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",U.async=!0,U.onload=()=>M(),U.onerror=W=>B(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(U)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),R=new v({locateFile:b=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${b}`});return R.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),R.onResults(b=>{const M=Z.current;M==="A"?Q(b):M==="B"&&ye(b)}),s.current=R,R}catch(v){return console.error("MediaPipe initialization error:",v),m(`MediaPipe error: ${v.message}`),null}},Oe=async(v,R,b)=>{if(!await De())return;const B=R.current;if(!B){Jt(`Video ref for ${v} not found`);return}Jt(`Initializing manual frame capture for camera ${v}, video dimensions:`,B.videoWidth,"x",B.videoHeight);let U=null;const W=()=>{const ce=R.current;ce&&ce.readyState>=2&&ce.videoWidth>0&&Ie(v,ce),U=requestAnimationFrame(W)};U=requestAnimationFrame(W),b.current={stop:()=>{U&&(cancelAnimationFrame(U),U=null,Jt(`Stopped manual frame capture for camera ${v}`))}},Jt(`Manual frame capture started for camera ${v}`)},ze=N.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),Y=N.useRef({wristY:null,player:"None",landmarks:null,wristX:null});N.useEffect(()=>{j.current=C},[C]),N.useEffect(()=>{T.current=y},[y]),N.useEffect(()=>{V.current=H},[H]);const Q=v=>le(v,n,"A"),ye=v=>le(v,r,"B"),le=(v,R,b)=>{var ut;const M=R.current;if(!M)return;const B=M.getContext("2d");if(!B)return;const U=b==="A"?e.current:t.current;if(!U||U.videoWidth===0||U.videoHeight===0){b==="A"?ze.current={wristY:null,wristX:null,landmarks:null,player:"None"}:Y.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}M.width=U.videoWidth,M.height=U.videoHeight,B.drawImage(U,0,0,M.width,M.height),B.fillStyle="rgba(0, 0, 0, 0.6)",B.fillRect(M.width-80,5,75,20),B.fillStyle="white",B.font="bold 14px Arial",B.fillText(`Camera ${b}`,M.width-75,20);let W=null,ce=null,me=null,Ce=[];if(v.multiHandLandmarks&&v.multiHandLandmarks.length>0)for(const Ge of v.multiHandLandmarks){const He=Ge[0],We=He.x*M.width,Qe=He.y*M.height;Ce.push({x:We,y:Qe,landmarks:Ge}),(W===null||(F?Qe<W:Qe>W))&&(W=Qe,ce=Ge,me=We)}Ce.forEach(({x:Ge,y:He})=>{B.fillStyle="orange",B.beginPath(),B.arc(Ge,He,8,0,Math.PI*2),B.fill()});let Pe="None";if(ce){B.fillStyle="lime",B.beginPath(),B.arc(me,W,10,0,2*Math.PI),B.fill(),B.fillStyle="lime",B.font="16px Arial",B.fillText("SELECTED",me-40,W-15);const He=Math.max(10,Math.min(300,Math.floor(((ut=V.current)==null?void 0:ut.roiSize)||60)))/2,We=Math.max(0,me-He),Qe=Math.max(0,W-He),kt=Math.min(M.width,me+He),Fn=Math.min(M.height,W+He),gt=Math.max(0,Math.floor(We)),zt=Math.max(0,Math.floor(Qe));let Pt=Math.floor(kt-We),nn=Math.floor(Fn-Qe);if(Pt=Math.max(1,Pt),nn=Math.max(1,nn),Pt=Math.min(Pt,M.width-gt),nn=Math.min(nn,M.height-zt),Pt>0&&nn>0){B.strokeStyle="lime",B.lineWidth=3,B.strokeRect(gt,zt,Pt,nn);try{const Kt=B.getImageData(gt,zt,Pt,nn),Qt=j.current,rr=T.current;Pe=z(Kt,Qt,rr).status}catch(Kt){console.warn("[Detector2] ROI sampling failed:",Kt),Pe="None"}}else Jt("ROI skipped due to zero width/height",{width:Pt,height:nn,left:gt,top:zt})}if(Ce.length>=1){let Ge=Ce[0].y,He=Ce[0].y;Ce.forEach(kt=>{kt.y<Ge&&(Ge=kt.y),kt.y>He&&(He=kt.y)}),B.strokeStyle="yellow",B.setLineDash([6,4]),B.beginPath(),B.moveTo(0,F?Ge:He),B.lineTo(M.width,F?Ge:He),B.stroke(),B.strokeStyle="cyan",B.beginPath(),B.moveTo(0,F?He:Ge),B.lineTo(M.width,F?He:Ge),B.stroke(),B.setLineDash([]);const We=F?"A (top)":"A (bottom)",Qe=F?"B (bottom)":"B (top)";B.fillStyle="lime",B.font="16px Arial",B.fillText(We,6,Math.max(14,(F?Ge:He)-6)),B.fillStyle="dodgerblue",B.fillText(Qe,6,Math.min(M.height-6,(F?He:Ge)+18))}const Ue={wristY:W,wristX:me,landmarks:ce,player:Pe};b==="A"?ze.current=Ue:Y.current=Ue;const Je=ze.current.wristY,tt=Y.current.wristY;let lt="None";if(Je!=null||tt!=null){const Ge=F?(We,Qe)=>We==null?Qe:Math.min(We,Qe):(We,Qe)=>We==null?Qe:Math.max(We,Qe);[Je,tt].filter(We=>We!=null).reduce(Ge,null)===Je?lt=ze.current.player:lt=Y.current.player}L({camA:ze.current.player,camB:Y.current.player,merged:lt})},P=(v,R,b)=>{v/=255,R/=255,b/=255;const M=Math.max(v,R,b),B=Math.min(v,R,b),U=M-B;let W=0;U!==0&&(M===v?W=60*((R-b)/U%6):M===R?W=60*((b-v)/U+2):W=60*((v-R)/U+4)),W<0&&(W+=360);const ce=M===0?0:U/M*255,me=M*255;return[W/2,ce,me]},z=(v,R,b)=>{var me,Ce,Pe,Ue;const M=v.data;if(R&&!b)return{status:"Player A",percentA:null,percentB:null};if(b&&!R)return{status:"Player B",percentA:null,percentB:null};const B=((me=V.current)==null?void 0:me.hueWeight)??4,U=((Ce=V.current)==null?void 0:Ce.satWeight)??2,W=((Pe=V.current)==null?void 0:Pe.valWeight)??1,ce=((Ue=V.current)==null?void 0:Ue.sensitivity)??0;if(R&&b){let Je=0,tt=0,lt=0;for(let We=0;We<M.length;We+=4){const Qe=M[We],kt=M[We+1],Fn=M[We+2],[gt,zt,Pt]=P(Qe,kt,Fn),nn=Math.min(1,Math.max(0,zt/255)),Kt=Math.min(1,Math.max(0,Pt/255)),Qt=Math.max(.05,.5*nn+.5*Kt),rr=Math.min(Math.abs(gt-R.h),180-Math.abs(gt-R.h)),Cn=Math.min(Math.abs(gt-b.h),180-Math.abs(gt-b.h)),Qr=Math.abs(zt-R.s),On=Math.abs(zt-b.s),Jr=Math.abs(Pt-R.v),Lr=Math.abs(Pt-b.v),ys=rr*B+Qr*U+Jr*W,$n=Cn*B+On*U+Lr*W;Math.min(ys,$n)>180||(ys<=$n?Je+=Qt:tt+=Qt,lt+=Qt)}if(lt===0)return{status:"None",percentA:0,percentB:0};const ut=Je/Math.max(1e-6,lt),Ge=tt/Math.max(1e-6,lt),He=.12*(1+.8*Math.max(0,Math.min(1,ce)));return ut>=He&&ut>=Ge?{status:"Player A",percentA:ut,percentB:Ge}:Ge>=He&&Ge>ut?{status:"Player B",percentA:ut,percentB:Ge}:{status:"None",percentA:ut,percentB:Ge}}return{status:"None",percentA:0,percentB:0}},J=(v,R,b)=>{const M=(v||0)*2,B=(R||0)/255,U=(b||0)/255,W=U*B,ce=W*(1-Math.abs(M/60%2-1)),me=U-W;let Ce=0,Pe=0,Ue=0;M>=0&&M<60?(Ce=W,Pe=ce,Ue=0):M<120?(Ce=ce,Pe=W,Ue=0):M<180?(Ce=0,Pe=W,Ue=ce):M<240?(Ce=0,Pe=ce,Ue=W):M<300?(Ce=ce,Pe=0,Ue=W):(Ce=W,Pe=0,Ue=ce);const Je=Math.round((Ce+me)*255),tt=Math.round((Pe+me)*255),lt=Math.round((Ue+me)*255);return`rgb(${Je}, ${tt}, ${lt})`},ue=v=>v?J(v.h,v.s,v.v):"#ffffff",$=async(v,R)=>{try{if(v==="A"){if(te(R),i.current){try{i.current.stop()}catch(M){Jt("Stop camA error:",M)}i.current=null}l.current&&(l.current.getTracks().forEach(M=>M.stop()),l.current=null);const b=e.current;b&&(b.srcObject=null),await new Promise(M=>setTimeout(M,100)),await ge(R,e,l),await new Promise(M=>setTimeout(M,200)),await De(),await Oe("A",e,i),Jt("Camera A switched to:",R)}else{if(xe(R),a.current){try{a.current.stop()}catch(M){Jt("Stop camB error:",M)}a.current=null}d.current&&(d.current.getTracks().forEach(M=>M.stop()),d.current=null);const b=t.current;b&&(b.srcObject=null),await new Promise(M=>setTimeout(M,100)),await ge(R,t,d),await new Promise(M=>setTimeout(M,200)),await De(),await Oe("B",t,a),Jt("Camera B switched to:",R)}}catch(b){console.error("[Detector2] Camera switch error:",b),m(`Camera switch error: ${b.message}`)}};return u.jsxs("div",{className:`detector-window ${w?"minimized":""}`,children:[u.jsxs("div",{className:"detector-header",children:[u.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),u.jsxs("div",{className:"detector-controls",children:[u.jsx("button",{onClick:()=>S(!w),children:w?"":""}),u.jsx("button",{onClick:()=>X(!F),title:"Toggle A criterion",children:F?"A=Top":"A=Bottom"})]})]}),u.jsxs("div",{className:"detector-content",style:{display:w?"none":"block"},children:[u.jsxs("div",{style:{display:"flex",gap:8},children:[u.jsxs("div",{style:{flex:1},children:[u.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[u.jsx("span",{children:"Camera A:"}),u.jsx("select",{value:q,onChange:v=>$("A",v.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(v=>u.jsx("option",{value:v.deviceId,children:v.label||`Camera ${v.deviceId.slice(0,8)}`},v.deviceId))})]}),u.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),u.jsx("canvas",{ref:n,className:"output_canvas"})]}),u.jsxs("div",{style:{flex:1},children:[u.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[u.jsx("span",{children:"Camera B:"}),u.jsx("select",{value:Ae,onChange:v=>$("B",v.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(v=>u.jsx("option",{value:v.deviceId,children:v.label||`Camera ${v.deviceId.slice(0,8)}`},v.deviceId))})]}),u.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),u.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),u.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[u.jsxs("div",{className:"status-display",children:["Merged: ",u.jsx("strong",{children:_.merged})]}),u.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),u.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:C?ue(C):"#444"}})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[u.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),u.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:y?ue(y):"#444"}})]})]}),u.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[u.jsxs("div",{children:["A: ",C?`h${Math.round(C.h)} s${Math.round(C.s)} v${Math.round(C.v)}`:""]}),u.jsxs("div",{children:["B: ",y?`h${Math.round(y.h)} s${Math.round(y.s)} v${Math.round(y.v)}`:""]})]}),h&&u.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),u.jsxs("div",{style:{fontSize:12,marginTop:6},children:[u.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const zo=Ru(),v1=e=>{var i,a,l,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((m,w)=>typeof w.elapsed=="number"&&w.elapsed>m?w.elapsed:m,0),r={},s={};return t.forEach(m=>{const w=(m==null?void 0:m.player)||"Unknown";r[w]=(r[w]||0)+1;const S=(m==null?void 0:m.phase)||"unknown";s[S]=(s[S]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((l=(a=e.metadata)==null?void 0:a.config)==null?void 0:l.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},hx=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},w1="adminPassword";function px(){var K;const[e,t]=N.useState([]),[n,r]=N.useState(!0),[s,i]=N.useState(null),[a,l]=N.useState(null),[d,h]=N.useState(null),[m,w]=N.useState(!1),[S,_]=N.useState(null),[L,F]=N.useState(!1),[X,C]=N.useState(""),[g,y]=N.useState(!1);N.useEffect(()=>{const ee=localStorage.getItem(w1);ee&&C(ee)},[]);const E=N.useCallback(async()=>{if(!X){i("Password required"),r(!1);return}r(!0),i(null),y(!1);try{const ee=await fetch(`${zo}/sessions`,{headers:{"x-admin-password":X}});if(ee.status===401||ee.status===403)throw y(!0),new Error("Invalid password");if(!ee.ok)throw new Error(`Failed to load sessions (${ee.status})`);const q=await ee.json(),te=Array.isArray(q)?q:[];localStorage.setItem(w1,X),t(te),l(Ae=>Ae&&te.some(xe=>xe.sessionGameId===Ae)?Ae:te.length>0?te[0].sessionGameId:null)}catch(ee){console.error("[Admin] Error fetching sessions:",ee),i(ee.message||"Failed to load sessions"),t([]),l(null)}finally{r(!1)}},[X]);N.useEffect(()=>{E()},[E]),N.useEffect(()=>{if(!a){h(null);return}let ee=!1;return(async()=>{if(X){w(!0),_(null);try{const te=await fetch(`${zo}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":X}});if(!te.ok)throw te.status===404?new Error("Session not found"):new Error(`Failed to load session (${te.status})`);const Ae=await te.json();ee||h(v1(Ae))}catch(te){console.error("[Admin] Error fetching session detail:",te),ee||(_(te.message||"Failed to load session"),h(null))}finally{ee||w(!1)}}})(),()=>{ee=!0}},[a]);const j=ee=>{l(ee),F(!1)},T=async()=>{if(!a||!X)return;const ee=!L;F(ee),w(!0),_(null);try{const q=ee?`${zo}/sessions/${encodeURIComponent(a)}/experiment-only`:`${zo}/sessions/${encodeURIComponent(a)}`,te=await fetch(q,{headers:{"x-admin-password":X}});if(!te.ok)throw new Error(`Failed to load session data (${te.status})`);const Ae=await te.json();h(v1(Ae))}catch(q){console.error("[Admin] Error loading session data:",q),_(q.message||"Failed to load session data"),F(!ee)}finally{w(!1)}},D=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},H=()=>{if(!d)return;const ee=JSON.stringify(d,null,2),q=new Blob([ee],{type:"application/json"}),te=URL.createObjectURL(q),Ae=document.createElement("a");Ae.href=te;const xe=`${a}_${new Date().toISOString().split("T")[0]}.json`;Ae.download=xe,Ae.click(),URL.revokeObjectURL(te),console.log("[Admin] Downloaded JSON:",xe)},se=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const ee=new Set;d.moves.forEach(ne=>{Object.keys(ne).forEach(ve=>{ve!=="camera_frame"&&ve!=="__v"&&ee.add(ve)})});const q=Array.from(ee),te=[q.join(",")];d.moves.forEach(ne=>{const ve=q.map(Me=>{const Ie=ne[Me];return Ie==null||Ie===""?"":Array.isArray(Ie)||typeof Ie=="object"?`"${JSON.stringify(Ie).replace(/"/g,'""')}"`:`"${String(Ie).replace(/"/g,'""')}"`});te.push(ve.join(","))});const Ae=te.join(`
`),xe=new Blob([Ae],{type:"text/csv;charset=utf-8;"}),ge=URL.createObjectURL(xe),Z=document.createElement("a");Z.href=ge;const oe=`${a}_${new Date().toISOString().split("T")[0]}.csv`;Z.download=oe,Z.click(),URL.revokeObjectURL(ge),console.log("[Admin] Downloaded CSV:",oe)},V=async(ee,q)=>{if(!(!a||!ee||!X))try{const te=await fetch(`${zo}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(ee)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":X},body:JSON.stringify({player:q})});if(!te.ok)throw new Error(`Failed to update player (${te.status})`);h(Ae=>Ae&&{...Ae,moves:Ae.moves.map(xe=>xe._id===ee?{...xe,player:q}:xe)}),console.log("[Admin] Player updated:",ee,q)}catch(te){console.error("[Admin] Error updating player:",te),alert("Failed to update player: "+te.message)}};return u.jsxs("div",{className:"admin-container",children:[u.jsxs("aside",{className:"admin-sidebar",children:[u.jsxs("div",{className:"admin-sidebar-header",children:[u.jsx("h1",{children:"Admin"}),u.jsxs("div",{className:"admin-password-row",children:[u.jsx("input",{type:"password",className:`admin-password-input ${g?"error":""}`,placeholder:"Password",value:X,onChange:ee=>C(ee.target.value),onKeyPress:ee=>{ee.key==="Enter"&&E()}}),u.jsx("button",{className:"admin-refresh-button",onClick:E,disabled:n||!X,children:n?"Refreshing":"Refresh"})]})]}),s&&u.jsx("div",{className:"admin-error",children:s}),u.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&u.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&u.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(ee=>{const q=typeof ee.movesCount=="number"?ee.movesCount:Array.isArray(ee.moves)?ee.moves.length:0,te=ee.sessionGameId===a;return u.jsxs("button",{className:`admin-session-card ${te?"active":""}`,onClick:()=>j(ee.sessionGameId),children:[u.jsx("div",{className:"admin-session-id",children:ee.sessionGameId}),u.jsxs("div",{className:"admin-session-meta",children:[u.jsxs("span",{children:["Participant: ",ee.subjectId||""]}),u.jsxs("span",{children:["Condition: ",ee.condition||""]})]}),u.jsxs("div",{className:"admin-session-meta",children:[u.jsxs("span",{children:["Moves: ",q]}),u.jsxs("span",{children:["Updated: ",hx(ee.updatedAt)]})]})]},ee.sessionGameId)})]})]}),u.jsxs("main",{className:"admin-content",children:[m&&u.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),S&&u.jsx("div",{className:"admin-error admin-error--content",children:S}),!m&&!S&&d&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"admin-toolbar",children:[u.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[u.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),u.jsx("button",{className:`admin-toolbar-button experiment-toggle ${L?"active":""}`,onClick:T,title:L?"Show all moves (including practice)":"Show only experiment phase moves",children:L?"Show All Moves":"Experiment Only"}),u.jsx("button",{className:"admin-toolbar-button edit-players",onClick:D,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),u.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[u.jsx("button",{className:"admin-toolbar-button download-json",onClick:H,title:"Download session data as JSON",children:"Download JSON"}),u.jsx("button",{className:"admin-toolbar-button download-csv",onClick:se,title:"Download moves as CSV",children:"Download CSV"})]})]}),u.jsx("div",{className:"admin-summary-wrapper",children:u.jsx(K2,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((K=d.sessionInfo)==null?void 0:K.sessionGameId)||a||""}${L?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:V})})]}),!m&&!S&&!d&&u.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const x1="adminPassword";function mx(){const[e,t]=N.useState(null),[n,r]=N.useState(!1),[s,i]=N.useState(null),[a,l]=N.useState(null),[d,h]=N.useState(null),[m,w]=N.useState(""),[S,_]=N.useState(!1);N.useEffect(()=>{const X=localStorage.getItem(x1);X&&w(X)},[]);const L=X=>{const C=X.target.files[0];if(!C)return;if(!C.name.endsWith(".json")){l("Please select a JSON file"),t(null);return}t(C),l(null),i(null);const g=new FileReader;g.onload=y=>{var E;try{const j=JSON.parse(y.target.result);h({sessionGameId:j.sessionGameId||"N/A",subjectId:j.subjectId||"N/A",condition:j.condition||"N/A",date:j.date||"N/A",movesCount:((E=j.moves)==null?void 0:E.length)||0,hasColorA:!!j.colorA,hasColorB:!!j.colorB})}catch(j){l("Invalid JSON file: "+j.message),h(null)}},g.readAsText(C)},F=async()=>{var X;if(!e){l("Please select a file first");return}r(!0),l(null),i(null);try{const C=await new Promise((T,D)=>{const H=new FileReader;H.onload=se=>T(se.target.result),H.onerror=D,H.readAsText(e)}),g=JSON.parse(C);if(!g.sessionGameId||!g.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!m)throw new Error("Admin password is required. Please enter it below.");const y=await fetch(`${Ru()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":m},body:JSON.stringify(g)}),E=await y.json();if(y.status===401||y.status===403)throw _(!0),new Error(E.message||"Invalid admin password");if(!y.ok)throw new Error(E.message||"Upload failed");localStorage.setItem(x1,m),_(!1),i(` Successfully uploaded session "${g.sessionGameId}" with ${((X=g.moves)==null?void 0:X.length)||0} moves`),t(null),h(null);const j=document.getElementById("json-file-input");j&&(j.value="")}catch(C){l(C.message||"Failed to upload file")}finally{r(!1)}};return u.jsx("div",{className:"admin-upload-container",children:u.jsxs("div",{className:"admin-upload-card",children:[u.jsx("h1",{children:"Admin: Upload Session JSON"}),u.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),u.jsxs("div",{className:"admin-upload-form",children:[u.jsxs("div",{className:"password-input-wrapper",children:[u.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),u.jsx("input",{id:"admin-password",type:"password",value:m,onChange:X=>{w(X.target.value),_(!1)},placeholder:"Enter admin password",className:S?"error":""}),S&&u.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),u.jsxs("div",{className:"file-input-wrapper",children:[u.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:L,disabled:n}),u.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&u.jsxs("div",{className:"file-preview",children:[u.jsx("h3",{children:"File Preview"}),u.jsxs("div",{className:"preview-grid",children:[u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Condition:"})," ",d.condition]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Date:"})," ",d.date]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),u.jsxs("div",{className:"preview-item",children:[u.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&u.jsxs("div",{className:"error-message",children:[u.jsx("strong",{children:"Error:"})," ",a]}),s&&u.jsx("div",{className:"success-message",children:s}),u.jsx("button",{className:"upload-button",onClick:F,disabled:!e||!m||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var pi=typeof self<"u"?self:{};function qs(){throw Error("Invalid UTF8")}function S1(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let dl,Vc;const gx=typeof TextDecoder<"u";let yx;const vx=typeof TextEncoder<"u";function Q2(e){if(vx)e=(yx||(yx=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var yh,iu;e:{for(var k1=["CLOSURE_FLAGS"],Yc=pi,Xc=0;Xc<k1.length;Xc++)if((Yc=Yc[k1[Xc]])==null){iu=null;break e}iu=Yc}var _a,A1=iu&&iu[610401301];yh=A1!=null&&A1;const E1=pi.navigator;function sf(e){return!!yh&&!!_a&&_a.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function dr(e){var t;return(t=pi.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function Ns(){return!!yh&&!!_a&&_a.brands.length>0}function Kc(){return Ns()?sf("Chromium"):(dr("Chrome")||dr("CriOS"))&&!(!Ns()&&dr("Edge"))||dr("Silk")}function vh(e){return vh[" "](e),e}_a=E1&&E1.userAgentData||null,vh[" "]=function(){};var wx=!Ns()&&(dr("Trident")||dr("MSIE"));!dr("Android")||Kc(),Kc(),dr("Safari")&&(Kc()||!Ns()&&dr("Coast")||!Ns()&&dr("Opera")||!Ns()&&dr("Edge")||(Ns()?sf("Microsoft Edge"):dr("Edg/"))||Ns()&&sf("Opera"));var J2={},Xo=null;function xx(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function l(h){for(;d<i.length;){const m=i.charAt(d++),w=Xo[m];if(w!=null)return w;if(!/^[\s\xa0]*$/.test(m))throw Error("Unknown base64 encoding at char: "+m)}return h}q2();let d=0;for(;;){const h=l(-1),m=l(0),w=l(64),S=l(64);if(S===64&&h===-1)break;a(h<<2|m>>4),w!=64&&(a(m<<4&240|w>>2),S!=64&&a(w<<6&192|S))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function q2(){if(!Xo){Xo={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));J2[n]=r;for(let s=0;s<r.length;s++){const i=r[s];Xo[i]===void 0&&(Xo[i]=s)}}}}var Z2=typeof Uint8Array<"u",ey=!wx&&typeof btoa=="function";function C1(e){if(!ey){var t;t===void 0&&(t=0),q2(),t=J2[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],l=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=l+s+i+a}switch(l=0,a=r,e.length-d){case 2:a=t[(15&(l=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|l>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const _1=/[-_.]/g,Sx={"-":"+",_:"/",".":"="};function kx(e){return Sx[e]||""}function ty(e){if(!ey)return xx(e);_1.test(e)&&(e=e.replace(_1,kx)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function La(e){return Z2&&e!=null&&e instanceof Uint8Array}var ao={};function mi(){return Ax||(Ax=new os(null,ao))}function wh(e){ny(ao);var t=e.g;return(t=t==null||La(t)?t:typeof t=="string"?ty(t):null)==null?t:e.g=t}var os=class{h(){return new Uint8Array(wh(this)||0)}constructor(e,t){if(ny(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let Ax,Ex;function ny(e){if(e!==ao)throw Error("illegal external caller")}function ry(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function of(e){return ry(e=Error(e),"warning"),e}var Lu=typeof Symbol=="function"&&typeof Symbol()=="symbol",Cx=new Set;function Ba(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&Cx.add(e),e}var _x=Ba("jas",void 0,!0,!0),j1=Ba(void 0,"0di"),Qc=Ba(void 0,"2ex"),Uo=Ba(void 0,"1oa",!0),lo=Ba(void 0,Symbol(),!0);const be=Lu?_x:"Ga",sy={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},iy=Object.defineProperties;function Bu(e,t){Lu||be in e||iy(e,sy),e[be]|=t}function Ht(e,t){Lu||be in e||iy(e,sy),e[be]=t}function So(e){return Bu(e,34),e}function jx(e,t){Ht(t,-30975&(0|e))}function af(e,t){Ht(t,-30941&(34|e))}function xh(){return typeof BigInt=="function"}function Rn(e){return Array.prototype.slice.call(e)}var Sh,Fa={},oy={};function N1(e){return!(!e||typeof e!="object"||e.Ia!==oy)}function kh(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function Ah(e,t){if(e!=null){if(typeof e=="string")e=e?new os(e,ao):mi();else if(e.constructor!==os)if(La(e))e=e.length?new os(new Uint8Array(e),ao):mi();else{if(!t)throw Error();e=void 0}}return e}function ou(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[be]))}const b1=[];function Ks(e){if(2&e)throw Error()}Ht(b1,55),Sh=Object.freeze(b1);class au{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new au(this.g,this.h,this.m)}}function Eh(e){return lo?e[lo]:void 0}var Nx=Object.freeze({});function Fu(e){return e.Qa=!0,e}var bx=Fu(e=>typeof e=="number"),M1=Fu(e=>typeof e=="string"),Mx=Fu(e=>typeof e=="boolean"),Ou=typeof pi.BigInt=="function"&&typeof pi.BigInt(0)=="bigint",lf=Fu(e=>Ou?e>=Px&&e<=Rx:e[0]==="-"?T1(e,Tx):T1(e,Ix));const Tx=Number.MIN_SAFE_INTEGER.toString(),Px=Ou?BigInt(Number.MIN_SAFE_INTEGER):void 0,Ix=Number.MAX_SAFE_INTEGER.toString(),Rx=Ou?BigInt(Number.MAX_SAFE_INTEGER):void 0;function T1(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const Lx=typeof Uint8Array.prototype.slice=="function";let ay,dt=0,Bt=0;function P1(e){const t=e>>>0;dt=t,Bt=(e-t)/4294967296>>>0}function uo(e){if(e<0){P1(-e);const[t,n]=Nh(dt,Bt);dt=t>>>0,Bt=n>>>0}else P1(e)}function Ch(e){const t=ay||(ay=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),Bt=0,dt=t.getUint32(0,!0)}function _h(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:ja(e,t)}function jh(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=_h(e,t))=="number"?n?-e:e:n?"-"+e:e}function ja(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else xh()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+I1(n)+I1(e));return n}function I1(e){return e=String(e),"0000000".slice(e.length)+e}function $u(e){if(e.length<16)uo(Number(e));else if(xh())e=BigInt(e),dt=Number(e&BigInt(4294967295))>>>0,Bt=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");Bt=dt=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));Bt*=1e6,dt=1e6*dt+i,dt>=4294967296&&(Bt+=Math.trunc(dt/4294967296),Bt>>>=0,dt>>>=0)}if(t){const[r,s]=Nh(dt,Bt);dt=r,Bt=s}}}function Nh(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const bh=typeof BigInt=="function"?BigInt.asIntN:void 0,Bx=typeof BigInt=="function"?BigInt.asUintN:void 0,Ki=Number.isSafeInteger,Du=Number.isFinite,lu=Math.trunc;function Qs(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function ly(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const Fx=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function zu(e){switch(typeof e){case"bigint":return!0;case"number":return Du(e);case"string":return Fx.test(e);default:return!1}}function ko(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Du(e)?0|e:void 0}function uy(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Du(e)?e>>>0:void 0}function R1(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Mh(e){return e=lu(e),Ki(e)||(uo(e),e=jh(dt,Bt)),e}function Th(e){var t=lu(Number(e));if(Ki(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if($u(e),e=dt,2147483648&(t=Bt))if(xh())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=Nh(e,t);e="-"+ja(n,r)}else e=ja(e,t);return e}function uu(e){return e==null?e:typeof e=="bigint"?(lf(e)?e=Number(e):(e=bh(64,e),e=lf(e)?Number(e):String(e)),e):zu(e)?typeof e=="number"?Mh(e):Th(e):void 0}function Ox(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(Bx(64,e));if(zu(e)){if(t==="string")return t=lu(Number(e)),Ki(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),R1(e)||($u(e),e=ja(dt,Bt))),e;if(t==="number")return(e=lu(e))>=0&&Ki(e)?e:function(n){if(n<0){uo(n);var r=ja(dt,Bt);return n=Number(r),Ki(n)?n:r}return R1(r=String(n))?r:(uo(n),_h(dt,Bt))}(e)}}function cy(e){if(typeof e!="string")throw Error();return e}function Ao(e){if(e!=null&&typeof e!="string")throw Error();return e}function co(e){return e==null||typeof e=="string"?e:void 0}function Ph(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===Fa)return e;if(!Array.isArray(e))return n?2&r?((e=t[j1])||(So((e=new t).u),e=t[j1]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[be];return s===0&&(s|=32&r),s|=2&r,s!==n&&Ht(e,s),new t(e)}function $x(e,t,n){if(t)e:{if(!zu(t=e))throw of("int64");switch(typeof t){case"string":t=Th(t);break e;case"bigint":if(e=t=bh(64,t),M1(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(bx(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=Ou?BigInt(t):Mx(t)?t?"1":"0":M1(t)?t.trim()||"0":String(t);break e;default:t=Mh(t)}}else t=uu(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&Ki(t=+n)?t:n}const Dx={};let zx=function(){try{return vh(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class Jc{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const Ux=zx?(Object.setPrototypeOf(Jc.prototype,Map.prototype),Object.defineProperties(Jc.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),Jc):class extends Map{constructor(){super()}};function L1(e){return e}function qc(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var yr=class extends Ux{constructor(e,t,n=L1,r=L1){super();let s=0|e[be];s|=64,Ht(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?Hx:r;for(let i=0;i<e.length;i++){const a=e[i],l=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(l,d)}}na(e=B1){if(this.size!==0)return this.X(e)}X(e=B1){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){qc(this),super.clear()}delete(e){return qc(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new au(e,Gx,this)}keys(){return this.Ha()}values(){var e=this.ma();return new au(e,yr.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return qc(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Hx(e,t,n,r,s,i){return e=Ph(e,r,n,i),s&&(e=Hu(e)),e}function B1(e){return e}function Gx(e){return[e,this.get(e)]}let Wx,dy,Vx;function F1(){return Wx||(Wx=new yr(So([]),void 0,void 0,void 0,Dx))}function Ih(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=ou(e)?void 0:s&&2&(0|e[be])?e:Rh(e,t,n,r!==void 0,s);else if(kh(e)){const i={};for(let a in e)i[a]=Ih(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function Rh(e,t,n,r,s){const i=r||n?0|e[be]:0,a=r?!!(32&i):void 0;r=Rn(e);for(let l=0;l<r.length;l++)r[l]=Ih(r[l],t,n,a,s);return n&&((e=Eh(e))&&(r[lo]=Rn(e)),n(i,r)),r}function Yx(e){return Ih(e,fy,void 0,void 0,!1)}function fy(e){return e.W===Fa?e.toJSON():e instanceof yr?e.na(Yx):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return lf(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(ou(t))return}else{if(La(t))return C1(t);if(t instanceof os){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=C1(n)}if(t instanceof yr)return t.na()}}return t}(e)}function hy(e){return Rh(e,fy,void 0,void 0,!1)}function Ds(e,t,n){return e=py(e,t[0],t[1],n?1:2),t!==dy&&n&&Bu(e,16384),e}function py(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[be]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(kh(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return Ht(e,s),e}function uf(e,t,n=af){if(e!=null){if(Z2&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[be];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?(Ht(e,-12293&(34|r)),e):Rh(e,uf,4&r?af:n,!0,!0))}return e.W===Fa?e=2&(r=0|(n=e.u)[be])?e:new e.constructor(Uu(n,r,!0)):e instanceof yr&&!(2&e.L)&&(n=So(e.X(uf)),e=new yr(n,e.S,e.R,e.Y)),e}}function Uu(e,t,n){const r=n||2&t?af:jx,s=!!(32&t);return e=function(i,a,l){const d=Rn(i);var h=d.length;const m=256&a?d[h-1]:void 0;for(h+=m?-1:0,a=512&a?1:0;a<h;a++)d[a]=l(d[a]);if(m){a=d[a]={};for(const w in m)a[w]=l(m[w])}return(i=Eh(i))&&(d[lo]=Rn(i)),d}(e,t,i=>uf(i,s,r)),Bu(e,32|(n?2:0)),e}function Hu(e){const t=e.u,n=0|t[be];return 2&n?new e.constructor(Uu(t,n,!1)):e}function fo(e,t){return gs(e=e.u,0|e[be],t)}function gs(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&Qc!=null&&((s=(e=Ex??(Ex={}))[Qc]||0)>=4||(e[Qc]=s+1,ry(e=Error(),"incident"),function(a){pi.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function ht(e,t,n){const r=e.u;let s=0|r[be];return Ks(s),Mt(r,s,t,n),e}function Mt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},Ht(e,t|=256)):e[i]=r),t)}function Nl(e,t){let n=0|(e=e.u)[be];const r=gs(e,n,t),s=Qs(r);return s!=null&&s!==r&&Mt(e,n,t,s),s}function my(e){let t=0|(e=e.u)[be];const n=gs(e,t,1),r=Ah(n,!0);return r!=null&&r!==n&&Mt(e,t,1,r),r}function si(){return Nx===void 0?2:4}function ii(e,t,n,r,s){const i=e.u,a=2&(e=0|i[be])?1:r;s=!!s;let l=0|(r=Lh(i,e,t))[be];if(!(4&l)){4&l&&(r=Rn(r),l=as(l,e),e=Mt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const m=n(r[d]);m!=null&&(r[h++]=m)}h<d&&(r.length=h),l=Bh(l,e),n=-4097&(20|l),l=n&=-8193,Ht(r,l),2&l&&Object.freeze(r)}return a===1||a===4&&32&l?ss(l)||(s=l,l|=2,l!==s&&Ht(r,l),Object.freeze(r)):(a===2&&ss(l)&&(r=Rn(r),l=as(l,e),l=zs(l,e,s),Ht(r,l),e=Mt(i,e,t,r)),ss(l)||(t=l,l=zs(l,e,s),l!==t&&Ht(r,l))),r}function Lh(e,t,n,r){return e=gs(e,t,n,r),Array.isArray(e)?e:Sh}function Bh(e,t){return e===0&&(e=as(e,t)),1|e}function ss(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function gy(e){e=Rn(e);for(let t=0;t<e.length;t++){const n=e[t]=Rn(e[t]);Array.isArray(n[1])&&(n[1]=So(n[1]))}return e}function cf(e,t,n,r){let s=0|(e=e.u)[be];Ks(s),Mt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function Eo(e,t,n,r,s){Ks(t);var i=!(!(64&t)&&16384&t);const a=(s=Lh(e,t,n,s))!==Sh;if(i||!a){let l=i=a?0|s[be]:0;(!a||2&l||ss(l)||4&l&&!(32&l))&&(s=Rn(s),l=as(l,t),t=Mt(e,t,n,s)),l=-13&Bh(l,t),l=zs(r?-17&l:16|l,t,!0),l!==i&&Ht(s,l)}return s}function Zc(e,t){var n=iv;return Oh(Fh(e=e.u),e,0|e[be],n)===t?t:-1}function Fh(e){if(Lu)return e[Uo]??(e[Uo]=new Map);if(Uo in e)return e[Uo];const t=new Map;return Object.defineProperty(e,Uo,{value:t}),t}function yy(e,t,n,r){const s=Fh(e),i=Oh(s,e,t,n);return i!==r&&(i&&(t=Mt(e,t,i)),s.set(n,r)),t}function Oh(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];gs(t,n,a)!=null&&(s!==0&&(n=Mt(t,n,s)),s=a)}return e.set(r,s),s}function $h(e,t,n,r){let s,i=0|e[be];if((r=gs(e,i,n,r))!=null&&r.W===Fa)return(t=Hu(r))!==r&&Mt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[be];s=2&a?Ds(Uu(r,a,!1),t,!0):64&a?r:Ds(s,t,!0)}else s=Ds(void 0,t,!0);return s!==r&&Mt(e,i,n,s),s}function vy(e,t,n,r){let s=0|(e=e.u)[be];return(t=Ph(r=gs(e,s,n,r),t,!1,s))!==r&&t!=null&&Mt(e,s,n,t),t}function et(e,t,n,r=!1){if((t=vy(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[be]))){const s=Hu(t);s!==t&&Mt(e,r,n,t=s)}return t}function wy(e,t,n,r,s,i,a){e=e.u;var l=!!(2&t);const d=l?1:s;i=!!i,a&&(a=!l);var h=0|(s=Lh(e,t,r))[be];if(!(l=!!(4&h))){var m=s,w=t;const S=!!(2&(h=Bh(h,t)));S&&(w|=2);let _=!S,L=!0,F=0,X=0;for(;F<m.length;F++){const C=Ph(m[F],n,!1,w);if(C instanceof n){if(!S){const g=!!(2&(0|C.u[be]));_&&(_=!g),L&&(L=g)}m[X++]=C}}X<F&&(m.length=X),h|=4,h=L?16|h:-17&h,Ht(m,h=_?8|h:-9&h),S&&Object.freeze(m)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(ss(h)&&(s=Rn(s),h=as(h,t),t=Mt(e,t,r,s)),n=s,a=h,m=0;m<n.length;m++)(h=n[m])!==(w=Hu(h))&&(n[m]=w);a|=8,Ht(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?ss(h)||(t=h,(h|=!s.length||16&h&&(!l||32&h)?2:2048)!==t&&Ht(s,h),Object.freeze(s)):(d===2&&ss(h)&&(Ht(s=Rn(s),h=zs(h=as(h,t),t,i)),t=Mt(e,t,r,s)),ss(h)||(r=h,(h=zs(h,t,i))!==r&&Ht(s,h))),s}function hs(e,t,n){const r=0|e.u[be];return wy(e,r,t,n,si(),!1,!(2&r))}function Te(e,t,n,r){return r==null&&(r=void 0),ht(e,n,r)}function oa(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[be];if(Ks(s),r==null){const i=Fh(e);if(Oh(i,e,s,n)!==t)break e;i.set(n,0)}else s=yy(e,s,n,t);Mt(e,s,t,r)}}function as(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function zs(e,t,n){return 32&t&&n||(e&=-33),e}function cu(e,t,n,r){const s=0|e.u[be];Ks(s),e=wy(e,s,n,t,2,!0),r=r??new n,e.push(r),e[be]=2&(0|r.u[be])?-9&e[be]:-17&e[be]}function hr(e,t){return ko(fo(e,t))}function vr(e,t){return co(fo(e,t))}function Ot(e,t){return Nl(e,t)??0}function Na(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);ht(e,t,n)}function Xr(e,t,n){if(n!=null){if(typeof n!="number"||!Du(n))throw of("int32");n|=0}ht(e,t,n)}function _e(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);ht(e,t,n)}function du(e,t,n){{const a=e.u;let l=0|a[be];if(Ks(l),n==null)Mt(a,l,t);else{var r=e=0|n[be],s=ss(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=Rn(n),r=0,e=zs(e=as(e,l),l,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=cy(d);Object.is(d,h)||(i&&(n=Rn(n),r=0,e=zs(e=as(e,l),l,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=Rn(n),e=zs(e=as(e,l),l,!0)),Ht(n,e)),Mt(a,l,t,n)}}}function Gu(e,t,n){Ks(0|e.u[be]),ii(e,t,co,2,!0).push(cy(n))}function xy(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Dh(){return Error("Failed to read varint, encoding is invalid.")}function Sy(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function zh(e){if(typeof e=="string")return{buffer:ty(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===os)return{buffer:wh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Uh(e,t){let n,r=0,s=0,i=0;const a=e.h;let l=e.g;do n=a[l++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[l++],s|=(127&n)<<i;if(li(e,l),n<128)return t(r>>>0,s>>>0);throw Dh()}function Hh(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return li(e,n),!!(127&t)}throw Dh()}function Gs(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Dh();return li(e,n),s}function ps(e){return Gs(e)>>>0}function df(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],li(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function ff(e){var t=df(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function Xx(e){return Gs(e)}function ed(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=zh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function li(e,t){if(e.g=t,t>e.l)throw Sy(e.l,t)}function ky(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw Sy(t,e.l-n);return e.g=r,n}function Ay(e,t){if(t==0)return mi();var n=ky(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Lx?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?mi():new os(n,ao)}yr.prototype.toJSON=void 0,yr.prototype.Ia=oy;var O1=[];function Ey(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=ps(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw xy(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function bl(e){switch(e.h){case 0:e.h!=0?bl(e):Hh(e.g);break;case 1:li(e=e.g,e.g+8);break;case 2:if(e.h!=2)bl(e);else{var t=ps(e.g);li(e=e.g,e.g+t)}break;case 5:li(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!Ey(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}bl(e)}break;default:throw xy(e.h,e.l)}}function Oa(e,t,n){const r=e.g.l,s=ps(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function Gh(e){var t=ps(e.g),n=ky(e=e.g,t);if(e=e.h,gx){var r,s=e;(r=Vc)||(r=Vc=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(l){if(dl===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),dl=!0}catch{dl=!1}}throw!dl&&(Vc=void 0),l}}else{t=(i=n)+t,n=[];let l,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?qs():(l=e[i++],a<194||(192&l)!=128?(i--,qs()):n.push((31&a)<<6|63&l)):a<240?i>=t-1?qs():(l=e[i++],(192&l)!=128||a===224&&l<160||a===237&&l>=160||(192&(r=e[i++]))!=128?(i--,qs()):n.push((15&a)<<12|(63&l)<<6|63&r)):a<=244?i>=t-2?qs():(l=e[i++],(192&l)!=128||l-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,qs()):(a=(7&a)<<18|(63&l)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):qs(),n.length>=8192&&(d=S1(d,n),n.length=0)}i=S1(d,n)}return i}function Cy(e){const t=ps(e.g);return Ay(e.g,t)}function Wu(e,t,n){var r=ps(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var fl=[];function Kx(e){return e}let Qi;function Tr(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var Ee=class{constructor(e,t){this.u=py(e,t)}toJSON(){const e=!Qi;try{return e&&(Qi=hy),_y(this)}finally{e&&(Qi=void 0)}}l(){var e=T5;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(Uu(e,0|e[be],!1))}N(){return!!(2&(0|this.u[be]))}};function _y(e){var t=e.u;{t=(e=Qi(t))!==t;let h=e.length;if(h){var n=e[h-1],r=kh(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,l=!1;if(a)for(let m in a)isNaN(+m)?(i??(i={}))[m]=a[m]:(r=a[m],Array.isArray(r)&&(ou(r)||N1(r)&&r.size===0)&&(r=null),r==null&&(l=!0),r!=null&&((i??(i={}))[m]=r));if(l||(i=a),i)for(let m in i){l=i;break e}l=null}a=l==null?n!=null:l!==n}for(;h>0&&((i=s[h-1])==null||ou(i)||N1(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||l)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),l&&s.push(l)),d=s}else d=e}return d}function $1(e){return e?/^\d+$/.test(e)?($u(e),new hf(dt,Bt)):null:Qx||(Qx=new hf(0,0))}Ee.prototype.W=Fa,Ee.prototype.toString=function(){try{return Qi=Kx,_y(this).toString()}finally{Qi=void 0}};var hf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Qx;function D1(e){return e?/^-?\d+$/.test(e)?($u(e),new pf(dt,Bt)):null:Jx||(Jx=new pf(0,0))}var pf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Jx;function Ji(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function Co(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function Vu(e,t){if(t>=0)Co(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function ba(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function ho(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function er(e,t,n){Co(e.g,8*t+n)}function Wh(e,t){return er(e,t,2),t=e.g.end(),ho(e,t),t.push(e.h),t}function Vh(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function Yu(e,t,n){er(e,t,2),Co(e.g,n.length),ho(e,e.g.end()),ho(e,n)}function fu(e,t,n,r){n!=null&&(t=Wh(e,t),r(n,e),Vh(e,t))}function Pr(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var Yh=Pr(),jy=Pr(),Xh=Pr(),Kh=Pr(),Ny=Pr(),by=Pr(),Qh=Pr(),My=Pr(),Ty=Pr(),_o=class{constructor(e,t,n){this.g=e,this.h=t,e=Yh,this.l=!!e&&n===e||!1}};function Xu(e,t){return new _o(e,t,Yh)}function Py(e,t,n,r,s){fu(e,n,By(t,r),s)}const qx=Xu(function(e,t,n,r,s){return e.h===2&&(Oa(e,$h(t,r,n),s),!0)},Py),Zx=Xu(function(e,t,n,r,s){return e.h===2&&(Oa(e,$h(t,r,n,!0),s),!0)},Py);var Ku=Symbol(),Jh=Symbol(),z1=Symbol(),U1=Symbol();let Iy,Ry;function vi(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(w){switch(typeof w){case"boolean":return dy||(dy=[0,void 0,!0]);case"number":return w>0?void 0:w===0?Vx||(Vx=[0,void 0]):[-w,void 0];case"string":return[0,w];case"object":return w}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Iy??(Iy=i),Ry??(Ry=r[a+1]),i=r[a+=2]));const l={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)l[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let w;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof _o?w=i:(w=qx,a--),w==null?void 0:w.l){i=r[++a],h=r;var m=a;typeof i=="function"&&(i=i(),h[m]=i),h=i}for(m=d+1,typeof(i=r[++a])=="number"&&i<0&&(m-=i,i=r[++a]);d<m;d++){const S=l[d];h?n(s,d,w,h,S):t(s,d,w,S)}}return r[e]=s}function Ly(e){return Array.isArray(e)?e[0]instanceof _o?e:[Zx,e]:[e,void 0]}function By(e,t){return e instanceof Ee?e.u:Array.isArray(e)?Ds(e,t,!1):void 0}function qh(e,t,n,r){const s=n.g;e[t]=r?(i,a,l)=>s(i,a,l,r):s}function Zh(e,t,n,r,s){const i=n.g;let a,l;e[t]=(d,h,m)=>i(d,h,m,l||(l=vi(Jh,qh,Zh,r).V),a||(a=ep(r)),s)}function ep(e){let t=e[z1];if(t!=null)return t;const n=vi(Jh,qh,Zh,e);return t=n.la?(r,s)=>Iy(r,s,n):(r,s)=>{const i=0|r[be];for(;Ey(s)&&s.h!=4;){var a=s.m,l=n[a];if(l==null){var d=n.ga;d&&(d=d[a])&&(d=e5(d))!=null&&(l=n[a]=d)}l!=null&&l(s,r,a)||(a=(l=s).l,bl(l),l.fa?l=void 0:(d=l.g.g-a,l.g.g=a,l=Ay(l.g,d)),a=r,l&&((d=a[lo])?d.push(l):a[lo]=[l]))}return 16384&i&&So(r),!0},e[z1]=t}function e5(e){const t=(e=Ly(e))[0].g;if(e=e[1]){const n=ep(e),r=vi(Jh,qh,Zh,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function Qu(e,t,n){e[t]=n.h}function Ju(e,t,n,r){let s,i;const a=n.h;e[t]=(l,d,h)=>a(l,d,h,i||(i=vi(Ku,Qu,Ju,r).V),s||(s=Fy(r)))}function Fy(e){let t=e[U1];if(!t){const n=vi(Ku,Qu,Ju,e);t=(r,s)=>Oy(r,s,n),e[U1]=t}return t}function Oy(e,t,n){for(var r=0|e[be],s=512&r?0:-1,i=e.length,a=512&r?1:0,l=i+(256&r?-1:0);a<l;a++){const d=e[a];if(d==null)continue;const h=a-s,m=H1(n,h);m&&m(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(l=H1(n,s))&&l(t,i,s)}if(e=Eh(e))for(ho(t,t.g.end()),n=0;n<e.length;n++)ho(t,wh(e[n])||new Uint8Array(0))}function H1(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=Ly(n))[0].h;if(n=n[1]){const s=Fy(n),i=vi(Ku,Qu,Ju,n).V;n=e.la?Ry(i,s):(a,l,d)=>r(a,l,d,i,s)}else n=r;return e[t]=n}}function jo(e,t){if(Array.isArray(t)){var n=0|t[be];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),Ht(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function An(e,t,n){return new _o(e,t,n)}function No(e,t,n){return new _o(e,t,n)}function En(e,t,n){Mt(e,0|e[be],t,n)}var t5=Xu(function(e,t,n,r,s){return e.h===2&&(e=Oa(e,Ds([void 0,void 0],r,!0),s),Ks(r=0|t[be]),(s=gs(t,r,n))instanceof yr?2&s.L?((s=s.X()).push(e),Mt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[be])&&Mt(t,r,n,s=gy(s)),s.push(e)):Mt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof yr)t.forEach((i,a)=>{fu(e,n,Ds([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&fu(e,n,Ds(a,r,!1),s)}});function $y(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String(bh(64,r));if(zu(r)){if(s==="string")return Th(r);if(s==="number")return Mh(r)}}(t),t!=null&&(typeof t=="string"&&D1(t),t!=null))switch(er(e,n,0),typeof t){case"number":e=e.g,uo(t),Ji(e,dt,Bt);break;case"bigint":n=BigInt.asUintN(64,t),n=new pf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ji(e.g,n.h,n.g);break;default:n=D1(t),Ji(e.g,n.h,n.g)}}function Dy(e,t,n){(t=ko(t))!=null&&t!=null&&(er(e,n,0),Vu(e.g,t))}function zy(e,t,n){(t=ly(t))!=null&&(er(e,n,0),e.g.g.push(t?1:0))}function Uy(e,t,n){(t=co(t))!=null&&Yu(e,n,Q2(t))}function Hy(e,t,n,r,s){fu(e,n,By(t,r),s)}function Gy(e,t,n){(t=t==null||typeof t=="string"||La(t)||t instanceof os?t:void 0)!=null&&Yu(e,n,zh(t).buffer)}function Wy(e,t,n){return(e.h===5||e.h===2)&&(t=Eo(t,0|t[be],n,!1,!1),e.h==2?Wu(e,ff,t):t.push(ff(e.g)),!0)}var es=An(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=df(r);const s=df(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,En(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Qs(t))!=null&&(er(e,n,1),e=e.g,(n=ay||(ay=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),dt=n.getUint32(0,!0),Bt=n.getUint32(4,!0),ba(e,dt),ba(e,Bt))},Pr()),Gt=An(function(e,t,n){return e.h===5&&(En(t,n,ff(e.g)),!0)},function(e,t,n){(t=Qs(t))!=null&&(er(e,n,5),e=e.g,Ch(t),ba(e,dt))},Qh),n5=No(Wy,function(e,t,n){if((t=jo(Qs,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(er(r,s,5),r=r.g,Ch(i),ba(r,dt))}},Qh),tp=No(Wy,function(e,t,n){if((t=jo(Qs,t))!=null&&t.length){er(e,n,2),Co(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,Ch(t[r]),ba(n,dt)}},Qh),Ws=An(function(e,t,n){return e.h===0&&(En(t,n,Uh(e.g,jh)),!0)},$y,by),td=An(function(e,t,n){return e.h===0&&(En(t,n,(e=Uh(e.g,jh))===0?void 0:e),!0)},$y,by),r5=An(function(e,t,n){return e.h===0&&(En(t,n,Uh(e.g,_h)),!0)},function(e,t,n){if((t=Ox(t))!=null&&(typeof t=="string"&&$1(t),t!=null))switch(er(e,n,0),typeof t){case"number":e=e.g,uo(t),Ji(e,dt,Bt);break;case"bigint":n=BigInt.asUintN(64,t),n=new hf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ji(e.g,n.h,n.g);break;default:n=$1(t),Ji(e.g,n.h,n.g)}},Pr()),Ft=An(function(e,t,n){return e.h===0&&(En(t,n,Gs(e.g)),!0)},Dy,Kh),qu=No(function(e,t,n){return(e.h===0||e.h===2)&&(t=Eo(t,0|t[be],n,!1,!1),e.h==2?Wu(e,Gs,t):t.push(Gs(e.g)),!0)},function(e,t,n){if((t=jo(ko,t))!=null&&t.length){n=Wh(e,n);for(let r=0;r<t.length;r++)Vu(e.g,t[r]);Vh(e,n)}},Kh),zi=An(function(e,t,n){return e.h===0&&(En(t,n,(e=Gs(e.g))===0?void 0:e),!0)},Dy,Kh),Ct=An(function(e,t,n){return e.h===0&&(En(t,n,Hh(e.g)),!0)},zy,jy),qi=An(function(e,t,n){return e.h===0&&(En(t,n,(e=Hh(e.g))===!1?void 0:e),!0)},zy,jy),fn=No(function(e,t,n){return e.h===2&&(e=Gh(e),Eo(t,0|t[be],n,!1).push(e),!0)},function(e,t,n){if((t=jo(co,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&Yu(r,s,Q2(i))}},Xh),bs=An(function(e,t,n){return e.h===2&&(En(t,n,(e=Gh(e))===""?void 0:e),!0)},Uy,Xh),st=An(function(e,t,n){return e.h===2&&(En(t,n,Gh(e)),!0)},Uy,Xh),Yt=function(e,t,n=Yh){return new _o(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=Ds(void 0,r,!0),Eo(t,0|t[be],n,!0).push(r),Oa(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)Hy(e,t[i],n,r,s)}),ot=Xu(function(e,t,n,r,s,i){return e.h===2&&(yy(t,0|t[be],i,n),Oa(e,t=$h(t,r,n),s),!0)},Hy),Vy=An(function(e,t,n){return e.h===2&&(En(t,n,Cy(e)),!0)},Gy,My),s5=No(function(e,t,n){return(e.h===0||e.h===2)&&(t=Eo(t,0|t[be],n,!1,!1),e.h==2?Wu(e,ps,t):t.push(ps(e.g)),!0)},function(e,t,n){if((t=jo(uy,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(er(r,s,0),Co(r.g,i))}},Ny),i5=An(function(e,t,n){return e.h===0&&(En(t,n,(e=ps(e.g))===0?void 0:e),!0)},function(e,t,n){(t=uy(t))!=null&&t!=null&&(er(e,n,0),Co(e.g,t))},Ny),wr=An(function(e,t,n){return e.h===0&&(En(t,n,Gs(e.g)),!0)},function(e,t,n){(t=ko(t))!=null&&(t=parseInt(t,10),er(e,n,0),Vu(e.g,t))},Ty);class o5{constructor(t,n){this.h=t,this.g=n,this.l=et,this.m=Te,this.defaultValue=void 0}}function Ir(e,t){return new o5(e,t)}function Js(e,t){return(n,r)=>{if(fl.length){const i=fl.pop();i.o(r),ed(i.g,n,r),n=i}else n=new class{constructor(i,a){if(O1.length){const l=O1.pop();ed(l,i,a),i=l}else i=new class{constructor(l,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,ed(this,l,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;ep(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,fl.length<100&&fl.push(n)}return s}}function Zu(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};Oy(this.u,t,vi(Ku,Qu,Ju,e)),ho(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const l=r[a];n.set(l,i),i+=l.length}return t.l=[n],n}}var G1=class extends Ee{constructor(e){super(e)}},W1=[0,bs,An(function(e,t,n){return e.h===2&&(En(t,n,(e=Cy(e))===mi()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof Ee){const r=t.Ra;return void(r&&(t=r(t),t!=null&&Yu(e,n,zh(t).buffer)))}if(Array.isArray(t))return}Gy(e,t,n)},My)];let nd,V1=globalThis.trustedTypes;function Y1(e){nd===void 0&&(nd=function(){let n=null;if(!V1)return n;try{const r=s=>s;n=V1.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=nd;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function a5(e,...t){if(t.length===0)return Y1(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return Y1(n)}var Yy=[0,Ft,wr,Ct,-1,qu,wr,-1],l5=class extends Ee{constructor(e){super(e)}},Xy=[0,Ct,st,Ct,wr,-1,No(function(e,t,n){return(e.h===0||e.h===2)&&(t=Eo(t,0|t[be],n,!1,!1),e.h==2?Wu(e,Xx,t):t.push(Gs(e.g)),!0)},function(e,t,n){if((t=jo(ko,t))!=null&&t.length){n=Wh(e,n);for(let r=0;r<t.length;r++)Vu(e.g,t[r]);Vh(e,n)}},Ty),st,-1,[0,Ct,-1],wr,Ct,-1],Ky=[0,st,-2],X1=class extends Ee{constructor(e){super(e)}},Qy=[0],Jy=[0,Ft,Ct,1,Ct,-3],Jn=class extends Ee{constructor(e){super(e,2)}},Wt={};Wt[336783863]=[0,st,Ct,-1,Ft,[0,[1,2,3,4,5,6,7,8],ot,Qy,ot,Xy,ot,Ky,ot,Jy,ot,Yy,ot,[0,st,-2],ot,[0,st,wr],ot,[0,wr,st]],[0,st],Ct,[0,[1,3],[2,4],ot,[0,qu],-1,ot,[0,fn],-1,Yt,[0,st,-1]],st];var K1=[0,td,-1,qi,-3,td,qu,bs,zi,td,-1,qi,zi,qi,-2,bs];function tr(e,t){cf(e,2,Ao(t),"")}function mt(e,t){Gu(e,3,t)}function Ke(e,t){Gu(e,4,t)}var xn=class extends Ee{constructor(e){super(e,500)}o(e){return Te(this,0,7,e)}},aa=[-1,{}],Q1=[0,st,1,aa],J1=[0,st,fn,aa];function nr(e,t){cu(e,1,xn,t)}function St(e,t){Gu(e,10,t)}function rt(e,t){Gu(e,15,t)}var Bn=class extends Ee{constructor(e){super(e,500)}o(e){return Te(this,0,1001,e)}},qy=[-500,Yt,[-500,bs,-1,fn,-3,[-2,Wt,Ct],Yt,W1,zi,-1,Q1,J1,Yt,[0,bs,qi],bs,K1,zi,fn,987,fn],4,Yt,[-500,st,-1,[-1,{}],998,st],Yt,[-500,st,fn,-1,[-2,{},Ct],997,fn,-1],zi,Yt,[-500,st,fn,aa,998,fn],fn,zi,Q1,J1,Yt,[0,bs,-1,aa],fn,-2,K1,bs,-1,qi,[0,qi,i5],978,aa,Yt,W1];Bn.prototype.g=Zu(qy);var u5=Js(Bn,qy),c5=class extends Ee{constructor(e){super(e)}},Zy=class extends Ee{constructor(e){super(e)}g(){return hs(this,c5,1)}},ev=[0,Yt,[0,Ft,Gt,st,-1]],ec=Js(Zy,ev),d5=class extends Ee{constructor(e){super(e)}},f5=class extends Ee{constructor(e){super(e)}},rd=class extends Ee{constructor(e){super(e)}h(){return et(this,d5,2)}g(){return hs(this,f5,5)}},tv=Js(class extends Ee{constructor(e){super(e)}},[0,fn,qu,tp,[0,wr,[0,Ft,-3],[0,Gt,-3],[0,Ft,-1,[0,Yt,[0,Ft,-2]]],Yt,[0,Gt,-1,st,Gt]],st,-1,Ws,Yt,[0,Ft,Gt],fn,Ws]),nv=class extends Ee{constructor(e){super(e)}},Zi=Js(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,Gt,-4]]),rv=class extends Ee{constructor(e){super(e)}},$a=Js(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,Gt,-4]]),h5=class extends Ee{constructor(e){super(e)}},p5=[0,Ft,-1,tp,wr],sv=class extends Ee{constructor(e){super(e)}};sv.prototype.g=Zu([0,Gt,-4,Ws]);var m5=class extends Ee{constructor(e){super(e)}},g5=Js(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,1,Ft,st,ev],Ws]),q1=class extends Ee{constructor(e){super(e)}},y5=class extends Ee{constructor(e){super(e)}oa(){const e=my(this);return e??mi()}},v5=class extends Ee{constructor(e){super(e)}},iv=[1,2],w5=Js(class extends Ee{constructor(e){super(e)}},[0,Yt,[0,iv,ot,[0,tp],ot,[0,Vy],Ft,st],Ws]),np=class extends Ee{constructor(e){super(e)}},ov=[0,st,Ft,Gt,fn,-1],Z1=class extends Ee{constructor(e){super(e)}},x5=[0,Ct,-1],e0=class extends Ee{constructor(e){super(e)}},Ml=[1,2,3,4,5],hu=class extends Ee{constructor(e){super(e)}g(){return my(this)!=null}h(){return vr(this,2)!=null}},_t=class extends Ee{constructor(e){super(e)}g(){return ly(fo(this,2))??!1}},av=[0,Vy,st,[0,Ft,Ws,-1],[0,r5,Ws]],Dt=[0,av,Ct,[0,Ml,ot,Jy,ot,Xy,ot,Yy,ot,Qy,ot,Ky],wr],tc=class extends Ee{constructor(e){super(e)}},rp=[0,Dt,Gt,-1,Ft],S5=Ir(502141897,tc);Wt[502141897]=rp;var k5=Js(class extends Ee{constructor(e){super(e)}},[0,[0,wr,-1,n5,s5],p5]),lv=class extends Ee{constructor(e){super(e)}},uv=class extends Ee{constructor(e){super(e)}},sp=[0,Dt,Gt,[0,Dt],Ct],cv=[0,Dt,rp,sp,Gt,[0,[0,av]]],A5=Ir(508968150,uv);Wt[508968150]=cv,Wt[508968149]=sp;var dv=class extends Ee{constructor(e){super(e)}},E5=Ir(513916220,dv);Wt[513916220]=[0,Dt,cv,Ft];var Ci=class extends Ee{constructor(e){super(e)}h(){return et(this,np,2)}g(){ht(this,2)}},fv=[0,Dt,ov];Wt[478825465]=fv;var C5=class extends Ee{constructor(e){super(e)}},hv=class extends Ee{constructor(e){super(e)}},ip=class extends Ee{constructor(e){super(e)}},op=class extends Ee{constructor(e){super(e)}},pv=class extends Ee{constructor(e){super(e)}},t0=[0,Dt,[0,Dt],fv,-1],mv=[0,Dt,Gt,Ft],ap=[0,Dt,Gt],gv=[0,Dt,mv,ap,Gt],_5=Ir(479097054,pv);Wt[479097054]=[0,Dt,gv,t0],Wt[463370452]=t0,Wt[464864288]=mv;var j5=Ir(462713202,op);Wt[462713202]=gv,Wt[474472470]=ap;var N5=class extends Ee{constructor(e){super(e)}},yv=class extends Ee{constructor(e){super(e)}},vv=class extends Ee{constructor(e){super(e)}},wv=class extends Ee{constructor(e){super(e)}},lp=[0,Dt,Gt,-1,Ft],mf=[0,Dt,Gt,Ct];wv.prototype.g=Zu([0,Dt,ap,[0,Dt],rp,sp,lp,mf]);var xv=class extends Ee{constructor(e){super(e)}},b5=Ir(456383383,xv);Wt[456383383]=[0,Dt,ov];var Sv=class extends Ee{constructor(e){super(e)}},M5=Ir(476348187,Sv);Wt[476348187]=[0,Dt,x5];var kv=class extends Ee{constructor(e){super(e)}},n0=class extends Ee{constructor(e){super(e)}},Av=[0,wr,-1],T5=Ir(458105876,class extends Ee{constructor(e){super(e)}g(){var e=this.u;const t=0|e[be],n=2&t;return e=function(r,s,i){var a=n0;const l=2&s;let d=!1;if(i==null){if(l)return F1();i=[]}else if(i.constructor===yr){if(!(2&i.L)||l)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[be])):i=[];if(l){if(!i.length)return F1();d||(d=!0,So(i))}else d&&(d=!1,i=gy(i));return d||(64&(0|i[be])?i[be]&=-33:32&s&&Bu(i,32)),Mt(r,s,2,a=new yr(i,a,$x,void 0)),a}(e,t,gs(e,t,2)),!n&&n0&&(e.ra=!0),e}});Wt[458105876]=[0,Av,t5,[!0,Ws,[0,st,-1,fn]]];var up=class extends Ee{constructor(e){super(e)}},Ev=Ir(458105758,up);Wt[458105758]=[0,Dt,st,Av];var Cv=class extends Ee{constructor(e){super(e)}},P5=Ir(443442058,Cv);Wt[443442058]=[0,Dt,st,Ft,Gt,fn,-1,Ct,Gt],Wt[514774813]=lp;var _v=class extends Ee{constructor(e){super(e)}},I5=Ir(516587230,_v);function gf(e,t){return t=t?t.clone():new np,e.displayNamesLocale!==void 0?ht(t,1,Ao(e.displayNamesLocale)):e.displayNamesLocale===void 0&&ht(t,1),e.maxResults!==void 0?Xr(t,2,e.maxResults):"maxResults"in e&&ht(t,2),e.scoreThreshold!==void 0?_e(t,3,e.scoreThreshold):"scoreThreshold"in e&&ht(t,3),e.categoryAllowlist!==void 0?du(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&ht(t,4),e.categoryDenylist!==void 0?du(t,5,e.categoryDenylist):"categoryDenylist"in e&&ht(t,5),t}function cp(e,t=-1,n=""){return{categories:e.map(r=>({index:hr(r,1)??0??-1,score:Ot(r,2)??0,categoryName:vr(r,3)??""??"",displayName:vr(r,4)??""??""})),headIndex:t,headName:n}}function jv(e){var a,l;var t=ii(e,3,Qs,si()),n=ii(e,2,ko,si()),r=ii(e,1,co,si()),s=ii(e,9,co,si());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=et(e,rd,4))==null?void 0:a.h())&&(i.boundingBox={originX:hr(t,1)??0,originY:hr(t,2)??0,width:hr(t,3)??0,height:hr(t,4)??0,angle:0}),(l=et(e,rd,4))==null?void 0:l.g().length)for(const d of et(e,rd,4).g())i.keypoints.push({x:Nl(d,1)??0,y:Nl(d,2)??0,score:Nl(d,4)??0,label:vr(d,3)??""});return i}function nc(e){const t=[];for(const n of hs(e,rv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function la(e){const t=[];for(const n of hs(e,nv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function r0(e){return Array.from(e,t=>t>127?t-256:t)}function s0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let hl;Wt[516587230]=[0,Dt,lp,mf,Gt],Wt[518928384]=mf;const R5=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Nv(){if(hl===void 0)try{await WebAssembly.instantiate(R5),hl=!0}catch{hl=!1}return hl}async function Ho(e,t=a5``){const n=await Nv()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var Cs=class{};function bv(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function i0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function Mv(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function Ne(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function o0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=Mv(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function a0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function Dr(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function ks(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}Cs.forVisionTasks=function(e){return Ho("vision",e)},Cs.forTextTasks=function(e){return Ho("text",e)},Cs.forGenAiExperimentalTasks=function(e){return Ho("genai_experimental",e)},Cs.forGenAiTasks=function(e){return Ho("genai",e)},Cs.forAudioTasks=function(e){return Ho("audio",e)},Cs.isSimdSupported=function(){return Nv()};async function L5(e,t,n,r){return e=await(async(s,i,a,l,d)=>{if(i&&await i0(i),!self.ModuleFactory||a&&(await i0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,l)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function sd(e,t){const n=et(e.baseOptions,hu,1)||new hu;typeof t=="string"?(ht(n,2,Ao(t)),ht(n,1)):t instanceof Uint8Array&&(ht(n,1,Ah(t,!1)),ht(n,2)),Te(e.baseOptions,0,1,n)}function l0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function ke(e,t){e.B=Math.max(e.B,t)}function rc(e,t){e.A=new xn,tr(e.A,"PassThroughCalculator"),mt(e.A,"free_memory"),Ke(e.A,"free_memory_unused_out"),St(t,"free_memory"),nr(t,e.A)}function po(e,t){mt(e.A,t),Ke(e.A,t+"_unused_out")}function sc(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var Tl=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,l;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=et(this.baseOptions,hu,1))!=null&&s.g()||(i=et(this.baseOptions,hu,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(l=e.baseOptions)!=null&&l.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,m){let w=et(h.baseOptions,e0,3);if(!w){var S=w=new e0,_=new X1;oa(S,4,Ml,_)}"delegate"in m&&(m.delegate==="GPU"?(m=w,S=new l5,oa(m,2,Ml,S)):(m=w,S=new X1,oa(m,4,Ml,S))),Te(h.baseOptions,0,3,w)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),sd(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)sd(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const m=[];for(var w=0;;){const{done:S,value:_}=await h.read();if(S)break;m.push(_),w+=_.length}if(m.length===0)return new Uint8Array(0);if(m.length===1)return m[0];h=new Uint8Array(w),w=0;for(const S of m)h.set(S,w),w+=S.length;return h}(d.modelAssetBuffer).then(h=>{sd(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=u5(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,l0(this)}finishProcessing(){this.g.finishProcessing(),l0(this)}close(){this.A=void 0,this.g.closeGraph()}};function ls(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Tl.prototype.close=Tl.prototype.close,function(e,t){e=e.split(".");var n,r=pi;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",Tl);class B5{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function u0(e,t,n){const r=e.g;if(n=ls(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function c0(e,t){const n=e.g,r=ls(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=ls(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=ls(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new B5(n,r,s,i)}function dp(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function fp(e,t,n,r){return dp(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=c0(e,!0)),n=e.s):(e.v||(e.v=c0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function ic(e,t,n){return dp(e,t),e=ls(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function oc(e,t,n){dp(e,t),e.A||(e.A=ls(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function hp(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var pp=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=ls(e.createProgram(),"Failed to create WebGL program"),this.aa=u0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=u0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function ts(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function yf(e){var t=ts(e,1);if(!t){if(t=ts(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=mo(e);var n=mp(e);if(oc(n,r,Tv(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function Tv(e){let t=ts(e,2);if(!t){const n=mo(e);t=Iv(e);const r=yf(e),s=Pv(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),vf(e)}return t}function mo(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ls(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Pv(e){if(e=mo(e),!pl)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))pl=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");pl=e.R16F}return pl}function mp(e){return e.l||(e.l=new pp),e.l}function Iv(e){const t=mo(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=ts(e,2);return n||(n=ic(mp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function vf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var pl,qt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--d0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!ts(this,0)}ja(){return!!ts(this,1)}P(){return!!ts(this,2)}ia(){return(t=ts(e=this,0))||(t=yf(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return yf(this)}M(){return Tv(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=mo(this),s=mp(this);r.activeTexture(r.TEXTURE1),n=ic(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=Pv(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),oc(s,r,n),fp(s,r,!1,()=>{Iv(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),vf(this)}),hp(s),vf(this)}}e.push(n)}return new qt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&mo(this).deleteTexture(ts(this,2)),d0=-1}};qt.prototype.close=qt.prototype.close,qt.prototype.clone=qt.prototype.clone,qt.prototype.getAsWebGLTexture=qt.prototype.M,qt.prototype.getAsFloat32Array=qt.prototype.ha,qt.prototype.getAsUint8Array=qt.prototype.ia,qt.prototype.hasWebGLTexture=qt.prototype.P,qt.prototype.hasFloat32Array=qt.prototype.ja,qt.prototype.hasUint8Array=qt.prototype.Fa;var d0=250;function Gr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function Rv(e){var t=Gr(e,0);if(!t){t=go(e);const n=ac(e),r=new Uint8Array(e.width*e.height*4);oc(n,t,Pl(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),hp(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function Pl(e){let t=Gr(e,2);if(!t){const n=go(e);t=Il(e);const r=Gr(e,1)||Rv(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),Ko(e)}return t}function go(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ls(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function ac(e){return e.l||(e.l=new pp),e.l}function Il(e){const t=go(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Gr(e,2);return n||(n=ic(ac(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Ko(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function f0(e){const t=go(e);return fp(ac(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var Zt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--h0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Gr(this,0)}ka(){return!!Gr(this,1)}P(){return!!Gr(this,2)}Ca(){return Rv(this)}Ba(){var e=Gr(this,1);return e||(Pl(this),Il(this),e=f0(this),Ko(this),this.g.push(e),this.j=!0),e}M(){return Pl(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=go(this),s=ac(this);r.activeTexture(r.TEXTURE1),n=ic(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),oc(s,r,n),fp(s,r,!1,()=>{Il(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Ko(this)}),hp(s),Ko(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Pl(this),Il(this),n=f0(this),Ko(this)}e.push(n)}return new Zt(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Gr(this,1).close(),this.m&&go(this).deleteTexture(Gr(this,2)),h0=-1}};Zt.prototype.close=Zt.prototype.close,Zt.prototype.clone=Zt.prototype.clone,Zt.prototype.getAsWebGLTexture=Zt.prototype.M,Zt.prototype.getAsImageBitmap=Zt.prototype.Ba,Zt.prototype.getAsImageData=Zt.prototype.Ca,Zt.prototype.hasWebGLTexture=Zt.prototype.P,Zt.prototype.hasImageBitmap=Zt.prototype.ka,Zt.prototype.hasImageData=Zt.prototype.Ea;var h0=250;function Rr(...e){return e.map(([t,n])=>({start:t,end:n}))}const F5=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((p0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:bv()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),Ne(this,r||"input_audio",i=>{Ne(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){Dr(this,"__graph_config__",t=>{e(t)}),Ne(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),Ne(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){Ne(this,t,r=>{const[s,i]=o0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){Ne(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){Ne(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){Ne(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){Ne(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){Ne(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){Ne(this,t,r=>{Ne(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){Ne(this,t,r=>{a0(this,Object.keys(e),s=>{a0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){Ne(this,n,s=>{Ne(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){Ne(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)Ne(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){Ne(this,t,n=>{Ne(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){Ne(this,n,r=>{Ne(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)Ne(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){Dr(this,e,t),Ne(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){ks(this,e,t),Ne(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){Dr(this,e,t),Ne(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){ks(this,e,t),Ne(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){Dr(this,e,t),Ne(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){ks(this,e,t),Ne(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){Dr(this,e,t),Ne(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){ks(this,e,t),Ne(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){Dr(this,e,t),Ne(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){ks(this,e,t),Ne(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){Dr(this,e,t),Ne(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){ks(this,e,t),Ne(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){Dr(this,e,t),Ne(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){ks(this,e,t),Ne(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Dr(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),Ne(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends p0{get ea(){return this.i}qa(e,t,n){Ne(this,t,r=>{const[s,i]=o0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){Dr(this,e,t),Ne(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){ks(this,e,t),Ne(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var p0,xr=class extends F5{};async function Xe(e,t,n){return async function(r,s,i,a){return L5(r,s,i,a)}(e,n.canvas??(bv()?void 0:document.createElement("canvas")),t,n)}function Lv(e,t,n,r){if(e.T){const i=new sv;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");_e(i,1,(s.left+s.right)/2),_e(i,2,(s.top+s.bottom)/2),_e(i,4,s.right-s.left),_e(i,3,s.bottom-s.top)}else _e(i,1,.5),_e(i,2,.5),_e(i,4,1),_e(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(_e(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,l]=Mv(t);n=Ot(i,3)*l/a,s=Ot(i,4)*a/l,_e(i,4,n),_e(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function Sr(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Lv(e,t,n,e.B+1)}function Kr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Lv(e,t,n,r)}function yo(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new qt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Ln=class extends Tl{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new pp}l(e,t=!0){if("runningMode"in e&&Na(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Ln.prototype.close=Ln.prototype.close;var or=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Te(e=this.h=new tc,0,1,t=new _t),_e(this.h,2,.5),_e(this.h,3,.3)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&_e(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&_e(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},Sr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Kr(this,e,n,t),this.j}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect_in"),rt(e,"detections");const t=new Jn;Tr(t,S5,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect_in"),Ke(n,"DETECTIONS:detections"),n.o(t),nr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=tv(i),this.j.detections.push(jv(r));ke(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};or.prototype.detectForVideo=or.prototype.F,or.prototype.detect=or.prototype.D,or.prototype.setOptions=or.prototype.o,or.createFromModelPath=async function(e,t){return Xe(or,e,{baseOptions:{modelAssetPath:t}})},or.createFromModelBuffer=function(e,t){return Xe(or,e,{baseOptions:{modelAssetBuffer:t}})},or.createFromOptions=function(e,t){return Xe(or,e,t)};var gp=Rr([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),yp=Rr([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),vp=Rr([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),Bv=Rr([474,475],[475,476],[476,477],[477,474]),wp=Rr([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),xp=Rr([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Fv=Rr([469,470],[470,471],[471,472],[472,469]),Sp=Rr([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),Ov=[...gp,...yp,...vp,...wp,...xp,...Sp],$v=Rr([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function m0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var Rt=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Te(e=this.h=new uv,0,1,t=new _t),this.v=new lv,Te(this.h,0,3,this.v),this.s=new tc,Te(this.h,0,2,this.s),Xr(this.s,4,1),_e(this.s,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numFaces"in e&&Xr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&_e(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return m0(this),Sr(this,e,t),this.j}F(e,t,n){return m0(this),Kr(this,e,n,t),this.j}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect"),rt(e,"face_landmarks");const t=new Jn;Tr(t,A5,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),nr(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=$a(i),this.j.faceLandmarks.push(nc(r));ke(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{ke(this,r)}),this.outputFaceBlendshapes&&(rt(e,"blendshapes"),Ke(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=ec(i),this.j.faceBlendshapes.push(cp(r.g()??[]));ke(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{ke(this,r)})),this.outputFacialTransformationMatrixes&&(rt(e,"face_geometry"),Ke(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=et(k5(i),h5,2))&&this.j.facialTransformationMatrixes.push({rows:hr(r,1)??0??0,columns:hr(r,2)??0??0,data:ii(r,3,Qs,si()).slice()??[]});ke(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{ke(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Rt.prototype.detectForVideo=Rt.prototype.F,Rt.prototype.detect=Rt.prototype.D,Rt.prototype.setOptions=Rt.prototype.o,Rt.createFromModelPath=function(e,t){return Xe(Rt,e,{baseOptions:{modelAssetPath:t}})},Rt.createFromModelBuffer=function(e,t){return Xe(Rt,e,{baseOptions:{modelAssetBuffer:t}})},Rt.createFromOptions=function(e,t){return Xe(Rt,e,t)},Rt.FACE_LANDMARKS_LIPS=gp,Rt.FACE_LANDMARKS_LEFT_EYE=yp,Rt.FACE_LANDMARKS_LEFT_EYEBROW=vp,Rt.FACE_LANDMARKS_LEFT_IRIS=Bv,Rt.FACE_LANDMARKS_RIGHT_EYE=wp,Rt.FACE_LANDMARKS_RIGHT_EYEBROW=xp,Rt.FACE_LANDMARKS_RIGHT_IRIS=Fv,Rt.FACE_LANDMARKS_FACE_OVAL=Sp,Rt.FACE_LANDMARKS_CONTOURS=Ov,Rt.FACE_LANDMARKS_TESSELATION=$v;var zr=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!0),Te(e=this.j=new dv,0,1,t=new _t)}get baseOptions(){return et(this.j,_t,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,Sr(this,e,r??{}),!this.h)return this.s}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect"),rt(e,"stylized_image");const t=new Jn;Tr(t,E5,this.j);const n=new xn;tr(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),nr(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,l=r.width;const d=l*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let m=0;m<d;++m)h[4*m]=a[3*m],h[4*m+1]=a[3*m+1],h[4*m+2]=a[3*m+2],h[4*m+3]=255;a=new ImageData(h,l,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),l,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);l=new Zt([a],!1,!1,this.g.i.canvas,this.O,l,r),this.s=i=i?l.clone():l,this.h&&this.h(i),ke(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};zr.prototype.stylize=zr.prototype.Oa,zr.prototype.setOptions=zr.prototype.o,zr.createFromModelPath=function(e,t){return Xe(zr,e,{baseOptions:{modelAssetPath:t}})},zr.createFromModelBuffer=function(e,t){return Xe(zr,e,{baseOptions:{modelAssetBuffer:t}})},zr.createFromOptions=function(e,t){return Xe(zr,e,t)};var kp=Rr([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function g0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function y0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function v0(e,t=!0){const n=[];for(const s of e){var r=ec(s);e=[];for(const i of r.g())r=t&&hr(i,1)!=null?hr(i,1)??0:-1,e.push({score:Ot(i,2)??0,index:r,categoryName:vr(i,3)??""??"",displayName:vr(i,4)??""??""});n.push(e)}return n}var Hn=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Te(e=this.j=new pv,0,1,t=new _t),this.s=new op,Te(this.j,0,2,this.s),this.C=new ip,Te(this.s,0,3,this.C),this.v=new hv,Te(this.s,0,2,this.v),this.h=new C5,Te(this.j,0,3,this.h),_e(this.v,2,.5),_e(this.s,4,.5),_e(this.C,2,.5)}get baseOptions(){return et(this.j,_t,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){var s,i,a,l;if(Xr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new Ci,n=t,r=gf(e.cannedGesturesClassifierOptions,(s=et(this.h,Ci,3))==null?void 0:s.h());Te(n,0,2,r),Te(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=et(this.h,Ci,3))==null||i.g());return e.customGesturesClassifierOptions?(Te(n=t=new Ci,0,2,r=gf(e.customGesturesClassifierOptions,(a=et(this.h,Ci,4))==null?void 0:a.h())),Te(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((l=et(this.h,Ci,4))==null||l.g()),this.l(e)}Ja(e,t){return g0(this),Sr(this,e,t),y0(this)}Ka(e,t,n){return g0(this),Kr(this,e,n,t),y0(this)}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect"),rt(e,"hand_gestures"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Jn;Tr(t,_5,this.j);const n=new xn;tr(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"HAND_GESTURES:hand_gestures"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),nr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=$a(i);const a=[];for(const l of hs(r,rv,1))a.push({x:Ot(l,1)??0,y:Ot(l,2)??0,z:Ot(l,3)??0,visibility:Ot(l,4)??0});this.landmarks.push(a)}ke(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=Zi(i);const a=[];for(const l of hs(r,nv,1))a.push({x:Ot(l,1)??0,y:Ot(l,2)??0,z:Ot(l,3)??0,visibility:Ot(l,4)??0});this.worldLandmarks.push(a)}ke(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...v0(r,!1)),ke(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{ke(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...v0(r)),ke(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function w0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Hn.prototype.recognizeForVideo=Hn.prototype.Ka,Hn.prototype.recognize=Hn.prototype.Ja,Hn.prototype.setOptions=Hn.prototype.o,Hn.createFromModelPath=function(e,t){return Xe(Hn,e,{baseOptions:{modelAssetPath:t}})},Hn.createFromModelBuffer=function(e,t){return Xe(Hn,e,{baseOptions:{modelAssetBuffer:t}})},Hn.createFromOptions=function(e,t){return Xe(Hn,e,t)},Hn.HAND_CONNECTIONS=kp;var Gn=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Te(e=this.h=new op,0,1,t=new _t),this.s=new ip,Te(this.h,0,3,this.s),this.j=new hv,Te(this.h,0,2,this.j),Xr(this.j,3,1),_e(this.j,2,.5),_e(this.s,2,.5),_e(this.h,4,.5)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numHands"in e&&Xr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Sr(this,e,t),w0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Kr(this,e,n,t),w0(this)}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Jn;Tr(t,j5,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),nr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=$a(i),this.landmarks.push(nc(r));ke(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=Zi(i),this.worldLandmarks.push(la(r));ke(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const l=[];for(const d of r){r=ec(d);const h=[];for(const m of r.g())h.push({score:Ot(m,2)??0,index:hr(m,1)??0??-1,categoryName:vr(m,3)??""??"",displayName:vr(m,4)??""??""});l.push(h)}a.call(i,...l),ke(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Gn.prototype.detectForVideo=Gn.prototype.F,Gn.prototype.detect=Gn.prototype.D,Gn.prototype.setOptions=Gn.prototype.o,Gn.createFromModelPath=function(e,t){return Xe(Gn,e,{baseOptions:{modelAssetPath:t}})},Gn.createFromModelBuffer=function(e,t){return Xe(Gn,e,{baseOptions:{modelAssetBuffer:t}})},Gn.createFromOptions=function(e,t){return Xe(Gn,e,t)},Gn.HAND_CONNECTIONS=kp;var Dv=Rr([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function x0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function S0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{sc(e)}}function ml(e,t){e=$a(e),t.push(nc(e))}var At=class extends Ln{constructor(e,t){super(new xr(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Te(e=this.j=new wv,0,1,t=new _t),this.J=new ip,Te(this.j,0,2,this.J),this.Z=new N5,Te(this.j,0,3,this.Z),this.s=new tc,Te(this.j,0,4,this.s),this.H=new lv,Te(this.j,0,5,this.H),this.v=new yv,Te(this.j,0,6,this.v),this.K=new vv,Te(this.j,0,7,this.K),_e(this.s,2,.5),_e(this.s,3,.3),_e(this.H,2,.5),_e(this.v,2,.5),_e(this.v,3,.3),_e(this.K,2,.5),_e(this.J,2,.5)}get baseOptions(){return et(this.j,_t,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&_e(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&_e(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&_e(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&_e(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&_e(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&_e(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,x0(this),Sr(this,e,r),S0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,x0(this),Kr(this,e,s,t),S0(this)}m(){var e=new Bn;St(e,"input_frames_image"),rt(e,"pose_landmarks"),rt(e,"pose_world_landmarks"),rt(e,"face_landmarks"),rt(e,"left_hand_landmarks"),rt(e,"left_hand_world_landmarks"),rt(e,"right_hand_landmarks"),rt(e,"right_hand_world_landmarks");const t=new Jn,n=new G1;cf(n,1,Ao("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))ht(s,2,hy(i));else{if(!(typeof i=="string"||i instanceof os||La(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");cf(s,2,Ah(i,!1),mi())}}(n,this.j.g());const r=new xn;tr(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),cu(r,8,G1,n),mt(r,"IMAGE:input_frames_image"),Ke(r,"POSE_LANDMARKS:pose_landmarks"),Ke(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Ke(r,"FACE_LANDMARKS:face_landmarks"),Ke(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Ke(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Ke(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Ke(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),nr(e,r),rc(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{ml(s,this.h.poseLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=Zi(s),a.push(la(s)),ke(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{ke(this,s)}),this.outputPoseSegmentationMasks&&(Ke(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),po(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[yo(this,s,!0,!this.C)],ke(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],ke(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{ml(s,this.h.faceLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{ke(this,s)}),this.outputFaceBlendshapes&&(rt(e,"extra_blendshapes"),Ke(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=ec(s),a.push(cp(s.g()??[]))),ke(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{ke(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{ml(s,this.h.leftHandLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=Zi(s),a.push(la(s)),ke(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{ml(s,this.h.rightHandLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=Zi(s),a.push(la(s)),ke(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{ke(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};At.prototype.detectForVideo=At.prototype.F,At.prototype.detect=At.prototype.D,At.prototype.setOptions=At.prototype.o,At.createFromModelPath=function(e,t){return Xe(At,e,{baseOptions:{modelAssetPath:t}})},At.createFromModelBuffer=function(e,t){return Xe(At,e,{baseOptions:{modelAssetBuffer:t}})},At.createFromOptions=function(e,t){return Xe(At,e,t)},At.HAND_CONNECTIONS=kp,At.POSE_CONNECTIONS=Dv,At.FACE_LANDMARKS_LIPS=gp,At.FACE_LANDMARKS_LEFT_EYE=yp,At.FACE_LANDMARKS_LEFT_EYEBROW=vp,At.FACE_LANDMARKS_LEFT_IRIS=Bv,At.FACE_LANDMARKS_RIGHT_EYE=wp,At.FACE_LANDMARKS_RIGHT_EYEBROW=xp,At.FACE_LANDMARKS_RIGHT_IRIS=Fv,At.FACE_LANDMARKS_FACE_OVAL=Sp,At.FACE_LANDMARKS_CONTOURS=Ov,At.FACE_LANDMARKS_TESSELATION=$v;var ar=class extends Ln{constructor(e,t){super(new xr(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Te(e=this.h=new xv,0,1,t=new _t)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return Te(this.h,0,2,gf(e,et(this.h,np,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},Sr(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},Kr(this,e,n,t),this.j}m(){var e=new Bn;St(e,"input_image"),St(e,"norm_rect"),rt(e,"classifications");const t=new Jn;Tr(t,b5,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),mt(n,"IMAGE:input_image"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"CLASSIFICATIONS:classifications"),n.o(t),nr(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:hs(i,m5,1).map(l=>{var d;return cp(((d=et(l,Zy,4))==null?void 0:d.g())??[],hr(l,2)??0,vr(l,3)??"")})};return uu(fo(i,2))!=null&&(a.timestampMs=uu(fo(i,2))??0),a}(g5(r)),ke(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ar.prototype.classifyForVideo=ar.prototype.ta,ar.prototype.classify=ar.prototype.sa,ar.prototype.setOptions=ar.prototype.o,ar.createFromModelPath=function(e,t){return Xe(ar,e,{baseOptions:{modelAssetPath:t}})},ar.createFromModelBuffer=function(e,t){return Xe(ar,e,{baseOptions:{modelAssetBuffer:t}})},ar.createFromOptions=function(e,t){return Xe(ar,e,t)};var Wn=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!0),this.h=new Sv,this.embeddings={embeddings:[]},Te(e=this.h,0,1,t=new _t)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){var t=this.h,n=et(this.h,Z1,2);return n=n?n.clone():new Z1,e.l2Normalize!==void 0?Na(n,1,e.l2Normalize):"l2Normalize"in e&&ht(n,1),e.quantize!==void 0?Na(n,2,e.quantize):"quantize"in e&&ht(n,2),Te(t,0,2,n),this.l(e)}za(e,t){return Sr(this,e,t),this.embeddings}Aa(e,t,n){return Kr(this,e,n,t),this.embeddings}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect"),rt(e,"embeddings_out");const t=new Jn;Tr(t,M5,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"EMBEDDINGS:embeddings_out"),n.o(t),nr(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=w5(r),this.embeddings=function(i){return{embeddings:hs(i,v5,1).map(a=>{var d,h;const l={headIndex:hr(a,3)??0??-1,headName:vr(a,4)??""??""};if(vy(a,q1,Zc(a,1))!==void 0)a=ii(a=et(a,q1,Zc(a,1)),1,Qs,si()),l.floatEmbedding=a.slice();else{const m=new Uint8Array(0);l.quantizedEmbedding=((h=(d=et(a,y5,Zc(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??m}return l}),timestampMs:uu(fo(i,2))??0}}(r),ke(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Wn.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=s0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=s0(r0(e.quantizedEmbedding),r0(t.quantizedEmbedding))}return e},Wn.prototype.embedForVideo=Wn.prototype.Aa,Wn.prototype.embed=Wn.prototype.za,Wn.prototype.setOptions=Wn.prototype.o,Wn.createFromModelPath=function(e,t){return Xe(Wn,e,{baseOptions:{modelAssetPath:t}})},Wn.createFromModelBuffer=function(e,t){return Xe(Wn,e,{baseOptions:{modelAssetBuffer:t}})},Wn.createFromOptions=function(e,t){return Xe(Wn,e,t)};var wf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function k0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function A0(e){try{const t=new wf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{sc(e)}}wf.prototype.close=wf.prototype.close;var dn=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new up,this.v=new kv,Te(this.h,0,3,this.v),Te(e=this.h,0,1,t=new _t)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ht(this.h,2,Ao(e.displayNamesLocale)):"displayNamesLocale"in e&&ht(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=hs(e.da(),xn,1).filter(s=>(vr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=et(t[0],Jn,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=vr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,k0(this),Sr(this,e,r),A0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,k0(this),Kr(this,e,s,t),A0(this)}Da(){return this.s}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect");const t=new Jn;Tr(t,Ev,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),n.o(t),nr(e,n),rc(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),po(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>yo(this,i,!0,!this.j)),ke(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],ke(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),po(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=yo(this,r,!1,!this.j),ke(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,ke(this,r)})),rt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,ke(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};dn.prototype.getLabels=dn.prototype.Da,dn.prototype.segmentForVideo=dn.prototype.Ma,dn.prototype.segment=dn.prototype.segment,dn.prototype.setOptions=dn.prototype.o,dn.createFromModelPath=function(e,t){return Xe(dn,e,{baseOptions:{modelAssetPath:t}})},dn.createFromModelBuffer=function(e,t){return Xe(dn,e,{baseOptions:{modelAssetBuffer:t}})},dn.createFromOptions=function(e,t){return Xe(dn,e,t)};var xf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};xf.prototype.close=xf.prototype.close;var O5=class extends Ee{constructor(e){super(e)}},_i=[0,Ft,-2],pu=[0,es,-3,Ct,es,-1],E0=[0,pu],C0=[0,pu,Ft,-1],id=class extends Ee{constructor(e){super(e)}},_0=[0,es,-1,Ct],$5=class extends Ee{constructor(e){super(e)}},j0=class extends Ee{constructor(e){super(e)}},Sf=[1,2,3,4,5,6,7,8,9,10,14,15],zv=class extends Ee{constructor(e){super(e)}};zv.prototype.g=Zu([0,Yt,[0,Sf,ot,pu,ot,[0,pu,_i],ot,E0,ot,[0,E0,_i],ot,_0,ot,[0,es,-3,Ct,wr],ot,[0,es,-3,Ct],ot,[0,st,es,-2,Ct,Ft,Ct,-1,2,es,_i],ot,C0,ot,[0,C0,_i],es,_i,st,ot,[0,es,-3,Ct,_i,-1],ot,[0,Yt,_0]],st,[0,st,Ft,-1,Ct]]);var Ur=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new up,this.s=new kv,Te(this.h,0,3,this.s),Te(e=this.h,0,1,t=new _t)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new zv;const i=new j0;var a=new O5;if(Xr(a,1,255),Te(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var l=new id;Na(l,3,!0),_e(l,1,t.keypoint.x),_e(l,2,t.keypoint.y),oa(i,5,Sf,l)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(l of(a=new $5,t.scribble))Na(t=new id,3,!0),_e(t,1,l.x),_e(t,2,l.y),cu(a,1,id,t);oa(i,15,Sf,a)}cu(r,1,j0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),Sr(this,e,s);e:{try{const h=new xf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{sc(this)}d=void 0}return d}m(){var e=new Bn;St(e,"image_in"),St(e,"roi_in"),St(e,"norm_rect_in");const t=new Jn;Tr(t,Ev,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),mt(n,"IMAGE:image_in"),mt(n,"ROI:roi_in"),mt(n,"NORM_RECT:norm_rect_in"),n.o(t),nr(e,n),rc(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),po(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>yo(this,i,!0,!this.j)),ke(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],ke(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),po(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=yo(this,r,!1,!this.j),ke(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,ke(this,r)})),rt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,ke(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ur.prototype.segment=Ur.prototype.segment,Ur.prototype.setOptions=Ur.prototype.o,Ur.createFromModelPath=function(e,t){return Xe(Ur,e,{baseOptions:{modelAssetPath:t}})},Ur.createFromModelBuffer=function(e,t){return Xe(Ur,e,{baseOptions:{modelAssetBuffer:t}})},Ur.createFromOptions=function(e,t){return Xe(Ur,e,t)};var lr=class extends Ln{constructor(e,t){super(new xr(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Te(e=this.h=new Cv,0,1,t=new _t)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ht(this.h,2,Ao(e.displayNamesLocale)):"displayNamesLocale"in e&&ht(this.h,2),e.maxResults!==void 0?Xr(this.h,3,e.maxResults):"maxResults"in e&&ht(this.h,3),e.scoreThreshold!==void 0?_e(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&ht(this.h,4),e.categoryAllowlist!==void 0?du(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&ht(this.h,5),e.categoryDenylist!==void 0?du(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&ht(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},Sr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Kr(this,e,n,t),this.j}m(){var e=new Bn;St(e,"input_frame_gpu"),St(e,"norm_rect"),rt(e,"detections");const t=new Jn;Tr(t,P5,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),mt(n,"IMAGE:input_frame_gpu"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"DETECTIONS:detections"),n.o(t),nr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=tv(i),this.j.detections.push(jv(r));ke(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};lr.prototype.detectForVideo=lr.prototype.F,lr.prototype.detect=lr.prototype.D,lr.prototype.setOptions=lr.prototype.o,lr.createFromModelPath=async function(e,t){return Xe(lr,e,{baseOptions:{modelAssetPath:t}})},lr.createFromModelBuffer=function(e,t){return Xe(lr,e,{baseOptions:{modelAssetBuffer:t}})},lr.createFromOptions=function(e,t){return Xe(lr,e,t)};var kf=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function N0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function b0(e){try{const t=new kf(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{sc(e)}}kf.prototype.close=kf.prototype.close;var Vn=class extends Ln{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Te(e=this.h=new _v,0,1,t=new _t),this.v=new vv,Te(this.h,0,3,this.v),this.j=new yv,Te(this.h,0,2,this.j),Xr(this.j,4,1),_e(this.j,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return et(this.h,_t,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numPoses"in e&&Xr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&_e(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&_e(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,N0(this),Sr(this,e,r),b0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,N0(this),Kr(this,e,s,t),b0(this)}m(){var e=new Bn;St(e,"image_in"),St(e,"norm_rect"),rt(e,"normalized_landmarks"),rt(e,"world_landmarks"),rt(e,"segmentation_masks");const t=new Jn;Tr(t,I5,this.h);const n=new xn;tr(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:normalized_landmarks"),Ke(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),nr(e,n),rc(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=$a(i),this.landmarks.push(nc(r));ke(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],ke(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=Zi(i),this.worldLandmarks.push(la(r));ke(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],ke(this,r)}),this.outputSegmentationMasks&&(Ke(n,"SEGMENTATION_MASK:segmentation_masks"),po(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>yo(this,i,!0,!this.s)),ke(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],ke(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Vn.prototype.detectForVideo=Vn.prototype.F,Vn.prototype.detect=Vn.prototype.D,Vn.prototype.setOptions=Vn.prototype.o,Vn.createFromModelPath=function(e,t){return Xe(Vn,e,{baseOptions:{modelAssetPath:t}})},Vn.createFromModelBuffer=function(e,t){return Xe(Vn,e,{baseOptions:{modelAssetBuffer:t}})},Vn.createFromOptions=function(e,t){return Xe(Vn,e,t)},Vn.POSE_CONNECTIONS=Dv;const Uv="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",D5=Uv,mu=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let l=0,d=0,h=0;t>=0&&t<60?(l=s,d=i,h=0):t<120?(l=i,d=s,h=0):t<180?(l=0,d=s,h=i):t<240?(l=0,d=i,h=s):t<300?(l=i,d=0,h=s):(l=s,d=0,h=i);const m=w=>Math.max(0,Math.min(255,Math.round((w+a)*255)));return{r:m(l),g:m(d),b:m(h)}}return null},Ap=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),M0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),T0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},Hv=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const l=e.canvas;return s=l.width,i=l.height,r=l.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(l){console.warn("[ColorDetector] Failed to extract category mask data:",l)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},z5=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=mu(t),a=mu(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:l="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:m=50,minGapRatio:w=.05}=r,S=new Image;S.crossOrigin="anonymous",S.onload=()=>{try{const _=S.width>d?d/S.width:1,L=Math.max(1,Math.round(S.width*_)),F=Math.max(1,Math.round(S.height*_)),X=document.createElement("canvas");X.width=L,X.height=F;const C=X.getContext("2d");if(!C){s({suggestion:"None",stats:{mode:"colorMask"}});return}C.drawImage(S,0,0,L,F);const g=C.getImageData(0,0,L,F),{data:y}=g,E=h*h,j={minY:F,maxY:-1,pixels:0},T={minY:F,maxY:-1,pixels:0},D=new Uint8Array(L*F);for(let q=0;q<F;q+=1)for(let te=0;te<L;te+=1){const Ae=(q*L+te)*4,xe=q*L+te,ge=y[Ae],Z=y[Ae+1],oe=y[Ae+2],ne=(ge-i.r)*(ge-i.r)+(Z-i.g)*(Z-i.g)+(oe-i.b)*(oe-i.b),ve=(ge-a.r)*(ge-a.r)+(Z-a.g)*(Z-a.g)+(oe-a.b)*(oe-a.b);ne<E&&ne<ve?(j.pixels+=1,q<j.minY&&(j.minY=q),q>j.maxY&&(j.maxY=q),D[xe]=1):ve<E&&ve<ne&&(T.pixels+=1,q<T.minY&&(T.minY=q),q>T.maxY&&(T.maxY=q),D[xe]=2)}const H={mode:"colorMask",pixelsA:j.pixels,pixelsB:T.pixels,minYA:j.pixels>0?j.minY:null,maxYA:j.pixels>0?j.maxY:null,minYB:T.pixels>0?T.minY:null,maxYB:T.pixels>0?T.maxY:null,width:L,height:F},se=j.pixels>=m,V=T.pixels>=m;let K="None";if(se&&!V)K="A";else if(!se&&V)K="B";else if(se&&V){let q,te;l==="top"?(q=j.minY,te=T.minY):(q=j.maxY,te=T.maxY);const Ae=Math.abs(q-te),xe=F*w;Ae>=xe&&(K=l==="top"?q<te?"A":"B":q>te?"A":"B")}let ee=null;try{const q=document.createElement("canvas");q.width=L,q.height=F;const te=q.getContext("2d");te.drawImage(S,0,0,L,F);const Ae=te.getImageData(0,0,L,F),xe=Ae.data,ge=(ne,ve)=>{xe[ne]=Math.round(xe[ne]*.3+ve.r*.7),xe[ne+1]=Math.round(xe[ne+1]*.3+ve.g*.7),xe[ne+2]=Math.round(xe[ne+2]*.3+ve.b*.7),xe[ne+3]=255},Z={r:255,g:82,b:97},oe={r:80,g:170,b:255};for(let ne=0;ne<D.length;ne+=1)D[ne]===1?ge(ne*4,Z):D[ne]===2&&ge(ne*4,oe);te.putImageData(Ae,0,0),ee=q.toDataURL("image/png")}catch(q){console.warn("[ColorDetector] Failed generating preview",q)}s({suggestion:K,stats:H,preview:ee})}catch(_){console.error("[ColorDetector] Error processing frame:",_),s({suggestion:"None",stats:{mode:"colorMask"}})}},S.onerror=_=>{console.error("[ColorDetector] Failed to load frame image",_),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?S.src=e:typeof e=="string"?S.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),P0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const _ of e){const L=_.y*t+_.x;L>=0&&L<i.length&&(i[L]=1)}const a=[],l=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const _ of e){const L=_.y*t+_.x;if(L<0||L>=i.length||i[L]!==1)continue;let F=0;const X=[{x:_.x,y:_.y}];i[L]=2;const C=[];let g=0;for(;g<X.length;){const{x:y,y:E}=X[g++];F++,C.push({x:y,y:E});for(const j of l){const T=y+j.dx,D=E+j.dy;if(T>=0&&T<t&&D>=0&&D<n){const H=D*t+T;H>=0&&H<i.length&&i[H]===1&&(i[H]=2,X.push({x:T,y:D}))}}}a.push({size:F,pixels:C})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((_,L)=>L.size>_.size?L:_).size,m=Math.max(1,Math.floor(h*s));let w=0;const S=[];for(const _ of a)_.size>=m&&(w+=_.size,S.push(..._.pixels));return{count:w,pixels:S,largestBlobSize:h,minBlobSize:m,totalBlobs:a.length,filteredBlobs:a.filter(_=>_.size>=m).length}},U5=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=mu(t),i=mu(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await Ap(e),l=a.naturalWidth||a.width,d=a.naturalHeight||a.height,m=(await Ep()).segment(a),{maskData:w,maskWidth:S,maskHeight:_,isRGBA:L}=Hv(m.categoryMask,l,d);if(!w)throw new Error("Failed to extract segmentation mask data");const F=new Uint8ClampedArray(l*d*4),X=l/S,C=d/_;for(let P=0;P<d;P++)for(let z=0;z<l;z++){const J=Math.min(S-1,Math.floor(z/X)),$=(Math.min(_-1,Math.floor(P/C))*S+J)*(L?4:1);let v=0;w&&$<w.length&&(v=w[$]);const R=v!==0&&v!==2?255:0,b=(P*l+z)*4;F[b]=R,F[b+1]=R,F[b+2]=R,F[b+3]=255}const g=document.createElement("canvas");g.width=l,g.height=d;const y=g.getContext("2d");y.drawImage(a,0,0,l,d);const E=y.getImageData(0,0,l,d).data,j=r.maskThreshold||100,T=r.colorThreshold??95,D=r.anchor||"top",H=T*T,se=r.scanDepth??1,V=r.stride||2;let K=D==="top"?d:0,ee=!1;if(D==="top")for(let P=0;P<d;P+=V){for(let z=0;z<l;z+=V)if(F[(P*l+z)*4]>=j){K=P,ee=!0;break}if(ee)break}else for(let P=d-1;P>=0;P-=V){for(let z=0;z<l;z+=V)if(F[(P*l+z)*4]>=j){K=P,ee=!0;break}if(ee)break}let q,te,Ae;if(r.manualBounds&&D==="manually")q=r.manualBounds.topY,te=r.manualBounds.bottomY,Ae=te-q,ee||(K=q);else{if(!ee)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};Ae=se?Math.floor(d*se):d,D==="top"?(q=K,te=Math.min(d,K+Ae)):(q=Math.max(0,K-Ae),te=K)}const xe=[],ge=[];for(let P=q;P<te;P+=V)for(let z=0;z<l;z+=V){const J=(P*l+z)*4;if(F[J]<j)continue;const ue=E[J],$=E[J+1],v=E[J+2],R=M0({r:ue,g:$,b:v},s),b=M0({r:ue,g:$,b:v},i);R<H&&R<b?xe.push({x:z,y:P}):b<H&&b<R&&ge.push({x:z,y:P})}const Z=r.minBlobRatio??.1,oe=P0(xe,l,d,V,Z),ne=P0(ge,l,d,V,Z),ve=oe.count,Me=ne.count,Ie=oe.pixels.map(P=>({...P,idx:(P.y*l+P.x)*4})),De=ne.pixels.map(P=>({...P,idx:(P.y*l+P.x)*4})),Oe=50;let ze="None",Y=null;ve>Oe&&ve>Me?(ze="A",Y={color:"A",pixelCount:ve,minY:q,maxY:te,anchorY:K,rawPixels:xe.length,largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize}):Me>Oe&&Me>ve&&(ze="B",Y={color:"B",pixelCount:Me,minY:q,maxY:te,anchorY:K,rawPixels:ge.length,largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize});let Q=null,ye=null;try{const P=document.createElement("canvas");P.width=l,P.height=d;const z=P.getContext("2d");z.drawImage(a,0,0,l,d),z.fillStyle="rgba(0,0,0,0.6)",z.fillRect(0,0,l,d),z.globalCompositeOperation="destination-out",z.fillStyle="rgba(0,0,0,1)",z.fillRect(0,q,l,te-q),z.globalCompositeOperation="destination-over",z.drawImage(a,0,0,l,d),z.globalCompositeOperation="source-over";const J=z.createImageData(l,d),ue=J.data;for(let U=q;U<te;U+=1)for(let W=0;W<l;W+=1){const ce=(U*l+W)*4;F[ce]>=j&&(ue[ce]=0,ue[ce+1]=255,ue[ce+2]=255,ue[ce+3]=90)}z.putImageData(J,0,0);const $=z.createImageData(l,d),v=$.data;for(const U of Ie){const W=U.idx;W>=0&&W<v.length-3&&(v[W]=255,v[W+1]=0,v[W+2]=0,v[W+3]=180)}for(const U of De){const W=U.idx;W>=0&&W<v.length-3&&(v[W]=0,v[W+1]=100,v[W+2]=255,v[W+3]=180)}z.putImageData($,0,0),z.globalCompositeOperation="source-over",z.strokeStyle="#00FF00",z.lineWidth=3,z.setLineDash([]),z.beginPath(),z.moveTo(0,q),z.lineTo(l,q),z.stroke(),z.strokeStyle="#FFFF00",z.lineWidth=3,z.setLineDash([5,5]),z.beginPath(),z.moveTo(0,te),z.lineTo(l,te),z.stroke(),K!==q&&K!==te&&(z.strokeStyle="#FF00FF",z.lineWidth=2,z.setLineDash([2,2]),z.beginPath(),z.moveTo(0,K),z.lineTo(l,K),z.stroke()),Q=P.toDataURL("image/png");const R=document.createElement("canvas");R.width=l,R.height=d;const b=R.getContext("2d"),M=b.createImageData(l,d),B=M.data;for(let U=0;U<l*d;U+=1){const W=U*4,me=F[U*4]>=j?255:0;B[W]=me,B[W+1]=me,B[W+2]=me,B[W+3]=255}b.putImageData(M,0,0),ye=R.toDataURL("image/png")}catch(P){console.warn("[ColorDetector] Failed generating preview",P)}const le={mode:"segmentation",width:l,height:d,pixelsA:ve,pixelsB:Me,rawPixelsA:xe.length,rawPixelsB:ge.length,tipY:K,scanDepth:Ae,scanDepthRatio:se,anchor:D,bestArm:Y,blobInfoA:{largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize,totalBlobs:oe.totalBlobs,filteredBlobs:oe.filteredBlobs,droppedPixels:xe.length-ve},blobInfoB:{largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize,totalBlobs:ne.totalBlobs,filteredBlobs:ne.filteredBlobs,droppedPixels:ge.length-Me},minBlobRatio:Z};return{suggestion:ze,stats:le,preview:Q,maskPreview:ye}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},H5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},gu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),G5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,l=-1/0;for(const w of e){const S=gu(w,i);S>l&&(l=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let _=0;_<e.length;_++){let L=0,F=1/0;for(let X=0;X<s.length;X++){const C=gu(e[_],s[X]);C<F&&(F=C,L=X)}d[_]!==L&&(d[_]=L,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((_,L)=>{const F=d[L];S[F]+=1;for(let X=0;X<r;X++)w[F][X]+=_[X]});for(let _=0;_<s.length;_++)S[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=w[_].map(L=>L/S[_]);h+=1}return{assignments:d,centroids:s}},W5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await Ep(),r=t.maxFrames||e.length,s=t.stride||2;t.minClothPixels;const i=t.manualBounds||null,a=e.slice(0,r),l=[];let d=0;for(const g of a)try{const y=await Ap(g.frameDataUrl),E=y.naturalWidth||y.width,j=y.naturalHeight||y.height,T=n.segment(y),{maskData:D,maskWidth:H,maskHeight:se,isRGBA:V}=Hv(T.categoryMask,E,j);if(!D){d+=1;continue}const K=document.createElement("canvas");K.width=E,K.height=j;const ee=K.getContext("2d");ee.drawImage(y,0,0,E,j);const q=ee.getImageData(0,0,E,j).data,te=E/H,Ae=j/se;let xe;i?xe=i.bottomY-i.topY:xe=j;const ge=Math.floor(xe/s),Z=Math.floor(E/s),oe=ge*Z,ve=Math.max(Math.floor(oe*.005),20);let Me=0,Ie=0,De=0,Oe=0,ze=0,Y=0;for(let le=0;le<j;le+=s){if(i&&(le<i.topY||le>i.bottomY))continue;const P=Math.min(se-1,Math.floor(le/Ae));for(let z=0;z<E;z+=s){const J=Math.min(H-1,Math.floor(z/te)),ue=(P*H+J)*(V?4:1);if(D[ue]===4){const v=(le*E+z)*4,R=q[v],b=q[v+1],M=q[v+2];Me+=R,Ie+=b,De+=M,Oe+=z,ze+=le,Y+=1}}}if(Y<ve){console.log(`[Cloth] Frame ${g.moveId} SKIPPED - cloth pixels: ${Y}, threshold: ${ve}, scan area: ${xe}px, manual bounds: ${i?"YES":"NO"}`),d+=1;continue}console.log(`[Cloth] Frame ${g.moveId} ACCEPTED - cloth pixels: ${Y}, threshold: ${ve}, scan area: ${xe}px, manual bounds: ${i?`Y:${i.topY}-${i.bottomY}`:"NO"}`);const Q={r:Me/Y,g:Ie/Y,b:De/Y};let ye=null;try{const le=document.createElement("canvas");le.width=E,le.height=j;const P=le.getContext("2d");P.drawImage(y,0,0,E,j);const z=P.getImageData(0,0,E,j),J=z.data;for(let ue=0;ue<j;ue+=1){const $=Math.min(se-1,Math.floor(ue/Ae));for(let v=0;v<E;v+=1){const R=Math.min(H-1,Math.floor(v/te)),b=($*H+R)*(V?4:1);if(D[b]===4){const B=(ue*E+v)*4;J[B]=Math.round(J[B]*.5+50),J[B+1]=Math.round(J[B+1]*.5+255*.5),J[B+2]=Math.round(J[B+2]*.5+50)}}}P.putImageData(z,0,0),i&&(P.fillStyle="rgba(0, 0, 0, 0.5)",P.fillRect(0,0,E,i.topY),P.fillRect(0,i.bottomY,E,j-i.bottomY),P.strokeStyle="#00FF00",P.lineWidth=3,P.setLineDash([]),P.beginPath(),P.moveTo(0,i.topY),P.lineTo(E,i.topY),P.stroke(),P.strokeStyle="#FFFF00",P.lineWidth=3,P.setLineDash([5,5]),P.beginPath(),P.moveTo(0,i.bottomY),P.lineTo(E,i.bottomY),P.stroke(),P.fillStyle="#00FF00",P.font="bold 16px Arial",P.fillText(`Manual Scan Area (${xe}px)`,10,i.topY-10)),P.fillStyle="rgba(0, 0, 0, 0.7)",P.fillRect(10,10,300,80),P.fillStyle="#FFFFFF",P.font="bold 14px Arial",P.fillText(`Cloth Pixels: ${Y}`,20,30),P.fillText(`Threshold: ${ve}`,20,50),P.fillText(`Mean Color: ${T0(Q.r,Q.g,Q.b)}`,20,70),ye=le.toDataURL("image/png")}catch(le){console.warn("[ColorDetector] Failed to generate debug preview:",le)}l.push({moveId:g.moveId,meanColor:Q,feature:[Q.r/255,Q.g/255,Q.b/255],centroidX:Oe/Y/E,centroidY:ze/Y/j,pixelCount:Y,existingPlayer:g.existingPlayer||null,debugPreview:ye})}catch(y){console.warn("[ColorDetector] Cloth analysis failed for frame",g.moveId,y),d+=1}if(l.length<2)throw new Error("Not enough frames with detectable clothing");const h=l.map(g=>g.feature),{assignments:m,centroids:w}=G5(h,Math.min(2,l.length)),S=w.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));m.forEach((g,y)=>{const E=l[y],j=S[g];j.samples.push({moveId:E.moveId,centroidX:E.centroidX,centroidY:E.centroidY,pixelCount:E.pixelCount}),j.sumR+=E.meanColor.r,j.sumG+=E.meanColor.g,j.sumB+=E.meanColor.b,j.sumPixels+=E.pixelCount,j.sumBrightness+=(E.meanColor.r+E.meanColor.g+E.meanColor.b)/3,(E.existingPlayer==="Player A"||E.existingPlayer==="Player B")&&(j.labelCounts[E.existingPlayer]+=1)});const _={};S.forEach((g,y)=>{const E=g.labelCounts["Player A"],j=g.labelCounts["Player B"];E>j?_[y]="Player A":j>E&&(_[y]="Player B")});const L=S.map((g,y)=>{const E=g.sumR/Math.max(1,g.samples.length),j=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length);return{idx:y,hue:H5(E,j,T),brightness:g.sumBrightness/Math.max(1,g.samples.length)}}).sort((g,y)=>g.hue-y.hue||g.brightness-y.brightness),F=["Player A","Player B"];L.forEach(({idx:g})=>{if(!_[g]){const y=Object.values(_),E=F.find(j=>!y.includes(j))||"Player A";_[g]=E}});const X={};m.forEach((g,y)=>{const E=l[y],j=_[g]||(g===0?"Player A":"Player B"),T=w[g],D=w[g===0?1:0],H=gu(E.feature,T),se=D?gu(E.feature,D):H,V=D?Math.max(0,1-H/(H+se+1e-6)):1;X[E.moveId]={player:j,clusterId:g,styleLabel:`Style ${g+1}`,confidence:V,stats:{meanColor:E.meanColor,pixelCount:E.pixelCount,debugPreview:E.debugPreview}}});const C=S.map((g,y)=>{const E=g.sumR/Math.max(1,g.samples.length),j=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length),D=T0(E,j,T);return{id:y,styleLabel:`Style ${y+1}`,assignedPlayer:_[y]||(y===0?"Player A":"Player B"),hexColor:D,meanColor:{r:E,g:j,b:T},sampleCount:g.samples.length,avgPixels:g.sumPixels/Math.max(1,g.samples.length),avgBrightness:g.sumBrightness/Math.max(1,g.samples.length),knownAssignments:g.labelCounts}});return{assignments:X,clusters:C,analytics:{totalFrames:a.length,usedFrames:l.length,skippedFrames:d,clusters:C}}};let od=null;const Ep=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!od){const e=await Cs.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");od=await dn.createFromOptions(e,{baseOptions:{modelAssetPath:D5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return od},V5=async e=>{try{const t=await Ap(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await Ep()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let l;if(i.categoryMask.getAsUint8Array)l=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(l=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,l.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=l[w*4];l=m}}else if(i.categoryMask instanceof Uint8Array)l=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=h[w*4];l=m}else l=h}return await Promise.all(a.map(async h=>{const m=document.createElement("canvas");m.width=n,m.height=r;const w=m.getContext("2d");w.drawImage(t,0,0,n,r);const S=w.getImageData(0,0,n,r),_=S.data;let L=0;for(let F=0;F<l.length;F++)if(l[F]===h.id){L++;const X=F*4;h.id===0?(_[X]=_[X]*.25,_[X+1]=_[X+1]*.25,_[X+2]=_[X+2]*.25):(_[X]=(_[X]+h.color[0])/2,_[X+1]=(_[X+1]+h.color[1])/2,_[X+2]=(_[X+2]+h.color[2])/2)}return w.putImageData(S,0,0),{...h,pixelCount:L,preview:m.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},Y5=Uv,X5=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),K5=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const l=e.canvas;return s=l.width,i=l.height,r=l.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(l){console.warn("[ColorDetectorGeneral] Failed to extract category mask data:",l)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},yu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),Q5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,l=-1/0;for(const w of e){const S=yu(w,i);S>l&&(l=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let _=0;_<e.length;_++){let L=0,F=1/0;for(let X=0;X<s.length;X++){const C=yu(e[_],s[X]);C<F&&(F=C,L=X)}d[_]!==L&&(d[_]=L,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((_,L)=>{const F=d[L];S[F]+=1;for(let X=0;X<r;X++)w[F][X]+=_[X]});for(let _=0;_<s.length;_++)S[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=w[_].map(L=>L/S[_]);h+=1}return{assignments:d,centroids:s}},J5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},I0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()};let ad=null;const q5=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!ad){const e=await Cs.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");ad=await dn.createFromOptions(e,{baseOptions:{modelAssetPath:Y5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return ad},Z5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for analysis");const n=await q5(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minPixels||5,a=t.manualBounds||null,l=e.slice(0,r),d=[];let h=0;for(const y of l)try{const E=await X5(y.frameDataUrl),j=E.naturalWidth||E.width,T=E.naturalHeight||E.height,D=n.segment(E),{maskData:H,maskWidth:se,maskHeight:V,isRGBA:K}=K5(D.categoryMask,j,T);if(!H){h+=1;continue}const ee=document.createElement("canvas");ee.width=j,ee.height=T;const q=ee.getContext("2d");q.drawImage(E,0,0,j,T);const te=q.getImageData(0,0,j,T).data,Ae=j/se,xe=T/V;let ge=0,Z=T;a&&(ge=Math.max(0,a.topY),Z=Math.min(T,a.bottomY));let oe=0,ne=0,ve=0,Me=0,Ie=0,De=0;for(let Y=ge;Y<Z;Y+=s){const Q=Math.min(V-1,Math.floor(Y/xe));for(let ye=0;ye<j;ye+=s){const le=Math.min(se-1,Math.floor(ye/Ae)),P=(Q*se+le)*(K?4:1);if(H[P]!==0){const J=(Y*j+ye)*4,ue=te[J],$=te[J+1],v=te[J+2];oe+=ue,ne+=$,ve+=v,Me+=ye,Ie+=Y,De+=1}}}if(De<i){h+=1;continue}const Oe={r:oe/De,g:ne/De,b:ve/De};let ze=null;try{const Y=document.createElement("canvas");Y.width=j,Y.height=T;const Q=Y.getContext("2d");Q.drawImage(E,0,0,j,T);const ye=Q.getImageData(0,0,j,T),le=ye.data;for(let P=0;P<T;P+=1){const z=Math.min(V-1,Math.floor(P/xe));for(let J=0;J<j;J+=1){const ue=Math.min(se-1,Math.floor(J/Ae)),$=(z*se+ue)*(K?4:1);if(H[$]!==0){const R=(P*j+J)*4;le[R]=Math.round(le[R]*.5+50),le[R+1]=Math.round(le[R+1]*.5+100),le[R+2]=Math.round(le[R+2]*.5+255*.5)}}}if(Q.putImageData(ye,0,0),a){Q.fillStyle="rgba(0, 0, 0, 0.5)",Q.fillRect(0,0,j,a.topY),Q.fillRect(0,a.bottomY,j,T-a.bottomY),Q.strokeStyle="#00FF00",Q.lineWidth=3,Q.setLineDash([]),Q.beginPath(),Q.moveTo(0,a.topY),Q.lineTo(j,a.topY),Q.stroke(),Q.strokeStyle="#FFFF00",Q.lineWidth=3,Q.setLineDash([5,5]),Q.beginPath(),Q.moveTo(0,a.bottomY),Q.lineTo(j,a.bottomY),Q.stroke();const P=a.bottomY-a.topY;Q.fillStyle="#00FF00",Q.font="bold 16px Arial",Q.fillText(`Manual Scan Area (${P}px)`,10,a.topY-10)}Q.fillStyle="rgba(0, 0, 0, 0.7)",Q.fillRect(10,10,300,80),Q.fillStyle="#FFFFFF",Q.font="bold 14px Arial",Q.fillText(`Non-BG Pixels: ${De}`,20,30),Q.fillText(`Threshold: ${i}`,20,50),Q.fillText(`Mean Color: ${I0(Oe.r,Oe.g,Oe.b)}`,20,70),ze=Y.toDataURL("image/png")}catch(Y){console.warn("[ColorDetectorGeneral] Failed to generate debug preview:",Y)}d.push({moveId:y.moveId,meanColor:Oe,feature:[Oe.r/255,Oe.g/255,Oe.b/255],centroidX:Me/De/j,centroidY:Ie/De/T,pixelCount:De,existingPlayer:y.existingPlayer||null,debugPreview:ze})}catch(E){console.warn("[ColorDetectorGeneral] Analysis failed for frame",y.moveId,E),h+=1}if(d.length<2)throw new Error("Not enough frames with detectable pixels (need at least 2)");const m=d.map(y=>y.feature),{assignments:w,centroids:S}=Q5(m,Math.min(2,d.length)),_=S.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));w.forEach((y,E)=>{const j=d[E],T=_[y];T.samples.push({moveId:j.moveId,centroidX:j.centroidX,centroidY:j.centroidY,pixelCount:j.pixelCount}),T.sumR+=j.meanColor.r,T.sumG+=j.meanColor.g,T.sumB+=j.meanColor.b,T.sumPixels+=j.pixelCount,T.sumBrightness+=(j.meanColor.r+j.meanColor.g+j.meanColor.b)/3,(j.existingPlayer==="Player A"||j.existingPlayer==="Player B")&&(T.labelCounts[j.existingPlayer]+=1)});const L={};_.forEach((y,E)=>{const j=y.labelCounts["Player A"],T=y.labelCounts["Player B"];j>T?L[E]="Player A":T>j&&(L[E]="Player B")});const F=_.map((y,E)=>{const j=y.sumR/Math.max(1,y.samples.length),T=y.sumG/Math.max(1,y.samples.length),D=y.sumB/Math.max(1,y.samples.length);return{idx:E,hue:J5(j,T,D),brightness:y.sumBrightness/Math.max(1,y.samples.length)}}).sort((y,E)=>y.hue-E.hue||y.brightness-E.brightness),X=["Player A","Player B"];F.forEach(({idx:y})=>{if(!L[y]){const E=Object.values(L),j=X.find(T=>!E.includes(T))||"Player A";L[y]=j}});const C={};w.forEach((y,E)=>{const j=d[E],T=L[y]||(y===0?"Player A":"Player B"),D=S[y],H=S[y===0?1:0],se=yu(j.feature,D),V=H?yu(j.feature,H):se,K=H?Math.max(0,1-se/(se+V+1e-6)):1,ee=_[y],q=ee.sumR/Math.max(1,ee.samples.length),te=ee.sumG/Math.max(1,ee.samples.length),Ae=ee.sumB/Math.max(1,ee.samples.length);C[j.moveId]={player:T,clusterId:y,styleLabel:`Style ${y+1}`,confidence:K,stats:{meanColor:{r:q,g:te,b:Ae},pixelCount:j.pixelCount,debugPreview:j.debugPreview}}});const g=_.map((y,E)=>{const j=y.sumR/Math.max(1,y.samples.length),T=y.sumG/Math.max(1,y.samples.length),D=y.sumB/Math.max(1,y.samples.length),H=I0(j,T,D);return{id:E,styleLabel:`Style ${E+1}`,assignedPlayer:L[E]||(E===0?"Player A":"Player B"),hexColor:H,meanColor:{r:j,g:T,b:D},sampleCount:y.samples.length,avgPixels:y.sumPixels/Math.max(1,y.samples.length),avgBrightness:y.sumBrightness/Math.max(1,y.samples.length),knownAssignments:y.labelCounts}});return{assignments:C,clusters:g,analytics:{totalFrames:l.length,usedFrames:d.length,skippedFrames:h,clusters:g}}},ld=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,e6=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function t6({colorPreview:e,onClose:t}){var _,L,F,X,C,g,y,E,j,T,D,H,se,V;const[n,r]=N.useState("overview"),[s,i]=N.useState(null),[a,l]=N.useState(!1),d=async()=>{if(e!=null&&e.original){l(!0);try{const K=await V5(e.original);i(K)}catch(K){console.error("Failed to run multiclass segmentation:",K)}finally{l(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,m=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,w=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",S=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return u.jsx("div",{className:"image-modal",onClick:t,children:u.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:K=>K.stopPropagation(),children:[u.jsx("button",{className:"close-modal",onClick:t,children:""}),u.jsxs("div",{className:"color-preview-tabs",children:[u.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),u.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"color-preview-grid",children:[u.jsxs("div",{className:"color-preview-panel",children:[u.jsx("h3",{children:"Original Frame"}),u.jsx("img",{src:e.original,alt:"Original frame"})]}),u.jsxs("div",{className:"color-preview-panel",children:[u.jsx("h3",{children:"Mask View"}),e.preview?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mask-label",children:((_=e.stats)==null?void 0:_.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((L=e.stats)==null?void 0:L.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),u.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mask-label",children:((F=e.stats)==null?void 0:F.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),u.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):u.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&u.jsxs("div",{className:"color-preview-stats",children:[u.jsxs("div",{className:"color-preview-meta",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${m.toLocaleString()} px)`:""]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Method:"})," ",S]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Anchor:"})," ",w]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&u.jsxs("div",{children:[u.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&u.jsxs("div",{children:[u.jsx("strong",{children:"Person coverage:"})," ",e6(e.stats.personPixels)]}),e.stats.reason&&u.jsxs("div",{children:[u.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),u.jsxs("div",{className:"color-preview-calibration",children:[u.jsxs("div",{className:"calibration-card",children:[u.jsxs("div",{className:"calibration-header",children:[u.jsx("span",{className:"player-label",children:"Player A color"}),u.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),u.jsx("code",{children:e.colorA||""}),e.calibrationA&&u.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),u.jsxs("div",{className:"calibration-card",children:[u.jsxs("div",{className:"calibration-header",children:[u.jsx("span",{className:"player-label",children:"Player B color"}),u.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),u.jsx("code",{children:e.colorB||""}),e.calibrationB&&u.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?u.jsxs("div",{className:"segmentation-breakdown",children:[u.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),u.jsxs("div",{className:"segmentation-card",children:[u.jsx("h4",{children:"Scan Zone"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Scan Depth:"})," ",((X=e.stats.scanDepth)==null?void 0:X.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&u.jsxs("p",{children:[u.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),u.jsxs("div",{className:"segmentation-card",children:[u.jsx("h4",{children:"Color A Pixels"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Filtered:"})," ",((C=e.stats.pixelsA)==null?void 0:C.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&u.jsxs("p",{children:[u.jsx("strong",{children:"Raw (before blob filter):"})," ",((g=e.stats.rawPixelsA)==null?void 0:g.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Largest blob:"})," ",((y=e.stats.blobInfoA.largestBlobSize)==null?void 0:y.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Min blob size:"})," ",((E=e.stats.blobInfoA.minBlobSize)==null?void 0:E.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),u.jsxs("div",{className:"segmentation-card",children:[u.jsx("h4",{children:"Color B Pixels"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Filtered:"})," ",((j=e.stats.pixelsB)==null?void 0:j.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&u.jsxs("p",{children:[u.jsx("strong",{children:"Raw (before blob filter):"})," ",((T=e.stats.rawPixelsB)==null?void 0:T.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Largest blob:"})," ",((D=e.stats.blobInfoB.largestBlobSize)==null?void 0:D.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Min blob size:"})," ",((H=e.stats.blobInfoB.minBlobSize)==null?void 0:H.toLocaleString())||0," px"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&u.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[u.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,u.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixel Count:"})," ",((se=e.stats.bestArm.pixelCount)==null?void 0:se.toLocaleString())||0]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?u.jsxs("div",{className:"segmentation-breakdown",children:[u.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((V=e.stats.armRegions)==null?void 0:V.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((K,ee)=>{const q=e.stats.bestArm&&K.category===e.stats.bestArm.category&&K.dominantColor===e.stats.bestArm.dominantColor;return u.jsxs("div",{className:"segmentation-card",style:{border:q?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:q?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[u.jsxs("h4",{children:["Arm ",ee+1,": ",K.categoryName,q&&u.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Dominant Color:"})," ",u.jsxs("span",{style:{color:K.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",K.dominantColor]})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixels A:"})," ",K.pixelsA||0," | ",u.jsx("strong",{children:"Pixels B:"})," ",K.pixelsB||0]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Total arm pixels:"})," ",K.pixelCount||0]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Vertical span:"})," Y=",K.minY,"  ",K.maxY," (Anchor Y: ",K.anchorY,")"]})]},ee)}):u.jsx("p",{children:"No arms detected with matching colors"})]}):u.jsxs("div",{className:"color-preview-breakdown",children:[u.jsxs("div",{className:"breakdown-card",children:[u.jsx("h4",{children:"Player A band"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",ld(e.stats.pixelsA,m),")"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),u.jsxs("div",{className:"breakdown-card",children:[u.jsx("h4",{children:"Player B band"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",ld(e.stats.pixelsB,m),")"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):u.jsxs("div",{className:"multiclass-view",children:[u.jsxs("div",{className:"multiclass-header",children:[u.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),u.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&u.jsxs("div",{className:"loading-indicator",children:[u.jsx("div",{className:"spinner"}),u.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&u.jsx("div",{className:"multiclass-grid",children:s.map(K=>u.jsxs("div",{className:"multiclass-card",children:[u.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${K.color.join(",")})`},children:[u.jsxs("h4",{children:[K.id,". ",K.name]}),u.jsx("span",{className:"multiclass-badge",children:ld(K.pixelCount,m)})]}),u.jsx("p",{className:"multiclass-desc",children:K.desc}),u.jsx("div",{className:"multiclass-preview-container",children:u.jsx("img",{src:K.preview,alt:K.name})}),u.jsxs("div",{className:"multiclass-footer",children:[K.pixelCount.toLocaleString()," pixels"]})]},K.id))}),!a&&!s&&u.jsxs("div",{className:"error-message",children:[u.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),u.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function n6({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=N.useState(0),[i,a]=N.useState(0),[l,d]=N.useState(!1),[h,m]=N.useState(!1),w=N.useRef(null),[S,_]=N.useState(0),[L,F]=N.useState(0),X=N.useRef(null),C=G0.useCallback((T,D,H,se,V,K)=>{T.clearRect(0,0,se,V),K&&T.drawImage(K,0,0),T.fillStyle="rgba(0, 255, 0, 0.2)",T.fillRect(0,D,se,H-D),T.strokeStyle="#00FF00",T.lineWidth=3,T.setLineDash([]),T.beginPath(),T.moveTo(0,D),T.lineTo(se,D),T.stroke(),T.strokeStyle="#FFFF00",T.setLineDash([]),T.beginPath(),T.moveTo(0,H),T.lineTo(se,H),T.stroke(),T.fillStyle="#00FF00",T.font="16px Arial",T.fillText("Top",10,D-5),T.fillStyle="#FFFF00",T.fillText("Bottom",10,H+20)},[]);N.useEffect(()=>{if(!e||!w.current)return;const T=new Image;T.crossOrigin="anonymous",T.onload=()=>{const D=w.current,H=D.getContext("2d");D.width=T.width,D.height=T.height,F(T.width),_(T.height),X.current=T;const se=Math.floor(T.height*.2),V=Math.floor(T.height*.8);s(se),a(V),C(H,se,V,T.width,T.height,T)},e.startsWith("data:image")?T.src=e:T.src=`data:image/jpeg;base64,${e}`},[e]),N.useEffect(()=>{if(!w.current||S===0||!X.current)return;const T=w.current.getContext("2d");C(T,r,i,L,S,X.current)},[r,i,L,S]);const g=T=>{const D=w.current,H=D.getBoundingClientRect(),se=Math.floor((T.clientY-H.top)*(D.height/H.height));Math.abs(se-r)<10?d(!0):Math.abs(se-i)<10&&m(!0)},y=T=>{if(!l&&!h)return;const D=w.current,H=D.getBoundingClientRect(),se=Math.floor((T.clientY-H.top)*(D.height/H.height)),V=Math.max(0,Math.min(D.height,se));if(l){const K=Math.min(V,i-10);s(K)}else if(h){const K=Math.max(V,r+10);a(K)}},E=()=>{d(!1),m(!1)},j=()=>{t({topY:r,bottomY:i})};return u.jsx("div",{className:"image-modal",onClick:n,children:u.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:T=>T.stopPropagation(),children:[u.jsx("button",{className:"close-modal",onClick:n,children:""}),u.jsx("h2",{children:"Set Manual Scan Area"}),u.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines to define the scan area"}),u.jsx("canvas",{ref:w,onMouseDown:g,onMouseMove:y,onMouseUp:E,onMouseLeave:E,style:{cursor:l||h?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),u.jsx("div",{className:"manual-scan-info",children:u.jsxs("p",{children:[u.jsx("strong",{children:"Top Y:"})," ",r," | ",u.jsx("strong",{children:"Bottom Y:"})," ",i," | ",u.jsx("strong",{children:"Height:"})," ",i-r,"px"]})}),u.jsxs("div",{className:"manual-scan-actions",children:[u.jsx("button",{onClick:j,className:"save-btn",children:"Save Bounds"}),u.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const ji=Ru(),r6="adminPassword",Ni=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),s6=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function i6({sessionGameId:e}){var _n,Dn,vs,yt,zn,xi;const[t,n]=N.useState(null),[r,s]=N.useState(!0),[i,a]=N.useState(null),[l,d]=N.useState(null),[h,m]=N.useState(null),[w,S]=N.useState("all"),[_,L]=N.useState(""),[F,X]=N.useState(!1),[C,g]=N.useState({}),[y,E]=N.useState({current:0,total:0}),[j,T]=N.useState("#FF0000"),[D,H]=N.useState("#0000FF"),[se,V]=N.useState(!1),[K,ee]=N.useState(!1),[q,te]=N.useState({}),[Ae,xe]=N.useState({current:0,total:0}),[ge,Z]=N.useState("bottom"),[oe,ne]=N.useState(100),[ve,Me]=N.useState(null),[Ie,De]=N.useState(null),[Oe,ze]=N.useState(!1),[Y,Q]=N.useState(null),[ye,le]=N.useState(!1),[P,z]=N.useState(null),[J,ue]=N.useState({}),[$,v]=N.useState(!1),[R,b]=N.useState(""),[M,B]=N.useState(!1),[U,W]=N.useState(null),[ce,me]=N.useState("chronological"),[Ce,Pe]=N.useState(55),[Ue,Je]=N.useState(!1),[tt,lt]=N.useState({current:0,total:0}),[ut,Ge]=N.useState(null),He=N.useCallback(async O=>{if(!O)return{suggestion:"None",stats:null};try{const de=await U5(O,j,D,{anchor:ge,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:ge==="manually"&&Ie?null:oe/100,manualBounds:ge==="manually"?Ie:null});if(de)return de}catch(de){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",de)}return z5(O,j,D,{anchor:ge})},[j,D,ge,oe,Ie]);N.useEffect(()=>{const O=localStorage.getItem(r6);O&&L(O)},[]),N.useEffect(()=>{e&&_&&Qe()},[e,_]);const We=O=>{if(!O||typeof O.h>"u")return null;const de=(O.h||0)*2,pe=(O.s||0)/255,re=(O.v||0)/255,fe=re*pe,Re=fe*(1-Math.abs(de/60%2-1)),it=re-fe;let qe=0,Le=0,$e=0;de>=0&&de<60?(qe=fe,Le=Re,$e=0):de<120?(qe=Re,Le=fe,$e=0):de<180?(qe=0,Le=fe,$e=Re):de<240?(qe=0,Le=Re,$e=fe):de<300?(qe=Re,Le=0,$e=fe):(qe=fe,Le=0,$e=Re);const ct=mn=>{const gn=Math.round((mn+it)*255).toString(16);return gn.length===1?"0"+gn:gn};return`#${ct(qe)}${ct(Le)}${ct($e)}`.toUpperCase()},Qe=async()=>{var O,de,pe,re;if(_){s(!0),a(null);try{const fe=await fetch(`${ji}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":_}});if(!fe.ok)throw new Error(`Failed to load session (${fe.status})`);const Re=await fe.json();n(Re);let it=null,qe=null,Le="";if(Re.colorA&&Re.colorB?(it=Re.colorA,qe=Re.colorB,Le="session root"):(de=(O=Re.metadata)==null?void 0:O.config)!=null&&de.colorA&&((re=(pe=Re.metadata)==null?void 0:pe.config)!=null&&re.colorB)&&(it=Re.metadata.config.colorA,qe=Re.metadata.config.colorB,Le="session metadata"),it&&qe)T(it),H(qe),console.log(`[MoveHistoryEditor]  Loaded colors from ${Le}:`,it,qe);else try{const $e=JSON.parse(localStorage.getItem("calibrationA")||"null"),ct=JSON.parse(localStorage.getItem("calibrationB")||"null");if($e&&ct){const mn=We($e),gn=We(ct);mn&&gn?(T(mn),H(gn),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",mn,gn)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch($e){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",$e),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(fe){console.error("[MoveHistoryEditor] Error loading session:",fe),a(fe.message)}finally{s(!1)}}},kt=async(O,de)=>{if(!(!e||!O||!_))try{const pe=await fetch(`${ji}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent(O)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({player:de})});if(!pe.ok)throw new Error(`Failed to update player (${pe.status})`);n(re=>re&&{...re,moves:re.moves.map(fe=>fe._id===O?{...fe,player:de}:fe)}),g(re=>{const fe={...re};return delete fe[O],fe}),console.log("[MoveHistoryEditor] Player updated:",O,de)}catch(pe){console.error("[MoveHistoryEditor] Error updating player:",pe),alert("Failed to update player: "+pe.message)}},Fn=async()=>{if(!(!e||!_)){X(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",j,"Player B:",D);const O=On.filter(pe=>pe.camera_frame);if(O.length===0){alert("No moves with camera frames to process");return}E({current:0,total:O.length}),console.log(`[MoveHistoryEditor] Processing ${O.length} moves one by one...`);let de=0;for(const pe of O){E({current:de+1,total:O.length});try{const re=await fetch(`${ji}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({sessionGameId:e,moveId:pe._id,colorA:j,colorB:D,cameraPosition:ge==="top"||ge==="bottom"?ge:void 0})});if(re.ok){const fe=await re.json();b(""),g(Re=>({...Re,[pe._id]:{player:fe.suggestion==="A"?"Player A":fe.suggestion==="B"?"Player B":"None",confidence:fe.confidence,rawResponse:fe.rawResponse}})),de++,console.log(`[MoveHistoryEditor]  Processed ${de}/${O.length}: ${fe.suggestion}`)}else re.status===503?b(" Retrying..."):b(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${pe._id}`)}catch(re){b(""),console.error(`[MoveHistoryEditor] Error processing move ${pe._id}:`,re)}}console.log("[MoveHistoryEditor] AI identification complete:",de,"moves processed"),alert(`AI identified ${de} moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in AI identification:",O),alert("AI identification failed: "+O.message)}finally{X(!1),E({current:0,total:0}),b("")}}},gt=async()=>{if(!(!e||!_)){X(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",j,"Player B:",D);const O=On.filter(pe=>pe.camera_frame&&(!pe.player||pe.player==="Unknown"||pe.player==="None"));if(O.length===0){alert("No unknown moves with camera frames to process");return}E({current:0,total:O.length}),console.log(`[MoveHistoryEditor] Processing ${O.length} unknown moves one by one...`);let de=0;for(const pe of O){E({current:de+1,total:O.length});try{const re=await fetch(`${ji}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({sessionGameId:e,moveId:pe._id,colorA:j,colorB:D,cameraPosition:ge==="top"||ge==="bottom"?ge:void 0})});if(re.ok){const fe=await re.json();b(""),g(Re=>({...Re,[pe._id]:{player:fe.suggestion==="A"?"Player A":fe.suggestion==="B"?"Player B":"None",confidence:fe.confidence,rawResponse:fe.rawResponse}})),de++,console.log(`[MoveHistoryEditor]  Processed ${de}/${O.length}: ${fe.suggestion}`)}else re.status===503?b(" Retrying..."):b(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${pe._id}`)}catch(re){b(""),console.error(`[MoveHistoryEditor] Error processing move ${pe._id}:`,re)}}console.log("[MoveHistoryEditor] AI identification complete:",de,"unknown moves processed"),alert(`AI identified ${de} unknown moves. Review and confirm suggestions below.`)}catch(O){console.error("[MoveHistoryEditor] Error in AI identification:",O),alert("AI identification failed: "+O.message)}finally{X(!1),E({current:0,total:0}),b("")}}},zt=async O=>{const de=C[O];de&&await kt(O,de.player)},Pt=async O=>{const de=q[O];de&&(await kt(O,de.player),te(pe=>{const re={...pe};return delete re[O],re}))},nn=async O=>{if(!t||!Array.isArray(t.moves))return;const de=t.moves.find(pe=>pe._id===O);if(!de||!de.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${O}`);const pe=await He(de.camera_frame);if(!pe){alert("Color-based identification failed for this move.");return}te(Re=>({...Re,[O]:{method:"color",player:pe.suggestion==="A"?"Player A":pe.suggestion==="B"?"Player B":"None",stats:pe.stats,preview:pe.preview}}));let re=null,fe=null;try{re=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{re=null}try{fe=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{fe=null}Me({moveId:O,original:de.camera_frame,preview:pe.preview,maskPreview:pe.maskPreview,stats:pe.stats,suggestion:pe.suggestion,colorA:j,colorB:D,calibrationA:re,calibrationB:fe,anchor:ge})}catch(pe){console.error("[MoveHistoryEditor] Error color-identifying move:",pe),alert("Color-based identification failed: "+pe.message)}},Kt=N.useCallback(async({mode:O})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const de=t.moves.filter(re=>re.camera_frame);if(de.length===0){alert("No camera frames available for cloth-based identification.");return}const pe=new Set(t.moves.filter(re=>!re.player||re.player==="Unknown"||re.player==="None").map(re=>re._id));if(O==="unknown"&&pe.size===0){alert("All moves already have players assigned.");return}le(!0),z(null);try{const re=de.map(Le=>({moveId:Le._id,frameDataUrl:Le.camera_frame,existingPlayer:Le.player&&Le.player!=="Unknown"?Le.player:null})),fe=await W5(re,{maxFrames:de.length,stride:2,minClothPixels:80,manualBounds:ge==="manually"?Ie:null});fe!=null&&fe.analytics&&z(fe.analytics);const Re={};fe!=null&&fe.assignments&&Object.entries(fe.assignments).forEach(([Le,$e])=>{var ct;(ct=$e.stats)!=null&&ct.debugPreview&&(Re[Le]=$e.stats.debugPreview)}),Object.keys(Re).length>0&&ue(Re);const it={};fe!=null&&fe.assignments&&Object.entries(fe.assignments).forEach(([Le,$e])=>{(O==="all"||pe.has(Le))&&(it[Le]={method:"cloth",player:$e.player,styleLabel:$e.styleLabel,confidence:$e.confidence,stats:$e.stats})});const qe=Object.keys(it).length;qe===0?alert(`Cloth-based method did not find suggestions for any ${O==="all"?"moves":"unknown moves"}.`):(te($e=>({...$e,...it})),alert(`Cloth-based method suggested players for ${qe} ${O==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(re){console.error("[MoveHistoryEditor] Cloth identification failed:",re),alert("Cloth-based identification failed: "+re.message)}finally{le(!1)}},[t,ge,Ie]);N.useCallback(()=>{Kt({mode:"all"})},[Kt]),N.useCallback(()=>{Kt({mode:"unknown"})},[Kt]);const Qt=N.useCallback(async({mode:O})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const de=t.moves.filter(re=>re.camera_frame);if(de.length===0){alert("No camera frames available for All-All identification.");return}const pe=new Set(t.moves.filter(re=>!re.player||re.player==="Unknown"||re.player==="None").map(re=>re._id));if(O==="unknown"&&pe.size===0){alert("All moves already have players assigned.");return}B(!0),W(null);try{const re=de.map(Le=>({moveId:Le._id,frameDataUrl:Le.camera_frame,existingPlayer:Le.player&&Le.player!=="Unknown"&&Le.player!=="None"?Le.player:null})),fe=await Z5(re,{maxFrames:de.length,stride:2,minPixels:80,manualBounds:ge==="manually"?Ie:null});fe!=null&&fe.analytics&&W(fe.analytics);const Re={};fe!=null&&fe.assignments&&Object.entries(fe.assignments).forEach(([Le,$e])=>{var ct;(ct=$e.stats)!=null&&ct.debugPreview&&(Re[Le]=$e.stats.debugPreview)}),Object.keys(Re).length>0&&ue(Le=>({...Le,...Re}));const it={};fe!=null&&fe.assignments&&Object.entries(fe.assignments).forEach(([Le,$e])=>{(O==="all"||pe.has(Le))&&(it[Le]={method:"allall",player:$e.player,styleLabel:$e.styleLabel,confidence:$e.confidence,stats:$e.stats})});const qe=Object.keys(it).length;qe===0?alert(`All-All method did not find suggestions for any ${O==="all"?"moves":"unknown moves"}.`):(te($e=>({...$e,...it})),alert(`All-All method suggested players for ${qe} ${O==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(re){console.error("[MoveHistoryEditor] All-All identification failed:",re),alert("All-All identification failed: "+re.message)}finally{B(!1)}},[t,ge,Ie]),rr=N.useCallback(()=>{Qt({mode:"all"})},[Qt]),Cn=N.useCallback(()=>{Qt({mode:"unknown"})},[Qt]),Qr=async O=>{if(!(!e||!_))try{console.log(`[MoveHistoryEditor] Identifying single move: ${O}`);const de=await fetch(`${ji}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({sessionGameId:e,moveId:O,colorA:j,colorB:D,cameraPosition:ge==="top"||ge==="bottom"?ge:void 0})});if(de.ok){const pe=await de.json();g(re=>({...re,[O]:{player:pe.suggestion==="A"?"Player A":pe.suggestion==="B"?"Player B":"None",confidence:pe.confidence,rawResponse:pe.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${pe.suggestion}`)}else{const pe=await de.json();alert(`Failed to identify move: ${pe.message}`)}}catch(de){console.error("[MoveHistoryEditor] Error identifying move:",de),alert("AI identification failed: "+de.message)}},On=((_n=t==null?void 0:t.moves)==null?void 0:_n.filter(O=>w==="all"?!0:O.phase===w))||[],Lr=(()=>{const O=[...On];return ce==="chronological"?O:O.sort((de,pe)=>{var qe,Le;const re=!!q[de._id],fe=!!q[pe._id];if(re&&!fe)return-1;if(!re&&fe)return 1;if(!re&&!fe)return 0;const Re=((qe=q[de._id])==null?void 0:qe.confidence)||0,it=((Le=q[pe._id])==null?void 0:Le.confidence)||0;return ce==="confidenceDesc"?it-Re:ce==="confidenceAsc"?Re-it:0})})(),ys=async()=>{if(!e||!_)return;const O=Object.entries(q).filter(([de,pe])=>(pe.confidence||0)*100>=Ce).map(([de,pe])=>({moveId:de,player:pe.player}));if(O.length===0){alert(`No moves found with confidence above ${Ce}%`);return}if(window.confirm(`Are you sure you want to confirm ${O.length} moves with confidence >= ${Ce}%?`)){Je(!0),lt({current:0,total:O.length});try{const de=await fetch(`${ji}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({updates:O})});if(!de.ok)throw new Error(`Failed to update players (${de.status})`);const pe=await de.json();console.log("[MoveHistoryEditor] Bulk update success:",pe),n(re=>{if(!re)return re;const fe=re.moves.map(Re=>{const it=O.find(qe=>qe.moveId===Re._id);return it?{...Re,player:it.player}:Re});return{...re,moves:fe}}),te(re=>{const fe={...re};return O.forEach(({moveId:Re})=>{delete fe[Re]}),fe}),alert(`Successfully confirmed ${O.length} moves.`)}catch(de){console.error("Failed to confirm moves:",de),alert("Failed to confirm moves: "+de.message)}finally{Je(!1),lt({current:0,total:0})}}};if(r)return u.jsx("div",{className:"move-editor-container",children:u.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return u.jsx("div",{className:"move-editor-container",children:u.jsxs("div",{className:"move-editor-error",children:[u.jsx("h2",{children:"Error Loading Session"}),u.jsx("p",{children:i}),u.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return u.jsx("div",{className:"move-editor-container",children:u.jsx("div",{className:"move-editor-error",children:"Session not found"})});const $n=((Dn=t.moves)==null?void 0:Dn.filter(O=>O.phase==="practice").length)||0,wi=((vs=t.moves)==null?void 0:vs.filter(O=>O.phase==="experiment").length)||0;return u.jsxs("div",{className:"move-editor-container",children:[u.jsxs("header",{className:"move-editor-header",children:[u.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),u.jsxs("div",{className:"move-editor-title",children:[u.jsx("h1",{children:"Move History Editor"}),u.jsxs("div",{className:"session-info",children:[u.jsxs("span",{className:"session-id",children:["Session: ",e]}),u.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),u.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]})]}),u.jsxs("div",{className:"phase-filter",children:[u.jsxs("button",{className:`filter-btn ${w==="all"?"active":""}`,onClick:()=>S("all"),children:["All (",((yt=t.moves)==null?void 0:yt.length)||0,")"]}),u.jsxs("button",{className:`filter-btn ${w==="practice"?"active":""}`,onClick:()=>S("practice"),children:["Practice (",$n,")"]}),u.jsxs("button",{className:`filter-btn ${w==="experiment"?"active":""}`,onClick:()=>S("experiment"),children:["Experiment (",wi,")"]})]}),u.jsxs("div",{className:"bracelet-colors-controls",children:[u.jsx("button",{className:"color-picker-toggle",onClick:()=>V(!se),children:"Bracelet Colors"}),se&&u.jsxs("div",{className:"color-picker-panel",children:[u.jsxs("div",{className:"color-input-group",children:[u.jsx("label",{children:"Player A:"}),u.jsx("input",{type:"color",value:j,onChange:O=>T(O.target.value)}),u.jsx("span",{children:j})]}),u.jsxs("div",{className:"color-input-group",children:[u.jsx("label",{children:"Player B:"}),u.jsx("input",{type:"color",value:D,onChange:O=>H(O.target.value)}),u.jsx("span",{children:D})]})]})]}),u.jsxs("div",{className:"ai-controls",children:[u.jsx("button",{className:"ai-btn ai-btn-all",onClick:Fn,disabled:F,children:F&&y.total>0?R?`${R} ${y.current}/${y.total}`:`Processing ${y.current}/${y.total}...`:"AI Identify All"}),u.jsx("button",{className:"ai-btn ai-btn-unknown",onClick:gt,disabled:F,children:F&&y.total>0?R?`${R} ${y.current}/${y.total}`:`Processing ${y.current}/${y.total}...`:"AI Identify Unknown"})]}),u.jsxs("div",{className:"color-controls",children:[Object.keys(J).length>0&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:`ai-btn debug-btn ${$?"active":""}`,onClick:()=>v(!$),style:{backgroundColor:$?"#4CAF50":"#666",marginLeft:"20px"},children:$?" Debug View ON":" Show Debug View"}),u.jsx("button",{className:"ai-btn debug-btn",onClick:()=>{v(!1),ue({})},style:{backgroundColor:"#ff5722"},children:" Clear Debug"})]}),u.jsx("button",{className:"ai-btn allall-btn",onClick:rr,disabled:M,children:M?" Identifying by All All...":" Identify by All All"}),u.jsx("button",{className:"ai-btn allall-btn",onClick:Cn,disabled:M,children:M?" Identifying by All All...":" Identify by All Unknown"}),u.jsxs("div",{className:"color-anchor-toggle",children:[u.jsx("label",{children:"Color scan:"}),u.jsxs("select",{value:ge,onChange:O=>{if(Z(O.target.value),O.target.value==="manually"){const de=(t==null?void 0:t.moves)||[];if(de.length>0){const pe=de[Math.floor(Math.random()*de.length)];pe!=null&&pe.camera_frame?(Q(pe.camera_frame),ze(!0)):(alert("No frames available. Please ensure moves have camera frames."),Z("bottom"))}else alert("No moves available."),Z("bottom")}else ze(!1),De(null),Q(null)},children:[u.jsx("option",{value:"bottom",children:"Bottom"}),u.jsx("option",{value:"top",children:"Top"}),u.jsx("option",{value:"manually",children:"Manually"})]})]}),ge!=="manually"&&u.jsxs("div",{className:"color-scan-percentage",children:[u.jsxs("label",{children:["Scan area: ",oe,"%"]}),u.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:oe,onChange:O=>ne(Number(O.target.value)),style:{width:"120px",marginLeft:"8px"}})]}),ge==="manually"&&Ie&&u.jsxs("div",{className:"manual-bounds-info",children:[u.jsxs("span",{children:["Manual: Y=",Ie.topY,"  ",Ie.bottomY]}),u.jsx("button",{onClick:()=>ze(!0),style:{marginLeft:"8px",padding:"4px 8px"},children:"Edit"})]})]})]}),P&&u.jsxs("section",{className:"cloth-analytics",children:[u.jsx("div",{className:"cloth-analytics-header",children:u.jsxs("div",{children:[u.jsx("h3",{children:"Cloth Styles Analytics"}),u.jsxs("p",{children:["Frames analyzed: ",P.usedFrames,"/",P.totalFrames,"  Skipped:"," ",P.skippedFrames]})]})}),u.jsx("div",{className:"cloth-style-grid",children:(zn=P.clusters)==null?void 0:zn.map(O=>u.jsxs("div",{className:"cloth-style-card",children:[u.jsxs("div",{className:"cloth-style-card-header",children:[u.jsx("span",{className:"style-label",children:O.styleLabel}),u.jsx("span",{className:"player-label",children:O.assignedPlayer})]}),u.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:O.hexColor}}),u.jsxs("div",{className:"cloth-style-stats",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Mean color:"})," ",O.hexColor]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Frames:"})," ",O.sampleCount]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg pixels:"})," ",Ni(O.avgPixels||0)]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg brightness:"})," ",Ni(O.avgBrightness||0)]})]})]},O.id))})]}),U&&u.jsxs("section",{className:"cloth-analytics",children:[u.jsxs("div",{className:"cloth-analytics-header",children:[u.jsxs("div",{children:[u.jsx("h3",{children:" All-All Styles Analytics (Background Excluded)"}),u.jsxs("p",{children:["Frames analyzed: ",U.usedFrames,"/",U.totalFrames,"  Skipped:"," ",U.skippedFrames]})]}),u.jsxs("div",{className:"analytics-controls",style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"15px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#f5f5f5",padding:"4px 8px",borderRadius:"4px"},children:[u.jsxs("label",{style:{fontSize:"14px"},children:["Confirm threshold: ",Ce,"%"]}),u.jsx("input",{type:"range",min:"50",max:"100",value:Ce,onChange:O=>Pe(Number(O.target.value)),style:{width:"100px"}}),u.jsx("button",{onClick:ys,disabled:Ue,style:{backgroundColor:Ue?"#9E9E9E":"#4CAF50",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:Ue?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",minWidth:"140px"},children:Ue?`Saving ${tt.current}/${tt.total}...`:`Confirm All  ${Ce}% (${Object.values(q).filter(O=>(O.confidence||0)*100>=Ce).length})`})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("label",{children:"Sort by:"}),u.jsxs("select",{value:ce,onChange:O=>me(O.target.value),style:{padding:"4px",borderRadius:"4px"},children:[u.jsx("option",{value:"chronological",children:"Chronological"}),u.jsx("option",{value:"confidenceDesc",children:"Confidence (High to Low)"}),u.jsx("option",{value:"confidenceAsc",children:"Confidence (Low to High)"})]})]})]})]}),u.jsx("div",{className:"cloth-style-grid",children:(xi=U.clusters)==null?void 0:xi.map(O=>u.jsxs("div",{className:"cloth-style-card",children:[u.jsxs("div",{className:"cloth-style-card-header",children:[u.jsx("span",{className:"style-label",children:O.styleLabel}),u.jsx("span",{className:"player-label",children:O.assignedPlayer})]}),u.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:O.hexColor}}),u.jsxs("div",{className:"cloth-style-stats",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Mean color:"})," ",O.hexColor]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Frames:"})," ",O.sampleCount]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg pixels:"})," ",Ni(O.avgPixels||0)]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Avg brightness:"})," ",Ni(O.avgBrightness||0)]})]})]},O.id))})]}),u.jsxs("div",{className:"move-editor-content",children:[u.jsx("div",{className:"moves-grid",children:Lr.map((O,de)=>{var pe;return u.jsxs("div",{className:`move-card ${(l==null?void 0:l._id)===O._id?"selected":""}`,onClick:()=>d(O),children:[u.jsxs("div",{className:"move-card-header",children:[u.jsxs("span",{className:"move-number",children:["#",de+1]}),u.jsx("span",{className:`move-phase ${O.phase}`,children:O.phase})]}),O.camera_frame&&u.jsxs("div",{className:"move-image",onClick:re=>{re.stopPropagation(),m($&&J[O._id]?J[O._id]:O.camera_frame)},style:{position:"relative"},children:[u.jsx("img",{src:$&&J[O._id]?J[O._id]:O.camera_frame,alt:`Move ${de+1}`}),u.jsx("div",{className:"image-overlay",children:" Click to enlarge"}),$&&J[O._id]&&u.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(76, 175, 80, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:" DEBUG"})]}),u.jsxs("div",{className:"move-card-body",children:[u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Type:"}),u.jsx("span",{className:"value",children:O.type})]}),C[O._id]&&(()=>{const re=C[O._id].player,Re=re==="A"||re==="Player A"?j:D;return u.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:Re,outline:`2px solid ${s6(Re,.25)}`,outlineOffset:"2px"},children:[u.jsxs("div",{className:"ai-suggestion-content",children:[u.jsx("span",{className:"ai-icon",children:""}),u.jsxs("span",{className:"ai-text",children:["AI suggests: ",u.jsx("strong",{children:C[O._id].player})]})]}),u.jsx("button",{className:"ai-confirm-btn",onClick:it=>{it.stopPropagation(),zt(O._id)},children:" Confirm"})]})})(),q[O._id]&&(()=>{const re=q[O._id],it=re.player==="Player A"?j:D,qe=re.method||"color",Le=qe==="cloth"?"":qe==="allall"?"":"",$e=qe==="cloth"?`Cloth suggests${re.styleLabel?` (${re.styleLabel})`:""}:`:qe==="allall"?`All-All suggests${re.styleLabel?` (${re.styleLabel})`:""}:`:"Color suggests:",ct=typeof re.confidence=="number"?`  ${Math.round(re.confidence*100)}% confidence`:"";let mn=it;if(re.stats&&re.stats.meanColor){const{r:gn,g:bo,b:Da}=re.stats.meanColor,ws=sr=>{const Si=Math.round(sr).toString(16);return Si.length===1?"0"+Si:Si};mn=`#${ws(gn)}${ws(bo)}${ws(Da)}`}return u.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:mn,borderWidth:"2px",outline:`4px solid ${mn}`,outlineOffset:"2px"},children:[u.jsxs("div",{className:"ai-suggestion-content",children:[u.jsx("span",{className:"ai-icon",children:Le}),u.jsxs("span",{className:"ai-text",children:[$e," ",u.jsx("strong",{children:re.player}),ct]})]}),u.jsx("button",{className:"ai-confirm-btn",disabled:ut===O._id,onClick:async gn=>{gn.stopPropagation(),Ge(O._id),await Pt(O._id),Ge(null)},children:ut===O._id?"...":" Confirm"})]})})(),u.jsxs("div",{className:"move-info-row player-row",style:{borderColor:O.player==="Player A"?j:O.player==="Player B"?D:O.player==="None"?"#9E9E9E":"#FFC107"},children:[u.jsx("span",{className:"label",children:"Player:"}),u.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[u.jsxs("select",{className:`player-select ${(pe=O.player)==null?void 0:pe.toLowerCase().replace(" ","-")}`,value:O.player||"Unknown",onChange:re=>kt(O._id,re.target.value),onClick:re=>re.stopPropagation(),style:{flex:1,borderColor:O.player==="Player A"?j:O.player==="Player B"?D:O.player==="None"?"#9E9E9E":"#FFC107"},children:[u.jsx("option",{value:"Player A",children:"Player A"}),u.jsx("option",{value:"Player B",children:"Player B"}),u.jsx("option",{value:"None",children:"None"}),u.jsx("option",{value:"Unknown",children:"Unknown"})]}),O.camera_frame&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"ai-single-btn",onClick:re=>{re.stopPropagation(),Qr(O._id)},title:"Identify this move with AI",children:""}),u.jsx("button",{className:"ai-single-btn color-single-btn",onClick:re=>{re.stopPropagation(),nn(O._id)},title:"Identify this move by color",children:""})]})]})]}),O.blockId!==null&&O.blockId!==void 0&&u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Block:"}),u.jsx("span",{className:"value",children:O.blockId})]}),Array.isArray(O.position)&&O.position.length===2&&u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Position:"}),u.jsxs("span",{className:"value",children:["(",O.position[0],", ",O.position[1],")"]})]}),u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Time:"}),u.jsxs("span",{className:"value",children:[Ni(O.elapsed,1),"s"]})]}),Number.isFinite(O.holdTime)&&O.holdTime>0&&u.jsxs("div",{className:"move-info-row",children:[u.jsx("span",{className:"label",children:"Hold:"}),u.jsxs("span",{className:"value",children:[Ni(O.holdTime,2),"s"]})]})]})]},O._id||de)})}),On.length===0&&u.jsx("div",{className:"no-moves",children:u.jsx("p",{children:"No moves found for selected filter."})})]}),h&&u.jsx("div",{className:"image-modal",onClick:()=>m(null),children:u.jsxs("div",{className:"image-modal-content",onClick:O=>O.stopPropagation(),children:[u.jsx("button",{className:"close-modal",onClick:()=>m(null),children:""}),u.jsx("img",{src:h,alt:"Expanded view"})]})}),u.jsx(t6,{colorPreview:ve,onClose:()=>Me(null)}),Oe&&Y&&u.jsx(n6,{frameDataUrl:Y,onSave:O=>{De(O),ze(!1)},onCancel:()=>{ze(!1),Z("bottom"),Q(null)}})]})}const o6=!1;function a6(){const[e,t]=N.useState(!1),[n,r]=N.useState(null),[s,i]=N.useState(null),[a,l]=N.useState(window.location.hash),[d,h]=N.useState(!1);N.useEffect(()=>{const L=()=>{l(window.location.hash)};return window.addEventListener("hashchange",L),()=>window.removeEventListener("hashchange",L)},[]),N.useEffect(()=>(window.toggleInterface=L=>{h(L),console.log("[App] Interface "+(L?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const m=L=>{r(L),t(!0)},w=()=>{s&&!s.closed&&s.close();const L=window.location.origin+window.location.pathname+"#/detector",F=window.open(L,"BraceletDetector","width=700,height=600,left=100,top=100");i(F)};N.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),N.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(L){console.error("Error ending experience:",L),alert("Error ending experience: "+L.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let S=null;const _=a.match(/^#\/admin\/edit-moves\/(.+)$/);if(a==="#/detector")S=u.jsx(g1,{});else if(a==="#/calibrate")S=u.jsx(dx,{});else if(a==="#/detector2")S=u.jsx(fx,{});else if(a==="#/summary")S=u.jsx(K2,{});else if(a==="#/admin")S=u.jsx(px,{});else if(a==="#/admin/upload")S=u.jsx(mx,{});else if(_){const L=decodeURIComponent(_[1]);S=u.jsx(i6,{sessionGameId:L},L)}else S=e?u.jsxs(u.Fragment,{children:[u.jsx(ux,{config:n,interfaceHidden:d}),u.jsx(g1,{hidden:d}),o6,!d&&u.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[u.jsx("button",{onClick:w,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),u.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),u.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&u.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:u.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):u.jsx(tx,{onStart:m});return u.jsx("div",{className:"App",children:S})}ud.createRoot(document.getElementById("root")).render(u.jsx(G0.StrictMode,{children:u.jsx(a6,{})}));
