(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var F0={exports:{}},Su={},O0={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ba=Symbol.for("react.element"),j3=Symbol.for("react.portal"),N3=Symbol.for("react.fragment"),b3=Symbol.for("react.strict_mode"),M3=Symbol.for("react.profiler"),T3=Symbol.for("react.provider"),P3=Symbol.for("react.context"),I3=Symbol.for("react.forward_ref"),R3=Symbol.for("react.suspense"),B3=Symbol.for("react.memo"),L3=Symbol.for("react.lazy"),sm=Symbol.iterator;function F3(e){return e===null||typeof e!="object"?null:(e=sm&&e[sm]||e["@@iterator"],typeof e=="function"?e:null)}var $0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D0=Object.assign,z0={};function So(e,t,n){this.props=e,this.context=t,this.refs=z0,this.updater=n||$0}So.prototype.isReactComponent={};So.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};So.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function U0(){}U0.prototype=So.prototype;function _f(e,t,n){this.props=e,this.context=t,this.refs=z0,this.updater=n||$0}var jf=_f.prototype=new U0;jf.constructor=_f;D0(jf,So.prototype);jf.isPureReactComponent=!0;var im=Array.isArray,H0=Object.prototype.hasOwnProperty,Nf={current:null},G0={key:!0,ref:!0,__self:!0,__source:!0};function W0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)H0.call(t,r)&&!G0.hasOwnProperty(r)&&(s[r]=t[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var d=Array(u),h=0;h<u;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:Ba,type:e,key:i,ref:a,props:s,_owner:Nf.current}}function O3(e,t){return{$$typeof:Ba,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ba}function $3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var om=/\/+/g;function wc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$3(""+e.key):t.toString(36)}function wl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ba:case j3:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+wc(a,0):r,im(s)?(n="",e!=null&&(n=e.replace(om,"$&/")+"/"),wl(s,t,n,"",function(h){return h})):s!=null&&(bf(s)&&(s=O3(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(om,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",im(e))for(var u=0;u<e.length;u++){i=e[u];var d=r+wc(i,u);a+=wl(i,t,n,d,s)}else if(d=F3(e),typeof d=="function")for(e=d.call(e),u=0;!(i=e.next()).done;)i=i.value,d=r+wc(i,u++),a+=wl(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ja(e,t,n){if(e==null)return e;var r=[],s=0;return wl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function D3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var wn={current:null},Sl={transition:null},z3={ReactCurrentDispatcher:wn,ReactCurrentBatchConfig:Sl,ReactCurrentOwner:Nf};function V0(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Ja,forEach:function(e,t,n){Ja(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ja(e,function(){t++}),t},toArray:function(e){return Ja(e,function(t){return t})||[]},only:function(e){if(!bf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=So;Ye.Fragment=N3;Ye.Profiler=M3;Ye.PureComponent=_f;Ye.StrictMode=b3;Ye.Suspense=R3;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z3;Ye.act=V0;Ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=D0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Nf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(d in t)H0.call(t,d)&&!G0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&u!==void 0?u[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var h=0;h<d;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:Ba,type:e.type,key:s,ref:i,props:r,_owner:a}};Ye.createContext=function(e){return e={$$typeof:P3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:T3,_context:e},e.Consumer=e};Ye.createElement=W0;Ye.createFactory=function(e){var t=W0.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:I3,render:e}};Ye.isValidElement=bf;Ye.lazy=function(e){return{$$typeof:L3,_payload:{_status:-1,_result:e},_init:D3}};Ye.memo=function(e,t){return{$$typeof:B3,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=Sl.transition;Sl.transition={};try{e()}finally{Sl.transition=t}};Ye.unstable_act=V0;Ye.useCallback=function(e,t){return wn.current.useCallback(e,t)};Ye.useContext=function(e){return wn.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return wn.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return wn.current.useEffect(e,t)};Ye.useId=function(){return wn.current.useId()};Ye.useImperativeHandle=function(e,t,n){return wn.current.useImperativeHandle(e,t,n)};Ye.useInsertionEffect=function(e,t){return wn.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return wn.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return wn.current.useMemo(e,t)};Ye.useReducer=function(e,t,n){return wn.current.useReducer(e,t,n)};Ye.useRef=function(e){return wn.current.useRef(e)};Ye.useState=function(e){return wn.current.useState(e)};Ye.useSyncExternalStore=function(e,t,n){return wn.current.useSyncExternalStore(e,t,n)};Ye.useTransition=function(){return wn.current.useTransition()};Ye.version="18.3.1";O0.exports=Ye;var j=O0.exports;const Y0=_3(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U3=j,H3=Symbol.for("react.element"),G3=Symbol.for("react.fragment"),W3=Object.prototype.hasOwnProperty,V3=U3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Y3={key:!0,ref:!0,__self:!0,__source:!0};function X0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)W3.call(t,r)&&!Y3.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:H3,type:e,key:i,ref:a,props:s,_owner:V3.current}}Su.Fragment=G3;Su.jsx=X0;Su.jsxs=X0;F0.exports=Su;var l=F0.exports,fd={},K0={exports:{}},Jn={},Q0={exports:{}},J0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,te){var q=se.length;se.push(te);e:for(;0<q;){var me=q-1>>>1,Me=se[me];if(0<s(Me,te))se[me]=te,se[q]=Me,q=me;else break e}}function n(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var te=se[0],q=se.pop();if(q!==te){se[0]=q;e:for(var me=0,Me=se.length,Ue=Me>>>1;me<Ue;){var He=2*(me+1)-1,Re=se[He],De=He+1,ne=se[De];if(0>s(Re,q))De<Me&&0>s(ne,Re)?(se[me]=ne,se[De]=q,me=De):(se[me]=Re,se[He]=q,me=He);else if(De<Me&&0>s(ne,q))se[me]=ne,se[De]=q,me=De;else break e}}return te}function s(se,te){var q=se.sortIndex-te.sortIndex;return q!==0?q:se.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,u=a.now();e.unstable_now=function(){return a.now()-u}}var d=[],h=[],g=1,v=null,w=3,_=!1,R=!1,B=!1,K=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(se){for(var te=n(h);te!==null;){if(te.callback===null)r(h);else if(te.startTime<=se)r(h),te.sortIndex=te.expirationTime,t(d,te);else break;te=n(h)}}function M(se){if(B=!1,k(se),!R)if(n(d)!==null)R=!0,pe(b);else{var te=n(h);te!==null&&Se(M,te.startTime-se)}}function b(se,te){R=!1,B&&(B=!1,E(O),O=-1),_=!0;var q=w;try{for(k(te),v=n(d);v!==null&&(!(v.expirationTime>te)||se&&!X());){var me=v.callback;if(typeof me=="function"){v.callback=null,w=v.priorityLevel;var Me=me(v.expirationTime<=te);te=e.unstable_now(),typeof Me=="function"?v.callback=Me:v===n(d)&&r(d),k(te)}else r(d);v=n(d)}if(v!==null)var Ue=!0;else{var He=n(h);He!==null&&Se(M,He.startTime-te),Ue=!1}return Ue}finally{v=null,w=q,_=!1}}var H=!1,I=null,O=-1,z=5,W=-1;function X(){return!(e.unstable_now()-W<z)}function Z(){if(I!==null){var se=e.unstable_now();W=se;var te=!0;try{te=I(!0,se)}finally{te?Q():(H=!1,I=null)}}else H=!1}var Q;if(typeof y=="function")Q=function(){y(Z)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,he=re.port2;re.port1.onmessage=Z,Q=function(){he.postMessage(null)}}else Q=function(){K(Z,0)};function pe(se){I=se,H||(H=!0,Q())}function Se(se,te){O=K(function(){se(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){R||_||(R=!0,pe(b))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return w},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(se){switch(w){case 1:case 2:case 3:var te=3;break;default:te=w}var q=w;w=te;try{return se()}finally{w=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,te){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var q=w;w=se;try{return te()}finally{w=q}},e.unstable_scheduleCallback=function(se,te,q){var me=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?me+q:me):q=me,se){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=q+Me,se={id:g++,callback:te,priorityLevel:se,startTime:q,expirationTime:Me,sortIndex:-1},q>me?(se.sortIndex=q,t(h,se),n(d)===null&&se===n(h)&&(B?(E(O),O=-1):B=!0,Se(M,q-me))):(se.sortIndex=Me,t(d,se),R||_||(R=!0,pe(b))),se},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(se){var te=w;return function(){var q=w;w=te;try{return se.apply(this,arguments)}finally{w=q}}}})(J0);Q0.exports=J0;var X3=Q0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K3=j,Kn=X3;function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z0=new Set,pa={};function gi(e,t){ro(e,t),ro(e+"Capture",t)}function ro(e,t){for(pa[e]=t,e=0;e<t.length;e++)Z0.add(t[e])}var as=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hd=Object.prototype.hasOwnProperty,Q3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,am={},lm={};function J3(e){return hd.call(lm,e)?!0:hd.call(am,e)?!1:Q3.test(e)?lm[e]=!0:(am[e]=!0,!1)}function Z3(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function q3(e,t,n,r){if(t===null||typeof t>"u"||Z3(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Sn(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){un[e]=new Sn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];un[t]=new Sn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){un[e]=new Sn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){un[e]=new Sn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){un[e]=new Sn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){un[e]=new Sn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){un[e]=new Sn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){un[e]=new Sn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){un[e]=new Sn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mf=/[\-:]([a-z])/g;function Tf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Mf,Tf);un[t]=new Sn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Mf,Tf);un[t]=new Sn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Mf,Tf);un[t]=new Sn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){un[e]=new Sn(e,1,!1,e.toLowerCase(),null,!1,!1)});un.xlinkHref=new Sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){un[e]=new Sn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Pf(e,t,n,r){var s=un.hasOwnProperty(t)?un[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(q3(t,n,s,r)&&(n=null),r||s===null?J3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var hs=K3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Za=Symbol.for("react.element"),Ti=Symbol.for("react.portal"),Pi=Symbol.for("react.fragment"),If=Symbol.for("react.strict_mode"),pd=Symbol.for("react.profiler"),q0=Symbol.for("react.provider"),eg=Symbol.for("react.context"),Rf=Symbol.for("react.forward_ref"),md=Symbol.for("react.suspense"),gd=Symbol.for("react.suspense_list"),Bf=Symbol.for("react.memo"),ws=Symbol.for("react.lazy"),tg=Symbol.for("react.offscreen"),um=Symbol.iterator;function Oo(e){return e===null||typeof e!="object"?null:(e=um&&e[um]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,Sc;function Ko(e){if(Sc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Sc=t&&t[1]||""}return`
`+Sc+e}var kc=!1;function Ac(e,t){if(!e||kc)return"";kc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,u=i.length-1;1<=a&&0<=u&&s[a]!==i[u];)u--;for(;1<=a&&0<=u;a--,u--)if(s[a]!==i[u]){if(a!==1||u!==1)do if(a--,u--,0>u||s[a]!==i[u]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=u);break}}}finally{kc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ko(e):""}function e4(e){switch(e.tag){case 5:return Ko(e.type);case 16:return Ko("Lazy");case 13:return Ko("Suspense");case 19:return Ko("SuspenseList");case 0:case 2:case 15:return e=Ac(e.type,!1),e;case 11:return e=Ac(e.type.render,!1),e;case 1:return e=Ac(e.type,!0),e;default:return""}}function yd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Pi:return"Fragment";case Ti:return"Portal";case pd:return"Profiler";case If:return"StrictMode";case md:return"Suspense";case gd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case eg:return(e.displayName||"Context")+".Consumer";case q0:return(e._context.displayName||"Context")+".Provider";case Rf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bf:return t=e.displayName||null,t!==null?t:yd(e.type)||"Memo";case ws:t=e._payload,e=e._init;try{return yd(e(t))}catch{}}return null}function t4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yd(t);case 8:return t===If?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $s(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ng(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function n4(e){var t=ng(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function qa(e){e._valueTracker||(e._valueTracker=n4(e))}function rg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ng(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ol(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vd(e,t){var n=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function cm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=$s(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sg(e,t){t=t.checked,t!=null&&Pf(e,"checked",t,!1)}function xd(e,t){sg(e,t);var n=$s(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wd(e,t.type,n):t.hasOwnProperty("defaultValue")&&wd(e,t.type,$s(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function dm(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function wd(e,t,n){(t!=="number"||Ol(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Qo=Array.isArray;function Wi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$s(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Sd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(le(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(le(92));if(Qo(n)){if(1<n.length)throw Error(le(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:$s(n)}}function ig(e,t){var n=$s(t.value),r=$s(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function hm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function og(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?og(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var el,ag=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(el=el||document.createElement("div"),el.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=el.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ma(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ta={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r4=["Webkit","ms","Moz","O"];Object.keys(ta).forEach(function(e){r4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ta[t]=ta[e]})});function lg(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ta.hasOwnProperty(e)&&ta[e]?(""+t).trim():t+"px"}function ug(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=lg(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var s4=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ad(e,t){if(t){if(s4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(le(62))}}function Ed(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cd=null;function Lf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _d=null,Vi=null,Yi=null;function pm(e){if(e=Oa(e)){if(typeof _d!="function")throw Error(le(280));var t=e.stateNode;t&&(t=_u(t),_d(e.stateNode,e.type,t))}}function cg(e){Vi?Yi?Yi.push(e):Yi=[e]:Vi=e}function dg(){if(Vi){var e=Vi,t=Yi;if(Yi=Vi=null,pm(e),t)for(e=0;e<t.length;e++)pm(t[e])}}function fg(e,t){return e(t)}function hg(){}var Ec=!1;function pg(e,t,n){if(Ec)return e(t,n);Ec=!0;try{return fg(e,t,n)}finally{Ec=!1,(Vi!==null||Yi!==null)&&(hg(),dg())}}function ga(e,t){var n=e.stateNode;if(n===null)return null;var r=_u(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(le(231,t,typeof n));return n}var jd=!1;if(as)try{var $o={};Object.defineProperty($o,"passive",{get:function(){jd=!0}}),window.addEventListener("test",$o,$o),window.removeEventListener("test",$o,$o)}catch{jd=!1}function i4(e,t,n,r,s,i,a,u,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(g){this.onError(g)}}var na=!1,$l=null,Dl=!1,Nd=null,o4={onError:function(e){na=!0,$l=e}};function a4(e,t,n,r,s,i,a,u,d){na=!1,$l=null,i4.apply(o4,arguments)}function l4(e,t,n,r,s,i,a,u,d){if(a4.apply(this,arguments),na){if(na){var h=$l;na=!1,$l=null}else throw Error(le(198));Dl||(Dl=!0,Nd=h)}}function yi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function mg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function mm(e){if(yi(e)!==e)throw Error(le(188))}function u4(e){var t=e.alternate;if(!t){if(t=yi(e),t===null)throw Error(le(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return mm(s),e;if(i===r)return mm(s),t;i=i.sibling}throw Error(le(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,u=s.child;u;){if(u===n){a=!0,n=s,r=i;break}if(u===r){a=!0,r=s,n=i;break}u=u.sibling}if(!a){for(u=i.child;u;){if(u===n){a=!0,n=i,r=s;break}if(u===r){a=!0,r=i,n=s;break}u=u.sibling}if(!a)throw Error(le(189))}}if(n.alternate!==r)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?e:t}function gg(e){return e=u4(e),e!==null?yg(e):null}function yg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yg(e);if(t!==null)return t;e=e.sibling}return null}var vg=Kn.unstable_scheduleCallback,gm=Kn.unstable_cancelCallback,c4=Kn.unstable_shouldYield,d4=Kn.unstable_requestPaint,$t=Kn.unstable_now,f4=Kn.unstable_getCurrentPriorityLevel,Ff=Kn.unstable_ImmediatePriority,xg=Kn.unstable_UserBlockingPriority,zl=Kn.unstable_NormalPriority,h4=Kn.unstable_LowPriority,wg=Kn.unstable_IdlePriority,ku=null,Gr=null;function p4(e){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(ku,e,void 0,(e.current.flags&128)===128)}catch{}}var jr=Math.clz32?Math.clz32:y4,m4=Math.log,g4=Math.LN2;function y4(e){return e>>>=0,e===0?32:31-(m4(e)/g4|0)|0}var tl=64,nl=4194304;function Jo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ul(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var u=a&~s;u!==0?r=Jo(u):(i&=a,i!==0&&(r=Jo(i)))}else a=n&~s,a!==0?r=Jo(a):i!==0&&(r=Jo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-jr(t),s=1<<n,r|=e[n],t&=~s;return r}function v4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function x4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-jr(i),u=1<<a,d=s[a];d===-1?(!(u&n)||u&r)&&(s[a]=v4(u,t)):d<=t&&(e.expiredLanes|=u),i&=~u}}function bd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sg(){var e=tl;return tl<<=1,!(tl&4194240)&&(tl=64),e}function Cc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function La(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jr(t),e[t]=n}function w4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-jr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Of(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-jr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function kg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ag,$f,Eg,Cg,_g,Md=!1,rl=[],bs=null,Ms=null,Ts=null,ya=new Map,va=new Map,As=[],S4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ym(e,t){switch(e){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":Ms=null;break;case"mouseover":case"mouseout":Ts=null;break;case"pointerover":case"pointerout":ya.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":va.delete(t.pointerId)}}function Do(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Oa(t),t!==null&&$f(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function k4(e,t,n,r,s){switch(t){case"focusin":return bs=Do(bs,e,t,n,r,s),!0;case"dragenter":return Ms=Do(Ms,e,t,n,r,s),!0;case"mouseover":return Ts=Do(Ts,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return ya.set(i,Do(ya.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,va.set(i,Do(va.get(i)||null,e,t,n,r,s)),!0}return!1}function jg(e){var t=ti(e.target);if(t!==null){var n=yi(t);if(n!==null){if(t=n.tag,t===13){if(t=mg(n),t!==null){e.blockedOn=t,_g(e.priority,function(){Eg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function kl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Td(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Cd=r,n.target.dispatchEvent(r),Cd=null}else return t=Oa(n),t!==null&&$f(t),e.blockedOn=n,!1;t.shift()}return!0}function vm(e,t,n){kl(e)&&n.delete(t)}function A4(){Md=!1,bs!==null&&kl(bs)&&(bs=null),Ms!==null&&kl(Ms)&&(Ms=null),Ts!==null&&kl(Ts)&&(Ts=null),ya.forEach(vm),va.forEach(vm)}function zo(e,t){e.blockedOn===t&&(e.blockedOn=null,Md||(Md=!0,Kn.unstable_scheduleCallback(Kn.unstable_NormalPriority,A4)))}function xa(e){function t(s){return zo(s,e)}if(0<rl.length){zo(rl[0],e);for(var n=1;n<rl.length;n++){var r=rl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(bs!==null&&zo(bs,e),Ms!==null&&zo(Ms,e),Ts!==null&&zo(Ts,e),ya.forEach(t),va.forEach(t),n=0;n<As.length;n++)r=As[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<As.length&&(n=As[0],n.blockedOn===null);)jg(n),n.blockedOn===null&&As.shift()}var Xi=hs.ReactCurrentBatchConfig,Hl=!0;function E4(e,t,n,r){var s=at,i=Xi.transition;Xi.transition=null;try{at=1,Df(e,t,n,r)}finally{at=s,Xi.transition=i}}function C4(e,t,n,r){var s=at,i=Xi.transition;Xi.transition=null;try{at=4,Df(e,t,n,r)}finally{at=s,Xi.transition=i}}function Df(e,t,n,r){if(Hl){var s=Td(e,t,n,r);if(s===null)Bc(e,t,r,Gl,n),ym(e,r);else if(k4(s,e,t,n,r))r.stopPropagation();else if(ym(e,r),t&4&&-1<S4.indexOf(e)){for(;s!==null;){var i=Oa(s);if(i!==null&&Ag(i),i=Td(e,t,n,r),i===null&&Bc(e,t,r,Gl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Bc(e,t,r,null,n)}}var Gl=null;function Td(e,t,n,r){if(Gl=null,e=Lf(r),e=ti(e),e!==null)if(t=yi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=mg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gl=e,null}function Ng(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(f4()){case Ff:return 1;case xg:return 4;case zl:case h4:return 16;case wg:return 536870912;default:return 16}default:return 16}}var js=null,zf=null,Al=null;function bg(){if(Al)return Al;var e,t=zf,n=t.length,r,s="value"in js?js.value:js.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return Al=s.slice(e,1<r?1-r:void 0)}function El(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sl(){return!0}function xm(){return!1}function Zn(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(i):i[u]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sl:xm,this.isPropagationStopped=xm,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=sl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=sl)},persist:function(){},isPersistent:sl}),t}var ko={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uf=Zn(ko),Fa=Mt({},ko,{view:0,detail:0}),_4=Zn(Fa),_c,jc,Uo,Au=Mt({},Fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Uo&&(Uo&&e.type==="mousemove"?(_c=e.screenX-Uo.screenX,jc=e.screenY-Uo.screenY):jc=_c=0,Uo=e),_c)},movementY:function(e){return"movementY"in e?e.movementY:jc}}),wm=Zn(Au),j4=Mt({},Au,{dataTransfer:0}),N4=Zn(j4),b4=Mt({},Fa,{relatedTarget:0}),Nc=Zn(b4),M4=Mt({},ko,{animationName:0,elapsedTime:0,pseudoElement:0}),T4=Zn(M4),P4=Mt({},ko,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),I4=Zn(P4),R4=Mt({},ko,{data:0}),Sm=Zn(R4),B4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},F4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=F4[e])?!!t[e]:!1}function Hf(){return O4}var $4=Mt({},Fa,{key:function(e){if(e.key){var t=B4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=El(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?L4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hf,charCode:function(e){return e.type==="keypress"?El(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?El(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),D4=Zn($4),z4=Mt({},Au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),km=Zn(z4),U4=Mt({},Fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hf}),H4=Zn(U4),G4=Mt({},ko,{propertyName:0,elapsedTime:0,pseudoElement:0}),W4=Zn(G4),V4=Mt({},Au,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Y4=Zn(V4),X4=[9,13,27,32],Gf=as&&"CompositionEvent"in window,ra=null;as&&"documentMode"in document&&(ra=document.documentMode);var K4=as&&"TextEvent"in window&&!ra,Mg=as&&(!Gf||ra&&8<ra&&11>=ra),Am=" ",Em=!1;function Tg(e,t){switch(e){case"keyup":return X4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ii=!1;function Q4(e,t){switch(e){case"compositionend":return Pg(t);case"keypress":return t.which!==32?null:(Em=!0,Am);case"textInput":return e=t.data,e===Am&&Em?null:e;default:return null}}function J4(e,t){if(Ii)return e==="compositionend"||!Gf&&Tg(e,t)?(e=bg(),Al=zf=js=null,Ii=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mg&&t.locale!=="ko"?null:t.data;default:return null}}var Z4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Z4[e.type]:t==="textarea"}function Ig(e,t,n,r){cg(r),t=Wl(t,"onChange"),0<t.length&&(n=new Uf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var sa=null,wa=null;function q4(e){Gg(e,0)}function Eu(e){var t=Li(e);if(rg(t))return e}function ex(e,t){if(e==="change")return t}var Rg=!1;if(as){var bc;if(as){var Mc="oninput"in document;if(!Mc){var _m=document.createElement("div");_m.setAttribute("oninput","return;"),Mc=typeof _m.oninput=="function"}bc=Mc}else bc=!1;Rg=bc&&(!document.documentMode||9<document.documentMode)}function jm(){sa&&(sa.detachEvent("onpropertychange",Bg),wa=sa=null)}function Bg(e){if(e.propertyName==="value"&&Eu(wa)){var t=[];Ig(t,wa,e,Lf(e)),pg(q4,t)}}function tx(e,t,n){e==="focusin"?(jm(),sa=t,wa=n,sa.attachEvent("onpropertychange",Bg)):e==="focusout"&&jm()}function nx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Eu(wa)}function rx(e,t){if(e==="click")return Eu(t)}function sx(e,t){if(e==="input"||e==="change")return Eu(t)}function ix(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var br=typeof Object.is=="function"?Object.is:ix;function Sa(e,t){if(br(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!hd.call(t,s)||!br(e[s],t[s]))return!1}return!0}function Nm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function bm(e,t){var n=Nm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Nm(n)}}function Lg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Lg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Fg(){for(var e=window,t=Ol();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ol(e.document)}return t}function Wf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ox(e){var t=Fg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Lg(n.ownerDocument.documentElement,n)){if(r!==null&&Wf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=bm(n,i);var a=bm(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ax=as&&"documentMode"in document&&11>=document.documentMode,Ri=null,Pd=null,ia=null,Id=!1;function Mm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Id||Ri==null||Ri!==Ol(r)||(r=Ri,"selectionStart"in r&&Wf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ia&&Sa(ia,r)||(ia=r,r=Wl(Pd,"onSelect"),0<r.length&&(t=new Uf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ri)))}function il(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Bi={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionend:il("Transition","TransitionEnd")},Tc={},Og={};as&&(Og=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function Cu(e){if(Tc[e])return Tc[e];if(!Bi[e])return e;var t=Bi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Og)return Tc[e]=t[n];return e}var $g=Cu("animationend"),Dg=Cu("animationiteration"),zg=Cu("animationstart"),Ug=Cu("transitionend"),Hg=new Map,Tm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hs(e,t){Hg.set(e,t),gi(t,[e])}for(var Pc=0;Pc<Tm.length;Pc++){var Ic=Tm[Pc],lx=Ic.toLowerCase(),ux=Ic[0].toUpperCase()+Ic.slice(1);Hs(lx,"on"+ux)}Hs($g,"onAnimationEnd");Hs(Dg,"onAnimationIteration");Hs(zg,"onAnimationStart");Hs("dblclick","onDoubleClick");Hs("focusin","onFocus");Hs("focusout","onBlur");Hs(Ug,"onTransitionEnd");ro("onMouseEnter",["mouseout","mouseover"]);ro("onMouseLeave",["mouseout","mouseover"]);ro("onPointerEnter",["pointerout","pointerover"]);ro("onPointerLeave",["pointerout","pointerover"]);gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zo));function Pm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,l4(r,t,void 0,e),e.currentTarget=null}function Gg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var u=r[a],d=u.instance,h=u.currentTarget;if(u=u.listener,d!==i&&s.isPropagationStopped())break e;Pm(s,u,h),i=d}else for(a=0;a<r.length;a++){if(u=r[a],d=u.instance,h=u.currentTarget,u=u.listener,d!==i&&s.isPropagationStopped())break e;Pm(s,u,h),i=d}}}if(Dl)throw e=Nd,Dl=!1,Nd=null,e}function vt(e,t){var n=t[Od];n===void 0&&(n=t[Od]=new Set);var r=e+"__bubble";n.has(r)||(Wg(t,e,2,!1),n.add(r))}function Rc(e,t,n){var r=0;t&&(r|=4),Wg(n,e,r,t)}var ol="_reactListening"+Math.random().toString(36).slice(2);function ka(e){if(!e[ol]){e[ol]=!0,Z0.forEach(function(n){n!=="selectionchange"&&(cx.has(n)||Rc(n,!1,e),Rc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ol]||(t[ol]=!0,Rc("selectionchange",!1,t))}}function Wg(e,t,n,r){switch(Ng(t)){case 1:var s=E4;break;case 4:s=C4;break;default:s=Df}n=s.bind(null,t,n,e),s=void 0,!jd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Bc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;u!==null;){if(a=ti(u),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}u=u.parentNode}}r=r.return}pg(function(){var h=i,g=Lf(n),v=[];e:{var w=Hg.get(e);if(w!==void 0){var _=Uf,R=e;switch(e){case"keypress":if(El(n)===0)break e;case"keydown":case"keyup":_=D4;break;case"focusin":R="focus",_=Nc;break;case"focusout":R="blur",_=Nc;break;case"beforeblur":case"afterblur":_=Nc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=N4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=H4;break;case $g:case Dg:case zg:_=T4;break;case Ug:_=W4;break;case"scroll":_=_4;break;case"wheel":_=Y4;break;case"copy":case"cut":case"paste":_=I4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=km}var B=(t&4)!==0,K=!B&&e==="scroll",E=B?w!==null?w+"Capture":null:w;B=[];for(var y=h,k;y!==null;){k=y;var M=k.stateNode;if(k.tag===5&&M!==null&&(k=M,E!==null&&(M=ga(y,E),M!=null&&B.push(Aa(y,M,k)))),K)break;y=y.return}0<B.length&&(w=new _(w,R,null,n,g),v.push({event:w,listeners:B}))}}if(!(t&7)){e:{if(w=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",w&&n!==Cd&&(R=n.relatedTarget||n.fromElement)&&(ti(R)||R[ls]))break e;if((_||w)&&(w=g.window===g?g:(w=g.ownerDocument)?w.defaultView||w.parentWindow:window,_?(R=n.relatedTarget||n.toElement,_=h,R=R?ti(R):null,R!==null&&(K=yi(R),R!==K||R.tag!==5&&R.tag!==6)&&(R=null)):(_=null,R=h),_!==R)){if(B=wm,M="onMouseLeave",E="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(B=km,M="onPointerLeave",E="onPointerEnter",y="pointer"),K=_==null?w:Li(_),k=R==null?w:Li(R),w=new B(M,y+"leave",_,n,g),w.target=K,w.relatedTarget=k,M=null,ti(g)===h&&(B=new B(E,y+"enter",R,n,g),B.target=k,B.relatedTarget=K,M=B),K=M,_&&R)t:{for(B=_,E=R,y=0,k=B;k;k=ji(k))y++;for(k=0,M=E;M;M=ji(M))k++;for(;0<y-k;)B=ji(B),y--;for(;0<k-y;)E=ji(E),k--;for(;y--;){if(B===E||E!==null&&B===E.alternate)break t;B=ji(B),E=ji(E)}B=null}else B=null;_!==null&&Im(v,w,_,B,!1),R!==null&&K!==null&&Im(v,K,R,B,!0)}}e:{if(w=h?Li(h):window,_=w.nodeName&&w.nodeName.toLowerCase(),_==="select"||_==="input"&&w.type==="file")var b=ex;else if(Cm(w))if(Rg)b=sx;else{b=nx;var H=tx}else(_=w.nodeName)&&_.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(b=rx);if(b&&(b=b(e,h))){Ig(v,b,n,g);break e}H&&H(e,w,h),e==="focusout"&&(H=w._wrapperState)&&H.controlled&&w.type==="number"&&wd(w,"number",w.value)}switch(H=h?Li(h):window,e){case"focusin":(Cm(H)||H.contentEditable==="true")&&(Ri=H,Pd=h,ia=null);break;case"focusout":ia=Pd=Ri=null;break;case"mousedown":Id=!0;break;case"contextmenu":case"mouseup":case"dragend":Id=!1,Mm(v,n,g);break;case"selectionchange":if(ax)break;case"keydown":case"keyup":Mm(v,n,g)}var I;if(Gf)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Ii?Tg(e,n)&&(O="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(Mg&&n.locale!=="ko"&&(Ii||O!=="onCompositionStart"?O==="onCompositionEnd"&&Ii&&(I=bg()):(js=g,zf="value"in js?js.value:js.textContent,Ii=!0)),H=Wl(h,O),0<H.length&&(O=new Sm(O,e,null,n,g),v.push({event:O,listeners:H}),I?O.data=I:(I=Pg(n),I!==null&&(O.data=I)))),(I=K4?Q4(e,n):J4(e,n))&&(h=Wl(h,"onBeforeInput"),0<h.length&&(g=new Sm("onBeforeInput","beforeinput",null,n,g),v.push({event:g,listeners:h}),g.data=I))}Gg(v,t)})}function Aa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ga(e,n),i!=null&&r.unshift(Aa(e,i,s)),i=ga(e,t),i!=null&&r.push(Aa(e,i,s))),e=e.return}return r}function ji(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Im(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var u=n,d=u.alternate,h=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&h!==null&&(u=h,s?(d=ga(n,i),d!=null&&a.unshift(Aa(n,d,u))):s||(d=ga(n,i),d!=null&&a.push(Aa(n,d,u)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var dx=/\r\n?/g,fx=/\u0000|\uFFFD/g;function Rm(e){return(typeof e=="string"?e:""+e).replace(dx,`
`).replace(fx,"")}function al(e,t,n){if(t=Rm(t),Rm(e)!==t&&n)throw Error(le(425))}function Vl(){}var Rd=null,Bd=null;function Ld(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fd=typeof setTimeout=="function"?setTimeout:void 0,hx=typeof clearTimeout=="function"?clearTimeout:void 0,Bm=typeof Promise=="function"?Promise:void 0,px=typeof queueMicrotask=="function"?queueMicrotask:typeof Bm<"u"?function(e){return Bm.resolve(null).then(e).catch(mx)}:Fd;function mx(e){setTimeout(function(){throw e})}function Lc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),xa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);xa(t)}function Ps(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Lm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ao=Math.random().toString(36).slice(2),Hr="__reactFiber$"+Ao,Ea="__reactProps$"+Ao,ls="__reactContainer$"+Ao,Od="__reactEvents$"+Ao,gx="__reactListeners$"+Ao,yx="__reactHandles$"+Ao;function ti(e){var t=e[Hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ls]||n[Hr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Lm(e);e!==null;){if(n=e[Hr])return n;e=Lm(e)}return t}e=n,n=e.parentNode}return null}function Oa(e){return e=e[Hr]||e[ls],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Li(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(le(33))}function _u(e){return e[Ea]||null}var $d=[],Fi=-1;function Gs(e){return{current:e}}function xt(e){0>Fi||(e.current=$d[Fi],$d[Fi]=null,Fi--)}function pt(e,t){Fi++,$d[Fi]=e.current,e.current=t}var Ds={},mn=Gs(Ds),Tn=Gs(!1),ui=Ds;function so(e,t){var n=e.type.contextTypes;if(!n)return Ds;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pn(e){return e=e.childContextTypes,e!=null}function Yl(){xt(Tn),xt(mn)}function Fm(e,t,n){if(mn.current!==Ds)throw Error(le(168));pt(mn,t),pt(Tn,n)}function Vg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(le(108,t4(e)||"Unknown",s));return Mt({},n,r)}function Xl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ds,ui=mn.current,pt(mn,e),pt(Tn,Tn.current),!0}function Om(e,t,n){var r=e.stateNode;if(!r)throw Error(le(169));n?(e=Vg(e,t,ui),r.__reactInternalMemoizedMergedChildContext=e,xt(Tn),xt(mn),pt(mn,e)):xt(Tn),pt(Tn,n)}var Jr=null,ju=!1,Fc=!1;function Yg(e){Jr===null?Jr=[e]:Jr.push(e)}function vx(e){ju=!0,Yg(e)}function Ws(){if(!Fc&&Jr!==null){Fc=!0;var e=0,t=at;try{var n=Jr;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Jr=null,ju=!1}catch(s){throw Jr!==null&&(Jr=Jr.slice(e+1)),vg(Ff,Ws),s}finally{at=t,Fc=!1}}return null}var Oi=[],$i=0,Kl=null,Ql=0,ar=[],lr=0,ci=null,es=1,ts="";function qs(e,t){Oi[$i++]=Ql,Oi[$i++]=Kl,Kl=e,Ql=t}function Xg(e,t,n){ar[lr++]=es,ar[lr++]=ts,ar[lr++]=ci,ci=e;var r=es;e=ts;var s=32-jr(r)-1;r&=~(1<<s),n+=1;var i=32-jr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,es=1<<32-jr(t)+s|n<<s|r,ts=i+e}else es=1<<i|n<<s|r,ts=e}function Vf(e){e.return!==null&&(qs(e,1),Xg(e,1,0))}function Yf(e){for(;e===Kl;)Kl=Oi[--$i],Oi[$i]=null,Ql=Oi[--$i],Oi[$i]=null;for(;e===ci;)ci=ar[--lr],ar[lr]=null,ts=ar[--lr],ar[lr]=null,es=ar[--lr],ar[lr]=null}var Xn=null,Yn=null,kt=!1,Cr=null;function Kg(e,t){var n=cr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function $m(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xn=e,Yn=Ps(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xn=e,Yn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ci!==null?{id:es,overflow:ts}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=cr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Xn=e,Yn=null,!0):!1;default:return!1}}function Dd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function zd(e){if(kt){var t=Yn;if(t){var n=t;if(!$m(e,t)){if(Dd(e))throw Error(le(418));t=Ps(n.nextSibling);var r=Xn;t&&$m(e,t)?Kg(r,n):(e.flags=e.flags&-4097|2,kt=!1,Xn=e)}}else{if(Dd(e))throw Error(le(418));e.flags=e.flags&-4097|2,kt=!1,Xn=e}}}function Dm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xn=e}function ll(e){if(e!==Xn)return!1;if(!kt)return Dm(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ld(e.type,e.memoizedProps)),t&&(t=Yn)){if(Dd(e))throw Qg(),Error(le(418));for(;t;)Kg(e,t),t=Ps(t.nextSibling)}if(Dm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Yn=Ps(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Yn=null}}else Yn=Xn?Ps(e.stateNode.nextSibling):null;return!0}function Qg(){for(var e=Yn;e;)e=Ps(e.nextSibling)}function io(){Yn=Xn=null,kt=!1}function Xf(e){Cr===null?Cr=[e]:Cr.push(e)}var xx=hs.ReactCurrentBatchConfig;function Ho(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var r=n.stateNode}if(!r)throw Error(le(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var u=s.refs;a===null?delete u[i]:u[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,e))}return e}function ul(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zm(e){var t=e._init;return t(e._payload)}function Jg(e){function t(E,y){if(e){var k=E.deletions;k===null?(E.deletions=[y],E.flags|=16):k.push(y)}}function n(E,y){if(!e)return null;for(;y!==null;)t(E,y),y=y.sibling;return null}function r(E,y){for(E=new Map;y!==null;)y.key!==null?E.set(y.key,y):E.set(y.index,y),y=y.sibling;return E}function s(E,y){return E=Ls(E,y),E.index=0,E.sibling=null,E}function i(E,y,k){return E.index=k,e?(k=E.alternate,k!==null?(k=k.index,k<y?(E.flags|=2,y):k):(E.flags|=2,y)):(E.flags|=1048576,y)}function a(E){return e&&E.alternate===null&&(E.flags|=2),E}function u(E,y,k,M){return y===null||y.tag!==6?(y=Gc(k,E.mode,M),y.return=E,y):(y=s(y,k),y.return=E,y)}function d(E,y,k,M){var b=k.type;return b===Pi?g(E,y,k.props.children,M,k.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ws&&zm(b)===y.type)?(M=s(y,k.props),M.ref=Ho(E,y,k),M.return=E,M):(M=Tl(k.type,k.key,k.props,null,E.mode,M),M.ref=Ho(E,y,k),M.return=E,M)}function h(E,y,k,M){return y===null||y.tag!==4||y.stateNode.containerInfo!==k.containerInfo||y.stateNode.implementation!==k.implementation?(y=Wc(k,E.mode,M),y.return=E,y):(y=s(y,k.children||[]),y.return=E,y)}function g(E,y,k,M,b){return y===null||y.tag!==7?(y=ai(k,E.mode,M,b),y.return=E,y):(y=s(y,k),y.return=E,y)}function v(E,y,k){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Gc(""+y,E.mode,k),y.return=E,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Za:return k=Tl(y.type,y.key,y.props,null,E.mode,k),k.ref=Ho(E,null,y),k.return=E,k;case Ti:return y=Wc(y,E.mode,k),y.return=E,y;case ws:var M=y._init;return v(E,M(y._payload),k)}if(Qo(y)||Oo(y))return y=ai(y,E.mode,k,null),y.return=E,y;ul(E,y)}return null}function w(E,y,k,M){var b=y!==null?y.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return b!==null?null:u(E,y,""+k,M);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Za:return k.key===b?d(E,y,k,M):null;case Ti:return k.key===b?h(E,y,k,M):null;case ws:return b=k._init,w(E,y,b(k._payload),M)}if(Qo(k)||Oo(k))return b!==null?null:g(E,y,k,M,null);ul(E,k)}return null}function _(E,y,k,M,b){if(typeof M=="string"&&M!==""||typeof M=="number")return E=E.get(k)||null,u(y,E,""+M,b);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Za:return E=E.get(M.key===null?k:M.key)||null,d(y,E,M,b);case Ti:return E=E.get(M.key===null?k:M.key)||null,h(y,E,M,b);case ws:var H=M._init;return _(E,y,k,H(M._payload),b)}if(Qo(M)||Oo(M))return E=E.get(k)||null,g(y,E,M,b,null);ul(y,M)}return null}function R(E,y,k,M){for(var b=null,H=null,I=y,O=y=0,z=null;I!==null&&O<k.length;O++){I.index>O?(z=I,I=null):z=I.sibling;var W=w(E,I,k[O],M);if(W===null){I===null&&(I=z);break}e&&I&&W.alternate===null&&t(E,I),y=i(W,y,O),H===null?b=W:H.sibling=W,H=W,I=z}if(O===k.length)return n(E,I),kt&&qs(E,O),b;if(I===null){for(;O<k.length;O++)I=v(E,k[O],M),I!==null&&(y=i(I,y,O),H===null?b=I:H.sibling=I,H=I);return kt&&qs(E,O),b}for(I=r(E,I);O<k.length;O++)z=_(I,E,O,k[O],M),z!==null&&(e&&z.alternate!==null&&I.delete(z.key===null?O:z.key),y=i(z,y,O),H===null?b=z:H.sibling=z,H=z);return e&&I.forEach(function(X){return t(E,X)}),kt&&qs(E,O),b}function B(E,y,k,M){var b=Oo(k);if(typeof b!="function")throw Error(le(150));if(k=b.call(k),k==null)throw Error(le(151));for(var H=b=null,I=y,O=y=0,z=null,W=k.next();I!==null&&!W.done;O++,W=k.next()){I.index>O?(z=I,I=null):z=I.sibling;var X=w(E,I,W.value,M);if(X===null){I===null&&(I=z);break}e&&I&&X.alternate===null&&t(E,I),y=i(X,y,O),H===null?b=X:H.sibling=X,H=X,I=z}if(W.done)return n(E,I),kt&&qs(E,O),b;if(I===null){for(;!W.done;O++,W=k.next())W=v(E,W.value,M),W!==null&&(y=i(W,y,O),H===null?b=W:H.sibling=W,H=W);return kt&&qs(E,O),b}for(I=r(E,I);!W.done;O++,W=k.next())W=_(I,E,O,W.value,M),W!==null&&(e&&W.alternate!==null&&I.delete(W.key===null?O:W.key),y=i(W,y,O),H===null?b=W:H.sibling=W,H=W);return e&&I.forEach(function(Z){return t(E,Z)}),kt&&qs(E,O),b}function K(E,y,k,M){if(typeof k=="object"&&k!==null&&k.type===Pi&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case Za:e:{for(var b=k.key,H=y;H!==null;){if(H.key===b){if(b=k.type,b===Pi){if(H.tag===7){n(E,H.sibling),y=s(H,k.props.children),y.return=E,E=y;break e}}else if(H.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ws&&zm(b)===H.type){n(E,H.sibling),y=s(H,k.props),y.ref=Ho(E,H,k),y.return=E,E=y;break e}n(E,H);break}else t(E,H);H=H.sibling}k.type===Pi?(y=ai(k.props.children,E.mode,M,k.key),y.return=E,E=y):(M=Tl(k.type,k.key,k.props,null,E.mode,M),M.ref=Ho(E,y,k),M.return=E,E=M)}return a(E);case Ti:e:{for(H=k.key;y!==null;){if(y.key===H)if(y.tag===4&&y.stateNode.containerInfo===k.containerInfo&&y.stateNode.implementation===k.implementation){n(E,y.sibling),y=s(y,k.children||[]),y.return=E,E=y;break e}else{n(E,y);break}else t(E,y);y=y.sibling}y=Wc(k,E.mode,M),y.return=E,E=y}return a(E);case ws:return H=k._init,K(E,y,H(k._payload),M)}if(Qo(k))return R(E,y,k,M);if(Oo(k))return B(E,y,k,M);ul(E,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,y!==null&&y.tag===6?(n(E,y.sibling),y=s(y,k),y.return=E,E=y):(n(E,y),y=Gc(k,E.mode,M),y.return=E,E=y),a(E)):n(E,y)}return K}var oo=Jg(!0),Zg=Jg(!1),Jl=Gs(null),Zl=null,Di=null,Kf=null;function Qf(){Kf=Di=Zl=null}function Jf(e){var t=Jl.current;xt(Jl),e._currentValue=t}function Ud(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ki(e,t){Zl=e,Kf=Di=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Mn=!0),e.firstContext=null)}function hr(e){var t=e._currentValue;if(Kf!==e)if(e={context:e,memoizedValue:t,next:null},Di===null){if(Zl===null)throw Error(le(308));Di=e,Zl.dependencies={lanes:0,firstContext:e}}else Di=Di.next=e;return t}var ni=null;function Zf(e){ni===null?ni=[e]:ni.push(e)}function qg(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Zf(t)):(n.next=s.next,s.next=n),t.interleaved=n,us(e,r)}function us(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ss=!1;function qf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function rs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Is(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ze&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,us(e,n)}return s=r.interleaved,s===null?(t.next=t,Zf(r)):(t.next=s.next,s.next=t),r.interleaved=t,us(e,n)}function Cl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Of(e,n)}}function Um(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ql(e,t,n,r){var s=e.updateQueue;Ss=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var d=u,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==a&&(u===null?g.firstBaseUpdate=h:u.next=h,g.lastBaseUpdate=d))}if(i!==null){var v=s.baseState;a=0,g=h=d=null,u=i;do{var w=u.lane,_=u.eventTime;if((r&w)===w){g!==null&&(g=g.next={eventTime:_,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var R=e,B=u;switch(w=t,_=n,B.tag){case 1:if(R=B.payload,typeof R=="function"){v=R.call(_,v,w);break e}v=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=B.payload,w=typeof R=="function"?R.call(_,v,w):R,w==null)break e;v=Mt({},v,w);break e;case 2:Ss=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,w=s.effects,w===null?s.effects=[u]:w.push(u))}else _={eventTime:_,lane:w,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(h=g=_,d=v):g=g.next=_,a|=w;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;w=u,u=w.next,w.next=null,s.lastBaseUpdate=w,s.shared.pending=null}}while(!0);if(g===null&&(d=v),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);fi|=a,e.lanes=a,e.memoizedState=v}}function Hm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(le(191,s));s.call(r)}}}var $a={},Wr=Gs($a),Ca=Gs($a),_a=Gs($a);function ri(e){if(e===$a)throw Error(le(174));return e}function eh(e,t){switch(pt(_a,t),pt(Ca,e),pt(Wr,$a),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:kd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=kd(t,e)}xt(Wr),pt(Wr,t)}function ao(){xt(Wr),xt(Ca),xt(_a)}function t2(e){ri(_a.current);var t=ri(Wr.current),n=kd(t,e.type);t!==n&&(pt(Ca,e),pt(Wr,n))}function th(e){Ca.current===e&&(xt(Wr),xt(Ca))}var jt=Gs(0);function eu(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Oc=[];function nh(){for(var e=0;e<Oc.length;e++)Oc[e]._workInProgressVersionPrimary=null;Oc.length=0}var _l=hs.ReactCurrentDispatcher,$c=hs.ReactCurrentBatchConfig,di=0,Nt=null,Yt=null,tn=null,tu=!1,oa=!1,ja=0,wx=0;function cn(){throw Error(le(321))}function rh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!br(e[n],t[n]))return!1;return!0}function sh(e,t,n,r,s,i){if(di=i,Nt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_l.current=e===null||e.memoizedState===null?Ex:Cx,e=n(r,s),oa){i=0;do{if(oa=!1,ja=0,25<=i)throw Error(le(301));i+=1,tn=Yt=null,t.updateQueue=null,_l.current=_x,e=n(r,s)}while(oa)}if(_l.current=nu,t=Yt!==null&&Yt.next!==null,di=0,tn=Yt=Nt=null,tu=!1,t)throw Error(le(300));return e}function ih(){var e=ja!==0;return ja=0,e}function zr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tn===null?Nt.memoizedState=tn=e:tn=tn.next=e,tn}function pr(){if(Yt===null){var e=Nt.alternate;e=e!==null?e.memoizedState:null}else e=Yt.next;var t=tn===null?Nt.memoizedState:tn.next;if(t!==null)tn=t,Yt=e;else{if(e===null)throw Error(le(310));Yt=e,e={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},tn===null?Nt.memoizedState=tn=e:tn=tn.next=e}return tn}function Na(e,t){return typeof t=="function"?t(e):t}function Dc(e){var t=pr(),n=t.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=e;var r=Yt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var u=a=null,d=null,h=i;do{var g=h.lane;if((di&g)===g)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var v={lane:g,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(u=d=v,a=r):d=d.next=v,Nt.lanes|=g,fi|=g}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=u,br(r,t.memoizedState)||(Mn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Nt.lanes|=i,fi|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function zc(e){var t=pr(),n=t.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);br(i,t.memoizedState)||(Mn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function n2(){}function r2(e,t){var n=Nt,r=pr(),s=t(),i=!br(r.memoizedState,s);if(i&&(r.memoizedState=s,Mn=!0),r=r.queue,oh(o2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||tn!==null&&tn.memoizedState.tag&1){if(n.flags|=2048,ba(9,i2.bind(null,n,r,s,t),void 0,null),nn===null)throw Error(le(349));di&30||s2(n,t,s)}return s}function s2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function i2(e,t,n,r){t.value=n,t.getSnapshot=r,a2(t)&&l2(e)}function o2(e,t,n){return n(function(){a2(t)&&l2(e)})}function a2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!br(e,n)}catch{return!0}}function l2(e){var t=us(e,1);t!==null&&Nr(t,e,1,-1)}function Gm(e){var t=zr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:e},t.queue=e,e=e.dispatch=Ax.bind(null,Nt,e),[t.memoizedState,e]}function ba(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function u2(){return pr().memoizedState}function jl(e,t,n,r){var s=zr();Nt.flags|=e,s.memoizedState=ba(1|t,n,void 0,r===void 0?null:r)}function Nu(e,t,n,r){var s=pr();r=r===void 0?null:r;var i=void 0;if(Yt!==null){var a=Yt.memoizedState;if(i=a.destroy,r!==null&&rh(r,a.deps)){s.memoizedState=ba(t,n,i,r);return}}Nt.flags|=e,s.memoizedState=ba(1|t,n,i,r)}function Wm(e,t){return jl(8390656,8,e,t)}function oh(e,t){return Nu(2048,8,e,t)}function c2(e,t){return Nu(4,2,e,t)}function d2(e,t){return Nu(4,4,e,t)}function f2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function h2(e,t,n){return n=n!=null?n.concat([e]):null,Nu(4,4,f2.bind(null,t,e),n)}function ah(){}function p2(e,t){var n=pr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&rh(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function m2(e,t){var n=pr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&rh(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function g2(e,t,n){return di&21?(br(n,t)||(n=Sg(),Nt.lanes|=n,fi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Mn=!0),e.memoizedState=n)}function Sx(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=$c.transition;$c.transition={};try{e(!1),t()}finally{at=n,$c.transition=r}}function y2(){return pr().memoizedState}function kx(e,t,n){var r=Bs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},v2(e))x2(t,n);else if(n=qg(e,t,n,r),n!==null){var s=vn();Nr(n,e,r,s),w2(n,t,r)}}function Ax(e,t,n){var r=Bs(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(v2(e))x2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,u=i(a,n);if(s.hasEagerState=!0,s.eagerState=u,br(u,a)){var d=t.interleaved;d===null?(s.next=s,Zf(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=qg(e,t,s,r),n!==null&&(s=vn(),Nr(n,e,r,s),w2(n,t,r))}}function v2(e){var t=e.alternate;return e===Nt||t!==null&&t===Nt}function x2(e,t){oa=tu=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function w2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Of(e,n)}}var nu={readContext:hr,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useInsertionEffect:cn,useLayoutEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useMutableSource:cn,useSyncExternalStore:cn,useId:cn,unstable_isNewReconciler:!1},Ex={readContext:hr,useCallback:function(e,t){return zr().memoizedState=[e,t===void 0?null:t],e},useContext:hr,useEffect:Wm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,jl(4194308,4,f2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return jl(4194308,4,e,t)},useInsertionEffect:function(e,t){return jl(4,2,e,t)},useMemo:function(e,t){var n=zr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=zr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=kx.bind(null,Nt,e),[r.memoizedState,e]},useRef:function(e){var t=zr();return e={current:e},t.memoizedState=e},useState:Gm,useDebugValue:ah,useDeferredValue:function(e){return zr().memoizedState=e},useTransition:function(){var e=Gm(!1),t=e[0];return e=Sx.bind(null,e[1]),zr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Nt,s=zr();if(kt){if(n===void 0)throw Error(le(407));n=n()}else{if(n=t(),nn===null)throw Error(le(349));di&30||s2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Wm(o2.bind(null,r,i,e),[e]),r.flags|=2048,ba(9,i2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=zr(),t=nn.identifierPrefix;if(kt){var n=ts,r=es;n=(r&~(1<<32-jr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ja++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=wx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Cx={readContext:hr,useCallback:p2,useContext:hr,useEffect:oh,useImperativeHandle:h2,useInsertionEffect:c2,useLayoutEffect:d2,useMemo:m2,useReducer:Dc,useRef:u2,useState:function(){return Dc(Na)},useDebugValue:ah,useDeferredValue:function(e){var t=pr();return g2(t,Yt.memoizedState,e)},useTransition:function(){var e=Dc(Na)[0],t=pr().memoizedState;return[e,t]},useMutableSource:n2,useSyncExternalStore:r2,useId:y2,unstable_isNewReconciler:!1},_x={readContext:hr,useCallback:p2,useContext:hr,useEffect:oh,useImperativeHandle:h2,useInsertionEffect:c2,useLayoutEffect:d2,useMemo:m2,useReducer:zc,useRef:u2,useState:function(){return zc(Na)},useDebugValue:ah,useDeferredValue:function(e){var t=pr();return Yt===null?t.memoizedState=e:g2(t,Yt.memoizedState,e)},useTransition:function(){var e=zc(Na)[0],t=pr().memoizedState;return[e,t]},useMutableSource:n2,useSyncExternalStore:r2,useId:y2,unstable_isNewReconciler:!1};function Ar(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Hd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Mt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var bu={isMounted:function(e){return(e=e._reactInternals)?yi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Bs(e),i=rs(r,s);i.payload=t,n!=null&&(i.callback=n),t=Is(e,i,s),t!==null&&(Nr(t,e,s,r),Cl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Bs(e),i=rs(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Is(e,i,s),t!==null&&(Nr(t,e,s,r),Cl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=vn(),r=Bs(e),s=rs(n,r);s.tag=2,t!=null&&(s.callback=t),t=Is(e,s,r),t!==null&&(Nr(t,e,r,n),Cl(t,e,r))}};function Vm(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!Sa(n,r)||!Sa(s,i):!0}function S2(e,t,n){var r=!1,s=Ds,i=t.contextType;return typeof i=="object"&&i!==null?i=hr(i):(s=Pn(t)?ui:mn.current,r=t.contextTypes,i=(r=r!=null)?so(e,s):Ds),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=bu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ym(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&bu.enqueueReplaceState(t,t.state,null)}function Gd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},qf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=hr(i):(i=Pn(t)?ui:mn.current,s.context=so(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Hd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&bu.enqueueReplaceState(s,s.state,null),ql(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do n+=e4(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Uc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Wd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var jx=typeof WeakMap=="function"?WeakMap:Map;function k2(e,t,n){n=rs(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){su||(su=!0,tf=r),Wd(e,t)},n}function A2(e,t,n){n=rs(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Wd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Wd(e,t),typeof r!="function"&&(Rs===null?Rs=new Set([this]):Rs.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Xm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new jx;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=zx.bind(null,e,t,n),t.then(e,e))}function Km(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Qm(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=rs(-1,1),t.tag=2,Is(n,t,1))),n.lanes|=1),e)}var Nx=hs.ReactCurrentOwner,Mn=!1;function yn(e,t,n,r){t.child=e===null?Zg(t,null,n,r):oo(t,e.child,n,r)}function Jm(e,t,n,r,s){n=n.render;var i=t.ref;return Ki(t,s),r=sh(e,t,n,r,i,s),n=ih(),e!==null&&!Mn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cs(e,t,s)):(kt&&n&&Vf(t),t.flags|=1,yn(e,t,r,s),t.child)}function Zm(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!mh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,E2(e,t,i,r,s)):(e=Tl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Sa,n(a,r)&&e.ref===t.ref)return cs(e,t,s)}return t.flags|=1,e=Ls(i,r),e.ref=t.ref,e.return=t,t.child=e}function E2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Sa(i,r)&&e.ref===t.ref)if(Mn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Mn=!0);else return t.lanes=e.lanes,cs(e,t,s)}return Vd(e,t,n,r,s)}function C2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(Ui,Vn),Vn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,pt(Ui,Vn),Vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,pt(Ui,Vn),Vn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,pt(Ui,Vn),Vn|=r;return yn(e,t,s,n),t.child}function _2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Vd(e,t,n,r,s){var i=Pn(n)?ui:mn.current;return i=so(t,i),Ki(t,s),n=sh(e,t,n,r,i,s),r=ih(),e!==null&&!Mn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cs(e,t,s)):(kt&&r&&Vf(t),t.flags|=1,yn(e,t,n,s),t.child)}function qm(e,t,n,r,s){if(Pn(n)){var i=!0;Xl(t)}else i=!1;if(Ki(t,s),t.stateNode===null)Nl(e,t),S2(t,n,r),Gd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,u=t.memoizedProps;a.props=u;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=hr(h):(h=Pn(n)?ui:mn.current,h=so(t,h));var g=n.getDerivedStateFromProps,v=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||d!==h)&&Ym(t,a,r,h),Ss=!1;var w=t.memoizedState;a.state=w,ql(t,r,a,s),d=t.memoizedState,u!==r||w!==d||Tn.current||Ss?(typeof g=="function"&&(Hd(t,n,g,r),d=t.memoizedState),(u=Ss||Vm(t,n,u,r,w,d,h))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=u):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,e2(e,t),u=t.memoizedProps,h=t.type===t.elementType?u:Ar(t.type,u),a.props=h,v=t.pendingProps,w=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=hr(d):(d=Pn(n)?ui:mn.current,d=so(t,d));var _=n.getDerivedStateFromProps;(g=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==v||w!==d)&&Ym(t,a,r,d),Ss=!1,w=t.memoizedState,a.state=w,ql(t,r,a,s);var R=t.memoizedState;u!==v||w!==R||Tn.current||Ss?(typeof _=="function"&&(Hd(t,n,_,r),R=t.memoizedState),(h=Ss||Vm(t,n,h,r,w,R,d)||!1)?(g||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,R,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,R,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=R),a.props=r,a.state=R,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||u===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),r=!1)}return Yd(e,t,n,r,i,s)}function Yd(e,t,n,r,s,i){_2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&Om(t,n,!1),cs(e,t,i);r=t.stateNode,Nx.current=t;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=oo(t,e.child,null,i),t.child=oo(t,null,u,i)):yn(e,t,u,i),t.memoizedState=r.state,s&&Om(t,n,!0),t.child}function j2(e){var t=e.stateNode;t.pendingContext?Fm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Fm(e,t.context,!1),eh(e,t.containerInfo)}function e1(e,t,n,r,s){return io(),Xf(s),t.flags|=256,yn(e,t,n,r),t.child}var Xd={dehydrated:null,treeContext:null,retryLane:0};function Kd(e){return{baseLanes:e,cachePool:null,transitions:null}}function N2(e,t,n){var r=t.pendingProps,s=jt.current,i=!1,a=(t.flags&128)!==0,u;if((u=a)||(u=e!==null&&e.memoizedState===null?!1:(s&2)!==0),u?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),pt(jt,s&1),e===null)return zd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Pu(a,r,0,null),e=ai(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Kd(n),t.memoizedState=Xd,e):lh(t,a));if(s=e.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return bx(e,t,a,r,u,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,u=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Ls(s,d),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?i=Ls(u,i):(i=ai(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Kd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Xd,r}return i=e.child,e=i.sibling,r=Ls(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function lh(e,t){return t=Pu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cl(e,t,n,r){return r!==null&&Xf(r),oo(t,e.child,null,n),e=lh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function bx(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Uc(Error(le(422))),cl(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Pu({mode:"visible",children:r.children},s,0,null),i=ai(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&oo(t,e.child,null,a),t.child.memoizedState=Kd(a),t.memoizedState=Xd,i);if(!(t.mode&1))return cl(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,i=Error(le(419)),r=Uc(i,r,void 0),cl(e,t,a,r)}if(u=(a&e.childLanes)!==0,Mn||u){if(r=nn,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,us(e,s),Nr(r,e,s,-1))}return ph(),r=Uc(Error(le(421))),cl(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Ux.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Yn=Ps(s.nextSibling),Xn=t,kt=!0,Cr=null,e!==null&&(ar[lr++]=es,ar[lr++]=ts,ar[lr++]=ci,es=e.id,ts=e.overflow,ci=t),t=lh(t,r.children),t.flags|=4096,t)}function t1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ud(e.return,t,n)}function Hc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function b2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(yn(e,t,r.children,n),r=jt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&t1(e,n,t);else if(e.tag===19)t1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(pt(jt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&eu(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Hc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&eu(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Hc(t,!0,n,null,i);break;case"together":Hc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Nl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),fi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(le(153));if(t.child!==null){for(e=t.child,n=Ls(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ls(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Mx(e,t,n){switch(t.tag){case 3:j2(t),io();break;case 5:t2(t);break;case 1:Pn(t.type)&&Xl(t);break;case 4:eh(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;pt(Jl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(pt(jt,jt.current&1),t.flags|=128,null):n&t.child.childLanes?N2(e,t,n):(pt(jt,jt.current&1),e=cs(e,t,n),e!==null?e.sibling:null);pt(jt,jt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return b2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),pt(jt,jt.current),r)break;return null;case 22:case 23:return t.lanes=0,C2(e,t,n)}return cs(e,t,n)}var M2,Qd,T2,P2;M2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qd=function(){};T2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ri(Wr.current);var i=null;switch(n){case"input":s=vd(e,s),r=vd(e,r),i=[];break;case"select":s=Mt({},s,{value:void 0}),r=Mt({},r,{value:void 0}),i=[];break;case"textarea":s=Sd(e,s),r=Sd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Vl)}Ad(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var u=s[h];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(pa.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(u=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==u&&(d!=null||u!=null))if(h==="style")if(u){for(a in u)!u.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&u[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(pa.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&vt("scroll",e),i||u===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};P2=function(e,t,n,r){n!==r&&(t.flags|=4)};function Go(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function dn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Tx(e,t,n){var r=t.pendingProps;switch(Yf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(t),null;case 1:return Pn(t.type)&&Yl(),dn(t),null;case 3:return r=t.stateNode,ao(),xt(Tn),xt(mn),nh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ll(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cr!==null&&(sf(Cr),Cr=null))),Qd(e,t),dn(t),null;case 5:th(t);var s=ri(_a.current);if(n=t.type,e!==null&&t.stateNode!=null)T2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(le(166));return dn(t),null}if(e=ri(Wr.current),ll(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Hr]=t,r[Ea]=i,e=(t.mode&1)!==0,n){case"dialog":vt("cancel",r),vt("close",r);break;case"iframe":case"object":case"embed":vt("load",r);break;case"video":case"audio":for(s=0;s<Zo.length;s++)vt(Zo[s],r);break;case"source":vt("error",r);break;case"img":case"image":case"link":vt("error",r),vt("load",r);break;case"details":vt("toggle",r);break;case"input":cm(r,i),vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},vt("invalid",r);break;case"textarea":fm(r,i),vt("invalid",r)}Ad(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var u=i[a];a==="children"?typeof u=="string"?r.textContent!==u&&(i.suppressHydrationWarning!==!0&&al(r.textContent,u,e),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(i.suppressHydrationWarning!==!0&&al(r.textContent,u,e),s=["children",""+u]):pa.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&vt("scroll",r)}switch(n){case"input":qa(r),dm(r,i,!0);break;case"textarea":qa(r),hm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Vl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=og(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Hr]=t,e[Ea]=r,M2(e,t,!1,!1),t.stateNode=e;e:{switch(a=Ed(n,r),n){case"dialog":vt("cancel",e),vt("close",e),s=r;break;case"iframe":case"object":case"embed":vt("load",e),s=r;break;case"video":case"audio":for(s=0;s<Zo.length;s++)vt(Zo[s],e);s=r;break;case"source":vt("error",e),s=r;break;case"img":case"image":case"link":vt("error",e),vt("load",e),s=r;break;case"details":vt("toggle",e),s=r;break;case"input":cm(e,r),s=vd(e,r),vt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Mt({},r,{value:void 0}),vt("invalid",e);break;case"textarea":fm(e,r),s=Sd(e,r),vt("invalid",e);break;default:s=r}Ad(n,s),u=s;for(i in u)if(u.hasOwnProperty(i)){var d=u[i];i==="style"?ug(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&ag(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&ma(e,d):typeof d=="number"&&ma(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(pa.hasOwnProperty(i)?d!=null&&i==="onScroll"&&vt("scroll",e):d!=null&&Pf(e,i,d,a))}switch(n){case"input":qa(e),dm(e,r,!1);break;case"textarea":qa(e),hm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+$s(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Wi(e,!!r.multiple,i,!1):r.defaultValue!=null&&Wi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Vl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dn(t),null;case 6:if(e&&t.stateNode!=null)P2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(le(166));if(n=ri(_a.current),ri(Wr.current),ll(t)){if(r=t.stateNode,n=t.memoizedProps,r[Hr]=t,(i=r.nodeValue!==n)&&(e=Xn,e!==null))switch(e.tag){case 3:al(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&al(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Hr]=t,t.stateNode=r}return dn(t),null;case 13:if(xt(jt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&Yn!==null&&t.mode&1&&!(t.flags&128))Qg(),io(),t.flags|=98560,i=!1;else if(i=ll(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(le(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(le(317));i[Hr]=t}else io(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dn(t),i=!1}else Cr!==null&&(sf(Cr),Cr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||jt.current&1?Kt===0&&(Kt=3):ph())),t.updateQueue!==null&&(t.flags|=4),dn(t),null);case 4:return ao(),Qd(e,t),e===null&&ka(t.stateNode.containerInfo),dn(t),null;case 10:return Jf(t.type._context),dn(t),null;case 17:return Pn(t.type)&&Yl(),dn(t),null;case 19:if(xt(jt),i=t.memoizedState,i===null)return dn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Go(i,!1);else{if(Kt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=eu(e),a!==null){for(t.flags|=128,Go(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return pt(jt,jt.current&1|2),t.child}e=e.sibling}i.tail!==null&&$t()>uo&&(t.flags|=128,r=!0,Go(i,!1),t.lanes=4194304)}else{if(!r)if(e=eu(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Go(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!kt)return dn(t),null}else 2*$t()-i.renderingStartTime>uo&&n!==1073741824&&(t.flags|=128,r=!0,Go(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$t(),t.sibling=null,n=jt.current,pt(jt,r?n&1|2:n&1),t):(dn(t),null);case 22:case 23:return hh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Vn&1073741824&&(dn(t),t.subtreeFlags&6&&(t.flags|=8192)):dn(t),null;case 24:return null;case 25:return null}throw Error(le(156,t.tag))}function Px(e,t){switch(Yf(t),t.tag){case 1:return Pn(t.type)&&Yl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ao(),xt(Tn),xt(mn),nh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return th(t),null;case 13:if(xt(jt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(le(340));io()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xt(jt),null;case 4:return ao(),null;case 10:return Jf(t.type._context),null;case 22:case 23:return hh(),null;case 24:return null;default:return null}}var dl=!1,pn=!1,Ix=typeof WeakSet=="function"?WeakSet:Set,ke=null;function zi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Bt(e,t,r)}else n.current=null}function Jd(e,t,n){try{n()}catch(r){Bt(e,t,r)}}var n1=!1;function Rx(e,t){if(Rd=Hl,e=Fg(),Wf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,u=-1,d=-1,h=0,g=0,v=e,w=null;t:for(;;){for(var _;v!==n||s!==0&&v.nodeType!==3||(u=a+s),v!==i||r!==0&&v.nodeType!==3||(d=a+r),v.nodeType===3&&(a+=v.nodeValue.length),(_=v.firstChild)!==null;)w=v,v=_;for(;;){if(v===e)break t;if(w===n&&++h===s&&(u=a),w===i&&++g===r&&(d=a),(_=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=_}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bd={focusedElem:e,selectionRange:n},Hl=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var R=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var B=R.memoizedProps,K=R.memoizedState,E=t.stateNode,y=E.getSnapshotBeforeUpdate(t.elementType===t.type?B:Ar(t.type,B),K);E.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(M){Bt(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return R=n1,n1=!1,R}function aa(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Jd(t,n,i)}s=s.next}while(s!==r)}}function Mu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Zd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function I2(e){var t=e.alternate;t!==null&&(e.alternate=null,I2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Hr],delete t[Ea],delete t[Od],delete t[gx],delete t[yx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function R2(e){return e.tag===5||e.tag===3||e.tag===4}function r1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||R2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Vl));else if(r!==4&&(e=e.child,e!==null))for(qd(e,t,n),e=e.sibling;e!==null;)qd(e,t,n),e=e.sibling}function ef(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ef(e,t,n),e=e.sibling;e!==null;)ef(e,t,n),e=e.sibling}var an=null,Er=!1;function vs(e,t,n){for(n=n.child;n!==null;)B2(e,t,n),n=n.sibling}function B2(e,t,n){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(ku,n)}catch{}switch(n.tag){case 5:pn||zi(n,t);case 6:var r=an,s=Er;an=null,vs(e,t,n),an=r,Er=s,an!==null&&(Er?(e=an,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):an.removeChild(n.stateNode));break;case 18:an!==null&&(Er?(e=an,n=n.stateNode,e.nodeType===8?Lc(e.parentNode,n):e.nodeType===1&&Lc(e,n),xa(e)):Lc(an,n.stateNode));break;case 4:r=an,s=Er,an=n.stateNode.containerInfo,Er=!0,vs(e,t,n),an=r,Er=s;break;case 0:case 11:case 14:case 15:if(!pn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Jd(n,t,a),s=s.next}while(s!==r)}vs(e,t,n);break;case 1:if(!pn&&(zi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Bt(n,t,u)}vs(e,t,n);break;case 21:vs(e,t,n);break;case 22:n.mode&1?(pn=(r=pn)||n.memoizedState!==null,vs(e,t,n),pn=r):vs(e,t,n);break;default:vs(e,t,n)}}function s1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Ix),t.forEach(function(r){var s=Hx.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function kr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,u=a;e:for(;u!==null;){switch(u.tag){case 5:an=u.stateNode,Er=!1;break e;case 3:an=u.stateNode.containerInfo,Er=!0;break e;case 4:an=u.stateNode.containerInfo,Er=!0;break e}u=u.return}if(an===null)throw Error(le(160));B2(i,a,s),an=null,Er=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){Bt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)L2(t,e),t=t.sibling}function L2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(kr(t,e),Br(e),r&4){try{aa(3,e,e.return),Mu(3,e)}catch(B){Bt(e,e.return,B)}try{aa(5,e,e.return)}catch(B){Bt(e,e.return,B)}}break;case 1:kr(t,e),Br(e),r&512&&n!==null&&zi(n,n.return);break;case 5:if(kr(t,e),Br(e),r&512&&n!==null&&zi(n,n.return),e.flags&32){var s=e.stateNode;try{ma(s,"")}catch(B){Bt(e,e.return,B)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,u=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{u==="input"&&i.type==="radio"&&i.name!=null&&sg(s,i),Ed(u,a);var h=Ed(u,i);for(a=0;a<d.length;a+=2){var g=d[a],v=d[a+1];g==="style"?ug(s,v):g==="dangerouslySetInnerHTML"?ag(s,v):g==="children"?ma(s,v):Pf(s,g,v,h)}switch(u){case"input":xd(s,i);break;case"textarea":ig(s,i);break;case"select":var w=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Wi(s,!!i.multiple,_,!1):w!==!!i.multiple&&(i.defaultValue!=null?Wi(s,!!i.multiple,i.defaultValue,!0):Wi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ea]=i}catch(B){Bt(e,e.return,B)}}break;case 6:if(kr(t,e),Br(e),r&4){if(e.stateNode===null)throw Error(le(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(B){Bt(e,e.return,B)}}break;case 3:if(kr(t,e),Br(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{xa(t.containerInfo)}catch(B){Bt(e,e.return,B)}break;case 4:kr(t,e),Br(e);break;case 13:kr(t,e),Br(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(dh=$t())),r&4&&s1(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(pn=(h=pn)||g,kr(t,e),pn=h):kr(t,e),Br(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!g&&e.mode&1)for(ke=e,g=e.child;g!==null;){for(v=ke=g;ke!==null;){switch(w=ke,_=w.child,w.tag){case 0:case 11:case 14:case 15:aa(4,w,w.return);break;case 1:zi(w,w.return);var R=w.stateNode;if(typeof R.componentWillUnmount=="function"){r=w,n=w.return;try{t=r,R.props=t.memoizedProps,R.state=t.memoizedState,R.componentWillUnmount()}catch(B){Bt(r,n,B)}}break;case 5:zi(w,w.return);break;case 22:if(w.memoizedState!==null){o1(v);continue}}_!==null?(_.return=w,ke=_):o1(v)}g=g.sibling}e:for(g=null,v=e;;){if(v.tag===5){if(g===null){g=v;try{s=v.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(u=v.stateNode,d=v.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=lg("display",a))}catch(B){Bt(e,e.return,B)}}}else if(v.tag===6){if(g===null)try{v.stateNode.nodeValue=h?"":v.memoizedProps}catch(B){Bt(e,e.return,B)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;g===v&&(g=null),v=v.return}g===v&&(g=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:kr(t,e),Br(e),r&4&&s1(e);break;case 21:break;default:kr(t,e),Br(e)}}function Br(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(R2(n)){var r=n;break e}n=n.return}throw Error(le(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ma(s,""),r.flags&=-33);var i=r1(e);ef(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,u=r1(e);qd(e,u,a);break;default:throw Error(le(161))}}catch(d){Bt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Bx(e,t,n){ke=e,F2(e)}function F2(e,t,n){for(var r=(e.mode&1)!==0;ke!==null;){var s=ke,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||dl;if(!a){var u=s.alternate,d=u!==null&&u.memoizedState!==null||pn;u=dl;var h=pn;if(dl=a,(pn=d)&&!h)for(ke=s;ke!==null;)a=ke,d=a.child,a.tag===22&&a.memoizedState!==null?a1(s):d!==null?(d.return=a,ke=d):a1(s);for(;i!==null;)ke=i,F2(i),i=i.sibling;ke=s,dl=u,pn=h}i1(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ke=i):i1(e)}}function i1(e){for(;ke!==null;){var t=ke;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pn||Mu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Ar(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Hm(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Hm(t,a,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var g=h.memoizedState;if(g!==null){var v=g.dehydrated;v!==null&&xa(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}pn||t.flags&512&&Zd(t)}catch(w){Bt(t,t.return,w)}}if(t===e){ke=null;break}if(n=t.sibling,n!==null){n.return=t.return,ke=n;break}ke=t.return}}function o1(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ke=n;break}ke=t.return}}function a1(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Mu(4,t)}catch(d){Bt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){Bt(t,s,d)}}var i=t.return;try{Zd(t)}catch(d){Bt(t,i,d)}break;case 5:var a=t.return;try{Zd(t)}catch(d){Bt(t,a,d)}}}catch(d){Bt(t,t.return,d)}if(t===e){ke=null;break}var u=t.sibling;if(u!==null){u.return=t.return,ke=u;break}ke=t.return}}var Lx=Math.ceil,ru=hs.ReactCurrentDispatcher,uh=hs.ReactCurrentOwner,fr=hs.ReactCurrentBatchConfig,Ze=0,nn=null,Ut=null,ln=0,Vn=0,Ui=Gs(0),Kt=0,Ma=null,fi=0,Tu=0,ch=0,la=null,bn=null,dh=0,uo=1/0,Qr=null,su=!1,tf=null,Rs=null,fl=!1,Ns=null,iu=0,ua=0,nf=null,bl=-1,Ml=0;function vn(){return Ze&6?$t():bl!==-1?bl:bl=$t()}function Bs(e){return e.mode&1?Ze&2&&ln!==0?ln&-ln:xx.transition!==null?(Ml===0&&(Ml=Sg()),Ml):(e=at,e!==0||(e=window.event,e=e===void 0?16:Ng(e.type)),e):1}function Nr(e,t,n,r){if(50<ua)throw ua=0,nf=null,Error(le(185));La(e,n,r),(!(Ze&2)||e!==nn)&&(e===nn&&(!(Ze&2)&&(Tu|=n),Kt===4&&Es(e,ln)),In(e,r),n===1&&Ze===0&&!(t.mode&1)&&(uo=$t()+500,ju&&Ws()))}function In(e,t){var n=e.callbackNode;x4(e,t);var r=Ul(e,e===nn?ln:0);if(r===0)n!==null&&gm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&gm(n),t===1)e.tag===0?vx(l1.bind(null,e)):Yg(l1.bind(null,e)),px(function(){!(Ze&6)&&Ws()}),n=null;else{switch(kg(r)){case 1:n=Ff;break;case 4:n=xg;break;case 16:n=zl;break;case 536870912:n=wg;break;default:n=zl}n=W2(n,O2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function O2(e,t){if(bl=-1,Ml=0,Ze&6)throw Error(le(327));var n=e.callbackNode;if(Qi()&&e.callbackNode!==n)return null;var r=Ul(e,e===nn?ln:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ou(e,r);else{t=r;var s=Ze;Ze|=2;var i=D2();(nn!==e||ln!==t)&&(Qr=null,uo=$t()+500,oi(e,t));do try{$x();break}catch(u){$2(e,u)}while(!0);Qf(),ru.current=i,Ze=s,Ut!==null?t=0:(nn=null,ln=0,t=Kt)}if(t!==0){if(t===2&&(s=bd(e),s!==0&&(r=s,t=rf(e,s))),t===1)throw n=Ma,oi(e,0),Es(e,r),In(e,$t()),n;if(t===6)Es(e,r);else{if(s=e.current.alternate,!(r&30)&&!Fx(s)&&(t=ou(e,r),t===2&&(i=bd(e),i!==0&&(r=i,t=rf(e,i))),t===1))throw n=Ma,oi(e,0),Es(e,r),In(e,$t()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(le(345));case 2:ei(e,bn,Qr);break;case 3:if(Es(e,r),(r&130023424)===r&&(t=dh+500-$t(),10<t)){if(Ul(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){vn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Fd(ei.bind(null,e,bn,Qr),t);break}ei(e,bn,Qr);break;case 4:if(Es(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-jr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lx(r/1960))-r,10<r){e.timeoutHandle=Fd(ei.bind(null,e,bn,Qr),r);break}ei(e,bn,Qr);break;case 5:ei(e,bn,Qr);break;default:throw Error(le(329))}}}return In(e,$t()),e.callbackNode===n?O2.bind(null,e):null}function rf(e,t){var n=la;return e.current.memoizedState.isDehydrated&&(oi(e,t).flags|=256),e=ou(e,t),e!==2&&(t=bn,bn=n,t!==null&&sf(t)),e}function sf(e){bn===null?bn=e:bn.push.apply(bn,e)}function Fx(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!br(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Es(e,t){for(t&=~ch,t&=~Tu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jr(t),r=1<<n;e[n]=-1,t&=~r}}function l1(e){if(Ze&6)throw Error(le(327));Qi();var t=Ul(e,0);if(!(t&1))return In(e,$t()),null;var n=ou(e,t);if(e.tag!==0&&n===2){var r=bd(e);r!==0&&(t=r,n=rf(e,r))}if(n===1)throw n=Ma,oi(e,0),Es(e,t),In(e,$t()),n;if(n===6)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ei(e,bn,Qr),In(e,$t()),null}function fh(e,t){var n=Ze;Ze|=1;try{return e(t)}finally{Ze=n,Ze===0&&(uo=$t()+500,ju&&Ws())}}function hi(e){Ns!==null&&Ns.tag===0&&!(Ze&6)&&Qi();var t=Ze;Ze|=1;var n=fr.transition,r=at;try{if(fr.transition=null,at=1,e)return e()}finally{at=r,fr.transition=n,Ze=t,!(Ze&6)&&Ws()}}function hh(){Vn=Ui.current,xt(Ui)}function oi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,hx(n)),Ut!==null)for(n=Ut.return;n!==null;){var r=n;switch(Yf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Yl();break;case 3:ao(),xt(Tn),xt(mn),nh();break;case 5:th(r);break;case 4:ao();break;case 13:xt(jt);break;case 19:xt(jt);break;case 10:Jf(r.type._context);break;case 22:case 23:hh()}n=n.return}if(nn=e,Ut=e=Ls(e.current,null),ln=Vn=t,Kt=0,Ma=null,ch=Tu=fi=0,bn=la=null,ni!==null){for(t=0;t<ni.length;t++)if(n=ni[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ni=null}return e}function $2(e,t){do{var n=Ut;try{if(Qf(),_l.current=nu,tu){for(var r=Nt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}tu=!1}if(di=0,tn=Yt=Nt=null,oa=!1,ja=0,uh.current=null,n===null||n.return===null){Kt=1,Ma=t,Ut=null;break}e:{var i=e,a=n.return,u=n,d=t;if(t=ln,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,g=u,v=g.tag;if(!(g.mode&1)&&(v===0||v===11||v===15)){var w=g.alternate;w?(g.updateQueue=w.updateQueue,g.memoizedState=w.memoizedState,g.lanes=w.lanes):(g.updateQueue=null,g.memoizedState=null)}var _=Km(a);if(_!==null){_.flags&=-257,Qm(_,a,u,i,t),_.mode&1&&Xm(i,h,t),t=_,d=h;var R=t.updateQueue;if(R===null){var B=new Set;B.add(d),t.updateQueue=B}else R.add(d);break e}else{if(!(t&1)){Xm(i,h,t),ph();break e}d=Error(le(426))}}else if(kt&&u.mode&1){var K=Km(a);if(K!==null){!(K.flags&65536)&&(K.flags|=256),Qm(K,a,u,i,t),Xf(lo(d,u));break e}}i=d=lo(d,u),Kt!==4&&(Kt=2),la===null?la=[i]:la.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var E=k2(i,d,t);Um(i,E);break e;case 1:u=d;var y=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Rs===null||!Rs.has(k)))){i.flags|=65536,t&=-t,i.lanes|=t;var M=A2(i,u,t);Um(i,M);break e}}i=i.return}while(i!==null)}U2(n)}catch(b){t=b,Ut===n&&n!==null&&(Ut=n=n.return);continue}break}while(!0)}function D2(){var e=ru.current;return ru.current=nu,e===null?nu:e}function ph(){(Kt===0||Kt===3||Kt===2)&&(Kt=4),nn===null||!(fi&268435455)&&!(Tu&268435455)||Es(nn,ln)}function ou(e,t){var n=Ze;Ze|=2;var r=D2();(nn!==e||ln!==t)&&(Qr=null,oi(e,t));do try{Ox();break}catch(s){$2(e,s)}while(!0);if(Qf(),Ze=n,ru.current=r,Ut!==null)throw Error(le(261));return nn=null,ln=0,Kt}function Ox(){for(;Ut!==null;)z2(Ut)}function $x(){for(;Ut!==null&&!c4();)z2(Ut)}function z2(e){var t=G2(e.alternate,e,Vn);e.memoizedProps=e.pendingProps,t===null?U2(e):Ut=t,uh.current=null}function U2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Px(n,t),n!==null){n.flags&=32767,Ut=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Kt=6,Ut=null;return}}else if(n=Tx(n,t,Vn),n!==null){Ut=n;return}if(t=t.sibling,t!==null){Ut=t;return}Ut=t=e}while(t!==null);Kt===0&&(Kt=5)}function ei(e,t,n){var r=at,s=fr.transition;try{fr.transition=null,at=1,Dx(e,t,n,r)}finally{fr.transition=s,at=r}return null}function Dx(e,t,n,r){do Qi();while(Ns!==null);if(Ze&6)throw Error(le(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(w4(e,i),e===nn&&(Ut=nn=null,ln=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fl||(fl=!0,W2(zl,function(){return Qi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fr.transition,fr.transition=null;var a=at;at=1;var u=Ze;Ze|=4,uh.current=null,Rx(e,n),L2(n,e),ox(Bd),Hl=!!Rd,Bd=Rd=null,e.current=n,Bx(n),d4(),Ze=u,at=a,fr.transition=i}else e.current=n;if(fl&&(fl=!1,Ns=e,iu=s),i=e.pendingLanes,i===0&&(Rs=null),p4(n.stateNode),In(e,$t()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(su)throw su=!1,e=tf,tf=null,e;return iu&1&&e.tag!==0&&Qi(),i=e.pendingLanes,i&1?e===nf?ua++:(ua=0,nf=e):ua=0,Ws(),null}function Qi(){if(Ns!==null){var e=kg(iu),t=fr.transition,n=at;try{if(fr.transition=null,at=16>e?16:e,Ns===null)var r=!1;else{if(e=Ns,Ns=null,iu=0,Ze&6)throw Error(le(331));var s=Ze;for(Ze|=4,ke=e.current;ke!==null;){var i=ke,a=i.child;if(ke.flags&16){var u=i.deletions;if(u!==null){for(var d=0;d<u.length;d++){var h=u[d];for(ke=h;ke!==null;){var g=ke;switch(g.tag){case 0:case 11:case 15:aa(8,g,i)}var v=g.child;if(v!==null)v.return=g,ke=v;else for(;ke!==null;){g=ke;var w=g.sibling,_=g.return;if(I2(g),g===h){ke=null;break}if(w!==null){w.return=_,ke=w;break}ke=_}}}var R=i.alternate;if(R!==null){var B=R.child;if(B!==null){R.child=null;do{var K=B.sibling;B.sibling=null,B=K}while(B!==null)}}ke=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ke=a;else e:for(;ke!==null;){if(i=ke,i.flags&2048)switch(i.tag){case 0:case 11:case 15:aa(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,ke=E;break e}ke=i.return}}var y=e.current;for(ke=y;ke!==null;){a=ke;var k=a.child;if(a.subtreeFlags&2064&&k!==null)k.return=a,ke=k;else e:for(a=y;ke!==null;){if(u=ke,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Mu(9,u)}}catch(b){Bt(u,u.return,b)}if(u===a){ke=null;break e}var M=u.sibling;if(M!==null){M.return=u.return,ke=M;break e}ke=u.return}}if(Ze=s,Ws(),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(ku,e)}catch{}r=!0}return r}finally{at=n,fr.transition=t}}return!1}function u1(e,t,n){t=lo(n,t),t=k2(e,t,1),e=Is(e,t,1),t=vn(),e!==null&&(La(e,1,t),In(e,t))}function Bt(e,t,n){if(e.tag===3)u1(e,e,n);else for(;t!==null;){if(t.tag===3){u1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rs===null||!Rs.has(r))){e=lo(n,e),e=A2(t,e,1),t=Is(t,e,1),e=vn(),t!==null&&(La(t,1,e),In(t,e));break}}t=t.return}}function zx(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=vn(),e.pingedLanes|=e.suspendedLanes&n,nn===e&&(ln&n)===n&&(Kt===4||Kt===3&&(ln&130023424)===ln&&500>$t()-dh?oi(e,0):ch|=n),In(e,t)}function H2(e,t){t===0&&(e.mode&1?(t=nl,nl<<=1,!(nl&130023424)&&(nl=4194304)):t=1);var n=vn();e=us(e,t),e!==null&&(La(e,t,n),In(e,n))}function Ux(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),H2(e,n)}function Hx(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(le(314))}r!==null&&r.delete(t),H2(e,n)}var G2;G2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Tn.current)Mn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Mn=!1,Mx(e,t,n);Mn=!!(e.flags&131072)}else Mn=!1,kt&&t.flags&1048576&&Xg(t,Ql,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Nl(e,t),e=t.pendingProps;var s=so(t,mn.current);Ki(t,n),s=sh(null,t,r,e,s,n);var i=ih();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pn(r)?(i=!0,Xl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,qf(t),s.updater=bu,t.stateNode=s,s._reactInternals=t,Gd(t,r,e,n),t=Yd(null,t,r,!0,i,n)):(t.tag=0,kt&&i&&Vf(t),yn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Nl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Wx(r),e=Ar(r,e),s){case 0:t=Vd(null,t,r,e,n);break e;case 1:t=qm(null,t,r,e,n);break e;case 11:t=Jm(null,t,r,e,n);break e;case 14:t=Zm(null,t,r,Ar(r.type,e),n);break e}throw Error(le(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ar(r,s),Vd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ar(r,s),qm(e,t,r,s,n);case 3:e:{if(j2(t),e===null)throw Error(le(387));r=t.pendingProps,i=t.memoizedState,s=i.element,e2(e,t),ql(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=lo(Error(le(423)),t),t=e1(e,t,r,n,s);break e}else if(r!==s){s=lo(Error(le(424)),t),t=e1(e,t,r,n,s);break e}else for(Yn=Ps(t.stateNode.containerInfo.firstChild),Xn=t,kt=!0,Cr=null,n=Zg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(io(),r===s){t=cs(e,t,n);break e}yn(e,t,r,n)}t=t.child}return t;case 5:return t2(t),e===null&&zd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Ld(r,s)?a=null:i!==null&&Ld(r,i)&&(t.flags|=32),_2(e,t),yn(e,t,a,n),t.child;case 6:return e===null&&zd(t),null;case 13:return N2(e,t,n);case 4:return eh(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=oo(t,null,r,n):yn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ar(r,s),Jm(e,t,r,s,n);case 7:return yn(e,t,t.pendingProps,n),t.child;case 8:return yn(e,t,t.pendingProps.children,n),t.child;case 12:return yn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,pt(Jl,r._currentValue),r._currentValue=a,i!==null)if(br(i.value,a)){if(i.children===s.children&&!Tn.current){t=cs(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var u=i.dependencies;if(u!==null){a=i.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=rs(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var g=h.pending;g===null?d.next=d:(d.next=g.next,g.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),Ud(i.return,n,t),u.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(le(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Ud(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}yn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ki(t,n),s=hr(s),r=r(s),t.flags|=1,yn(e,t,r,n),t.child;case 14:return r=t.type,s=Ar(r,t.pendingProps),s=Ar(r.type,s),Zm(e,t,r,s,n);case 15:return E2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ar(r,s),Nl(e,t),t.tag=1,Pn(r)?(e=!0,Xl(t)):e=!1,Ki(t,n),S2(t,r,s),Gd(t,r,s,n),Yd(null,t,r,!0,e,n);case 19:return b2(e,t,n);case 22:return C2(e,t,n)}throw Error(le(156,t.tag))};function W2(e,t){return vg(e,t)}function Gx(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(e,t,n,r){return new Gx(e,t,n,r)}function mh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wx(e){if(typeof e=="function")return mh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Rf)return 11;if(e===Bf)return 14}return 2}function Ls(e,t){var n=e.alternate;return n===null?(n=cr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Tl(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")mh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Pi:return ai(n.children,s,i,t);case If:a=8,s|=8;break;case pd:return e=cr(12,n,t,s|2),e.elementType=pd,e.lanes=i,e;case md:return e=cr(13,n,t,s),e.elementType=md,e.lanes=i,e;case gd:return e=cr(19,n,t,s),e.elementType=gd,e.lanes=i,e;case tg:return Pu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case q0:a=10;break e;case eg:a=9;break e;case Rf:a=11;break e;case Bf:a=14;break e;case ws:a=16,r=null;break e}throw Error(le(130,e==null?e:typeof e,""))}return t=cr(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ai(e,t,n,r){return e=cr(7,e,r,t),e.lanes=n,e}function Pu(e,t,n,r){return e=cr(22,e,r,t),e.elementType=tg,e.lanes=n,e.stateNode={isHidden:!1},e}function Gc(e,t,n){return e=cr(6,e,null,t),e.lanes=n,e}function Wc(e,t,n){return t=cr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vx(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cc(0),this.expirationTimes=Cc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function gh(e,t,n,r,s,i,a,u,d){return e=new Vx(e,t,n,u,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=cr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qf(i),e}function Yx(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ti,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function V2(e){if(!e)return Ds;e=e._reactInternals;e:{if(yi(e)!==e||e.tag!==1)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(le(171))}if(e.tag===1){var n=e.type;if(Pn(n))return Vg(e,n,t)}return t}function Y2(e,t,n,r,s,i,a,u,d){return e=gh(n,r,!0,e,s,i,a,u,d),e.context=V2(null),n=e.current,r=vn(),s=Bs(n),i=rs(r,s),i.callback=t??null,Is(n,i,s),e.current.lanes=s,La(e,s,r),In(e,r),e}function Iu(e,t,n,r){var s=t.current,i=vn(),a=Bs(s);return n=V2(n),t.context===null?t.context=n:t.pendingContext=n,t=rs(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Is(s,t,a),e!==null&&(Nr(e,s,a,i),Cl(e,s,a)),a}function au(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function c1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function yh(e,t){c1(e,t),(e=e.alternate)&&c1(e,t)}function Xx(){return null}var X2=typeof reportError=="function"?reportError:function(e){console.error(e)};function vh(e){this._internalRoot=e}Ru.prototype.render=vh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(le(409));Iu(e,t,null,null)};Ru.prototype.unmount=vh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hi(function(){Iu(null,e,null,null)}),t[ls]=null}};function Ru(e){this._internalRoot=e}Ru.prototype.unstable_scheduleHydration=function(e){if(e){var t=Cg();e={blockedOn:null,target:e,priority:t};for(var n=0;n<As.length&&t!==0&&t<As[n].priority;n++);As.splice(n,0,e),n===0&&jg(e)}};function xh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function d1(){}function Kx(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=au(a);i.call(h)}}var a=Y2(t,r,e,0,null,!1,!1,"",d1);return e._reactRootContainer=a,e[ls]=a.current,ka(e.nodeType===8?e.parentNode:e),hi(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var h=au(d);u.call(h)}}var d=gh(e,0,!1,null,null,!1,!1,"",d1);return e._reactRootContainer=d,e[ls]=d.current,ka(e.nodeType===8?e.parentNode:e),hi(function(){Iu(t,d,n,r)}),d}function Lu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var u=s;s=function(){var d=au(a);u.call(d)}}Iu(t,a,e,s)}else a=Kx(n,t,e,s,r);return au(a)}Ag=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Jo(t.pendingLanes);n!==0&&(Of(t,n|1),In(t,$t()),!(Ze&6)&&(uo=$t()+500,Ws()))}break;case 13:hi(function(){var r=us(e,1);if(r!==null){var s=vn();Nr(r,e,1,s)}}),yh(e,1)}};$f=function(e){if(e.tag===13){var t=us(e,134217728);if(t!==null){var n=vn();Nr(t,e,134217728,n)}yh(e,134217728)}};Eg=function(e){if(e.tag===13){var t=Bs(e),n=us(e,t);if(n!==null){var r=vn();Nr(n,e,t,r)}yh(e,t)}};Cg=function(){return at};_g=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};_d=function(e,t,n){switch(t){case"input":if(xd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=_u(r);if(!s)throw Error(le(90));rg(r),xd(r,s)}}}break;case"textarea":ig(e,n);break;case"select":t=n.value,t!=null&&Wi(e,!!n.multiple,t,!1)}};fg=fh;hg=hi;var Qx={usingClientEntryPoint:!1,Events:[Oa,Li,_u,cg,dg,fh]},Wo={findFiberByHostInstance:ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jx={bundleType:Wo.bundleType,version:Wo.version,rendererPackageName:Wo.rendererPackageName,rendererConfig:Wo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gg(e),e===null?null:e.stateNode},findFiberByHostInstance:Wo.findFiberByHostInstance||Xx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hl.isDisabled&&hl.supportsFiber)try{ku=hl.inject(Jx),Gr=hl}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qx;Jn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xh(t))throw Error(le(200));return Yx(e,t,null,n)};Jn.createRoot=function(e,t){if(!xh(e))throw Error(le(299));var n=!1,r="",s=X2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=gh(e,1,!1,null,null,n,!1,r,s),e[ls]=t.current,ka(e.nodeType===8?e.parentNode:e),new vh(t)};Jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(le(188)):(e=Object.keys(e).join(","),Error(le(268,e)));return e=gg(t),e=e===null?null:e.stateNode,e};Jn.flushSync=function(e){return hi(e)};Jn.hydrate=function(e,t,n){if(!Bu(t))throw Error(le(200));return Lu(null,e,t,!0,n)};Jn.hydrateRoot=function(e,t,n){if(!xh(e))throw Error(le(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=X2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Y2(t,null,e,1,n??null,s,!1,i,a),e[ls]=t.current,ka(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Ru(t)};Jn.render=function(e,t,n){if(!Bu(t))throw Error(le(200));return Lu(null,e,t,!1,n)};Jn.unmountComponentAtNode=function(e){if(!Bu(e))throw Error(le(40));return e._reactRootContainer?(hi(function(){Lu(null,null,e,!1,function(){e._reactRootContainer=null,e[ls]=null})}),!0):!1};Jn.unstable_batchedUpdates=fh;Jn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Bu(n))throw Error(le(200));if(e==null||e._reactInternals===void 0)throw Error(le(38));return Lu(e,t,n,!1,r)};Jn.version="18.3.1-next-f1338f8080-20240426";function K2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(K2)}catch(e){console.error(e)}}K2(),K0.exports=Jn;var Zx=K0.exports,f1=Zx;fd.createRoot=f1.createRoot,fd.hydrateRoot=f1.hydrateRoot;const Ji={},Q2="production",h1={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-server.onrender.com/api",healthUrl:"https://cfg-server.onrender.com/health"}},J2=h1[Q2]||h1.development,Fu=()=>{if(!(Ji!=null&&Ji.VITE_API_BASE_URL))return J2.baseUrl},qx=()=>{if(!(Ji!=null&&Ji.VITE_HEALTH_URL))return J2.healthUrl},ew=async()=>{try{const e=await fetch(qx(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},tw=()=>Q2;function nw({onStart:e}){const[t,n]=j.useState("1"),[r,s]=j.useState("individual"),[i,a]=j.useState("15"),[u,d]=j.useState({status:"checking",version:"...",commit:"...",healthy:!1});j.useEffect(()=>{const w=async()=>{const R=await ew();d(R),console.log("[StartDialog] Server health:",R)};w();const _=setInterval(w,3e4);return()=>clearInterval(_)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const w={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(w)},g=()=>{window.close()},v=()=>u.status==="checking"?"checking":u.healthy?"healthy":"unhealthy";return l.jsx("div",{className:"dialog-overlay",children:l.jsxs("div",{className:"dialog-box",children:[l.jsxs("div",{className:"dialog-header",children:[l.jsx("h2",{children:"The Creative Game"}),l.jsxs("div",{className:`server-health-indicator ${v()}`,title:`Server: ${u.status}
Version: ${u.version}
Commit: ${u.commit}
Environment: ${tw()}`,children:[l.jsx("span",{className:"health-light"}),l.jsx("span",{className:"health-text",children:"Server"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"ID:"}),l.jsx("input",{type:"text",value:t,onChange:w=>n(w.target.value)})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Condition:"}),l.jsxs("select",{value:r,onChange:w=>s(w.target.value),children:[l.jsx("option",{value:"individual",children:"individual"}),l.jsx("option",{value:"group",children:"group"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Time (in minutes):"}),l.jsx("input",{type:"number",value:i,onChange:w=>a(w.target.value),min:"1"})]}),l.jsxs("div",{className:"dialog-buttons",children:[l.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),l.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),l.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),l.jsx("button",{className:"dialog-button cancel",onClick:g,children:"Cancel"})]})]})})}class p1{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const rw=.035;class sw{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=Fu(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),u=s-i;let d=0,h=0,g=0;n>=0&&n<60?(d=i,h=a,g=0):n<120?(d=a,h=i,g=0):n<180?(d=0,h=i,g=a):n<240?(d=0,h=a,g=i):n<300?(d=a,h=0,g=i):(d=i,h=0,g=a);const v=w=>{const _=Math.round((w+u)*255).toString(16);return _.length===1?"0"+_:_};return`#${v(d)}${v(h)}${v(g)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const u=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${u}

Please choose a different Session ID.`),this.stop(),new Error(u)):new Error(u)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/rw,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),u=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(w=>this.relativeToGrid(w)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:u,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:u,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(w=>this.relativeToGrid(w)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(w=>this.relativeToGrid(w)):null)),this.moves.push(h),this.persistMove(h).catch(w=>{console.error("[GameTracker] Failed to persist move to server:",w)});const g=this.getCurrentBraceletStatus(),v=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:u,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:g,lastKnownPlayer:v,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(w=>({status:w.status,elapsed:w.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(u=>u.timestamp>=s&&u.timestamp<=i);if(a.length>0){const u={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(u[h.status]=(u[h.status]||0)+1)});const d=Object.keys(u).reduce((h,g)=>u[h]>u[g]?h:g,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let Vc=null;const m1=()=>(Vc||(Vc=new sw),Vc),_r=.07,ca=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),_t=e=>Math.round(e*1e3)/1e3,iw=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[_t(i.position[0]-_r),_t(i.position[1])],[_t(i.position[0]+_r),_t(i.position[1])],[_t(i.position[0]),_t(i.position[1]-_r)],[_t(i.position[0]),_t(i.position[1]+_r)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},ow=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},of=e=>e.map(t=>{const n=[],r=[[_t(t.position[0]-_r),_t(t.position[1])],[_t(t.position[0]+_r),_t(t.position[1])],[_t(t.position[0]),_t(t.position[1]-_r)],[_t(t.position[0]),_t(t.position[1]+_r)]];return e.forEach(s=>{r.forEach(i=>{_t(s.position[0])===i[0]&&_t(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),aw=e=>{const t=new Set;if(e.forEach((a,u)=>{a.forEach((d,h)=>{d&&t.add(`${u},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,u]=i.shift(),d=`${a},${u}`;s.has(d)||(s.add(d),n.forEach(([h,g])=>{const v=`${a+h},${u+g}`;t.has(v)&&!s.has(v)&&i.push([a+h,u+g])}))}return s.size===t.size},lw=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=_r)n.push(_t(i));const r=[];for(let i=-.7;i<0;i+=_r)r.push(_t(i));for(let i=0;i<=.77;i+=_r)r.push(_t(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const u=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);u!==-1&&d!==-1&&(s[d][u]=!0)}}),aw(s)},af=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=lw(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},g1=e=>{if(e.length===0)return null;try{const t=e.map(g=>g[0]),n=e.map(g=>g[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(g=>{const v=Math.sqrt(Math.pow(g[0]-r,2)+Math.pow(g[1]-s,2));v<i&&(i=v,a=g)});const u=-a[0],d=-a[1],h=e.map(g=>[_t(g[0]+u),_t(g[1]+d)]);return h.sort((g,v)=>g[0]-v[0]||g[1]-v[1]),h}catch{return null}},uw=60,y1=.07,Yc=120;function cw({config:e,interfaceHidden:t=!1}){const[n,r]=j.useState(ca()),[s,i]=j.useState(null),[a,u]=j.useState({x:0,y:0}),[d,h]=j.useState(!0),[g,v]=j.useState(e.timeSeconds),[w,_]=j.useState(0),[R,B]=j.useState(null),[K,E]=j.useState(!0),[y,k]=j.useState(""),[M,b]=j.useState(!1),[H,I]=j.useState({blockSize:uw,bottomPadding:Yc}),O=j.useRef(null),z=j.useRef(new p1(e)),W=j.useRef(m1()),X=j.useRef(null),Z=j.useRef(Date.now()),Q=j.useRef(Yc),re=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,he=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,pe="The experiment is done. Thank you very much for your participation!",Se=j.useCallback(()=>{const U=O.current;if(!U)return;const G=U.offsetWidth,J=U.offsetHeight;if(!G||!J)return;const ee=Q.current||Yc;let L=Math.max(1,Math.min(G,J-ee)),m=Math.max(38,Math.min(L*y1*.95,L/4)),T=Math.max(m*2.5,110);L=Math.max(1,Math.min(G,J-T)),m=Math.max(38,Math.min(L*y1*.95,L/4)),T=Math.max(m*2.5,110),Q.current=T,I(N=>{const C=Math.abs(N.blockSize-m),F=Math.abs(N.bottomPadding-T);return C<.5&&F<.5?N:{blockSize:m,bottomPadding:T}})},[]);j.useEffect(()=>(k(re),(async()=>{try{W.current.start(),await W.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(G){console.error("[GameCanvas] Failed to initialize tracker:",G),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{E(!0),k(pe),b(!0),W.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,W.current.stop()}),[]),j.useEffect(()=>{Se()},[Se,t]),j.useEffect(()=>{const U=()=>{Se()};return U(),window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[Se]),j.useEffect(()=>{if(!d&&g>0){const U=setInterval(()=>{v(G=>G<=1?(clearInterval(U),E(!0),k(pe),b(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):G-1)},1e3);return()=>clearInterval(U)}},[d,g]),j.useEffect(()=>{r(U=>af(of(U),d))},[d]);const se=()=>(Date.now()-Z.current)/1e3,te=(U,G)=>{const J=O.current;if(!J)return 0;const ee=J.offsetHeight-Q.current,L=Math.min(J.offsetWidth,ee),m=G==="x"?(J.offsetWidth-L)/2:(J.offsetHeight-Q.current-L)/2;return(U-m)/L-.5},q=(U,G)=>{const J=O.current;if(!J)return 0;const ee=J.offsetHeight-Q.current,L=Math.min(J.offsetWidth,ee),m=G==="x"?(J.offsetWidth-L)/2:(J.offsetHeight-Q.current-L)/2;return(U+.5)*L+m},me=U=>{var L,m,T,N;const G=O.current.getBoundingClientRect(),J=U.clientX!==void 0?U.clientX:(m=(L=U.touches)==null?void 0:L[0])==null?void 0:m.clientX,ee=U.clientY!==void 0?U.clientY:(N=(T=U.touches)==null?void 0:T[0])==null?void 0:N.clientY;return{x:J-G.left,y:ee-G.top}},Me=(U,G)=>{const J=n.find(T=>T.id===G);if(!J||!J.canMove)return;U.preventDefault();const ee=me(U),L=q(J.position[0],"x"),m=q(J.position[1],"y");X.current=Date.now(),i(G),u({x:ee.x-L,y:ee.y-m})},Ue=U=>{if(s===null)return;U.preventDefault();const G=me(U),J=te(G.x-a.x,"x"),ee=te(G.y-a.y,"y");r(L=>L.map(m=>m.id===s?{...m,position:[J,ee]}:m))},He=()=>{try{const U=window.braceletDetectorVideo;if(!U||!U.videoWidth||U.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const G=document.createElement("canvas"),J=640,ee=480;let L=U.videoWidth,m=U.videoHeight;const T=L/m;return L>J&&(L=J,m=L/T),m>ee&&(m=ee,L=m*T),G.width=Math.floor(L),G.height=Math.floor(m),G.getContext("2d").drawImage(U,0,0,G.width,G.height),G.toDataURL("image/jpeg",.6)}catch(U){return console.error("[GameCanvas] Error capturing camera frame:",U),null}},Re=()=>{if(s===null)return;const U=n.find(C=>C.id===s),G=iw(n,s),J=ow(G,U.position),ee=X.current?(Date.now()-X.current)/1e3:0,L=n.map(C=>C.id===s?{...C,position:J}:C),m=He(),T=window.currentBraceletStatus||"Unknown",N={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:se(),unit:s,end_position:J,all_positions:L.map(C=>C.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:m,player:T};z.current.write(N),W.current.recordMove(N,ee,m),r(C=>{const F=C.map(D=>D.id===s?{...D,position:J}:D);return af(of(F),d)}),i(null),X.current=null},De=()=>{const U=n.map(N=>N.position),G=g1(U),J=w+1,ee=He(),L=window.currentBraceletStatus||"Unknown",m={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:se(),unit:null,end_position:null,all_positions:null,gallery_shape_number:J,gallery:U,gallery_normalized:G,camera_frame:ee,player:L};z.current.write(m),W.current.recordMove(m,0,ee);const T=ne();B(T),_(J)},ne=()=>{const U=document.createElement("canvas");U.width=400,U.height=400;const G=U.getContext("2d");G.fillStyle="#000",G.fillRect(0,0,400,400);const J=n.map(L=>L.position),ee=g1(J);return ee&&ee.forEach(L=>{const m=(L[0]+.5)*400,T=(L[1]+.5)*400;G.fillStyle="green",G.fillRect(m-15,T-15,30,30)}),U.toDataURL()},ue=j.useCallback(U=>{U.key==="p"&&d?(h(!1),E(!0),k(he),Z.current=Date.now(),r(ca()),B(null),_(0),z.current=new p1(e),W.current.stop(),W.current=m1(),W.current.start(),W.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):U.key==="q"&&!d&&(E(!0),k(pe),b(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);j.useEffect(()=>(window.addEventListener("keydown",ue),()=>window.removeEventListener("keydown",ue)),[ue]);const ve=()=>{if(M&&y===pe){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&y===he)try{const U=new(window.AudioContext||window.webkitAudioContext),G=U.createOscillator(),J=U.createGain();G.connect(J),J.connect(U.destination),G.frequency.setValueAtTime(800,U.currentTime),G.frequency.setValueAtTime(600,U.currentTime+.15),J.gain.setValueAtTime(.3,U.currentTime),J.gain.exponentialRampToValueAtTime(.01,U.currentTime+.3),G.start(U.currentTime),G.stop(U.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(U){console.error("[GameCanvas] Error playing sound:",U)}E(!1)},ce=U=>{U.preventDefault()};return l.jsxs("div",{className:"game-canvas",ref:O,style:{"--block-size":`${H.blockSize}px`,"--bottom-padding":`${H.bottomPadding}px`},onMouseMove:Ue,onMouseUp:Re,onMouseLeave:Re,onTouchMove:Ue,onTouchEnd:Re,onTouchCancel:Re,onContextMenu:ce,children:[l.jsx("div",{className:"gallery",onClick:De,children:l.jsx("div",{className:"gallery-frame",children:R?l.jsx("img",{src:R,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&l.jsxs("div",{className:"timer",children:["Time: ",Math.floor(g/60),":",(g%60).toString().padStart(2,"0")]}),n.map(U=>l.jsx("div",{className:`block ${U.canMove?"movable":""}`,style:{left:`${q(U.position[0],"x")}px`,top:`${q(U.position[1],"y")}px`,backgroundColor:U.color||"green",cursor:U.canMove?"grab":"default"},onMouseDown:G=>Me(G,U.id),onTouchStart:G=>Me(G,U.id)},U.id)),K&&l.jsx("div",{className:"message-overlay",onClick:ve,children:l.jsxs("div",{className:"message-box",children:[y,l.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var lu={};(function(){var e;function t(o){var c=0;return function(){return c<o.length?{done:!1,value:o[c++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof xc=="object"&&xc];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,c){if(c)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var x=o[p];if(!(x in f))break e;f=f[x]}o=o[o.length-1],p=f[o],c=c(p),c!=p&&c!=null&&n(f,o,{configurable:!0,writable:!0,value:c})}}i("Symbol",function(o){function c(A){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new f(p+(A||"")+"_"+x++,A)}function f(A,S){this.h=A,n(this,"description",{configurable:!0,writable:!0,value:S})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",x=0;return c}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<c.length;f++){var p=s[c[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function u(o){var c=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return c?c.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=u(o);for(var c,f=[];!(c=o.next()).done;)f.push(c.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,c){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(o[x]=p[x])}return o};i("Object.assign",function(o){return o||h});var g=typeof Object.create=="function"?Object.create:function(o){function c(){}return c.prototype=o,new c},v;if(typeof Object.setPrototypeOf=="function")v=Object.setPrototypeOf;else{var w;e:{var _={a:!0},R={};try{R.__proto__=_,w=R.a;break e}catch{}w=!1}v=w?function(o,c){if(o.__proto__=c,o.__proto__!==c)throw new TypeError(o+" is not extensible");return o}:null}var B=v;function K(o,c){if(o.prototype=g(c.prototype),o.prototype.constructor=o,B)B(o,c);else for(var f in c)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(c,f);p&&Object.defineProperty(o,f,p)}else o[f]=c[f];o.ya=c.prototype}function E(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function y(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}E.prototype.u=function(o){this.i=o};function k(o,c){o.l={ma:c,na:!0},o.h=o.s||o.v}E.prototype.return=function(o){this.l={return:o},this.h=this.v};function M(o,c,f){return o.h=f,{value:c}}function b(o){this.h=new E,this.i=o}function H(o,c){y(o.h);var f=o.h.j;return f?I(o,"return"in f?f.return:function(p){return{value:p,done:!0}},c,o.h.return):(o.h.return(c),O(o))}function I(o,c,f,p){try{var x=c.call(o.h.j,f);if(!(x instanceof Object))throw new TypeError("Iterator result "+x+" is not an object");if(!x.done)return o.h.m=!1,x;var A=x.value}catch(S){return o.h.j=null,k(o.h,S),O(o)}return o.h.j=null,p.call(o.h,A),O(o)}function O(o){for(;o.h.h;)try{var c=o.i(o.h);if(c)return o.h.m=!1,{value:c.value,done:!1}}catch(f){o.h.i=void 0,k(o.h,f)}if(o.h.m=!1,o.h.l){if(c=o.h.l,o.h.l=null,c.na)throw c.ma;return{value:c.return,done:!0}}return{value:void 0,done:!0}}function z(o){this.next=function(c){return y(o.h),o.h.j?c=I(o,o.h.j.next,c,o.h.u):(o.h.u(c),c=O(o)),c},this.throw=function(c){return y(o.h),o.h.j?c=I(o,o.h.j.throw,c,o.h.u):(k(o.h,c),c=O(o)),c},this.return=function(c){return H(o,c)},this[Symbol.iterator]=function(){return this}}function W(o){function c(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,x){function A(S){S.done?p(S.value):Promise.resolve(S.value).then(c,f).then(A,x)}A(o.next())})}function X(o){return W(new z(new b(o)))}i("Promise",function(o){function c(S){this.i=0,this.j=void 0,this.h=[],this.u=!1;var P=this.l();try{S(P.resolve,P.reject)}catch(Y){P.reject(Y)}}function f(){this.h=null}function p(S){return S instanceof c?S:new c(function(P){P(S)})}if(o)return o;f.prototype.i=function(S){if(this.h==null){this.h=[];var P=this;this.j(function(){P.m()})}this.h.push(S)};var x=s.setTimeout;f.prototype.j=function(S){x(S,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var S=this.h;this.h=[];for(var P=0;P<S.length;++P){var Y=S[P];S[P]=null;try{Y()}catch(oe){this.l(oe)}}}this.h=null},f.prototype.l=function(S){this.j(function(){throw S})},c.prototype.l=function(){function S(oe){return function(fe){Y||(Y=!0,oe.call(P,fe))}}var P=this,Y=!1;return{resolve:S(this.I),reject:S(this.m)}},c.prototype.I=function(S){if(S===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(S instanceof c)this.L(S);else{e:switch(typeof S){case"object":var P=S!=null;break e;case"function":P=!0;break e;default:P=!1}P?this.F(S):this.s(S)}},c.prototype.F=function(S){var P=void 0;try{P=S.then}catch(Y){this.m(Y);return}typeof P=="function"?this.M(P,S):this.s(S)},c.prototype.m=function(S){this.v(2,S)},c.prototype.s=function(S){this.v(1,S)},c.prototype.v=function(S,P){if(this.i!=0)throw Error("Cannot settle("+S+", "+P+"): Promise already settled in state"+this.i);this.i=S,this.j=P,this.i===2&&this.K(),this.H()},c.prototype.K=function(){var S=this;x(function(){if(S.D()){var P=s.console;typeof P<"u"&&P.error(S.j)}},1)},c.prototype.D=function(){if(this.u)return!1;var S=s.CustomEvent,P=s.Event,Y=s.dispatchEvent;return typeof Y>"u"?!0:(typeof S=="function"?S=new S("unhandledrejection",{cancelable:!0}):typeof P=="function"?S=new P("unhandledrejection",{cancelable:!0}):(S=s.document.createEvent("CustomEvent"),S.initCustomEvent("unhandledrejection",!1,!0,S)),S.promise=this,S.reason=this.j,Y(S))},c.prototype.H=function(){if(this.h!=null){for(var S=0;S<this.h.length;++S)A.i(this.h[S]);this.h=null}};var A=new f;return c.prototype.L=function(S){var P=this.l();S.T(P.resolve,P.reject)},c.prototype.M=function(S,P){var Y=this.l();try{S.call(P,Y.resolve,Y.reject)}catch(oe){Y.reject(oe)}},c.prototype.then=function(S,P){function Y(je,ye){return typeof je=="function"?function(Le){try{oe(je(Le))}catch(Ve){fe(Ve)}}:ye}var oe,fe,Be=new c(function(je,ye){oe=je,fe=ye});return this.T(Y(S,oe),Y(P,fe)),Be},c.prototype.catch=function(S){return this.then(void 0,S)},c.prototype.T=function(S,P){function Y(){switch(oe.i){case 1:S(oe.j);break;case 2:P(oe.j);break;default:throw Error("Unexpected state: "+oe.i)}}var oe=this;this.h==null?A.i(Y):this.h.push(Y),this.u=!0},c.resolve=p,c.reject=function(S){return new c(function(P,Y){Y(S)})},c.race=function(S){return new c(function(P,Y){for(var oe=u(S),fe=oe.next();!fe.done;fe=oe.next())p(fe.value).T(P,Y)})},c.all=function(S){var P=u(S),Y=P.next();return Y.done?p([]):new c(function(oe,fe){function Be(Le){return function(Ve){je[Le]=Ve,ye--,ye==0&&oe(je)}}var je=[],ye=0;do je.push(void 0),ye++,p(Y.value).T(Be(je.length-1),fe),Y=P.next();while(!Y.done)})},c});function Z(o,c){o instanceof String&&(o+="");var f=0,p=!1,x={next:function(){if(!p&&f<o.length){var A=f++;return{value:c(A,o[A]),done:!1}}return p=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.keys",function(o){return o||function(){return Z(this,function(c){return c})}}),i("Array.prototype.fill",function(o){return o||function(c,f,p){var x=this.length||0;for(0>f&&(f=Math.max(0,x+f)),(p==null||p>x)&&(p=x),p=Number(p),0>p&&(p=Math.max(0,x+p)),f=Number(f||0);f<p;f++)this[f]=c;return this}});function Q(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",Q),i("Uint8Array.prototype.fill",Q),i("Uint8ClampedArray.prototype.fill",Q),i("Int16Array.prototype.fill",Q),i("Uint16Array.prototype.fill",Q),i("Int32Array.prototype.fill",Q),i("Uint32Array.prototype.fill",Q),i("Float32Array.prototype.fill",Q),i("Float64Array.prototype.fill",Q),i("Object.is",function(o){return o||function(c,f){return c===f?c!==0||1/c===1/f:c!==c&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(c,f){var p=this;p instanceof String&&(p=String(p));var x=p.length;for(f=f||0,0>f&&(f=Math.max(f+x,0));f<x;f++){var A=p[f];if(A===c||Object.is(A,c))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(c,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(c,f||0)!==-1}});var re=this||self;function he(o,c){o=o.split(".");var f=re;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||c===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=c}function pe(o){var c;e:{if((c=re.navigator)&&(c=c.userAgent))break e;c=""}return c.indexOf(o)!=-1}var Se=Array.prototype.map?function(o,c){return Array.prototype.map.call(o,c,void 0)}:function(o,c){for(var f=o.length,p=Array(f),x=typeof o=="string"?o.split(""):o,A=0;A<f;A++)A in x&&(p[A]=c.call(void 0,x[A],A,o));return p},se={},te=null;function q(o){var c=o.length,f=3*c/4;f%3?f=Math.floor(f):"=.".indexOf(o[c-1])!=-1&&(f="=.".indexOf(o[c-2])!=-1?f-2:f-1);var p=new Uint8Array(f),x=0;return me(o,function(A){p[x++]=A}),x!==f?p.subarray(0,x):p}function me(o,c){function f(Y){for(;p<o.length;){var oe=o.charAt(p++),fe=te[oe];if(fe!=null)return fe;if(!/^[\s\xa0]*$/.test(oe))throw Error("Unknown base64 encoding at char: "+oe)}return Y}Me();for(var p=0;;){var x=f(-1),A=f(0),S=f(64),P=f(64);if(P===64&&x===-1)break;c(x<<2|A>>4),S!=64&&(c(A<<4&240|S>>2),P!=64&&c(S<<6&192|P))}}function Me(){if(!te){te={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(c[f].split(""));se[f]=p;for(var x=0;x<p.length;x++){var A=p[x];te[A]===void 0&&(te[A]=x)}}}}var Ue=typeof Uint8Array<"u",He=!(pe("Trident")||pe("MSIE"))&&typeof re.btoa=="function";function Re(o){if(!He){var c;c===void 0&&(c=0),Me(),c=se[c];for(var f=Array(Math.floor(o.length/3)),p=c[64]||"",x=0,A=0;x<o.length-2;x+=3){var S=o[x],P=o[x+1],Y=o[x+2],oe=c[S>>2];S=c[(S&3)<<4|P>>4],P=c[(P&15)<<2|Y>>6],Y=c[Y&63],f[A++]=oe+S+P+Y}switch(oe=0,Y=p,o.length-x){case 2:oe=o[x+1],Y=c[(oe&15)<<2]||p;case 1:o=o[x],f[A]=c[o>>2]+c[(o&3)<<4|oe>>4]+Y+p}return f.join("")}for(c="";10240<o.length;)c+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return c+=String.fromCharCode.apply(null,o),btoa(c)}var De=RegExp("[-_.]","g");function ne(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function ue(o){if(!He)return q(o);De.test(o)&&(o=o.replace(De,ne)),o=atob(o);for(var c=new Uint8Array(o.length),f=0;f<o.length;f++)c[f]=o.charCodeAt(f);return c}var ve;function ce(){return ve||(ve=new Uint8Array(0))}var U={},G=typeof Uint8Array.prototype.slice=="function",J=0,ee=0;function L(o){var c=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),c&&(f=u(T(f,o)),c=f.next().value,o=f.next().value,f=c),J=f>>>0,ee=o>>>0}var m=typeof BigInt=="function";function T(o,c){return c=~c,o?o=~o+1:c+=1,[o,c]}function N(o,c){this.i=o>>>0,this.h=c>>>0}function C(o){if(!o)return F||(F=new N(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)L(Number(o));else if(m)o=BigInt(o),J=Number(o&BigInt(4294967295))>>>0,ee=Number(o>>BigInt(32)&BigInt(4294967295));else{var c=+(o[0]==="-");ee=J=0;for(var f=o.length,p=c,x=(f-c)%6+c;x<=f;p=x,x+=6)p=Number(o.slice(p,x)),ee*=1e6,J=1e6*J+p,4294967296<=J&&(ee+=J/4294967296|0,J%=4294967296);c&&(c=u(T(J,ee)),o=c.next().value,c=c.next().value,J=o,ee=c)}return new N(J,ee)}var F;function D(o,c){return Error("Invalid wire type: "+o+" (at position "+c+")")}function V(){return Error("Failed to read varint, encoding is invalid.")}function ie(o,c){return Error("Tried to read past the end of the data "+c+" > "+o)}function de(){throw Error("Invalid UTF8")}function Ee(o,c){return c=String.fromCharCode.apply(null,c),o==null?c:o+c}var Pe=void 0,Fe,et=typeof TextDecoder<"u",Qe,lt=typeof TextEncoder<"u",ut;function Ge(o){if(o!==U)throw Error("illegal external caller")}function ze(o,c){if(Ge(c),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function We(){return ut||(ut=new ze(null,U))}function Je(o){Ge(U);var c=o.V;return c=c==null||Ue&&c!=null&&c instanceof Uint8Array?c:typeof c=="string"?ue(c):null,c==null?c:o.V=c}function Ct(o){if(typeof o=="string")return{buffer:ue(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===ze)return{buffer:Je(o)||ce(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Fn(o,c){this.i=null,this.m=!1,this.h=this.j=this.l=0,ct(this,o,c)}function ct(o,c,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,c&&(c=Ct(c),o.i=c.buffer,o.m=c.C,o.l=0,o.j=o.i.length,o.h=o.l)}Fn.prototype.reset=function(){this.h=this.l};function zt(o,c){if(o.h=c,c>o.j)throw ie(o.j,c)}function Tt(o){var c=o.i,f=o.h,p=c[f++],x=p&127;if(p&128&&(p=c[f++],x|=(p&127)<<7,p&128&&(p=c[f++],x|=(p&127)<<14,p&128&&(p=c[f++],x|=(p&127)<<21,p&128&&(p=c[f++],x|=p<<28,p&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128)))))throw V();return zt(o,f),x}function rn(o,c){if(0>c)throw Error("Tried to read a negative byte length: "+c);var f=o.h,p=f+c;if(p>o.j)throw ie(c,o.j-f);return o.h=p,f}var Qt=[];function Jt(){this.h=[]}Jt.prototype.length=function(){return this.h.length},Jt.prototype.end=function(){var o=this.h;return this.h=[],o};function nr(o,c,f){for(;0<f||127<c;)o.h.push(c&127|128),c=(c>>>7|f<<25)>>>0,f>>>=7;o.h.push(c)}function En(o,c){for(;127<c;)o.h.push(c&127|128),c>>>=7;o.h.push(c)}function Xr(o,c){if(Qt.length){var f=Qt.pop();ct(f,o,c),o=f}else o=new Fn(o,c);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(c)}Xr.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},Xr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function wr(o){var c=o.h;if(c.h==c.j)return!1;o.j=o.h.h;var f=Tt(o.h)>>>0;if(c=f>>>3,f&=7,!(0<=f&&5>=f))throw D(f,o.j);if(1>c)throw Error("Invalid field number: "+c+" (at position "+o.j+")");return o.l=c,o.i=f,!0}function Kr(o){switch(o.i){case 0:if(o.i!=0)Kr(o);else e:{o=o.h;for(var c=o.h,f=c+10,p=o.i;c<f;)if(!(p[c++]&128)){zt(o,c);break e}throw V()}break;case 1:o=o.h,zt(o,o.h+8);break;case 2:o.i!=2?Kr(o):(c=Tt(o.h)>>>0,o=o.h,zt(o,o.h+c));break;case 5:o=o.h,zt(o,o.h+4);break;case 3:c=o.l;do{if(!wr(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=c)throw Error("Unmatched end-group tag");break}Kr(o)}while(!0);break;default:throw D(o.i,o.j)}}var Rr=[];function ms(){this.j=[],this.i=0,this.h=new Jt}function On(o,c){c.length!==0&&(o.j.push(c),o.i+=c.length)}function xi(o,c){if(c=c.R){On(o,o.h.end());for(var f=0;f<c.length;f++)On(o,Je(c[f])||ce())}}var Cn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function $n(o,c){return Cn?o[Cn]|=c:o.A!==void 0?o.A|=c:(Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}}),c)}function Ks(o,c){Cn?o[Cn]&&(o[Cn]&=~c):o.A!==void 0&&(o.A&=~c)}function gt(o){var c;return Cn?c=o[Cn]:c=o.A,c??0}function Dn(o,c){Cn?o[Cn]=c:o.A!==void 0?o.A=c:Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}})}function wi(o){return $n(o,1),o}function Wa(o,c){Dn(c,(o|0)&-51)}function Qs(o,c){Dn(c,(o|18)&-41)}var Si={};function Js(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var gs,Po=[];Dn(Po,23),gs=Object.freeze(Po);function ki(o){if(gt(o.o)&2)throw Error("Cannot mutate an immutable Message")}function $(o){var c=o.length;(c=c?o[c-1]:void 0)&&Js(c)?c.g=1:(c={},o.push((c.g=1,c)))}function ge(o){var c=o.i+o.G;return o.B||(o.B=o.o[c]={})}function xe(o,c){return c===-1?null:c>=o.i?o.B?o.B[c]:void 0:o.o[c+o.G]}function ae(o,c,f,p){ki(o),we(o,c,f,p)}function we(o,c,f,p){o.j&&(o.j=void 0),c>=o.i||p?ge(o)[c]=f:(o.o[c+o.G]=f,(o=o.B)&&c in o&&delete o[c])}function Oe(o,c,f,p){var x=xe(o,c);Array.isArray(x)||(x=gs);var A=gt(x);if(A&1||wi(x),p)A&2||$n(x,2),f&1||Object.freeze(x);else{p=!(f&2);var S=A&2;f&1||!S?p&&A&16&&!S&&Ks(x,16):(x=wi(Array.prototype.slice.call(x)),we(o,c,x))}return x}function it(o,c){var f=xe(o,c),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&we(o,c,p),p}function tt(o,c,f,p,x){o.h||(o.h={});var A=o.h[f],S=Oe(o,f,3,x);if(!A){var P=S;A=[];var Y=!!(gt(o.o)&16);S=!!(gt(P)&2);var oe=P;!x&&S&&(P=Array.prototype.slice.call(P));for(var fe=S,Be=0;Be<P.length;Be++){var je=P[Be],ye=c,Le=!1;if(Le=Le===void 0?!1:Le,je=Array.isArray(je)?new ye(je):Le?new ye:void 0,je!==void 0){ye=je.o;var Ve=Le=gt(ye);S&&(Ve|=2),Y&&(Ve|=16),Ve!=Le&&Dn(ye,Ve),ye=Ve,fe=fe||!!(2&ye),A.push(je)}}return o.h[f]=A,Y=gt(P),c=Y|33,c=fe?c&-9:c|8,Y!=c&&(fe=P,Object.isFrozen(fe)&&(fe=Array.prototype.slice.call(fe)),Dn(fe,c),P=fe),oe!==P&&we(o,f,P),(x||p&&S)&&$n(A,2),p&&Object.freeze(A),A}return x||(x=Object.isFrozen(A),p&&!x?Object.freeze(A):!p&&x&&(A=Array.prototype.slice.call(A),o.h[f]=A)),A}function Ie(o,c,f){var p=!!(gt(o.o)&2);if(c=tt(o,c,f,p,p),o=Oe(o,f,3,p),!(p||gt(o)&8)){for(p=0;p<c.length;p++){if(f=c[p],gt(f.o)&2){var x=Tp(f,!1);x.j=f}else x=f;f!==x&&(c[p]=x,o[p]=x.o)}$n(o,8)}return c}function $e(o,c,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);ae(o,c,f)}function Vt(o,c,f,p,x){ki(o);var A=tt(o,f,c,!1,!1);return f=p??new f,o=Oe(o,c,2,!1),x!=null?(A.splice(x,0,f),o.splice(x,0,f.o)):(A.push(f),o.push(f.o)),f.C()&&Ks(o,8),f}function _n(o,c){return o??c}function Pt(o,c,f){return f=f===void 0?0:f,_n(it(o,c),f)}var Ai;function dc(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(gt(o)&128)return o=Array.prototype.slice.call(o),$(o),o}else{if(Ue&&o!=null&&o instanceof Uint8Array)return Re(o);if(o instanceof ze){var c=o.V;return c==null?"":typeof c=="string"?c:o.V=Re(c)}}}return o}function Ei(o,c,f,p){if(o!=null){if(Array.isArray(o))o=Io(o,c,f,p!==void 0);else if(Js(o)){var x={},A;for(A in o)x[A]=Ei(o[A],c,f,p);o=x}else o=c(o,p);return o}}function Io(o,c,f,p){var x=gt(o);p=p?!!(x&16):void 0,o=Array.prototype.slice.call(o);for(var A=0;A<o.length;A++)o[A]=Ei(o[A],c,f,p);return f(x,o),o}function Ro(o){return o.ja===Si?o.toJSON():dc(o)}function Yv(o,c){o&128&&$(c)}function Np(o,c,f){if(f=f===void 0?Qs:f,o!=null){if(Ue&&o instanceof Uint8Array)return o.length?new ze(new Uint8Array(o),U):We();if(Array.isArray(o)){var p=gt(o);return p&2?o:c&&!(p&32)&&(p&16||p===0)?(Dn(o,p|2),o):(o=Io(o,Np,p&4?Qs:f,!0),c=gt(o),c&4&&c&2&&Object.freeze(o),o)}return o.ja===Si?Mp(o):o}}function bp(o,c,f,p,x,A,S){if(o=o.h&&o.h[f]){if(p=gt(o),p&2?p=o:(A=Se(o,Mp),Qs(p,A),Object.freeze(A),p=A),ki(c),S=p==null?gs:wi([]),p!=null){for(A=!!p.length,o=0;o<p.length;o++){var P=p[o];A=A&&!(gt(P.o)&2),S[o]=P.o}A=(A?8:0)|1,o=gt(S),(o&A)!==A&&(Object.isFrozen(S)&&(S=Array.prototype.slice.call(S)),Dn(S,o|A)),c.h||(c.h={}),c.h[f]=p}else c.h&&(c.h[f]=void 0);we(c,f,S,x)}else ae(c,f,Np(p,A,S),x)}function Mp(o){return gt(o.o)&2||(o=Tp(o,!0),$n(o.o,2)),o}function Tp(o,c){var f=o.o,p=[];$n(p,16);var x=o.constructor.h;if(x&&p.push(x),x=o.B,x){p.length=f.length,p.fill(void 0,p.length,f.length);var A={};p[p.length-1]=A}gt(f)&128&&$(p),c=c||o.C()?Qs:Wa,A=o.constructor,Ai=p,p=new A(p),Ai=void 0,o.R&&(p.R=o.R.slice()),A=!!(gt(f)&16);for(var S=x?f.length-1:f.length,P=0;P<S;P++)bp(o,p,P-o.G,f[P],!1,A,c);if(x)for(var Y in x)bp(o,p,+Y,x[Y],!0,A,c);return p}function jn(o,c,f){o==null&&(o=Ai),Ai=void 0;var p=this.constructor.i||0,x=0<p,A=this.constructor.h,S=!1;if(o==null){o=A?[A]:[];var P=48,Y=!0;x&&(p=0,P|=128),Dn(o,P)}else{if(!Array.isArray(o)||A&&A!==o[0])throw Error();var oe=P=$n(o,0);if((Y=(16&oe)!==0)&&((S=(32&oe)!==0)||(oe|=32)),x){if(128&oe)p=0;else if(0<o.length){var fe=o[o.length-1];if(Js(fe)&&"g"in fe){p=0,oe|=128,delete fe.g;var Be=!0,je;for(je in fe){Be=!1;break}Be&&o.pop()}}}else if(128&oe)throw Error();P!==oe&&Dn(o,oe)}this.G=(A?0:-1)-p,this.h=void 0,this.o=o;e:{if(A=this.o.length,p=A-1,A&&(A=this.o[p],Js(A))){this.B=A,this.i=p-this.G;break e}c!==void 0&&-1<c?(this.i=Math.max(c,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!x&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){c=Y&&!S&&!0,x=this.i;var ye;for(Y=0;Y<f.length;Y++)S=f[Y],S<x?(S+=this.G,(p=o[S])?Pp(p,c):o[S]=gs):(ye||(ye=ge(this)),(p=ye[S])?Pp(p,c):ye[S]=gs)}}jn.prototype.toJSON=function(){return Io(this.o,Ro,Yv)},jn.prototype.C=function(){return!!(gt(this.o)&2)};function Pp(o,c){if(Array.isArray(o)){var f=gt(o),p=1;!c||f&2||(p|=16),(f&p)!==p&&Dn(o,f|p)}}jn.prototype.ja=Si,jn.prototype.toString=function(){return this.o.toString()};function Ip(o,c,f){if(f){var p={},x;for(x in f){var A=f[x],S=A.qa;S||(p.J=A.wa||A.oa.W,A.ia?(p.aa=Op(A.ia),S=function(P){return function(Y,oe,fe){return P.J(Y,oe,fe,P.aa)}}(p)):A.ka?(p.Z=$p(A.da.P,A.ka),S=function(P){return function(Y,oe,fe){return P.J(Y,oe,fe,P.Z)}}(p)):S=p.J,A.qa=S),S(c,o,A.da),p={J:p.J,aa:p.aa,Z:p.Z}}}xi(c,o)}var Va=Symbol();function Rp(o,c,f){return o[Va]||(o[Va]=function(p,x){return c(p,x,f)})}function Bp(o){var c=o[Va];if(!c){var f=hc(o);c=function(p,x){return Dp(p,x,f)},o[Va]=c}return c}function Xv(o){var c=o.ia;if(c)return Bp(c);if(c=o.va)return Rp(o.da.P,c,o.ka)}function Kv(o){var c=Xv(o),f=o.da,p=o.oa.U;return c?function(x,A){return p(x,A,f,c)}:function(x,A){return p(x,A,f)}}function Lp(o,c){var f=o[c];return typeof f=="function"&&f.length===0&&(f=f(),o[c]=f),Array.isArray(f)&&(Lo in f||Bo in f||0<f.length&&typeof f[0]=="function")?f:void 0}function Fp(o,c,f,p,x,A){c.P=o[0];var S=1;if(o.length>S&&typeof o[S]!="number"){var P=o[S++];f(c,P)}for(;S<o.length;){f=o[S++];for(var Y=S+1;Y<o.length&&typeof o[Y]!="number";)Y++;switch(P=o[S++],Y-=S,Y){case 0:p(c,f,P);break;case 1:(Y=Lp(o,S))?(S++,x(c,f,P,Y)):p(c,f,P,o[S++]);break;case 2:Y=S++,Y=Lp(o,Y),x(c,f,P,Y,o[S++]);break;case 3:A(c,f,P,o[S++],o[S++],o[S++]);break;case 4:A(c,f,P,o[S++],o[S++],o[S++],o[S++]);break;default:throw Error("unexpected number of binary field arguments: "+Y)}}return c}var Ya=Symbol();function Op(o){var c=o[Ya];if(!c){var f=fc(o);c=function(p,x){return zp(p,x,f)},o[Ya]=c}return c}function $p(o,c){var f=o[Ya];return f||(f=function(p,x){return Ip(p,x,c)},o[Ya]=f),f}var Bo=Symbol();function Qv(o,c){o.push(c)}function Jv(o,c,f){o.push(c,f.W)}function Zv(o,c,f,p){var x=Op(p),A=fc(p).P,S=f.W;o.push(c,function(P,Y,oe){return S(P,Y,oe,A,x)})}function qv(o,c,f,p,x,A){var S=$p(p,A),P=f.W;o.push(c,function(Y,oe,fe){return P(Y,oe,fe,p,S)})}function fc(o){var c=o[Bo];return c||(c=Fp(o,o[Bo]=[],Qv,Jv,Zv,qv),Lo in o&&Bo in o&&(o.length=0),c)}var Lo=Symbol();function e3(o,c){o[0]=c}function t3(o,c,f,p){var x=f.U;o[c]=p?function(A,S,P){return x(A,S,P,p)}:x}function n3(o,c,f,p,x){var A=f.U,S=Bp(p),P=hc(p).P;o[c]=function(Y,oe,fe){return A(Y,oe,fe,P,S,x)}}function r3(o,c,f,p,x,A,S){var P=f.U,Y=Rp(p,x,A);o[c]=function(oe,fe,Be){return P(oe,fe,Be,p,Y,S)}}function hc(o){var c=o[Lo];return c||(c=Fp(o,o[Lo]={},e3,t3,n3,r3),Lo in o&&Bo in o&&(o.length=0),c)}function Dp(o,c,f){for(;wr(c)&&c.i!=4;){var p=c.l,x=f[p];if(!x){var A=f[0];A&&(A=A[p])&&(x=f[p]=Kv(A))}if(!x||!x(c,o,p)){x=c,p=o,A=x.j,Kr(x);var S=x;if(!S.ca){if(x=S.h.h-A,S.h.h=A,S=S.h,x==0)x=We();else{if(A=rn(S,x),S.S&&S.m)x=S.i.subarray(A,A+x);else{S=S.i;var P=A;x=A+x,x=P===x?ce():G?S.slice(P,x):new Uint8Array(S.subarray(P,x))}x=x.length==0?We():new ze(x,U)}(A=p.R)?A.push(x):p.R=[x]}}}return o}function zp(o,c,f){for(var p=f.length,x=p%2==1,A=x?1:0;A<p;A+=2)(0,f[A+1])(c,o,f[A]);Ip(o,c,x?f[0]:void 0)}function Fo(o,c){return{U:o,W:c}}var Sr=Fo(function(o,c,f){if(o.i!==5)return!1;o=o.h;var p=o.i,x=o.h,A=p[x],S=p[x+1],P=p[x+2];return p=p[x+3],zt(o,o.h+4),S=(A<<0|S<<8|P<<16|p<<24)>>>0,o=2*(S>>31)+1,A=S>>>23&255,S&=8388607,ae(c,f,A==255?S?NaN:1/0*o:A==0?o*Math.pow(2,-149)*S:o*Math.pow(2,A-150)*(S+Math.pow(2,23))),!0},function(o,c,f){if(c=it(c,f),c!=null){En(o.h,8*f+5),o=o.h;var p=+c;p===0?0<1/p?J=ee=0:(ee=0,J=2147483648):isNaN(p)?(ee=0,J=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(ee=0,J=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),ee=0,J=(f|p)>>>0):(c=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-c),p=Math.round(8388608*p),16777216<=p&&++c,ee=0,J=(f|c+127<<23|p&8388607)>>>0)),f=J,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),s3=Fo(function(o,c,f){if(o.i!==0)return!1;var p=o.h,x=0,A=o=0,S=p.i,P=p.h;do{var Y=S[P++];x|=(Y&127)<<A,A+=7}while(32>A&&Y&128);for(32<A&&(o|=(Y&127)>>4),A=3;32>A&&Y&128;A+=7)Y=S[P++],o|=(Y&127)<<A;if(zt(p,P),128>Y)p=x>>>0,Y=o>>>0,(o=Y&2147483648)&&(p=~p+1>>>0,Y=~Y>>>0,p==0&&(Y=Y+1>>>0)),p=4294967296*Y+(p>>>0);else throw V();return ae(c,f,o?-p:p),!0},function(o,c,f){c=xe(c,f),c!=null&&(typeof c=="string"&&C(c),c!=null&&(En(o.h,8*f),typeof c=="number"?(o=o.h,L(c),nr(o,J,ee)):(f=C(c),nr(o.h,f.i,f.h))))}),i3=Fo(function(o,c,f){return o.i!==0?!1:(ae(c,f,Tt(o.h)),!0)},function(o,c,f){if(c=xe(c,f),c!=null&&c!=null)if(En(o.h,8*f),o=o.h,f=c,0<=f)En(o,f);else{for(c=0;9>c;c++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),Up=Fo(function(o,c,f){if(o.i!==2)return!1;var p=Tt(o.h)>>>0;o=o.h;var x=rn(o,p);if(o=o.i,et){var A=o,S;(S=Fe)||(S=Fe=new TextDecoder("utf-8",{fatal:!0})),o=x+p,A=x===0&&o===A.length?A:A.subarray(x,o);try{var P=S.decode(A)}catch(Be){if(Pe===void 0){try{S.decode(new Uint8Array([128]))}catch{}try{S.decode(new Uint8Array([97])),Pe=!0}catch{Pe=!1}}throw!Pe&&(Fe=void 0),Be}}else{P=x,p=P+p,x=[];for(var Y=null,oe,fe;P<p;)oe=o[P++],128>oe?x.push(oe):224>oe?P>=p?de():(fe=o[P++],194>oe||(fe&192)!==128?(P--,de()):x.push((oe&31)<<6|fe&63)):240>oe?P>=p-1?de():(fe=o[P++],(fe&192)!==128||oe===224&&160>fe||oe===237&&160<=fe||((A=o[P++])&192)!==128?(P--,de()):x.push((oe&15)<<12|(fe&63)<<6|A&63)):244>=oe?P>=p-2?de():(fe=o[P++],(fe&192)!==128||(oe<<28)+(fe-144)>>30||((A=o[P++])&192)!==128||((S=o[P++])&192)!==128?(P--,de()):(oe=(oe&7)<<18|(fe&63)<<12|(A&63)<<6|S&63,oe-=65536,x.push((oe>>10&1023)+55296,(oe&1023)+56320))):de(),8192<=x.length&&(Y=Ee(Y,x),x.length=0);P=Ee(Y,x)}return ae(c,f,P),!0},function(o,c,f){if(c=xe(c,f),c!=null){var p=!1;if(p=p===void 0?!1:p,lt){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(c))throw Error("Found an unpaired surrogate");c=(Qe||(Qe=new TextEncoder)).encode(c)}else{for(var x=0,A=new Uint8Array(3*c.length),S=0;S<c.length;S++){var P=c.charCodeAt(S);if(128>P)A[x++]=P;else{if(2048>P)A[x++]=P>>6|192;else{if(55296<=P&&57343>=P){if(56319>=P&&S<c.length){var Y=c.charCodeAt(++S);if(56320<=Y&&57343>=Y){P=1024*(P-55296)+Y-56320+65536,A[x++]=P>>18|240,A[x++]=P>>12&63|128,A[x++]=P>>6&63|128,A[x++]=P&63|128;continue}else S--}if(p)throw Error("Found an unpaired surrogate");P=65533}A[x++]=P>>12|224,A[x++]=P>>6&63|128}A[x++]=P&63|128}}c=x===A.length?A:A.subarray(0,x)}En(o.h,8*f+2),En(o.h,c.length),On(o,o.h.end()),On(o,c)}}),Hp=Fo(function(o,c,f,p,x){if(o.i!==2)return!1;c=Vt(c,f,p),f=o.h.j,p=Tt(o.h)>>>0;var A=o.h.h+p,S=A-f;if(0>=S&&(o.h.j=A,x(c,o,void 0,void 0,void 0),S=A-o.h.h),S)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-S)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=A,o.h.j=f,!0},function(o,c,f,p,x){if(c=Ie(c,p,f),c!=null)for(p=0;p<c.length;p++){var A=o;En(A.h,8*f+2);var S=A.h.end();On(A,S),S.push(A.i),A=S,x(c[p],o),S=o;var P=A.pop();for(P=S.i+S.h.length()-P;127<P;)A.push(P&127|128),P>>>=7,S.i++;A.push(P),S.i++}});function pc(o){return function(c,f){e:{if(Rr.length){var p=Rr.pop();p.setOptions(f),ct(p.h,c,f),c=p}else c=new Xr(c,f);try{var x=hc(o),A=Dp(new x.P,c,x);break e}finally{x=c.h,x.i=null,x.m=!1,x.l=0,x.j=0,x.h=0,x.S=!1,c.l=-1,c.i=-1,100>Rr.length&&Rr.push(c)}A=void 0}return A}}function mc(o){return function(){var c=new ms;zp(this,c,fc(o)),On(c,c.h.end());for(var f=new Uint8Array(c.i),p=c.j,x=p.length,A=0,S=0;S<x;S++){var P=p[S];f.set(P,A),A+=P.length}return c.j=[f],f}}function Ci(o){jn.call(this,o)}K(Ci,jn);var Gp=[Ci,1,i3,2,Sr,3,Up,4,Up];Ci.prototype.l=mc(Gp);function gc(o){jn.call(this,o,-1,o3)}K(gc,jn),gc.prototype.addClassification=function(o,c){return Vt(this,1,Ci,o,c),this};var o3=[1],Wp=pc([gc,1,Hp,Gp]);function _i(o){jn.call(this,o)}K(_i,jn);var Vp=[_i,1,Sr,2,Sr,3,Sr,4,Sr,5,Sr];_i.prototype.l=mc(Vp);function Yp(o){jn.call(this,o,-1,a3)}K(Yp,jn);var a3=[1],Xp=pc([Yp,1,Hp,Vp]);function Xa(o){jn.call(this,o)}K(Xa,jn);var Kp=[Xa,1,Sr,2,Sr,3,Sr,4,Sr,5,Sr,6,s3],l3=pc(Kp);Xa.prototype.l=mc(Kp);function Qp(o,c,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function Jp(o){return Ie(o,Ci,1).map(function(c){var f=xe(c,1);return{index:f??0,score:Pt(c,2),label:xe(c,3)!=null?_n(xe(c,3),""):void 0,displayName:xe(c,4)!=null?_n(xe(c,4),""):void 0}})}function Zp(o){return{x:Pt(o,1),y:Pt(o,2),z:Pt(o,3),visibility:it(o,4)!=null?Pt(o,4):void 0}}function qp(o){return o.map(function(c){return Ie(Xp(c),_i,1).map(Zp)})}function yc(o,c){this.i=o,this.h=c,this.m=0}function em(o,c,f){return u3(o,c),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function u3(o,c){var f=o.h;if(o.s===void 0){var p=Qp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),x=Qp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),A=f.createProgram();if(f.attachShader(A,p),f.attachShader(A,x),f.linkProgram(A),!f.getProgramParameter(A,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(A));p=o.s=A,f.useProgram(p),x=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:x},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(x,0)}p=o.l,f.useProgram(o.s),f.canvas.width=c.width,f.canvas.height=c.height,f.viewport(0,0,c.width,c.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(c.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function c3(o){this.h=o}var d3=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function f3(o,c){return c+o}function tm(o,c){window[o]=c}function h3(o){var c=document.createElement("script");return c.setAttribute("src",o),c.setAttribute("crossorigin","anonymous"),new Promise(function(f){c.addEventListener("load",function(){f()},!1),c.addEventListener("error",function(){f()},!1),document.body.appendChild(c)})}function p3(){return X(function(o){switch(o.h){case 1:return o.s=2,M(o,WebAssembly.instantiate(d3),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function vc(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||f3,typeof window=="object")var c=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")c=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=c,o.options){c=u(Object.keys(o.options));for(var f=c.next();!f.done;f=c.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=vc.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function m3(o){var c,f,p,x,A,S,P,Y,oe,fe,Be;return X(function(je){switch(je.h){case 1:return o.ga?(c=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,M(je,p3(),2)):je.return();case 2:if(f=je.i,typeof window=="object")return tm("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),tm("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),S=c.filter(function(ye){return ye.data!==void 0}),P=c.filter(function(ye){return ye.data===void 0}),Y=Promise.all(S.map(function(ye){var Le=Ka(o,ye.url);if(ye.path!==void 0){var Ve=ye.path;Le=Le.then(function(yt){return o.overrideFile(Ve,yt),Promise.resolve(yt)})}return Le})),oe=Promise.all(P.map(function(ye){return ye.simd===void 0||ye.simd&&f||!ye.simd&&!f?h3(o.locateFile(ye.url,o.ha)):Promise.resolve()})).then(function(){var ye,Le,Ve;return X(function(yt){if(yt.h==1)return ye=window.createMediapipeSolutionsWasm,Le=window.createMediapipeSolutionsPackedAssets,Ve=o,M(yt,ye(Le),2);Ve.i=yt.i,yt.h=0})}),fe=function(){return X(function(ye){return o.h.graph&&o.h.graph.url?ye=M(ye,Ka(o,o.h.graph.url),0):(ye.h=0,ye=void 0),ye})}(),M(je,Promise.all([oe,Y,fe]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=c.filter(function(ye){return ye.simd===void 0||ye.simd&&f||!ye.simd&&!f}).map(function(ye){return o.locateFile(ye.url,o.ha)}),importScripts.apply(null,d(p)),x=o,M(je,createMediapipeSolutionsWasm(Module),6);case 6:x.i=je.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,A=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(A),je.h=4;break;case 7:if(o.m=document.createElement("canvas"),Be=o.m.getContext("webgl2",{}),!Be&&(Be=o.m.getContext("webgl",{}),!Be))return alert("Failed to create WebGL canvas context when passing video frame."),je.return();o.K=Be,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,je.h=0}})}function g3(o){var c,f,p,x,A,S,P,Y;return X(function(oe){if(oe.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return oe.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){oe.h=2;return}return o.fa=o.h.graph.url,M(oe,Ka(o,o.h.graph.url),3)}for(oe.h!=2&&(c=oe.i,o.j.loadGraph(c)),f=u(Object.keys(o.D)),p=f.next();!p.done;p=f.next())x=p.value,o.j.overrideFile(x,o.D[x]);if(o.D={},o.h.listeners)for(A=u(o.h.listeners),S=A.next();!S.done;S=A.next())P=S.value,w3(o,P);Y=o.l,o.l={},o.setOptions(Y),oe.h=0})}e.reset=function(){var o=this;return X(function(c){o.j&&(o.j.reset(),o.s={},o.v={}),c.h=0})},e.setOptions=function(o,c){var f=this;if(c=c||this.h.options){for(var p=[],x=[],A={},S=u(Object.keys(o)),P=S.next();!P.done;A={X:A.X,Y:A.Y},P=S.next())if(P=P.value,!(P in this.l&&this.l[P]===o[P])){this.l[P]=o[P];var Y=c[P];Y!==void 0&&(Y.onChange&&(A.X=Y.onChange,A.Y=o[P],p.push(function(oe){return function(){var fe;return X(function(Be){if(Be.h==1)return M(Be,oe.X(oe.Y),2);fe=Be.i,fe===!0&&(f.u=!0),Be.h=0})}}(A))),Y.graphOptionXref&&(P=Object.assign({},{calculatorName:"",calculatorIndex:0},Y.graphOptionXref,{valueNumber:Y.type===1?o[P]:0,valueBoolean:Y.type===0?o[P]:!1,valueString:Y.type===2?o[P]:""}),x.push(P)))}(p.length!==0||x.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(x),this.F=(this.F===void 0?[]:this.F).concat(p))}};function y3(o){var c,f,p,x,A,S,P;return X(function(Y){switch(Y.h){case 1:if(!o.u)return Y.return();if(!o.F){Y.h=2;break}c=u(o.F),f=c.next();case 3:if(f.done){Y.h=5;break}return p=f.value,M(Y,p(),4);case 4:f=c.next(),Y.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(x=new o.i.GraphOptionChangeRequestList,A=u(o.H),S=A.next();!S.done;S=A.next())P=S.value,x.push_back(P);o.j.changeOptions(x),x.delete(),o.H=void 0}o.u=!1,Y.h=0}})}e.initialize=function(){var o=this;return X(function(c){return c.h==1?M(c,m3(o),2):c.h!=3?M(c,g3(o),3):M(c,y3(o),0)})};function Ka(o,c){var f,p;return X(function(x){return c in o.L?x.return(o.L[c]):(f=o.locateFile(c,""),p=fetch(f).then(function(A){return A.arrayBuffer()}),o.L[c]=p,x.return(p))})}e.overrideFile=function(o,c){this.j?this.j.overrideFile(o,c):this.D[o]=c},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,c){var f=this,p,x,A,S,P,Y,oe,fe,Be;return X(function(je){switch(je.h){case 1:return f.h.inputs?(p=1e3*(c??performance.now()),M(je,f.I,2)):je.return();case 2:return M(je,f.initialize(),3);case 3:for(x=new f.i.PacketDataList,A=u(Object.keys(o)),S=A.next();!S.done;S=A.next())if(P=S.value,Y=f.h.inputs[P]){e:{var ye=o[P];switch(Y.type){case"video":var Le=f.s[Y.stream];if(Le||(Le=new yc(f.i,f.K),f.s[Y.stream]=Le),Le.m===0&&(Le.m=Le.i.createTexture()),typeof HTMLVideoElement<"u"&&ye instanceof HTMLVideoElement)var Ve=ye.videoWidth,yt=ye.videoHeight;else typeof HTMLImageElement<"u"&&ye instanceof HTMLImageElement?(Ve=ye.naturalWidth,yt=ye.naturalHeight):(Ve=ye.width,yt=ye.height);yt={glName:Le.m,width:Ve,height:yt},Ve=Le.h,Ve.canvas.width=yt.width,Ve.canvas.height=yt.height,Ve.activeTexture(Ve.TEXTURE0),Le.i.bindTexture2d(Le.m),Ve.texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,Ve.RGBA,Ve.UNSIGNED_BYTE,ye),Le.i.bindTexture2d(0),Le=yt;break e;case"detections":for(Le=f.s[Y.stream],Le||(Le=new c3(f.i),f.s[Y.stream]=Le),Le.data||(Le.data=new Le.h.DetectionListData),Le.data.reset(ye.length),yt=0;yt<ye.length;++yt){Ve=ye[yt];var ft=Le.data,sn=ft.setBoundingBox,rr=yt,Nn=Ve.la,nt=new Xa;if($e(nt,1,Nn.ra),$e(nt,2,Nn.sa),$e(nt,3,Nn.height),$e(nt,4,Nn.width),$e(nt,5,Nn.rotation),ae(nt,6,Nn.pa),Nn=nt.l(),sn.call(ft,rr,Nn),Ve.ea)for(ft=0;ft<Ve.ea.length;++ft){nt=Ve.ea[ft],sn=Le.data,rr=sn.addNormalizedLandmark,Nn=yt,nt=Object.assign({},nt,{visibility:nt.visibility?nt.visibility:0});var on=new _i;$e(on,1,nt.x),$e(on,2,nt.y),$e(on,3,nt.z),nt.visibility&&$e(on,4,nt.visibility),nt=on.l(),rr.call(sn,Nn,nt)}if(Ve.ba)for(ft=0;ft<Ve.ba.length;++ft)sn=Le.data,rr=sn.addClassification,Nn=yt,nt=Ve.ba[ft],on=new Ci,$e(on,2,nt.score),nt.index&&ae(on,1,nt.index),nt.label&&ae(on,3,nt.label),nt.displayName&&ae(on,4,nt.displayName),nt=on.l(),rr.call(sn,Nn,nt)}Le=Le.data;break e;default:Le={}}}switch(oe=Le,fe=Y.stream,Y.type){case"video":x.pushTexture2d(Object.assign({},oe,{stream:fe,timestamp:p}));break;case"detections":Be=oe,Be.stream=fe,Be.timestamp=p,x.pushDetectionList(Be);break;default:throw Error("Unknown input config type: '"+Y.type+"'")}}return f.j.send(x),M(je,f.I,4);case 4:x.delete(),je.h=0}})};function v3(o,c,f){var p,x,A,S,P,Y,oe,fe,Be,je,ye,Le,Ve,yt;return X(function(ft){switch(ft.h){case 1:if(!f)return ft.return(c);for(p={},x=0,A=u(Object.keys(f)),S=A.next();!S.done;S=A.next())P=S.value,Y=f[P],typeof Y!="string"&&Y.type==="texture"&&c[Y.stream]!==void 0&&++x;1<x&&(o.M=!1),oe=u(Object.keys(f)),S=oe.next();case 2:if(S.done){ft.h=4;break}if(fe=S.value,Be=f[fe],typeof Be=="string")return Ve=p,yt=fe,M(ft,x3(o,fe,c[Be]),14);if(je=c[Be.stream],Be.type==="detection_list"){if(je){for(var sn=je.getRectList(),rr=je.getLandmarksList(),Nn=je.getClassificationsList(),nt=[],on=0;on<sn.size();++on){var ys=l3(sn.get(on)),S3=Pt(ys,1),k3=Pt(ys,2),A3=Pt(ys,3),E3=Pt(ys,4),C3=Pt(ys,5,0),Qa=void 0;Qa=Qa===void 0?0:Qa,ys={la:{ra:S3,sa:k3,height:A3,width:E3,rotation:C3,pa:_n(xe(ys,6),Qa)},ea:Ie(Xp(rr.get(on)),_i,1).map(Zp),ba:Jp(Wp(Nn.get(on)))},nt.push(ys)}sn=nt}else sn=[];p[fe]=sn,ft.h=7;break}if(Be.type==="proto_list"){if(je){for(sn=Array(je.size()),rr=0;rr<je.size();rr++)sn[rr]=je.get(rr);je.delete()}else sn=[];p[fe]=sn,ft.h=7;break}if(je===void 0){ft.h=3;break}if(Be.type==="float_list"){p[fe]=je,ft.h=7;break}if(Be.type==="proto"){p[fe]=je,ft.h=7;break}if(Be.type!=="texture")throw Error("Unknown output config type: '"+Be.type+"'");return ye=o.v[fe],ye||(ye=new yc(o.i,o.K),o.v[fe]=ye),M(ft,em(ye,je,o.M),13);case 13:Le=ft.i,p[fe]=Le;case 7:Be.transform&&p[fe]&&(p[fe]=Be.transform(p[fe])),ft.h=3;break;case 14:Ve[yt]=ft.i;case 3:S=oe.next(),ft.h=2;break;case 4:return ft.return(p)}})}function x3(o,c,f){var p;return X(function(x){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?x.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[c],p||(p=new yc(o.i,o.K),o.v[c]=p),x.return(em(p,f,o.M))):x.return(void 0)})}function w3(o,c){for(var f=c.name||"$",p=[].concat(d(c.wants)),x=new o.i.StringList,A=u(c.wants),S=A.next();!S.done;S=A.next())x.push_back(S.value);A=o.i.PacketListener.implement({onResults:function(P){for(var Y={},oe=0;oe<c.wants.length;++oe)Y[p[oe]]=P.get(oe);var fe=o.listeners[f];fe&&(o.I=v3(o,Y,c.outs).then(function(Be){Be=fe(Be);for(var je=0;je<c.wants.length;++je){var ye=Y[p[je]];typeof ye=="object"&&ye.hasOwnProperty&&ye.hasOwnProperty("delete")&&ye.delete()}Be&&(o.I=Be)}))}}),o.j.attachMultiListener(x,A),x.delete()}e.onResults=function(o,c){this.listeners[c||"$"]=o},he("Solution",vc),he("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function nm(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function rm(o){var c=this;o=o||{},this.h=new vc({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:nm(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:qp},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:qp},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return Jp(Wp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,x,A;return X(function(S){return S.h==1?(p=nm(f),x="third_party/mediapipe/modules/hand_landmark/"+p,M(S,Ka(c.h,p),2)):(A=S.i,c.h.overrideFile(x,A),S.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=rm.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return X(function(c){return M(c,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var c=this;return X(function(f){return M(f,c.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},he("Hands",rm),he("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),he("VERSION","0.4.1675469240")}).call(xc);const zn=(...e)=>{},Lr={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},It={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function v1({hidden:e=!1}){const t=j.useRef(null),n=j.useRef(null),r=j.useRef(null),s=j.useRef(null),[i,a]=j.useState(!1),[u,d]=j.useState("None"),[h,g]=j.useState([]),[v,w]=j.useState(null),[_,R]=j.useState(null),[B,K]=j.useState(null),[E,y]=j.useState({a:null,b:null}),k=j.useRef(null),M=j.useRef(null),b=(L,m)=>{const T=localStorage.getItem(L);if(T===null)return m;const N=parseFloat(T);return Number.isFinite(N)?N:m},[H,I]=j.useState(()=>({roiSize:(()=>{const L=b(It.roiSize,44);return L>10?L:44})(),hueWeight:b(It.hueWeight,4),satWeight:b(It.satWeight,2),valWeight:b(It.valWeight,1),sensitivity:b(It.sensitivity,0)})),O=j.useRef(H),z=j.useRef(null),W=j.useRef(!1),X=j.useRef(0),Z=j.useRef(null),[Q,re]=j.useState([]),he=j.useRef([]),[pe,Se]=j.useState(()=>localStorage.getItem(It.selectedCamera)||""),se=j.useCallback(async()=>{try{const m=(await navigator.mediaDevices.enumerateDevices()).filter(T=>T.kind==="videoinput");return re(m),he.current=m,m}catch{return[]}},[]),te=j.useCallback(L=>{},[zn]),q=j.useCallback(async(L=null)=>{const m=t.current;if(!m)return;z.current&&(z.current.getTracks().forEach(C=>C.stop()),z.current=null),U();const T=++X.current;Z.current=null;const N=L!==null?L:pe;try{const C=N?{video:{deviceId:{exact:N}}}:{video:!0};if(N){const V=he.current.find(ie=>ie.deviceId===N);console.log("[Detector]  Loading SELECTED camera:",{deviceId:N,label:(V==null?void 0:V.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const F=await navigator.mediaDevices.getUserMedia(C);if(!W.current||T!==X.current){zn("Stale camera request (unmounted or superseded). Stopping stream."),F.getTracks().forEach(V=>V.stop());return}z.current=F;const D=F.getVideoTracks();if(zn("getUserMedia success. Tracks:",D),D.length>0){const V=D[0];console.log("[Detector]  Camera loaded successfully:",{label:V.label,deviceId:V.getSettings().deviceId,resolution:`${V.getSettings().width}x${V.getSettings().height}`,frameRate:V.getSettings().frameRate})}if(m.srcObject=F,await new Promise(V=>{if(m.readyState>=1&&m.videoWidth>0&&m.videoHeight>0)return V();const de=()=>{m.removeEventListener("loadedmetadata",de),V()};m.addEventListener("loadedmetadata",de,{once:!0}),setTimeout(()=>{m.removeEventListener("loadedmetadata",de),V()},1500)}),!W.current||T!==X.current){zn("Stale request before play(). Stopping stream."),F.getTracks().forEach(V=>V.stop());return}try{await m.play(),zn("video.play() promise resolved. Video should be playing.")}catch(V){if(console.error("[Detector] video.play() promise rejected:",V),zn("video.play() promise rejected:",V.name,V.message),T!==X.current){zn("play() aborted due to newer request."),F.getTracks().forEach(ie=>ie.stop());return}}if(Z.current!==T&&(Z.current=T,zn("Initializing MediaPipe for request id",T),Re()),W.current){const V=await se();if(!N||!L){const ie=V.find(de=>de.deviceId);ie&&ie.deviceId&&ie.deviceId!==pe&&(Se(ie.deviceId),localStorage.setItem(It.selectedCamera,ie.deviceId))}}}catch(C){console.error("[Detector] Error accessing camera:",C),zn("getUserMedia error:",C.name,C.message)}},[zn,se,te,pe]),me=(L,m,T)=>{const N=(L||0)*2,C=(m||0)/255,F=(T||0)/255,D=F*C,V=D*(1-Math.abs(N/60%2-1)),ie=F-D;let de=0,Ee=0,Pe=0;N>=0&&N<60?(de=D,Ee=V,Pe=0):N<120?(de=V,Ee=D,Pe=0):N<180?(de=0,Ee=D,Pe=V):N<240?(de=0,Ee=V,Pe=D):N<300?(de=V,Ee=0,Pe=D):(de=D,Ee=0,Pe=V);const Fe=Math.round((de+ie)*255),et=Math.round((Ee+ie)*255),Qe=Math.round((Pe+ie)*255);return`rgb(${Fe}, ${et}, ${Qe})`},Me=L=>L?me(L.h,L.s,L.v):"#ffffff",Ue=L=>L==="Player A"&&_?Me(_):L==="Player B"&&B?Me(B):L==="Red"?"#ff0000":L==="Blue"?"#0000ff":"#ffffff";j.useEffect(()=>{W.current=!0;const L=()=>{try{const N=JSON.parse(localStorage.getItem("calibrationA")||"null"),C=JSON.parse(localStorage.getItem("calibrationB")||"null");N&&R({h:N.h,s:N.s,v:N.v}),C&&K({h:C.h,s:C.s,v:C.v})}catch{}},m=N=>{!N||!N.key||(["calibrationA","calibrationB"].includes(N.key)&&L(),[It.roiSize,It.hueWeight,It.satWeight,It.valWeight,It.sensitivity].includes(N.key)&&I(C=>({roiSize:(()=>{const F=b(It.roiSize,(C==null?void 0:C.roiSize)??44);return F>10?F:(C==null?void 0:C.roiSize)??44})(),hueWeight:b(It.hueWeight,(C==null?void 0:C.hueWeight)??4),satWeight:b(It.satWeight,(C==null?void 0:C.satWeight)??2),valWeight:b(It.valWeight,(C==null?void 0:C.valWeight)??1),sensitivity:b(It.sensitivity,(C==null?void 0:C.sensitivity)??0)})))};return(async()=>{const N=await se();if(!W.current)return;const C=localStorage.getItem(It.selectedCamera);let F="";if(C&&N.some(D=>D.deviceId&&D.deviceId===C)){const D=N.find(V=>V.deviceId===C);F=C,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:C,label:(D==null?void 0:D.label)||"Unknown"})}else{C&&localStorage.removeItem(It.selectedCamera);const D=N.find(V=>V.deviceId);D&&D.deviceId?(F=D.deviceId,localStorage.setItem(It.selectedCamera,D.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:D.deviceId,label:D.label||"Unknown",savedCameraWas:C||"none"}),zn("Saved camera not found, using default camera:",D.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}Se(F?D=>D===F?D:F:D=>D||""),L()})(),window.addEventListener("storage",m),()=>{W.current=!1,X.current+=1,Z.current=null,s.current&&(s.current.stop(),s.current=null),z.current&&(z.current.getTracks().forEach(C=>C.stop()),z.current=null);const N=t.current;N&&(N.srcObject=null,te(N)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",m)}},[]),j.useEffect(()=>{k.current=_},[_]),j.useEffect(()=>{M.current=B},[B]),j.useEffect(()=>{O.current=H},[H]),j.useEffect(()=>{q(pe||null)},[pe,q]),j.useEffect(()=>{const L=setInterval(()=>{d(m=>(He(m),m))},1e3);return()=>clearInterval(L)},[]);const He=L=>{const T={timestamp:new Date().toISOString(),status:L};g(C=>[...C,T]);const N=JSON.parse(localStorage.getItem("braceletDetections")||"[]");N.push(T),localStorage.setItem("braceletDetections",JSON.stringify(N))},Re=async()=>{try{const L=await(async()=>{try{if(typeof lu.Hands=="function")return lu.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((T,N)=>{const C="mp-hands-cdn-script";if(document.getElementById(C))return T();const F=document.createElement("script");F.id=C,F.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",F.async=!0,F.onload=()=>T(),F.onerror=D=>N(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(F)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),m=new L({locateFile:T=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${T}`});if(m.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),m.onResults(De),r.current=m,t.current){const T=t.current;console.log("[Detector]  Starting manual frame capture from video element");let N;const C=async()=>{if(T.readyState>=2&&T.videoWidth>0)try{await m.send({image:T})}catch(F){console.error("[Detector] Error sending frame to MediaPipe:",F)}N=requestAnimationFrame(C)};C(),s.current={stop:()=>{N&&(cancelAnimationFrame(N),console.log("[Detector]  Stopped frame capture"))}}}}catch(L){console.error("MediaPipe initialization error:",L),w(`MediaPipe error: ${L.message}`)}},De=L=>{var D;const m=n.current,T=t.current;if(!m||!T)return;const N=m.getContext("2d");m.width=T.videoWidth,m.height=T.videoHeight,N.drawImage(T,0,0,m.width,m.height);let C="None";if(L.multiHandLandmarks&&L.multiHandLandmarks.length>0){zn("onResults: hands=",L.multiHandLandmarks.length);let V=null,ie=0;if(L.multiHandLandmarks.forEach(de=>{const Ee=de[0];Ee.y>ie&&(ie=Ee.y,V=de)}),L.multiHandLandmarks.forEach(de=>{ne(N,de,m.width,m.height)}),V){const de=V[0],Ee=de.x*m.width,Pe=de.y*m.height;N.fillStyle="lime",N.beginPath(),N.arc(Ee,Pe,10,0,2*Math.PI),N.fill(),N.fillStyle="lime",N.font="16px Arial",N.fillText("SELECTED",Ee-40,Pe-15);const et=Math.max(10,Math.min(300,Math.floor(((D=O.current)==null?void 0:D.roiSize)||60)))/2,Qe=Math.max(0,Ee-et),lt=Math.max(0,Pe-et),ut=Math.min(m.width,Ee+et),Ge=Math.min(m.height,Pe+et);N.strokeStyle="lime",N.lineWidth=3,N.strokeRect(Qe,lt,ut-Qe,Ge-lt);const ze=ut-Qe,We=Ge-lt;if(ze>0&&We>0)try{const Je=N.getImageData(Qe,lt,ze,We),Ct=k.current,Fn=M.current,ct=ve(Je,Ct,Fn);C=ct.status,y({a:ct.percentA,b:ct.percentB}),zn("Detection result:",C,{roi:{x1:Qe,y1:lt,w:ze,h:We}})}catch(Je){console.warn("[Detector] Failed to get ROI image data:",Je.message),C="None",y({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:ze,height:We}),C="None",y({a:null,b:null})}}let F="#ffffff";C==="Player A"&&k.current?F=Me(k.current):C==="Player B"&&M.current&&(F=Me(M.current)),N.fillStyle=F,N.font="bold 32px Arial",N.fillText(`Status: ${C}`,10,40),d(C),typeof window<"u"&&(window.currentBraceletStatus=C,window.braceletDetectorCanvas=m,window.braceletDetectorVideo=T)},ne=(L,m,T,N)=>{L.strokeStyle="white",L.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([F,D])=>{const V=m[F],ie=m[D];L.beginPath(),L.moveTo(V.x*T,V.y*N),L.lineTo(ie.x*T,ie.y*N),L.stroke()}),m.forEach(F=>{L.fillStyle="red",L.beginPath(),L.arc(F.x*T,F.y*N,5,0,2*Math.PI),L.fill()})},ue=L=>{const m=L.data;let T=0,N=0;for(let C=0;C<m.length;C+=4){const F=m[C],D=m[C+1],V=m[C+2],ie=ce(F,D,V);(ie[0]>=Lr.red.lower1[0]&&ie[0]<=Lr.red.upper1[0]||ie[0]>=Lr.red.lower2[0]&&ie[0]<=Lr.red.upper2[0])&&ie[1]>=Lr.red.lower1[1]&&ie[2]>=Lr.red.lower1[2]&&T++,ie[0]>=Lr.blue.lower[0]&&ie[0]<=Lr.blue.upper[0]&&ie[1]>=Lr.blue.lower[1]&&ie[2]>=Lr.blue.lower[2]&&N++}return{redCount:T,blueCount:N}},ve=(L,m,T)=>{var et,Qe,lt,ut;const N=L.data;if(m&&!T)return{status:"Player A",percentA:null,percentB:null};if(T&&!m)return{status:"Player B",percentA:null,percentB:null};const C=((et=O.current)==null?void 0:et.hueWeight)??4,F=((Qe=O.current)==null?void 0:Qe.satWeight)??2,D=((lt=O.current)==null?void 0:lt.valWeight)??1,V=((ut=O.current)==null?void 0:ut.sensitivity)??0;if(m&&T){let Ge=0,ze=0,We=0;for(let ct=0;ct<N.length;ct+=4){const zt=N[ct],Tt=N[ct+1],rn=N[ct+2],[Qt,Jt,nr]=ce(zt,Tt,rn),En=Math.min(1,Math.max(0,Jt/255)),Xr=Math.min(1,Math.max(0,nr/255)),wr=Math.max(.05,.5*En+.5*Xr),Kr=Math.min(Math.abs(Qt-m.h),180-Math.abs(Qt-m.h)),Rr=Math.min(Math.abs(Qt-T.h),180-Math.abs(Qt-T.h)),ms=Math.abs(Jt-m.s),On=Math.abs(Jt-T.s),xi=Math.abs(nr-m.v),Cn=Math.abs(nr-T.v),$n=Kr*C+ms*F+xi*D,Ks=Rr*C+On*F+Cn*D;Math.min($n,Ks)>180||($n<=Ks?Ge+=wr:ze+=wr,We+=wr)}if(We===0)return{status:"None",percentA:0,percentB:0};const Je=Ge/Math.max(1e-6,We),Ct=ze/Math.max(1e-6,We),Fn=.12*(1+.8*Math.max(0,Math.min(1,V)));return Je>=Fn&&Je>=Ct?{status:"Player A",percentA:Je,percentB:Ct}:Ct>=Fn&&Ct>Je?{status:"Player B",percentA:Je,percentB:Ct}:{status:"None",percentA:Je,percentB:Ct}}const{redCount:ie,blueCount:de}=ue(L),Ee=ie+de;if(Ee===0)return{status:"None",percentA:0,percentB:0};const Pe=ie/Ee,Fe=de/Ee;return Pe>=.15&&Pe>=Fe?{status:"Player A",percentA:Pe,percentB:Fe}:Fe>=.15&&Fe>Pe?{status:"Player B",percentA:Pe,percentB:Fe}:{status:"None",percentA:Pe,percentB:Fe}},ce=(L,m,T)=>{L/=255,m/=255,T/=255;const N=Math.max(L,m,T),C=Math.min(L,m,T),F=N-C;let D=0;F!==0&&(N===L?D=60*((m-T)/F%6):N===m?D=60*((T-L)/F+2):D=60*((L-m)/F+4)),D<0&&(D+=360);const V=N===0?0:F/N*255,ie=N*255;return[D/2,V,ie]},U=L=>{},G=L=>{Se(L),L?localStorage.setItem(It.selectedCamera,L):localStorage.removeItem(It.selectedCamera)},J=()=>{const L=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),m=new Blob([JSON.stringify(L,null,2)],{type:"application/json"}),T=URL.createObjectURL(m),N=document.createElement("a");N.href=T,N.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,N.click();const C=L.map(ie=>`${ie.timestamp}: ${ie.status}`).join(`
`),F=new Blob([C],{type:"text/plain"}),D=URL.createObjectURL(F),V=document.createElement("a");V.href=D,V.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,V.click()},ee=()=>{localStorage.removeItem("braceletDetections"),g([])};return l.jsx(l.Fragment,{children:l.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:J,title:"Download Logs",children:""}),l.jsx("button",{onClick:ee,title:"Clear Logs",children:""}),l.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),l.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{children:"Camera:"}),l.jsxs("select",{value:pe,onChange:L=>G(L.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[l.jsx("option",{value:"",children:"System Default"}),Q.map((L,m)=>{var V;const T=!!L.deviceId,N=T?L.deviceId:"",C=T?L.deviceId:`camera-${m}`,F=((V=L.label)==null?void 0:V.trim())||`Camera ${m+1}`,D=T?`  ${L.deviceId.slice(0,8)}`:" (needs permission)";return l.jsxs("option",{value:N,disabled:!T,children:[F,D]},C)})]})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),l.jsx("canvas",{ref:n,className:"output_canvas"}),l.jsxs("div",{className:"detector-info",children:[l.jsxs("div",{className:"status-display",children:["Status: ",l.jsx("span",{style:{color:Ue(u),fontWeight:700},children:u})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:_?Me(_):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:E.a==null?"":`${Math.round(Math.max(0,Math.min(1,E.a))*100)}%`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:B?Me(B):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:E.b==null?"":`${Math.round(Math.max(0,Math.min(1,E.b))*100)}%`})]})]}),l.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",_?`h${Math.round(_.h)} s${Math.round(_.s)} v${Math.round(_.v)}`:""]}),l.jsxs("div",{children:["B: ",B?`h${Math.round(B.h)} s${Math.round(B.s)} v${Math.round(B.v)}`:""]})]})]})]})]})})}const Xc=(...e)=>{console.log("[Calibrate]",...e)},Fr={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},dw=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,u=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,g=0,v=0;r>=0&&r<60?(h=a,g=u,v=0):r<120?(h=u,g=a,v=0):r<180?(h=0,g=a,v=u):r<240?(h=0,g=u,v=a):r<300?(h=u,g=0,v=a):(h=a,g=0,v=u);const w=Math.round((h+d)*255),_=Math.round((g+d)*255),R=Math.round((v+d)*255);return`rgb(${w}, ${_}, ${R})`},x1=e=>e?dw(e.h,e.s,e.v):"#444";function fw(){const e=j.useRef(null),t=j.useRef(null),n=j.useRef(null),r=j.useRef(!1),s=j.useRef(0),[i,a]=j.useState(!1),[u,d]=j.useState(""),[h,g]=j.useState(null),[v,w]=j.useState(null),_=(ne,ue)=>{const ve=localStorage.getItem(ne);if(ve===null)return ue;const ce=parseFloat(ve);return Number.isFinite(ce)?ce:ue},[R,B]=j.useState(()=>{const ne=_(Fr.roiSize,44);return ne>10?ne:44}),[K,E]=j.useState(()=>_(Fr.hueWeight,4)),[y,k]=j.useState(()=>_(Fr.satWeight,2)),[M,b]=j.useState(()=>_(Fr.valWeight,1)),[H,I]=j.useState(()=>_(Fr.sensitivity,0)),[O,z]=j.useState(!1),[W,X]=j.useState("idle"),[Z,Q]=j.useState(5),re=j.useRef({A:[],B:[]});j.useEffect(()=>{r.current=!0;try{const ne=JSON.parse(localStorage.getItem("calibrationA")||"null"),ue=JSON.parse(localStorage.getItem("calibrationB")||"null");ne&&g(ne),ue&&w(ue)}catch{}return(async()=>await he())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(ue=>ue.stop()),n.current=null);const ne=e.current;ne&&(ne.srcObject=null)}},[]),j.useEffect(()=>{localStorage.setItem(Fr.roiSize,String(R))},[R]),j.useEffect(()=>{localStorage.setItem(Fr.hueWeight,String(K))},[K]),j.useEffect(()=>{localStorage.setItem(Fr.satWeight,String(y))},[y]),j.useEffect(()=>{localStorage.setItem(Fr.valWeight,String(M))},[M]),j.useEffect(()=>{localStorage.setItem(Fr.sensitivity,String(H))},[H]);const he=j.useCallback(async()=>{const ne=e.current;if(!ne)return;n.current&&(n.current.getTracks().forEach(ve=>ve.stop()),n.current=null);const ue=++s.current;a(!1),d("Requesting camera...");try{const ve=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||ue!==s.current){ve.getTracks().forEach(ce=>ce.stop());return}if(n.current=ve,ne.srcObject=ve,await new Promise(ce=>{if(ne.readyState>=1&&ne.videoWidth>0)return ce();const G=()=>{ne.removeEventListener("loadedmetadata",G),ce()};ne.addEventListener("loadedmetadata",G,{once:!0}),setTimeout(()=>{ne.removeEventListener("loadedmetadata",G),ce()},1500)}),!r.current||ue!==s.current){ve.getTracks().forEach(ce=>ce.stop());return}try{await ne.play(),Xc("video.play resolved")}catch(ce){Xc("video.play rejected",ce)}a(!0),d("")}catch(ve){d(`Camera error: ${(ve==null?void 0:ve.message)||ve}`),Xc("getUserMedia error",ve)}},[]),pe=(ne,ue,ve)=>{ne/=255,ue/=255,ve/=255;const ce=Math.max(ne,ue,ve),U=Math.min(ne,ue,ve),G=ce-U;let J=0;G!==0&&(ce===ne?J=60*((ue-ve)/G%6):ce===ue?J=60*((ve-ne)/G+2):J=60*((ne-ue)/G+4)),J<0&&(J+=360);const ee=ce===0?0:G/ce*255,L=ce*255;return[J/2,ee,L]},Se=()=>{const ne=e.current,ue=t.current;if(!ne||!ue||ne.videoWidth===0)return null;const ve=ne.videoWidth,ce=ne.videoHeight;ue.width=ve,ue.height=ce;const U=ue.getContext("2d");U.drawImage(ne,0,0,ve,ce);const G=Math.max(10,Math.min(300,Math.floor(R))),J=Math.floor(ve/2-G/2),ee=Math.floor(ce/2-G/2),m=U.getImageData(J,ee,G,G).data;let T=0,N=0,C=0,F=0,D=0;for(let Qe=0;Qe<m.length;Qe+=4){const[lt,ut,Ge]=pe(m[Qe],m[Qe+1],m[Qe+2]),ze=lt*2*(Math.PI/180);T+=Math.cos(ze),N+=Math.sin(ze),C+=ut,F+=Ge,D++}if(D===0)return null;const V=C/D,ie=F/D,de=T/D,Ee=N/D;let Fe=Math.atan2(Ee,de)*(180/Math.PI);return Fe<0&&(Fe+=360),{h:Fe/2,s:V,v:ie}},se=ne=>{const ue=Se();if(!ue){d("Could not sample video frame.");return}ne==="A"?(localStorage.setItem("calibrationA",JSON.stringify(ue)),g(ue),d(`Saved Player A: h${ue.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(ue)),w(ue),d(`Saved Player B: h${ue.h.toFixed(0)}`))},te=ne=>{ne==="A"?(localStorage.removeItem("calibrationA"),g(null)):(localStorage.removeItem("calibrationB"),w(null)),d("Cleared")},q=()=>{z(!0),X("playerA"),Q(5),re.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};j.useEffect(()=>{if(!(!O||W==="idle"||W==="optimizing"||W==="complete"))if(Z>0){const ne=setTimeout(()=>{Q(Z-1)},1e3);return()=>clearTimeout(ne)}else W==="playerA"?(X("switching"),Q(3),d("Switch to Player B... Get ready!")):W==="switching"?(X("playerB"),Q(5),d("Hold Player B bracelet in center square...")):W==="playerB"&&(X("optimizing"),me())},[O,W,Z]),j.useEffect(()=>{if(!O||W==="idle"||W==="switching"||W==="optimizing"||W==="complete")return;const ne=setInterval(()=>{const ue=Se();ue&&(W==="playerA"?re.current.A.push(ue):W==="playerB"&&re.current.B.push(ue))},200);return()=>clearInterval(ne)},[O,W]);const me=()=>{d("Optimizing parameters...");const ne=re.current.A,ue=re.current.B;if(ne.length===0||ue.length===0){d("Error: Not enough samples collected!"),z(!1),X("idle");return}const ve=Me(ne),ce=Me(ue),U=Math.min(Math.abs(ve.h-ce.h),180-Math.abs(ve.h-ce.h)),G=Math.abs(ve.s-ce.s),J=Math.abs(ve.v-ce.v),ee=U/90,L=G/255,m=J/255,T=Ue(ne),N=Ue(ue),C={h:(T.h+N.h)/2,s:(T.s+N.s)/2,v:(T.v+N.v)/2},F=ee+L+m,D=F>0?ee/F*(1/(1+C.h/20))*6:2,V=F>0?L/F*(1/(1+C.s/50))*4:1,ie=F>0?m/F*(1/(1+C.v/50))*3:.5;E(Math.max(.5,Math.min(6,D))),k(Math.max(.1,Math.min(4,V))),b(Math.max(.1,Math.min(3,ie)));const de=He(ne,ue,ve,ce),Ee=Math.max(0,Math.min(.8,de*.5));I(Ee),localStorage.setItem("calibrationA",JSON.stringify(ve)),localStorage.setItem("calibrationB",JSON.stringify(ce)),g(ve),w(ce),X("complete"),d(` Auto-calibration complete! Collected ${ne.length+ue.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{z(!1),X("idle")},3e3)},Me=ne=>{const ue=ne.map(N=>N.h),ve=ne.map(N=>N.s).sort((N,C)=>N-C),ce=ne.map(N=>N.v).sort((N,C)=>N-C);let U=0,G=0;ue.forEach(N=>{const C=N*2*(Math.PI/180);U+=Math.cos(C),G+=Math.sin(C)});let ee=Math.atan2(G/ue.length,U/ue.length)*(180/Math.PI);ee<0&&(ee+=360);const L=ee/2,m=ve[Math.floor(ve.length/2)],T=ce[Math.floor(ce.length/2)];return{h:L,s:m,v:T}},Ue=ne=>{const ue=ne.reduce((ce,U)=>({h:ce.h+U.h,s:ce.s+U.s,v:ce.v+U.v}),{h:0,s:0,v:0});ue.h/=ne.length,ue.s/=ne.length,ue.v/=ne.length;const ve=ne.reduce((ce,U)=>({h:ce.h+Math.pow(U.h-ue.h,2),s:ce.s+Math.pow(U.s-ue.s,2),v:ce.v+Math.pow(U.v-ue.v,2)}),{h:0,s:0,v:0});return{h:ve.h/ne.length,s:ve.s/ne.length,v:ve.v/ne.length}},He=(ne,ue,ve,ce)=>{let U=0;const G=Math.min(ne.length,ue.length)*2;return ne.forEach(J=>{const ee=Re(J,ve);Re(J,ce)<ee*1.5&&U++}),ue.forEach(J=>{const ee=Re(J,ve),L=Re(J,ce);ee<L*1.5&&U++}),U/G},Re=(ne,ue)=>{const ve=Math.min(Math.abs(ne.h-ue.h),180-Math.abs(ne.h-ue.h)),ce=Math.abs(ne.s-ue.s),U=Math.abs(ne.v-ue.v);return Math.sqrt(ve*ve+ce*ce+U*U)},De=()=>{z(!1),X("idle"),Q(5),d("Generic mode cancelled")};return l.jsxs("div",{className:"calib-root",children:[l.jsxs("div",{className:"calib-header",children:[l.jsx("h2",{children:"Color Calibration"}),l.jsxs("div",{className:"calib-actions",children:[l.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),l.jsx("button",{onClick:he,children:"Restart Camera"})]})]}),u&&l.jsx("div",{className:"calib-message",children:u}),l.jsxs("div",{className:"calib-content",children:[l.jsx("div",{children:l.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[l.jsx("div",{className:"label",children:"Live Preview"}),l.jsx("div",{className:"value",style:{marginBottom:8},children:O?`Generic Mode Active: ${W==="playerA"?"Player A":W==="switching"?"Switching...":W==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),l.jsxs("div",{className:"calib-video-wrap",children:[l.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),l.jsx("div",{className:"calib-center-box",style:{width:R,height:R,borderColor:"#22d3ee",borderWidth:O?"4px":"3px",boxShadow:O?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),O&&Z>0&&l.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:Z})]})]})}),l.jsxs("div",{className:"calib-controls",children:[l.jsxs("div",{className:"calib-block",style:{background:O?"#1a2332":"#0f172a",border:O?"2px solid #22d3ee":"1px solid #1f2937"},children:[l.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),l.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),O?l.jsxs("div",{style:{marginTop:8},children:[l.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[W==="playerA"&&`Player A: Hold bracelet steady... ${Z}s`,W==="switching"&&`Switch hands! Get Player B ready... ${Z}s`,W==="playerB"&&`Player B: Hold bracelet steady... ${Z}s`,W==="optimizing"&&"Optimizing parameters...",W==="complete"&&" Complete!"]}),l.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[W==="playerA"&&`Samples collected: ${re.current.A.length}`,W==="switching"&&`Player A: ${re.current.A.length} samples collected`,W==="playerB"&&`Samples collected: ${re.current.B.length}`]}),W!=="complete"&&l.jsx("button",{onClick:De,style:{background:"#ef4444"},children:"Cancel"})]}):l.jsx("div",{className:"buttons",children:l.jsx("button",{onClick:q,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Detector Settings"}),l.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Detection square size"}),l.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:R,onChange:ne=>B(Number(ne.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[R,"px"]})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Hue weight"}),l.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:K,onChange:ne=>E(Number(ne.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:K.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Saturation weight"}),l.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:y,onChange:ne=>k(Number(ne.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:y.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Value weight"}),l.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:M,onChange:ne=>b(Number(ne.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:M.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:H,onChange:ne=>I(Number(ne.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[(H*100).toFixed(0),"%"]})]}),l.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player A"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:x1(h)}}),l.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>se("A"),disabled:!i,children:"Save A"}),l.jsx("button",{onClick:()=>te("A"),children:"Clear A"})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player B"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:x1(v)}}),l.jsx("span",{children:v?`h${v.h.toFixed(0)} s${v.s.toFixed(0)} v${v.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>se("B"),disabled:!i,children:"Save B"}),l.jsx("button",{onClick:()=>te("B"),children:"Clear B"})]})]})]})]}),l.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function Z2({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var L;const[a,u]=j.useState(e),[d,h]=j.useState(0),[g,v]=j.useState(!1),[w,_]=j.useState(1),[R,B]=j.useState(ca()),[K,E]=j.useState(!0),[y,k]=j.useState([]),[M,b]=j.useState(null),[H,I]=j.useState(!1),O=j.useRef(null),z=j.useRef(null),W=j.useRef(null),X=n&&!e,Z=["summary-container",r].filter(Boolean).join(" "),Q=(m,T)=>{const N=W.current;if(!N)return 0;const C=N.offsetHeight;return(m+.5)*C},re=j.useCallback((m,T=null)=>{const N=T||a;if(!N)return;let C=ca(),F=!0;const D=[];let V=null;for(let ie=0;ie<=m&&ie<N.moves.length;ie++){const de=N.moves[ie];de.phase==="experiment"&&F&&(F=!1,C=ca());const Ee=de.all_positions||(de.allPositions?de.allPositions.map(Pe=>[Pe[0]*.07,Pe[1]*.07]):null);if(de.type==="moveblock"&&Ee)Ee.length===10&&C.length===10?C=C.map((Pe,Fe)=>{const et=Ee[Fe];return et&&Array.isArray(et)&&et.length===2?{...Pe,position:[et[0],et[1]]}:Pe}):console.warn(`Position count mismatch: blocks=${C.length}, positions=${Ee==null?void 0:Ee.length}`),C=af(of(C),F),V=de.blockId!==void 0?de.blockId:de.unit;else if(de.type==="added shape to gallery"&&de.gallery_normalized){const Pe=document.createElement("canvas");Pe.width=400,Pe.height=400;const Fe=Pe.getContext("2d");Fe.fillStyle="#000",Fe.fillRect(0,0,400,400),de.gallery_normalized.forEach(et=>{const Qe=(et[0]+.5)*400,lt=(et[1]+.5)*400;Fe.fillStyle="green";const ut=60;Fe.fillRect(Qe-ut/2,lt-ut/2,ut,ut)}),D.push({number:de.gallery_shape_number,image:Pe.toDataURL()}),V=null}}B(C),E(F),k(D),b(V)},[a]),he=m=>{u(m),h(0),v(!1),setTimeout(()=>{re(0,m)},0)},pe=m=>{if(!X)return;const T=m.target.files[0];if(!T)return;const N=new FileReader;N.onload=C=>{try{const F=JSON.parse(C.target.result);he(F)}catch(F){alert("Failed to parse JSON file: "+F.message)}},N.readAsText(T)};j.useEffect(()=>{e&&he(e)},[e]),j.useEffect(()=>{a&&d>=0&&re(d)},[a,d,re]),j.useEffect(()=>{const m=()=>{a&&d>=0&&setTimeout(()=>{re(d)},100)};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[a,d,re]);const Se=m=>{a&&(m<0||m>=a.moves.length||(re(m),h(m)))},se=()=>{if(!a||g)return;v(!0),h(0),re(0);let m=0;z.current=setInterval(()=>{if(m>=a.moves.length){te();return}m++,re(m),h(m)},1e3/w)},te=()=>{z.current&&(clearInterval(z.current),z.current=null),v(!1)};if(j.useEffect(()=>()=>{z.current&&clearInterval(z.current)},[]),j.useEffect(()=>{if(g&&z.current){clearInterval(z.current),z.current=null;const m=d;h(0),v(!1),setTimeout(()=>{h(m),se()},0)}},[w]),!a)return X?l.jsx("div",{className:Z,children:l.jsxs("div",{className:"summary-upload",children:[l.jsx("h1",{children:t}),l.jsx("p",{children:"Load a game session JSON file to view the replay"}),l.jsx("input",{ref:O,type:"file",accept:".json",onChange:pe,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var m;return(m=O.current)==null?void 0:m.click()},children:"Load JSON File"})]})}):null;const q=a.moves[d],me=a.moves.length,Me=((L=a.summary)==null?void 0:L.movesByPlayer)||{},Ue=Object.entries(Me||{}),He=(m,T=1)=>Number.isFinite(m)?m.toFixed(T):"",Re=a.sessionInfo||{},De=Re.subjectId||Re.id||a.subjectId||a.id||null,ne=Re.sessionGameId||a.sessionGameId||De||null,ue=Re.condition||a.condition||null,ve=a.startTime||Re.startedAt||Re.date||null,ce=a.endTime||Re.endedAt||null,U=m=>{if(!m)return null;try{const T=new Date(m);if(!Number.isNaN(T.getTime()))return T.toLocaleString()}catch{}return m},G=[];ne&&G.push({label:"Session ID",value:ne}),De&&De!==ne&&G.push({label:"Participant",value:De}),ue&&G.push({label:"Condition",value:ue});const J=U(ve);J&&G.push({label:"Start",value:J});const ee=U(ce);return ee&&G.push({label:"End",value:ee}),l.jsxs("div",{className:Z,children:[l.jsxs("div",{className:"summary-header",children:[l.jsx("h1",{children:t}),G.length>0&&l.jsx("div",{className:"summary-session-info",children:G.map(m=>l.jsxs("div",{className:"summary-session-info-item",children:[l.jsx("span",{className:"summary-session-info-label",children:m.label}),l.jsx("span",{className:"summary-session-info-value",children:m.value})]},`${m.label}-${m.value}`))})]}),l.jsxs("div",{className:"summary-main",children:[l.jsxs("div",{className:"summary-left",children:[l.jsx("div",{className:"summary-game-area",children:l.jsxs("div",{className:"game-canvas",ref:W,children:[l.jsx("div",{className:"gallery",children:l.jsx("div",{className:"gallery-frame",children:y.length>0?l.jsx("img",{src:y[y.length-1].image,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),R.map((m,T)=>{const N=m.position||[0,0];return!Array.isArray(N)||N.length!==2||!Number.isFinite(N[0])||!Number.isFinite(N[1])?(console.warn(`Invalid position for block ${m.id}:`,N),null):l.jsx("div",{className:`block ${m.canMove?"movable":""} ${m.id===M?"highlighted":""}`,style:{left:`${Q(N[0])}px`,top:`${Q(N[1])}px`,backgroundColor:m.color||"green",cursor:m.canMove?"grab":"default",zIndex:m.id===M?20:T+1}},m.id)})]})}),l.jsxs("div",{className:"summary-progress",children:[l.jsx("input",{type:"range",min:"0",max:Math.max(0,me-1),value:d,onChange:m=>Se(parseInt(m.target.value)),style:{width:"100%"}}),l.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",me,q&&l.jsxs("span",{className:"move-info",children:[" "," Player: ",q.player,Array.isArray(q.position)&&q.position.length===2&&`  Position: (${q.position[0]}, ${q.position[1]})`,Number.isFinite(q.holdTime)&&`  Hold: ${He(q.holdTime,2)}s`," "," Time: ",He(q.elapsed,1),"s"]})]})]})]}),l.jsxs("div",{className:"summary-right",children:[l.jsxs("div",{className:"summary-stats",children:[l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Duration"}),l.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),l.jsx("span",{className:"summary-stats-value",children:me})]}),l.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[l.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),l.jsx("div",{className:"summary-stats-value",children:Ue.length===0?l.jsx("span",{children:""}):Ue.map(([m,T])=>l.jsxs("div",{children:[m,": ",T]},m))})]})]}),l.jsxs("div",{className:"summary-controls",children:[l.jsx("button",{onClick:()=>Se(0),disabled:d===0,children:" First"}),l.jsx("button",{onClick:()=>Se(d-1),disabled:d===0,children:" Previous"}),l.jsx("button",{onClick:g?te:se,children:g?" Pause":" Play"}),l.jsx("button",{onClick:()=>Se(d+1),disabled:d>=me-1,children:" Next"}),l.jsx("button",{onClick:()=>Se(me-1),disabled:d>=me-1,children:" Last"}),l.jsxs("div",{className:"speed-control",children:[l.jsx("label",{children:"Speed:"}),l.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:w,onChange:m=>_(parseFloat(m.target.value))}),l.jsxs("span",{children:[w,"x"]})]}),X&&l.jsxs(l.Fragment,{children:[l.jsx("input",{ref:O,type:"file",accept:".json",onChange:pe,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var m;return(m=O.current)==null?void 0:m.click()},children:" Load New File"})]})]}),l.jsxs("div",{className:"summary-moves-list",children:[l.jsxs("div",{className:"move-list-header",children:[l.jsx("h2",{children:"Move History"}),i&&l.jsx("button",{className:`edit-mode-toggle ${H?"active":""}`,onClick:()=>I(!H),children:H?" Done Editing":"Edit Players"})]}),l.jsx("div",{className:"moves-scroll",children:a.moves.map((m,T)=>l.jsxs("div",{className:`move-item ${T===d?"active":""} ${H?"edit-mode":""}`,onClick:()=>!H&&Se(T),children:[l.jsx("div",{className:"move-number",children:T+1}),m.camera_frame&&l.jsx("div",{className:"move-camera-frame",children:l.jsx("img",{src:m.camera_frame,alt:`Camera frame for move ${T+1}`,className:"camera-frame-thumbnail"})}),l.jsxs("div",{className:"move-details",children:[l.jsx("div",{className:"move-type",children:m.type}),H&&i?l.jsxs("div",{className:"move-player-edit",children:[l.jsx("label",{children:"Player:"}),l.jsxs("select",{value:m.player||"Unknown",onChange:N=>{const C=N.target.value;i(m._id,C)},onClick:N=>N.stopPropagation(),children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):l.jsxs("div",{className:"move-player",children:["Player: ",m.player]}),m.blockId!==null&&m.blockId!==void 0||m.unit!==null&&m.unit!==void 0?l.jsxs("div",{className:"move-unit",children:["Block: ",m.blockId!==void 0?m.blockId:m.unit]}):null,Array.isArray(m.position)&&m.position.length===2&&l.jsxs("div",{className:"move-position",children:["Position: (",m.position[0],", ",m.position[1],")"]}),Number.isFinite(m.holdTime)&&m.holdTime>0&&l.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",He(m.holdTime,2),"s"]}),l.jsxs("div",{className:"move-time",children:["Time: ",He(m.elapsed,1),"s"]})]})]},T))})]})]})]})]})}const Zt=(...e)=>{console.log("[Detector2]",...e)},gn={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function hw(){const e=j.useRef(null),t=j.useRef(null),n=j.useRef(null),r=j.useRef(null),s=j.useRef(null),i=j.useRef(null),a=j.useRef(null),u=j.useRef(null),d=j.useRef(null),[h,g]=j.useState(""),[v,w]=j.useState(!1),[_,R]=j.useState({camA:"None",camB:"None",merged:"None"}),[B,K]=j.useState(!0),[E,y]=j.useState(null),[k,M]=j.useState(null),b=j.useRef(null),H=j.useRef(null),I=(m,T)=>{const N=localStorage.getItem(m);if(N===null)return T;const C=parseFloat(N);return Number.isFinite(C)?C:T},[O,z]=j.useState(()=>({roiSize:(()=>{const m=I(gn.roiSize,44);return m>10?m:44})(),hueWeight:I(gn.hueWeight,4),satWeight:I(gn.satWeight,2),valWeight:I(gn.valWeight,1),sensitivity:I(gn.sensitivity,0)})),W=j.useRef(O),[X,Z]=j.useState([]),[Q,re]=j.useState(""),[he,pe]=j.useState("");j.useEffect(()=>{let m=!0;(async()=>{try{const F=(await navigator.mediaDevices.enumerateDevices()).filter(V=>V.kind==="videoinput");if(F.length===0){g("No cameras found");return}Z(F);const D=F.slice(0,2).map(V=>V.deviceId);re(D[0]||""),pe(D[1]||D[0]||""),await Se(D[0],e,u),D[1]?await Se(D[1],t,d):await Se(D[0],t,d),await He(),await Re("A",e,i),await Re("B",t,a)}catch(C){if(!m)return;g((C==null?void 0:C.message)||String(C))}})();const T=()=>{try{const C=JSON.parse(localStorage.getItem("calibrationA")||"null"),F=JSON.parse(localStorage.getItem("calibrationB")||"null");C&&y({h:C.h,s:C.s,v:C.v}),F&&M({h:F.h,s:F.s,v:F.v})}catch{Zt("No existing calibrations")}};T();const N=C=>{!C||!C.key||(["calibrationA","calibrationB"].includes(C.key)&&T(),[gn.roiSize,gn.hueWeight,gn.satWeight,gn.valWeight,gn.sensitivity].includes(C.key)&&z(F=>({roiSize:(()=>{const D=I(gn.roiSize,(F==null?void 0:F.roiSize)??44);return D>10?D:(F==null?void 0:F.roiSize)??44})(),hueWeight:I(gn.hueWeight,(F==null?void 0:F.hueWeight)??4),satWeight:I(gn.satWeight,(F==null?void 0:F.satWeight)??2),valWeight:I(gn.valWeight,(F==null?void 0:F.valWeight)??1),sensitivity:I(gn.sensitivity,(F==null?void 0:F.sensitivity)??0)})))};return window.addEventListener("storage",N),()=>{if(m=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),u.current&&(u.current.getTracks().forEach(D=>D.stop()),u.current=null),d.current&&(d.current.getTracks().forEach(D=>D.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const C=e.current;C&&(C.srcObject=null);const F=t.current;F&&(F.srcObject=null),window.removeEventListener("storage",N)}},[]);const Se=async(m,T,N)=>{const C={video:{deviceId:{exact:m}}};Zt("Starting camera with deviceId:",m);const F=await navigator.mediaDevices.getUserMedia(C);N.current=F;const D=T.current;if(!D){Zt("Video element not found!");return}D.srcObject=F,Zt("Stream assigned to video element, waiting for metadata..."),await new Promise(V=>{if(D.readyState>=2&&D.videoWidth>0&&D.videoHeight>0)return Zt("Video already ready:",D.videoWidth,"x",D.videoHeight),V();const de=()=>{Zt("loadedmetadata event fired:",D.videoWidth,"x",D.videoHeight),D.removeEventListener("loadedmetadata",de),V()};D.addEventListener("loadedmetadata",de,{once:!0}),setTimeout(()=>{Zt("Metadata timeout - proceeding anyway"),D.removeEventListener("loadedmetadata",de),V()},2e3)});try{await D.play(),Zt("Video play() succeeded")}catch(V){Zt("Video play() failed:",V)}},se=j.useRef(null),te=j.useRef(null),q=j.useRef(null),me=j.useRef(!1),Me=async()=>{if(!me.current){me.current=!0;try{for(;te.current||q.current;){const m=s.current;if(!m)break;let T=null,N=null;if(te.current?(T="A",N=te.current,te.current=null):q.current&&(T="B",N=q.current,q.current=null),!!N){se.current=T;try{await m.send({image:N})}catch(C){console.error("[Detector2] hands.send error:",C);break}}}}finally{me.current=!1}}},Ue=(m,T)=>{m==="A"?te.current=T:q.current=T,Promise.resolve().then(Me)},He=async()=>{if(s.current)return s.current;try{const m=await(async()=>{try{if(typeof lu.Hands=="function")return lu.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const N=document.getElementById("mp-hands-cdn-script");if(N&&(await new Promise(C=>{if(window.Hands&&typeof window.Hands=="function")return C();const F=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(F),C())},50);setTimeout(()=>{clearInterval(F),C()},3e3)}),window.Hands&&typeof window.Hands=="function")||(N||await new Promise((C,F)=>{const D=document.createElement("script");D.id="mp-hands-cdn-script",D.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",D.async=!0,D.onload=()=>C(),D.onerror=V=>F(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(D)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),T=new m({locateFile:N=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${N}`});return T.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),T.onResults(N=>{const C=se.current;C==="A"?ue(N):C==="B"&&ve(N)}),s.current=T,T}catch(m){return console.error("MediaPipe initialization error:",m),g(`MediaPipe error: ${m.message}`),null}},Re=async(m,T,N)=>{if(!await He())return;const F=T.current;if(!F){Zt(`Video ref for ${m} not found`);return}Zt(`Initializing manual frame capture for camera ${m}, video dimensions:`,F.videoWidth,"x",F.videoHeight);let D=null;const V=()=>{const ie=T.current;ie&&ie.readyState>=2&&ie.videoWidth>0&&Ue(m,ie),D=requestAnimationFrame(V)};D=requestAnimationFrame(V),N.current={stop:()=>{D&&(cancelAnimationFrame(D),D=null,Zt(`Stopped manual frame capture for camera ${m}`))}},Zt(`Manual frame capture started for camera ${m}`)},De=j.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),ne=j.useRef({wristY:null,player:"None",landmarks:null,wristX:null});j.useEffect(()=>{b.current=E},[E]),j.useEffect(()=>{H.current=k},[k]),j.useEffect(()=>{W.current=O},[O]);const ue=m=>ce(m,n,"A"),ve=m=>ce(m,r,"B"),ce=(m,T,N)=>{var ut;const C=T.current;if(!C)return;const F=C.getContext("2d");if(!F)return;const D=N==="A"?e.current:t.current;if(!D||D.videoWidth===0||D.videoHeight===0){N==="A"?De.current={wristY:null,wristX:null,landmarks:null,player:"None"}:ne.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}C.width=D.videoWidth,C.height=D.videoHeight,F.drawImage(D,0,0,C.width,C.height),F.fillStyle="rgba(0, 0, 0, 0.6)",F.fillRect(C.width-80,5,75,20),F.fillStyle="white",F.font="bold 14px Arial",F.fillText(`Camera ${N}`,C.width-75,20);let V=null,ie=null,de=null,Ee=[];if(m.multiHandLandmarks&&m.multiHandLandmarks.length>0)for(const Ge of m.multiHandLandmarks){const ze=Ge[0],We=ze.x*C.width,Je=ze.y*C.height;Ee.push({x:We,y:Je,landmarks:Ge}),(V===null||(B?Je<V:Je>V))&&(V=Je,ie=Ge,de=We)}Ee.forEach(({x:Ge,y:ze})=>{F.fillStyle="orange",F.beginPath(),F.arc(Ge,ze,8,0,Math.PI*2),F.fill()});let Pe="None";if(ie){F.fillStyle="lime",F.beginPath(),F.arc(de,V,10,0,2*Math.PI),F.fill(),F.fillStyle="lime",F.font="16px Arial",F.fillText("SELECTED",de-40,V-15);const ze=Math.max(10,Math.min(300,Math.floor(((ut=W.current)==null?void 0:ut.roiSize)||60)))/2,We=Math.max(0,de-ze),Je=Math.max(0,V-ze),Ct=Math.min(C.width,de+ze),Fn=Math.min(C.height,V+ze),ct=Math.max(0,Math.floor(We)),zt=Math.max(0,Math.floor(Je));let Tt=Math.floor(Ct-We),rn=Math.floor(Fn-Je);if(Tt=Math.max(1,Tt),rn=Math.max(1,rn),Tt=Math.min(Tt,C.width-ct),rn=Math.min(rn,C.height-zt),Tt>0&&rn>0){F.strokeStyle="lime",F.lineWidth=3,F.strokeRect(ct,zt,Tt,rn);try{const Qt=F.getImageData(ct,zt,Tt,rn),Jt=b.current,nr=H.current;Pe=G(Qt,Jt,nr).status}catch(Qt){console.warn("[Detector2] ROI sampling failed:",Qt),Pe="None"}}else Zt("ROI skipped due to zero width/height",{width:Tt,height:rn,left:ct,top:zt})}if(Ee.length>=1){let Ge=Ee[0].y,ze=Ee[0].y;Ee.forEach(Ct=>{Ct.y<Ge&&(Ge=Ct.y),Ct.y>ze&&(ze=Ct.y)}),F.strokeStyle="yellow",F.setLineDash([6,4]),F.beginPath(),F.moveTo(0,B?Ge:ze),F.lineTo(C.width,B?Ge:ze),F.stroke(),F.strokeStyle="cyan",F.beginPath(),F.moveTo(0,B?ze:Ge),F.lineTo(C.width,B?ze:Ge),F.stroke(),F.setLineDash([]);const We=B?"A (top)":"A (bottom)",Je=B?"B (bottom)":"B (top)";F.fillStyle="lime",F.font="16px Arial",F.fillText(We,6,Math.max(14,(B?Ge:ze)-6)),F.fillStyle="dodgerblue",F.fillText(Je,6,Math.min(C.height-6,(B?ze:Ge)+18))}const Fe={wristY:V,wristX:de,landmarks:ie,player:Pe};N==="A"?De.current=Fe:ne.current=Fe;const et=De.current.wristY,Qe=ne.current.wristY;let lt="None";if(et!=null||Qe!=null){const Ge=B?(We,Je)=>We==null?Je:Math.min(We,Je):(We,Je)=>We==null?Je:Math.max(We,Je);[et,Qe].filter(We=>We!=null).reduce(Ge,null)===et?lt=De.current.player:lt=ne.current.player}R({camA:De.current.player,camB:ne.current.player,merged:lt})},U=(m,T,N)=>{m/=255,T/=255,N/=255;const C=Math.max(m,T,N),F=Math.min(m,T,N),D=C-F;let V=0;D!==0&&(C===m?V=60*((T-N)/D%6):C===T?V=60*((N-m)/D+2):V=60*((m-T)/D+4)),V<0&&(V+=360);const ie=C===0?0:D/C*255,de=C*255;return[V/2,ie,de]},G=(m,T,N)=>{var de,Ee,Pe,Fe;const C=m.data;if(T&&!N)return{status:"Player A",percentA:null,percentB:null};if(N&&!T)return{status:"Player B",percentA:null,percentB:null};const F=((de=W.current)==null?void 0:de.hueWeight)??4,D=((Ee=W.current)==null?void 0:Ee.satWeight)??2,V=((Pe=W.current)==null?void 0:Pe.valWeight)??1,ie=((Fe=W.current)==null?void 0:Fe.sensitivity)??0;if(T&&N){let et=0,Qe=0,lt=0;for(let We=0;We<C.length;We+=4){const Je=C[We],Ct=C[We+1],Fn=C[We+2],[ct,zt,Tt]=U(Je,Ct,Fn),rn=Math.min(1,Math.max(0,zt/255)),Qt=Math.min(1,Math.max(0,Tt/255)),Jt=Math.max(.05,.5*rn+.5*Qt),nr=Math.min(Math.abs(ct-T.h),180-Math.abs(ct-T.h)),En=Math.min(Math.abs(ct-N.h),180-Math.abs(ct-N.h)),Xr=Math.abs(zt-T.s),wr=Math.abs(zt-N.s),Kr=Math.abs(Tt-T.v),Rr=Math.abs(Tt-N.v),ms=nr*F+Xr*D+Kr*V,On=En*F+wr*D+Rr*V;Math.min(ms,On)>180||(ms<=On?et+=Jt:Qe+=Jt,lt+=Jt)}if(lt===0)return{status:"None",percentA:0,percentB:0};const ut=et/Math.max(1e-6,lt),Ge=Qe/Math.max(1e-6,lt),ze=.12*(1+.8*Math.max(0,Math.min(1,ie)));return ut>=ze&&ut>=Ge?{status:"Player A",percentA:ut,percentB:Ge}:Ge>=ze&&Ge>ut?{status:"Player B",percentA:ut,percentB:Ge}:{status:"None",percentA:ut,percentB:Ge}}return{status:"None",percentA:0,percentB:0}},J=(m,T,N)=>{const C=(m||0)*2,F=(T||0)/255,D=(N||0)/255,V=D*F,ie=V*(1-Math.abs(C/60%2-1)),de=D-V;let Ee=0,Pe=0,Fe=0;C>=0&&C<60?(Ee=V,Pe=ie,Fe=0):C<120?(Ee=ie,Pe=V,Fe=0):C<180?(Ee=0,Pe=V,Fe=ie):C<240?(Ee=0,Pe=ie,Fe=V):C<300?(Ee=ie,Pe=0,Fe=V):(Ee=V,Pe=0,Fe=ie);const et=Math.round((Ee+de)*255),Qe=Math.round((Pe+de)*255),lt=Math.round((Fe+de)*255);return`rgb(${et}, ${Qe}, ${lt})`},ee=m=>m?J(m.h,m.s,m.v):"#ffffff",L=async(m,T)=>{try{if(m==="A"){if(re(T),i.current){try{i.current.stop()}catch(C){Zt("Stop camA error:",C)}i.current=null}u.current&&(u.current.getTracks().forEach(C=>C.stop()),u.current=null);const N=e.current;N&&(N.srcObject=null),await new Promise(C=>setTimeout(C,100)),await Se(T,e,u),await new Promise(C=>setTimeout(C,200)),await He(),await Re("A",e,i),Zt("Camera A switched to:",T)}else{if(pe(T),a.current){try{a.current.stop()}catch(C){Zt("Stop camB error:",C)}a.current=null}d.current&&(d.current.getTracks().forEach(C=>C.stop()),d.current=null);const N=t.current;N&&(N.srcObject=null),await new Promise(C=>setTimeout(C,100)),await Se(T,t,d),await new Promise(C=>setTimeout(C,200)),await He(),await Re("B",t,a),Zt("Camera B switched to:",T)}}catch(N){console.error("[Detector2] Camera switch error:",N),g(`Camera switch error: ${N.message}`)}};return l.jsxs("div",{className:`detector-window ${v?"minimized":""}`,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:()=>w(!v),children:v?"":""}),l.jsx("button",{onClick:()=>K(!B),title:"Toggle A criterion",children:B?"A=Top":"A=Bottom"})]})]}),l.jsxs("div",{className:"detector-content",style:{display:v?"none":"block"},children:[l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera A:"}),l.jsx("select",{value:Q,onChange:m=>L("A",m.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:X.map(m=>l.jsx("option",{value:m.deviceId,children:m.label||`Camera ${m.deviceId.slice(0,8)}`},m.deviceId))})]}),l.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:n,className:"output_canvas"})]}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera B:"}),l.jsx("select",{value:he,onChange:m=>L("B",m.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:X.map(m=>l.jsx("option",{value:m.deviceId,children:m.label||`Camera ${m.deviceId.slice(0,8)}`},m.deviceId))})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),l.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[l.jsxs("div",{className:"status-display",children:["Merged: ",l.jsx("strong",{children:_.merged})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:E?ee(E):"#444"}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:k?ee(k):"#444"}})]})]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",E?`h${Math.round(E.h)} s${Math.round(E.s)} v${Math.round(E.v)}`:""]}),l.jsxs("div",{children:["B: ",k?`h${Math.round(k.h)} s${Math.round(k.s)} v${Math.round(k.v)}`:""]})]}),h&&l.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),l.jsxs("div",{style:{fontSize:12,marginTop:6},children:[l.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const Vo=Fu(),w1=e=>{var i,a,u,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((g,v)=>typeof v.elapsed=="number"&&v.elapsed>g?v.elapsed:g,0),r={},s={};return t.forEach(g=>{const v=(g==null?void 0:g.player)||"Unknown";r[v]=(r[v]||0)+1;const w=(g==null?void 0:g.phase)||"unknown";s[w]=(s[w]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((u=(a=e.metadata)==null?void 0:a.config)==null?void 0:u.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},pw=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},S1="adminPassword";function mw(){var X;const[e,t]=j.useState([]),[n,r]=j.useState(!0),[s,i]=j.useState(null),[a,u]=j.useState(null),[d,h]=j.useState(null),[g,v]=j.useState(!1),[w,_]=j.useState(null),[R,B]=j.useState(!1),[K,E]=j.useState(""),[y,k]=j.useState(!1);j.useEffect(()=>{const Z=localStorage.getItem(S1);Z&&E(Z)},[]);const M=j.useCallback(async()=>{if(!K){i("Password required"),r(!1);return}r(!0),i(null),k(!1);try{const Z=await fetch(`${Vo}/sessions`,{headers:{"x-admin-password":K}});if(Z.status===401||Z.status===403)throw k(!0),new Error("Invalid password");if(!Z.ok)throw new Error(`Failed to load sessions (${Z.status})`);const Q=await Z.json(),re=Array.isArray(Q)?Q:[];localStorage.setItem(S1,K),t(re),u(he=>he&&re.some(pe=>pe.sessionGameId===he)?he:re.length>0?re[0].sessionGameId:null)}catch(Z){console.error("[Admin] Error fetching sessions:",Z),i(Z.message||"Failed to load sessions"),t([]),u(null)}finally{r(!1)}},[K]);j.useEffect(()=>{M()},[M]),j.useEffect(()=>{if(!a){h(null);return}let Z=!1;return(async()=>{if(K){v(!0),_(null);try{const re=await fetch(`${Vo}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":K}});if(!re.ok)throw re.status===404?new Error("Session not found"):new Error(`Failed to load session (${re.status})`);const he=await re.json();Z||h(w1(he))}catch(re){console.error("[Admin] Error fetching session detail:",re),Z||(_(re.message||"Failed to load session"),h(null))}finally{Z||v(!1)}}})(),()=>{Z=!0}},[a]);const b=Z=>{u(Z),B(!1)},H=async()=>{if(!a||!K)return;const Z=!R;B(Z),v(!0),_(null);try{const Q=Z?`${Vo}/sessions/${encodeURIComponent(a)}/experiment-only`:`${Vo}/sessions/${encodeURIComponent(a)}`,re=await fetch(Q,{headers:{"x-admin-password":K}});if(!re.ok)throw new Error(`Failed to load session data (${re.status})`);const he=await re.json();h(w1(he))}catch(Q){console.error("[Admin] Error loading session data:",Q),_(Q.message||"Failed to load session data"),B(!Z)}finally{v(!1)}},I=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},O=()=>{if(!d)return;const Z=JSON.stringify(d,null,2),Q=new Blob([Z],{type:"application/json"}),re=URL.createObjectURL(Q),he=document.createElement("a");he.href=re;const pe=`${a}_${new Date().toISOString().split("T")[0]}.json`;he.download=pe,he.click(),URL.revokeObjectURL(re),console.log("[Admin] Downloaded JSON:",pe)},z=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const Z=new Set;d.moves.forEach(q=>{Object.keys(q).forEach(me=>{me!=="camera_frame"&&me!=="__v"&&Z.add(me)})});const Q=Array.from(Z),re=[Q.join(",")];d.moves.forEach(q=>{const me=Q.map(Me=>{const Ue=q[Me];return Ue==null||Ue===""?"":Array.isArray(Ue)||typeof Ue=="object"?`"${JSON.stringify(Ue).replace(/"/g,'""')}"`:`"${String(Ue).replace(/"/g,'""')}"`});re.push(me.join(","))});const he=re.join(`
`),pe=new Blob([he],{type:"text/csv;charset=utf-8;"}),Se=URL.createObjectURL(pe),se=document.createElement("a");se.href=Se;const te=`${a}_${new Date().toISOString().split("T")[0]}.csv`;se.download=te,se.click(),URL.revokeObjectURL(Se),console.log("[Admin] Downloaded CSV:",te)},W=async(Z,Q)=>{if(!(!a||!Z||!K))try{const re=await fetch(`${Vo}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(Z)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":K},body:JSON.stringify({player:Q})});if(!re.ok)throw new Error(`Failed to update player (${re.status})`);h(he=>he&&{...he,moves:he.moves.map(pe=>pe._id===Z?{...pe,player:Q}:pe)}),console.log("[Admin] Player updated:",Z,Q)}catch(re){console.error("[Admin] Error updating player:",re),alert("Failed to update player: "+re.message)}};return l.jsxs("div",{className:"admin-container",children:[l.jsxs("aside",{className:"admin-sidebar",children:[l.jsxs("div",{className:"admin-sidebar-header",children:[l.jsx("h1",{children:"Admin"}),l.jsxs("div",{className:"admin-password-row",children:[l.jsx("input",{type:"password",className:`admin-password-input ${y?"error":""}`,placeholder:"Password",value:K,onChange:Z=>E(Z.target.value),onKeyPress:Z=>{Z.key==="Enter"&&M()}}),l.jsx("button",{className:"admin-refresh-button",onClick:M,disabled:n||!K,children:n?"Refreshing":"Refresh"})]})]}),s&&l.jsx("div",{className:"admin-error",children:s}),l.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&l.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&l.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(Z=>{const Q=typeof Z.movesCount=="number"?Z.movesCount:Array.isArray(Z.moves)?Z.moves.length:0,re=Z.sessionGameId===a;return l.jsxs("button",{className:`admin-session-card ${re?"active":""}`,onClick:()=>b(Z.sessionGameId),children:[l.jsx("div",{className:"admin-session-id",children:Z.sessionGameId}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Participant: ",Z.subjectId||""]}),l.jsxs("span",{children:["Condition: ",Z.condition||""]})]}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Moves: ",Q]}),l.jsxs("span",{children:["Updated: ",pw(Z.updatedAt)]})]})]},Z.sessionGameId)})]})]}),l.jsxs("main",{className:"admin-content",children:[g&&l.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),w&&l.jsx("div",{className:"admin-error admin-error--content",children:w}),!g&&!w&&d&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"admin-toolbar",children:[l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[l.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),l.jsx("button",{className:`admin-toolbar-button experiment-toggle ${R?"active":""}`,onClick:H,title:R?"Show all moves (including practice)":"Show only experiment phase moves",children:R?"Show All Moves":"Experiment Only"}),l.jsx("button",{className:"admin-toolbar-button edit-players",onClick:I,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[l.jsx("button",{className:"admin-toolbar-button download-json",onClick:O,title:"Download session data as JSON",children:"Download JSON"}),l.jsx("button",{className:"admin-toolbar-button download-csv",onClick:z,title:"Download moves as CSV",children:"Download CSV"})]})]}),l.jsx("div",{className:"admin-summary-wrapper",children:l.jsx(Z2,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((X=d.sessionInfo)==null?void 0:X.sessionGameId)||a||""}${R?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:W})})]}),!g&&!w&&!d&&l.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const k1="adminPassword";function gw(){const[e,t]=j.useState(null),[n,r]=j.useState(!1),[s,i]=j.useState(null),[a,u]=j.useState(null),[d,h]=j.useState(null),[g,v]=j.useState(""),[w,_]=j.useState(!1);j.useEffect(()=>{const K=localStorage.getItem(k1);K&&v(K)},[]);const R=K=>{const E=K.target.files[0];if(!E)return;if(!E.name.endsWith(".json")){u("Please select a JSON file"),t(null);return}t(E),u(null),i(null);const y=new FileReader;y.onload=k=>{var M;try{const b=JSON.parse(k.target.result);h({sessionGameId:b.sessionGameId||"N/A",subjectId:b.subjectId||"N/A",condition:b.condition||"N/A",date:b.date||"N/A",movesCount:((M=b.moves)==null?void 0:M.length)||0,hasColorA:!!b.colorA,hasColorB:!!b.colorB})}catch(b){u("Invalid JSON file: "+b.message),h(null)}},y.readAsText(E)},B=async()=>{var K;if(!e){u("Please select a file first");return}r(!0),u(null),i(null);try{const E=await new Promise((H,I)=>{const O=new FileReader;O.onload=z=>H(z.target.result),O.onerror=I,O.readAsText(e)}),y=JSON.parse(E);if(!y.sessionGameId||!y.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!g)throw new Error("Admin password is required. Please enter it below.");const k=await fetch(`${Fu()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":g},body:JSON.stringify(y)}),M=await k.json();if(k.status===401||k.status===403)throw _(!0),new Error(M.message||"Invalid admin password");if(!k.ok)throw new Error(M.message||"Upload failed");localStorage.setItem(k1,g),_(!1),i(` Successfully uploaded session "${y.sessionGameId}" with ${((K=y.moves)==null?void 0:K.length)||0} moves`),t(null),h(null);const b=document.getElementById("json-file-input");b&&(b.value="")}catch(E){u(E.message||"Failed to upload file")}finally{r(!1)}};return l.jsx("div",{className:"admin-upload-container",children:l.jsxs("div",{className:"admin-upload-card",children:[l.jsx("h1",{children:"Admin: Upload Session JSON"}),l.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),l.jsxs("div",{className:"admin-upload-form",children:[l.jsxs("div",{className:"password-input-wrapper",children:[l.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),l.jsx("input",{id:"admin-password",type:"password",value:g,onChange:K=>{v(K.target.value),_(!1)},placeholder:"Enter admin password",className:w?"error":""}),w&&l.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),l.jsxs("div",{className:"file-input-wrapper",children:[l.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:R,disabled:n}),l.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&l.jsxs("div",{className:"file-preview",children:[l.jsx("h3",{children:"File Preview"}),l.jsxs("div",{className:"preview-grid",children:[l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Condition:"})," ",d.condition]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Date:"})," ",d.date]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&l.jsxs("div",{className:"error-message",children:[l.jsx("strong",{children:"Error:"})," ",a]}),s&&l.jsx("div",{className:"success-message",children:s}),l.jsx("button",{className:"upload-button",onClick:B,disabled:!e||!g||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var pi=typeof self<"u"?self:{};function Zs(){throw Error("Invalid UTF8")}function A1(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let pl,Kc;const yw=typeof TextDecoder<"u";let vw;const xw=typeof TextEncoder<"u";function q2(e){if(xw)e=(vw||(vw=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var wh,uu;e:{for(var E1=["CLOSURE_FLAGS"],Qc=pi,Jc=0;Jc<E1.length;Jc++)if((Qc=Qc[E1[Jc]])==null){uu=null;break e}uu=Qc}var Ta,C1=uu&&uu[610401301];wh=C1!=null&&C1;const _1=pi.navigator;function lf(e){return!!wh&&!!Ta&&Ta.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function ur(e){var t;return(t=pi.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function Cs(){return!!wh&&!!Ta&&Ta.brands.length>0}function Zc(){return Cs()?lf("Chromium"):(ur("Chrome")||ur("CriOS"))&&!(!Cs()&&ur("Edge"))||ur("Silk")}function Sh(e){return Sh[" "](e),e}Ta=_1&&_1.userAgentData||null,Sh[" "]=function(){};var ww=!Cs()&&(ur("Trident")||ur("MSIE"));!ur("Android")||Zc(),Zc(),ur("Safari")&&(Zc()||!Cs()&&ur("Coast")||!Cs()&&ur("Opera")||!Cs()&&ur("Edge")||(Cs()?lf("Microsoft Edge"):ur("Edg/"))||Cs()&&lf("Opera"));var ey={},qo=null;function Sw(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function u(h){for(;d<i.length;){const g=i.charAt(d++),v=qo[g];if(v!=null)return v;if(!/^[\s\xa0]*$/.test(g))throw Error("Unknown base64 encoding at char: "+g)}return h}ty();let d=0;for(;;){const h=u(-1),g=u(0),v=u(64),w=u(64);if(w===64&&h===-1)break;a(h<<2|g>>4),v!=64&&(a(g<<4&240|v>>2),w!=64&&a(v<<6&192|w))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function ty(){if(!qo){qo={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));ey[n]=r;for(let s=0;s<r.length;s++){const i=r[s];qo[i]===void 0&&(qo[i]=s)}}}}var ny=typeof Uint8Array<"u",ry=!ww&&typeof btoa=="function";function j1(e){if(!ry){var t;t===void 0&&(t=0),ty(),t=ey[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],u=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=u+s+i+a}switch(u=0,a=r,e.length-d){case 2:a=t[(15&(u=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|u>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const N1=/[-_.]/g,kw={"-":"+",_:"/",".":"="};function Aw(e){return kw[e]||""}function sy(e){if(!ry)return Sw(e);N1.test(e)&&(e=e.replace(N1,Aw)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function Da(e){return ny&&e!=null&&e instanceof Uint8Array}var co={};function mi(){return Ew||(Ew=new ss(null,co))}function kh(e){iy(co);var t=e.g;return(t=t==null||Da(t)?t:typeof t=="string"?sy(t):null)==null?t:e.g=t}var ss=class{h(){return new Uint8Array(kh(this)||0)}constructor(e,t){if(iy(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let Ew,Cw;function iy(e){if(e!==co)throw Error("illegal external caller")}function oy(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function uf(e){return oy(e=Error(e),"warning"),e}var Ou=typeof Symbol=="function"&&typeof Symbol()=="symbol",_w=new Set;function za(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&_w.add(e),e}var jw=za("jas",void 0,!0,!0),b1=za(void 0,"0di"),qc=za(void 0,"2ex"),Yo=za(void 0,"1oa",!0),fo=za(void 0,Symbol(),!0);const be=Ou?jw:"Ga",ay={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},ly=Object.defineProperties;function $u(e,t){Ou||be in e||ly(e,ay),e[be]|=t}function Ht(e,t){Ou||be in e||ly(e,ay),e[be]=t}function Eo(e){return $u(e,34),e}function Nw(e,t){Ht(t,-30975&(0|e))}function cf(e,t){Ht(t,-30941&(34|e))}function Ah(){return typeof BigInt=="function"}function Rn(e){return Array.prototype.slice.call(e)}var Eh,Ua={},uy={};function M1(e){return!(!e||typeof e!="object"||e.Ia!==uy)}function Ch(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function _h(e,t){if(e!=null){if(typeof e=="string")e=e?new ss(e,co):mi();else if(e.constructor!==ss)if(Da(e))e=e.length?new ss(new Uint8Array(e),co):mi();else{if(!t)throw Error();e=void 0}}return e}function cu(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[be]))}const T1=[];function Vs(e){if(2&e)throw Error()}Ht(T1,55),Eh=Object.freeze(T1);class du{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new du(this.g,this.h,this.m)}}function jh(e){return fo?e[fo]:void 0}var bw=Object.freeze({});function Du(e){return e.Qa=!0,e}var Mw=Du(e=>typeof e=="number"),P1=Du(e=>typeof e=="string"),Tw=Du(e=>typeof e=="boolean"),zu=typeof pi.BigInt=="function"&&typeof pi.BigInt(0)=="bigint",df=Du(e=>zu?e>=Iw&&e<=Bw:e[0]==="-"?I1(e,Pw):I1(e,Rw));const Pw=Number.MIN_SAFE_INTEGER.toString(),Iw=zu?BigInt(Number.MIN_SAFE_INTEGER):void 0,Rw=Number.MAX_SAFE_INTEGER.toString(),Bw=zu?BigInt(Number.MAX_SAFE_INTEGER):void 0;function I1(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const Lw=typeof Uint8Array.prototype.slice=="function";let cy,dt=0,Lt=0;function R1(e){const t=e>>>0;dt=t,Lt=(e-t)/4294967296>>>0}function ho(e){if(e<0){R1(-e);const[t,n]=Th(dt,Lt);dt=t>>>0,Lt=n>>>0}else R1(e)}function Nh(e){const t=cy||(cy=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),Lt=0,dt=t.getUint32(0,!0)}function bh(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:Pa(e,t)}function Mh(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=bh(e,t))=="number"?n?-e:e:n?"-"+e:e}function Pa(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else Ah()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+B1(n)+B1(e));return n}function B1(e){return e=String(e),"0000000".slice(e.length)+e}function Uu(e){if(e.length<16)ho(Number(e));else if(Ah())e=BigInt(e),dt=Number(e&BigInt(4294967295))>>>0,Lt=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");Lt=dt=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));Lt*=1e6,dt=1e6*dt+i,dt>=4294967296&&(Lt+=Math.trunc(dt/4294967296),Lt>>>=0,dt>>>=0)}if(t){const[r,s]=Th(dt,Lt);dt=r,Lt=s}}}function Th(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const Ph=typeof BigInt=="function"?BigInt.asIntN:void 0,Fw=typeof BigInt=="function"?BigInt.asUintN:void 0,Zi=Number.isSafeInteger,Hu=Number.isFinite,fu=Math.trunc;function Ys(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function dy(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const Ow=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Gu(e){switch(typeof e){case"bigint":return!0;case"number":return Hu(e);case"string":return Ow.test(e);default:return!1}}function Co(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Hu(e)?0|e:void 0}function fy(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Hu(e)?e>>>0:void 0}function L1(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Ih(e){return e=fu(e),Zi(e)||(ho(e),e=Mh(dt,Lt)),e}function Rh(e){var t=fu(Number(e));if(Zi(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if(Uu(e),e=dt,2147483648&(t=Lt))if(Ah())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=Th(e,t);e="-"+Pa(n,r)}else e=Pa(e,t);return e}function hu(e){return e==null?e:typeof e=="bigint"?(df(e)?e=Number(e):(e=Ph(64,e),e=df(e)?Number(e):String(e)),e):Gu(e)?typeof e=="number"?Ih(e):Rh(e):void 0}function $w(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(Fw(64,e));if(Gu(e)){if(t==="string")return t=fu(Number(e)),Zi(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),L1(e)||(Uu(e),e=Pa(dt,Lt))),e;if(t==="number")return(e=fu(e))>=0&&Zi(e)?e:function(n){if(n<0){ho(n);var r=Pa(dt,Lt);return n=Number(r),Zi(n)?n:r}return L1(r=String(n))?r:(ho(n),bh(dt,Lt))}(e)}}function hy(e){if(typeof e!="string")throw Error();return e}function _o(e){if(e!=null&&typeof e!="string")throw Error();return e}function po(e){return e==null||typeof e=="string"?e:void 0}function Bh(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===Ua)return e;if(!Array.isArray(e))return n?2&r?((e=t[b1])||(Eo((e=new t).u),e=t[b1]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[be];return s===0&&(s|=32&r),s|=2&r,s!==n&&Ht(e,s),new t(e)}function Dw(e,t,n){if(t)e:{if(!Gu(t=e))throw uf("int64");switch(typeof t){case"string":t=Rh(t);break e;case"bigint":if(e=t=Ph(64,t),P1(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(Mw(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=zu?BigInt(t):Tw(t)?t?"1":"0":P1(t)?t.trim()||"0":String(t);break e;default:t=Ih(t)}}else t=hu(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&Zi(t=+n)?t:n}const zw={};let Uw=function(){try{return Sh(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class ed{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const Hw=Uw?(Object.setPrototypeOf(ed.prototype,Map.prototype),Object.defineProperties(ed.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),ed):class extends Map{constructor(){super()}};function F1(e){return e}function td(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var mr=class extends Hw{constructor(e,t,n=F1,r=F1){super();let s=0|e[be];s|=64,Ht(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?Gw:r;for(let i=0;i<e.length;i++){const a=e[i],u=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(u,d)}}na(e=O1){if(this.size!==0)return this.X(e)}X(e=O1){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){td(this),super.clear()}delete(e){return td(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new du(e,Ww,this)}keys(){return this.Ha()}values(){var e=this.ma();return new du(e,mr.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return td(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Gw(e,t,n,r,s,i){return e=Bh(e,r,n,i),s&&(e=Vu(e)),e}function O1(e){return e}function Ww(e){return[e,this.get(e)]}let Vw,py,Yw;function $1(){return Vw||(Vw=new mr(Eo([]),void 0,void 0,void 0,zw))}function Lh(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=cu(e)?void 0:s&&2&(0|e[be])?e:Fh(e,t,n,r!==void 0,s);else if(Ch(e)){const i={};for(let a in e)i[a]=Lh(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function Fh(e,t,n,r,s){const i=r||n?0|e[be]:0,a=r?!!(32&i):void 0;r=Rn(e);for(let u=0;u<r.length;u++)r[u]=Lh(r[u],t,n,a,s);return n&&((e=jh(e))&&(r[fo]=Rn(e)),n(i,r)),r}function Xw(e){return Lh(e,my,void 0,void 0,!1)}function my(e){return e.W===Ua?e.toJSON():e instanceof mr?e.na(Xw):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return df(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(cu(t))return}else{if(Da(t))return j1(t);if(t instanceof ss){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=j1(n)}if(t instanceof mr)return t.na()}}return t}(e)}function gy(e){return Fh(e,my,void 0,void 0,!1)}function Fs(e,t,n){return e=yy(e,t[0],t[1],n?1:2),t!==py&&n&&$u(e,16384),e}function yy(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[be]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(Ch(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return Ht(e,s),e}function ff(e,t,n=cf){if(e!=null){if(ny&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[be];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?(Ht(e,-12293&(34|r)),e):Fh(e,ff,4&r?cf:n,!0,!0))}return e.W===Ua?e=2&(r=0|(n=e.u)[be])?e:new e.constructor(Wu(n,r,!0)):e instanceof mr&&!(2&e.L)&&(n=Eo(e.X(ff)),e=new mr(n,e.S,e.R,e.Y)),e}}function Wu(e,t,n){const r=n||2&t?cf:Nw,s=!!(32&t);return e=function(i,a,u){const d=Rn(i);var h=d.length;const g=256&a?d[h-1]:void 0;for(h+=g?-1:0,a=512&a?1:0;a<h;a++)d[a]=u(d[a]);if(g){a=d[a]={};for(const v in g)a[v]=u(g[v])}return(i=jh(i))&&(d[fo]=Rn(i)),d}(e,t,i=>ff(i,s,r)),$u(e,32|(n?2:0)),e}function Vu(e){const t=e.u,n=0|t[be];return 2&n?new e.constructor(Wu(t,n,!1)):e}function mo(e,t){return ps(e=e.u,0|e[be],t)}function ps(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&qc!=null&&((s=(e=Cw??(Cw={}))[qc]||0)>=4||(e[qc]=s+1,oy(e=Error(),"incident"),function(a){pi.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function ht(e,t,n){const r=e.u;let s=0|r[be];return Vs(s),bt(r,s,t,n),e}function bt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},Ht(e,t|=256)):e[i]=r),t)}function Pl(e,t){let n=0|(e=e.u)[be];const r=ps(e,n,t),s=Ys(r);return s!=null&&s!==r&&bt(e,n,t,s),s}function vy(e){let t=0|(e=e.u)[be];const n=ps(e,t,1),r=_h(n,!0);return r!=null&&r!==n&&bt(e,t,1,r),r}function si(){return bw===void 0?2:4}function ii(e,t,n,r,s){const i=e.u,a=2&(e=0|i[be])?1:r;s=!!s;let u=0|(r=Oh(i,e,t))[be];if(!(4&u)){4&u&&(r=Rn(r),u=is(u,e),e=bt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const g=n(r[d]);g!=null&&(r[h++]=g)}h<d&&(r.length=h),u=$h(u,e),n=-4097&(20|u),u=n&=-8193,Ht(r,u),2&u&&Object.freeze(r)}return a===1||a===4&&32&u?ns(u)||(s=u,u|=2,u!==s&&Ht(r,u),Object.freeze(r)):(a===2&&ns(u)&&(r=Rn(r),u=is(u,e),u=Os(u,e,s),Ht(r,u),e=bt(i,e,t,r)),ns(u)||(t=u,u=Os(u,e,s),u!==t&&Ht(r,u))),r}function Oh(e,t,n,r){return e=ps(e,t,n,r),Array.isArray(e)?e:Eh}function $h(e,t){return e===0&&(e=is(e,t)),1|e}function ns(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function xy(e){e=Rn(e);for(let t=0;t<e.length;t++){const n=e[t]=Rn(e[t]);Array.isArray(n[1])&&(n[1]=Eo(n[1]))}return e}function hf(e,t,n,r){let s=0|(e=e.u)[be];Vs(s),bt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function jo(e,t,n,r,s){Vs(t);var i=!(!(64&t)&&16384&t);const a=(s=Oh(e,t,n,s))!==Eh;if(i||!a){let u=i=a?0|s[be]:0;(!a||2&u||ns(u)||4&u&&!(32&u))&&(s=Rn(s),u=is(u,t),t=bt(e,t,n,s)),u=-13&$h(u,t),u=Os(r?-17&u:16|u,t,!0),u!==i&&Ht(s,u)}return s}function nd(e,t){var n=lv;return zh(Dh(e=e.u),e,0|e[be],n)===t?t:-1}function Dh(e){if(Ou)return e[Yo]??(e[Yo]=new Map);if(Yo in e)return e[Yo];const t=new Map;return Object.defineProperty(e,Yo,{value:t}),t}function wy(e,t,n,r){const s=Dh(e),i=zh(s,e,t,n);return i!==r&&(i&&(t=bt(e,t,i)),s.set(n,r)),t}function zh(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];ps(t,n,a)!=null&&(s!==0&&(n=bt(t,n,s)),s=a)}return e.set(r,s),s}function Uh(e,t,n,r){let s,i=0|e[be];if((r=ps(e,i,n,r))!=null&&r.W===Ua)return(t=Vu(r))!==r&&bt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[be];s=2&a?Fs(Wu(r,a,!1),t,!0):64&a?r:Fs(s,t,!0)}else s=Fs(void 0,t,!0);return s!==r&&bt(e,i,n,s),s}function Sy(e,t,n,r){let s=0|(e=e.u)[be];return(t=Bh(r=ps(e,s,n,r),t,!1,s))!==r&&t!=null&&bt(e,s,n,t),t}function qe(e,t,n,r=!1){if((t=Sy(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[be]))){const s=Vu(t);s!==t&&bt(e,r,n,t=s)}return t}function ky(e,t,n,r,s,i,a){e=e.u;var u=!!(2&t);const d=u?1:s;i=!!i,a&&(a=!u);var h=0|(s=Oh(e,t,r))[be];if(!(u=!!(4&h))){var g=s,v=t;const w=!!(2&(h=$h(h,t)));w&&(v|=2);let _=!w,R=!0,B=0,K=0;for(;B<g.length;B++){const E=Bh(g[B],n,!1,v);if(E instanceof n){if(!w){const y=!!(2&(0|E.u[be]));_&&(_=!y),R&&(R=y)}g[K++]=E}}K<B&&(g.length=K),h|=4,h=R?16|h:-17&h,Ht(g,h=_?8|h:-9&h),w&&Object.freeze(g)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(ns(h)&&(s=Rn(s),h=is(h,t),t=bt(e,t,r,s)),n=s,a=h,g=0;g<n.length;g++)(h=n[g])!==(v=Vu(h))&&(n[g]=v);a|=8,Ht(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?ns(h)||(t=h,(h|=!s.length||16&h&&(!u||32&h)?2:2048)!==t&&Ht(s,h),Object.freeze(s)):(d===2&&ns(h)&&(Ht(s=Rn(s),h=Os(h=is(h,t),t,i)),t=bt(e,t,r,s)),ns(h)||(r=h,(h=Os(h,t,i))!==r&&Ht(s,h))),s}function ds(e,t,n){const r=0|e.u[be];return ky(e,r,t,n,si(),!1,!(2&r))}function Te(e,t,n,r){return r==null&&(r=void 0),ht(e,n,r)}function da(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[be];if(Vs(s),r==null){const i=Dh(e);if(zh(i,e,s,n)!==t)break e;i.set(n,0)}else s=wy(e,s,n,t);bt(e,s,t,r)}}function is(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function Os(e,t,n){return 32&t&&n||(e&=-33),e}function pu(e,t,n,r){const s=0|e.u[be];Vs(s),e=ky(e,s,n,t,2,!0),r=r??new n,e.push(r),e[be]=2&(0|r.u[be])?-9&e[be]:-17&e[be]}function dr(e,t){return Co(mo(e,t))}function gr(e,t){return po(mo(e,t))}function Ot(e,t){return Pl(e,t)??0}function Ia(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);ht(e,t,n)}function Vr(e,t,n){if(n!=null){if(typeof n!="number"||!Hu(n))throw uf("int32");n|=0}ht(e,t,n)}function _e(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);ht(e,t,n)}function mu(e,t,n){{const a=e.u;let u=0|a[be];if(Vs(u),n==null)bt(a,u,t);else{var r=e=0|n[be],s=ns(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=Rn(n),r=0,e=Os(e=is(e,u),u,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=hy(d);Object.is(d,h)||(i&&(n=Rn(n),r=0,e=Os(e=is(e,u),u,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=Rn(n),e=Os(e=is(e,u),u,!0)),Ht(n,e)),bt(a,u,t,n)}}}function Yu(e,t,n){Vs(0|e.u[be]),ii(e,t,po,2,!0).push(hy(n))}function Ay(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Hh(){return Error("Failed to read varint, encoding is invalid.")}function Ey(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function Gh(e){if(typeof e=="string")return{buffer:sy(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===ss)return{buffer:kh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Wh(e,t){let n,r=0,s=0,i=0;const a=e.h;let u=e.g;do n=a[u++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[u++],s|=(127&n)<<i;if(li(e,u),n<128)return t(r>>>0,s>>>0);throw Hh()}function Vh(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return li(e,n),!!(127&t)}throw Hh()}function zs(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Hh();return li(e,n),s}function fs(e){return zs(e)>>>0}function pf(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],li(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function mf(e){var t=pf(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function Kw(e){return zs(e)}function rd(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=Gh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function li(e,t){if(e.g=t,t>e.l)throw Ey(e.l,t)}function Cy(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw Ey(t,e.l-n);return e.g=r,n}function _y(e,t){if(t==0)return mi();var n=Cy(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Lw?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?mi():new ss(n,co)}mr.prototype.toJSON=void 0,mr.prototype.Ia=uy;var D1=[];function jy(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=fs(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw Ay(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function Il(e){switch(e.h){case 0:e.h!=0?Il(e):Vh(e.g);break;case 1:li(e=e.g,e.g+8);break;case 2:if(e.h!=2)Il(e);else{var t=fs(e.g);li(e=e.g,e.g+t)}break;case 5:li(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!jy(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}Il(e)}break;default:throw Ay(e.h,e.l)}}function Ha(e,t,n){const r=e.g.l,s=fs(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function Yh(e){var t=fs(e.g),n=Cy(e=e.g,t);if(e=e.h,yw){var r,s=e;(r=Kc)||(r=Kc=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(u){if(pl===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),pl=!0}catch{pl=!1}}throw!pl&&(Kc=void 0),u}}else{t=(i=n)+t,n=[];let u,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?Zs():(u=e[i++],a<194||(192&u)!=128?(i--,Zs()):n.push((31&a)<<6|63&u)):a<240?i>=t-1?Zs():(u=e[i++],(192&u)!=128||a===224&&u<160||a===237&&u>=160||(192&(r=e[i++]))!=128?(i--,Zs()):n.push((15&a)<<12|(63&u)<<6|63&r)):a<=244?i>=t-2?Zs():(u=e[i++],(192&u)!=128||u-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,Zs()):(a=(7&a)<<18|(63&u)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):Zs(),n.length>=8192&&(d=A1(d,n),n.length=0)}i=A1(d,n)}return i}function Ny(e){const t=fs(e.g);return _y(e.g,t)}function Xu(e,t,n){var r=fs(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var ml=[];function Qw(e){return e}let qi;function Mr(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var Ce=class{constructor(e,t){this.u=yy(e,t)}toJSON(){const e=!qi;try{return e&&(qi=gy),by(this)}finally{e&&(qi=void 0)}}l(){var e=P5;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(Wu(e,0|e[be],!1))}N(){return!!(2&(0|this.u[be]))}};function by(e){var t=e.u;{t=(e=qi(t))!==t;let h=e.length;if(h){var n=e[h-1],r=Ch(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,u=!1;if(a)for(let g in a)isNaN(+g)?(i??(i={}))[g]=a[g]:(r=a[g],Array.isArray(r)&&(cu(r)||M1(r)&&r.size===0)&&(r=null),r==null&&(u=!0),r!=null&&((i??(i={}))[g]=r));if(u||(i=a),i)for(let g in i){u=i;break e}u=null}a=u==null?n!=null:u!==n}for(;h>0&&((i=s[h-1])==null||cu(i)||M1(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||u)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),u&&s.push(u)),d=s}else d=e}return d}function z1(e){return e?/^\d+$/.test(e)?(Uu(e),new gf(dt,Lt)):null:Jw||(Jw=new gf(0,0))}Ce.prototype.W=Ua,Ce.prototype.toString=function(){try{return qi=Qw,by(this).toString()}finally{qi=void 0}};var gf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Jw;function U1(e){return e?/^-?\d+$/.test(e)?(Uu(e),new yf(dt,Lt)):null:Zw||(Zw=new yf(0,0))}var yf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Zw;function eo(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function No(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function Ku(e,t){if(t>=0)No(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function Ra(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function go(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function qn(e,t,n){No(e.g,8*t+n)}function Xh(e,t){return qn(e,t,2),t=e.g.end(),go(e,t),t.push(e.h),t}function Kh(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function Qu(e,t,n){qn(e,t,2),No(e.g,n.length),go(e,e.g.end()),go(e,n)}function gu(e,t,n,r){n!=null&&(t=Xh(e,t),r(n,e),Kh(e,t))}function Tr(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var Qh=Tr(),My=Tr(),Jh=Tr(),Zh=Tr(),Ty=Tr(),Py=Tr(),qh=Tr(),Iy=Tr(),Ry=Tr(),bo=class{constructor(e,t,n){this.g=e,this.h=t,e=Qh,this.l=!!e&&n===e||!1}};function Ju(e,t){return new bo(e,t,Qh)}function By(e,t,n,r,s){gu(e,n,$y(t,r),s)}const qw=Ju(function(e,t,n,r,s){return e.h===2&&(Ha(e,Uh(t,r,n),s),!0)},By),e5=Ju(function(e,t,n,r,s){return e.h===2&&(Ha(e,Uh(t,r,n,!0),s),!0)},By);var Zu=Symbol(),ep=Symbol(),H1=Symbol(),G1=Symbol();let Ly,Fy;function vi(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(v){switch(typeof v){case"boolean":return py||(py=[0,void 0,!0]);case"number":return v>0?void 0:v===0?Yw||(Yw=[0,void 0]):[-v,void 0];case"string":return[0,v];case"object":return v}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Ly??(Ly=i),Fy??(Fy=r[a+1]),i=r[a+=2]));const u={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)u[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let v;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof bo?v=i:(v=qw,a--),v==null?void 0:v.l){i=r[++a],h=r;var g=a;typeof i=="function"&&(i=i(),h[g]=i),h=i}for(g=d+1,typeof(i=r[++a])=="number"&&i<0&&(g-=i,i=r[++a]);d<g;d++){const w=u[d];h?n(s,d,v,h,w):t(s,d,v,w)}}return r[e]=s}function Oy(e){return Array.isArray(e)?e[0]instanceof bo?e:[e5,e]:[e,void 0]}function $y(e,t){return e instanceof Ce?e.u:Array.isArray(e)?Fs(e,t,!1):void 0}function tp(e,t,n,r){const s=n.g;e[t]=r?(i,a,u)=>s(i,a,u,r):s}function np(e,t,n,r,s){const i=n.g;let a,u;e[t]=(d,h,g)=>i(d,h,g,u||(u=vi(ep,tp,np,r).V),a||(a=rp(r)),s)}function rp(e){let t=e[H1];if(t!=null)return t;const n=vi(ep,tp,np,e);return t=n.la?(r,s)=>Ly(r,s,n):(r,s)=>{const i=0|r[be];for(;jy(s)&&s.h!=4;){var a=s.m,u=n[a];if(u==null){var d=n.ga;d&&(d=d[a])&&(d=t5(d))!=null&&(u=n[a]=d)}u!=null&&u(s,r,a)||(a=(u=s).l,Il(u),u.fa?u=void 0:(d=u.g.g-a,u.g.g=a,u=_y(u.g,d)),a=r,u&&((d=a[fo])?d.push(u):a[fo]=[u]))}return 16384&i&&Eo(r),!0},e[H1]=t}function t5(e){const t=(e=Oy(e))[0].g;if(e=e[1]){const n=rp(e),r=vi(ep,tp,np,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function qu(e,t,n){e[t]=n.h}function ec(e,t,n,r){let s,i;const a=n.h;e[t]=(u,d,h)=>a(u,d,h,i||(i=vi(Zu,qu,ec,r).V),s||(s=Dy(r)))}function Dy(e){let t=e[G1];if(!t){const n=vi(Zu,qu,ec,e);t=(r,s)=>zy(r,s,n),e[G1]=t}return t}function zy(e,t,n){for(var r=0|e[be],s=512&r?0:-1,i=e.length,a=512&r?1:0,u=i+(256&r?-1:0);a<u;a++){const d=e[a];if(d==null)continue;const h=a-s,g=W1(n,h);g&&g(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(u=W1(n,s))&&u(t,i,s)}if(e=jh(e))for(go(t,t.g.end()),n=0;n<e.length;n++)go(t,kh(e[n])||new Uint8Array(0))}function W1(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=Oy(n))[0].h;if(n=n[1]){const s=Dy(n),i=vi(Zu,qu,ec,n).V;n=e.la?Fy(i,s):(a,u,d)=>r(a,u,d,i,s)}else n=r;return e[t]=n}}function Mo(e,t){if(Array.isArray(t)){var n=0|t[be];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),Ht(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function kn(e,t,n){return new bo(e,t,n)}function To(e,t,n){return new bo(e,t,n)}function An(e,t,n){bt(e,0|e[be],t,n)}var n5=Ju(function(e,t,n,r,s){return e.h===2&&(e=Ha(e,Fs([void 0,void 0],r,!0),s),Vs(r=0|t[be]),(s=ps(t,r,n))instanceof mr?2&s.L?((s=s.X()).push(e),bt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[be])&&bt(t,r,n,s=xy(s)),s.push(e)):bt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof mr)t.forEach((i,a)=>{gu(e,n,Fs([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&gu(e,n,Fs(a,r,!1),s)}});function Uy(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String(Ph(64,r));if(Gu(r)){if(s==="string")return Rh(r);if(s==="number")return Ih(r)}}(t),t!=null&&(typeof t=="string"&&U1(t),t!=null))switch(qn(e,n,0),typeof t){case"number":e=e.g,ho(t),eo(e,dt,Lt);break;case"bigint":n=BigInt.asUintN(64,t),n=new yf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),eo(e.g,n.h,n.g);break;default:n=U1(t),eo(e.g,n.h,n.g)}}function Hy(e,t,n){(t=Co(t))!=null&&t!=null&&(qn(e,n,0),Ku(e.g,t))}function Gy(e,t,n){(t=dy(t))!=null&&(qn(e,n,0),e.g.g.push(t?1:0))}function Wy(e,t,n){(t=po(t))!=null&&Qu(e,n,q2(t))}function Vy(e,t,n,r,s){gu(e,n,$y(t,r),s)}function Yy(e,t,n){(t=t==null||typeof t=="string"||Da(t)||t instanceof ss?t:void 0)!=null&&Qu(e,n,Gh(t).buffer)}function Xy(e,t,n){return(e.h===5||e.h===2)&&(t=jo(t,0|t[be],n,!1,!1),e.h==2?Xu(e,mf,t):t.push(mf(e.g)),!0)}var Zr=kn(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=pf(r);const s=pf(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,An(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Ys(t))!=null&&(qn(e,n,1),e=e.g,(n=cy||(cy=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),dt=n.getUint32(0,!0),Lt=n.getUint32(4,!0),Ra(e,dt),Ra(e,Lt))},Tr()),Gt=kn(function(e,t,n){return e.h===5&&(An(t,n,mf(e.g)),!0)},function(e,t,n){(t=Ys(t))!=null&&(qn(e,n,5),e=e.g,Nh(t),Ra(e,dt))},qh),r5=To(Xy,function(e,t,n){if((t=Mo(Ys,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(qn(r,s,5),r=r.g,Nh(i),Ra(r,dt))}},qh),sp=To(Xy,function(e,t,n){if((t=Mo(Ys,t))!=null&&t.length){qn(e,n,2),No(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,Nh(t[r]),Ra(n,dt)}},qh),Us=kn(function(e,t,n){return e.h===0&&(An(t,n,Wh(e.g,Mh)),!0)},Uy,Py),sd=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Wh(e.g,Mh))===0?void 0:e),!0)},Uy,Py),s5=kn(function(e,t,n){return e.h===0&&(An(t,n,Wh(e.g,bh)),!0)},function(e,t,n){if((t=$w(t))!=null&&(typeof t=="string"&&z1(t),t!=null))switch(qn(e,n,0),typeof t){case"number":e=e.g,ho(t),eo(e,dt,Lt);break;case"bigint":n=BigInt.asUintN(64,t),n=new gf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),eo(e.g,n.h,n.g);break;default:n=z1(t),eo(e.g,n.h,n.g)}},Tr()),Ft=kn(function(e,t,n){return e.h===0&&(An(t,n,zs(e.g)),!0)},Hy,Zh),tc=To(function(e,t,n){return(e.h===0||e.h===2)&&(t=jo(t,0|t[be],n,!1,!1),e.h==2?Xu(e,zs,t):t.push(zs(e.g)),!0)},function(e,t,n){if((t=Mo(Co,t))!=null&&t.length){n=Xh(e,n);for(let r=0;r<t.length;r++)Ku(e.g,t[r]);Kh(e,n)}},Zh),Hi=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=zs(e.g))===0?void 0:e),!0)},Hy,Zh),At=kn(function(e,t,n){return e.h===0&&(An(t,n,Vh(e.g)),!0)},Gy,My),to=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Vh(e.g))===!1?void 0:e),!0)},Gy,My),hn=To(function(e,t,n){return e.h===2&&(e=Yh(e),jo(t,0|t[be],n,!1).push(e),!0)},function(e,t,n){if((t=Mo(po,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&Qu(r,s,q2(i))}},Jh),_s=kn(function(e,t,n){return e.h===2&&(An(t,n,(e=Yh(e))===""?void 0:e),!0)},Wy,Jh),st=kn(function(e,t,n){return e.h===2&&(An(t,n,Yh(e)),!0)},Wy,Jh),Xt=function(e,t,n=Qh){return new bo(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=Fs(void 0,r,!0),jo(t,0|t[be],n,!0).push(r),Ha(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)Vy(e,t[i],n,r,s)}),ot=Ju(function(e,t,n,r,s,i){return e.h===2&&(wy(t,0|t[be],i,n),Ha(e,t=Uh(t,r,n),s),!0)},Vy),Ky=kn(function(e,t,n){return e.h===2&&(An(t,n,Ny(e)),!0)},Yy,Iy),i5=To(function(e,t,n){return(e.h===0||e.h===2)&&(t=jo(t,0|t[be],n,!1,!1),e.h==2?Xu(e,fs,t):t.push(fs(e.g)),!0)},function(e,t,n){if((t=Mo(fy,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(qn(r,s,0),No(r.g,i))}},Ty),o5=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=fs(e.g))===0?void 0:e),!0)},function(e,t,n){(t=fy(t))!=null&&t!=null&&(qn(e,n,0),No(e.g,t))},Ty),yr=kn(function(e,t,n){return e.h===0&&(An(t,n,zs(e.g)),!0)},function(e,t,n){(t=Co(t))!=null&&(t=parseInt(t,10),qn(e,n,0),Ku(e.g,t))},Ry);class a5{constructor(t,n){this.h=t,this.g=n,this.l=qe,this.m=Te,this.defaultValue=void 0}}function Pr(e,t){return new a5(e,t)}function Xs(e,t){return(n,r)=>{if(ml.length){const i=ml.pop();i.o(r),rd(i.g,n,r),n=i}else n=new class{constructor(i,a){if(D1.length){const u=D1.pop();rd(u,i,a),i=u}else i=new class{constructor(u,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,rd(this,u,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;rp(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,ml.length<100&&ml.push(n)}return s}}function nc(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};zy(this.u,t,vi(Zu,qu,ec,e)),go(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const u=r[a];n.set(u,i),i+=u.length}return t.l=[n],n}}var V1=class extends Ce{constructor(e){super(e)}},Y1=[0,_s,kn(function(e,t,n){return e.h===2&&(An(t,n,(e=Ny(e))===mi()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof Ce){const r=t.Ra;return void(r&&(t=r(t),t!=null&&Qu(e,n,Gh(t).buffer)))}if(Array.isArray(t))return}Yy(e,t,n)},Iy)];let id,X1=globalThis.trustedTypes;function K1(e){id===void 0&&(id=function(){let n=null;if(!X1)return n;try{const r=s=>s;n=X1.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=id;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function l5(e,...t){if(t.length===0)return K1(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return K1(n)}var Qy=[0,Ft,yr,At,-1,tc,yr,-1],u5=class extends Ce{constructor(e){super(e)}},Jy=[0,At,st,At,yr,-1,To(function(e,t,n){return(e.h===0||e.h===2)&&(t=jo(t,0|t[be],n,!1,!1),e.h==2?Xu(e,Kw,t):t.push(zs(e.g)),!0)},function(e,t,n){if((t=Mo(Co,t))!=null&&t.length){n=Xh(e,n);for(let r=0;r<t.length;r++)Ku(e.g,t[r]);Kh(e,n)}},Ry),st,-1,[0,At,-1],yr,At,-1],Zy=[0,st,-2],Q1=class extends Ce{constructor(e){super(e)}},qy=[0],ev=[0,Ft,At,1,At,-3],Qn=class extends Ce{constructor(e){super(e,2)}},Wt={};Wt[336783863]=[0,st,At,-1,Ft,[0,[1,2,3,4,5,6,7,8],ot,qy,ot,Jy,ot,Zy,ot,ev,ot,Qy,ot,[0,st,-2],ot,[0,st,yr],ot,[0,yr,st]],[0,st],At,[0,[1,3],[2,4],ot,[0,tc],-1,ot,[0,hn],-1,Xt,[0,st,-1]],st];var J1=[0,sd,-1,to,-3,sd,tc,_s,Hi,sd,-1,to,Hi,to,-2,_s];function er(e,t){hf(e,2,_o(t),"")}function mt(e,t){Yu(e,3,t)}function Ke(e,t){Yu(e,4,t)}var xn=class extends Ce{constructor(e){super(e,500)}o(e){return Te(this,0,7,e)}},fa=[-1,{}],Z1=[0,st,1,fa],q1=[0,st,hn,fa];function tr(e,t){pu(e,1,xn,t)}function wt(e,t){Yu(e,10,t)}function rt(e,t){Yu(e,15,t)}var Ln=class extends Ce{constructor(e){super(e,500)}o(e){return Te(this,0,1001,e)}},tv=[-500,Xt,[-500,_s,-1,hn,-3,[-2,Wt,At],Xt,Y1,Hi,-1,Z1,q1,Xt,[0,_s,to],_s,J1,Hi,hn,987,hn],4,Xt,[-500,st,-1,[-1,{}],998,st],Xt,[-500,st,hn,-1,[-2,{},At],997,hn,-1],Hi,Xt,[-500,st,hn,fa,998,hn],hn,Hi,Z1,q1,Xt,[0,_s,-1,fa],hn,-2,J1,_s,-1,to,[0,to,o5],978,fa,Xt,Y1];Ln.prototype.g=nc(tv);var c5=Xs(Ln,tv),d5=class extends Ce{constructor(e){super(e)}},nv=class extends Ce{constructor(e){super(e)}g(){return ds(this,d5,1)}},rv=[0,Xt,[0,Ft,Gt,st,-1]],rc=Xs(nv,rv),f5=class extends Ce{constructor(e){super(e)}},h5=class extends Ce{constructor(e){super(e)}},od=class extends Ce{constructor(e){super(e)}h(){return qe(this,f5,2)}g(){return ds(this,h5,5)}},sv=Xs(class extends Ce{constructor(e){super(e)}},[0,hn,tc,sp,[0,yr,[0,Ft,-3],[0,Gt,-3],[0,Ft,-1,[0,Xt,[0,Ft,-2]]],Xt,[0,Gt,-1,st,Gt]],st,-1,Us,Xt,[0,Ft,Gt],hn,Us]),iv=class extends Ce{constructor(e){super(e)}},no=Xs(class extends Ce{constructor(e){super(e)}},[0,Xt,[0,Gt,-4]]),ov=class extends Ce{constructor(e){super(e)}},Ga=Xs(class extends Ce{constructor(e){super(e)}},[0,Xt,[0,Gt,-4]]),p5=class extends Ce{constructor(e){super(e)}},m5=[0,Ft,-1,sp,yr],av=class extends Ce{constructor(e){super(e)}};av.prototype.g=nc([0,Gt,-4,Us]);var g5=class extends Ce{constructor(e){super(e)}},y5=Xs(class extends Ce{constructor(e){super(e)}},[0,Xt,[0,1,Ft,st,rv],Us]),e0=class extends Ce{constructor(e){super(e)}},v5=class extends Ce{constructor(e){super(e)}oa(){const e=vy(this);return e??mi()}},x5=class extends Ce{constructor(e){super(e)}},lv=[1,2],w5=Xs(class extends Ce{constructor(e){super(e)}},[0,Xt,[0,lv,ot,[0,sp],ot,[0,Ky],Ft,st],Us]),ip=class extends Ce{constructor(e){super(e)}},uv=[0,st,Ft,Gt,hn,-1],t0=class extends Ce{constructor(e){super(e)}},S5=[0,At,-1],n0=class extends Ce{constructor(e){super(e)}},Rl=[1,2,3,4,5],yu=class extends Ce{constructor(e){super(e)}g(){return vy(this)!=null}h(){return gr(this,2)!=null}},Et=class extends Ce{constructor(e){super(e)}g(){return dy(mo(this,2))??!1}},cv=[0,Ky,st,[0,Ft,Us,-1],[0,s5,Us]],Dt=[0,cv,At,[0,Rl,ot,ev,ot,Jy,ot,Qy,ot,qy,ot,Zy],yr],sc=class extends Ce{constructor(e){super(e)}},op=[0,Dt,Gt,-1,Ft],k5=Pr(502141897,sc);Wt[502141897]=op;var A5=Xs(class extends Ce{constructor(e){super(e)}},[0,[0,yr,-1,r5,i5],m5]),dv=class extends Ce{constructor(e){super(e)}},fv=class extends Ce{constructor(e){super(e)}},ap=[0,Dt,Gt,[0,Dt],At],hv=[0,Dt,op,ap,Gt,[0,[0,cv]]],E5=Pr(508968150,fv);Wt[508968150]=hv,Wt[508968149]=ap;var pv=class extends Ce{constructor(e){super(e)}},C5=Pr(513916220,pv);Wt[513916220]=[0,Dt,hv,Ft];var Ni=class extends Ce{constructor(e){super(e)}h(){return qe(this,ip,2)}g(){ht(this,2)}},mv=[0,Dt,uv];Wt[478825465]=mv;var _5=class extends Ce{constructor(e){super(e)}},gv=class extends Ce{constructor(e){super(e)}},lp=class extends Ce{constructor(e){super(e)}},up=class extends Ce{constructor(e){super(e)}},yv=class extends Ce{constructor(e){super(e)}},r0=[0,Dt,[0,Dt],mv,-1],vv=[0,Dt,Gt,Ft],cp=[0,Dt,Gt],xv=[0,Dt,vv,cp,Gt],j5=Pr(479097054,yv);Wt[479097054]=[0,Dt,xv,r0],Wt[463370452]=r0,Wt[464864288]=vv;var N5=Pr(462713202,up);Wt[462713202]=xv,Wt[474472470]=cp;var b5=class extends Ce{constructor(e){super(e)}},wv=class extends Ce{constructor(e){super(e)}},Sv=class extends Ce{constructor(e){super(e)}},kv=class extends Ce{constructor(e){super(e)}},dp=[0,Dt,Gt,-1,Ft],vf=[0,Dt,Gt,At];kv.prototype.g=nc([0,Dt,cp,[0,Dt],op,ap,dp,vf]);var Av=class extends Ce{constructor(e){super(e)}},M5=Pr(456383383,Av);Wt[456383383]=[0,Dt,uv];var Ev=class extends Ce{constructor(e){super(e)}},T5=Pr(476348187,Ev);Wt[476348187]=[0,Dt,S5];var Cv=class extends Ce{constructor(e){super(e)}},s0=class extends Ce{constructor(e){super(e)}},_v=[0,yr,-1],P5=Pr(458105876,class extends Ce{constructor(e){super(e)}g(){var e=this.u;const t=0|e[be],n=2&t;return e=function(r,s,i){var a=s0;const u=2&s;let d=!1;if(i==null){if(u)return $1();i=[]}else if(i.constructor===mr){if(!(2&i.L)||u)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[be])):i=[];if(u){if(!i.length)return $1();d||(d=!0,Eo(i))}else d&&(d=!1,i=xy(i));return d||(64&(0|i[be])?i[be]&=-33:32&s&&$u(i,32)),bt(r,s,2,a=new mr(i,a,Dw,void 0)),a}(e,t,ps(e,t,2)),!n&&s0&&(e.ra=!0),e}});Wt[458105876]=[0,_v,n5,[!0,Us,[0,st,-1,hn]]];var fp=class extends Ce{constructor(e){super(e)}},jv=Pr(458105758,fp);Wt[458105758]=[0,Dt,st,_v];var Nv=class extends Ce{constructor(e){super(e)}},I5=Pr(443442058,Nv);Wt[443442058]=[0,Dt,st,Ft,Gt,hn,-1,At,Gt],Wt[514774813]=dp;var bv=class extends Ce{constructor(e){super(e)}},R5=Pr(516587230,bv);function xf(e,t){return t=t?t.clone():new ip,e.displayNamesLocale!==void 0?ht(t,1,_o(e.displayNamesLocale)):e.displayNamesLocale===void 0&&ht(t,1),e.maxResults!==void 0?Vr(t,2,e.maxResults):"maxResults"in e&&ht(t,2),e.scoreThreshold!==void 0?_e(t,3,e.scoreThreshold):"scoreThreshold"in e&&ht(t,3),e.categoryAllowlist!==void 0?mu(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&ht(t,4),e.categoryDenylist!==void 0?mu(t,5,e.categoryDenylist):"categoryDenylist"in e&&ht(t,5),t}function hp(e,t=-1,n=""){return{categories:e.map(r=>({index:dr(r,1)??0??-1,score:Ot(r,2)??0,categoryName:gr(r,3)??""??"",displayName:gr(r,4)??""??""})),headIndex:t,headName:n}}function Mv(e){var a,u;var t=ii(e,3,Ys,si()),n=ii(e,2,Co,si()),r=ii(e,1,po,si()),s=ii(e,9,po,si());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=qe(e,od,4))==null?void 0:a.h())&&(i.boundingBox={originX:dr(t,1)??0,originY:dr(t,2)??0,width:dr(t,3)??0,height:dr(t,4)??0,angle:0}),(u=qe(e,od,4))==null?void 0:u.g().length)for(const d of qe(e,od,4).g())i.keypoints.push({x:Pl(d,1)??0,y:Pl(d,2)??0,score:Pl(d,4)??0,label:gr(d,3)??""});return i}function ic(e){const t=[];for(const n of ds(e,ov,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function ha(e){const t=[];for(const n of ds(e,iv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function i0(e){return Array.from(e,t=>t>127?t-256:t)}function o0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let gl;Wt[516587230]=[0,Dt,dp,vf,Gt],Wt[518928384]=vf;const B5=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Tv(){if(gl===void 0)try{await WebAssembly.instantiate(B5),gl=!0}catch{gl=!1}return gl}async function Xo(e,t=l5``){const n=await Tv()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var ks=class{};function Pv(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function a0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function Iv(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function Ne(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function l0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=Iv(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function u0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function Or(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function xs(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}ks.forVisionTasks=function(e){return Xo("vision",e)},ks.forTextTasks=function(e){return Xo("text",e)},ks.forGenAiExperimentalTasks=function(e){return Xo("genai_experimental",e)},ks.forGenAiTasks=function(e){return Xo("genai",e)},ks.forAudioTasks=function(e){return Xo("audio",e)},ks.isSimdSupported=function(){return Tv()};async function L5(e,t,n,r){return e=await(async(s,i,a,u,d)=>{if(i&&await a0(i),!self.ModuleFactory||a&&(await a0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,u)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function ad(e,t){const n=qe(e.baseOptions,yu,1)||new yu;typeof t=="string"?(ht(n,2,_o(t)),ht(n,1)):t instanceof Uint8Array&&(ht(n,1,_h(t,!1)),ht(n,2)),Te(e.baseOptions,0,1,n)}function c0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function Ae(e,t){e.B=Math.max(e.B,t)}function oc(e,t){e.A=new xn,er(e.A,"PassThroughCalculator"),mt(e.A,"free_memory"),Ke(e.A,"free_memory_unused_out"),wt(t,"free_memory"),tr(t,e.A)}function yo(e,t){mt(e.A,t),Ke(e.A,t+"_unused_out")}function ac(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var Bl=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,u;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=qe(this.baseOptions,yu,1))!=null&&s.g()||(i=qe(this.baseOptions,yu,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(u=e.baseOptions)!=null&&u.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,g){let v=qe(h.baseOptions,n0,3);if(!v){var w=v=new n0,_=new Q1;da(w,4,Rl,_)}"delegate"in g&&(g.delegate==="GPU"?(g=v,w=new u5,da(g,2,Rl,w)):(g=v,w=new Q1,da(g,4,Rl,w))),Te(h.baseOptions,0,3,v)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),ad(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)ad(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const g=[];for(var v=0;;){const{done:w,value:_}=await h.read();if(w)break;g.push(_),v+=_.length}if(g.length===0)return new Uint8Array(0);if(g.length===1)return g[0];h=new Uint8Array(v),v=0;for(const w of g)h.set(w,v),v+=w.length;return h}(d.modelAssetBuffer).then(h=>{ad(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=c5(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,c0(this)}finishProcessing(){this.g.finishProcessing(),c0(this)}close(){this.A=void 0,this.g.closeGraph()}};function os(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Bl.prototype.close=Bl.prototype.close,function(e,t){e=e.split(".");var n,r=pi;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",Bl);class F5{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function d0(e,t,n){const r=e.g;if(n=os(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function f0(e,t){const n=e.g,r=os(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=os(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=os(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new F5(n,r,s,i)}function pp(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function mp(e,t,n,r){return pp(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=f0(e,!0)),n=e.s):(e.v||(e.v=f0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function lc(e,t,n){return pp(e,t),e=os(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function uc(e,t,n){pp(e,t),e.A||(e.A=os(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function gp(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var yp=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=os(e.createProgram(),"Failed to create WebGL program"),this.aa=d0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=d0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function qr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function wf(e){var t=qr(e,1);if(!t){if(t=qr(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=vo(e);var n=vp(e);if(uc(n,r,Rv(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function Rv(e){let t=qr(e,2);if(!t){const n=vo(e);t=Lv(e);const r=wf(e),s=Bv(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),Sf(e)}return t}function vo(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=os(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Bv(e){if(e=vo(e),!yl)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))yl=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");yl=e.R16F}return yl}function vp(e){return e.l||(e.l=new yp),e.l}function Lv(e){const t=vo(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=qr(e,2);return n||(n=lc(vp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Sf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var yl,qt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--h0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!qr(this,0)}ja(){return!!qr(this,1)}P(){return!!qr(this,2)}ia(){return(t=qr(e=this,0))||(t=wf(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return wf(this)}M(){return Rv(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=vo(this),s=vp(this);r.activeTexture(r.TEXTURE1),n=lc(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=Bv(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),uc(s,r,n),mp(s,r,!1,()=>{Lv(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Sf(this)}),gp(s),Sf(this)}}e.push(n)}return new qt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&vo(this).deleteTexture(qr(this,2)),h0=-1}};qt.prototype.close=qt.prototype.close,qt.prototype.clone=qt.prototype.clone,qt.prototype.getAsWebGLTexture=qt.prototype.M,qt.prototype.getAsFloat32Array=qt.prototype.ha,qt.prototype.getAsUint8Array=qt.prototype.ia,qt.prototype.hasWebGLTexture=qt.prototype.P,qt.prototype.hasFloat32Array=qt.prototype.ja,qt.prototype.hasUint8Array=qt.prototype.Fa;var h0=250;function Ur(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function Fv(e){var t=Ur(e,0);if(!t){t=xo(e);const n=cc(e),r=new Uint8Array(e.width*e.height*4);uc(n,t,Ll(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),gp(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function Ll(e){let t=Ur(e,2);if(!t){const n=xo(e);t=Fl(e);const r=Ur(e,1)||Fv(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),ea(e)}return t}function xo(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=os(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function cc(e){return e.l||(e.l=new yp),e.l}function Fl(e){const t=xo(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Ur(e,2);return n||(n=lc(cc(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function ea(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function p0(e){const t=xo(e);return mp(cc(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var en=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--m0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Ur(this,0)}ka(){return!!Ur(this,1)}P(){return!!Ur(this,2)}Ca(){return Fv(this)}Ba(){var e=Ur(this,1);return e||(Ll(this),Fl(this),e=p0(this),ea(this),this.g.push(e),this.j=!0),e}M(){return Ll(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=xo(this),s=cc(this);r.activeTexture(r.TEXTURE1),n=lc(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),uc(s,r,n),mp(s,r,!1,()=>{Fl(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),ea(this)}),gp(s),ea(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Ll(this),Fl(this),n=p0(this),ea(this)}e.push(n)}return new en(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Ur(this,1).close(),this.m&&xo(this).deleteTexture(Ur(this,2)),m0=-1}};en.prototype.close=en.prototype.close,en.prototype.clone=en.prototype.clone,en.prototype.getAsWebGLTexture=en.prototype.M,en.prototype.getAsImageBitmap=en.prototype.Ba,en.prototype.getAsImageData=en.prototype.Ca,en.prototype.hasWebGLTexture=en.prototype.P,en.prototype.hasImageBitmap=en.prototype.ka,en.prototype.hasImageData=en.prototype.Ea;var m0=250;function Ir(...e){return e.map(([t,n])=>({start:t,end:n}))}const O5=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((g0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:Pv()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),Ne(this,r||"input_audio",i=>{Ne(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){Or(this,"__graph_config__",t=>{e(t)}),Ne(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),Ne(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){Ne(this,t,r=>{const[s,i]=l0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){Ne(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){Ne(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){Ne(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){Ne(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){Ne(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){Ne(this,t,r=>{Ne(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){Ne(this,t,r=>{u0(this,Object.keys(e),s=>{u0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){Ne(this,n,s=>{Ne(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){Ne(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){Ne(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)Ne(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){Ne(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){Ne(this,t,n=>{Ne(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){Ne(this,n,r=>{Ne(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){Ne(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)Ne(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){Or(this,e,t),Ne(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){xs(this,e,t),Ne(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){Or(this,e,t),Ne(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){xs(this,e,t),Ne(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){Or(this,e,t),Ne(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){xs(this,e,t),Ne(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){Or(this,e,t),Ne(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){xs(this,e,t),Ne(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){Or(this,e,t),Ne(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){xs(this,e,t),Ne(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){Or(this,e,t),Ne(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){xs(this,e,t),Ne(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){Or(this,e,t),Ne(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){xs(this,e,t),Ne(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Or(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),Ne(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends g0{get ea(){return this.i}qa(e,t,n){Ne(this,t,r=>{const[s,i]=l0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){Or(this,e,t),Ne(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){xs(this,e,t),Ne(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var g0,vr=class extends O5{};async function Xe(e,t,n){return async function(r,s,i,a){return L5(r,s,i,a)}(e,n.canvas??(Pv()?void 0:document.createElement("canvas")),t,n)}function Ov(e,t,n,r){if(e.T){const i=new av;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");_e(i,1,(s.left+s.right)/2),_e(i,2,(s.top+s.bottom)/2),_e(i,4,s.right-s.left),_e(i,3,s.bottom-s.top)}else _e(i,1,.5),_e(i,2,.5),_e(i,4,1),_e(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(_e(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,u]=Iv(t);n=Ot(i,3)*u/a,s=Ot(i,4)*a/u,_e(i,4,n),_e(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function xr(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Ov(e,t,n,e.B+1)}function Yr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Ov(e,t,n,r)}function wo(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new qt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Bn=class extends Bl{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new yp}l(e,t=!0){if("runningMode"in e&&Ia(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Bn.prototype.close=Bn.prototype.close;var sr=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Te(e=this.h=new sc,0,1,t=new Et),_e(this.h,2,.5),_e(this.h,3,.3)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&_e(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&_e(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},xr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Yr(this,e,n,t),this.j}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect_in"),rt(e,"detections");const t=new Qn;Mr(t,k5,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect_in"),Ke(n,"DETECTIONS:detections"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=sv(i),this.j.detections.push(Mv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};sr.prototype.detectForVideo=sr.prototype.F,sr.prototype.detect=sr.prototype.D,sr.prototype.setOptions=sr.prototype.o,sr.createFromModelPath=async function(e,t){return Xe(sr,e,{baseOptions:{modelAssetPath:t}})},sr.createFromModelBuffer=function(e,t){return Xe(sr,e,{baseOptions:{modelAssetBuffer:t}})},sr.createFromOptions=function(e,t){return Xe(sr,e,t)};var xp=Ir([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),wp=Ir([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),Sp=Ir([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),$v=Ir([474,475],[475,476],[476,477],[477,474]),kp=Ir([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),Ap=Ir([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Dv=Ir([469,470],[470,471],[471,472],[472,469]),Ep=Ir([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),zv=[...xp,...wp,...Sp,...kp,...Ap,...Ep],Uv=Ir([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function y0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var Rt=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Te(e=this.h=new fv,0,1,t=new Et),this.v=new dv,Te(this.h,0,3,this.v),this.s=new sc,Te(this.h,0,2,this.s),Vr(this.s,4,1),_e(this.s,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numFaces"in e&&Vr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&_e(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return y0(this),xr(this,e,t),this.j}F(e,t,n){return y0(this),Yr(this,e,n,t),this.j}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"face_landmarks");const t=new Qn;Mr(t,E5,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=Ga(i),this.j.faceLandmarks.push(ic(r));Ae(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{Ae(this,r)}),this.outputFaceBlendshapes&&(rt(e,"blendshapes"),Ke(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=rc(i),this.j.faceBlendshapes.push(hp(r.g()??[]));Ae(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{Ae(this,r)})),this.outputFacialTransformationMatrixes&&(rt(e,"face_geometry"),Ke(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=qe(A5(i),p5,2))&&this.j.facialTransformationMatrixes.push({rows:dr(r,1)??0??0,columns:dr(r,2)??0??0,data:ii(r,3,Ys,si()).slice()??[]});Ae(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Rt.prototype.detectForVideo=Rt.prototype.F,Rt.prototype.detect=Rt.prototype.D,Rt.prototype.setOptions=Rt.prototype.o,Rt.createFromModelPath=function(e,t){return Xe(Rt,e,{baseOptions:{modelAssetPath:t}})},Rt.createFromModelBuffer=function(e,t){return Xe(Rt,e,{baseOptions:{modelAssetBuffer:t}})},Rt.createFromOptions=function(e,t){return Xe(Rt,e,t)},Rt.FACE_LANDMARKS_LIPS=xp,Rt.FACE_LANDMARKS_LEFT_EYE=wp,Rt.FACE_LANDMARKS_LEFT_EYEBROW=Sp,Rt.FACE_LANDMARKS_LEFT_IRIS=$v,Rt.FACE_LANDMARKS_RIGHT_EYE=kp,Rt.FACE_LANDMARKS_RIGHT_EYEBROW=Ap,Rt.FACE_LANDMARKS_RIGHT_IRIS=Dv,Rt.FACE_LANDMARKS_FACE_OVAL=Ep,Rt.FACE_LANDMARKS_CONTOURS=zv,Rt.FACE_LANDMARKS_TESSELATION=Uv;var $r=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect",!0),Te(e=this.j=new pv,0,1,t=new Et)}get baseOptions(){return qe(this.j,Et,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,xr(this,e,r??{}),!this.h)return this.s}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"stylized_image");const t=new Qn;Mr(t,C5,this.j);const n=new xn;er(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),tr(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,u=r.width;const d=u*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let g=0;g<d;++g)h[4*g]=a[3*g],h[4*g+1]=a[3*g+1],h[4*g+2]=a[3*g+2],h[4*g+3]=255;a=new ImageData(h,u,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),u,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);u=new en([a],!1,!1,this.g.i.canvas,this.O,u,r),this.s=i=i?u.clone():u,this.h&&this.h(i),Ae(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};$r.prototype.stylize=$r.prototype.Oa,$r.prototype.setOptions=$r.prototype.o,$r.createFromModelPath=function(e,t){return Xe($r,e,{baseOptions:{modelAssetPath:t}})},$r.createFromModelBuffer=function(e,t){return Xe($r,e,{baseOptions:{modelAssetBuffer:t}})},$r.createFromOptions=function(e,t){return Xe($r,e,t)};var Cp=Ir([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function v0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function x0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function w0(e,t=!0){const n=[];for(const s of e){var r=rc(s);e=[];for(const i of r.g())r=t&&dr(i,1)!=null?dr(i,1)??0:-1,e.push({score:Ot(i,2)??0,index:r,categoryName:gr(i,3)??""??"",displayName:gr(i,4)??""??""});n.push(e)}return n}var Un=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Te(e=this.j=new yv,0,1,t=new Et),this.s=new up,Te(this.j,0,2,this.s),this.C=new lp,Te(this.s,0,3,this.C),this.v=new gv,Te(this.s,0,2,this.v),this.h=new _5,Te(this.j,0,3,this.h),_e(this.v,2,.5),_e(this.s,4,.5),_e(this.C,2,.5)}get baseOptions(){return qe(this.j,Et,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){var s,i,a,u;if(Vr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new Ni,n=t,r=xf(e.cannedGesturesClassifierOptions,(s=qe(this.h,Ni,3))==null?void 0:s.h());Te(n,0,2,r),Te(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=qe(this.h,Ni,3))==null||i.g());return e.customGesturesClassifierOptions?(Te(n=t=new Ni,0,2,r=xf(e.customGesturesClassifierOptions,(a=qe(this.h,Ni,4))==null?void 0:a.h())),Te(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((u=qe(this.h,Ni,4))==null||u.g()),this.l(e)}Ja(e,t){return v0(this),xr(this,e,t),x0(this)}Ka(e,t,n){return v0(this),Yr(this,e,n,t),x0(this)}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"hand_gestures"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Qn;Mr(t,j5,this.j);const n=new xn;er(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"HAND_GESTURES:hand_gestures"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=Ga(i);const a=[];for(const u of ds(r,ov,1))a.push({x:Ot(u,1)??0,y:Ot(u,2)??0,z:Ot(u,3)??0,visibility:Ot(u,4)??0});this.landmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=no(i);const a=[];for(const u of ds(r,iv,1))a.push({x:Ot(u,1)??0,y:Ot(u,2)??0,z:Ot(u,3)??0,visibility:Ot(u,4)??0});this.worldLandmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...w0(r,!1)),Ae(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...w0(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function S0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Un.prototype.recognizeForVideo=Un.prototype.Ka,Un.prototype.recognize=Un.prototype.Ja,Un.prototype.setOptions=Un.prototype.o,Un.createFromModelPath=function(e,t){return Xe(Un,e,{baseOptions:{modelAssetPath:t}})},Un.createFromModelBuffer=function(e,t){return Xe(Un,e,{baseOptions:{modelAssetBuffer:t}})},Un.createFromOptions=function(e,t){return Xe(Un,e,t)},Un.HAND_CONNECTIONS=Cp;var Hn=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Te(e=this.h=new up,0,1,t=new Et),this.s=new lp,Te(this.h,0,3,this.s),this.j=new gv,Te(this.h,0,2,this.j),Vr(this.j,3,1),_e(this.j,2,.5),_e(this.s,2,.5),_e(this.h,4,.5)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numHands"in e&&Vr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],xr(this,e,t),S0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Yr(this,e,n,t),S0(this)}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"hand_landmarks"),rt(e,"world_hand_landmarks"),rt(e,"handedness");const t=new Qn;Mr(t,N5,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=Ga(i),this.landmarks.push(ic(r));Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=no(i),this.worldLandmarks.push(ha(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const u=[];for(const d of r){r=rc(d);const h=[];for(const g of r.g())h.push({score:Ot(g,2)??0,index:dr(g,1)??0??-1,categoryName:gr(g,3)??""??"",displayName:gr(g,4)??""??""});u.push(h)}a.call(i,...u),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Hn.prototype.detectForVideo=Hn.prototype.F,Hn.prototype.detect=Hn.prototype.D,Hn.prototype.setOptions=Hn.prototype.o,Hn.createFromModelPath=function(e,t){return Xe(Hn,e,{baseOptions:{modelAssetPath:t}})},Hn.createFromModelBuffer=function(e,t){return Xe(Hn,e,{baseOptions:{modelAssetBuffer:t}})},Hn.createFromOptions=function(e,t){return Xe(Hn,e,t)},Hn.HAND_CONNECTIONS=Cp;var Hv=Ir([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function k0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function A0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{ac(e)}}function vl(e,t){e=Ga(e),t.push(ic(e))}var St=class extends Bn{constructor(e,t){super(new vr(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Te(e=this.j=new kv,0,1,t=new Et),this.J=new lp,Te(this.j,0,2,this.J),this.Z=new b5,Te(this.j,0,3,this.Z),this.s=new sc,Te(this.j,0,4,this.s),this.H=new dv,Te(this.j,0,5,this.H),this.v=new wv,Te(this.j,0,6,this.v),this.K=new Sv,Te(this.j,0,7,this.K),_e(this.s,2,.5),_e(this.s,3,.3),_e(this.H,2,.5),_e(this.v,2,.5),_e(this.v,3,.3),_e(this.K,2,.5),_e(this.J,2,.5)}get baseOptions(){return qe(this.j,Et,1)}set baseOptions(e){Te(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&_e(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&_e(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&_e(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&_e(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&_e(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&_e(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,k0(this),xr(this,e,r),A0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,k0(this),Yr(this,e,s,t),A0(this)}m(){var e=new Ln;wt(e,"input_frames_image"),rt(e,"pose_landmarks"),rt(e,"pose_world_landmarks"),rt(e,"face_landmarks"),rt(e,"left_hand_landmarks"),rt(e,"left_hand_world_landmarks"),rt(e,"right_hand_landmarks"),rt(e,"right_hand_world_landmarks");const t=new Qn,n=new V1;hf(n,1,_o("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))ht(s,2,gy(i));else{if(!(typeof i=="string"||i instanceof ss||Da(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");hf(s,2,_h(i,!1),mi())}}(n,this.j.g());const r=new xn;er(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),pu(r,8,V1,n),mt(r,"IMAGE:input_frames_image"),Ke(r,"POSE_LANDMARKS:pose_landmarks"),Ke(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Ke(r,"FACE_LANDMARKS:face_landmarks"),Ke(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Ke(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Ke(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Ke(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),tr(e,r),oc(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{vl(s,this.h.poseLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=no(s),a.push(ha(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{Ae(this,s)}),this.outputPoseSegmentationMasks&&(Ke(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),yo(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[wo(this,s,!0,!this.C)],Ae(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],Ae(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{vl(s,this.h.faceLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{Ae(this,s)}),this.outputFaceBlendshapes&&(rt(e,"extra_blendshapes"),Ke(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=rc(s),a.push(hp(s.g()??[]))),Ae(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{Ae(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{vl(s,this.h.leftHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=no(s),a.push(ha(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{vl(s,this.h.rightHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=no(s),a.push(ha(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{Ae(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};St.prototype.detectForVideo=St.prototype.F,St.prototype.detect=St.prototype.D,St.prototype.setOptions=St.prototype.o,St.createFromModelPath=function(e,t){return Xe(St,e,{baseOptions:{modelAssetPath:t}})},St.createFromModelBuffer=function(e,t){return Xe(St,e,{baseOptions:{modelAssetBuffer:t}})},St.createFromOptions=function(e,t){return Xe(St,e,t)},St.HAND_CONNECTIONS=Cp,St.POSE_CONNECTIONS=Hv,St.FACE_LANDMARKS_LIPS=xp,St.FACE_LANDMARKS_LEFT_EYE=wp,St.FACE_LANDMARKS_LEFT_EYEBROW=Sp,St.FACE_LANDMARKS_LEFT_IRIS=$v,St.FACE_LANDMARKS_RIGHT_EYE=kp,St.FACE_LANDMARKS_RIGHT_EYEBROW=Ap,St.FACE_LANDMARKS_RIGHT_IRIS=Dv,St.FACE_LANDMARKS_FACE_OVAL=Ep,St.FACE_LANDMARKS_CONTOURS=zv,St.FACE_LANDMARKS_TESSELATION=Uv;var ir=class extends Bn{constructor(e,t){super(new vr(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Te(e=this.h=new Av,0,1,t=new Et)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return Te(this.h,0,2,xf(e,qe(this.h,ip,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},xr(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},Yr(this,e,n,t),this.j}m(){var e=new Ln;wt(e,"input_image"),wt(e,"norm_rect"),rt(e,"classifications");const t=new Qn;Mr(t,M5,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),mt(n,"IMAGE:input_image"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"CLASSIFICATIONS:classifications"),n.o(t),tr(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:ds(i,g5,1).map(u=>{var d;return hp(((d=qe(u,nv,4))==null?void 0:d.g())??[],dr(u,2)??0,gr(u,3)??"")})};return hu(mo(i,2))!=null&&(a.timestampMs=hu(mo(i,2))??0),a}(y5(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ir.prototype.classifyForVideo=ir.prototype.ta,ir.prototype.classify=ir.prototype.sa,ir.prototype.setOptions=ir.prototype.o,ir.createFromModelPath=function(e,t){return Xe(ir,e,{baseOptions:{modelAssetPath:t}})},ir.createFromModelBuffer=function(e,t){return Xe(ir,e,{baseOptions:{modelAssetBuffer:t}})},ir.createFromOptions=function(e,t){return Xe(ir,e,t)};var Gn=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect",!0),this.h=new Ev,this.embeddings={embeddings:[]},Te(e=this.h,0,1,t=new Et)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){var t=this.h,n=qe(this.h,t0,2);return n=n?n.clone():new t0,e.l2Normalize!==void 0?Ia(n,1,e.l2Normalize):"l2Normalize"in e&&ht(n,1),e.quantize!==void 0?Ia(n,2,e.quantize):"quantize"in e&&ht(n,2),Te(t,0,2,n),this.l(e)}za(e,t){return xr(this,e,t),this.embeddings}Aa(e,t,n){return Yr(this,e,n,t),this.embeddings}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"embeddings_out");const t=new Qn;Mr(t,T5,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"EMBEDDINGS:embeddings_out"),n.o(t),tr(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=w5(r),this.embeddings=function(i){return{embeddings:ds(i,x5,1).map(a=>{var d,h;const u={headIndex:dr(a,3)??0??-1,headName:gr(a,4)??""??""};if(Sy(a,e0,nd(a,1))!==void 0)a=ii(a=qe(a,e0,nd(a,1)),1,Ys,si()),u.floatEmbedding=a.slice();else{const g=new Uint8Array(0);u.quantizedEmbedding=((h=(d=qe(a,v5,nd(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??g}return u}),timestampMs:hu(mo(i,2))??0}}(r),Ae(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Gn.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=o0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=o0(i0(e.quantizedEmbedding),i0(t.quantizedEmbedding))}return e},Gn.prototype.embedForVideo=Gn.prototype.Aa,Gn.prototype.embed=Gn.prototype.za,Gn.prototype.setOptions=Gn.prototype.o,Gn.createFromModelPath=function(e,t){return Xe(Gn,e,{baseOptions:{modelAssetPath:t}})},Gn.createFromModelBuffer=function(e,t){return Xe(Gn,e,{baseOptions:{modelAssetBuffer:t}})},Gn.createFromOptions=function(e,t){return Xe(Gn,e,t)};var kf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function E0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function C0(e){try{const t=new kf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{ac(e)}}kf.prototype.close=kf.prototype.close;var fn=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new fp,this.v=new Cv,Te(this.h,0,3,this.v),Te(e=this.h,0,1,t=new Et)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ht(this.h,2,_o(e.displayNamesLocale)):"displayNamesLocale"in e&&ht(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=ds(e.da(),xn,1).filter(s=>(gr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=qe(t[0],Qn,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=gr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,E0(this),xr(this,e,r),C0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,E0(this),Yr(this,e,s,t),C0(this)}Da(){return this.s}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect");const t=new Qn;Mr(t,jv,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),n.o(t),tr(e,n),oc(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),yo(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>wo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),yo(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=wo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),rt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};fn.prototype.getLabels=fn.prototype.Da,fn.prototype.segmentForVideo=fn.prototype.Ma,fn.prototype.segment=fn.prototype.segment,fn.prototype.setOptions=fn.prototype.o,fn.createFromModelPath=function(e,t){return Xe(fn,e,{baseOptions:{modelAssetPath:t}})},fn.createFromModelBuffer=function(e,t){return Xe(fn,e,{baseOptions:{modelAssetBuffer:t}})},fn.createFromOptions=function(e,t){return Xe(fn,e,t)};var Af=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};Af.prototype.close=Af.prototype.close;var $5=class extends Ce{constructor(e){super(e)}},bi=[0,Ft,-2],vu=[0,Zr,-3,At,Zr,-1],_0=[0,vu],j0=[0,vu,Ft,-1],ld=class extends Ce{constructor(e){super(e)}},N0=[0,Zr,-1,At],D5=class extends Ce{constructor(e){super(e)}},b0=class extends Ce{constructor(e){super(e)}},Ef=[1,2,3,4,5,6,7,8,9,10,14,15],Gv=class extends Ce{constructor(e){super(e)}};Gv.prototype.g=nc([0,Xt,[0,Ef,ot,vu,ot,[0,vu,bi],ot,_0,ot,[0,_0,bi],ot,N0,ot,[0,Zr,-3,At,yr],ot,[0,Zr,-3,At],ot,[0,st,Zr,-2,At,Ft,At,-1,2,Zr,bi],ot,j0,ot,[0,j0,bi],Zr,bi,st,ot,[0,Zr,-3,At,bi,-1],ot,[0,Xt,N0]],st,[0,st,Ft,-1,At]]);var Dr=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new fp,this.s=new Cv,Te(this.h,0,3,this.s),Te(e=this.h,0,1,t=new Et)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new Gv;const i=new b0;var a=new $5;if(Vr(a,1,255),Te(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var u=new ld;Ia(u,3,!0),_e(u,1,t.keypoint.x),_e(u,2,t.keypoint.y),da(i,5,Ef,u)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(u of(a=new D5,t.scribble))Ia(t=new ld,3,!0),_e(t,1,u.x),_e(t,2,u.y),pu(a,1,ld,t);da(i,15,Ef,a)}pu(r,1,b0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),xr(this,e,s);e:{try{const h=new Af(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{ac(this)}d=void 0}return d}m(){var e=new Ln;wt(e,"image_in"),wt(e,"roi_in"),wt(e,"norm_rect_in");const t=new Qn;Mr(t,jv,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),mt(n,"IMAGE:image_in"),mt(n,"ROI:roi_in"),mt(n,"NORM_RECT:norm_rect_in"),n.o(t),tr(e,n),oc(this,e),this.outputConfidenceMasks&&(rt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),yo(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>wo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(rt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),yo(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=wo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),rt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Dr.prototype.segment=Dr.prototype.segment,Dr.prototype.setOptions=Dr.prototype.o,Dr.createFromModelPath=function(e,t){return Xe(Dr,e,{baseOptions:{modelAssetPath:t}})},Dr.createFromModelBuffer=function(e,t){return Xe(Dr,e,{baseOptions:{modelAssetBuffer:t}})},Dr.createFromOptions=function(e,t){return Xe(Dr,e,t)};var or=class extends Bn{constructor(e,t){super(new vr(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Te(e=this.h=new Nv,0,1,t=new Et)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ht(this.h,2,_o(e.displayNamesLocale)):"displayNamesLocale"in e&&ht(this.h,2),e.maxResults!==void 0?Vr(this.h,3,e.maxResults):"maxResults"in e&&ht(this.h,3),e.scoreThreshold!==void 0?_e(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&ht(this.h,4),e.categoryAllowlist!==void 0?mu(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&ht(this.h,5),e.categoryDenylist!==void 0?mu(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&ht(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},xr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Yr(this,e,n,t),this.j}m(){var e=new Ln;wt(e,"input_frame_gpu"),wt(e,"norm_rect"),rt(e,"detections");const t=new Qn;Mr(t,I5,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),mt(n,"IMAGE:input_frame_gpu"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"DETECTIONS:detections"),n.o(t),tr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=sv(i),this.j.detections.push(Mv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};or.prototype.detectForVideo=or.prototype.F,or.prototype.detect=or.prototype.D,or.prototype.setOptions=or.prototype.o,or.createFromModelPath=async function(e,t){return Xe(or,e,{baseOptions:{modelAssetPath:t}})},or.createFromModelBuffer=function(e,t){return Xe(or,e,{baseOptions:{modelAssetBuffer:t}})},or.createFromOptions=function(e,t){return Xe(or,e,t)};var Cf=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function M0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function T0(e){try{const t=new Cf(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{ac(e)}}Cf.prototype.close=Cf.prototype.close;var Wn=class extends Bn{constructor(e,t){super(new vr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Te(e=this.h=new bv,0,1,t=new Et),this.v=new Sv,Te(this.h,0,3,this.v),this.j=new wv,Te(this.h,0,2,this.j),Vr(this.j,4,1),_e(this.j,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return qe(this.h,Et,1)}set baseOptions(e){Te(this.h,0,1,e)}o(e){return"numPoses"in e&&Vr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&_e(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&_e(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,M0(this),xr(this,e,r),T0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,M0(this),Yr(this,e,s,t),T0(this)}m(){var e=new Ln;wt(e,"image_in"),wt(e,"norm_rect"),rt(e,"normalized_landmarks"),rt(e,"world_landmarks"),rt(e,"segmentation_masks");const t=new Qn;Mr(t,R5,this.h);const n=new xn;er(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),mt(n,"IMAGE:image_in"),mt(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:normalized_landmarks"),Ke(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),tr(e,n),oc(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=Ga(i),this.landmarks.push(ic(r));Ae(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],Ae(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=no(i),this.worldLandmarks.push(ha(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],Ae(this,r)}),this.outputSegmentationMasks&&(Ke(n,"SEGMENTATION_MASK:segmentation_masks"),yo(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>wo(this,i,!0,!this.s)),Ae(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Wn.prototype.detectForVideo=Wn.prototype.F,Wn.prototype.detect=Wn.prototype.D,Wn.prototype.setOptions=Wn.prototype.o,Wn.createFromModelPath=function(e,t){return Xe(Wn,e,{baseOptions:{modelAssetPath:t}})},Wn.createFromModelBuffer=function(e,t){return Xe(Wn,e,{baseOptions:{modelAssetBuffer:t}})},Wn.createFromOptions=function(e,t){return Xe(Wn,e,t)},Wn.POSE_CONNECTIONS=Hv;const Wv="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",z5=Wv,xu=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let u=0,d=0,h=0;t>=0&&t<60?(u=s,d=i,h=0):t<120?(u=i,d=s,h=0):t<180?(u=0,d=s,h=i):t<240?(u=0,d=i,h=s):t<300?(u=i,d=0,h=s):(u=s,d=0,h=i);const g=v=>Math.max(0,Math.min(255,Math.round((v+a)*255)));return{r:g(u),g:g(d),b:g(h)}}return null},_p=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),P0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),I0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},Vv=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const u=e.canvas;return s=u.width,i=u.height,r=u.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(u){console.warn("[ColorDetector] Failed to extract category mask data:",u)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},U5=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=xu(t),a=xu(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:u="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:g=50,minGapRatio:v=.05}=r,w=new Image;w.crossOrigin="anonymous",w.onload=()=>{try{const _=w.width>d?d/w.width:1,R=Math.max(1,Math.round(w.width*_)),B=Math.max(1,Math.round(w.height*_)),K=document.createElement("canvas");K.width=R,K.height=B;const E=K.getContext("2d");if(!E){s({suggestion:"None",stats:{mode:"colorMask"}});return}E.drawImage(w,0,0,R,B);const y=E.getImageData(0,0,R,B),{data:k}=y,M=h*h,b={minY:B,maxY:-1,pixels:0},H={minY:B,maxY:-1,pixels:0},I=new Uint8Array(R*B);for(let Q=0;Q<B;Q+=1)for(let re=0;re<R;re+=1){const he=(Q*R+re)*4,pe=Q*R+re,Se=k[he],se=k[he+1],te=k[he+2],q=(Se-i.r)*(Se-i.r)+(se-i.g)*(se-i.g)+(te-i.b)*(te-i.b),me=(Se-a.r)*(Se-a.r)+(se-a.g)*(se-a.g)+(te-a.b)*(te-a.b);q<M&&q<me?(b.pixels+=1,Q<b.minY&&(b.minY=Q),Q>b.maxY&&(b.maxY=Q),I[pe]=1):me<M&&me<q&&(H.pixels+=1,Q<H.minY&&(H.minY=Q),Q>H.maxY&&(H.maxY=Q),I[pe]=2)}const O={mode:"colorMask",pixelsA:b.pixels,pixelsB:H.pixels,minYA:b.pixels>0?b.minY:null,maxYA:b.pixels>0?b.maxY:null,minYB:H.pixels>0?H.minY:null,maxYB:H.pixels>0?H.maxY:null,width:R,height:B},z=b.pixels>=g,W=H.pixels>=g;let X="None";if(z&&!W)X="A";else if(!z&&W)X="B";else if(z&&W){let Q,re;u==="top"?(Q=b.minY,re=H.minY):(Q=b.maxY,re=H.maxY);const he=Math.abs(Q-re),pe=B*v;he>=pe&&(X=u==="top"?Q<re?"A":"B":Q>re?"A":"B")}let Z=null;try{const Q=document.createElement("canvas");Q.width=R,Q.height=B;const re=Q.getContext("2d");re.drawImage(w,0,0,R,B);const he=re.getImageData(0,0,R,B),pe=he.data,Se=(q,me)=>{pe[q]=Math.round(pe[q]*.3+me.r*.7),pe[q+1]=Math.round(pe[q+1]*.3+me.g*.7),pe[q+2]=Math.round(pe[q+2]*.3+me.b*.7),pe[q+3]=255},se={r:255,g:82,b:97},te={r:80,g:170,b:255};for(let q=0;q<I.length;q+=1)I[q]===1?Se(q*4,se):I[q]===2&&Se(q*4,te);re.putImageData(he,0,0),Z=Q.toDataURL("image/png")}catch(Q){console.warn("[ColorDetector] Failed generating preview",Q)}s({suggestion:X,stats:O,preview:Z})}catch(_){console.error("[ColorDetector] Error processing frame:",_),s({suggestion:"None",stats:{mode:"colorMask"}})}},w.onerror=_=>{console.error("[ColorDetector] Failed to load frame image",_),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?w.src=e:typeof e=="string"?w.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),R0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const _ of e){const R=_.y*t+_.x;R>=0&&R<i.length&&(i[R]=1)}const a=[],u=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const _ of e){const R=_.y*t+_.x;if(R<0||R>=i.length||i[R]!==1)continue;let B=0;const K=[{x:_.x,y:_.y}];i[R]=2;const E=[];let y=0;for(;y<K.length;){const{x:k,y:M}=K[y++];B++,E.push({x:k,y:M});for(const b of u){const H=k+b.dx,I=M+b.dy;if(H>=0&&H<t&&I>=0&&I<n){const O=I*t+H;O>=0&&O<i.length&&i[O]===1&&(i[O]=2,K.push({x:H,y:I}))}}}a.push({size:B,pixels:E})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((_,R)=>R.size>_.size?R:_).size,g=Math.max(1,Math.floor(h*s));let v=0;const w=[];for(const _ of a)_.size>=g&&(v+=_.size,w.push(..._.pixels));return{count:v,pixels:w,largestBlobSize:h,minBlobSize:g,totalBlobs:a.length,filteredBlobs:a.filter(_=>_.size>=g).length}},H5=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=xu(t),i=xu(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await _p(e),u=a.naturalWidth||a.width,d=a.naturalHeight||a.height,g=(await jp()).segment(a),{maskData:v,maskWidth:w,maskHeight:_,isRGBA:R}=Vv(g.categoryMask,u,d);if(!v)throw new Error("Failed to extract segmentation mask data");const B=new Uint8ClampedArray(u*d*4),K=u/w,E=d/_;for(let U=0;U<d;U++)for(let G=0;G<u;G++){const J=Math.min(w-1,Math.floor(G/K)),L=(Math.min(_-1,Math.floor(U/E))*w+J)*(R?4:1);let m=0;v&&L<v.length&&(m=v[L]);const T=m!==0&&m!==2?255:0,N=(U*u+G)*4;B[N]=T,B[N+1]=T,B[N+2]=T,B[N+3]=255}const y=document.createElement("canvas");y.width=u,y.height=d;const k=y.getContext("2d");k.drawImage(a,0,0,u,d);const M=k.getImageData(0,0,u,d).data,b=r.maskThreshold||100,H=r.colorThreshold??95,I=r.anchor||"top",O=H*H,z=r.scanDepth??1,W=r.stride||2;let X=I==="top"?d:0,Z=!1;if(I==="top")for(let U=0;U<d;U+=W){for(let G=0;G<u;G+=W)if(B[(U*u+G)*4]>=b){X=U,Z=!0;break}if(Z)break}else for(let U=d-1;U>=0;U-=W){for(let G=0;G<u;G+=W)if(B[(U*u+G)*4]>=b){X=U,Z=!0;break}if(Z)break}let Q,re,he;if(r.manualBounds&&I==="manually")Q=r.manualBounds.topY,re=r.manualBounds.bottomY,he=re-Q,Z||(X=Q);else{if(!Z)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};he=z?Math.floor(d*z):d,I==="top"?(Q=X,re=Math.min(d,X+he)):(Q=Math.max(0,X-he),re=X)}const pe=[],Se=[];for(let U=Q;U<re;U+=W)for(let G=0;G<u;G+=W){const J=(U*u+G)*4;if(B[J]<b)continue;const ee=M[J],L=M[J+1],m=M[J+2],T=P0({r:ee,g:L,b:m},s),N=P0({r:ee,g:L,b:m},i);T<O&&T<N?pe.push({x:G,y:U}):N<O&&N<T&&Se.push({x:G,y:U})}const se=r.minBlobRatio??.1,te=R0(pe,u,d,W,se),q=R0(Se,u,d,W,se),me=te.count,Me=q.count,Ue=te.pixels.map(U=>({...U,idx:(U.y*u+U.x)*4})),He=q.pixels.map(U=>({...U,idx:(U.y*u+U.x)*4})),Re=50;let De="None",ne=null;me>Re&&me>Me?(De="A",ne={color:"A",pixelCount:me,minY:Q,maxY:re,anchorY:X,rawPixels:pe.length,largestBlobSize:te.largestBlobSize,minBlobSize:te.minBlobSize}):Me>Re&&Me>me&&(De="B",ne={color:"B",pixelCount:Me,minY:Q,maxY:re,anchorY:X,rawPixels:Se.length,largestBlobSize:q.largestBlobSize,minBlobSize:q.minBlobSize});let ue=null,ve=null;try{const U=document.createElement("canvas");U.width=u,U.height=d;const G=U.getContext("2d");G.drawImage(a,0,0,u,d),G.fillStyle="rgba(0,0,0,0.6)",G.fillRect(0,0,u,d),G.globalCompositeOperation="destination-out",G.fillStyle="rgba(0,0,0,1)",G.fillRect(0,Q,u,re-Q),G.globalCompositeOperation="destination-over",G.drawImage(a,0,0,u,d),G.globalCompositeOperation="source-over";const J=G.createImageData(u,d),ee=J.data;for(let D=Q;D<re;D+=1)for(let V=0;V<u;V+=1){const ie=(D*u+V)*4;B[ie]>=b&&(ee[ie]=0,ee[ie+1]=255,ee[ie+2]=255,ee[ie+3]=90)}G.putImageData(J,0,0);const L=G.createImageData(u,d),m=L.data;for(const D of Ue){const V=D.idx;V>=0&&V<m.length-3&&(m[V]=255,m[V+1]=0,m[V+2]=0,m[V+3]=180)}for(const D of He){const V=D.idx;V>=0&&V<m.length-3&&(m[V]=0,m[V+1]=100,m[V+2]=255,m[V+3]=180)}G.putImageData(L,0,0),G.globalCompositeOperation="source-over",G.strokeStyle="#00FF00",G.lineWidth=3,G.setLineDash([]),G.beginPath(),G.moveTo(0,Q),G.lineTo(u,Q),G.stroke(),G.strokeStyle="#FFFF00",G.lineWidth=3,G.setLineDash([5,5]),G.beginPath(),G.moveTo(0,re),G.lineTo(u,re),G.stroke(),X!==Q&&X!==re&&(G.strokeStyle="#FF00FF",G.lineWidth=2,G.setLineDash([2,2]),G.beginPath(),G.moveTo(0,X),G.lineTo(u,X),G.stroke()),ue=U.toDataURL("image/png");const T=document.createElement("canvas");T.width=u,T.height=d;const N=T.getContext("2d"),C=N.createImageData(u,d),F=C.data;for(let D=0;D<u*d;D+=1){const V=D*4,de=B[D*4]>=b?255:0;F[V]=de,F[V+1]=de,F[V+2]=de,F[V+3]=255}N.putImageData(C,0,0),ve=T.toDataURL("image/png")}catch(U){console.warn("[ColorDetector] Failed generating preview",U)}const ce={mode:"segmentation",width:u,height:d,pixelsA:me,pixelsB:Me,rawPixelsA:pe.length,rawPixelsB:Se.length,tipY:X,scanDepth:he,scanDepthRatio:z,anchor:I,bestArm:ne,blobInfoA:{largestBlobSize:te.largestBlobSize,minBlobSize:te.minBlobSize,totalBlobs:te.totalBlobs,filteredBlobs:te.filteredBlobs,droppedPixels:pe.length-me},blobInfoB:{largestBlobSize:q.largestBlobSize,minBlobSize:q.minBlobSize,totalBlobs:q.totalBlobs,filteredBlobs:q.filteredBlobs,droppedPixels:Se.length-Me},minBlobRatio:se};return{suggestion:De,stats:ce,preview:ue,maskPreview:ve}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},G5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},wu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),W5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,u=-1/0;for(const v of e){const w=wu(v,i);w>u&&(u=w,a=v)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,g=!0;for(;g&&h<n;){g=!1;for(let _=0;_<e.length;_++){let R=0,B=1/0;for(let K=0;K<s.length;K++){const E=wu(e[_],s[K]);E<B&&(B=E,R=K)}d[_]!==R&&(d[_]=R,g=!0)}const v=Array.from({length:s.length},()=>new Array(r).fill(0)),w=new Array(s.length).fill(0);e.forEach((_,R)=>{const B=d[R];w[B]+=1;for(let K=0;K<r;K++)v[B][K]+=_[K]});for(let _=0;_<s.length;_++)w[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=v[_].map(R=>R/w[_]);h+=1}return{assignments:d,centroids:s}},V5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await jp(),r=t.maxFrames||e.length,s=t.stride||2;t.minClothPixels;const i=t.manualBounds||null,a=e.slice(0,r),u=[];let d=0;for(const y of a)try{const k=await _p(y.frameDataUrl),M=k.naturalWidth||k.width,b=k.naturalHeight||k.height,H=n.segment(k),{maskData:I,maskWidth:O,maskHeight:z,isRGBA:W}=Vv(H.categoryMask,M,b);if(!I){d+=1;continue}const X=document.createElement("canvas");X.width=M,X.height=b;const Z=X.getContext("2d");Z.drawImage(k,0,0,M,b);const Q=Z.getImageData(0,0,M,b).data,re=M/O,he=b/z;let pe,Se=0,se=1,te=0,q=M/2,me=b/2;if(i){if(pe=i.bottomY-i.topY,Se=i.rotation||0,Se!==0){const L=-Se*Math.PI/180;se=Math.cos(L),te=Math.sin(L)}}else pe=b;const Me=Math.floor(pe/s),Ue=Math.floor(M/s),He=Me*Ue,De=Math.max(Math.floor(He*.005),20);let ne=0,ue=0,ve=0,ce=0,U=0,G=0;for(let L=0;L<b;L+=s){if(i&&Se===0&&(L<i.topY||L>i.bottomY))continue;const m=Math.min(z-1,Math.floor(L/he));for(let T=0;T<M;T+=s){if(i&&Se!==0){const D=T-q,V=L-me,ie=D*te+V*se+me;if(ie<i.topY||ie>i.bottomY)continue}const N=Math.min(O-1,Math.floor(T/re)),C=(m*O+N)*(W?4:1);if(I[C]===4){const D=(L*M+T)*4,V=Q[D],ie=Q[D+1],de=Q[D+2];ne+=V,ue+=ie,ve+=de,ce+=T,U+=L,G+=1}}}if(G<De){console.log(`[Cloth] Frame ${y.moveId} SKIPPED - cloth pixels: ${G}, threshold: ${De}, scan area: ${pe}px, manual bounds: ${i?"YES":"NO"}`),d+=1;continue}console.log(`[Cloth] Frame ${y.moveId} ACCEPTED - cloth pixels: ${G}, threshold: ${De}, scan area: ${pe}px, manual bounds: ${i?`Y:${i.topY}-${i.bottomY}`:"NO"}`);const J={r:ne/G,g:ue/G,b:ve/G};let ee=null;try{const L=document.createElement("canvas");L.width=M,L.height=b;const m=L.getContext("2d");m.drawImage(k,0,0,M,b);const T=m.getImageData(0,0,M,b),N=T.data;for(let C=0;C<b;C+=1){const F=Math.min(z-1,Math.floor(C/he));for(let D=0;D<M;D+=1){const V=Math.min(O-1,Math.floor(D/re)),ie=(F*O+V)*(W?4:1);if(I[ie]===4){const Ee=(C*M+D)*4;N[Ee]=Math.round(N[Ee]*.5+50),N[Ee+1]=Math.round(N[Ee+1]*.5+255*.5),N[Ee+2]=Math.round(N[Ee+2]*.5+50)}}}m.putImageData(T,0,0),i&&(m.save(),Se!==0&&(m.translate(q,me),m.rotate(Se*Math.PI/180),m.translate(-q,-me)),m.strokeStyle="#00FF00",m.lineWidth=3,m.setLineDash([]),m.beginPath(),m.moveTo(-M,i.topY),m.lineTo(M*2,i.topY),m.stroke(),m.strokeStyle="#FFFF00",m.lineWidth=3,m.setLineDash([5,5]),m.beginPath(),m.moveTo(-M,i.bottomY),m.lineTo(M*2,i.bottomY),m.stroke(),m.fillStyle="rgba(0, 255, 0, 0.2)",m.fillRect(-M,i.topY,M*3,i.bottomY-i.topY),m.fillStyle="#00FF00",m.font="bold 16px Arial",m.fillText(`Manual Scan Area (${pe}px)`,10,i.topY-10),m.restore()),m.fillStyle="rgba(0, 0, 0, 0.7)",m.fillRect(10,10,300,80),m.fillStyle="#FFFFFF",m.font="bold 14px Arial",m.fillText(`Cloth Pixels: ${G}`,20,30),m.fillText(`Threshold: ${De}`,20,50),m.fillText(`Mean Color: ${I0(J.r,J.g,J.b)}`,20,70),ee=L.toDataURL("image/png")}catch(L){console.warn("[ColorDetector] Failed to generate debug preview:",L)}u.push({moveId:y.moveId,meanColor:J,feature:[J.r/255,J.g/255,J.b/255],centroidX:ce/G/M,centroidY:U/G/b,pixelCount:G,existingPlayer:y.existingPlayer||null,debugPreview:ee})}catch(k){console.warn("[ColorDetector] Cloth analysis failed for frame",y.moveId,k),d+=1}if(u.length<2)throw new Error("Not enough frames with detectable clothing");const h=u.map(y=>y.feature),{assignments:g,centroids:v}=W5(h,Math.min(2,u.length)),w=v.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));g.forEach((y,k)=>{const M=u[k],b=w[y];b.samples.push({moveId:M.moveId,centroidX:M.centroidX,centroidY:M.centroidY,pixelCount:M.pixelCount}),b.sumR+=M.meanColor.r,b.sumG+=M.meanColor.g,b.sumB+=M.meanColor.b,b.sumPixels+=M.pixelCount,b.sumBrightness+=(M.meanColor.r+M.meanColor.g+M.meanColor.b)/3,(M.existingPlayer==="Player A"||M.existingPlayer==="Player B")&&(b.labelCounts[M.existingPlayer]+=1)});const _={};w.forEach((y,k)=>{const M=y.labelCounts["Player A"],b=y.labelCounts["Player B"];M>b?_[k]="Player A":b>M&&(_[k]="Player B")});const R=w.map((y,k)=>{const M=y.sumR/Math.max(1,y.samples.length),b=y.sumG/Math.max(1,y.samples.length),H=y.sumB/Math.max(1,y.samples.length);return{idx:k,hue:G5(M,b,H),brightness:y.sumBrightness/Math.max(1,y.samples.length)}}).sort((y,k)=>y.hue-k.hue||y.brightness-k.brightness),B=["Player A","Player B"];R.forEach(({idx:y})=>{if(!_[y]){const k=Object.values(_),M=B.find(b=>!k.includes(b))||"Player A";_[y]=M}});const K={};g.forEach((y,k)=>{const M=u[k],b=_[y]||(y===0?"Player A":"Player B"),H=v[y],I=v[y===0?1:0],O=wu(M.feature,H),z=I?wu(M.feature,I):O,W=I?Math.max(0,1-O/(O+z+1e-6)):1;K[M.moveId]={player:b,clusterId:y,styleLabel:`Style ${y+1}`,confidence:W,stats:{meanColor:M.meanColor,pixelCount:M.pixelCount,debugPreview:M.debugPreview}}});const E=w.map((y,k)=>{const M=y.sumR/Math.max(1,y.samples.length),b=y.sumG/Math.max(1,y.samples.length),H=y.sumB/Math.max(1,y.samples.length),I=I0(M,b,H);return{id:k,styleLabel:`Style ${k+1}`,assignedPlayer:_[k]||(k===0?"Player A":"Player B"),hexColor:I,meanColor:{r:M,g:b,b:H},sampleCount:y.samples.length,avgPixels:y.sumPixels/Math.max(1,y.samples.length),avgBrightness:y.sumBrightness/Math.max(1,y.samples.length),knownAssignments:y.labelCounts}});return{assignments:K,clusters:E,analytics:{totalFrames:a.length,usedFrames:u.length,skippedFrames:d,clusters:E}}};let ud=null;const jp=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!ud){const e=await ks.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");ud=await fn.createFromOptions(e,{baseOptions:{modelAssetPath:z5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return ud},Y5=async e=>{try{const t=await _p(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await jp()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let u;if(i.categoryMask.getAsUint8Array)u=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(u=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,u.length===n*r*4){const g=new Uint8Array(n*r);for(let v=0;v<n*r;v++)g[v]=u[v*4];u=g}}else if(i.categoryMask instanceof Uint8Array)u=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const g=new Uint8Array(n*r);for(let v=0;v<n*r;v++)g[v]=h[v*4];u=g}else u=h}return await Promise.all(a.map(async h=>{const g=document.createElement("canvas");g.width=n,g.height=r;const v=g.getContext("2d");v.drawImage(t,0,0,n,r);const w=v.getImageData(0,0,n,r),_=w.data;let R=0;for(let B=0;B<u.length;B++)if(u[B]===h.id){R++;const K=B*4;h.id===0?(_[K]=_[K]*.25,_[K+1]=_[K+1]*.25,_[K+2]=_[K+2]*.25):(_[K]=(_[K]+h.color[0])/2,_[K+1]=(_[K+1]+h.color[1])/2,_[K+2]=(_[K+2]+h.color[2])/2)}return v.putImageData(w,0,0),{...h,pixelCount:R,preview:g.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},X5=Wv,K5=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),Gi=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),Q5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,u=-1/0;for(const v of e){const w=Gi(v,i);w>u&&(u=w,a=v)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,g=!0;for(;g&&h<n;){g=!1;for(let _=0;_<e.length;_++){let R=0,B=1/0;for(let K=0;K<s.length;K++){const E=Gi(e[_],s[K]);E<B&&(B=E,R=K)}d[_]!==R&&(d[_]=R,g=!0)}const v=Array.from({length:s.length},()=>new Array(r).fill(0)),w=new Array(s.length).fill(0);e.forEach((_,R)=>{const B=d[R];w[B]+=1;for(let K=0;K<r;K++)v[B][K]+=_[K]});for(let _=0;_<s.length;_++)w[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=v[_].map(R=>R/w[_]);h+=1}return{assignments:d,centroids:s}},J5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},B0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},L0=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null};let cd=null;const Z5=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!cd){const e=await ks.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");cd=await fn.createFromOptions(e,{baseOptions:{modelAssetPath:X5,delegate:"GPU"},outputCategoryMask:!1,outputConfidenceMasks:!0,runningMode:"IMAGE"})}return cd},q5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for analysis");const n=await Z5(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minPixels||5,a=t.manualBounds||null,u=t.playerColors||null,d=t.sensitivity||.8,h=e.slice(0,r),g=[];let v=0;for(const b of h)try{const H=await K5(b.frameDataUrl),I=H.naturalWidth||H.width,O=H.naturalHeight||H.height,z=n.segment(H),W=z.confidenceMasks[0].getAsFloat32Array(),X=z.confidenceMasks[0].width,Z=z.confidenceMasks[0].height,Q=document.createElement("canvas");Q.width=I,Q.height=O;const re=Q.getContext("2d");re.drawImage(H,0,0,I,O);const he=re.getImageData(0,0,I,O).data,pe=I/X,Se=O/Z;let se=0,te=O,q=0,me=1,Me=0,Ue=I/2,He=O/2;if(a)if(q=a.rotation||0,q!==0){const J=-q*Math.PI/180;me=Math.cos(J),Me=Math.sin(J),se=0,te=O}else se=Math.max(0,a.topY),te=Math.min(O,a.bottomY);let Re=0,De=0,ne=0,ue=0,ve=0,ce=0;for(let J=se;J<te;J+=s){const ee=Math.min(Z-1,Math.floor(J/Se));for(let L=0;L<I;L+=s){if(a&&q!==0){const C=L-Ue,F=J-He,D=C*Me+F*me+He;if(D<a.topY||D>a.bottomY)continue}const m=Math.min(X-1,Math.floor(L/pe)),T=ee*X+m;if(W[T]<d){const C=(J*I+L)*4,F=he[C],D=he[C+1],V=he[C+2];Re+=F,De+=D,ne+=V,ue+=L,ve+=J,ce+=1}}}if(ce<i){v+=1;continue}const U={r:Re/ce,g:De/ce,b:ne/ce};let G=null;try{const J=document.createElement("canvas");J.width=I,J.height=O;const ee=J.getContext("2d");ee.drawImage(H,0,0,I,O);const L=ee.getImageData(0,0,I,O),m=L.data;for(let T=0;T<O;T+=1){const N=Math.min(Z-1,Math.floor(T/Se));for(let C=0;C<I;C+=1){const F=Math.min(X-1,Math.floor(C/pe)),D=N*X+F;if(W[D]<d){const ie=(T*I+C)*4;m[ie]=Math.min(255,m[ie]+50),m[ie+1]=Math.max(0,m[ie+1]-20),m[ie+2]=Math.max(0,m[ie+2]-20)}}}if(ee.putImageData(L,0,0),a){ee.save(),q!==0&&(ee.translate(Ue,He),ee.rotate(q*Math.PI/180),ee.translate(-Ue,-He)),ee.strokeStyle="#00FF00",ee.lineWidth=3,ee.setLineDash([]),ee.beginPath(),ee.moveTo(-I,a.topY),ee.lineTo(I*2,a.topY),ee.stroke(),ee.strokeStyle="#FFFF00",ee.lineWidth=3,ee.setLineDash([5,5]),ee.beginPath(),ee.moveTo(-I,a.bottomY),ee.lineTo(I*2,a.bottomY),ee.stroke(),ee.fillStyle="rgba(0, 255, 0, 0.2)",ee.fillRect(-I,a.topY,I*3,a.bottomY-a.topY);const T=a.bottomY-a.topY;ee.fillStyle="#00FF00",ee.font="bold 16px Arial",ee.fillText(`Manual Scan Area (${T}px)`,10,a.topY-10),ee.restore()}ee.fillStyle="rgba(0, 0, 0, 0.7)",ee.fillRect(10,10,300,80),ee.fillStyle="#FFFFFF",ee.font="bold 14px Arial",ee.fillText(`Non-BG Pixels: ${ce}`,20,30),ee.fillText(`Threshold: ${i}`,20,50),ee.fillText(`Mean Color: ${B0(U.r,U.g,U.b)}`,20,70),G=J.toDataURL("image/png")}catch(J){console.warn("[ColorDetectorGeneral] Failed to generate debug preview:",J)}g.push({moveId:b.moveId,meanColor:U,feature:[U.r/255,U.g/255,U.b/255],centroidX:ue/ce/I,centroidY:ve/ce/O,pixelCount:ce,existingPlayer:b.existingPlayer||null,debugPreview:G})}catch(H){console.warn("[ColorDetectorGeneral] Analysis failed for frame",b.moveId,H),v+=1}if(g.length<2)throw new Error("Not enough frames with detectable pixels (need at least 2)");const w=g.map(b=>b.feature),{assignments:_,centroids:R}=Q5(w,Math.min(2,g.length)),B=R.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));_.forEach((b,H)=>{const I=g[H],O=B[b];O.samples.push({moveId:I.moveId,centroidX:I.centroidX,centroidY:I.centroidY,pixelCount:I.pixelCount}),O.sumR+=I.meanColor.r,O.sumG+=I.meanColor.g,O.sumB+=I.meanColor.b,O.sumPixels+=I.pixelCount,O.sumBrightness+=(I.meanColor.r+I.meanColor.g+I.meanColor.b)/3,(I.existingPlayer==="Player A"||I.existingPlayer==="Player B")&&(O.labelCounts[I.existingPlayer]+=1)});const K={};if(u&&u["Player A"]&&u["Player B"]){const b=L0(u["Player A"]),H=L0(u["Player B"]);if(b&&H){const I=B.map((O,z)=>{const W=O.sumR/Math.max(1,O.samples.length),X=O.sumG/Math.max(1,O.samples.length),Z=O.sumB/Math.max(1,O.samples.length),Q=[W,X,Z];return{idx:z,distA:Gi(Q,[b.r,b.g,b.b]),distB:Gi(Q,[H.r,H.g,H.b])}});if(I.length===2){const O=I[0],z=I[1],W=O.distA+z.distB,X=O.distB+z.distA;W<X?(K[O.idx]="Player A",K[z.idx]="Player B"):(K[O.idx]="Player B",K[z.idx]="Player A")}else I.forEach(O=>{O.distA<O.distB?K[O.idx]="Player A":K[O.idx]="Player B"})}}B.forEach((b,H)=>{if(K[H])return;const I=b.labelCounts["Player A"],O=b.labelCounts["Player B"];I>O?K[H]="Player A":O>I&&(K[H]="Player B")});const E=B.map((b,H)=>{const I=b.sumR/Math.max(1,b.samples.length),O=b.sumG/Math.max(1,b.samples.length),z=b.sumB/Math.max(1,b.samples.length);return{idx:H,hue:J5(I,O,z),brightness:b.sumBrightness/Math.max(1,b.samples.length)}}).sort((b,H)=>b.hue-H.hue||b.brightness-H.brightness),y=["Player A","Player B"];E.forEach(({idx:b})=>{if(!K[b]){const H=Object.values(K),I=y.find(O=>!H.includes(O))||"Player A";K[b]=I}});const k={};_.forEach((b,H)=>{const I=g[H],O=K[b]||(b===0?"Player A":"Player B"),z=R[b],W=R[b===0?1:0],X=Gi(I.feature,z),Z=W?Gi(I.feature,W):X,Q=W?Math.max(0,1-X/(X+Z+1e-6)):1,re=B[b],he=re.sumR/Math.max(1,re.samples.length),pe=re.sumG/Math.max(1,re.samples.length),Se=re.sumB/Math.max(1,re.samples.length);k[I.moveId]={player:O,clusterId:b,styleLabel:`Style ${b+1}`,confidence:Q,stats:{meanColor:{r:he,g:pe,b:Se},pixelCount:I.pixelCount,debugPreview:I.debugPreview}}});const M=B.map((b,H)=>{const I=b.sumR/Math.max(1,b.samples.length),O=b.sumG/Math.max(1,b.samples.length),z=b.sumB/Math.max(1,b.samples.length),W=B0(I,O,z);return{id:H,styleLabel:`Style ${H+1}`,assignedPlayer:K[H]||(H===0?"Player A":"Player B"),hexColor:W,meanColor:{r:I,g:O,b:z},sampleCount:b.samples.length,avgPixels:b.sumPixels/Math.max(1,b.samples.length),avgBrightness:b.sumBrightness/Math.max(1,b.samples.length),knownAssignments:b.labelCounts}});return{assignments:k,clusters:M,analytics:{totalFrames:h.length,usedFrames:g.length,skippedFrames:v,clusters:M}}},dd=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,e6=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function t6({colorPreview:e,onClose:t}){var _,R,B,K,E,y,k,M,b,H,I,O,z,W;const[n,r]=j.useState("overview"),[s,i]=j.useState(null),[a,u]=j.useState(!1),d=async()=>{if(e!=null&&e.original){u(!0);try{const X=await Y5(e.original);i(X)}catch(X){console.error("Failed to run multiclass segmentation:",X)}finally{u(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,g=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,v=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",w=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return l.jsx("div",{className:"image-modal",onClick:t,children:l.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:X=>X.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:t,children:""}),l.jsxs("div",{className:"color-preview-tabs",children:[l.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),l.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"color-preview-grid",children:[l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Original Frame"}),l.jsx("img",{src:e.original,alt:"Original frame"})]}),l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Mask View"}),e.preview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((_=e.stats)==null?void 0:_.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((R=e.stats)==null?void 0:R.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),l.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((B=e.stats)==null?void 0:B.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),l.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):l.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&l.jsxs("div",{className:"color-preview-stats",children:[l.jsxs("div",{className:"color-preview-meta",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${g.toLocaleString()} px)`:""]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Method:"})," ",w]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Anchor:"})," ",v]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&l.jsxs("div",{children:[l.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&l.jsxs("div",{children:[l.jsx("strong",{children:"Person coverage:"})," ",e6(e.stats.personPixels)]}),e.stats.reason&&l.jsxs("div",{children:[l.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),l.jsxs("div",{className:"color-preview-calibration",children:[l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player A color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),l.jsx("code",{children:e.colorA||""}),e.calibrationA&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player B color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),l.jsx("code",{children:e.colorB||""}),e.calibrationB&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Scan Zone"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Depth:"})," ",((K=e.stats.scanDepth)==null?void 0:K.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color A Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((E=e.stats.pixelsA)==null?void 0:E.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((y=e.stats.rawPixelsA)==null?void 0:y.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((k=e.stats.blobInfoA.largestBlobSize)==null?void 0:k.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((M=e.stats.blobInfoA.minBlobSize)==null?void 0:M.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color B Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((b=e.stats.pixelsB)==null?void 0:b.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((H=e.stats.rawPixelsB)==null?void 0:H.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((I=e.stats.blobInfoB.largestBlobSize)==null?void 0:I.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((O=e.stats.blobInfoB.minBlobSize)==null?void 0:O.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&l.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[l.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixel Count:"})," ",((z=e.stats.bestArm.pixelCount)==null?void 0:z.toLocaleString())||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((W=e.stats.armRegions)==null?void 0:W.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((X,Z)=>{const Q=e.stats.bestArm&&X.category===e.stats.bestArm.category&&X.dominantColor===e.stats.bestArm.dominantColor;return l.jsxs("div",{className:"segmentation-card",style:{border:Q?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:Q?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[l.jsxs("h4",{children:["Arm ",Z+1,": ",X.categoryName,Q&&l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Dominant Color:"})," ",l.jsxs("span",{style:{color:X.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",X.dominantColor]})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels A:"})," ",X.pixelsA||0," | ",l.jsx("strong",{children:"Pixels B:"})," ",X.pixelsB||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Total arm pixels:"})," ",X.pixelCount||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," Y=",X.minY,"  ",X.maxY," (Anchor Y: ",X.anchorY,")"]})]},Z)}):l.jsx("p",{children:"No arms detected with matching colors"})]}):l.jsxs("div",{className:"color-preview-breakdown",children:[l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player A band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",dd(e.stats.pixelsA,g),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player B band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",dd(e.stats.pixelsB,g),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):l.jsxs("div",{className:"multiclass-view",children:[l.jsxs("div",{className:"multiclass-header",children:[l.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),l.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&l.jsxs("div",{className:"loading-indicator",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&l.jsx("div",{className:"multiclass-grid",children:s.map(X=>l.jsxs("div",{className:"multiclass-card",children:[l.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${X.color.join(",")})`},children:[l.jsxs("h4",{children:[X.id,". ",X.name]}),l.jsx("span",{className:"multiclass-badge",children:dd(X.pixelCount,g)})]}),l.jsx("p",{className:"multiclass-desc",children:X.desc}),l.jsx("div",{className:"multiclass-preview-container",children:l.jsx("img",{src:X.preview,alt:X.name})}),l.jsxs("div",{className:"multiclass-footer",children:[X.pixelCount.toLocaleString()," pixels"]})]},X.id))}),!a&&!s&&l.jsxs("div",{className:"error-message",children:[l.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),l.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function n6({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=j.useState(0),[i,a]=j.useState(0),[u,d]=j.useState(0),[h,g]=j.useState(!1),[v,w]=j.useState(!1),_=j.useRef(null),[R,B]=j.useState(0),[K,E]=j.useState(0),y=j.useRef(null),k=Y0.useCallback((z,W,X,Z,Q,re,he)=>{z.clearRect(0,0,Q,re),he&&z.drawImage(he,0,0),z.save();const pe=Q/2,Se=re/2;z.translate(pe,Se),z.rotate(Z*Math.PI/180),z.translate(-pe,-Se),z.fillStyle="rgba(0, 255, 0, 0.2)",z.fillRect(-Q,W,Q*3,X-W),z.strokeStyle="#00FF00",z.lineWidth=3,z.setLineDash([]),z.beginPath(),z.moveTo(-Q,W),z.lineTo(Q*2,W),z.stroke(),z.strokeStyle="#FFFF00",z.setLineDash([]),z.beginPath(),z.moveTo(-Q,X),z.lineTo(Q*2,X),z.stroke(),z.fillStyle="#00FF00",z.font="16px Arial",z.fillText("Top",10,W-5),z.fillStyle="#FFFF00",z.fillText("Bottom",10,X+20),z.restore()},[]);j.useEffect(()=>{if(!e||!_.current)return;const z=new Image;z.crossOrigin="anonymous",z.onload=()=>{const W=_.current,X=W.getContext("2d");W.width=z.width,W.height=z.height,E(z.width),B(z.height),y.current=z;const Z=Math.floor(z.height*.2),Q=Math.floor(z.height*.8);s(Z),a(Q),k(X,Z,Q,0,z.width,z.height,z)},e.startsWith("data:image")?z.src=e:z.src=`data:image/jpeg;base64,${e}`},[e,k]),j.useEffect(()=>{if(!_.current||R===0||!y.current)return;const z=_.current.getContext("2d");k(z,r,i,u,K,R,y.current)},[r,i,u,K,R,k]);const M=(z,W)=>{const X=_.current,Z=X.getBoundingClientRect(),Q=X.width/Z.width,re=X.height/Z.height,he=(z-Z.left)*Q,pe=(W-Z.top)*re,Se=X.width/2,se=X.height/2,te=he-Se,q=pe-se,me=-u*Math.PI/180;return te*Math.sin(me)+q*Math.cos(me)+se},b=z=>{const W=M(z.clientX,z.clientY);Math.abs(W-r)<10?g(!0):Math.abs(W-i)<10&&w(!0)},H=z=>{if(!h&&!v)return;const W=M(z.clientX,z.clientY),X=Math.max(-R,Math.min(R*2,W));if(h){const Z=Math.min(X,i-10);s(Z)}else if(v){const Z=Math.max(X,r+10);a(Z)}},I=()=>{g(!1),w(!1)},O=()=>{t({topY:r,bottomY:i,rotation:u})};return l.jsx("div",{className:"image-modal",onClick:n,children:l.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:z=>z.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:n,children:""}),l.jsx("h2",{children:"Set Manual Scan Area"}),l.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines. Use slider to rotate."}),l.jsxs("div",{className:"scan-controls",style:{marginBottom:"10px",display:"flex",alignItems:"center",gap:"10px"},children:[l.jsxs("label",{children:["Rotation: ",u,""]}),l.jsx("input",{type:"range",min:"-45",max:"45",value:u,onChange:z=>d(Number(z.target.value)),style:{flex:1}})]}),l.jsx("canvas",{ref:_,onMouseDown:b,onMouseMove:H,onMouseUp:I,onMouseLeave:I,style:{cursor:h||v?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),l.jsx("div",{className:"manual-scan-info",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Top Y:"})," ",Math.round(r)," | ",l.jsx("strong",{children:"Bottom Y:"})," ",Math.round(i)," | ",l.jsx("strong",{children:"Height:"})," ",Math.round(i-r),"px"]})}),l.jsxs("div",{className:"manual-scan-actions",children:[l.jsx("button",{onClick:O,className:"save-btn",children:"Save Bounds"}),l.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const xl=Fu(),r6="adminPassword",Mi=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),s6=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function i6({sessionGameId:e}){var gt,Dn,wi,Wa,Qs,Si,Js,gs,Po,ki;const[t,n]=j.useState(null),[r,s]=j.useState(!0),[i,a]=j.useState(null),[u,d]=j.useState(null),[h,g]=j.useState(null),[v,w]=j.useState("all"),[_,R]=j.useState("all"),[B,K]=j.useState(""),[E,y]=j.useState(!1),[k,M]=j.useState({}),[b,H]=j.useState({current:0,total:0}),[I,O]=j.useState("#FF0000"),[z,W]=j.useState("#0000FF"),[X,Z]=j.useState(!1),[Q,re]=j.useState(!1),[he,pe]=j.useState({}),[Se,se]=j.useState({current:0,total:0}),[te,q]=j.useState("bottom"),[me,Me]=j.useState(100),[Ue,He]=j.useState(null),[Re,De]=j.useState(null),[ne,ue]=j.useState(!1),[ve,ce]=j.useState(null),[U,G]=j.useState(!1),[J,ee]=j.useState(null),[L,m]=j.useState({}),[T,N]=j.useState(!1),[C,F]=j.useState(""),[D,V]=j.useState(!1),[ie,de]=j.useState(null),[Ee,Pe]=j.useState("chronological"),[Fe,et]=j.useState(55),[Qe,lt]=j.useState(!1),[ut,Ge]=j.useState({current:0,total:0}),[ze,We]=j.useState(null),Je=j.useCallback(async $=>{if(!$)return{suggestion:"None",stats:null};try{const ge=await H5($,I,z,{anchor:te,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:te==="manually"&&Re?null:me/100,manualBounds:te==="manually"?Re:null});if(ge)return ge}catch(ge){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",ge)}return U5($,I,z,{anchor:te})},[I,z,te,me,Re]);j.useEffect(()=>{const $=localStorage.getItem(r6);$&&K($)},[]),j.useEffect(()=>{e&&B&&Fn()},[e,B]);const Ct=$=>{if(!$||typeof $.h>"u")return null;const ge=($.h||0)*2,xe=($.s||0)/255,ae=($.v||0)/255,we=ae*xe,Oe=we*(1-Math.abs(ge/60%2-1)),it=ae-we;let tt=0,Ie=0,$e=0;ge>=0&&ge<60?(tt=we,Ie=Oe,$e=0):ge<120?(tt=Oe,Ie=we,$e=0):ge<180?(tt=0,Ie=we,$e=Oe):ge<240?(tt=0,Ie=Oe,$e=we):ge<300?(tt=Oe,Ie=0,$e=we):(tt=we,Ie=0,$e=Oe);const Vt=_n=>{const Pt=Math.round((_n+it)*255).toString(16);return Pt.length===1?"0"+Pt:Pt};return`#${Vt(tt)}${Vt(Ie)}${Vt($e)}`.toUpperCase()},Fn=async()=>{var $,ge,xe,ae;if(B){s(!0),a(null);try{const we=await fetch(`${xl}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":B}});if(!we.ok)throw new Error(`Failed to load session (${we.status})`);const Oe=await we.json();n(Oe);let it=null,tt=null,Ie="";if(Oe.colorA&&Oe.colorB?(it=Oe.colorA,tt=Oe.colorB,Ie="session root"):(ge=($=Oe.metadata)==null?void 0:$.config)!=null&&ge.colorA&&((ae=(xe=Oe.metadata)==null?void 0:xe.config)!=null&&ae.colorB)&&(it=Oe.metadata.config.colorA,tt=Oe.metadata.config.colorB,Ie="session metadata"),it&&tt)O(it),W(tt),console.log(`[MoveHistoryEditor]  Loaded colors from ${Ie}:`,it,tt);else try{const $e=JSON.parse(localStorage.getItem("calibrationA")||"null"),Vt=JSON.parse(localStorage.getItem("calibrationB")||"null");if($e&&Vt){const _n=Ct($e),Pt=Ct(Vt);_n&&Pt?(O(_n),W(Pt),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",_n,Pt)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch($e){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",$e),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(we){console.error("[MoveHistoryEditor] Error loading session:",we),a(we.message)}finally{s(!1)}}},ct=async($,ge)=>{if(!(!e||!$||!B))try{const xe=await fetch(`${xl}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent($)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":B},body:JSON.stringify({player:ge})});if(!xe.ok)throw new Error(`Failed to update player (${xe.status})`);n(ae=>ae&&{...ae,moves:ae.moves.map(we=>we._id===$?{...we,player:ge}:we)}),M(ae=>{const we={...ae};return delete we[$],we}),console.log("[MoveHistoryEditor] Player updated:",$,ge)}catch(xe){console.error("[MoveHistoryEditor] Error updating player:",xe),alert("Failed to update player: "+xe.message)}},zt=async $=>{const ge=k[$];ge&&await ct($,ge.player)},Tt=async $=>{const ge=he[$];ge&&(await ct($,ge.player),pe(xe=>{const ae={...xe};return delete ae[$],ae}))},rn=async $=>{if(!t||!Array.isArray(t.moves))return;const ge=t.moves.find(xe=>xe._id===$);if(!ge||!ge.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${$}`);const xe=await Je(ge.camera_frame);if(!xe){alert("Color-based identification failed for this move.");return}pe(Oe=>({...Oe,[$]:{method:"color",player:xe.suggestion==="A"?"Player A":xe.suggestion==="B"?"Player B":"None",stats:xe.stats,preview:xe.preview}}));let ae=null,we=null;try{ae=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{ae=null}try{we=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{we=null}He({moveId:$,original:ge.camera_frame,preview:xe.preview,maskPreview:xe.maskPreview,stats:xe.stats,suggestion:xe.suggestion,colorA:I,colorB:z,calibrationA:ae,calibrationB:we,anchor:te})}catch(xe){console.error("[MoveHistoryEditor] Error color-identifying move:",xe),alert("Color-based identification failed: "+xe.message)}},Qt=j.useCallback(async({mode:$})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ge=t.moves.filter(ae=>ae.camera_frame);if(ge.length===0){alert("No camera frames available for cloth-based identification.");return}const xe=new Set(t.moves.filter(ae=>!ae.player||ae.player==="Unknown"||ae.player==="None").map(ae=>ae._id));if($==="unknown"&&xe.size===0){alert("All moves already have players assigned.");return}G(!0),ee(null);try{const ae=ge.map(Ie=>({moveId:Ie._id,frameDataUrl:Ie.camera_frame,existingPlayer:Ie.player&&Ie.player!=="Unknown"?Ie.player:null})),we=await V5(ae,{maxFrames:ge.length,stride:2,minClothPixels:80,manualBounds:te==="manually"?Re:null});we!=null&&we.analytics&&ee(we.analytics);const Oe={};we!=null&&we.assignments&&Object.entries(we.assignments).forEach(([Ie,$e])=>{var Vt;(Vt=$e.stats)!=null&&Vt.debugPreview&&(Oe[Ie]=$e.stats.debugPreview)}),Object.keys(Oe).length>0&&m(Oe);const it={};we!=null&&we.assignments&&Object.entries(we.assignments).forEach(([Ie,$e])=>{($==="all"||xe.has(Ie))&&(it[Ie]={method:"cloth",player:$e.player,styleLabel:$e.styleLabel,confidence:$e.confidence,stats:$e.stats})});const tt=Object.keys(it).length;tt===0?alert(`Cloth-based method did not find suggestions for any ${$==="all"?"moves":"unknown moves"}.`):(pe($e=>({...$e,...it})),alert(`Cloth-based method suggested players for ${tt} ${$==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(ae){console.error("[MoveHistoryEditor] Cloth identification failed:",ae),alert("Cloth-based identification failed: "+ae.message)}finally{G(!1)}},[t,te,Re]);j.useCallback(()=>{Qt({mode:"all"})},[Qt]),j.useCallback(()=>{Qt({mode:"unknown"})},[Qt]);const Jt=j.useCallback(async({mode:$})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ge=t.moves.filter(ae=>ae.camera_frame);if(ge.length===0){alert("No camera frames available for All-All identification.");return}const xe=new Set(t.moves.filter(ae=>!ae.player||ae.player==="Unknown"||ae.player==="None").map(ae=>ae._id));if($==="unknown"&&xe.size===0){alert("All moves already have players assigned.");return}V(!0),de(null);try{const ae=ge.map(Ie=>({moveId:Ie._id,frameDataUrl:Ie.camera_frame,existingPlayer:Ie.player&&Ie.player!=="Unknown"&&Ie.player!=="None"?Ie.player:null})),we=await q5(ae,{maxFrames:ge.length,stride:2,minPixels:80,manualBounds:te==="manually"?Re:null,playerColors:{"Player A":I,"Player B":z}});we!=null&&we.analytics&&de(we.analytics);const Oe={};we!=null&&we.assignments&&Object.entries(we.assignments).forEach(([Ie,$e])=>{var Vt;(Vt=$e.stats)!=null&&Vt.debugPreview&&(Oe[Ie]=$e.stats.debugPreview)}),Object.keys(Oe).length>0&&m(Ie=>({...Ie,...Oe}));const it={};we!=null&&we.assignments&&Object.entries(we.assignments).forEach(([Ie,$e])=>{($==="all"||xe.has(Ie))&&(it[Ie]={method:"allall",player:$e.player,styleLabel:$e.styleLabel,confidence:$e.confidence,stats:$e.stats})});const tt=Object.keys(it).length;tt===0?alert(`All-All method did not find suggestions for any ${$==="all"?"moves":"unknown moves"}.`):(pe($e=>({...$e,...it})),alert(`All-All method suggested players for ${tt} ${$==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(ae){console.error("[MoveHistoryEditor] All-All identification failed:",ae),alert("All-All identification failed: "+ae.message)}finally{V(!1)}},[t,te,Re]),nr=j.useCallback(()=>{Jt({mode:"all"})},[Jt]),En=j.useCallback(()=>{Jt({mode:"unknown"})},[Jt]),Xr=async $=>{if(!(!e||!B))try{console.log(`[MoveHistoryEditor] Identifying single move: ${$}`);const ge=await fetch(`${xl}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":B},body:JSON.stringify({sessionGameId:e,moveId:$,colorA:I,colorB:z,cameraPosition:te==="top"||te==="bottom"?te:void 0})});if(ge.ok){const xe=await ge.json();M(ae=>({...ae,[$]:{player:xe.suggestion==="A"?"Player A":xe.suggestion==="B"?"Player B":"None",confidence:xe.confidence,rawResponse:xe.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${xe.suggestion}`)}else{const xe=await ge.json();alert(`Failed to identify move: ${xe.message}`)}}catch(ge){console.error("[MoveHistoryEditor] Error identifying move:",ge),alert("AI identification failed: "+ge.message)}},wr=((gt=t==null?void 0:t.moves)==null?void 0:gt.filter($=>{let ge=!0;v!=="all"&&(ge=$.phase===v);let xe=!0;return _!=="all"&&(_==="None"?xe=!$.player||$.player==="None"||$.player==="Unknown":xe=$.player===_),ge&&xe}))||[],Rr=(()=>{const $=[...wr];return Ee==="chronological"?$:$.sort((ge,xe)=>{var tt,Ie;const ae=!!he[ge._id],we=!!he[xe._id];if(ae&&!we)return-1;if(!ae&&we)return 1;if(!ae&&!we)return 0;const Oe=((tt=he[ge._id])==null?void 0:tt.confidence)||0,it=((Ie=he[xe._id])==null?void 0:Ie.confidence)||0;return Ee==="confidenceDesc"?it-Oe:Ee==="confidenceAsc"?Oe-it:0})})(),ms=async()=>{if(!e||!B)return;const $=Object.entries(he).filter(([ge,xe])=>(xe.confidence||0)*100>=Fe).map(([ge,xe])=>({moveId:ge,player:xe.player}));if($.length===0){alert(`No moves found with confidence above ${Fe}%`);return}if(window.confirm(`Are you sure you want to confirm ${$.length} moves with confidence >= ${Fe}%?`)){lt(!0),Ge({current:0,total:$.length});try{const ge=await fetch(`${xl}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":B},body:JSON.stringify({updates:$})});if(!ge.ok)throw new Error(`Failed to update players (${ge.status})`);const xe=await ge.json();console.log("[MoveHistoryEditor] Bulk update success:",xe),n(ae=>{if(!ae)return ae;const we=ae.moves.map(Oe=>{const it=$.find(tt=>tt.moveId===Oe._id);return it?{...Oe,player:it.player}:Oe});return{...ae,moves:we}}),pe(ae=>{const we={...ae};return $.forEach(({moveId:Oe})=>{delete we[Oe]}),we}),alert(`Successfully confirmed ${$.length} moves.`)}catch(ge){console.error("Failed to confirm moves:",ge),alert("Failed to confirm moves: "+ge.message)}finally{lt(!1),Ge({current:0,total:0})}}};if(r)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return l.jsx("div",{className:"move-editor-container",children:l.jsxs("div",{className:"move-editor-error",children:[l.jsx("h2",{children:"Error Loading Session"}),l.jsx("p",{children:i}),l.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-error",children:"Session not found"})});const On=((Dn=t.moves)==null?void 0:Dn.filter($=>$.phase==="practice").length)||0,xi=((wi=t.moves)==null?void 0:wi.filter($=>$.phase==="experiment").length)||0,Cn=((Wa=t.moves)==null?void 0:Wa.filter($=>$.player==="Player A").length)||0,$n=((Qs=t.moves)==null?void 0:Qs.filter($=>$.player==="Player B").length)||0,Ks=((Si=t.moves)==null?void 0:Si.filter($=>!$.player||$.player==="None"||$.player==="Unknown").length)||0;return l.jsxs("div",{className:"move-editor-container",children:[l.jsxs("header",{className:"move-editor-header",children:[l.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),l.jsxs("div",{className:"move-editor-title",children:[l.jsx("h1",{children:"Move History Editor"}),l.jsxs("div",{className:"session-info",children:[l.jsxs("span",{className:"session-id",children:["Session: ",e]}),l.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),l.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]}),l.jsxs("div",{className:"player-stats",style:{marginTop:"5px",fontSize:"0.9em"},children:[l.jsxs("span",{style:{marginRight:"15px",color:I,fontWeight:"bold"},children:["Player A: ",Cn]}),l.jsxs("span",{style:{color:z,fontWeight:"bold"},children:["Player B: ",$n]})]})]}),l.jsxs("div",{className:"header-center-group",children:[l.jsxs("div",{className:"phase-filter",children:[l.jsxs("button",{className:`filter-btn ${v==="all"?"active":""}`,onClick:()=>w("all"),children:["All (",((Js=t.moves)==null?void 0:Js.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${v==="practice"?"active":""}`,onClick:()=>w("practice"),children:["Practice (",On,")"]}),l.jsxs("button",{className:`filter-btn ${v==="experiment"?"active":""}`,onClick:()=>w("experiment"),children:["Experiment (",xi,")"]})]}),l.jsxs("div",{className:"player-filter",style:{marginTop:"4px"},children:[l.jsxs("button",{className:`filter-btn ${_==="all"?"active":""}`,onClick:()=>R("all"),children:["All Players (",((gs=t.moves)==null?void 0:gs.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${_==="Player A"?"active":""}`,onClick:()=>R("Player A"),style:{borderColor:I,color:_==="Player A"?"white":I,backgroundColor:_==="Player A"?I:"transparent"},children:["Player A (",Cn,")"]}),l.jsxs("button",{className:`filter-btn ${_==="Player B"?"active":""}`,onClick:()=>R("Player B"),style:{borderColor:z,color:_==="Player B"?"white":z,backgroundColor:_==="Player B"?z:"transparent"},children:["Player B (",$n,")"]}),l.jsxs("button",{className:`filter-btn ${_==="None"?"active":""}`,onClick:()=>R("None"),children:["None/Unknown (",Ks,")"]})]})]}),l.jsxs("div",{className:"header-controls-group",children:[l.jsxs("div",{className:"bracelet-colors-controls",children:[l.jsx("button",{className:"color-picker-toggle",onClick:()=>Z(!X),children:"Bracelet Colors"}),X&&l.jsxs("div",{className:"color-picker-panel",children:[l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player A:"}),l.jsx("input",{type:"color",value:I,onChange:$=>O($.target.value)}),l.jsx("span",{children:I})]}),l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player B:"}),l.jsx("input",{type:"color",value:z,onChange:$=>W($.target.value)}),l.jsx("span",{children:z})]})]})]}),l.jsxs("div",{className:"color-controls",children:[Object.keys(L).length>0&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:`ai-btn debug-btn ${T?"active":""}`,onClick:()=>N(!T),style:{backgroundColor:T?"#4CAF50":"#666",marginLeft:"20px"},children:T?" Debug View ON":" Show Debug View"}),l.jsx("button",{className:"ai-btn debug-btn",onClick:()=>{N(!1),m({})},style:{backgroundColor:"#ff5722"},children:" Clear Debug"})]}),l.jsx("button",{className:"ai-btn allall-btn",onClick:nr,disabled:D,children:D?" Identifying by All All...":" Identify by All All"}),l.jsx("button",{className:"ai-btn allall-btn",onClick:En,disabled:D,children:D?" Identifying by All All...":" Identify by All Unknown"}),l.jsxs("div",{className:"color-anchor-toggle",style:{display:"flex",alignItems:"center",gap:"10px"},children:[l.jsxs("div",{className:"scan-mode-radios",style:{display:"flex",gap:"10px",alignItems:"center"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("input",{type:"radio",name:"scanMode",checked:te!=="manually",onChange:()=>{q("bottom"),ue(!1),De(null),ce(null)}}),"General"]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("input",{type:"radio",name:"scanMode",checked:te==="manually",onChange:()=>{q("manually");const $=(t==null?void 0:t.moves)||[];if($.length>0){const ge=$[Math.floor(Math.random()*$.length)];ge!=null&&ge.camera_frame?(ce(ge.camera_frame),ue(!0)):(alert("No frames available. Please ensure moves have camera frames."),q("bottom"))}else alert("No moves available."),q("bottom")}}),"Manual"]})]}),te!=="manually"&&l.jsxs(l.Fragment,{children:[l.jsx("label",{children:"Scan area:"}),l.jsxs("select",{value:te,onChange:$=>q($.target.value),style:{padding:"6px",borderRadius:"4px",background:"#222",color:"#fff",border:"1px solid #444"},children:[l.jsx("option",{value:"bottom",children:"Bottom"}),l.jsx("option",{value:"top",children:"Top"})]}),l.jsxs("div",{className:"color-scan-percentage",children:[l.jsxs("label",{children:[me,"%"]}),l.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:me,onChange:$=>Me(Number($.target.value)),style:{width:"80px",marginLeft:"8px"}})]})]}),te==="manually"&&l.jsxs("div",{className:"manual-bounds-info",style:{display:"flex",alignItems:"center",gap:"8px"},children:[Re?l.jsxs("span",{style:{fontSize:"12px",color:"#aaa"},children:["Y: ",Math.round(Re.topY),"",Math.round(Re.bottomY)]}):l.jsx("span",{style:{fontSize:"12px",color:"#f44336"},children:"Not set"}),l.jsx("button",{onClick:()=>{if(ve)ue(!0);else{const $=(t==null?void 0:t.moves)||[],ge=$[Math.floor(Math.random()*$.length)];ge!=null&&ge.camera_frame&&(ce(ge.camera_frame),ue(!0))}},className:"ai-btn",style:{padding:"4px 8px",fontSize:"12px",backgroundColor:"#2196F3"},children:"Change scan area"})]})]})]})]})]}),J&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsx("div",{className:"cloth-analytics-header",children:l.jsxs("div",{children:[l.jsx("h3",{children:"Cloth Styles Analytics"}),l.jsxs("p",{children:["Frames analyzed: ",J.usedFrames,"/",J.totalFrames,"  Skipped:"," ",J.skippedFrames]})]})}),l.jsx("div",{className:"cloth-style-grid",children:(Po=J.clusters)==null?void 0:Po.map($=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:$.styleLabel}),l.jsx("span",{className:"player-label",children:$.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:$.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",$.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",$.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Mi($.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Mi($.avgBrightness||0)]})]})]},$.id))})]}),ie&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsxs("div",{className:"cloth-analytics-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:" All-All Styles Analytics (Background Excluded)"}),l.jsxs("p",{children:["Frames analyzed: ",ie.usedFrames,"/",ie.totalFrames,"  Skipped:"," ",ie.skippedFrames]})]}),l.jsxs("div",{className:"analytics-controls",style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"15px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#f5f5f5",padding:"4px 8px",borderRadius:"4px"},children:[l.jsxs("label",{style:{fontSize:"14px"},children:["Confirm threshold: ",Fe,"%"]}),l.jsx("input",{type:"range",min:"50",max:"100",value:Fe,onChange:$=>et(Number($.target.value)),style:{width:"100px"}}),l.jsx("button",{onClick:ms,disabled:Qe,style:{backgroundColor:Qe?"#9E9E9E":"#4CAF50",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:Qe?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",minWidth:"140px"},children:Qe?`Saving ${ut.current}/${ut.total}...`:`Confirm All  ${Fe}% (${Object.values(he).filter($=>($.confidence||0)*100>=Fe).length})`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("label",{children:"Sort by:"}),l.jsxs("select",{value:Ee,onChange:$=>Pe($.target.value),style:{padding:"4px",borderRadius:"4px"},children:[l.jsx("option",{value:"chronological",children:"Chronological"}),l.jsx("option",{value:"confidenceDesc",children:"Confidence (High to Low)"}),l.jsx("option",{value:"confidenceAsc",children:"Confidence (Low to High)"})]})]})]})]}),l.jsx("div",{className:"cloth-style-grid",children:(ki=ie.clusters)==null?void 0:ki.map($=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:$.styleLabel}),l.jsx("span",{className:"player-label",children:$.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:$.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",$.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",$.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Mi($.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Mi($.avgBrightness||0)]})]})]},$.id))})]}),l.jsxs("div",{className:"move-editor-content",children:[l.jsx("div",{className:"moves-grid",children:Rr.map(($,ge)=>{var xe;return l.jsxs("div",{className:`move-card ${(u==null?void 0:u._id)===$._id?"selected":""}`,onClick:()=>d($),children:[l.jsxs("div",{className:"move-card-header",children:[l.jsxs("span",{className:"move-number",children:["#",ge+1]}),l.jsx("span",{className:`move-phase ${$.phase}`,children:$.phase})]}),$.camera_frame&&l.jsxs("div",{className:"move-image",onClick:ae=>{ae.stopPropagation(),g(T&&L[$._id]?L[$._id]:$.camera_frame)},style:{position:"relative"},children:[l.jsx("img",{src:T&&L[$._id]?L[$._id]:$.camera_frame,alt:`Move ${ge+1}`}),l.jsx("div",{className:"image-overlay",children:" Click to enlarge"}),T&&L[$._id]&&l.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(76, 175, 80, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:" DEBUG"})]}),l.jsxs("div",{className:"move-card-body",children:[l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Type:"}),l.jsx("span",{className:"value",children:$.type})]}),k[$._id]&&(()=>{const ae=k[$._id].player,Oe=ae==="A"||ae==="Player A"?I:z;return l.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:Oe,outline:`2px solid ${s6(Oe,.25)}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:""}),l.jsxs("span",{className:"ai-text",children:["AI suggests: ",l.jsx("strong",{children:k[$._id].player})]})]}),l.jsx("button",{className:"ai-confirm-btn",onClick:it=>{it.stopPropagation(),zt($._id)},children:" Confirm"})]})})(),he[$._id]&&(()=>{const ae=he[$._id],it=ae.player==="Player A"?I:z,tt=ae.method||"color",Ie=tt==="cloth"?"":tt==="allall"?"":"",$e=tt==="cloth"?`Cloth suggests${ae.styleLabel?` (${ae.styleLabel})`:""}:`:tt==="allall"?`All-All suggests${ae.styleLabel?` (${ae.styleLabel})`:""}:`:"Color suggests:",Vt=typeof ae.confidence=="number"?`  ${Math.round(ae.confidence*100)}% confidence`:"";let _n=it;if(ae.stats&&ae.stats.meanColor){const{r:Pt,g:Ai,b:dc}=ae.stats.meanColor,Ei=Io=>{const Ro=Math.round(Io).toString(16);return Ro.length===1?"0"+Ro:Ro};_n=`#${Ei(Pt)}${Ei(Ai)}${Ei(dc)}`}return l.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:_n,borderWidth:"2px",outline:`4px solid ${_n}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:Ie}),l.jsxs("span",{className:"ai-text",children:[$e," ",l.jsx("strong",{children:ae.player}),Vt]})]}),l.jsx("button",{className:"ai-confirm-btn",disabled:ze===$._id,onClick:async Pt=>{Pt.stopPropagation(),We($._id),await Tt($._id),We(null)},children:ze===$._id?"...":" Confirm"})]})})(),l.jsxs("div",{className:"move-info-row player-row",style:{borderColor:$.player==="Player A"?I:$.player==="Player B"?z:$.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("span",{className:"label",children:"Player:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[l.jsxs("select",{className:`player-select ${(xe=$.player)==null?void 0:xe.toLowerCase().replace(" ","-")}`,value:$.player||"Unknown",onChange:ae=>ct($._id,ae.target.value),onClick:ae=>ae.stopPropagation(),style:{flex:1,borderColor:$.player==="Player A"?I:$.player==="Player B"?z:$.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]}),$.camera_frame&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"ai-single-btn",onClick:ae=>{ae.stopPropagation(),Xr($._id)},title:"Identify this move with AI",children:""}),l.jsx("button",{className:"ai-single-btn color-single-btn",onClick:ae=>{ae.stopPropagation(),rn($._id)},title:"Identify this move by color",children:""})]})]})]}),$.blockId!==null&&$.blockId!==void 0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Block:"}),l.jsx("span",{className:"value",children:$.blockId})]}),Array.isArray($.position)&&$.position.length===2&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Position:"}),l.jsxs("span",{className:"value",children:["(",$.position[0],", ",$.position[1],")"]})]}),l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Time:"}),l.jsxs("span",{className:"value",children:[Mi($.elapsed,1),"s"]})]}),Number.isFinite($.holdTime)&&$.holdTime>0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Hold:"}),l.jsxs("span",{className:"value",children:[Mi($.holdTime,2),"s"]})]})]})]},$._id||ge)})}),wr.length===0&&l.jsx("div",{className:"no-moves",children:l.jsx("p",{children:"No moves found for selected filter."})})]}),h&&l.jsx("div",{className:"image-modal",onClick:()=>g(null),children:l.jsxs("div",{className:"image-modal-content",onClick:$=>$.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:()=>g(null),children:""}),l.jsx("img",{src:h,alt:"Expanded view"})]})}),l.jsx(t6,{colorPreview:Ue,onClose:()=>He(null)}),ne&&ve&&l.jsx(n6,{frameDataUrl:ve,onSave:$=>{De($),ue(!1)},onCancel:()=>{ue(!1),q("bottom"),ce(null)}})]})}const o6=!1;function a6(){const[e,t]=j.useState(!1),[n,r]=j.useState(null),[s,i]=j.useState(null),[a,u]=j.useState(window.location.hash),[d,h]=j.useState(!1);j.useEffect(()=>{const R=()=>{u(window.location.hash)};return window.addEventListener("hashchange",R),()=>window.removeEventListener("hashchange",R)},[]),j.useEffect(()=>(window.toggleInterface=R=>{h(R),console.log("[App] Interface "+(R?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const g=R=>{r(R),t(!0)},v=()=>{s&&!s.closed&&s.close();const R=window.location.origin+window.location.pathname+"#/detector",B=window.open(R,"BraceletDetector","width=700,height=600,left=100,top=100");i(B)};j.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),j.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(R){console.error("Error ending experience:",R),alert("Error ending experience: "+R.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let w=null;const _=a.match(/^#\/admin\/edit-moves\/(.+)$/);if(a==="#/detector")w=l.jsx(v1,{});else if(a==="#/calibrate")w=l.jsx(fw,{});else if(a==="#/detector2")w=l.jsx(hw,{});else if(a==="#/summary")w=l.jsx(Z2,{});else if(a==="#/admin")w=l.jsx(mw,{});else if(a==="#/admin/upload")w=l.jsx(gw,{});else if(_){const R=decodeURIComponent(_[1]);w=l.jsx(i6,{sessionGameId:R},R)}else w=e?l.jsxs(l.Fragment,{children:[l.jsx(cw,{config:n,interfaceHidden:d}),l.jsx(v1,{hidden:d}),o6,!d&&l.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[l.jsx("button",{onClick:v,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),l.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),l.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&l.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:l.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):l.jsx(nw,{onStart:g});return l.jsx("div",{className:"App",children:w})}fd.createRoot(document.getElementById("root")).render(l.jsx(Y0.StrictMode,{children:l.jsx(a6,{})}));
