(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var yc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var L0={exports:{}},wu={},B0={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pa=Symbol.for("react.element"),_3=Symbol.for("react.portal"),j3=Symbol.for("react.fragment"),N3=Symbol.for("react.strict_mode"),b3=Symbol.for("react.profiler"),M3=Symbol.for("react.provider"),T3=Symbol.for("react.context"),P3=Symbol.for("react.forward_ref"),I3=Symbol.for("react.suspense"),R3=Symbol.for("react.memo"),L3=Symbol.for("react.lazy"),rm=Symbol.iterator;function B3(e){return e===null||typeof e!="object"?null:(e=rm&&e[rm]||e["@@iterator"],typeof e=="function"?e:null)}var F0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O0=Object.assign,$0={};function wo(e,t,n){this.props=e,this.context=t,this.refs=$0,this.updater=n||F0}wo.prototype.isReactComponent={};wo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};wo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function D0(){}D0.prototype=wo.prototype;function Ef(e,t,n){this.props=e,this.context=t,this.refs=$0,this.updater=n||F0}var Cf=Ef.prototype=new D0;Cf.constructor=Ef;O0(Cf,wo.prototype);Cf.isPureReactComponent=!0;var sm=Array.isArray,U0=Object.prototype.hasOwnProperty,_f={current:null},z0={key:!0,ref:!0,__self:!0,__source:!0};function H0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)U0.call(t,r)&&!z0.hasOwnProperty(r)&&(s[r]=t[r]);var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){for(var d=Array(u),h=0;h<u;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)s[r]===void 0&&(s[r]=u[r]);return{$$typeof:Pa,type:e,key:i,ref:a,props:s,_owner:_f.current}}function F3(e,t){return{$$typeof:Pa,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function jf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Pa}function O3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var im=/\/+/g;function vc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?O3(""+e.key):t.toString(36)}function yl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Pa:case _3:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+vc(a,0):r,sm(s)?(n="",e!=null&&(n=e.replace(im,"$&/")+"/"),yl(s,t,n,"",function(h){return h})):s!=null&&(jf(s)&&(s=F3(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(im,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",sm(e))for(var u=0;u<e.length;u++){i=e[u];var d=r+vc(i,u);a+=yl(i,t,n,d,s)}else if(d=B3(e),typeof d=="function")for(e=d.call(e),u=0;!(i=e.next()).done;)i=i.value,d=r+vc(i,u++),a+=yl(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ka(e,t,n){if(e==null)return e;var r=[],s=0;return yl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function $3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kn={current:null},vl={transition:null},D3={ReactCurrentDispatcher:kn,ReactCurrentBatchConfig:vl,ReactCurrentOwner:_f};function G0(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:Ka,forEach:function(e,t,n){Ka(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ka(e,function(){t++}),t},toArray:function(e){return Ka(e,function(t){return t})||[]},only:function(e){if(!jf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=wo;Ye.Fragment=j3;Ye.Profiler=b3;Ye.PureComponent=Ef;Ye.StrictMode=N3;Ye.Suspense=I3;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D3;Ye.act=G0;Ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=O0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=_f.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(d in t)U0.call(t,d)&&!z0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&u!==void 0?u[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var h=0;h<d;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:Pa,type:e.type,key:s,ref:i,props:r,_owner:a}};Ye.createContext=function(e){return e={$$typeof:T3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:M3,_context:e},e.Consumer=e};Ye.createElement=H0;Ye.createFactory=function(e){var t=H0.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:P3,render:e}};Ye.isValidElement=jf;Ye.lazy=function(e){return{$$typeof:L3,_payload:{_status:-1,_result:e},_init:$3}};Ye.memo=function(e,t){return{$$typeof:R3,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=vl.transition;vl.transition={};try{e()}finally{vl.transition=t}};Ye.unstable_act=G0;Ye.useCallback=function(e,t){return kn.current.useCallback(e,t)};Ye.useContext=function(e){return kn.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return kn.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return kn.current.useEffect(e,t)};Ye.useId=function(){return kn.current.useId()};Ye.useImperativeHandle=function(e,t,n){return kn.current.useImperativeHandle(e,t,n)};Ye.useInsertionEffect=function(e,t){return kn.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return kn.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return kn.current.useMemo(e,t)};Ye.useReducer=function(e,t,n){return kn.current.useReducer(e,t,n)};Ye.useRef=function(e){return kn.current.useRef(e)};Ye.useState=function(e){return kn.current.useState(e)};Ye.useSyncExternalStore=function(e,t,n){return kn.current.useSyncExternalStore(e,t,n)};Ye.useTransition=function(){return kn.current.useTransition()};Ye.version="18.3.1";B0.exports=Ye;var N=B0.exports;const W0=C3(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U3=N,z3=Symbol.for("react.element"),H3=Symbol.for("react.fragment"),G3=Object.prototype.hasOwnProperty,W3=U3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V3={key:!0,ref:!0,__self:!0,__source:!0};function V0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)G3.call(t,r)&&!V3.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:z3,type:e,key:i,ref:a,props:s,_owner:W3.current}}wu.Fragment=H3;wu.jsx=V0;wu.jsxs=V0;L0.exports=wu;var l=L0.exports,cd={},Y0={exports:{}},Zn={},X0={exports:{}},K0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ne,oe){var re=ne.length;ne.push(oe);e:for(;0<re;){var we=re-1>>>1,Te=ne[we];if(0<s(Te,oe))ne[we]=oe,ne[re]=Te,re=we;else break e}}function n(ne){return ne.length===0?null:ne[0]}function r(ne){if(ne.length===0)return null;var oe=ne[0],re=ne.pop();if(re!==oe){ne[0]=re;e:for(var we=0,Te=ne.length,Le=Te>>>1;we<Le;){var $e=2*(we+1)-1,Oe=ne[$e],De=$e+1,Y=ne[De];if(0>s(Oe,re))De<Te&&0>s(Y,Oe)?(ne[we]=Y,ne[De]=re,we=De):(ne[we]=Oe,ne[$e]=re,we=$e);else if(De<Te&&0>s(Y,re))ne[we]=Y,ne[De]=re,we=De;else break e}}return oe}function s(ne,oe){var re=ne.sortIndex-oe.sortIndex;return re!==0?re:ne.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,u=a.now();e.unstable_now=function(){return a.now()-u}}var d=[],h=[],m=1,w=null,S=3,_=!1,B=!1,O=!1,X=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ne){for(var oe=n(h);oe!==null;){if(oe.callback===null)r(h);else if(oe.startTime<=ne)r(h),oe.sortIndex=oe.expirationTime,t(d,oe);else break;oe=n(h)}}function E(ne){if(O=!1,y(ne),!B)if(n(d)!==null)B=!0,ve(j);else{var oe=n(h);oe!==null&&ye(E,oe.startTime-ne)}}function j(ne,oe){B=!1,O&&(O=!1,C(H),H=-1),_=!0;var re=S;try{for(y(oe),w=n(d);w!==null&&(!(w.expirationTime>oe)||ne&&!K());){var we=w.callback;if(typeof we=="function"){w.callback=null,S=w.priorityLevel;var Te=we(w.expirationTime<=oe);oe=e.unstable_now(),typeof Te=="function"?w.callback=Te:w===n(d)&&r(d),y(oe)}else r(d);w=n(d)}if(w!==null)var Le=!0;else{var $e=n(h);$e!==null&&ye(E,$e.startTime-oe),Le=!1}return Le}finally{w=null,S=re,_=!1}}var T=!1,D=null,H=-1,se=5,V=-1;function K(){return!(e.unstable_now()-V<se)}function ee(){if(D!==null){var ne=e.unstable_now();V=ne;var oe=!0;try{oe=D(!0,ne)}finally{oe?q():(T=!1,D=null)}}else T=!1}var q;if(typeof g=="function")q=function(){g(ee)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,Se=te.port2;te.port1.onmessage=ee,q=function(){Se.postMessage(null)}}else q=function(){X(ee,0)};function ve(ne){D=ne,T||(T=!0,q())}function ye(ne,oe){H=X(function(){ne(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){B||_||(B=!0,ve(j))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(ne){switch(S){case 1:case 2:case 3:var oe=3;break;default:oe=S}var re=S;S=oe;try{return ne()}finally{S=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,oe){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var re=S;S=ne;try{return oe()}finally{S=re}},e.unstable_scheduleCallback=function(ne,oe,re){var we=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?we+re:we):re=we,ne){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=re+Te,ne={id:m++,callback:oe,priorityLevel:ne,startTime:re,expirationTime:Te,sortIndex:-1},re>we?(ne.sortIndex=re,t(h,ne),n(d)===null&&ne===n(h)&&(O?(C(H),H=-1):O=!0,ye(E,re-we))):(ne.sortIndex=Te,t(d,ne),B||_||(B=!0,ve(j))),ne},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(ne){var oe=S;return function(){var re=S;S=oe;try{return ne.apply(this,arguments)}finally{S=re}}}})(K0);X0.exports=K0;var Y3=X0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X3=N,Jn=Y3;function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Q0=new Set,da={};function gi(e,t){to(e,t),to(e+"Capture",t)}function to(e,t){for(da[e]=t,e=0;e<t.length;e++)Q0.add(t[e])}var ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dd=Object.prototype.hasOwnProperty,K3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,om={},am={};function Q3(e){return dd.call(am,e)?!0:dd.call(om,e)?!1:K3.test(e)?am[e]=!0:(om[e]=!0,!1)}function J3(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function q3(e,t,n,r){if(t===null||typeof t>"u"||J3(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function An(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ln[e]=new An(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ln[t]=new An(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ln[e]=new An(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ln[e]=new An(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ln[e]=new An(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ln[e]=new An(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ln[e]=new An(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ln[e]=new An(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ln[e]=new An(e,5,!1,e.toLowerCase(),null,!1,!1)});var Nf=/[\-:]([a-z])/g;function bf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Nf,bf);ln[t]=new An(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Nf,bf);ln[t]=new An(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Nf,bf);ln[t]=new An(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ln[e]=new An(e,1,!1,e.toLowerCase(),null,!1,!1)});ln.xlinkHref=new An("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ln[e]=new An(e,1,!1,e.toLowerCase(),null,!0,!0)});function Mf(e,t,n,r){var s=ln.hasOwnProperty(t)?ln[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(q3(t,n,s,r)&&(n=null),r||s===null?Q3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ps=X3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qa=Symbol.for("react.element"),Mi=Symbol.for("react.portal"),Ti=Symbol.for("react.fragment"),Tf=Symbol.for("react.strict_mode"),fd=Symbol.for("react.profiler"),J0=Symbol.for("react.provider"),q0=Symbol.for("react.context"),Pf=Symbol.for("react.forward_ref"),hd=Symbol.for("react.suspense"),pd=Symbol.for("react.suspense_list"),If=Symbol.for("react.memo"),xs=Symbol.for("react.lazy"),Z0=Symbol.for("react.offscreen"),lm=Symbol.iterator;function Lo(e){return e===null||typeof e!="object"?null:(e=lm&&e[lm]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,wc;function Vo(e){if(wc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);wc=t&&t[1]||""}return`
`+wc+e}var xc=!1;function Sc(e,t){if(!e||xc)return"";xc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,u=i.length-1;1<=a&&0<=u&&s[a]!==i[u];)u--;for(;1<=a&&0<=u;a--,u--)if(s[a]!==i[u]){if(a!==1||u!==1)do if(a--,u--,0>u||s[a]!==i[u]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=u);break}}}finally{xc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Vo(e):""}function Z3(e){switch(e.tag){case 5:return Vo(e.type);case 16:return Vo("Lazy");case 13:return Vo("Suspense");case 19:return Vo("SuspenseList");case 0:case 2:case 15:return e=Sc(e.type,!1),e;case 11:return e=Sc(e.type.render,!1),e;case 1:return e=Sc(e.type,!0),e;default:return""}}function md(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ti:return"Fragment";case Mi:return"Portal";case fd:return"Profiler";case Tf:return"StrictMode";case hd:return"Suspense";case pd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case q0:return(e.displayName||"Context")+".Consumer";case J0:return(e._context.displayName||"Context")+".Provider";case Pf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case If:return t=e.displayName||null,t!==null?t:md(e.type)||"Memo";case xs:t=e._payload,e=e._init;try{return md(e(t))}catch{}}return null}function e4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return md(t);case 8:return t===Tf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $s(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function eg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function t4(e){var t=eg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ja(e){e._valueTracker||(e._valueTracker=t4(e))}function tg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=eg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ll(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gd(e,t){var n=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function um(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=$s(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ng(e,t){t=t.checked,t!=null&&Mf(e,"checked",t,!1)}function yd(e,t){ng(e,t);var n=$s(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vd(e,t.type,n):t.hasOwnProperty("defaultValue")&&vd(e,t.type,$s(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function cm(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function vd(e,t,n){(t!=="number"||Ll(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Yo=Array.isArray;function Hi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$s(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function wd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(le(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function dm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(le(92));if(Yo(n)){if(1<n.length)throw Error(le(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:$s(n)}}function rg(e,t){var n=$s(t.value),r=$s(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function fm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qa,ig=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qa=qa||document.createElement("div"),qa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fa(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var qo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},n4=["Webkit","ms","Moz","O"];Object.keys(qo).forEach(function(e){n4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),qo[t]=qo[e]})});function og(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||qo.hasOwnProperty(e)&&qo[e]?(""+t).trim():t+"px"}function ag(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=og(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var r4=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sd(e,t){if(t){if(r4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(le(62))}}function kd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ad=null;function Rf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ed=null,Gi=null,Wi=null;function hm(e){if(e=La(e)){if(typeof Ed!="function")throw Error(le(280));var t=e.stateNode;t&&(t=Eu(t),Ed(e.stateNode,e.type,t))}}function lg(e){Gi?Wi?Wi.push(e):Wi=[e]:Gi=e}function ug(){if(Gi){var e=Gi,t=Wi;if(Wi=Gi=null,hm(e),t)for(e=0;e<t.length;e++)hm(t[e])}}function cg(e,t){return e(t)}function dg(){}var kc=!1;function fg(e,t,n){if(kc)return e(t,n);kc=!0;try{return cg(e,t,n)}finally{kc=!1,(Gi!==null||Wi!==null)&&(dg(),ug())}}function ha(e,t){var n=e.stateNode;if(n===null)return null;var r=Eu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(le(231,t,typeof n));return n}var Cd=!1;if(ls)try{var Bo={};Object.defineProperty(Bo,"passive",{get:function(){Cd=!0}}),window.addEventListener("test",Bo,Bo),window.removeEventListener("test",Bo,Bo)}catch{Cd=!1}function s4(e,t,n,r,s,i,a,u,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(m){this.onError(m)}}var Zo=!1,Bl=null,Fl=!1,_d=null,i4={onError:function(e){Zo=!0,Bl=e}};function o4(e,t,n,r,s,i,a,u,d){Zo=!1,Bl=null,s4.apply(i4,arguments)}function a4(e,t,n,r,s,i,a,u,d){if(o4.apply(this,arguments),Zo){if(Zo){var h=Bl;Zo=!1,Bl=null}else throw Error(le(198));Fl||(Fl=!0,_d=h)}}function yi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pm(e){if(yi(e)!==e)throw Error(le(188))}function l4(e){var t=e.alternate;if(!t){if(t=yi(e),t===null)throw Error(le(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return pm(s),e;if(i===r)return pm(s),t;i=i.sibling}throw Error(le(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,u=s.child;u;){if(u===n){a=!0,n=s,r=i;break}if(u===r){a=!0,r=s,n=i;break}u=u.sibling}if(!a){for(u=i.child;u;){if(u===n){a=!0,n=i,r=s;break}if(u===r){a=!0,r=i,n=s;break}u=u.sibling}if(!a)throw Error(le(189))}}if(n.alternate!==r)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?e:t}function pg(e){return e=l4(e),e!==null?mg(e):null}function mg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mg(e);if(t!==null)return t;e=e.sibling}return null}var gg=Jn.unstable_scheduleCallback,mm=Jn.unstable_cancelCallback,u4=Jn.unstable_shouldYield,c4=Jn.unstable_requestPaint,$t=Jn.unstable_now,d4=Jn.unstable_getCurrentPriorityLevel,Lf=Jn.unstable_ImmediatePriority,yg=Jn.unstable_UserBlockingPriority,Ol=Jn.unstable_NormalPriority,f4=Jn.unstable_LowPriority,vg=Jn.unstable_IdlePriority,xu=null,Vr=null;function h4(e){if(Vr&&typeof Vr.onCommitFiberRoot=="function")try{Vr.onCommitFiberRoot(xu,e,void 0,(e.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:g4,p4=Math.log,m4=Math.LN2;function g4(e){return e>>>=0,e===0?32:31-(p4(e)/m4|0)|0}var Za=64,el=4194304;function Xo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $l(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var u=a&~s;u!==0?r=Xo(u):(i&=a,i!==0&&(r=Xo(i)))}else a=n&~s,a!==0?r=Xo(a):i!==0&&(r=Xo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Nr(t),s=1<<n,r|=e[n],t&=~s;return r}function y4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Nr(i),u=1<<a,d=s[a];d===-1?(!(u&n)||u&r)&&(s[a]=y4(u,t)):d<=t&&(e.expiredLanes|=u),i&=~u}}function jd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wg(){var e=Za;return Za<<=1,!(Za&4194240)&&(Za=64),e}function Ac(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ia(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nr(t),e[t]=n}function w4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Nr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Bf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Nr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function xg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Sg,Ff,kg,Ag,Eg,Nd=!1,tl=[],bs=null,Ms=null,Ts=null,pa=new Map,ma=new Map,As=[],x4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gm(e,t){switch(e){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":Ms=null;break;case"mouseover":case"mouseout":Ts=null;break;case"pointerover":case"pointerout":pa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ma.delete(t.pointerId)}}function Fo(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=La(t),t!==null&&Ff(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function S4(e,t,n,r,s){switch(t){case"focusin":return bs=Fo(bs,e,t,n,r,s),!0;case"dragenter":return Ms=Fo(Ms,e,t,n,r,s),!0;case"mouseover":return Ts=Fo(Ts,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return pa.set(i,Fo(pa.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ma.set(i,Fo(ma.get(i)||null,e,t,n,r,s)),!0}return!1}function Cg(e){var t=ti(e.target);if(t!==null){var n=yi(t);if(n!==null){if(t=n.tag,t===13){if(t=hg(n),t!==null){e.blockedOn=t,Eg(e.priority,function(){kg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function wl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=bd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ad=r,n.target.dispatchEvent(r),Ad=null}else return t=La(n),t!==null&&Ff(t),e.blockedOn=n,!1;t.shift()}return!0}function ym(e,t,n){wl(e)&&n.delete(t)}function k4(){Nd=!1,bs!==null&&wl(bs)&&(bs=null),Ms!==null&&wl(Ms)&&(Ms=null),Ts!==null&&wl(Ts)&&(Ts=null),pa.forEach(ym),ma.forEach(ym)}function Oo(e,t){e.blockedOn===t&&(e.blockedOn=null,Nd||(Nd=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,k4)))}function ga(e){function t(s){return Oo(s,e)}if(0<tl.length){Oo(tl[0],e);for(var n=1;n<tl.length;n++){var r=tl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(bs!==null&&Oo(bs,e),Ms!==null&&Oo(Ms,e),Ts!==null&&Oo(Ts,e),pa.forEach(t),ma.forEach(t),n=0;n<As.length;n++)r=As[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<As.length&&(n=As[0],n.blockedOn===null);)Cg(n),n.blockedOn===null&&As.shift()}var Vi=ps.ReactCurrentBatchConfig,Dl=!0;function A4(e,t,n,r){var s=at,i=Vi.transition;Vi.transition=null;try{at=1,Of(e,t,n,r)}finally{at=s,Vi.transition=i}}function E4(e,t,n,r){var s=at,i=Vi.transition;Vi.transition=null;try{at=4,Of(e,t,n,r)}finally{at=s,Vi.transition=i}}function Of(e,t,n,r){if(Dl){var s=bd(e,t,n,r);if(s===null)Ic(e,t,r,Ul,n),gm(e,r);else if(S4(s,e,t,n,r))r.stopPropagation();else if(gm(e,r),t&4&&-1<x4.indexOf(e)){for(;s!==null;){var i=La(s);if(i!==null&&Sg(i),i=bd(e,t,n,r),i===null&&Ic(e,t,r,Ul,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Ic(e,t,r,null,n)}}var Ul=null;function bd(e,t,n,r){if(Ul=null,e=Rf(r),e=ti(e),e!==null)if(t=yi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ul=e,null}function _g(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(d4()){case Lf:return 1;case yg:return 4;case Ol:case f4:return 16;case vg:return 536870912;default:return 16}default:return 16}}var js=null,$f=null,xl=null;function jg(){if(xl)return xl;var e,t=$f,n=t.length,r,s="value"in js?js.value:js.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return xl=s.slice(e,1<r?1-r:void 0)}function Sl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function nl(){return!0}function vm(){return!1}function er(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(i):i[u]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?nl:vm,this.isPropagationStopped=vm,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=nl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=nl)},persist:function(){},isPersistent:nl}),t}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Df=er(xo),Ra=Mt({},xo,{view:0,detail:0}),C4=er(Ra),Ec,Cc,$o,Su=Mt({},Ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$o&&($o&&e.type==="mousemove"?(Ec=e.screenX-$o.screenX,Cc=e.screenY-$o.screenY):Cc=Ec=0,$o=e),Ec)},movementY:function(e){return"movementY"in e?e.movementY:Cc}}),wm=er(Su),_4=Mt({},Su,{dataTransfer:0}),j4=er(_4),N4=Mt({},Ra,{relatedTarget:0}),_c=er(N4),b4=Mt({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),M4=er(b4),T4=Mt({},xo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),P4=er(T4),I4=Mt({},xo,{data:0}),xm=er(I4),R4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=B4[e])?!!t[e]:!1}function Uf(){return F4}var O4=Mt({},Ra,{key:function(e){if(e.key){var t=R4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Sl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?L4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uf,charCode:function(e){return e.type==="keypress"?Sl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Sl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$4=er(O4),D4=Mt({},Su,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sm=er(D4),U4=Mt({},Ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uf}),z4=er(U4),H4=Mt({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),G4=er(H4),W4=Mt({},Su,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),V4=er(W4),Y4=[9,13,27,32],zf=ls&&"CompositionEvent"in window,ea=null;ls&&"documentMode"in document&&(ea=document.documentMode);var X4=ls&&"TextEvent"in window&&!ea,Ng=ls&&(!zf||ea&&8<ea&&11>=ea),km=" ",Am=!1;function bg(e,t){switch(e){case"keyup":return Y4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pi=!1;function K4(e,t){switch(e){case"compositionend":return Mg(t);case"keypress":return t.which!==32?null:(Am=!0,km);case"textInput":return e=t.data,e===km&&Am?null:e;default:return null}}function Q4(e,t){if(Pi)return e==="compositionend"||!zf&&bg(e,t)?(e=jg(),xl=$f=js=null,Pi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ng&&t.locale!=="ko"?null:t.data;default:return null}}var J4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Em(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!J4[e.type]:t==="textarea"}function Tg(e,t,n,r){lg(r),t=zl(t,"onChange"),0<t.length&&(n=new Df("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ta=null,ya=null;function q4(e){zg(e,0)}function ku(e){var t=Li(e);if(tg(t))return e}function Z4(e,t){if(e==="change")return t}var Pg=!1;if(ls){var jc;if(ls){var Nc="oninput"in document;if(!Nc){var Cm=document.createElement("div");Cm.setAttribute("oninput","return;"),Nc=typeof Cm.oninput=="function"}jc=Nc}else jc=!1;Pg=jc&&(!document.documentMode||9<document.documentMode)}function _m(){ta&&(ta.detachEvent("onpropertychange",Ig),ya=ta=null)}function Ig(e){if(e.propertyName==="value"&&ku(ya)){var t=[];Tg(t,ya,e,Rf(e)),fg(q4,t)}}function ew(e,t,n){e==="focusin"?(_m(),ta=t,ya=n,ta.attachEvent("onpropertychange",Ig)):e==="focusout"&&_m()}function tw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ku(ya)}function nw(e,t){if(e==="click")return ku(t)}function rw(e,t){if(e==="input"||e==="change")return ku(t)}function sw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mr=typeof Object.is=="function"?Object.is:sw;function va(e,t){if(Mr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!dd.call(t,s)||!Mr(e[s],t[s]))return!1}return!0}function jm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Nm(e,t){var n=jm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jm(n)}}function Rg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Lg(){for(var e=window,t=Ll();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ll(e.document)}return t}function Hf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function iw(e){var t=Lg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Rg(n.ownerDocument.documentElement,n)){if(r!==null&&Hf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Nm(n,i);var a=Nm(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ow=ls&&"documentMode"in document&&11>=document.documentMode,Ii=null,Md=null,na=null,Td=!1;function bm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Td||Ii==null||Ii!==Ll(r)||(r=Ii,"selectionStart"in r&&Hf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),na&&va(na,r)||(na=r,r=zl(Md,"onSelect"),0<r.length&&(t=new Df("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ii)))}function rl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ri={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionend:rl("Transition","TransitionEnd")},bc={},Bg={};ls&&(Bg=document.createElement("div").style,"AnimationEvent"in window||(delete Ri.animationend.animation,delete Ri.animationiteration.animation,delete Ri.animationstart.animation),"TransitionEvent"in window||delete Ri.transitionend.transition);function Au(e){if(bc[e])return bc[e];if(!Ri[e])return e;var t=Ri[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Bg)return bc[e]=t[n];return e}var Fg=Au("animationend"),Og=Au("animationiteration"),$g=Au("animationstart"),Dg=Au("transitionend"),Ug=new Map,Mm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hs(e,t){Ug.set(e,t),gi(t,[e])}for(var Mc=0;Mc<Mm.length;Mc++){var Tc=Mm[Mc],aw=Tc.toLowerCase(),lw=Tc[0].toUpperCase()+Tc.slice(1);Hs(aw,"on"+lw)}Hs(Fg,"onAnimationEnd");Hs(Og,"onAnimationIteration");Hs($g,"onAnimationStart");Hs("dblclick","onDoubleClick");Hs("focusin","onFocus");Hs("focusout","onBlur");Hs(Dg,"onTransitionEnd");to("onMouseEnter",["mouseout","mouseover"]);to("onMouseLeave",["mouseout","mouseover"]);to("onPointerEnter",["pointerout","pointerover"]);to("onPointerLeave",["pointerout","pointerover"]);gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ko));function Tm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,a4(r,t,void 0,e),e.currentTarget=null}function zg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var u=r[a],d=u.instance,h=u.currentTarget;if(u=u.listener,d!==i&&s.isPropagationStopped())break e;Tm(s,u,h),i=d}else for(a=0;a<r.length;a++){if(u=r[a],d=u.instance,h=u.currentTarget,u=u.listener,d!==i&&s.isPropagationStopped())break e;Tm(s,u,h),i=d}}}if(Fl)throw e=_d,Fl=!1,_d=null,e}function yt(e,t){var n=t[Bd];n===void 0&&(n=t[Bd]=new Set);var r=e+"__bubble";n.has(r)||(Hg(t,e,2,!1),n.add(r))}function Pc(e,t,n){var r=0;t&&(r|=4),Hg(n,e,r,t)}var sl="_reactListening"+Math.random().toString(36).slice(2);function wa(e){if(!e[sl]){e[sl]=!0,Q0.forEach(function(n){n!=="selectionchange"&&(uw.has(n)||Pc(n,!1,e),Pc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[sl]||(t[sl]=!0,Pc("selectionchange",!1,t))}}function Hg(e,t,n,r){switch(_g(t)){case 1:var s=A4;break;case 4:s=E4;break;default:s=Of}n=s.bind(null,t,n,e),s=void 0,!Cd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Ic(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var u=r.stateNode.containerInfo;if(u===s||u.nodeType===8&&u.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;u!==null;){if(a=ti(u),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}u=u.parentNode}}r=r.return}fg(function(){var h=i,m=Rf(n),w=[];e:{var S=Ug.get(e);if(S!==void 0){var _=Df,B=e;switch(e){case"keypress":if(Sl(n)===0)break e;case"keydown":case"keyup":_=$4;break;case"focusin":B="focus",_=_c;break;case"focusout":B="blur",_=_c;break;case"beforeblur":case"afterblur":_=_c;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=j4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=z4;break;case Fg:case Og:case $g:_=M4;break;case Dg:_=G4;break;case"scroll":_=C4;break;case"wheel":_=V4;break;case"copy":case"cut":case"paste":_=P4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Sm}var O=(t&4)!==0,X=!O&&e==="scroll",C=O?S!==null?S+"Capture":null:S;O=[];for(var g=h,y;g!==null;){y=g;var E=y.stateNode;if(y.tag===5&&E!==null&&(y=E,C!==null&&(E=ha(g,C),E!=null&&O.push(xa(g,E,y)))),X)break;g=g.return}0<O.length&&(S=new _(S,B,null,n,m),w.push({event:S,listeners:O}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",S&&n!==Ad&&(B=n.relatedTarget||n.fromElement)&&(ti(B)||B[us]))break e;if((_||S)&&(S=m.window===m?m:(S=m.ownerDocument)?S.defaultView||S.parentWindow:window,_?(B=n.relatedTarget||n.toElement,_=h,B=B?ti(B):null,B!==null&&(X=yi(B),B!==X||B.tag!==5&&B.tag!==6)&&(B=null)):(_=null,B=h),_!==B)){if(O=wm,E="onMouseLeave",C="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(O=Sm,E="onPointerLeave",C="onPointerEnter",g="pointer"),X=_==null?S:Li(_),y=B==null?S:Li(B),S=new O(E,g+"leave",_,n,m),S.target=X,S.relatedTarget=y,E=null,ti(m)===h&&(O=new O(C,g+"enter",B,n,m),O.target=y,O.relatedTarget=X,E=O),X=E,_&&B)t:{for(O=_,C=B,g=0,y=O;y;y=Ci(y))g++;for(y=0,E=C;E;E=Ci(E))y++;for(;0<g-y;)O=Ci(O),g--;for(;0<y-g;)C=Ci(C),y--;for(;g--;){if(O===C||C!==null&&O===C.alternate)break t;O=Ci(O),C=Ci(C)}O=null}else O=null;_!==null&&Pm(w,S,_,O,!1),B!==null&&X!==null&&Pm(w,X,B,O,!0)}}e:{if(S=h?Li(h):window,_=S.nodeName&&S.nodeName.toLowerCase(),_==="select"||_==="input"&&S.type==="file")var j=Z4;else if(Em(S))if(Pg)j=rw;else{j=tw;var T=ew}else(_=S.nodeName)&&_.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(j=nw);if(j&&(j=j(e,h))){Tg(w,j,n,m);break e}T&&T(e,S,h),e==="focusout"&&(T=S._wrapperState)&&T.controlled&&S.type==="number"&&vd(S,"number",S.value)}switch(T=h?Li(h):window,e){case"focusin":(Em(T)||T.contentEditable==="true")&&(Ii=T,Md=h,na=null);break;case"focusout":na=Md=Ii=null;break;case"mousedown":Td=!0;break;case"contextmenu":case"mouseup":case"dragend":Td=!1,bm(w,n,m);break;case"selectionchange":if(ow)break;case"keydown":case"keyup":bm(w,n,m)}var D;if(zf)e:{switch(e){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else Pi?bg(e,n)&&(H="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(H="onCompositionStart");H&&(Ng&&n.locale!=="ko"&&(Pi||H!=="onCompositionStart"?H==="onCompositionEnd"&&Pi&&(D=jg()):(js=m,$f="value"in js?js.value:js.textContent,Pi=!0)),T=zl(h,H),0<T.length&&(H=new xm(H,e,null,n,m),w.push({event:H,listeners:T}),D?H.data=D:(D=Mg(n),D!==null&&(H.data=D)))),(D=X4?K4(e,n):Q4(e,n))&&(h=zl(h,"onBeforeInput"),0<h.length&&(m=new xm("onBeforeInput","beforeinput",null,n,m),w.push({event:m,listeners:h}),m.data=D))}zg(w,t)})}function xa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function zl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ha(e,n),i!=null&&r.unshift(xa(e,i,s)),i=ha(e,t),i!=null&&r.push(xa(e,i,s))),e=e.return}return r}function Ci(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Pm(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var u=n,d=u.alternate,h=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&h!==null&&(u=h,s?(d=ha(n,i),d!=null&&a.unshift(xa(n,d,u))):s||(d=ha(n,i),d!=null&&a.push(xa(n,d,u)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var cw=/\r\n?/g,dw=/\u0000|\uFFFD/g;function Im(e){return(typeof e=="string"?e:""+e).replace(cw,`
`).replace(dw,"")}function il(e,t,n){if(t=Im(t),Im(e)!==t&&n)throw Error(le(425))}function Hl(){}var Pd=null,Id=null;function Rd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ld=typeof setTimeout=="function"?setTimeout:void 0,fw=typeof clearTimeout=="function"?clearTimeout:void 0,Rm=typeof Promise=="function"?Promise:void 0,hw=typeof queueMicrotask=="function"?queueMicrotask:typeof Rm<"u"?function(e){return Rm.resolve(null).then(e).catch(pw)}:Ld;function pw(e){setTimeout(function(){throw e})}function Rc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),ga(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ga(t)}function Ps(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Lm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var So=Math.random().toString(36).slice(2),Wr="__reactFiber$"+So,Sa="__reactProps$"+So,us="__reactContainer$"+So,Bd="__reactEvents$"+So,mw="__reactListeners$"+So,gw="__reactHandles$"+So;function ti(e){var t=e[Wr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[us]||n[Wr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Lm(e);e!==null;){if(n=e[Wr])return n;e=Lm(e)}return t}e=n,n=e.parentNode}return null}function La(e){return e=e[Wr]||e[us],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Li(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(le(33))}function Eu(e){return e[Sa]||null}var Fd=[],Bi=-1;function Gs(e){return{current:e}}function vt(e){0>Bi||(e.current=Fd[Bi],Fd[Bi]=null,Bi--)}function ht(e,t){Bi++,Fd[Bi]=e.current,e.current=t}var Ds={},pn=Gs(Ds),In=Gs(!1),ui=Ds;function no(e,t){var n=e.type.contextTypes;if(!n)return Ds;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Rn(e){return e=e.childContextTypes,e!=null}function Gl(){vt(In),vt(pn)}function Bm(e,t,n){if(pn.current!==Ds)throw Error(le(168));ht(pn,t),ht(In,n)}function Gg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(le(108,e4(e)||"Unknown",s));return Mt({},n,r)}function Wl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ds,ui=pn.current,ht(pn,e),ht(In,In.current),!0}function Fm(e,t,n){var r=e.stateNode;if(!r)throw Error(le(169));n?(e=Gg(e,t,ui),r.__reactInternalMemoizedMergedChildContext=e,vt(In),vt(pn),ht(pn,e)):vt(In),ht(In,n)}var qr=null,Cu=!1,Lc=!1;function Wg(e){qr===null?qr=[e]:qr.push(e)}function yw(e){Cu=!0,Wg(e)}function Ws(){if(!Lc&&qr!==null){Lc=!0;var e=0,t=at;try{var n=qr;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}qr=null,Cu=!1}catch(s){throw qr!==null&&(qr=qr.slice(e+1)),gg(Lf,Ws),s}finally{at=t,Lc=!1}}return null}var Fi=[],Oi=0,Vl=null,Yl=0,ur=[],cr=0,ci=null,ts=1,ns="";function Zs(e,t){Fi[Oi++]=Yl,Fi[Oi++]=Vl,Vl=e,Yl=t}function Vg(e,t,n){ur[cr++]=ts,ur[cr++]=ns,ur[cr++]=ci,ci=e;var r=ts;e=ns;var s=32-Nr(r)-1;r&=~(1<<s),n+=1;var i=32-Nr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ts=1<<32-Nr(t)+s|n<<s|r,ns=i+e}else ts=1<<i|n<<s|r,ns=e}function Gf(e){e.return!==null&&(Zs(e,1),Vg(e,1,0))}function Wf(e){for(;e===Vl;)Vl=Fi[--Oi],Fi[Oi]=null,Yl=Fi[--Oi],Fi[Oi]=null;for(;e===ci;)ci=ur[--cr],ur[cr]=null,ns=ur[--cr],ur[cr]=null,ts=ur[--cr],ur[cr]=null}var Qn=null,Kn=null,At=!1,_r=null;function Yg(e,t){var n=fr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Om(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Qn=e,Kn=Ps(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Qn=e,Kn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ci!==null?{id:ts,overflow:ns}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=fr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Qn=e,Kn=null,!0):!1;default:return!1}}function Od(e){return(e.mode&1)!==0&&(e.flags&128)===0}function $d(e){if(At){var t=Kn;if(t){var n=t;if(!Om(e,t)){if(Od(e))throw Error(le(418));t=Ps(n.nextSibling);var r=Qn;t&&Om(e,t)?Yg(r,n):(e.flags=e.flags&-4097|2,At=!1,Qn=e)}}else{if(Od(e))throw Error(le(418));e.flags=e.flags&-4097|2,At=!1,Qn=e}}}function $m(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qn=e}function ol(e){if(e!==Qn)return!1;if(!At)return $m(e),At=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Rd(e.type,e.memoizedProps)),t&&(t=Kn)){if(Od(e))throw Xg(),Error(le(418));for(;t;)Yg(e,t),t=Ps(t.nextSibling)}if($m(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Kn=Ps(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Kn=null}}else Kn=Qn?Ps(e.stateNode.nextSibling):null;return!0}function Xg(){for(var e=Kn;e;)e=Ps(e.nextSibling)}function ro(){Kn=Qn=null,At=!1}function Vf(e){_r===null?_r=[e]:_r.push(e)}var vw=ps.ReactCurrentBatchConfig;function Do(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var r=n.stateNode}if(!r)throw Error(le(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var u=s.refs;a===null?delete u[i]:u[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,e))}return e}function al(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Dm(e){var t=e._init;return t(e._payload)}function Kg(e){function t(C,g){if(e){var y=C.deletions;y===null?(C.deletions=[g],C.flags|=16):y.push(g)}}function n(C,g){if(!e)return null;for(;g!==null;)t(C,g),g=g.sibling;return null}function r(C,g){for(C=new Map;g!==null;)g.key!==null?C.set(g.key,g):C.set(g.index,g),g=g.sibling;return C}function s(C,g){return C=Bs(C,g),C.index=0,C.sibling=null,C}function i(C,g,y){return C.index=y,e?(y=C.alternate,y!==null?(y=y.index,y<g?(C.flags|=2,g):y):(C.flags|=2,g)):(C.flags|=1048576,g)}function a(C){return e&&C.alternate===null&&(C.flags|=2),C}function u(C,g,y,E){return g===null||g.tag!==6?(g=zc(y,C.mode,E),g.return=C,g):(g=s(g,y),g.return=C,g)}function d(C,g,y,E){var j=y.type;return j===Ti?m(C,g,y.props.children,E,y.key):g!==null&&(g.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===xs&&Dm(j)===g.type)?(E=s(g,y.props),E.ref=Do(C,g,y),E.return=C,E):(E=Nl(y.type,y.key,y.props,null,C.mode,E),E.ref=Do(C,g,y),E.return=C,E)}function h(C,g,y,E){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Hc(y,C.mode,E),g.return=C,g):(g=s(g,y.children||[]),g.return=C,g)}function m(C,g,y,E,j){return g===null||g.tag!==7?(g=ai(y,C.mode,E,j),g.return=C,g):(g=s(g,y),g.return=C,g)}function w(C,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=zc(""+g,C.mode,y),g.return=C,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Qa:return y=Nl(g.type,g.key,g.props,null,C.mode,y),y.ref=Do(C,null,g),y.return=C,y;case Mi:return g=Hc(g,C.mode,y),g.return=C,g;case xs:var E=g._init;return w(C,E(g._payload),y)}if(Yo(g)||Lo(g))return g=ai(g,C.mode,y,null),g.return=C,g;al(C,g)}return null}function S(C,g,y,E){var j=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return j!==null?null:u(C,g,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Qa:return y.key===j?d(C,g,y,E):null;case Mi:return y.key===j?h(C,g,y,E):null;case xs:return j=y._init,S(C,g,j(y._payload),E)}if(Yo(y)||Lo(y))return j!==null?null:m(C,g,y,E,null);al(C,y)}return null}function _(C,g,y,E,j){if(typeof E=="string"&&E!==""||typeof E=="number")return C=C.get(y)||null,u(g,C,""+E,j);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Qa:return C=C.get(E.key===null?y:E.key)||null,d(g,C,E,j);case Mi:return C=C.get(E.key===null?y:E.key)||null,h(g,C,E,j);case xs:var T=E._init;return _(C,g,y,T(E._payload),j)}if(Yo(E)||Lo(E))return C=C.get(y)||null,m(g,C,E,j,null);al(g,E)}return null}function B(C,g,y,E){for(var j=null,T=null,D=g,H=g=0,se=null;D!==null&&H<y.length;H++){D.index>H?(se=D,D=null):se=D.sibling;var V=S(C,D,y[H],E);if(V===null){D===null&&(D=se);break}e&&D&&V.alternate===null&&t(C,D),g=i(V,g,H),T===null?j=V:T.sibling=V,T=V,D=se}if(H===y.length)return n(C,D),At&&Zs(C,H),j;if(D===null){for(;H<y.length;H++)D=w(C,y[H],E),D!==null&&(g=i(D,g,H),T===null?j=D:T.sibling=D,T=D);return At&&Zs(C,H),j}for(D=r(C,D);H<y.length;H++)se=_(D,C,H,y[H],E),se!==null&&(e&&se.alternate!==null&&D.delete(se.key===null?H:se.key),g=i(se,g,H),T===null?j=se:T.sibling=se,T=se);return e&&D.forEach(function(K){return t(C,K)}),At&&Zs(C,H),j}function O(C,g,y,E){var j=Lo(y);if(typeof j!="function")throw Error(le(150));if(y=j.call(y),y==null)throw Error(le(151));for(var T=j=null,D=g,H=g=0,se=null,V=y.next();D!==null&&!V.done;H++,V=y.next()){D.index>H?(se=D,D=null):se=D.sibling;var K=S(C,D,V.value,E);if(K===null){D===null&&(D=se);break}e&&D&&K.alternate===null&&t(C,D),g=i(K,g,H),T===null?j=K:T.sibling=K,T=K,D=se}if(V.done)return n(C,D),At&&Zs(C,H),j;if(D===null){for(;!V.done;H++,V=y.next())V=w(C,V.value,E),V!==null&&(g=i(V,g,H),T===null?j=V:T.sibling=V,T=V);return At&&Zs(C,H),j}for(D=r(C,D);!V.done;H++,V=y.next())V=_(D,C,H,V.value,E),V!==null&&(e&&V.alternate!==null&&D.delete(V.key===null?H:V.key),g=i(V,g,H),T===null?j=V:T.sibling=V,T=V);return e&&D.forEach(function(ee){return t(C,ee)}),At&&Zs(C,H),j}function X(C,g,y,E){if(typeof y=="object"&&y!==null&&y.type===Ti&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Qa:e:{for(var j=y.key,T=g;T!==null;){if(T.key===j){if(j=y.type,j===Ti){if(T.tag===7){n(C,T.sibling),g=s(T,y.props.children),g.return=C,C=g;break e}}else if(T.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===xs&&Dm(j)===T.type){n(C,T.sibling),g=s(T,y.props),g.ref=Do(C,T,y),g.return=C,C=g;break e}n(C,T);break}else t(C,T);T=T.sibling}y.type===Ti?(g=ai(y.props.children,C.mode,E,y.key),g.return=C,C=g):(E=Nl(y.type,y.key,y.props,null,C.mode,E),E.ref=Do(C,g,y),E.return=C,C=E)}return a(C);case Mi:e:{for(T=y.key;g!==null;){if(g.key===T)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(C,g.sibling),g=s(g,y.children||[]),g.return=C,C=g;break e}else{n(C,g);break}else t(C,g);g=g.sibling}g=Hc(y,C.mode,E),g.return=C,C=g}return a(C);case xs:return T=y._init,X(C,g,T(y._payload),E)}if(Yo(y))return B(C,g,y,E);if(Lo(y))return O(C,g,y,E);al(C,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(C,g.sibling),g=s(g,y),g.return=C,C=g):(n(C,g),g=zc(y,C.mode,E),g.return=C,C=g),a(C)):n(C,g)}return X}var so=Kg(!0),Qg=Kg(!1),Xl=Gs(null),Kl=null,$i=null,Yf=null;function Xf(){Yf=$i=Kl=null}function Kf(e){var t=Xl.current;vt(Xl),e._currentValue=t}function Dd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Yi(e,t){Kl=e,Yf=$i=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pn=!0),e.firstContext=null)}function mr(e){var t=e._currentValue;if(Yf!==e)if(e={context:e,memoizedValue:t,next:null},$i===null){if(Kl===null)throw Error(le(308));$i=e,Kl.dependencies={lanes:0,firstContext:e}}else $i=$i.next=e;return t}var ni=null;function Qf(e){ni===null?ni=[e]:ni.push(e)}function Jg(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Qf(t)):(n.next=s.next,s.next=n),t.interleaved=n,cs(e,r)}function cs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ss=!1;function Jf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ss(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Is(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,et&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,cs(e,n)}return s=r.interleaved,s===null?(t.next=t,Qf(r)):(t.next=s.next,s.next=t),r.interleaved=t,cs(e,n)}function kl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Bf(e,n)}}function Um(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ql(e,t,n,r){var s=e.updateQueue;Ss=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,u=s.shared.pending;if(u!==null){s.shared.pending=null;var d=u,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var m=e.alternate;m!==null&&(m=m.updateQueue,u=m.lastBaseUpdate,u!==a&&(u===null?m.firstBaseUpdate=h:u.next=h,m.lastBaseUpdate=d))}if(i!==null){var w=s.baseState;a=0,m=h=d=null,u=i;do{var S=u.lane,_=u.eventTime;if((r&S)===S){m!==null&&(m=m.next={eventTime:_,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var B=e,O=u;switch(S=t,_=n,O.tag){case 1:if(B=O.payload,typeof B=="function"){w=B.call(_,w,S);break e}w=B;break e;case 3:B.flags=B.flags&-65537|128;case 0:if(B=O.payload,S=typeof B=="function"?B.call(_,w,S):B,S==null)break e;w=Mt({},w,S);break e;case 2:Ss=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,S=s.effects,S===null?s.effects=[u]:S.push(u))}else _={eventTime:_,lane:S,tag:u.tag,payload:u.payload,callback:u.callback,next:null},m===null?(h=m=_,d=w):m=m.next=_,a|=S;if(u=u.next,u===null){if(u=s.shared.pending,u===null)break;S=u,u=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(!0);if(m===null&&(d=w),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);fi|=a,e.lanes=a,e.memoizedState=w}}function zm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(le(191,s));s.call(r)}}}var Ba={},Yr=Gs(Ba),ka=Gs(Ba),Aa=Gs(Ba);function ri(e){if(e===Ba)throw Error(le(174));return e}function qf(e,t){switch(ht(Aa,t),ht(ka,e),ht(Yr,Ba),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:xd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=xd(t,e)}vt(Yr),ht(Yr,t)}function io(){vt(Yr),vt(ka),vt(Aa)}function Zg(e){ri(Aa.current);var t=ri(Yr.current),n=xd(t,e.type);t!==n&&(ht(ka,e),ht(Yr,n))}function Zf(e){ka.current===e&&(vt(Yr),vt(ka))}var jt=Gs(0);function Jl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bc=[];function eh(){for(var e=0;e<Bc.length;e++)Bc[e]._workInProgressVersionPrimary=null;Bc.length=0}var Al=ps.ReactCurrentDispatcher,Fc=ps.ReactCurrentBatchConfig,di=0,Nt=null,Yt=null,en=null,ql=!1,ra=!1,Ea=0,ww=0;function un(){throw Error(le(321))}function th(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Mr(e[n],t[n]))return!1;return!0}function nh(e,t,n,r,s,i){if(di=i,Nt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Al.current=e===null||e.memoizedState===null?Aw:Ew,e=n(r,s),ra){i=0;do{if(ra=!1,Ea=0,25<=i)throw Error(le(301));i+=1,en=Yt=null,t.updateQueue=null,Al.current=Cw,e=n(r,s)}while(ra)}if(Al.current=Zl,t=Yt!==null&&Yt.next!==null,di=0,en=Yt=Nt=null,ql=!1,t)throw Error(le(300));return e}function rh(){var e=Ea!==0;return Ea=0,e}function Hr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?Nt.memoizedState=en=e:en=en.next=e,en}function gr(){if(Yt===null){var e=Nt.alternate;e=e!==null?e.memoizedState:null}else e=Yt.next;var t=en===null?Nt.memoizedState:en.next;if(t!==null)en=t,Yt=e;else{if(e===null)throw Error(le(310));Yt=e,e={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},en===null?Nt.memoizedState=en=e:en=en.next=e}return en}function Ca(e,t){return typeof t=="function"?t(e):t}function Oc(e){var t=gr(),n=t.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=e;var r=Yt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var u=a=null,d=null,h=i;do{var m=h.lane;if((di&m)===m)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var w={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(u=d=w,a=r):d=d.next=w,Nt.lanes|=m,fi|=m}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=u,Mr(r,t.memoizedState)||(Pn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Nt.lanes|=i,fi|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function $c(e){var t=gr(),n=t.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Mr(i,t.memoizedState)||(Pn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function e2(){}function t2(e,t){var n=Nt,r=gr(),s=t(),i=!Mr(r.memoizedState,s);if(i&&(r.memoizedState=s,Pn=!0),r=r.queue,sh(s2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||en!==null&&en.memoizedState.tag&1){if(n.flags|=2048,_a(9,r2.bind(null,n,r,s,t),void 0,null),tn===null)throw Error(le(349));di&30||n2(n,t,s)}return s}function n2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function r2(e,t,n,r){t.value=n,t.getSnapshot=r,i2(t)&&o2(e)}function s2(e,t,n){return n(function(){i2(t)&&o2(e)})}function i2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Mr(e,n)}catch{return!0}}function o2(e){var t=cs(e,1);t!==null&&br(t,e,1,-1)}function Hm(e){var t=Hr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:e},t.queue=e,e=e.dispatch=kw.bind(null,Nt,e),[t.memoizedState,e]}function _a(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function a2(){return gr().memoizedState}function El(e,t,n,r){var s=Hr();Nt.flags|=e,s.memoizedState=_a(1|t,n,void 0,r===void 0?null:r)}function _u(e,t,n,r){var s=gr();r=r===void 0?null:r;var i=void 0;if(Yt!==null){var a=Yt.memoizedState;if(i=a.destroy,r!==null&&th(r,a.deps)){s.memoizedState=_a(t,n,i,r);return}}Nt.flags|=e,s.memoizedState=_a(1|t,n,i,r)}function Gm(e,t){return El(8390656,8,e,t)}function sh(e,t){return _u(2048,8,e,t)}function l2(e,t){return _u(4,2,e,t)}function u2(e,t){return _u(4,4,e,t)}function c2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function d2(e,t,n){return n=n!=null?n.concat([e]):null,_u(4,4,c2.bind(null,t,e),n)}function ih(){}function f2(e,t){var n=gr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&th(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function h2(e,t){var n=gr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&th(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function p2(e,t,n){return di&21?(Mr(n,t)||(n=wg(),Nt.lanes|=n,fi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pn=!0),e.memoizedState=n)}function xw(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=Fc.transition;Fc.transition={};try{e(!1),t()}finally{at=n,Fc.transition=r}}function m2(){return gr().memoizedState}function Sw(e,t,n){var r=Ls(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},g2(e))y2(t,n);else if(n=Jg(e,t,n,r),n!==null){var s=xn();br(n,e,r,s),v2(n,t,r)}}function kw(e,t,n){var r=Ls(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(g2(e))y2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,u=i(a,n);if(s.hasEagerState=!0,s.eagerState=u,Mr(u,a)){var d=t.interleaved;d===null?(s.next=s,Qf(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=Jg(e,t,s,r),n!==null&&(s=xn(),br(n,e,r,s),v2(n,t,r))}}function g2(e){var t=e.alternate;return e===Nt||t!==null&&t===Nt}function y2(e,t){ra=ql=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function v2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Bf(e,n)}}var Zl={readContext:mr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},Aw={readContext:mr,useCallback:function(e,t){return Hr().memoizedState=[e,t===void 0?null:t],e},useContext:mr,useEffect:Gm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,El(4194308,4,c2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return El(4194308,4,e,t)},useInsertionEffect:function(e,t){return El(4,2,e,t)},useMemo:function(e,t){var n=Hr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Sw.bind(null,Nt,e),[r.memoizedState,e]},useRef:function(e){var t=Hr();return e={current:e},t.memoizedState=e},useState:Hm,useDebugValue:ih,useDeferredValue:function(e){return Hr().memoizedState=e},useTransition:function(){var e=Hm(!1),t=e[0];return e=xw.bind(null,e[1]),Hr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Nt,s=Hr();if(At){if(n===void 0)throw Error(le(407));n=n()}else{if(n=t(),tn===null)throw Error(le(349));di&30||n2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Gm(s2.bind(null,r,i,e),[e]),r.flags|=2048,_a(9,r2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Hr(),t=tn.identifierPrefix;if(At){var n=ns,r=ts;n=(r&~(1<<32-Nr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ea++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ww++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ew={readContext:mr,useCallback:f2,useContext:mr,useEffect:sh,useImperativeHandle:d2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:h2,useReducer:Oc,useRef:a2,useState:function(){return Oc(Ca)},useDebugValue:ih,useDeferredValue:function(e){var t=gr();return p2(t,Yt.memoizedState,e)},useTransition:function(){var e=Oc(Ca)[0],t=gr().memoizedState;return[e,t]},useMutableSource:e2,useSyncExternalStore:t2,useId:m2,unstable_isNewReconciler:!1},Cw={readContext:mr,useCallback:f2,useContext:mr,useEffect:sh,useImperativeHandle:d2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:h2,useReducer:$c,useRef:a2,useState:function(){return $c(Ca)},useDebugValue:ih,useDeferredValue:function(e){var t=gr();return Yt===null?t.memoizedState=e:p2(t,Yt.memoizedState,e)},useTransition:function(){var e=$c(Ca)[0],t=gr().memoizedState;return[e,t]},useMutableSource:e2,useSyncExternalStore:t2,useId:m2,unstable_isNewReconciler:!1};function Er(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Ud(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Mt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ju={isMounted:function(e){return(e=e._reactInternals)?yi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=xn(),s=Ls(e),i=ss(r,s);i.payload=t,n!=null&&(i.callback=n),t=Is(e,i,s),t!==null&&(br(t,e,s,r),kl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=xn(),s=Ls(e),i=ss(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Is(e,i,s),t!==null&&(br(t,e,s,r),kl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=xn(),r=Ls(e),s=ss(n,r);s.tag=2,t!=null&&(s.callback=t),t=Is(e,s,r),t!==null&&(br(t,e,r,n),kl(t,e,r))}};function Wm(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!va(n,r)||!va(s,i):!0}function w2(e,t,n){var r=!1,s=Ds,i=t.contextType;return typeof i=="object"&&i!==null?i=mr(i):(s=Rn(t)?ui:pn.current,r=t.contextTypes,i=(r=r!=null)?no(e,s):Ds),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ju,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Vm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ju.enqueueReplaceState(t,t.state,null)}function zd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Jf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=mr(i):(i=Rn(t)?ui:pn.current,s.context=no(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Ud(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ju.enqueueReplaceState(s,s.state,null),Ql(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function oo(e,t){try{var n="",r=t;do n+=Z3(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Dc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Hd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _w=typeof WeakMap=="function"?WeakMap:Map;function x2(e,t,n){n=ss(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){tu||(tu=!0,Zd=r),Hd(e,t)},n}function S2(e,t,n){n=ss(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Hd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Hd(e,t),typeof r!="function"&&(Rs===null?Rs=new Set([this]):Rs.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Ym(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new _w;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Dw.bind(null,e,t,n),t.then(e,e))}function Xm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Km(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ss(-1,1),t.tag=2,Is(n,t,1))),n.lanes|=1),e)}var jw=ps.ReactCurrentOwner,Pn=!1;function wn(e,t,n,r){t.child=e===null?Qg(t,null,n,r):so(t,e.child,n,r)}function Qm(e,t,n,r,s){n=n.render;var i=t.ref;return Yi(t,s),r=nh(e,t,n,r,i,s),n=rh(),e!==null&&!Pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ds(e,t,s)):(At&&n&&Gf(t),t.flags|=1,wn(e,t,r,s),t.child)}function Jm(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!hh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,k2(e,t,i,r,s)):(e=Nl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:va,n(a,r)&&e.ref===t.ref)return ds(e,t,s)}return t.flags|=1,e=Bs(i,r),e.ref=t.ref,e.return=t,t.child=e}function k2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(va(i,r)&&e.ref===t.ref)if(Pn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Pn=!0);else return t.lanes=e.lanes,ds(e,t,s)}return Gd(e,t,n,r,s)}function A2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(Ui,Xn),Xn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(Ui,Xn),Xn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ht(Ui,Xn),Xn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,ht(Ui,Xn),Xn|=r;return wn(e,t,s,n),t.child}function E2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Gd(e,t,n,r,s){var i=Rn(n)?ui:pn.current;return i=no(t,i),Yi(t,s),n=nh(e,t,n,r,i,s),r=rh(),e!==null&&!Pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ds(e,t,s)):(At&&r&&Gf(t),t.flags|=1,wn(e,t,n,s),t.child)}function qm(e,t,n,r,s){if(Rn(n)){var i=!0;Wl(t)}else i=!1;if(Yi(t,s),t.stateNode===null)Cl(e,t),w2(t,n,r),zd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,u=t.memoizedProps;a.props=u;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=mr(h):(h=Rn(n)?ui:pn.current,h=no(t,h));var m=n.getDerivedStateFromProps,w=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==r||d!==h)&&Vm(t,a,r,h),Ss=!1;var S=t.memoizedState;a.state=S,Ql(t,r,a,s),d=t.memoizedState,u!==r||S!==d||In.current||Ss?(typeof m=="function"&&(Ud(t,n,m,r),d=t.memoizedState),(u=Ss||Wm(t,n,u,r,S,d,h))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=u):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,qg(e,t),u=t.memoizedProps,h=t.type===t.elementType?u:Er(t.type,u),a.props=h,w=t.pendingProps,S=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=mr(d):(d=Rn(n)?ui:pn.current,d=no(t,d));var _=n.getDerivedStateFromProps;(m=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(u!==w||S!==d)&&Vm(t,a,r,d),Ss=!1,S=t.memoizedState,a.state=S,Ql(t,r,a,s);var B=t.memoizedState;u!==w||S!==B||In.current||Ss?(typeof _=="function"&&(Ud(t,n,_,r),B=t.memoizedState),(h=Ss||Wm(t,n,h,r,S,B,d)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,B,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,B,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=B),a.props=r,a.state=B,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),r=!1)}return Wd(e,t,n,r,i,s)}function Wd(e,t,n,r,s,i){E2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&Fm(t,n,!1),ds(e,t,i);r=t.stateNode,jw.current=t;var u=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=so(t,e.child,null,i),t.child=so(t,null,u,i)):wn(e,t,u,i),t.memoizedState=r.state,s&&Fm(t,n,!0),t.child}function C2(e){var t=e.stateNode;t.pendingContext?Bm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Bm(e,t.context,!1),qf(e,t.containerInfo)}function Zm(e,t,n,r,s){return ro(),Vf(s),t.flags|=256,wn(e,t,n,r),t.child}var Vd={dehydrated:null,treeContext:null,retryLane:0};function Yd(e){return{baseLanes:e,cachePool:null,transitions:null}}function _2(e,t,n){var r=t.pendingProps,s=jt.current,i=!1,a=(t.flags&128)!==0,u;if((u=a)||(u=e!==null&&e.memoizedState===null?!1:(s&2)!==0),u?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ht(jt,s&1),e===null)return $d(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Mu(a,r,0,null),e=ai(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Yd(n),t.memoizedState=Vd,e):oh(t,a));if(s=e.memoizedState,s!==null&&(u=s.dehydrated,u!==null))return Nw(e,t,a,r,u,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,u=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Bs(s,d),r.subtreeFlags=s.subtreeFlags&14680064),u!==null?i=Bs(u,i):(i=ai(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Yd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Vd,r}return i=e.child,e=i.sibling,r=Bs(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function oh(e,t){return t=Mu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ll(e,t,n,r){return r!==null&&Vf(r),so(t,e.child,null,n),e=oh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Nw(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Dc(Error(le(422))),ll(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Mu({mode:"visible",children:r.children},s,0,null),i=ai(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&so(t,e.child,null,a),t.child.memoizedState=Yd(a),t.memoizedState=Vd,i);if(!(t.mode&1))return ll(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var u=r.dgst;return r=u,i=Error(le(419)),r=Dc(i,r,void 0),ll(e,t,a,r)}if(u=(a&e.childLanes)!==0,Pn||u){if(r=tn,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,cs(e,s),br(r,e,s,-1))}return fh(),r=Dc(Error(le(421))),ll(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Uw.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Kn=Ps(s.nextSibling),Qn=t,At=!0,_r=null,e!==null&&(ur[cr++]=ts,ur[cr++]=ns,ur[cr++]=ci,ts=e.id,ns=e.overflow,ci=t),t=oh(t,r.children),t.flags|=4096,t)}function e1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Dd(e.return,t,n)}function Uc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function j2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(wn(e,t,r.children,n),r=jt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&e1(e,n,t);else if(e.tag===19)e1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ht(jt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Jl(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Uc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Jl(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Uc(t,!0,n,null,i);break;case"together":Uc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Cl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ds(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),fi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(le(153));if(t.child!==null){for(e=t.child,n=Bs(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Bs(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function bw(e,t,n){switch(t.tag){case 3:C2(t),ro();break;case 5:Zg(t);break;case 1:Rn(t.type)&&Wl(t);break;case 4:qf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ht(Xl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ht(jt,jt.current&1),t.flags|=128,null):n&t.child.childLanes?_2(e,t,n):(ht(jt,jt.current&1),e=ds(e,t,n),e!==null?e.sibling:null);ht(jt,jt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return j2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ht(jt,jt.current),r)break;return null;case 22:case 23:return t.lanes=0,A2(e,t,n)}return ds(e,t,n)}var N2,Xd,b2,M2;N2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xd=function(){};b2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ri(Yr.current);var i=null;switch(n){case"input":s=gd(e,s),r=gd(e,r),i=[];break;case"select":s=Mt({},s,{value:void 0}),r=Mt({},r,{value:void 0}),i=[];break;case"textarea":s=wd(e,s),r=wd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Hl)}Sd(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var u=s[h];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(da.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(u=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==u&&(d!=null||u!=null))if(h==="style")if(u){for(a in u)!u.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&u[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(da.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&yt("scroll",e),i||u===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};M2=function(e,t,n,r){n!==r&&(t.flags|=4)};function Uo(e,t){if(!At)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Mw(e,t,n){var r=t.pendingProps;switch(Wf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(t),null;case 1:return Rn(t.type)&&Gl(),cn(t),null;case 3:return r=t.stateNode,io(),vt(In),vt(pn),eh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ol(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_r!==null&&(nf(_r),_r=null))),Xd(e,t),cn(t),null;case 5:Zf(t);var s=ri(Aa.current);if(n=t.type,e!==null&&t.stateNode!=null)b2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(le(166));return cn(t),null}if(e=ri(Yr.current),ol(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Wr]=t,r[Sa]=i,e=(t.mode&1)!==0,n){case"dialog":yt("cancel",r),yt("close",r);break;case"iframe":case"object":case"embed":yt("load",r);break;case"video":case"audio":for(s=0;s<Ko.length;s++)yt(Ko[s],r);break;case"source":yt("error",r);break;case"img":case"image":case"link":yt("error",r),yt("load",r);break;case"details":yt("toggle",r);break;case"input":um(r,i),yt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},yt("invalid",r);break;case"textarea":dm(r,i),yt("invalid",r)}Sd(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var u=i[a];a==="children"?typeof u=="string"?r.textContent!==u&&(i.suppressHydrationWarning!==!0&&il(r.textContent,u,e),s=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(i.suppressHydrationWarning!==!0&&il(r.textContent,u,e),s=["children",""+u]):da.hasOwnProperty(a)&&u!=null&&a==="onScroll"&&yt("scroll",r)}switch(n){case"input":Ja(r),cm(r,i,!0);break;case"textarea":Ja(r),fm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Hl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Wr]=t,e[Sa]=r,N2(e,t,!1,!1),t.stateNode=e;e:{switch(a=kd(n,r),n){case"dialog":yt("cancel",e),yt("close",e),s=r;break;case"iframe":case"object":case"embed":yt("load",e),s=r;break;case"video":case"audio":for(s=0;s<Ko.length;s++)yt(Ko[s],e);s=r;break;case"source":yt("error",e),s=r;break;case"img":case"image":case"link":yt("error",e),yt("load",e),s=r;break;case"details":yt("toggle",e),s=r;break;case"input":um(e,r),s=gd(e,r),yt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Mt({},r,{value:void 0}),yt("invalid",e);break;case"textarea":dm(e,r),s=wd(e,r),yt("invalid",e);break;default:s=r}Sd(n,s),u=s;for(i in u)if(u.hasOwnProperty(i)){var d=u[i];i==="style"?ag(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&ig(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&fa(e,d):typeof d=="number"&&fa(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(da.hasOwnProperty(i)?d!=null&&i==="onScroll"&&yt("scroll",e):d!=null&&Mf(e,i,d,a))}switch(n){case"input":Ja(e),cm(e,r,!1);break;case"textarea":Ja(e),fm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+$s(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Hi(e,!!r.multiple,i,!1):r.defaultValue!=null&&Hi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Hl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return cn(t),null;case 6:if(e&&t.stateNode!=null)M2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(le(166));if(n=ri(Aa.current),ri(Yr.current),ol(t)){if(r=t.stateNode,n=t.memoizedProps,r[Wr]=t,(i=r.nodeValue!==n)&&(e=Qn,e!==null))switch(e.tag){case 3:il(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&il(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wr]=t,t.stateNode=r}return cn(t),null;case 13:if(vt(jt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(At&&Kn!==null&&t.mode&1&&!(t.flags&128))Xg(),ro(),t.flags|=98560,i=!1;else if(i=ol(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(le(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(le(317));i[Wr]=t}else ro(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;cn(t),i=!1}else _r!==null&&(nf(_r),_r=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||jt.current&1?Kt===0&&(Kt=3):fh())),t.updateQueue!==null&&(t.flags|=4),cn(t),null);case 4:return io(),Xd(e,t),e===null&&wa(t.stateNode.containerInfo),cn(t),null;case 10:return Kf(t.type._context),cn(t),null;case 17:return Rn(t.type)&&Gl(),cn(t),null;case 19:if(vt(jt),i=t.memoizedState,i===null)return cn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Uo(i,!1);else{if(Kt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Jl(e),a!==null){for(t.flags|=128,Uo(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ht(jt,jt.current&1|2),t.child}e=e.sibling}i.tail!==null&&$t()>ao&&(t.flags|=128,r=!0,Uo(i,!1),t.lanes=4194304)}else{if(!r)if(e=Jl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Uo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!At)return cn(t),null}else 2*$t()-i.renderingStartTime>ao&&n!==1073741824&&(t.flags|=128,r=!0,Uo(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=$t(),t.sibling=null,n=jt.current,ht(jt,r?n&1|2:n&1),t):(cn(t),null);case 22:case 23:return dh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Xn&1073741824&&(cn(t),t.subtreeFlags&6&&(t.flags|=8192)):cn(t),null;case 24:return null;case 25:return null}throw Error(le(156,t.tag))}function Tw(e,t){switch(Wf(t),t.tag){case 1:return Rn(t.type)&&Gl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return io(),vt(In),vt(pn),eh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Zf(t),null;case 13:if(vt(jt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(le(340));ro()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vt(jt),null;case 4:return io(),null;case 10:return Kf(t.type._context),null;case 22:case 23:return dh(),null;case 24:return null;default:return null}}var ul=!1,hn=!1,Pw=typeof WeakSet=="function"?WeakSet:Set,ke=null;function Di(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Lt(e,t,r)}else n.current=null}function Kd(e,t,n){try{n()}catch(r){Lt(e,t,r)}}var t1=!1;function Iw(e,t){if(Pd=Dl,e=Lg(),Hf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,u=-1,d=-1,h=0,m=0,w=e,S=null;t:for(;;){for(var _;w!==n||s!==0&&w.nodeType!==3||(u=a+s),w!==i||r!==0&&w.nodeType!==3||(d=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(_=w.firstChild)!==null;)S=w,w=_;for(;;){if(w===e)break t;if(S===n&&++h===s&&(u=a),S===i&&++m===r&&(d=a),(_=w.nextSibling)!==null)break;w=S,S=w.parentNode}w=_}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Id={focusedElem:e,selectionRange:n},Dl=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var B=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var O=B.memoizedProps,X=B.memoizedState,C=t.stateNode,g=C.getSnapshotBeforeUpdate(t.elementType===t.type?O:Er(t.type,O),X);C.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(E){Lt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return B=t1,t1=!1,B}function sa(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Kd(t,n,i)}s=s.next}while(s!==r)}}function Nu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Qd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function T2(e){var t=e.alternate;t!==null&&(e.alternate=null,T2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Wr],delete t[Sa],delete t[Bd],delete t[mw],delete t[gw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function P2(e){return e.tag===5||e.tag===3||e.tag===4}function n1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||P2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Hl));else if(r!==4&&(e=e.child,e!==null))for(Jd(e,t,n),e=e.sibling;e!==null;)Jd(e,t,n),e=e.sibling}function qd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(qd(e,t,n),e=e.sibling;e!==null;)qd(e,t,n),e=e.sibling}var on=null,Cr=!1;function vs(e,t,n){for(n=n.child;n!==null;)I2(e,t,n),n=n.sibling}function I2(e,t,n){if(Vr&&typeof Vr.onCommitFiberUnmount=="function")try{Vr.onCommitFiberUnmount(xu,n)}catch{}switch(n.tag){case 5:hn||Di(n,t);case 6:var r=on,s=Cr;on=null,vs(e,t,n),on=r,Cr=s,on!==null&&(Cr?(e=on,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):on.removeChild(n.stateNode));break;case 18:on!==null&&(Cr?(e=on,n=n.stateNode,e.nodeType===8?Rc(e.parentNode,n):e.nodeType===1&&Rc(e,n),ga(e)):Rc(on,n.stateNode));break;case 4:r=on,s=Cr,on=n.stateNode.containerInfo,Cr=!0,vs(e,t,n),on=r,Cr=s;break;case 0:case 11:case 14:case 15:if(!hn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Kd(n,t,a),s=s.next}while(s!==r)}vs(e,t,n);break;case 1:if(!hn&&(Di(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Lt(n,t,u)}vs(e,t,n);break;case 21:vs(e,t,n);break;case 22:n.mode&1?(hn=(r=hn)||n.memoizedState!==null,vs(e,t,n),hn=r):vs(e,t,n);break;default:vs(e,t,n)}}function r1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Pw),t.forEach(function(r){var s=zw.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ar(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,u=a;e:for(;u!==null;){switch(u.tag){case 5:on=u.stateNode,Cr=!1;break e;case 3:on=u.stateNode.containerInfo,Cr=!0;break e;case 4:on=u.stateNode.containerInfo,Cr=!0;break e}u=u.return}if(on===null)throw Error(le(160));I2(i,a,s),on=null,Cr=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){Lt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)R2(t,e),t=t.sibling}function R2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ar(t,e),Fr(e),r&4){try{sa(3,e,e.return),Nu(3,e)}catch(O){Lt(e,e.return,O)}try{sa(5,e,e.return)}catch(O){Lt(e,e.return,O)}}break;case 1:Ar(t,e),Fr(e),r&512&&n!==null&&Di(n,n.return);break;case 5:if(Ar(t,e),Fr(e),r&512&&n!==null&&Di(n,n.return),e.flags&32){var s=e.stateNode;try{fa(s,"")}catch(O){Lt(e,e.return,O)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,u=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{u==="input"&&i.type==="radio"&&i.name!=null&&ng(s,i),kd(u,a);var h=kd(u,i);for(a=0;a<d.length;a+=2){var m=d[a],w=d[a+1];m==="style"?ag(s,w):m==="dangerouslySetInnerHTML"?ig(s,w):m==="children"?fa(s,w):Mf(s,m,w,h)}switch(u){case"input":yd(s,i);break;case"textarea":rg(s,i);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Hi(s,!!i.multiple,_,!1):S!==!!i.multiple&&(i.defaultValue!=null?Hi(s,!!i.multiple,i.defaultValue,!0):Hi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Sa]=i}catch(O){Lt(e,e.return,O)}}break;case 6:if(Ar(t,e),Fr(e),r&4){if(e.stateNode===null)throw Error(le(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(O){Lt(e,e.return,O)}}break;case 3:if(Ar(t,e),Fr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ga(t.containerInfo)}catch(O){Lt(e,e.return,O)}break;case 4:Ar(t,e),Fr(e);break;case 13:Ar(t,e),Fr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(uh=$t())),r&4&&r1(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(hn=(h=hn)||m,Ar(t,e),hn=h):Ar(t,e),Fr(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!m&&e.mode&1)for(ke=e,m=e.child;m!==null;){for(w=ke=m;ke!==null;){switch(S=ke,_=S.child,S.tag){case 0:case 11:case 14:case 15:sa(4,S,S.return);break;case 1:Di(S,S.return);var B=S.stateNode;if(typeof B.componentWillUnmount=="function"){r=S,n=S.return;try{t=r,B.props=t.memoizedProps,B.state=t.memoizedState,B.componentWillUnmount()}catch(O){Lt(r,n,O)}}break;case 5:Di(S,S.return);break;case 22:if(S.memoizedState!==null){i1(w);continue}}_!==null?(_.return=S,ke=_):i1(w)}m=m.sibling}e:for(m=null,w=e;;){if(w.tag===5){if(m===null){m=w;try{s=w.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(u=w.stateNode,d=w.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=og("display",a))}catch(O){Lt(e,e.return,O)}}}else if(w.tag===6){if(m===null)try{w.stateNode.nodeValue=h?"":w.memoizedProps}catch(O){Lt(e,e.return,O)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===e)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===e)break e;for(;w.sibling===null;){if(w.return===null||w.return===e)break e;m===w&&(m=null),w=w.return}m===w&&(m=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Ar(t,e),Fr(e),r&4&&r1(e);break;case 21:break;default:Ar(t,e),Fr(e)}}function Fr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(P2(n)){var r=n;break e}n=n.return}throw Error(le(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(fa(s,""),r.flags&=-33);var i=n1(e);qd(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,u=n1(e);Jd(e,u,a);break;default:throw Error(le(161))}}catch(d){Lt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Rw(e,t,n){ke=e,L2(e)}function L2(e,t,n){for(var r=(e.mode&1)!==0;ke!==null;){var s=ke,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||ul;if(!a){var u=s.alternate,d=u!==null&&u.memoizedState!==null||hn;u=ul;var h=hn;if(ul=a,(hn=d)&&!h)for(ke=s;ke!==null;)a=ke,d=a.child,a.tag===22&&a.memoizedState!==null?o1(s):d!==null?(d.return=a,ke=d):o1(s);for(;i!==null;)ke=i,L2(i),i=i.sibling;ke=s,ul=u,hn=h}s1(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ke=i):s1(e)}}function s1(e){for(;ke!==null;){var t=ke;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:hn||Nu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!hn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Er(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&zm(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}zm(t,a,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var w=m.dehydrated;w!==null&&ga(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}hn||t.flags&512&&Qd(t)}catch(S){Lt(t,t.return,S)}}if(t===e){ke=null;break}if(n=t.sibling,n!==null){n.return=t.return,ke=n;break}ke=t.return}}function i1(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ke=n;break}ke=t.return}}function o1(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Nu(4,t)}catch(d){Lt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){Lt(t,s,d)}}var i=t.return;try{Qd(t)}catch(d){Lt(t,i,d)}break;case 5:var a=t.return;try{Qd(t)}catch(d){Lt(t,a,d)}}}catch(d){Lt(t,t.return,d)}if(t===e){ke=null;break}var u=t.sibling;if(u!==null){u.return=t.return,ke=u;break}ke=t.return}}var Lw=Math.ceil,eu=ps.ReactCurrentDispatcher,ah=ps.ReactCurrentOwner,pr=ps.ReactCurrentBatchConfig,et=0,tn=null,zt=null,an=0,Xn=0,Ui=Gs(0),Kt=0,ja=null,fi=0,bu=0,lh=0,ia=null,Tn=null,uh=0,ao=1/0,Jr=null,tu=!1,Zd=null,Rs=null,cl=!1,Ns=null,nu=0,oa=0,ef=null,_l=-1,jl=0;function xn(){return et&6?$t():_l!==-1?_l:_l=$t()}function Ls(e){return e.mode&1?et&2&&an!==0?an&-an:vw.transition!==null?(jl===0&&(jl=wg()),jl):(e=at,e!==0||(e=window.event,e=e===void 0?16:_g(e.type)),e):1}function br(e,t,n,r){if(50<oa)throw oa=0,ef=null,Error(le(185));Ia(e,n,r),(!(et&2)||e!==tn)&&(e===tn&&(!(et&2)&&(bu|=n),Kt===4&&Es(e,an)),Ln(e,r),n===1&&et===0&&!(t.mode&1)&&(ao=$t()+500,Cu&&Ws()))}function Ln(e,t){var n=e.callbackNode;v4(e,t);var r=$l(e,e===tn?an:0);if(r===0)n!==null&&mm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&mm(n),t===1)e.tag===0?yw(a1.bind(null,e)):Wg(a1.bind(null,e)),hw(function(){!(et&6)&&Ws()}),n=null;else{switch(xg(r)){case 1:n=Lf;break;case 4:n=yg;break;case 16:n=Ol;break;case 536870912:n=vg;break;default:n=Ol}n=H2(n,B2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function B2(e,t){if(_l=-1,jl=0,et&6)throw Error(le(327));var n=e.callbackNode;if(Xi()&&e.callbackNode!==n)return null;var r=$l(e,e===tn?an:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ru(e,r);else{t=r;var s=et;et|=2;var i=O2();(tn!==e||an!==t)&&(Jr=null,ao=$t()+500,oi(e,t));do try{Ow();break}catch(u){F2(e,u)}while(!0);Xf(),eu.current=i,et=s,zt!==null?t=0:(tn=null,an=0,t=Kt)}if(t!==0){if(t===2&&(s=jd(e),s!==0&&(r=s,t=tf(e,s))),t===1)throw n=ja,oi(e,0),Es(e,r),Ln(e,$t()),n;if(t===6)Es(e,r);else{if(s=e.current.alternate,!(r&30)&&!Bw(s)&&(t=ru(e,r),t===2&&(i=jd(e),i!==0&&(r=i,t=tf(e,i))),t===1))throw n=ja,oi(e,0),Es(e,r),Ln(e,$t()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(le(345));case 2:ei(e,Tn,Jr);break;case 3:if(Es(e,r),(r&130023424)===r&&(t=uh+500-$t(),10<t)){if($l(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){xn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Ld(ei.bind(null,e,Tn,Jr),t);break}ei(e,Tn,Jr);break;case 4:if(Es(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Nr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lw(r/1960))-r,10<r){e.timeoutHandle=Ld(ei.bind(null,e,Tn,Jr),r);break}ei(e,Tn,Jr);break;case 5:ei(e,Tn,Jr);break;default:throw Error(le(329))}}}return Ln(e,$t()),e.callbackNode===n?B2.bind(null,e):null}function tf(e,t){var n=ia;return e.current.memoizedState.isDehydrated&&(oi(e,t).flags|=256),e=ru(e,t),e!==2&&(t=Tn,Tn=n,t!==null&&nf(t)),e}function nf(e){Tn===null?Tn=e:Tn.push.apply(Tn,e)}function Bw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Mr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Es(e,t){for(t&=~lh,t&=~bu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Nr(t),r=1<<n;e[n]=-1,t&=~r}}function a1(e){if(et&6)throw Error(le(327));Xi();var t=$l(e,0);if(!(t&1))return Ln(e,$t()),null;var n=ru(e,t);if(e.tag!==0&&n===2){var r=jd(e);r!==0&&(t=r,n=tf(e,r))}if(n===1)throw n=ja,oi(e,0),Es(e,t),Ln(e,$t()),n;if(n===6)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ei(e,Tn,Jr),Ln(e,$t()),null}function ch(e,t){var n=et;et|=1;try{return e(t)}finally{et=n,et===0&&(ao=$t()+500,Cu&&Ws())}}function hi(e){Ns!==null&&Ns.tag===0&&!(et&6)&&Xi();var t=et;et|=1;var n=pr.transition,r=at;try{if(pr.transition=null,at=1,e)return e()}finally{at=r,pr.transition=n,et=t,!(et&6)&&Ws()}}function dh(){Xn=Ui.current,vt(Ui)}function oi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,fw(n)),zt!==null)for(n=zt.return;n!==null;){var r=n;switch(Wf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gl();break;case 3:io(),vt(In),vt(pn),eh();break;case 5:Zf(r);break;case 4:io();break;case 13:vt(jt);break;case 19:vt(jt);break;case 10:Kf(r.type._context);break;case 22:case 23:dh()}n=n.return}if(tn=e,zt=e=Bs(e.current,null),an=Xn=t,Kt=0,ja=null,lh=bu=fi=0,Tn=ia=null,ni!==null){for(t=0;t<ni.length;t++)if(n=ni[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ni=null}return e}function F2(e,t){do{var n=zt;try{if(Xf(),Al.current=Zl,ql){for(var r=Nt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ql=!1}if(di=0,en=Yt=Nt=null,ra=!1,Ea=0,ah.current=null,n===null||n.return===null){Kt=1,ja=t,zt=null;break}e:{var i=e,a=n.return,u=n,d=t;if(t=an,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,m=u,w=m.tag;if(!(m.mode&1)&&(w===0||w===11||w===15)){var S=m.alternate;S?(m.updateQueue=S.updateQueue,m.memoizedState=S.memoizedState,m.lanes=S.lanes):(m.updateQueue=null,m.memoizedState=null)}var _=Xm(a);if(_!==null){_.flags&=-257,Km(_,a,u,i,t),_.mode&1&&Ym(i,h,t),t=_,d=h;var B=t.updateQueue;if(B===null){var O=new Set;O.add(d),t.updateQueue=O}else B.add(d);break e}else{if(!(t&1)){Ym(i,h,t),fh();break e}d=Error(le(426))}}else if(At&&u.mode&1){var X=Xm(a);if(X!==null){!(X.flags&65536)&&(X.flags|=256),Km(X,a,u,i,t),Vf(oo(d,u));break e}}i=d=oo(d,u),Kt!==4&&(Kt=2),ia===null?ia=[i]:ia.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var C=x2(i,d,t);Um(i,C);break e;case 1:u=d;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Rs===null||!Rs.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var E=S2(i,u,t);Um(i,E);break e}}i=i.return}while(i!==null)}D2(n)}catch(j){t=j,zt===n&&n!==null&&(zt=n=n.return);continue}break}while(!0)}function O2(){var e=eu.current;return eu.current=Zl,e===null?Zl:e}function fh(){(Kt===0||Kt===3||Kt===2)&&(Kt=4),tn===null||!(fi&268435455)&&!(bu&268435455)||Es(tn,an)}function ru(e,t){var n=et;et|=2;var r=O2();(tn!==e||an!==t)&&(Jr=null,oi(e,t));do try{Fw();break}catch(s){F2(e,s)}while(!0);if(Xf(),et=n,eu.current=r,zt!==null)throw Error(le(261));return tn=null,an=0,Kt}function Fw(){for(;zt!==null;)$2(zt)}function Ow(){for(;zt!==null&&!u4();)$2(zt)}function $2(e){var t=z2(e.alternate,e,Xn);e.memoizedProps=e.pendingProps,t===null?D2(e):zt=t,ah.current=null}function D2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Tw(n,t),n!==null){n.flags&=32767,zt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Kt=6,zt=null;return}}else if(n=Mw(n,t,Xn),n!==null){zt=n;return}if(t=t.sibling,t!==null){zt=t;return}zt=t=e}while(t!==null);Kt===0&&(Kt=5)}function ei(e,t,n){var r=at,s=pr.transition;try{pr.transition=null,at=1,$w(e,t,n,r)}finally{pr.transition=s,at=r}return null}function $w(e,t,n,r){do Xi();while(Ns!==null);if(et&6)throw Error(le(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(w4(e,i),e===tn&&(zt=tn=null,an=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||cl||(cl=!0,H2(Ol,function(){return Xi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=pr.transition,pr.transition=null;var a=at;at=1;var u=et;et|=4,ah.current=null,Iw(e,n),R2(n,e),iw(Id),Dl=!!Pd,Id=Pd=null,e.current=n,Rw(n),c4(),et=u,at=a,pr.transition=i}else e.current=n;if(cl&&(cl=!1,Ns=e,nu=s),i=e.pendingLanes,i===0&&(Rs=null),h4(n.stateNode),Ln(e,$t()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(tu)throw tu=!1,e=Zd,Zd=null,e;return nu&1&&e.tag!==0&&Xi(),i=e.pendingLanes,i&1?e===ef?oa++:(oa=0,ef=e):oa=0,Ws(),null}function Xi(){if(Ns!==null){var e=xg(nu),t=pr.transition,n=at;try{if(pr.transition=null,at=16>e?16:e,Ns===null)var r=!1;else{if(e=Ns,Ns=null,nu=0,et&6)throw Error(le(331));var s=et;for(et|=4,ke=e.current;ke!==null;){var i=ke,a=i.child;if(ke.flags&16){var u=i.deletions;if(u!==null){for(var d=0;d<u.length;d++){var h=u[d];for(ke=h;ke!==null;){var m=ke;switch(m.tag){case 0:case 11:case 15:sa(8,m,i)}var w=m.child;if(w!==null)w.return=m,ke=w;else for(;ke!==null;){m=ke;var S=m.sibling,_=m.return;if(T2(m),m===h){ke=null;break}if(S!==null){S.return=_,ke=S;break}ke=_}}}var B=i.alternate;if(B!==null){var O=B.child;if(O!==null){B.child=null;do{var X=O.sibling;O.sibling=null,O=X}while(O!==null)}}ke=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ke=a;else e:for(;ke!==null;){if(i=ke,i.flags&2048)switch(i.tag){case 0:case 11:case 15:sa(9,i,i.return)}var C=i.sibling;if(C!==null){C.return=i.return,ke=C;break e}ke=i.return}}var g=e.current;for(ke=g;ke!==null;){a=ke;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,ke=y;else e:for(a=g;ke!==null;){if(u=ke,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Nu(9,u)}}catch(j){Lt(u,u.return,j)}if(u===a){ke=null;break e}var E=u.sibling;if(E!==null){E.return=u.return,ke=E;break e}ke=u.return}}if(et=s,Ws(),Vr&&typeof Vr.onPostCommitFiberRoot=="function")try{Vr.onPostCommitFiberRoot(xu,e)}catch{}r=!0}return r}finally{at=n,pr.transition=t}}return!1}function l1(e,t,n){t=oo(n,t),t=x2(e,t,1),e=Is(e,t,1),t=xn(),e!==null&&(Ia(e,1,t),Ln(e,t))}function Lt(e,t,n){if(e.tag===3)l1(e,e,n);else for(;t!==null;){if(t.tag===3){l1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rs===null||!Rs.has(r))){e=oo(n,e),e=S2(t,e,1),t=Is(t,e,1),e=xn(),t!==null&&(Ia(t,1,e),Ln(t,e));break}}t=t.return}}function Dw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=xn(),e.pingedLanes|=e.suspendedLanes&n,tn===e&&(an&n)===n&&(Kt===4||Kt===3&&(an&130023424)===an&&500>$t()-uh?oi(e,0):lh|=n),Ln(e,t)}function U2(e,t){t===0&&(e.mode&1?(t=el,el<<=1,!(el&130023424)&&(el=4194304)):t=1);var n=xn();e=cs(e,t),e!==null&&(Ia(e,t,n),Ln(e,n))}function Uw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),U2(e,n)}function zw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(le(314))}r!==null&&r.delete(t),U2(e,n)}var z2;z2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||In.current)Pn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Pn=!1,bw(e,t,n);Pn=!!(e.flags&131072)}else Pn=!1,At&&t.flags&1048576&&Vg(t,Yl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Cl(e,t),e=t.pendingProps;var s=no(t,pn.current);Yi(t,n),s=nh(null,t,r,e,s,n);var i=rh();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rn(r)?(i=!0,Wl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Jf(t),s.updater=ju,t.stateNode=s,s._reactInternals=t,zd(t,r,e,n),t=Wd(null,t,r,!0,i,n)):(t.tag=0,At&&i&&Gf(t),wn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Cl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Gw(r),e=Er(r,e),s){case 0:t=Gd(null,t,r,e,n);break e;case 1:t=qm(null,t,r,e,n);break e;case 11:t=Qm(null,t,r,e,n);break e;case 14:t=Jm(null,t,r,Er(r.type,e),n);break e}throw Error(le(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Gd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),qm(e,t,r,s,n);case 3:e:{if(C2(t),e===null)throw Error(le(387));r=t.pendingProps,i=t.memoizedState,s=i.element,qg(e,t),Ql(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=oo(Error(le(423)),t),t=Zm(e,t,r,n,s);break e}else if(r!==s){s=oo(Error(le(424)),t),t=Zm(e,t,r,n,s);break e}else for(Kn=Ps(t.stateNode.containerInfo.firstChild),Qn=t,At=!0,_r=null,n=Qg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ro(),r===s){t=ds(e,t,n);break e}wn(e,t,r,n)}t=t.child}return t;case 5:return Zg(t),e===null&&$d(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Rd(r,s)?a=null:i!==null&&Rd(r,i)&&(t.flags|=32),E2(e,t),wn(e,t,a,n),t.child;case 6:return e===null&&$d(t),null;case 13:return _2(e,t,n);case 4:return qf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=so(t,null,r,n):wn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Qm(e,t,r,s,n);case 7:return wn(e,t,t.pendingProps,n),t.child;case 8:return wn(e,t,t.pendingProps.children,n),t.child;case 12:return wn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,ht(Xl,r._currentValue),r._currentValue=a,i!==null)if(Mr(i.value,a)){if(i.children===s.children&&!In.current){t=ds(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var u=i.dependencies;if(u!==null){a=i.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=ss(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?d.next=d:(d.next=m.next,m.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),Dd(i.return,n,t),u.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(le(341));a.lanes|=n,u=a.alternate,u!==null&&(u.lanes|=n),Dd(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}wn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Yi(t,n),s=mr(s),r=r(s),t.flags|=1,wn(e,t,r,n),t.child;case 14:return r=t.type,s=Er(r,t.pendingProps),s=Er(r.type,s),Jm(e,t,r,s,n);case 15:return k2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Cl(e,t),t.tag=1,Rn(r)?(e=!0,Wl(t)):e=!1,Yi(t,n),w2(t,r,s),zd(t,r,s,n),Wd(null,t,r,!0,e,n);case 19:return j2(e,t,n);case 22:return A2(e,t,n)}throw Error(le(156,t.tag))};function H2(e,t){return gg(e,t)}function Hw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(e,t,n,r){return new Hw(e,t,n,r)}function hh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gw(e){if(typeof e=="function")return hh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Pf)return 11;if(e===If)return 14}return 2}function Bs(e,t){var n=e.alternate;return n===null?(n=fr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nl(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")hh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Ti:return ai(n.children,s,i,t);case Tf:a=8,s|=8;break;case fd:return e=fr(12,n,t,s|2),e.elementType=fd,e.lanes=i,e;case hd:return e=fr(13,n,t,s),e.elementType=hd,e.lanes=i,e;case pd:return e=fr(19,n,t,s),e.elementType=pd,e.lanes=i,e;case Z0:return Mu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case J0:a=10;break e;case q0:a=9;break e;case Pf:a=11;break e;case If:a=14;break e;case xs:a=16,r=null;break e}throw Error(le(130,e==null?e:typeof e,""))}return t=fr(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ai(e,t,n,r){return e=fr(7,e,r,t),e.lanes=n,e}function Mu(e,t,n,r){return e=fr(22,e,r,t),e.elementType=Z0,e.lanes=n,e.stateNode={isHidden:!1},e}function zc(e,t,n){return e=fr(6,e,null,t),e.lanes=n,e}function Hc(e,t,n){return t=fr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ww(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ac(0),this.expirationTimes=Ac(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ac(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ph(e,t,n,r,s,i,a,u,d){return e=new Ww(e,t,n,u,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=fr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jf(i),e}function Vw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function G2(e){if(!e)return Ds;e=e._reactInternals;e:{if(yi(e)!==e||e.tag!==1)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(le(171))}if(e.tag===1){var n=e.type;if(Rn(n))return Gg(e,n,t)}return t}function W2(e,t,n,r,s,i,a,u,d){return e=ph(n,r,!0,e,s,i,a,u,d),e.context=G2(null),n=e.current,r=xn(),s=Ls(n),i=ss(r,s),i.callback=t??null,Is(n,i,s),e.current.lanes=s,Ia(e,s,r),Ln(e,r),e}function Tu(e,t,n,r){var s=t.current,i=xn(),a=Ls(s);return n=G2(n),t.context===null?t.context=n:t.pendingContext=n,t=ss(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Is(s,t,a),e!==null&&(br(e,s,a,i),kl(e,s,a)),a}function su(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function u1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function mh(e,t){u1(e,t),(e=e.alternate)&&u1(e,t)}function Yw(){return null}var V2=typeof reportError=="function"?reportError:function(e){console.error(e)};function gh(e){this._internalRoot=e}Pu.prototype.render=gh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(le(409));Tu(e,t,null,null)};Pu.prototype.unmount=gh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hi(function(){Tu(null,e,null,null)}),t[us]=null}};function Pu(e){this._internalRoot=e}Pu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ag();e={blockedOn:null,target:e,priority:t};for(var n=0;n<As.length&&t!==0&&t<As[n].priority;n++);As.splice(n,0,e),n===0&&Cg(e)}};function yh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Iu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function c1(){}function Xw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=su(a);i.call(h)}}var a=W2(t,r,e,0,null,!1,!1,"",c1);return e._reactRootContainer=a,e[us]=a.current,wa(e.nodeType===8?e.parentNode:e),hi(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var u=r;r=function(){var h=su(d);u.call(h)}}var d=ph(e,0,!1,null,null,!1,!1,"",c1);return e._reactRootContainer=d,e[us]=d.current,wa(e.nodeType===8?e.parentNode:e),hi(function(){Tu(t,d,n,r)}),d}function Ru(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var u=s;s=function(){var d=su(a);u.call(d)}}Tu(t,a,e,s)}else a=Xw(n,t,e,s,r);return su(a)}Sg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Xo(t.pendingLanes);n!==0&&(Bf(t,n|1),Ln(t,$t()),!(et&6)&&(ao=$t()+500,Ws()))}break;case 13:hi(function(){var r=cs(e,1);if(r!==null){var s=xn();br(r,e,1,s)}}),mh(e,1)}};Ff=function(e){if(e.tag===13){var t=cs(e,134217728);if(t!==null){var n=xn();br(t,e,134217728,n)}mh(e,134217728)}};kg=function(e){if(e.tag===13){var t=Ls(e),n=cs(e,t);if(n!==null){var r=xn();br(n,e,t,r)}mh(e,t)}};Ag=function(){return at};Eg=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Ed=function(e,t,n){switch(t){case"input":if(yd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Eu(r);if(!s)throw Error(le(90));tg(r),yd(r,s)}}}break;case"textarea":rg(e,n);break;case"select":t=n.value,t!=null&&Hi(e,!!n.multiple,t,!1)}};cg=ch;dg=hi;var Kw={usingClientEntryPoint:!1,Events:[La,Li,Eu,lg,ug,ch]},zo={findFiberByHostInstance:ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qw={bundleType:zo.bundleType,version:zo.version,rendererPackageName:zo.rendererPackageName,rendererConfig:zo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ps.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pg(e),e===null?null:e.stateNode},findFiberByHostInstance:zo.findFiberByHostInstance||Yw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dl.isDisabled&&dl.supportsFiber)try{xu=dl.inject(Qw),Vr=dl}catch{}}Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kw;Zn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yh(t))throw Error(le(200));return Vw(e,t,null,n)};Zn.createRoot=function(e,t){if(!yh(e))throw Error(le(299));var n=!1,r="",s=V2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ph(e,1,!1,null,null,n,!1,r,s),e[us]=t.current,wa(e.nodeType===8?e.parentNode:e),new gh(t)};Zn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(le(188)):(e=Object.keys(e).join(","),Error(le(268,e)));return e=pg(t),e=e===null?null:e.stateNode,e};Zn.flushSync=function(e){return hi(e)};Zn.hydrate=function(e,t,n){if(!Iu(t))throw Error(le(200));return Ru(null,e,t,!0,n)};Zn.hydrateRoot=function(e,t,n){if(!yh(e))throw Error(le(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=V2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=W2(t,null,e,1,n??null,s,!1,i,a),e[us]=t.current,wa(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Pu(t)};Zn.render=function(e,t,n){if(!Iu(t))throw Error(le(200));return Ru(null,e,t,!1,n)};Zn.unmountComponentAtNode=function(e){if(!Iu(e))throw Error(le(40));return e._reactRootContainer?(hi(function(){Ru(null,null,e,!1,function(){e._reactRootContainer=null,e[us]=null})}),!0):!1};Zn.unstable_batchedUpdates=ch;Zn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Iu(n))throw Error(le(200));if(e==null||e._reactInternals===void 0)throw Error(le(38));return Ru(e,t,n,!1,r)};Zn.version="18.3.1-next-f1338f8080-20240426";function Y2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Y2)}catch(e){console.error(e)}}Y2(),Y0.exports=Zn;var Jw=Y0.exports,d1=Jw;cd.createRoot=d1.createRoot,cd.hydrateRoot=d1.hydrateRoot;const Ki={},X2="production",f1={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-server.onrender.com/api",healthUrl:"https://cfg-server.onrender.com/health"}},K2=f1[X2]||f1.development,Lu=()=>{if(!(Ki!=null&&Ki.VITE_API_BASE_URL))return K2.baseUrl},qw=()=>{if(!(Ki!=null&&Ki.VITE_HEALTH_URL))return K2.healthUrl},Zw=async()=>{try{const e=await fetch(qw(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},ex=()=>X2;function tx({onStart:e}){const[t,n]=N.useState("1"),[r,s]=N.useState("individual"),[i,a]=N.useState("15"),[u,d]=N.useState({status:"checking",version:"...",commit:"...",healthy:!1});N.useEffect(()=>{const S=async()=>{const B=await Zw();d(B),console.log("[StartDialog] Server health:",B)};S();const _=setInterval(S,3e4);return()=>clearInterval(_)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const S={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(S)},m=()=>{window.close()},w=()=>u.status==="checking"?"checking":u.healthy?"healthy":"unhealthy";return l.jsx("div",{className:"dialog-overlay",children:l.jsxs("div",{className:"dialog-box",children:[l.jsxs("div",{className:"dialog-header",children:[l.jsx("h2",{children:"The Creative Game"}),l.jsxs("div",{className:`server-health-indicator ${w()}`,title:`Server: ${u.status}
Version: ${u.version}
Commit: ${u.commit}
Environment: ${ex()}`,children:[l.jsx("span",{className:"health-light"}),l.jsx("span",{className:"health-text",children:"Server"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"ID:"}),l.jsx("input",{type:"text",value:t,onChange:S=>n(S.target.value)})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Condition:"}),l.jsxs("select",{value:r,onChange:S=>s(S.target.value),children:[l.jsx("option",{value:"individual",children:"individual"}),l.jsx("option",{value:"group",children:"group"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Time (in minutes):"}),l.jsx("input",{type:"number",value:i,onChange:S=>a(S.target.value),min:"1"})]}),l.jsxs("div",{className:"dialog-buttons",children:[l.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),l.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),l.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),l.jsx("button",{className:"dialog-button cancel",onClick:m,children:"Cancel"})]})]})})}class h1{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const nx=.035;class rx{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=Lu(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),u=s-i;let d=0,h=0,m=0;n>=0&&n<60?(d=i,h=a,m=0):n<120?(d=a,h=i,m=0):n<180?(d=0,h=i,m=a):n<240?(d=0,h=a,m=i):n<300?(d=a,h=0,m=i):(d=i,h=0,m=a);const w=S=>{const _=Math.round((S+u)*255).toString(16);return _.length===1?"0"+_:_};return`#${w(d)}${w(h)}${w(m)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const u=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${u}

Please choose a different Session ID.`),this.stop(),new Error(u)):new Error(u)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/nx,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),u=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(S=>this.relativeToGrid(S)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:u,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:u,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(S=>this.relativeToGrid(S)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(S=>this.relativeToGrid(S)):null)),this.moves.push(h),this.persistMove(h).catch(S=>{console.error("[GameTracker] Failed to persist move to server:",S)});const m=this.getCurrentBraceletStatus(),w=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:u,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:m,lastKnownPlayer:w,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(S=>({status:S.status,elapsed:S.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(u=>u.timestamp>=s&&u.timestamp<=i);if(a.length>0){const u={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(u[h.status]=(u[h.status]||0)+1)});const d=Object.keys(u).reduce((h,m)=>u[h]>u[m]?h:m,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let Gc=null;const p1=()=>(Gc||(Gc=new rx),Gc),jr=.07,aa=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),_t=e=>Math.round(e*1e3)/1e3,sx=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[_t(i.position[0]-jr),_t(i.position[1])],[_t(i.position[0]+jr),_t(i.position[1])],[_t(i.position[0]),_t(i.position[1]-jr)],[_t(i.position[0]),_t(i.position[1]+jr)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},ix=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},rf=e=>e.map(t=>{const n=[],r=[[_t(t.position[0]-jr),_t(t.position[1])],[_t(t.position[0]+jr),_t(t.position[1])],[_t(t.position[0]),_t(t.position[1]-jr)],[_t(t.position[0]),_t(t.position[1]+jr)]];return e.forEach(s=>{r.forEach(i=>{_t(s.position[0])===i[0]&&_t(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),ox=e=>{const t=new Set;if(e.forEach((a,u)=>{a.forEach((d,h)=>{d&&t.add(`${u},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,u]=i.shift(),d=`${a},${u}`;s.has(d)||(s.add(d),n.forEach(([h,m])=>{const w=`${a+h},${u+m}`;t.has(w)&&!s.has(w)&&i.push([a+h,u+m])}))}return s.size===t.size},ax=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=jr)n.push(_t(i));const r=[];for(let i=-.7;i<0;i+=jr)r.push(_t(i));for(let i=0;i<=.77;i+=jr)r.push(_t(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const u=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);u!==-1&&d!==-1&&(s[d][u]=!0)}}),ox(s)},sf=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=ax(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},m1=e=>{if(e.length===0)return null;try{const t=e.map(m=>m[0]),n=e.map(m=>m[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(m=>{const w=Math.sqrt(Math.pow(m[0]-r,2)+Math.pow(m[1]-s,2));w<i&&(i=w,a=m)});const u=-a[0],d=-a[1],h=e.map(m=>[_t(m[0]+u),_t(m[1]+d)]);return h.sort((m,w)=>m[0]-w[0]||m[1]-w[1]),h}catch{return null}},lx=60,g1=.07,Wc=120;function ux({config:e,interfaceHidden:t=!1}){const[n,r]=N.useState(aa()),[s,i]=N.useState(null),[a,u]=N.useState({x:0,y:0}),[d,h]=N.useState(!0),[m,w]=N.useState(e.timeSeconds),[S,_]=N.useState(0),[B,O]=N.useState(null),[X,C]=N.useState(!0),[g,y]=N.useState(""),[E,j]=N.useState(!1),[T,D]=N.useState({blockSize:lx,bottomPadding:Wc}),H=N.useRef(null),se=N.useRef(new h1(e)),V=N.useRef(p1()),K=N.useRef(null),ee=N.useRef(Date.now()),q=N.useRef(Wc),te=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,Se=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,ve="The experiment is done. Thank you very much for your participation!",ye=N.useCallback(()=>{const P=H.current;if(!P)return;const U=P.offsetWidth,J=P.offsetHeight;if(!U||!J)return;const de=q.current||Wc;let $=Math.max(1,Math.min(U,J-de)),v=Math.max(38,Math.min($*g1*.95,$/4)),R=Math.max(v*2.5,110);$=Math.max(1,Math.min(U,J-R)),v=Math.max(38,Math.min($*g1*.95,$/4)),R=Math.max(v*2.5,110),q.current=R,D(b=>{const M=Math.abs(b.blockSize-v),F=Math.abs(b.bottomPadding-R);return M<.5&&F<.5?b:{blockSize:v,bottomPadding:R}})},[]);N.useEffect(()=>(y(te),(async()=>{try{V.current.start(),await V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(U){console.error("[GameCanvas] Failed to initialize tracker:",U),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{C(!0),y(ve),j(!0),V.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,V.current.stop()}),[]),N.useEffect(()=>{ye()},[ye,t]),N.useEffect(()=>{const P=()=>{ye()};return P(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[ye]),N.useEffect(()=>{if(!d&&m>0){const P=setInterval(()=>{w(U=>U<=1?(clearInterval(P),C(!0),y(ve),j(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):U-1)},1e3);return()=>clearInterval(P)}},[d,m]),N.useEffect(()=>{r(P=>sf(rf(P),d))},[d]);const ne=()=>(Date.now()-ee.current)/1e3,oe=(P,U)=>{const J=H.current;if(!J)return 0;const de=J.offsetHeight-q.current,$=Math.min(J.offsetWidth,de),v=U==="x"?(J.offsetWidth-$)/2:(J.offsetHeight-q.current-$)/2;return(P-v)/$-.5},re=(P,U)=>{const J=H.current;if(!J)return 0;const de=J.offsetHeight-q.current,$=Math.min(J.offsetWidth,de),v=U==="x"?(J.offsetWidth-$)/2:(J.offsetHeight-q.current-$)/2;return(P+.5)*$+v},we=P=>{var $,v,R,b;const U=H.current.getBoundingClientRect(),J=P.clientX!==void 0?P.clientX:(v=($=P.touches)==null?void 0:$[0])==null?void 0:v.clientX,de=P.clientY!==void 0?P.clientY:(b=(R=P.touches)==null?void 0:R[0])==null?void 0:b.clientY;return{x:J-U.left,y:de-U.top}},Te=(P,U)=>{const J=n.find(R=>R.id===U);if(!J||!J.canMove)return;P.preventDefault();const de=we(P),$=re(J.position[0],"x"),v=re(J.position[1],"y");K.current=Date.now(),i(U),u({x:de.x-$,y:de.y-v})},Le=P=>{if(s===null)return;P.preventDefault();const U=we(P),J=oe(U.x-a.x,"x"),de=oe(U.y-a.y,"y");r($=>$.map(v=>v.id===s?{...v,position:[J,de]}:v))},$e=()=>{try{const P=window.braceletDetectorVideo;if(!P||!P.videoWidth||P.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const U=document.createElement("canvas"),J=640,de=480;let $=P.videoWidth,v=P.videoHeight;const R=$/v;return $>J&&($=J,v=$/R),v>de&&(v=de,$=v*R),U.width=Math.floor($),U.height=Math.floor(v),U.getContext("2d").drawImage(P,0,0,U.width,U.height),U.toDataURL("image/jpeg",.6)}catch(P){return console.error("[GameCanvas] Error capturing camera frame:",P),null}},Oe=()=>{if(s===null)return;const P=n.find(M=>M.id===s),U=sx(n,s),J=ix(U,P.position),de=K.current?(Date.now()-K.current)/1e3:0,$=n.map(M=>M.id===s?{...M,position:J}:M),v=$e(),R=window.currentBraceletStatus||"Unknown",b={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:ne(),unit:s,end_position:J,all_positions:$.map(M=>M.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:v,player:R};se.current.write(b),V.current.recordMove(b,de,v),r(M=>{const F=M.map(z=>z.id===s?{...z,position:J}:z);return sf(rf(F),d)}),i(null),K.current=null},De=()=>{const P=n.map(b=>b.position),U=m1(P),J=S+1,de=$e(),$=window.currentBraceletStatus||"Unknown",v={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:ne(),unit:null,end_position:null,all_positions:null,gallery_shape_number:J,gallery:P,gallery_normalized:U,camera_frame:de,player:$};se.current.write(v),V.current.recordMove(v,0,de);const R=Y();O(R),_(J)},Y=()=>{const P=document.createElement("canvas");P.width=400,P.height=400;const U=P.getContext("2d");U.fillStyle="#000",U.fillRect(0,0,400,400);const J=n.map($=>$.position),de=m1(J);return de&&de.forEach($=>{const v=($[0]+.5)*400,R=($[1]+.5)*400;U.fillStyle="green",U.fillRect(v-15,R-15,30,30)}),P.toDataURL()},Q=N.useCallback(P=>{P.key==="p"&&d?(h(!1),C(!0),y(Se),ee.current=Date.now(),r(aa()),O(null),_(0),se.current=new h1(e),V.current.stop(),V.current=p1(),V.current.start(),V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):P.key==="q"&&!d&&(C(!0),y(ve),j(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);N.useEffect(()=>(window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)),[Q]);const me=()=>{if(E&&g===ve){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&g===Se)try{const P=new(window.AudioContext||window.webkitAudioContext),U=P.createOscillator(),J=P.createGain();U.connect(J),J.connect(P.destination),U.frequency.setValueAtTime(800,P.currentTime),U.frequency.setValueAtTime(600,P.currentTime+.15),J.gain.setValueAtTime(.3,P.currentTime),J.gain.exponentialRampToValueAtTime(.01,P.currentTime+.3),U.start(P.currentTime),U.stop(P.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(P){console.error("[GameCanvas] Error playing sound:",P)}C(!1)},ue=P=>{P.preventDefault()};return l.jsxs("div",{className:"game-canvas",ref:H,style:{"--block-size":`${T.blockSize}px`,"--bottom-padding":`${T.bottomPadding}px`},onMouseMove:Le,onMouseUp:Oe,onMouseLeave:Oe,onTouchMove:Le,onTouchEnd:Oe,onTouchCancel:Oe,onContextMenu:ue,children:[l.jsx("div",{className:"gallery",onClick:De,children:l.jsx("div",{className:"gallery-frame",children:B?l.jsx("img",{src:B,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&l.jsxs("div",{className:"timer",children:["Time: ",Math.floor(m/60),":",(m%60).toString().padStart(2,"0")]}),n.map(P=>l.jsx("div",{className:`block ${P.canMove?"movable":""}`,style:{left:`${re(P.position[0],"x")}px`,top:`${re(P.position[1],"y")}px`,backgroundColor:P.color||"green",cursor:P.canMove?"grab":"default"},onMouseDown:U=>Te(U,P.id),onTouchStart:U=>Te(U,P.id)},P.id)),X&&l.jsx("div",{className:"message-overlay",onClick:me,children:l.jsxs("div",{className:"message-box",children:[g,l.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var iu={};(function(){var e;function t(o){var c=0;return function(){return c<o.length?{done:!1,value:o[c++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof yc=="object"&&yc];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,c){if(c)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var x=o[p];if(!(x in f))break e;f=f[x]}o=o[o.length-1],p=f[o],c=c(p),c!=p&&c!=null&&n(f,o,{configurable:!0,writable:!0,value:c})}}i("Symbol",function(o){function c(A){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new f(p+(A||"")+"_"+x++,A)}function f(A,k){this.h=A,n(this,"description",{configurable:!0,writable:!0,value:k})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",x=0;return c}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<c.length;f++){var p=s[c[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function u(o){var c=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return c?c.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=u(o);for(var c,f=[];!(c=o.next()).done;)f.push(c.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,c){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var x in p)Object.prototype.hasOwnProperty.call(p,x)&&(o[x]=p[x])}return o};i("Object.assign",function(o){return o||h});var m=typeof Object.create=="function"?Object.create:function(o){function c(){}return c.prototype=o,new c},w;if(typeof Object.setPrototypeOf=="function")w=Object.setPrototypeOf;else{var S;e:{var _={a:!0},B={};try{B.__proto__=_,S=B.a;break e}catch{}S=!1}w=S?function(o,c){if(o.__proto__=c,o.__proto__!==c)throw new TypeError(o+" is not extensible");return o}:null}var O=w;function X(o,c){if(o.prototype=m(c.prototype),o.prototype.constructor=o,O)O(o,c);else for(var f in c)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(c,f);p&&Object.defineProperty(o,f,p)}else o[f]=c[f];o.ya=c.prototype}function C(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function g(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}C.prototype.u=function(o){this.i=o};function y(o,c){o.l={ma:c,na:!0},o.h=o.s||o.v}C.prototype.return=function(o){this.l={return:o},this.h=this.v};function E(o,c,f){return o.h=f,{value:c}}function j(o){this.h=new C,this.i=o}function T(o,c){g(o.h);var f=o.h.j;return f?D(o,"return"in f?f.return:function(p){return{value:p,done:!0}},c,o.h.return):(o.h.return(c),H(o))}function D(o,c,f,p){try{var x=c.call(o.h.j,f);if(!(x instanceof Object))throw new TypeError("Iterator result "+x+" is not an object");if(!x.done)return o.h.m=!1,x;var A=x.value}catch(k){return o.h.j=null,y(o.h,k),H(o)}return o.h.j=null,p.call(o.h,A),H(o)}function H(o){for(;o.h.h;)try{var c=o.i(o.h);if(c)return o.h.m=!1,{value:c.value,done:!1}}catch(f){o.h.i=void 0,y(o.h,f)}if(o.h.m=!1,o.h.l){if(c=o.h.l,o.h.l=null,c.na)throw c.ma;return{value:c.return,done:!0}}return{value:void 0,done:!0}}function se(o){this.next=function(c){return g(o.h),o.h.j?c=D(o,o.h.j.next,c,o.h.u):(o.h.u(c),c=H(o)),c},this.throw=function(c){return g(o.h),o.h.j?c=D(o,o.h.j.throw,c,o.h.u):(y(o.h,c),c=H(o)),c},this.return=function(c){return T(o,c)},this[Symbol.iterator]=function(){return this}}function V(o){function c(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,x){function A(k){k.done?p(k.value):Promise.resolve(k.value).then(c,f).then(A,x)}A(o.next())})}function K(o){return V(new se(new j(o)))}i("Promise",function(o){function c(k){this.i=0,this.j=void 0,this.h=[],this.u=!1;var I=this.l();try{k(I.resolve,I.reject)}catch(G){I.reject(G)}}function f(){this.h=null}function p(k){return k instanceof c?k:new c(function(I){I(k)})}if(o)return o;f.prototype.i=function(k){if(this.h==null){this.h=[];var I=this;this.j(function(){I.m()})}this.h.push(k)};var x=s.setTimeout;f.prototype.j=function(k){x(k,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var k=this.h;this.h=[];for(var I=0;I<k.length;++I){var G=k[I];k[I]=null;try{G()}catch(ie){this.l(ie)}}}this.h=null},f.prototype.l=function(k){this.j(function(){throw k})},c.prototype.l=function(){function k(ie){return function(pe){G||(G=!0,ie.call(I,pe))}}var I=this,G=!1;return{resolve:k(this.I),reject:k(this.m)}},c.prototype.I=function(k){if(k===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(k instanceof c)this.L(k);else{e:switch(typeof k){case"object":var I=k!=null;break e;case"function":I=!0;break e;default:I=!1}I?this.F(k):this.s(k)}},c.prototype.F=function(k){var I=void 0;try{I=k.then}catch(G){this.m(G);return}typeof I=="function"?this.M(I,k):this.s(k)},c.prototype.m=function(k){this.v(2,k)},c.prototype.s=function(k){this.v(1,k)},c.prototype.v=function(k,I){if(this.i!=0)throw Error("Cannot settle("+k+", "+I+"): Promise already settled in state"+this.i);this.i=k,this.j=I,this.i===2&&this.K(),this.H()},c.prototype.K=function(){var k=this;x(function(){if(k.D()){var I=s.console;typeof I<"u"&&I.error(k.j)}},1)},c.prototype.D=function(){if(this.u)return!1;var k=s.CustomEvent,I=s.Event,G=s.dispatchEvent;return typeof G>"u"?!0:(typeof k=="function"?k=new k("unhandledrejection",{cancelable:!0}):typeof I=="function"?k=new I("unhandledrejection",{cancelable:!0}):(k=s.document.createEvent("CustomEvent"),k.initCustomEvent("unhandledrejection",!1,!0,k)),k.promise=this,k.reason=this.j,G(k))},c.prototype.H=function(){if(this.h!=null){for(var k=0;k<this.h.length;++k)A.i(this.h[k]);this.h=null}};var A=new f;return c.prototype.L=function(k){var I=this.l();k.T(I.resolve,I.reject)},c.prototype.M=function(k,I){var G=this.l();try{k.call(I,G.resolve,G.reject)}catch(ie){G.reject(ie)}},c.prototype.then=function(k,I){function G(Ne,xe){return typeof Ne=="function"?function(Fe){try{ie(Ne(Fe))}catch(We){pe(We)}}:xe}var ie,pe,Be=new c(function(Ne,xe){ie=Ne,pe=xe});return this.T(G(k,ie),G(I,pe)),Be},c.prototype.catch=function(k){return this.then(void 0,k)},c.prototype.T=function(k,I){function G(){switch(ie.i){case 1:k(ie.j);break;case 2:I(ie.j);break;default:throw Error("Unexpected state: "+ie.i)}}var ie=this;this.h==null?A.i(G):this.h.push(G),this.u=!0},c.resolve=p,c.reject=function(k){return new c(function(I,G){G(k)})},c.race=function(k){return new c(function(I,G){for(var ie=u(k),pe=ie.next();!pe.done;pe=ie.next())p(pe.value).T(I,G)})},c.all=function(k){var I=u(k),G=I.next();return G.done?p([]):new c(function(ie,pe){function Be(Fe){return function(We){Ne[Fe]=We,xe--,xe==0&&ie(Ne)}}var Ne=[],xe=0;do Ne.push(void 0),xe++,p(G.value).T(Be(Ne.length-1),pe),G=I.next();while(!G.done)})},c});function ee(o,c){o instanceof String&&(o+="");var f=0,p=!1,x={next:function(){if(!p&&f<o.length){var A=f++;return{value:c(A,o[A]),done:!1}}return p=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.keys",function(o){return o||function(){return ee(this,function(c){return c})}}),i("Array.prototype.fill",function(o){return o||function(c,f,p){var x=this.length||0;for(0>f&&(f=Math.max(0,x+f)),(p==null||p>x)&&(p=x),p=Number(p),0>p&&(p=Math.max(0,x+p)),f=Number(f||0);f<p;f++)this[f]=c;return this}});function q(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",q),i("Uint8Array.prototype.fill",q),i("Uint8ClampedArray.prototype.fill",q),i("Int16Array.prototype.fill",q),i("Uint16Array.prototype.fill",q),i("Int32Array.prototype.fill",q),i("Uint32Array.prototype.fill",q),i("Float32Array.prototype.fill",q),i("Float64Array.prototype.fill",q),i("Object.is",function(o){return o||function(c,f){return c===f?c!==0||1/c===1/f:c!==c&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(c,f){var p=this;p instanceof String&&(p=String(p));var x=p.length;for(f=f||0,0>f&&(f=Math.max(f+x,0));f<x;f++){var A=p[f];if(A===c||Object.is(A,c))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(c,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(c,f||0)!==-1}});var te=this||self;function Se(o,c){o=o.split(".");var f=te;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||c===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=c}function ve(o){var c;e:{if((c=te.navigator)&&(c=c.userAgent))break e;c=""}return c.indexOf(o)!=-1}var ye=Array.prototype.map?function(o,c){return Array.prototype.map.call(o,c,void 0)}:function(o,c){for(var f=o.length,p=Array(f),x=typeof o=="string"?o.split(""):o,A=0;A<f;A++)A in x&&(p[A]=c.call(void 0,x[A],A,o));return p},ne={},oe=null;function re(o){var c=o.length,f=3*c/4;f%3?f=Math.floor(f):"=.".indexOf(o[c-1])!=-1&&(f="=.".indexOf(o[c-2])!=-1?f-2:f-1);var p=new Uint8Array(f),x=0;return we(o,function(A){p[x++]=A}),x!==f?p.subarray(0,x):p}function we(o,c){function f(G){for(;p<o.length;){var ie=o.charAt(p++),pe=oe[ie];if(pe!=null)return pe;if(!/^[\s\xa0]*$/.test(ie))throw Error("Unknown base64 encoding at char: "+ie)}return G}Te();for(var p=0;;){var x=f(-1),A=f(0),k=f(64),I=f(64);if(I===64&&x===-1)break;c(x<<2|A>>4),k!=64&&(c(A<<4&240|k>>2),I!=64&&c(k<<6&192|I))}}function Te(){if(!oe){oe={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(c[f].split(""));ne[f]=p;for(var x=0;x<p.length;x++){var A=p[x];oe[A]===void 0&&(oe[A]=x)}}}}var Le=typeof Uint8Array<"u",$e=!(ve("Trident")||ve("MSIE"))&&typeof te.btoa=="function";function Oe(o){if(!$e){var c;c===void 0&&(c=0),Te(),c=ne[c];for(var f=Array(Math.floor(o.length/3)),p=c[64]||"",x=0,A=0;x<o.length-2;x+=3){var k=o[x],I=o[x+1],G=o[x+2],ie=c[k>>2];k=c[(k&3)<<4|I>>4],I=c[(I&15)<<2|G>>6],G=c[G&63],f[A++]=ie+k+I+G}switch(ie=0,G=p,o.length-x){case 2:ie=o[x+1],G=c[(ie&15)<<2]||p;case 1:o=o[x],f[A]=c[o>>2]+c[(o&3)<<4|ie>>4]+G+p}return f.join("")}for(c="";10240<o.length;)c+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return c+=String.fromCharCode.apply(null,o),btoa(c)}var De=RegExp("[-_.]","g");function Y(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Q(o){if(!$e)return re(o);De.test(o)&&(o=o.replace(De,Y)),o=atob(o);for(var c=new Uint8Array(o.length),f=0;f<o.length;f++)c[f]=o.charCodeAt(f);return c}var me;function ue(){return me||(me=new Uint8Array(0))}var P={},U=typeof Uint8Array.prototype.slice=="function",J=0,de=0;function $(o){var c=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),c&&(f=u(R(f,o)),c=f.next().value,o=f.next().value,f=c),J=f>>>0,de=o>>>0}var v=typeof BigInt=="function";function R(o,c){return c=~c,o?o=~o+1:c+=1,[o,c]}function b(o,c){this.i=o>>>0,this.h=c>>>0}function M(o){if(!o)return F||(F=new b(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)$(Number(o));else if(v)o=BigInt(o),J=Number(o&BigInt(4294967295))>>>0,de=Number(o>>BigInt(32)&BigInt(4294967295));else{var c=+(o[0]==="-");de=J=0;for(var f=o.length,p=c,x=(f-c)%6+c;x<=f;p=x,x+=6)p=Number(o.slice(p,x)),de*=1e6,J=1e6*J+p,4294967296<=J&&(de+=J/4294967296|0,J%=4294967296);c&&(c=u(R(J,de)),o=c.next().value,c=c.next().value,J=o,de=c)}return new b(J,de)}var F;function z(o,c){return Error("Invalid wire type: "+o+" (at position "+c+")")}function W(){return Error("Failed to read varint, encoding is invalid.")}function fe(o,c){return Error("Tried to read past the end of the data "+c+" > "+o)}function ge(){throw Error("Invalid UTF8")}function Ce(o,c){return c=String.fromCharCode.apply(null,c),o==null?c:o+c}var Ie=void 0,Ue,Ze=typeof TextDecoder<"u",nt,lt=typeof TextEncoder<"u",ut;function He(o){if(o!==P)throw Error("illegal external caller")}function ze(o,c){if(He(c),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ge(){return ut||(ut=new ze(null,P))}function qe(o){He(P);var c=o.V;return c=c==null||Le&&c!=null&&c instanceof Uint8Array?c:typeof c=="string"?Q(c):null,c==null?c:o.V=c}function xt(o){if(typeof o=="string")return{buffer:Q(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===ze)return{buffer:qe(o)||ue(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function $n(o,c){this.i=null,this.m=!1,this.h=this.j=this.l=0,mt(this,o,c)}function mt(o,c,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,c&&(c=xt(c),o.i=c.buffer,o.m=c.C,o.l=0,o.j=o.i.length,o.h=o.l)}$n.prototype.reset=function(){this.h=this.l};function Ut(o,c){if(o.h=c,c>o.j)throw fe(o.j,c)}function Tt(o){var c=o.i,f=o.h,p=c[f++],x=p&127;if(p&128&&(p=c[f++],x|=(p&127)<<7,p&128&&(p=c[f++],x|=(p&127)<<14,p&128&&(p=c[f++],x|=(p&127)<<21,p&128&&(p=c[f++],x|=p<<28,p&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128&&c[f++]&128)))))throw W();return Ut(o,f),x}function nn(o,c){if(0>c)throw Error("Tried to read a negative byte length: "+c);var f=o.h,p=f+c;if(p>o.j)throw fe(c,o.j-f);return o.h=p,f}var mn=[];function gn(){this.h=[]}gn.prototype.length=function(){return this.h.length},gn.prototype.end=function(){var o=this.h;return this.h=[],o};function yn(o,c,f){for(;0<f||127<c;)o.h.push(c&127|128),c=(c>>>7|f<<25)>>>0,f>>>=7;o.h.push(c)}function _n(o,c){for(;127<c;)o.h.push(c&127|128),c>>>=7;o.h.push(c)}function Qr(o,c){if(mn.length){var f=mn.pop();mt(f,o,c),o=f}else o=new $n(o,c);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(c)}Qr.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},Qr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Dn(o){var c=o.h;if(c.h==c.j)return!1;o.j=o.h.h;var f=Tt(o.h)>>>0;if(c=f>>>3,f&=7,!(0<=f&&5>=f))throw z(f,o.j);if(1>c)throw Error("Invalid field number: "+c+" (at position "+o.j+")");return o.l=c,o.i=f,!0}function Lr(o){switch(o.i){case 0:if(o.i!=0)Lr(o);else e:{o=o.h;for(var c=o.h,f=c+10,p=o.i;c<f;)if(!(p[c++]&128)){Ut(o,c);break e}throw W()}break;case 1:o=o.h,Ut(o,o.h+8);break;case 2:o.i!=2?Lr(o):(c=Tt(o.h)>>>0,o=o.h,Ut(o,o.h+c));break;case 5:o=o.h,Ut(o,o.h+4);break;case 3:c=o.l;do{if(!Dn(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=c)throw Error("Unmatched end-group tag");break}Lr(o)}while(!0);break;default:throw z(o.i,o.j)}}var Br=[];function gs(){this.j=[],this.i=0,this.h=new gn}function Qt(o,c){c.length!==0&&(o.j.push(c),o.i+=c.length)}function Mo(o,c){if(c=c.R){Qt(o,o.h.end());for(var f=0;f<c.length;f++)Qt(o,qe(c[f])||ue())}}var Un=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function sr(o,c){return Un?o[Un]|=c:o.A!==void 0?o.A|=c:(Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}}),c)}function Ks(o,c){Un?o[Un]&&(o[Un]&=~c):o.A!==void 0&&(o.A&=~c)}function St(o){var c;return Un?c=o[Un]:c=o.A,c??0}function zn(o,c){Un?o[Un]=c:o.A!==void 0?o.A=c:Object.defineProperties(o,{A:{value:c,configurable:!0,writable:!0,enumerable:!1}})}function wi(o){return sr(o,1),o}function za(o,c){zn(c,(o|0)&-51)}function Qs(o,c){zn(c,(o|18)&-41)}var xi={};function Js(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var L,ce=[];zn(ce,23),L=Object.freeze(ce);function ae(o){if(St(o.o)&2)throw Error("Cannot mutate an immutable Message")}function Z(o){var c=o.length;(c=c?o[c-1]:void 0)&&Js(c)?c.g=1:(c={},o.push((c.g=1,c)))}function he(o){var c=o.i+o.G;return o.B||(o.B=o.o[c]={})}function je(o,c){return c===-1?null:c>=o.i?o.B?o.B[c]:void 0:o.o[c+o.G]}function Xe(o,c,f,p){ae(o),Qe(o,c,f,p)}function Qe(o,c,f,p){o.j&&(o.j=void 0),c>=o.i||p?he(o)[c]=f:(o.o[c+o.G]=f,(o=o.B)&&c in o&&delete o[c])}function Re(o,c,f,p){var x=je(o,c);Array.isArray(x)||(x=L);var A=St(x);if(A&1||wi(x),p)A&2||sr(x,2),f&1||Object.freeze(x);else{p=!(f&2);var k=A&2;f&1||!k?p&&A&16&&!k&&Ks(x,16):(x=wi(Array.prototype.slice.call(x)),Qe(o,c,x))}return x}function Ve(o,c){var f=je(o,c),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&Qe(o,c,p),p}function Vt(o,c,f,p,x){o.h||(o.h={});var A=o.h[f],k=Re(o,f,3,x);if(!A){var I=k;A=[];var G=!!(St(o.o)&16);k=!!(St(I)&2);var ie=I;!x&&k&&(I=Array.prototype.slice.call(I));for(var pe=k,Be=0;Be<I.length;Be++){var Ne=I[Be],xe=c,Fe=!1;if(Fe=Fe===void 0?!1:Fe,Ne=Array.isArray(Ne)?new xe(Ne):Fe?new xe:void 0,Ne!==void 0){xe=Ne.o;var We=Fe=St(xe);k&&(We|=2),G&&(We|=16),We!=Fe&&zn(xe,We),xe=We,pe=pe||!!(2&xe),A.push(Ne)}}return o.h[f]=A,G=St(I),c=G|33,c=pe?c&-9:c|8,G!=c&&(pe=I,Object.isFrozen(pe)&&(pe=Array.prototype.slice.call(pe)),zn(pe,c),I=pe),ie!==I&&Qe(o,f,I),(x||p&&k)&&sr(A,2),p&&Object.freeze(A),A}return x||(x=Object.isFrozen(A),p&&!x?Object.freeze(A):!p&&x&&(A=Array.prototype.slice.call(A),o.h[f]=A)),A}function jn(o,c,f){var p=!!(St(o.o)&2);if(c=Vt(o,c,f,p,p),o=Re(o,f,3,p),!(p||St(o)&8)){for(p=0;p<c.length;p++){if(f=c[p],St(f.o)&2){var x=Mp(f,!1);x.j=f}else x=f;f!==x&&(c[p]=x,o[p]=x.o)}sr(o,8)}return c}function Pt(o,c,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);Xe(o,c,f)}function Ha(o,c,f,p,x){ae(o);var A=Vt(o,f,c,!1,!1);return f=p??new f,o=Re(o,c,2,!1),x!=null?(A.splice(x,0,f),o.splice(x,0,f.o)):(A.push(f),o.push(f.o)),f.C()&&Ks(o,8),f}function Si(o,c){return o??c}function Nn(o,c,f){return f=f===void 0?0:f,Si(Ve(o,c),f)}var ki;function To(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(St(o)&128)return o=Array.prototype.slice.call(o),Z(o),o}else{if(Le&&o!=null&&o instanceof Uint8Array)return Oe(o);if(o instanceof ze){var c=o.V;return c==null?"":typeof c=="string"?c:o.V=Oe(c)}}}return o}function _p(o,c,f,p){if(o!=null){if(Array.isArray(o))o=uc(o,c,f,p!==void 0);else if(Js(o)){var x={},A;for(A in o)x[A]=_p(o[A],c,f,p);o=x}else o=c(o,p);return o}}function uc(o,c,f,p){var x=St(o);p=p?!!(x&16):void 0,o=Array.prototype.slice.call(o);for(var A=0;A<o.length;A++)o[A]=_p(o[A],c,f,p);return f(x,o),o}function Wv(o){return o.ja===xi?o.toJSON():To(o)}function Vv(o,c){o&128&&Z(c)}function jp(o,c,f){if(f=f===void 0?Qs:f,o!=null){if(Le&&o instanceof Uint8Array)return o.length?new ze(new Uint8Array(o),P):Ge();if(Array.isArray(o)){var p=St(o);return p&2?o:c&&!(p&32)&&(p&16||p===0)?(zn(o,p|2),o):(o=uc(o,jp,p&4?Qs:f,!0),c=St(o),c&4&&c&2&&Object.freeze(o),o)}return o.ja===xi?bp(o):o}}function Np(o,c,f,p,x,A,k){if(o=o.h&&o.h[f]){if(p=St(o),p&2?p=o:(A=ye(o,bp),Qs(p,A),Object.freeze(A),p=A),ae(c),k=p==null?L:wi([]),p!=null){for(A=!!p.length,o=0;o<p.length;o++){var I=p[o];A=A&&!(St(I.o)&2),k[o]=I.o}A=(A?8:0)|1,o=St(k),(o&A)!==A&&(Object.isFrozen(k)&&(k=Array.prototype.slice.call(k)),zn(k,o|A)),c.h||(c.h={}),c.h[f]=p}else c.h&&(c.h[f]=void 0);Qe(c,f,k,x)}else Xe(c,f,jp(p,A,k),x)}function bp(o){return St(o.o)&2||(o=Mp(o,!0),sr(o.o,2)),o}function Mp(o,c){var f=o.o,p=[];sr(p,16);var x=o.constructor.h;if(x&&p.push(x),x=o.B,x){p.length=f.length,p.fill(void 0,p.length,f.length);var A={};p[p.length-1]=A}St(f)&128&&Z(p),c=c||o.C()?Qs:za,A=o.constructor,ki=p,p=new A(p),ki=void 0,o.R&&(p.R=o.R.slice()),A=!!(St(f)&16);for(var k=x?f.length-1:f.length,I=0;I<k;I++)Np(o,p,I-o.G,f[I],!1,A,c);if(x)for(var G in x)Np(o,p,+G,x[G],!0,A,c);return p}function bn(o,c,f){o==null&&(o=ki),ki=void 0;var p=this.constructor.i||0,x=0<p,A=this.constructor.h,k=!1;if(o==null){o=A?[A]:[];var I=48,G=!0;x&&(p=0,I|=128),zn(o,I)}else{if(!Array.isArray(o)||A&&A!==o[0])throw Error();var ie=I=sr(o,0);if((G=(16&ie)!==0)&&((k=(32&ie)!==0)||(ie|=32)),x){if(128&ie)p=0;else if(0<o.length){var pe=o[o.length-1];if(Js(pe)&&"g"in pe){p=0,ie|=128,delete pe.g;var Be=!0,Ne;for(Ne in pe){Be=!1;break}Be&&o.pop()}}}else if(128&ie)throw Error();I!==ie&&zn(o,ie)}this.G=(A?0:-1)-p,this.h=void 0,this.o=o;e:{if(A=this.o.length,p=A-1,A&&(A=this.o[p],Js(A))){this.B=A,this.i=p-this.G;break e}c!==void 0&&-1<c?(this.i=Math.max(c,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!x&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){c=G&&!k&&!0,x=this.i;var xe;for(G=0;G<f.length;G++)k=f[G],k<x?(k+=this.G,(p=o[k])?Tp(p,c):o[k]=L):(xe||(xe=he(this)),(p=xe[k])?Tp(p,c):xe[k]=L)}}bn.prototype.toJSON=function(){return uc(this.o,Wv,Vv)},bn.prototype.C=function(){return!!(St(this.o)&2)};function Tp(o,c){if(Array.isArray(o)){var f=St(o),p=1;!c||f&2||(p|=16),(f&p)!==p&&zn(o,f|p)}}bn.prototype.ja=xi,bn.prototype.toString=function(){return this.o.toString()};function Pp(o,c,f){if(f){var p={},x;for(x in f){var A=f[x],k=A.qa;k||(p.J=A.wa||A.oa.W,A.ia?(p.aa=Fp(A.ia),k=function(I){return function(G,ie,pe){return I.J(G,ie,pe,I.aa)}}(p)):A.ka?(p.Z=Op(A.da.P,A.ka),k=function(I){return function(G,ie,pe){return I.J(G,ie,pe,I.Z)}}(p)):k=p.J,A.qa=k),k(c,o,A.da),p={J:p.J,aa:p.aa,Z:p.Z}}}Mo(c,o)}var Ga=Symbol();function Ip(o,c,f){return o[Ga]||(o[Ga]=function(p,x){return c(p,x,f)})}function Rp(o){var c=o[Ga];if(!c){var f=dc(o);c=function(p,x){return $p(p,x,f)},o[Ga]=c}return c}function Yv(o){var c=o.ia;if(c)return Rp(c);if(c=o.va)return Ip(o.da.P,c,o.ka)}function Xv(o){var c=Yv(o),f=o.da,p=o.oa.U;return c?function(x,A){return p(x,A,f,c)}:function(x,A){return p(x,A,f)}}function Lp(o,c){var f=o[c];return typeof f=="function"&&f.length===0&&(f=f(),o[c]=f),Array.isArray(f)&&(Io in f||Po in f||0<f.length&&typeof f[0]=="function")?f:void 0}function Bp(o,c,f,p,x,A){c.P=o[0];var k=1;if(o.length>k&&typeof o[k]!="number"){var I=o[k++];f(c,I)}for(;k<o.length;){f=o[k++];for(var G=k+1;G<o.length&&typeof o[G]!="number";)G++;switch(I=o[k++],G-=k,G){case 0:p(c,f,I);break;case 1:(G=Lp(o,k))?(k++,x(c,f,I,G)):p(c,f,I,o[k++]);break;case 2:G=k++,G=Lp(o,G),x(c,f,I,G,o[k++]);break;case 3:A(c,f,I,o[k++],o[k++],o[k++]);break;case 4:A(c,f,I,o[k++],o[k++],o[k++],o[k++]);break;default:throw Error("unexpected number of binary field arguments: "+G)}}return c}var Wa=Symbol();function Fp(o){var c=o[Wa];if(!c){var f=cc(o);c=function(p,x){return Dp(p,x,f)},o[Wa]=c}return c}function Op(o,c){var f=o[Wa];return f||(f=function(p,x){return Pp(p,x,c)},o[Wa]=f),f}var Po=Symbol();function Kv(o,c){o.push(c)}function Qv(o,c,f){o.push(c,f.W)}function Jv(o,c,f,p){var x=Fp(p),A=cc(p).P,k=f.W;o.push(c,function(I,G,ie){return k(I,G,ie,A,x)})}function qv(o,c,f,p,x,A){var k=Op(p,A),I=f.W;o.push(c,function(G,ie,pe){return I(G,ie,pe,p,k)})}function cc(o){var c=o[Po];return c||(c=Bp(o,o[Po]=[],Kv,Qv,Jv,qv),Io in o&&Po in o&&(o.length=0),c)}var Io=Symbol();function Zv(o,c){o[0]=c}function e3(o,c,f,p){var x=f.U;o[c]=p?function(A,k,I){return x(A,k,I,p)}:x}function t3(o,c,f,p,x){var A=f.U,k=Rp(p),I=dc(p).P;o[c]=function(G,ie,pe){return A(G,ie,pe,I,k,x)}}function n3(o,c,f,p,x,A,k){var I=f.U,G=Ip(p,x,A);o[c]=function(ie,pe,Be){return I(ie,pe,Be,p,G,k)}}function dc(o){var c=o[Io];return c||(c=Bp(o,o[Io]={},Zv,e3,t3,n3),Io in o&&Po in o&&(o.length=0),c)}function $p(o,c,f){for(;Dn(c)&&c.i!=4;){var p=c.l,x=f[p];if(!x){var A=f[0];A&&(A=A[p])&&(x=f[p]=Xv(A))}if(!x||!x(c,o,p)){x=c,p=o,A=x.j,Lr(x);var k=x;if(!k.ca){if(x=k.h.h-A,k.h.h=A,k=k.h,x==0)x=Ge();else{if(A=nn(k,x),k.S&&k.m)x=k.i.subarray(A,A+x);else{k=k.i;var I=A;x=A+x,x=I===x?ue():U?k.slice(I,x):new Uint8Array(k.subarray(I,x))}x=x.length==0?Ge():new ze(x,P)}(A=p.R)?A.push(x):p.R=[x]}}}return o}function Dp(o,c,f){for(var p=f.length,x=p%2==1,A=x?1:0;A<p;A+=2)(0,f[A+1])(c,o,f[A]);Pp(o,c,x?f[0]:void 0)}function Ro(o,c){return{U:o,W:c}}var kr=Ro(function(o,c,f){if(o.i!==5)return!1;o=o.h;var p=o.i,x=o.h,A=p[x],k=p[x+1],I=p[x+2];return p=p[x+3],Ut(o,o.h+4),k=(A<<0|k<<8|I<<16|p<<24)>>>0,o=2*(k>>31)+1,A=k>>>23&255,k&=8388607,Xe(c,f,A==255?k?NaN:1/0*o:A==0?o*Math.pow(2,-149)*k:o*Math.pow(2,A-150)*(k+Math.pow(2,23))),!0},function(o,c,f){if(c=Ve(c,f),c!=null){_n(o.h,8*f+5),o=o.h;var p=+c;p===0?0<1/p?J=de=0:(de=0,J=2147483648):isNaN(p)?(de=0,J=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(de=0,J=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),de=0,J=(f|p)>>>0):(c=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-c),p=Math.round(8388608*p),16777216<=p&&++c,de=0,J=(f|c+127<<23|p&8388607)>>>0)),f=J,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),r3=Ro(function(o,c,f){if(o.i!==0)return!1;var p=o.h,x=0,A=o=0,k=p.i,I=p.h;do{var G=k[I++];x|=(G&127)<<A,A+=7}while(32>A&&G&128);for(32<A&&(o|=(G&127)>>4),A=3;32>A&&G&128;A+=7)G=k[I++],o|=(G&127)<<A;if(Ut(p,I),128>G)p=x>>>0,G=o>>>0,(o=G&2147483648)&&(p=~p+1>>>0,G=~G>>>0,p==0&&(G=G+1>>>0)),p=4294967296*G+(p>>>0);else throw W();return Xe(c,f,o?-p:p),!0},function(o,c,f){c=je(c,f),c!=null&&(typeof c=="string"&&M(c),c!=null&&(_n(o.h,8*f),typeof c=="number"?(o=o.h,$(c),yn(o,J,de)):(f=M(c),yn(o.h,f.i,f.h))))}),s3=Ro(function(o,c,f){return o.i!==0?!1:(Xe(c,f,Tt(o.h)),!0)},function(o,c,f){if(c=je(c,f),c!=null&&c!=null)if(_n(o.h,8*f),o=o.h,f=c,0<=f)_n(o,f);else{for(c=0;9>c;c++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),Up=Ro(function(o,c,f){if(o.i!==2)return!1;var p=Tt(o.h)>>>0;o=o.h;var x=nn(o,p);if(o=o.i,Ze){var A=o,k;(k=Ue)||(k=Ue=new TextDecoder("utf-8",{fatal:!0})),o=x+p,A=x===0&&o===A.length?A:A.subarray(x,o);try{var I=k.decode(A)}catch(Be){if(Ie===void 0){try{k.decode(new Uint8Array([128]))}catch{}try{k.decode(new Uint8Array([97])),Ie=!0}catch{Ie=!1}}throw!Ie&&(Ue=void 0),Be}}else{I=x,p=I+p,x=[];for(var G=null,ie,pe;I<p;)ie=o[I++],128>ie?x.push(ie):224>ie?I>=p?ge():(pe=o[I++],194>ie||(pe&192)!==128?(I--,ge()):x.push((ie&31)<<6|pe&63)):240>ie?I>=p-1?ge():(pe=o[I++],(pe&192)!==128||ie===224&&160>pe||ie===237&&160<=pe||((A=o[I++])&192)!==128?(I--,ge()):x.push((ie&15)<<12|(pe&63)<<6|A&63)):244>=ie?I>=p-2?ge():(pe=o[I++],(pe&192)!==128||(ie<<28)+(pe-144)>>30||((A=o[I++])&192)!==128||((k=o[I++])&192)!==128?(I--,ge()):(ie=(ie&7)<<18|(pe&63)<<12|(A&63)<<6|k&63,ie-=65536,x.push((ie>>10&1023)+55296,(ie&1023)+56320))):ge(),8192<=x.length&&(G=Ce(G,x),x.length=0);I=Ce(G,x)}return Xe(c,f,I),!0},function(o,c,f){if(c=je(c,f),c!=null){var p=!1;if(p=p===void 0?!1:p,lt){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(c))throw Error("Found an unpaired surrogate");c=(nt||(nt=new TextEncoder)).encode(c)}else{for(var x=0,A=new Uint8Array(3*c.length),k=0;k<c.length;k++){var I=c.charCodeAt(k);if(128>I)A[x++]=I;else{if(2048>I)A[x++]=I>>6|192;else{if(55296<=I&&57343>=I){if(56319>=I&&k<c.length){var G=c.charCodeAt(++k);if(56320<=G&&57343>=G){I=1024*(I-55296)+G-56320+65536,A[x++]=I>>18|240,A[x++]=I>>12&63|128,A[x++]=I>>6&63|128,A[x++]=I&63|128;continue}else k--}if(p)throw Error("Found an unpaired surrogate");I=65533}A[x++]=I>>12|224,A[x++]=I>>6&63|128}A[x++]=I&63|128}}c=x===A.length?A:A.subarray(0,x)}_n(o.h,8*f+2),_n(o.h,c.length),Qt(o,o.h.end()),Qt(o,c)}}),zp=Ro(function(o,c,f,p,x){if(o.i!==2)return!1;c=Ha(c,f,p),f=o.h.j,p=Tt(o.h)>>>0;var A=o.h.h+p,k=A-f;if(0>=k&&(o.h.j=A,x(c,o,void 0,void 0,void 0),k=A-o.h.h),k)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-k)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=A,o.h.j=f,!0},function(o,c,f,p,x){if(c=jn(c,p,f),c!=null)for(p=0;p<c.length;p++){var A=o;_n(A.h,8*f+2);var k=A.h.end();Qt(A,k),k.push(A.i),A=k,x(c[p],o),k=o;var I=A.pop();for(I=k.i+k.h.length()-I;127<I;)A.push(I&127|128),I>>>=7,k.i++;A.push(I),k.i++}});function fc(o){return function(c,f){e:{if(Br.length){var p=Br.pop();p.setOptions(f),mt(p.h,c,f),c=p}else c=new Qr(c,f);try{var x=dc(o),A=$p(new x.P,c,x);break e}finally{x=c.h,x.i=null,x.m=!1,x.l=0,x.j=0,x.h=0,x.S=!1,c.l=-1,c.i=-1,100>Br.length&&Br.push(c)}A=void 0}return A}}function hc(o){return function(){var c=new gs;Dp(this,c,cc(o)),Qt(c,c.h.end());for(var f=new Uint8Array(c.i),p=c.j,x=p.length,A=0,k=0;k<x;k++){var I=p[k];f.set(I,A),A+=I.length}return c.j=[f],f}}function Ai(o){bn.call(this,o)}X(Ai,bn);var Hp=[Ai,1,s3,2,kr,3,Up,4,Up];Ai.prototype.l=hc(Hp);function pc(o){bn.call(this,o,-1,i3)}X(pc,bn),pc.prototype.addClassification=function(o,c){return Ha(this,1,Ai,o,c),this};var i3=[1],Gp=fc([pc,1,zp,Hp]);function Ei(o){bn.call(this,o)}X(Ei,bn);var Wp=[Ei,1,kr,2,kr,3,kr,4,kr,5,kr];Ei.prototype.l=hc(Wp);function Vp(o){bn.call(this,o,-1,o3)}X(Vp,bn);var o3=[1],Yp=fc([Vp,1,zp,Wp]);function Va(o){bn.call(this,o)}X(Va,bn);var Xp=[Va,1,kr,2,kr,3,kr,4,kr,5,kr,6,r3],a3=fc(Xp);Va.prototype.l=hc(Xp);function Kp(o,c,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,c),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function Qp(o){return jn(o,Ai,1).map(function(c){var f=je(c,1);return{index:f??0,score:Nn(c,2),label:je(c,3)!=null?Si(je(c,3),""):void 0,displayName:je(c,4)!=null?Si(je(c,4),""):void 0}})}function Jp(o){return{x:Nn(o,1),y:Nn(o,2),z:Nn(o,3),visibility:Ve(o,4)!=null?Nn(o,4):void 0}}function qp(o){return o.map(function(c){return jn(Yp(c),Ei,1).map(Jp)})}function mc(o,c){this.i=o,this.h=c,this.m=0}function Zp(o,c,f){return l3(o,c),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function l3(o,c){var f=o.h;if(o.s===void 0){var p=Kp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),x=Kp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),A=f.createProgram();if(f.attachShader(A,p),f.attachShader(A,x),f.linkProgram(A),!f.getProgramParameter(A,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(A));p=o.s=A,f.useProgram(p),x=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:x},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(x,0)}p=o.l,f.useProgram(o.s),f.canvas.width=c.width,f.canvas.height=c.height,f.viewport(0,0,c.width,c.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(c.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function u3(o){this.h=o}var c3=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function d3(o,c){return c+o}function em(o,c){window[o]=c}function f3(o){var c=document.createElement("script");return c.setAttribute("src",o),c.setAttribute("crossorigin","anonymous"),new Promise(function(f){c.addEventListener("load",function(){f()},!1),c.addEventListener("error",function(){f()},!1),document.body.appendChild(c)})}function h3(){return K(function(o){switch(o.h){case 1:return o.s=2,E(o,WebAssembly.instantiate(c3),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function gc(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||d3,typeof window=="object")var c=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")c=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=c,o.options){c=u(Object.keys(o.options));for(var f=c.next();!f.done;f=c.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=gc.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function p3(o){var c,f,p,x,A,k,I,G,ie,pe,Be;return K(function(Ne){switch(Ne.h){case 1:return o.ga?(c=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,E(Ne,h3(),2)):Ne.return();case 2:if(f=Ne.i,typeof window=="object")return em("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),em("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),k=c.filter(function(xe){return xe.data!==void 0}),I=c.filter(function(xe){return xe.data===void 0}),G=Promise.all(k.map(function(xe){var Fe=Ya(o,xe.url);if(xe.path!==void 0){var We=xe.path;Fe=Fe.then(function(gt){return o.overrideFile(We,gt),Promise.resolve(gt)})}return Fe})),ie=Promise.all(I.map(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f?f3(o.locateFile(xe.url,o.ha)):Promise.resolve()})).then(function(){var xe,Fe,We;return K(function(gt){if(gt.h==1)return xe=window.createMediapipeSolutionsWasm,Fe=window.createMediapipeSolutionsPackedAssets,We=o,E(gt,xe(Fe),2);We.i=gt.i,gt.h=0})}),pe=function(){return K(function(xe){return o.h.graph&&o.h.graph.url?xe=E(xe,Ya(o,o.h.graph.url),0):(xe.h=0,xe=void 0),xe})}(),E(Ne,Promise.all([ie,G,pe]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=c.filter(function(xe){return xe.simd===void 0||xe.simd&&f||!xe.simd&&!f}).map(function(xe){return o.locateFile(xe.url,o.ha)}),importScripts.apply(null,d(p)),x=o,E(Ne,createMediapipeSolutionsWasm(Module),6);case 6:x.i=Ne.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,A=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(A),Ne.h=4;break;case 7:if(o.m=document.createElement("canvas"),Be=o.m.getContext("webgl2",{}),!Be&&(Be=o.m.getContext("webgl",{}),!Be))return alert("Failed to create WebGL canvas context when passing video frame."),Ne.return();o.K=Be,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,Ne.h=0}})}function m3(o){var c,f,p,x,A,k,I,G;return K(function(ie){if(ie.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return ie.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){ie.h=2;return}return o.fa=o.h.graph.url,E(ie,Ya(o,o.h.graph.url),3)}for(ie.h!=2&&(c=ie.i,o.j.loadGraph(c)),f=u(Object.keys(o.D)),p=f.next();!p.done;p=f.next())x=p.value,o.j.overrideFile(x,o.D[x]);if(o.D={},o.h.listeners)for(A=u(o.h.listeners),k=A.next();!k.done;k=A.next())I=k.value,w3(o,I);G=o.l,o.l={},o.setOptions(G),ie.h=0})}e.reset=function(){var o=this;return K(function(c){o.j&&(o.j.reset(),o.s={},o.v={}),c.h=0})},e.setOptions=function(o,c){var f=this;if(c=c||this.h.options){for(var p=[],x=[],A={},k=u(Object.keys(o)),I=k.next();!I.done;A={X:A.X,Y:A.Y},I=k.next())if(I=I.value,!(I in this.l&&this.l[I]===o[I])){this.l[I]=o[I];var G=c[I];G!==void 0&&(G.onChange&&(A.X=G.onChange,A.Y=o[I],p.push(function(ie){return function(){var pe;return K(function(Be){if(Be.h==1)return E(Be,ie.X(ie.Y),2);pe=Be.i,pe===!0&&(f.u=!0),Be.h=0})}}(A))),G.graphOptionXref&&(I=Object.assign({},{calculatorName:"",calculatorIndex:0},G.graphOptionXref,{valueNumber:G.type===1?o[I]:0,valueBoolean:G.type===0?o[I]:!1,valueString:G.type===2?o[I]:""}),x.push(I)))}(p.length!==0||x.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(x),this.F=(this.F===void 0?[]:this.F).concat(p))}};function g3(o){var c,f,p,x,A,k,I;return K(function(G){switch(G.h){case 1:if(!o.u)return G.return();if(!o.F){G.h=2;break}c=u(o.F),f=c.next();case 3:if(f.done){G.h=5;break}return p=f.value,E(G,p(),4);case 4:f=c.next(),G.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(x=new o.i.GraphOptionChangeRequestList,A=u(o.H),k=A.next();!k.done;k=A.next())I=k.value,x.push_back(I);o.j.changeOptions(x),x.delete(),o.H=void 0}o.u=!1,G.h=0}})}e.initialize=function(){var o=this;return K(function(c){return c.h==1?E(c,p3(o),2):c.h!=3?E(c,m3(o),3):E(c,g3(o),0)})};function Ya(o,c){var f,p;return K(function(x){return c in o.L?x.return(o.L[c]):(f=o.locateFile(c,""),p=fetch(f).then(function(A){return A.arrayBuffer()}),o.L[c]=p,x.return(p))})}e.overrideFile=function(o,c){this.j?this.j.overrideFile(o,c):this.D[o]=c},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,c){var f=this,p,x,A,k,I,G,ie,pe,Be;return K(function(Ne){switch(Ne.h){case 1:return f.h.inputs?(p=1e3*(c??performance.now()),E(Ne,f.I,2)):Ne.return();case 2:return E(Ne,f.initialize(),3);case 3:for(x=new f.i.PacketDataList,A=u(Object.keys(o)),k=A.next();!k.done;k=A.next())if(I=k.value,G=f.h.inputs[I]){e:{var xe=o[I];switch(G.type){case"video":var Fe=f.s[G.stream];if(Fe||(Fe=new mc(f.i,f.K),f.s[G.stream]=Fe),Fe.m===0&&(Fe.m=Fe.i.createTexture()),typeof HTMLVideoElement<"u"&&xe instanceof HTMLVideoElement)var We=xe.videoWidth,gt=xe.videoHeight;else typeof HTMLImageElement<"u"&&xe instanceof HTMLImageElement?(We=xe.naturalWidth,gt=xe.naturalHeight):(We=xe.width,gt=xe.height);gt={glName:Fe.m,width:We,height:gt},We=Fe.h,We.canvas.width=gt.width,We.canvas.height=gt.height,We.activeTexture(We.TEXTURE0),Fe.i.bindTexture2d(Fe.m),We.texImage2D(We.TEXTURE_2D,0,We.RGBA,We.RGBA,We.UNSIGNED_BYTE,xe),Fe.i.bindTexture2d(0),Fe=gt;break e;case"detections":for(Fe=f.s[G.stream],Fe||(Fe=new u3(f.i),f.s[G.stream]=Fe),Fe.data||(Fe.data=new Fe.h.DetectionListData),Fe.data.reset(xe.length),gt=0;gt<xe.length;++gt){We=xe[gt];var dt=Fe.data,rn=dt.setBoundingBox,ir=gt,Mn=We.la,rt=new Va;if(Pt(rt,1,Mn.ra),Pt(rt,2,Mn.sa),Pt(rt,3,Mn.height),Pt(rt,4,Mn.width),Pt(rt,5,Mn.rotation),Xe(rt,6,Mn.pa),Mn=rt.l(),rn.call(dt,ir,Mn),We.ea)for(dt=0;dt<We.ea.length;++dt){rt=We.ea[dt],rn=Fe.data,ir=rn.addNormalizedLandmark,Mn=gt,rt=Object.assign({},rt,{visibility:rt.visibility?rt.visibility:0});var sn=new Ei;Pt(sn,1,rt.x),Pt(sn,2,rt.y),Pt(sn,3,rt.z),rt.visibility&&Pt(sn,4,rt.visibility),rt=sn.l(),ir.call(rn,Mn,rt)}if(We.ba)for(dt=0;dt<We.ba.length;++dt)rn=Fe.data,ir=rn.addClassification,Mn=gt,rt=We.ba[dt],sn=new Ai,Pt(sn,2,rt.score),rt.index&&Xe(sn,1,rt.index),rt.label&&Xe(sn,3,rt.label),rt.displayName&&Xe(sn,4,rt.displayName),rt=sn.l(),ir.call(rn,Mn,rt)}Fe=Fe.data;break e;default:Fe={}}}switch(ie=Fe,pe=G.stream,G.type){case"video":x.pushTexture2d(Object.assign({},ie,{stream:pe,timestamp:p}));break;case"detections":Be=ie,Be.stream=pe,Be.timestamp=p,x.pushDetectionList(Be);break;default:throw Error("Unknown input config type: '"+G.type+"'")}}return f.j.send(x),E(Ne,f.I,4);case 4:x.delete(),Ne.h=0}})};function y3(o,c,f){var p,x,A,k,I,G,ie,pe,Be,Ne,xe,Fe,We,gt;return K(function(dt){switch(dt.h){case 1:if(!f)return dt.return(c);for(p={},x=0,A=u(Object.keys(f)),k=A.next();!k.done;k=A.next())I=k.value,G=f[I],typeof G!="string"&&G.type==="texture"&&c[G.stream]!==void 0&&++x;1<x&&(o.M=!1),ie=u(Object.keys(f)),k=ie.next();case 2:if(k.done){dt.h=4;break}if(pe=k.value,Be=f[pe],typeof Be=="string")return We=p,gt=pe,E(dt,v3(o,pe,c[Be]),14);if(Ne=c[Be.stream],Be.type==="detection_list"){if(Ne){for(var rn=Ne.getRectList(),ir=Ne.getLandmarksList(),Mn=Ne.getClassificationsList(),rt=[],sn=0;sn<rn.size();++sn){var ys=a3(rn.get(sn)),x3=Nn(ys,1),S3=Nn(ys,2),k3=Nn(ys,3),A3=Nn(ys,4),E3=Nn(ys,5,0),Xa=void 0;Xa=Xa===void 0?0:Xa,ys={la:{ra:x3,sa:S3,height:k3,width:A3,rotation:E3,pa:Si(je(ys,6),Xa)},ea:jn(Yp(ir.get(sn)),Ei,1).map(Jp),ba:Qp(Gp(Mn.get(sn)))},rt.push(ys)}rn=rt}else rn=[];p[pe]=rn,dt.h=7;break}if(Be.type==="proto_list"){if(Ne){for(rn=Array(Ne.size()),ir=0;ir<Ne.size();ir++)rn[ir]=Ne.get(ir);Ne.delete()}else rn=[];p[pe]=rn,dt.h=7;break}if(Ne===void 0){dt.h=3;break}if(Be.type==="float_list"){p[pe]=Ne,dt.h=7;break}if(Be.type==="proto"){p[pe]=Ne,dt.h=7;break}if(Be.type!=="texture")throw Error("Unknown output config type: '"+Be.type+"'");return xe=o.v[pe],xe||(xe=new mc(o.i,o.K),o.v[pe]=xe),E(dt,Zp(xe,Ne,o.M),13);case 13:Fe=dt.i,p[pe]=Fe;case 7:Be.transform&&p[pe]&&(p[pe]=Be.transform(p[pe])),dt.h=3;break;case 14:We[gt]=dt.i;case 3:k=ie.next(),dt.h=2;break;case 4:return dt.return(p)}})}function v3(o,c,f){var p;return K(function(x){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?x.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[c],p||(p=new mc(o.i,o.K),o.v[c]=p),x.return(Zp(p,f,o.M))):x.return(void 0)})}function w3(o,c){for(var f=c.name||"$",p=[].concat(d(c.wants)),x=new o.i.StringList,A=u(c.wants),k=A.next();!k.done;k=A.next())x.push_back(k.value);A=o.i.PacketListener.implement({onResults:function(I){for(var G={},ie=0;ie<c.wants.length;++ie)G[p[ie]]=I.get(ie);var pe=o.listeners[f];pe&&(o.I=y3(o,G,c.outs).then(function(Be){Be=pe(Be);for(var Ne=0;Ne<c.wants.length;++Ne){var xe=G[p[Ne]];typeof xe=="object"&&xe.hasOwnProperty&&xe.hasOwnProperty("delete")&&xe.delete()}Be&&(o.I=Be)}))}}),o.j.attachMultiListener(x,A),x.delete()}e.onResults=function(o,c){this.listeners[c||"$"]=o},Se("Solution",gc),Se("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function tm(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function nm(o){var c=this;o=o||{},this.h=new gc({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:tm(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:qp},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:qp},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return Qp(Gp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,x,A;return K(function(k){return k.h==1?(p=tm(f),x="third_party/mediapipe/modules/hand_landmark/"+p,E(k,Ya(c.h,p),2)):(A=k.i,c.h.overrideFile(x,A),k.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=nm.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return K(function(c){return E(c,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var c=this;return K(function(f){return E(f,c.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},Se("Hands",nm),Se("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),Se("VERSION","0.4.1675469240")}).call(yc);const Hn=(...e)=>{},Or={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},It={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function y1({hidden:e=!1}){const t=N.useRef(null),n=N.useRef(null),r=N.useRef(null),s=N.useRef(null),[i,a]=N.useState(!1),[u,d]=N.useState("None"),[h,m]=N.useState([]),[w,S]=N.useState(null),[_,B]=N.useState(null),[O,X]=N.useState(null),[C,g]=N.useState({a:null,b:null}),y=N.useRef(null),E=N.useRef(null),j=($,v)=>{const R=localStorage.getItem($);if(R===null)return v;const b=parseFloat(R);return Number.isFinite(b)?b:v},[T,D]=N.useState(()=>({roiSize:(()=>{const $=j(It.roiSize,44);return $>10?$:44})(),hueWeight:j(It.hueWeight,4),satWeight:j(It.satWeight,2),valWeight:j(It.valWeight,1),sensitivity:j(It.sensitivity,0)})),H=N.useRef(T),se=N.useRef(null),V=N.useRef(!1),K=N.useRef(0),ee=N.useRef(null),[q,te]=N.useState([]),Se=N.useRef([]),[ve,ye]=N.useState(()=>localStorage.getItem(It.selectedCamera)||""),ne=N.useCallback(async()=>{try{const v=(await navigator.mediaDevices.enumerateDevices()).filter(R=>R.kind==="videoinput");return te(v),Se.current=v,v}catch{return[]}},[]),oe=N.useCallback($=>{},[Hn]),re=N.useCallback(async($=null)=>{const v=t.current;if(!v)return;se.current&&(se.current.getTracks().forEach(M=>M.stop()),se.current=null),P();const R=++K.current;ee.current=null;const b=$!==null?$:ve;try{const M=b?{video:{deviceId:{exact:b}}}:{video:!0};if(b){const W=Se.current.find(fe=>fe.deviceId===b);console.log("[Detector]  Loading SELECTED camera:",{deviceId:b,label:(W==null?void 0:W.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const F=await navigator.mediaDevices.getUserMedia(M);if(!V.current||R!==K.current){Hn("Stale camera request (unmounted or superseded). Stopping stream."),F.getTracks().forEach(W=>W.stop());return}se.current=F;const z=F.getVideoTracks();if(Hn("getUserMedia success. Tracks:",z),z.length>0){const W=z[0];console.log("[Detector]  Camera loaded successfully:",{label:W.label,deviceId:W.getSettings().deviceId,resolution:`${W.getSettings().width}x${W.getSettings().height}`,frameRate:W.getSettings().frameRate})}if(v.srcObject=F,await new Promise(W=>{if(v.readyState>=1&&v.videoWidth>0&&v.videoHeight>0)return W();const ge=()=>{v.removeEventListener("loadedmetadata",ge),W()};v.addEventListener("loadedmetadata",ge,{once:!0}),setTimeout(()=>{v.removeEventListener("loadedmetadata",ge),W()},1500)}),!V.current||R!==K.current){Hn("Stale request before play(). Stopping stream."),F.getTracks().forEach(W=>W.stop());return}try{await v.play(),Hn("video.play() promise resolved. Video should be playing.")}catch(W){if(console.error("[Detector] video.play() promise rejected:",W),Hn("video.play() promise rejected:",W.name,W.message),R!==K.current){Hn("play() aborted due to newer request."),F.getTracks().forEach(fe=>fe.stop());return}}if(ee.current!==R&&(ee.current=R,Hn("Initializing MediaPipe for request id",R),Oe()),V.current){const W=await ne();if(!b||!$){const fe=W.find(ge=>ge.deviceId);fe&&fe.deviceId&&fe.deviceId!==ve&&(ye(fe.deviceId),localStorage.setItem(It.selectedCamera,fe.deviceId))}}}catch(M){console.error("[Detector] Error accessing camera:",M),Hn("getUserMedia error:",M.name,M.message)}},[Hn,ne,oe,ve]),we=($,v,R)=>{const b=($||0)*2,M=(v||0)/255,F=(R||0)/255,z=F*M,W=z*(1-Math.abs(b/60%2-1)),fe=F-z;let ge=0,Ce=0,Ie=0;b>=0&&b<60?(ge=z,Ce=W,Ie=0):b<120?(ge=W,Ce=z,Ie=0):b<180?(ge=0,Ce=z,Ie=W):b<240?(ge=0,Ce=W,Ie=z):b<300?(ge=W,Ce=0,Ie=z):(ge=z,Ce=0,Ie=W);const Ue=Math.round((ge+fe)*255),Ze=Math.round((Ce+fe)*255),nt=Math.round((Ie+fe)*255);return`rgb(${Ue}, ${Ze}, ${nt})`},Te=$=>$?we($.h,$.s,$.v):"#ffffff",Le=$=>$==="Player A"&&_?Te(_):$==="Player B"&&O?Te(O):$==="Red"?"#ff0000":$==="Blue"?"#0000ff":"#ffffff";N.useEffect(()=>{V.current=!0;const $=()=>{try{const b=JSON.parse(localStorage.getItem("calibrationA")||"null"),M=JSON.parse(localStorage.getItem("calibrationB")||"null");b&&B({h:b.h,s:b.s,v:b.v}),M&&X({h:M.h,s:M.s,v:M.v})}catch{}},v=b=>{!b||!b.key||(["calibrationA","calibrationB"].includes(b.key)&&$(),[It.roiSize,It.hueWeight,It.satWeight,It.valWeight,It.sensitivity].includes(b.key)&&D(M=>({roiSize:(()=>{const F=j(It.roiSize,(M==null?void 0:M.roiSize)??44);return F>10?F:(M==null?void 0:M.roiSize)??44})(),hueWeight:j(It.hueWeight,(M==null?void 0:M.hueWeight)??4),satWeight:j(It.satWeight,(M==null?void 0:M.satWeight)??2),valWeight:j(It.valWeight,(M==null?void 0:M.valWeight)??1),sensitivity:j(It.sensitivity,(M==null?void 0:M.sensitivity)??0)})))};return(async()=>{const b=await ne();if(!V.current)return;const M=localStorage.getItem(It.selectedCamera);let F="";if(M&&b.some(z=>z.deviceId&&z.deviceId===M)){const z=b.find(W=>W.deviceId===M);F=M,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:M,label:(z==null?void 0:z.label)||"Unknown"})}else{M&&localStorage.removeItem(It.selectedCamera);const z=b.find(W=>W.deviceId);z&&z.deviceId?(F=z.deviceId,localStorage.setItem(It.selectedCamera,z.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:z.deviceId,label:z.label||"Unknown",savedCameraWas:M||"none"}),Hn("Saved camera not found, using default camera:",z.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}ye(F?z=>z===F?z:F:z=>z||""),$()})(),window.addEventListener("storage",v),()=>{V.current=!1,K.current+=1,ee.current=null,s.current&&(s.current.stop(),s.current=null),se.current&&(se.current.getTracks().forEach(M=>M.stop()),se.current=null);const b=t.current;b&&(b.srcObject=null,oe(b)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",v)}},[]),N.useEffect(()=>{y.current=_},[_]),N.useEffect(()=>{E.current=O},[O]),N.useEffect(()=>{H.current=T},[T]),N.useEffect(()=>{re(ve||null)},[ve,re]),N.useEffect(()=>{const $=setInterval(()=>{d(v=>($e(v),v))},1e3);return()=>clearInterval($)},[]);const $e=$=>{const R={timestamp:new Date().toISOString(),status:$};m(M=>[...M,R]);const b=JSON.parse(localStorage.getItem("braceletDetections")||"[]");b.push(R),localStorage.setItem("braceletDetections",JSON.stringify(b))},Oe=async()=>{try{const $=await(async()=>{try{if(typeof iu.Hands=="function")return iu.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((R,b)=>{const M="mp-hands-cdn-script";if(document.getElementById(M))return R();const F=document.createElement("script");F.id=M,F.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",F.async=!0,F.onload=()=>R(),F.onerror=z=>b(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(F)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),v=new $({locateFile:R=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${R}`});if(v.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),v.onResults(De),r.current=v,t.current){const R=t.current;console.log("[Detector]  Starting manual frame capture from video element");let b;const M=async()=>{if(R.readyState>=2&&R.videoWidth>0)try{await v.send({image:R})}catch(F){console.error("[Detector] Error sending frame to MediaPipe:",F)}b=requestAnimationFrame(M)};M(),s.current={stop:()=>{b&&(cancelAnimationFrame(b),console.log("[Detector]  Stopped frame capture"))}}}}catch($){console.error("MediaPipe initialization error:",$),S(`MediaPipe error: ${$.message}`)}},De=$=>{var z;const v=n.current,R=t.current;if(!v||!R)return;const b=v.getContext("2d");v.width=R.videoWidth,v.height=R.videoHeight,b.drawImage(R,0,0,v.width,v.height);let M="None";if($.multiHandLandmarks&&$.multiHandLandmarks.length>0){Hn("onResults: hands=",$.multiHandLandmarks.length);let W=null,fe=0;if($.multiHandLandmarks.forEach(ge=>{const Ce=ge[0];Ce.y>fe&&(fe=Ce.y,W=ge)}),$.multiHandLandmarks.forEach(ge=>{Y(b,ge,v.width,v.height)}),W){const ge=W[0],Ce=ge.x*v.width,Ie=ge.y*v.height;b.fillStyle="lime",b.beginPath(),b.arc(Ce,Ie,10,0,2*Math.PI),b.fill(),b.fillStyle="lime",b.font="16px Arial",b.fillText("SELECTED",Ce-40,Ie-15);const Ze=Math.max(10,Math.min(300,Math.floor(((z=H.current)==null?void 0:z.roiSize)||60)))/2,nt=Math.max(0,Ce-Ze),lt=Math.max(0,Ie-Ze),ut=Math.min(v.width,Ce+Ze),He=Math.min(v.height,Ie+Ze);b.strokeStyle="lime",b.lineWidth=3,b.strokeRect(nt,lt,ut-nt,He-lt);const ze=ut-nt,Ge=He-lt;if(ze>0&&Ge>0)try{const qe=b.getImageData(nt,lt,ze,Ge),xt=y.current,$n=E.current,mt=me(qe,xt,$n);M=mt.status,g({a:mt.percentA,b:mt.percentB}),Hn("Detection result:",M,{roi:{x1:nt,y1:lt,w:ze,h:Ge}})}catch(qe){console.warn("[Detector] Failed to get ROI image data:",qe.message),M="None",g({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:ze,height:Ge}),M="None",g({a:null,b:null})}}let F="#ffffff";M==="Player A"&&y.current?F=Te(y.current):M==="Player B"&&E.current&&(F=Te(E.current)),b.fillStyle=F,b.font="bold 32px Arial",b.fillText(`Status: ${M}`,10,40),d(M),typeof window<"u"&&(window.currentBraceletStatus=M,window.braceletDetectorCanvas=v,window.braceletDetectorVideo=R)},Y=($,v,R,b)=>{$.strokeStyle="white",$.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([F,z])=>{const W=v[F],fe=v[z];$.beginPath(),$.moveTo(W.x*R,W.y*b),$.lineTo(fe.x*R,fe.y*b),$.stroke()}),v.forEach(F=>{$.fillStyle="red",$.beginPath(),$.arc(F.x*R,F.y*b,5,0,2*Math.PI),$.fill()})},Q=$=>{const v=$.data;let R=0,b=0;for(let M=0;M<v.length;M+=4){const F=v[M],z=v[M+1],W=v[M+2],fe=ue(F,z,W);(fe[0]>=Or.red.lower1[0]&&fe[0]<=Or.red.upper1[0]||fe[0]>=Or.red.lower2[0]&&fe[0]<=Or.red.upper2[0])&&fe[1]>=Or.red.lower1[1]&&fe[2]>=Or.red.lower1[2]&&R++,fe[0]>=Or.blue.lower[0]&&fe[0]<=Or.blue.upper[0]&&fe[1]>=Or.blue.lower[1]&&fe[2]>=Or.blue.lower[2]&&b++}return{redCount:R,blueCount:b}},me=($,v,R)=>{var Ze,nt,lt,ut;const b=$.data;if(v&&!R)return{status:"Player A",percentA:null,percentB:null};if(R&&!v)return{status:"Player B",percentA:null,percentB:null};const M=((Ze=H.current)==null?void 0:Ze.hueWeight)??4,F=((nt=H.current)==null?void 0:nt.satWeight)??2,z=((lt=H.current)==null?void 0:lt.valWeight)??1,W=((ut=H.current)==null?void 0:ut.sensitivity)??0;if(v&&R){let He=0,ze=0,Ge=0;for(let mt=0;mt<b.length;mt+=4){const Ut=b[mt],Tt=b[mt+1],nn=b[mt+2],[mn,gn,yn]=ue(Ut,Tt,nn),_n=Math.min(1,Math.max(0,gn/255)),Qr=Math.min(1,Math.max(0,yn/255)),Dn=Math.max(.05,.5*_n+.5*Qr),Lr=Math.min(Math.abs(mn-v.h),180-Math.abs(mn-v.h)),Br=Math.min(Math.abs(mn-R.h),180-Math.abs(mn-R.h)),gs=Math.abs(gn-v.s),Qt=Math.abs(gn-R.s),Mo=Math.abs(yn-v.v),Un=Math.abs(yn-R.v),sr=Lr*M+gs*F+Mo*z,Ks=Br*M+Qt*F+Un*z;Math.min(sr,Ks)>180||(sr<=Ks?He+=Dn:ze+=Dn,Ge+=Dn)}if(Ge===0)return{status:"None",percentA:0,percentB:0};const qe=He/Math.max(1e-6,Ge),xt=ze/Math.max(1e-6,Ge),$n=.12*(1+.8*Math.max(0,Math.min(1,W)));return qe>=$n&&qe>=xt?{status:"Player A",percentA:qe,percentB:xt}:xt>=$n&&xt>qe?{status:"Player B",percentA:qe,percentB:xt}:{status:"None",percentA:qe,percentB:xt}}const{redCount:fe,blueCount:ge}=Q($),Ce=fe+ge;if(Ce===0)return{status:"None",percentA:0,percentB:0};const Ie=fe/Ce,Ue=ge/Ce;return Ie>=.15&&Ie>=Ue?{status:"Player A",percentA:Ie,percentB:Ue}:Ue>=.15&&Ue>Ie?{status:"Player B",percentA:Ie,percentB:Ue}:{status:"None",percentA:Ie,percentB:Ue}},ue=($,v,R)=>{$/=255,v/=255,R/=255;const b=Math.max($,v,R),M=Math.min($,v,R),F=b-M;let z=0;F!==0&&(b===$?z=60*((v-R)/F%6):b===v?z=60*((R-$)/F+2):z=60*(($-v)/F+4)),z<0&&(z+=360);const W=b===0?0:F/b*255,fe=b*255;return[z/2,W,fe]},P=$=>{},U=$=>{ye($),$?localStorage.setItem(It.selectedCamera,$):localStorage.removeItem(It.selectedCamera)},J=()=>{const $=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),v=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),R=URL.createObjectURL(v),b=document.createElement("a");b.href=R,b.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,b.click();const M=$.map(fe=>`${fe.timestamp}: ${fe.status}`).join(`
`),F=new Blob([M],{type:"text/plain"}),z=URL.createObjectURL(F),W=document.createElement("a");W.href=z,W.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,W.click()},de=()=>{localStorage.removeItem("braceletDetections"),m([])};return l.jsx(l.Fragment,{children:l.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:J,title:"Download Logs",children:""}),l.jsx("button",{onClick:de,title:"Clear Logs",children:""}),l.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),l.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{children:"Camera:"}),l.jsxs("select",{value:ve,onChange:$=>U($.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[l.jsx("option",{value:"",children:"System Default"}),q.map(($,v)=>{var W;const R=!!$.deviceId,b=R?$.deviceId:"",M=R?$.deviceId:`camera-${v}`,F=((W=$.label)==null?void 0:W.trim())||`Camera ${v+1}`,z=R?`  ${$.deviceId.slice(0,8)}`:" (needs permission)";return l.jsxs("option",{value:b,disabled:!R,children:[F,z]},M)})]})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),l.jsx("canvas",{ref:n,className:"output_canvas"}),l.jsxs("div",{className:"detector-info",children:[l.jsxs("div",{className:"status-display",children:["Status: ",l.jsx("span",{style:{color:Le(u),fontWeight:700},children:u})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:_?Te(_):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:C.a==null?"":`${Math.round(Math.max(0,Math.min(1,C.a))*100)}%`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:O?Te(O):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:C.b==null?"":`${Math.round(Math.max(0,Math.min(1,C.b))*100)}%`})]})]}),l.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",_?`h${Math.round(_.h)} s${Math.round(_.s)} v${Math.round(_.v)}`:""]}),l.jsxs("div",{children:["B: ",O?`h${Math.round(O.h)} s${Math.round(O.s)} v${Math.round(O.v)}`:""]})]})]})]})]})})}const Vc=(...e)=>{console.log("[Calibrate]",...e)},$r={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},cx=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,u=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,m=0,w=0;r>=0&&r<60?(h=a,m=u,w=0):r<120?(h=u,m=a,w=0):r<180?(h=0,m=a,w=u):r<240?(h=0,m=u,w=a):r<300?(h=u,m=0,w=a):(h=a,m=0,w=u);const S=Math.round((h+d)*255),_=Math.round((m+d)*255),B=Math.round((w+d)*255);return`rgb(${S}, ${_}, ${B})`},v1=e=>e?cx(e.h,e.s,e.v):"#444";function dx(){const e=N.useRef(null),t=N.useRef(null),n=N.useRef(null),r=N.useRef(!1),s=N.useRef(0),[i,a]=N.useState(!1),[u,d]=N.useState(""),[h,m]=N.useState(null),[w,S]=N.useState(null),_=(Y,Q)=>{const me=localStorage.getItem(Y);if(me===null)return Q;const ue=parseFloat(me);return Number.isFinite(ue)?ue:Q},[B,O]=N.useState(()=>{const Y=_($r.roiSize,44);return Y>10?Y:44}),[X,C]=N.useState(()=>_($r.hueWeight,4)),[g,y]=N.useState(()=>_($r.satWeight,2)),[E,j]=N.useState(()=>_($r.valWeight,1)),[T,D]=N.useState(()=>_($r.sensitivity,0)),[H,se]=N.useState(!1),[V,K]=N.useState("idle"),[ee,q]=N.useState(5),te=N.useRef({A:[],B:[]});N.useEffect(()=>{r.current=!0;try{const Y=JSON.parse(localStorage.getItem("calibrationA")||"null"),Q=JSON.parse(localStorage.getItem("calibrationB")||"null");Y&&m(Y),Q&&S(Q)}catch{}return(async()=>await Se())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(Q=>Q.stop()),n.current=null);const Y=e.current;Y&&(Y.srcObject=null)}},[]),N.useEffect(()=>{localStorage.setItem($r.roiSize,String(B))},[B]),N.useEffect(()=>{localStorage.setItem($r.hueWeight,String(X))},[X]),N.useEffect(()=>{localStorage.setItem($r.satWeight,String(g))},[g]),N.useEffect(()=>{localStorage.setItem($r.valWeight,String(E))},[E]),N.useEffect(()=>{localStorage.setItem($r.sensitivity,String(T))},[T]);const Se=N.useCallback(async()=>{const Y=e.current;if(!Y)return;n.current&&(n.current.getTracks().forEach(me=>me.stop()),n.current=null);const Q=++s.current;a(!1),d("Requesting camera...");try{const me=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||Q!==s.current){me.getTracks().forEach(ue=>ue.stop());return}if(n.current=me,Y.srcObject=me,await new Promise(ue=>{if(Y.readyState>=1&&Y.videoWidth>0)return ue();const U=()=>{Y.removeEventListener("loadedmetadata",U),ue()};Y.addEventListener("loadedmetadata",U,{once:!0}),setTimeout(()=>{Y.removeEventListener("loadedmetadata",U),ue()},1500)}),!r.current||Q!==s.current){me.getTracks().forEach(ue=>ue.stop());return}try{await Y.play(),Vc("video.play resolved")}catch(ue){Vc("video.play rejected",ue)}a(!0),d("")}catch(me){d(`Camera error: ${(me==null?void 0:me.message)||me}`),Vc("getUserMedia error",me)}},[]),ve=(Y,Q,me)=>{Y/=255,Q/=255,me/=255;const ue=Math.max(Y,Q,me),P=Math.min(Y,Q,me),U=ue-P;let J=0;U!==0&&(ue===Y?J=60*((Q-me)/U%6):ue===Q?J=60*((me-Y)/U+2):J=60*((Y-Q)/U+4)),J<0&&(J+=360);const de=ue===0?0:U/ue*255,$=ue*255;return[J/2,de,$]},ye=()=>{const Y=e.current,Q=t.current;if(!Y||!Q||Y.videoWidth===0)return null;const me=Y.videoWidth,ue=Y.videoHeight;Q.width=me,Q.height=ue;const P=Q.getContext("2d");P.drawImage(Y,0,0,me,ue);const U=Math.max(10,Math.min(300,Math.floor(B))),J=Math.floor(me/2-U/2),de=Math.floor(ue/2-U/2),v=P.getImageData(J,de,U,U).data;let R=0,b=0,M=0,F=0,z=0;for(let nt=0;nt<v.length;nt+=4){const[lt,ut,He]=ve(v[nt],v[nt+1],v[nt+2]),ze=lt*2*(Math.PI/180);R+=Math.cos(ze),b+=Math.sin(ze),M+=ut,F+=He,z++}if(z===0)return null;const W=M/z,fe=F/z,ge=R/z,Ce=b/z;let Ue=Math.atan2(Ce,ge)*(180/Math.PI);return Ue<0&&(Ue+=360),{h:Ue/2,s:W,v:fe}},ne=Y=>{const Q=ye();if(!Q){d("Could not sample video frame.");return}Y==="A"?(localStorage.setItem("calibrationA",JSON.stringify(Q)),m(Q),d(`Saved Player A: h${Q.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(Q)),S(Q),d(`Saved Player B: h${Q.h.toFixed(0)}`))},oe=Y=>{Y==="A"?(localStorage.removeItem("calibrationA"),m(null)):(localStorage.removeItem("calibrationB"),S(null)),d("Cleared")},re=()=>{se(!0),K("playerA"),q(5),te.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};N.useEffect(()=>{if(!(!H||V==="idle"||V==="optimizing"||V==="complete"))if(ee>0){const Y=setTimeout(()=>{q(ee-1)},1e3);return()=>clearTimeout(Y)}else V==="playerA"?(K("switching"),q(3),d("Switch to Player B... Get ready!")):V==="switching"?(K("playerB"),q(5),d("Hold Player B bracelet in center square...")):V==="playerB"&&(K("optimizing"),we())},[H,V,ee]),N.useEffect(()=>{if(!H||V==="idle"||V==="switching"||V==="optimizing"||V==="complete")return;const Y=setInterval(()=>{const Q=ye();Q&&(V==="playerA"?te.current.A.push(Q):V==="playerB"&&te.current.B.push(Q))},200);return()=>clearInterval(Y)},[H,V]);const we=()=>{d("Optimizing parameters...");const Y=te.current.A,Q=te.current.B;if(Y.length===0||Q.length===0){d("Error: Not enough samples collected!"),se(!1),K("idle");return}const me=Te(Y),ue=Te(Q),P=Math.min(Math.abs(me.h-ue.h),180-Math.abs(me.h-ue.h)),U=Math.abs(me.s-ue.s),J=Math.abs(me.v-ue.v),de=P/90,$=U/255,v=J/255,R=Le(Y),b=Le(Q),M={h:(R.h+b.h)/2,s:(R.s+b.s)/2,v:(R.v+b.v)/2},F=de+$+v,z=F>0?de/F*(1/(1+M.h/20))*6:2,W=F>0?$/F*(1/(1+M.s/50))*4:1,fe=F>0?v/F*(1/(1+M.v/50))*3:.5;C(Math.max(.5,Math.min(6,z))),y(Math.max(.1,Math.min(4,W))),j(Math.max(.1,Math.min(3,fe)));const ge=$e(Y,Q,me,ue),Ce=Math.max(0,Math.min(.8,ge*.5));D(Ce),localStorage.setItem("calibrationA",JSON.stringify(me)),localStorage.setItem("calibrationB",JSON.stringify(ue)),m(me),S(ue),K("complete"),d(` Auto-calibration complete! Collected ${Y.length+Q.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{se(!1),K("idle")},3e3)},Te=Y=>{const Q=Y.map(b=>b.h),me=Y.map(b=>b.s).sort((b,M)=>b-M),ue=Y.map(b=>b.v).sort((b,M)=>b-M);let P=0,U=0;Q.forEach(b=>{const M=b*2*(Math.PI/180);P+=Math.cos(M),U+=Math.sin(M)});let de=Math.atan2(U/Q.length,P/Q.length)*(180/Math.PI);de<0&&(de+=360);const $=de/2,v=me[Math.floor(me.length/2)],R=ue[Math.floor(ue.length/2)];return{h:$,s:v,v:R}},Le=Y=>{const Q=Y.reduce((ue,P)=>({h:ue.h+P.h,s:ue.s+P.s,v:ue.v+P.v}),{h:0,s:0,v:0});Q.h/=Y.length,Q.s/=Y.length,Q.v/=Y.length;const me=Y.reduce((ue,P)=>({h:ue.h+Math.pow(P.h-Q.h,2),s:ue.s+Math.pow(P.s-Q.s,2),v:ue.v+Math.pow(P.v-Q.v,2)}),{h:0,s:0,v:0});return{h:me.h/Y.length,s:me.s/Y.length,v:me.v/Y.length}},$e=(Y,Q,me,ue)=>{let P=0;const U=Math.min(Y.length,Q.length)*2;return Y.forEach(J=>{const de=Oe(J,me);Oe(J,ue)<de*1.5&&P++}),Q.forEach(J=>{const de=Oe(J,me),$=Oe(J,ue);de<$*1.5&&P++}),P/U},Oe=(Y,Q)=>{const me=Math.min(Math.abs(Y.h-Q.h),180-Math.abs(Y.h-Q.h)),ue=Math.abs(Y.s-Q.s),P=Math.abs(Y.v-Q.v);return Math.sqrt(me*me+ue*ue+P*P)},De=()=>{se(!1),K("idle"),q(5),d("Generic mode cancelled")};return l.jsxs("div",{className:"calib-root",children:[l.jsxs("div",{className:"calib-header",children:[l.jsx("h2",{children:"Color Calibration"}),l.jsxs("div",{className:"calib-actions",children:[l.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),l.jsx("button",{onClick:Se,children:"Restart Camera"})]})]}),u&&l.jsx("div",{className:"calib-message",children:u}),l.jsxs("div",{className:"calib-content",children:[l.jsx("div",{children:l.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[l.jsx("div",{className:"label",children:"Live Preview"}),l.jsx("div",{className:"value",style:{marginBottom:8},children:H?`Generic Mode Active: ${V==="playerA"?"Player A":V==="switching"?"Switching...":V==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),l.jsxs("div",{className:"calib-video-wrap",children:[l.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),l.jsx("div",{className:"calib-center-box",style:{width:B,height:B,borderColor:"#22d3ee",borderWidth:H?"4px":"3px",boxShadow:H?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),H&&ee>0&&l.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:ee})]})]})}),l.jsxs("div",{className:"calib-controls",children:[l.jsxs("div",{className:"calib-block",style:{background:H?"#1a2332":"#0f172a",border:H?"2px solid #22d3ee":"1px solid #1f2937"},children:[l.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),l.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),H?l.jsxs("div",{style:{marginTop:8},children:[l.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[V==="playerA"&&`Player A: Hold bracelet steady... ${ee}s`,V==="switching"&&`Switch hands! Get Player B ready... ${ee}s`,V==="playerB"&&`Player B: Hold bracelet steady... ${ee}s`,V==="optimizing"&&"Optimizing parameters...",V==="complete"&&" Complete!"]}),l.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[V==="playerA"&&`Samples collected: ${te.current.A.length}`,V==="switching"&&`Player A: ${te.current.A.length} samples collected`,V==="playerB"&&`Samples collected: ${te.current.B.length}`]}),V!=="complete"&&l.jsx("button",{onClick:De,style:{background:"#ef4444"},children:"Cancel"})]}):l.jsx("div",{className:"buttons",children:l.jsx("button",{onClick:re,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Detector Settings"}),l.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Detection square size"}),l.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:B,onChange:Y=>O(Number(Y.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[B,"px"]})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Hue weight"}),l.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:X,onChange:Y=>C(Number(Y.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:X.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Saturation weight"}),l.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:g,onChange:Y=>y(Number(Y.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:g.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Value weight"}),l.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:E,onChange:Y=>j(Number(Y.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:E.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:T,onChange:Y=>D(Number(Y.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[(T*100).toFixed(0),"%"]})]}),l.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player A"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:v1(h)}}),l.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>ne("A"),disabled:!i,children:"Save A"}),l.jsx("button",{onClick:()=>oe("A"),children:"Clear A"})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player B"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:v1(w)}}),l.jsx("span",{children:w?`h${w.h.toFixed(0)} s${w.s.toFixed(0)} v${w.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>ne("B"),disabled:!i,children:"Save B"}),l.jsx("button",{onClick:()=>oe("B"),children:"Clear B"})]})]})]})]}),l.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function Q2({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var $;const[a,u]=N.useState(e),[d,h]=N.useState(0),[m,w]=N.useState(!1),[S,_]=N.useState(1),[B,O]=N.useState(aa()),[X,C]=N.useState(!0),[g,y]=N.useState([]),[E,j]=N.useState(null),[T,D]=N.useState(!1),H=N.useRef(null),se=N.useRef(null),V=N.useRef(null),K=n&&!e,ee=["summary-container",r].filter(Boolean).join(" "),q=(v,R)=>{const b=V.current;if(!b)return 0;const M=b.offsetHeight;return(v+.5)*M},te=N.useCallback((v,R=null)=>{const b=R||a;if(!b)return;let M=aa(),F=!0;const z=[];let W=null;for(let fe=0;fe<=v&&fe<b.moves.length;fe++){const ge=b.moves[fe];ge.phase==="experiment"&&F&&(F=!1,M=aa());const Ce=ge.all_positions||(ge.allPositions?ge.allPositions.map(Ie=>[Ie[0]*.07,Ie[1]*.07]):null);if(ge.type==="moveblock"&&Ce)Ce.length===10&&M.length===10?M=M.map((Ie,Ue)=>{const Ze=Ce[Ue];return Ze&&Array.isArray(Ze)&&Ze.length===2?{...Ie,position:[Ze[0],Ze[1]]}:Ie}):console.warn(`Position count mismatch: blocks=${M.length}, positions=${Ce==null?void 0:Ce.length}`),M=sf(rf(M),F),W=ge.blockId!==void 0?ge.blockId:ge.unit;else if(ge.type==="added shape to gallery"&&ge.gallery_normalized){const Ie=document.createElement("canvas");Ie.width=400,Ie.height=400;const Ue=Ie.getContext("2d");Ue.fillStyle="#000",Ue.fillRect(0,0,400,400),ge.gallery_normalized.forEach(Ze=>{const nt=(Ze[0]+.5)*400,lt=(Ze[1]+.5)*400;Ue.fillStyle="green";const ut=60;Ue.fillRect(nt-ut/2,lt-ut/2,ut,ut)}),z.push({number:ge.gallery_shape_number,image:Ie.toDataURL()}),W=null}}O(M),C(F),y(z),j(W)},[a]),Se=v=>{u(v),h(0),w(!1),setTimeout(()=>{te(0,v)},0)},ve=v=>{if(!K)return;const R=v.target.files[0];if(!R)return;const b=new FileReader;b.onload=M=>{try{const F=JSON.parse(M.target.result);Se(F)}catch(F){alert("Failed to parse JSON file: "+F.message)}},b.readAsText(R)};N.useEffect(()=>{e&&Se(e)},[e]),N.useEffect(()=>{a&&d>=0&&te(d)},[a,d,te]),N.useEffect(()=>{const v=()=>{a&&d>=0&&setTimeout(()=>{te(d)},100)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[a,d,te]);const ye=v=>{a&&(v<0||v>=a.moves.length||(te(v),h(v)))},ne=()=>{if(!a||m)return;w(!0),h(0),te(0);let v=0;se.current=setInterval(()=>{if(v>=a.moves.length){oe();return}v++,te(v),h(v)},1e3/S)},oe=()=>{se.current&&(clearInterval(se.current),se.current=null),w(!1)};if(N.useEffect(()=>()=>{se.current&&clearInterval(se.current)},[]),N.useEffect(()=>{if(m&&se.current){clearInterval(se.current),se.current=null;const v=d;h(0),w(!1),setTimeout(()=>{h(v),ne()},0)}},[S]),!a)return K?l.jsx("div",{className:ee,children:l.jsxs("div",{className:"summary-upload",children:[l.jsx("h1",{children:t}),l.jsx("p",{children:"Load a game session JSON file to view the replay"}),l.jsx("input",{ref:H,type:"file",accept:".json",onChange:ve,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var v;return(v=H.current)==null?void 0:v.click()},children:"Load JSON File"})]})}):null;const re=a.moves[d],we=a.moves.length,Te=(($=a.summary)==null?void 0:$.movesByPlayer)||{},Le=Object.entries(Te||{}),$e=(v,R=1)=>Number.isFinite(v)?v.toFixed(R):"",Oe=a.sessionInfo||{},De=Oe.subjectId||Oe.id||a.subjectId||a.id||null,Y=Oe.sessionGameId||a.sessionGameId||De||null,Q=Oe.condition||a.condition||null,me=a.startTime||Oe.startedAt||Oe.date||null,ue=a.endTime||Oe.endedAt||null,P=v=>{if(!v)return null;try{const R=new Date(v);if(!Number.isNaN(R.getTime()))return R.toLocaleString()}catch{}return v},U=[];Y&&U.push({label:"Session ID",value:Y}),De&&De!==Y&&U.push({label:"Participant",value:De}),Q&&U.push({label:"Condition",value:Q});const J=P(me);J&&U.push({label:"Start",value:J});const de=P(ue);return de&&U.push({label:"End",value:de}),l.jsxs("div",{className:ee,children:[l.jsxs("div",{className:"summary-header",children:[l.jsx("h1",{children:t}),U.length>0&&l.jsx("div",{className:"summary-session-info",children:U.map(v=>l.jsxs("div",{className:"summary-session-info-item",children:[l.jsx("span",{className:"summary-session-info-label",children:v.label}),l.jsx("span",{className:"summary-session-info-value",children:v.value})]},`${v.label}-${v.value}`))})]}),l.jsxs("div",{className:"summary-main",children:[l.jsxs("div",{className:"summary-left",children:[l.jsx("div",{className:"summary-game-area",children:l.jsxs("div",{className:"game-canvas",ref:V,children:[l.jsx("div",{className:"gallery",children:l.jsx("div",{className:"gallery-frame",children:g.length>0?l.jsx("img",{src:g[g.length-1].image,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),B.map((v,R)=>{const b=v.position||[0,0];return!Array.isArray(b)||b.length!==2||!Number.isFinite(b[0])||!Number.isFinite(b[1])?(console.warn(`Invalid position for block ${v.id}:`,b),null):l.jsx("div",{className:`block ${v.canMove?"movable":""} ${v.id===E?"highlighted":""}`,style:{left:`${q(b[0])}px`,top:`${q(b[1])}px`,backgroundColor:v.color||"green",cursor:v.canMove?"grab":"default",zIndex:v.id===E?20:R+1}},v.id)})]})}),l.jsxs("div",{className:"summary-progress",children:[l.jsx("input",{type:"range",min:"0",max:Math.max(0,we-1),value:d,onChange:v=>ye(parseInt(v.target.value)),style:{width:"100%"}}),l.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",we,re&&l.jsxs("span",{className:"move-info",children:[" "," Player: ",re.player,Array.isArray(re.position)&&re.position.length===2&&`  Position: (${re.position[0]}, ${re.position[1]})`,Number.isFinite(re.holdTime)&&`  Hold: ${$e(re.holdTime,2)}s`," "," Time: ",$e(re.elapsed,1),"s"]})]})]})]}),l.jsxs("div",{className:"summary-right",children:[l.jsxs("div",{className:"summary-stats",children:[l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Duration"}),l.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),l.jsx("span",{className:"summary-stats-value",children:we})]}),l.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[l.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),l.jsx("div",{className:"summary-stats-value",children:Le.length===0?l.jsx("span",{children:""}):Le.map(([v,R])=>l.jsxs("div",{children:[v,": ",R]},v))})]})]}),l.jsxs("div",{className:"summary-controls",children:[l.jsx("button",{onClick:()=>ye(0),disabled:d===0,children:" First"}),l.jsx("button",{onClick:()=>ye(d-1),disabled:d===0,children:" Previous"}),l.jsx("button",{onClick:m?oe:ne,children:m?" Pause":" Play"}),l.jsx("button",{onClick:()=>ye(d+1),disabled:d>=we-1,children:" Next"}),l.jsx("button",{onClick:()=>ye(we-1),disabled:d>=we-1,children:" Last"}),l.jsxs("div",{className:"speed-control",children:[l.jsx("label",{children:"Speed:"}),l.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:S,onChange:v=>_(parseFloat(v.target.value))}),l.jsxs("span",{children:[S,"x"]})]}),K&&l.jsxs(l.Fragment,{children:[l.jsx("input",{ref:H,type:"file",accept:".json",onChange:ve,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var v;return(v=H.current)==null?void 0:v.click()},children:" Load New File"})]})]}),l.jsxs("div",{className:"summary-moves-list",children:[l.jsxs("div",{className:"move-list-header",children:[l.jsx("h2",{children:"Move History"}),i&&l.jsx("button",{className:`edit-mode-toggle ${T?"active":""}`,onClick:()=>D(!T),children:T?" Done Editing":"Edit Players"})]}),l.jsx("div",{className:"moves-scroll",children:a.moves.map((v,R)=>l.jsxs("div",{className:`move-item ${R===d?"active":""} ${T?"edit-mode":""}`,onClick:()=>!T&&ye(R),children:[l.jsx("div",{className:"move-number",children:R+1}),v.camera_frame&&l.jsx("div",{className:"move-camera-frame",children:l.jsx("img",{src:v.camera_frame,alt:`Camera frame for move ${R+1}`,className:"camera-frame-thumbnail"})}),l.jsxs("div",{className:"move-details",children:[l.jsx("div",{className:"move-type",children:v.type}),T&&i?l.jsxs("div",{className:"move-player-edit",children:[l.jsx("label",{children:"Player:"}),l.jsxs("select",{value:v.player||"Unknown",onChange:b=>{const M=b.target.value;i(v._id,M)},onClick:b=>b.stopPropagation(),children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):l.jsxs("div",{className:"move-player",children:["Player: ",v.player]}),v.blockId!==null&&v.blockId!==void 0||v.unit!==null&&v.unit!==void 0?l.jsxs("div",{className:"move-unit",children:["Block: ",v.blockId!==void 0?v.blockId:v.unit]}):null,Array.isArray(v.position)&&v.position.length===2&&l.jsxs("div",{className:"move-position",children:["Position: (",v.position[0],", ",v.position[1],")"]}),Number.isFinite(v.holdTime)&&v.holdTime>0&&l.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",$e(v.holdTime,2),"s"]}),l.jsxs("div",{className:"move-time",children:["Time: ",$e(v.elapsed,1),"s"]})]})]},R))})]})]})]})]})}const Jt=(...e)=>{console.log("[Detector2]",...e)},vn={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function fx(){const e=N.useRef(null),t=N.useRef(null),n=N.useRef(null),r=N.useRef(null),s=N.useRef(null),i=N.useRef(null),a=N.useRef(null),u=N.useRef(null),d=N.useRef(null),[h,m]=N.useState(""),[w,S]=N.useState(!1),[_,B]=N.useState({camA:"None",camB:"None",merged:"None"}),[O,X]=N.useState(!0),[C,g]=N.useState(null),[y,E]=N.useState(null),j=N.useRef(null),T=N.useRef(null),D=(v,R)=>{const b=localStorage.getItem(v);if(b===null)return R;const M=parseFloat(b);return Number.isFinite(M)?M:R},[H,se]=N.useState(()=>({roiSize:(()=>{const v=D(vn.roiSize,44);return v>10?v:44})(),hueWeight:D(vn.hueWeight,4),satWeight:D(vn.satWeight,2),valWeight:D(vn.valWeight,1),sensitivity:D(vn.sensitivity,0)})),V=N.useRef(H),[K,ee]=N.useState([]),[q,te]=N.useState(""),[Se,ve]=N.useState("");N.useEffect(()=>{let v=!0;(async()=>{try{const F=(await navigator.mediaDevices.enumerateDevices()).filter(W=>W.kind==="videoinput");if(F.length===0){m("No cameras found");return}ee(F);const z=F.slice(0,2).map(W=>W.deviceId);te(z[0]||""),ve(z[1]||z[0]||""),await ye(z[0],e,u),z[1]?await ye(z[1],t,d):await ye(z[0],t,d),await $e(),await Oe("A",e,i),await Oe("B",t,a)}catch(M){if(!v)return;m((M==null?void 0:M.message)||String(M))}})();const R=()=>{try{const M=JSON.parse(localStorage.getItem("calibrationA")||"null"),F=JSON.parse(localStorage.getItem("calibrationB")||"null");M&&g({h:M.h,s:M.s,v:M.v}),F&&E({h:F.h,s:F.s,v:F.v})}catch{Jt("No existing calibrations")}};R();const b=M=>{!M||!M.key||(["calibrationA","calibrationB"].includes(M.key)&&R(),[vn.roiSize,vn.hueWeight,vn.satWeight,vn.valWeight,vn.sensitivity].includes(M.key)&&se(F=>({roiSize:(()=>{const z=D(vn.roiSize,(F==null?void 0:F.roiSize)??44);return z>10?z:(F==null?void 0:F.roiSize)??44})(),hueWeight:D(vn.hueWeight,(F==null?void 0:F.hueWeight)??4),satWeight:D(vn.satWeight,(F==null?void 0:F.satWeight)??2),valWeight:D(vn.valWeight,(F==null?void 0:F.valWeight)??1),sensitivity:D(vn.sensitivity,(F==null?void 0:F.sensitivity)??0)})))};return window.addEventListener("storage",b),()=>{if(v=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),u.current&&(u.current.getTracks().forEach(z=>z.stop()),u.current=null),d.current&&(d.current.getTracks().forEach(z=>z.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const M=e.current;M&&(M.srcObject=null);const F=t.current;F&&(F.srcObject=null),window.removeEventListener("storage",b)}},[]);const ye=async(v,R,b)=>{const M={video:{deviceId:{exact:v}}};Jt("Starting camera with deviceId:",v);const F=await navigator.mediaDevices.getUserMedia(M);b.current=F;const z=R.current;if(!z){Jt("Video element not found!");return}z.srcObject=F,Jt("Stream assigned to video element, waiting for metadata..."),await new Promise(W=>{if(z.readyState>=2&&z.videoWidth>0&&z.videoHeight>0)return Jt("Video already ready:",z.videoWidth,"x",z.videoHeight),W();const ge=()=>{Jt("loadedmetadata event fired:",z.videoWidth,"x",z.videoHeight),z.removeEventListener("loadedmetadata",ge),W()};z.addEventListener("loadedmetadata",ge,{once:!0}),setTimeout(()=>{Jt("Metadata timeout - proceeding anyway"),z.removeEventListener("loadedmetadata",ge),W()},2e3)});try{await z.play(),Jt("Video play() succeeded")}catch(W){Jt("Video play() failed:",W)}},ne=N.useRef(null),oe=N.useRef(null),re=N.useRef(null),we=N.useRef(!1),Te=async()=>{if(!we.current){we.current=!0;try{for(;oe.current||re.current;){const v=s.current;if(!v)break;let R=null,b=null;if(oe.current?(R="A",b=oe.current,oe.current=null):re.current&&(R="B",b=re.current,re.current=null),!!b){ne.current=R;try{await v.send({image:b})}catch(M){console.error("[Detector2] hands.send error:",M);break}}}}finally{we.current=!1}}},Le=(v,R)=>{v==="A"?oe.current=R:re.current=R,Promise.resolve().then(Te)},$e=async()=>{if(s.current)return s.current;try{const v=await(async()=>{try{if(typeof iu.Hands=="function")return iu.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const b=document.getElementById("mp-hands-cdn-script");if(b&&(await new Promise(M=>{if(window.Hands&&typeof window.Hands=="function")return M();const F=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(F),M())},50);setTimeout(()=>{clearInterval(F),M()},3e3)}),window.Hands&&typeof window.Hands=="function")||(b||await new Promise((M,F)=>{const z=document.createElement("script");z.id="mp-hands-cdn-script",z.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",z.async=!0,z.onload=()=>M(),z.onerror=W=>F(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(z)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),R=new v({locateFile:b=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${b}`});return R.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),R.onResults(b=>{const M=ne.current;M==="A"?Q(b):M==="B"&&me(b)}),s.current=R,R}catch(v){return console.error("MediaPipe initialization error:",v),m(`MediaPipe error: ${v.message}`),null}},Oe=async(v,R,b)=>{if(!await $e())return;const F=R.current;if(!F){Jt(`Video ref for ${v} not found`);return}Jt(`Initializing manual frame capture for camera ${v}, video dimensions:`,F.videoWidth,"x",F.videoHeight);let z=null;const W=()=>{const fe=R.current;fe&&fe.readyState>=2&&fe.videoWidth>0&&Le(v,fe),z=requestAnimationFrame(W)};z=requestAnimationFrame(W),b.current={stop:()=>{z&&(cancelAnimationFrame(z),z=null,Jt(`Stopped manual frame capture for camera ${v}`))}},Jt(`Manual frame capture started for camera ${v}`)},De=N.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),Y=N.useRef({wristY:null,player:"None",landmarks:null,wristX:null});N.useEffect(()=>{j.current=C},[C]),N.useEffect(()=>{T.current=y},[y]),N.useEffect(()=>{V.current=H},[H]);const Q=v=>ue(v,n,"A"),me=v=>ue(v,r,"B"),ue=(v,R,b)=>{var ut;const M=R.current;if(!M)return;const F=M.getContext("2d");if(!F)return;const z=b==="A"?e.current:t.current;if(!z||z.videoWidth===0||z.videoHeight===0){b==="A"?De.current={wristY:null,wristX:null,landmarks:null,player:"None"}:Y.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}M.width=z.videoWidth,M.height=z.videoHeight,F.drawImage(z,0,0,M.width,M.height),F.fillStyle="rgba(0, 0, 0, 0.6)",F.fillRect(M.width-80,5,75,20),F.fillStyle="white",F.font="bold 14px Arial",F.fillText(`Camera ${b}`,M.width-75,20);let W=null,fe=null,ge=null,Ce=[];if(v.multiHandLandmarks&&v.multiHandLandmarks.length>0)for(const He of v.multiHandLandmarks){const ze=He[0],Ge=ze.x*M.width,qe=ze.y*M.height;Ce.push({x:Ge,y:qe,landmarks:He}),(W===null||(O?qe<W:qe>W))&&(W=qe,fe=He,ge=Ge)}Ce.forEach(({x:He,y:ze})=>{F.fillStyle="orange",F.beginPath(),F.arc(He,ze,8,0,Math.PI*2),F.fill()});let Ie="None";if(fe){F.fillStyle="lime",F.beginPath(),F.arc(ge,W,10,0,2*Math.PI),F.fill(),F.fillStyle="lime",F.font="16px Arial",F.fillText("SELECTED",ge-40,W-15);const ze=Math.max(10,Math.min(300,Math.floor(((ut=V.current)==null?void 0:ut.roiSize)||60)))/2,Ge=Math.max(0,ge-ze),qe=Math.max(0,W-ze),xt=Math.min(M.width,ge+ze),$n=Math.min(M.height,W+ze),mt=Math.max(0,Math.floor(Ge)),Ut=Math.max(0,Math.floor(qe));let Tt=Math.floor(xt-Ge),nn=Math.floor($n-qe);if(Tt=Math.max(1,Tt),nn=Math.max(1,nn),Tt=Math.min(Tt,M.width-mt),nn=Math.min(nn,M.height-Ut),Tt>0&&nn>0){F.strokeStyle="lime",F.lineWidth=3,F.strokeRect(mt,Ut,Tt,nn);try{const mn=F.getImageData(mt,Ut,Tt,nn),gn=j.current,yn=T.current;Ie=U(mn,gn,yn).status}catch(mn){console.warn("[Detector2] ROI sampling failed:",mn),Ie="None"}}else Jt("ROI skipped due to zero width/height",{width:Tt,height:nn,left:mt,top:Ut})}if(Ce.length>=1){let He=Ce[0].y,ze=Ce[0].y;Ce.forEach(xt=>{xt.y<He&&(He=xt.y),xt.y>ze&&(ze=xt.y)}),F.strokeStyle="yellow",F.setLineDash([6,4]),F.beginPath(),F.moveTo(0,O?He:ze),F.lineTo(M.width,O?He:ze),F.stroke(),F.strokeStyle="cyan",F.beginPath(),F.moveTo(0,O?ze:He),F.lineTo(M.width,O?ze:He),F.stroke(),F.setLineDash([]);const Ge=O?"A (top)":"A (bottom)",qe=O?"B (bottom)":"B (top)";F.fillStyle="lime",F.font="16px Arial",F.fillText(Ge,6,Math.max(14,(O?He:ze)-6)),F.fillStyle="dodgerblue",F.fillText(qe,6,Math.min(M.height-6,(O?ze:He)+18))}const Ue={wristY:W,wristX:ge,landmarks:fe,player:Ie};b==="A"?De.current=Ue:Y.current=Ue;const Ze=De.current.wristY,nt=Y.current.wristY;let lt="None";if(Ze!=null||nt!=null){const He=O?(Ge,qe)=>Ge==null?qe:Math.min(Ge,qe):(Ge,qe)=>Ge==null?qe:Math.max(Ge,qe);[Ze,nt].filter(Ge=>Ge!=null).reduce(He,null)===Ze?lt=De.current.player:lt=Y.current.player}B({camA:De.current.player,camB:Y.current.player,merged:lt})},P=(v,R,b)=>{v/=255,R/=255,b/=255;const M=Math.max(v,R,b),F=Math.min(v,R,b),z=M-F;let W=0;z!==0&&(M===v?W=60*((R-b)/z%6):M===R?W=60*((b-v)/z+2):W=60*((v-R)/z+4)),W<0&&(W+=360);const fe=M===0?0:z/M*255,ge=M*255;return[W/2,fe,ge]},U=(v,R,b)=>{var ge,Ce,Ie,Ue;const M=v.data;if(R&&!b)return{status:"Player A",percentA:null,percentB:null};if(b&&!R)return{status:"Player B",percentA:null,percentB:null};const F=((ge=V.current)==null?void 0:ge.hueWeight)??4,z=((Ce=V.current)==null?void 0:Ce.satWeight)??2,W=((Ie=V.current)==null?void 0:Ie.valWeight)??1,fe=((Ue=V.current)==null?void 0:Ue.sensitivity)??0;if(R&&b){let Ze=0,nt=0,lt=0;for(let Ge=0;Ge<M.length;Ge+=4){const qe=M[Ge],xt=M[Ge+1],$n=M[Ge+2],[mt,Ut,Tt]=P(qe,xt,$n),nn=Math.min(1,Math.max(0,Ut/255)),mn=Math.min(1,Math.max(0,Tt/255)),gn=Math.max(.05,.5*nn+.5*mn),yn=Math.min(Math.abs(mt-R.h),180-Math.abs(mt-R.h)),_n=Math.min(Math.abs(mt-b.h),180-Math.abs(mt-b.h)),Qr=Math.abs(Ut-R.s),Dn=Math.abs(Ut-b.s),Lr=Math.abs(Tt-R.v),Br=Math.abs(Tt-b.v),gs=yn*F+Qr*z+Lr*W,Qt=_n*F+Dn*z+Br*W;Math.min(gs,Qt)>180||(gs<=Qt?Ze+=gn:nt+=gn,lt+=gn)}if(lt===0)return{status:"None",percentA:0,percentB:0};const ut=Ze/Math.max(1e-6,lt),He=nt/Math.max(1e-6,lt),ze=.12*(1+.8*Math.max(0,Math.min(1,fe)));return ut>=ze&&ut>=He?{status:"Player A",percentA:ut,percentB:He}:He>=ze&&He>ut?{status:"Player B",percentA:ut,percentB:He}:{status:"None",percentA:ut,percentB:He}}return{status:"None",percentA:0,percentB:0}},J=(v,R,b)=>{const M=(v||0)*2,F=(R||0)/255,z=(b||0)/255,W=z*F,fe=W*(1-Math.abs(M/60%2-1)),ge=z-W;let Ce=0,Ie=0,Ue=0;M>=0&&M<60?(Ce=W,Ie=fe,Ue=0):M<120?(Ce=fe,Ie=W,Ue=0):M<180?(Ce=0,Ie=W,Ue=fe):M<240?(Ce=0,Ie=fe,Ue=W):M<300?(Ce=fe,Ie=0,Ue=W):(Ce=W,Ie=0,Ue=fe);const Ze=Math.round((Ce+ge)*255),nt=Math.round((Ie+ge)*255),lt=Math.round((Ue+ge)*255);return`rgb(${Ze}, ${nt}, ${lt})`},de=v=>v?J(v.h,v.s,v.v):"#ffffff",$=async(v,R)=>{try{if(v==="A"){if(te(R),i.current){try{i.current.stop()}catch(M){Jt("Stop camA error:",M)}i.current=null}u.current&&(u.current.getTracks().forEach(M=>M.stop()),u.current=null);const b=e.current;b&&(b.srcObject=null),await new Promise(M=>setTimeout(M,100)),await ye(R,e,u),await new Promise(M=>setTimeout(M,200)),await $e(),await Oe("A",e,i),Jt("Camera A switched to:",R)}else{if(ve(R),a.current){try{a.current.stop()}catch(M){Jt("Stop camB error:",M)}a.current=null}d.current&&(d.current.getTracks().forEach(M=>M.stop()),d.current=null);const b=t.current;b&&(b.srcObject=null),await new Promise(M=>setTimeout(M,100)),await ye(R,t,d),await new Promise(M=>setTimeout(M,200)),await $e(),await Oe("B",t,a),Jt("Camera B switched to:",R)}}catch(b){console.error("[Detector2] Camera switch error:",b),m(`Camera switch error: ${b.message}`)}};return l.jsxs("div",{className:`detector-window ${w?"minimized":""}`,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:()=>S(!w),children:w?"":""}),l.jsx("button",{onClick:()=>X(!O),title:"Toggle A criterion",children:O?"A=Top":"A=Bottom"})]})]}),l.jsxs("div",{className:"detector-content",style:{display:w?"none":"block"},children:[l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera A:"}),l.jsx("select",{value:q,onChange:v=>$("A",v.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(v=>l.jsx("option",{value:v.deviceId,children:v.label||`Camera ${v.deviceId.slice(0,8)}`},v.deviceId))})]}),l.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:n,className:"output_canvas"})]}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera B:"}),l.jsx("select",{value:Se,onChange:v=>$("B",v.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:K.map(v=>l.jsx("option",{value:v.deviceId,children:v.label||`Camera ${v.deviceId.slice(0,8)}`},v.deviceId))})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),l.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[l.jsxs("div",{className:"status-display",children:["Merged: ",l.jsx("strong",{children:_.merged})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:C?de(C):"#444"}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:y?de(y):"#444"}})]})]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",C?`h${Math.round(C.h)} s${Math.round(C.s)} v${Math.round(C.v)}`:""]}),l.jsxs("div",{children:["B: ",y?`h${Math.round(y.h)} s${Math.round(y.s)} v${Math.round(y.v)}`:""]})]}),h&&l.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),l.jsxs("div",{style:{fontSize:12,marginTop:6},children:[l.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const Ho=Lu(),w1=e=>{var i,a,u,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((m,w)=>typeof w.elapsed=="number"&&w.elapsed>m?w.elapsed:m,0),r={},s={};return t.forEach(m=>{const w=(m==null?void 0:m.player)||"Unknown";r[w]=(r[w]||0)+1;const S=(m==null?void 0:m.phase)||"unknown";s[S]=(s[S]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((u=(a=e.metadata)==null?void 0:a.config)==null?void 0:u.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},hx=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},x1="adminPassword";function px(){var K;const[e,t]=N.useState([]),[n,r]=N.useState(!0),[s,i]=N.useState(null),[a,u]=N.useState(null),[d,h]=N.useState(null),[m,w]=N.useState(!1),[S,_]=N.useState(null),[B,O]=N.useState(!1),[X,C]=N.useState(""),[g,y]=N.useState(!1);N.useEffect(()=>{const ee=localStorage.getItem(x1);ee&&C(ee)},[]);const E=N.useCallback(async()=>{if(!X){i("Password required"),r(!1);return}r(!0),i(null),y(!1);try{const ee=await fetch(`${Ho}/sessions`,{headers:{"x-admin-password":X}});if(ee.status===401||ee.status===403)throw y(!0),new Error("Invalid password");if(!ee.ok)throw new Error(`Failed to load sessions (${ee.status})`);const q=await ee.json(),te=Array.isArray(q)?q:[];localStorage.setItem(x1,X),t(te),u(Se=>Se&&te.some(ve=>ve.sessionGameId===Se)?Se:te.length>0?te[0].sessionGameId:null)}catch(ee){console.error("[Admin] Error fetching sessions:",ee),i(ee.message||"Failed to load sessions"),t([]),u(null)}finally{r(!1)}},[X]);N.useEffect(()=>{E()},[E]),N.useEffect(()=>{if(!a){h(null);return}let ee=!1;return(async()=>{if(X){w(!0),_(null);try{const te=await fetch(`${Ho}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":X}});if(!te.ok)throw te.status===404?new Error("Session not found"):new Error(`Failed to load session (${te.status})`);const Se=await te.json();ee||h(w1(Se))}catch(te){console.error("[Admin] Error fetching session detail:",te),ee||(_(te.message||"Failed to load session"),h(null))}finally{ee||w(!1)}}})(),()=>{ee=!0}},[a]);const j=ee=>{u(ee),O(!1)},T=async()=>{if(!a||!X)return;const ee=!B;O(ee),w(!0),_(null);try{const q=ee?`${Ho}/sessions/${encodeURIComponent(a)}/experiment-only`:`${Ho}/sessions/${encodeURIComponent(a)}`,te=await fetch(q,{headers:{"x-admin-password":X}});if(!te.ok)throw new Error(`Failed to load session data (${te.status})`);const Se=await te.json();h(w1(Se))}catch(q){console.error("[Admin] Error loading session data:",q),_(q.message||"Failed to load session data"),O(!ee)}finally{w(!1)}},D=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},H=()=>{if(!d)return;const ee=JSON.stringify(d,null,2),q=new Blob([ee],{type:"application/json"}),te=URL.createObjectURL(q),Se=document.createElement("a");Se.href=te;const ve=`${a}_${new Date().toISOString().split("T")[0]}.json`;Se.download=ve,Se.click(),URL.revokeObjectURL(te),console.log("[Admin] Downloaded JSON:",ve)},se=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const ee=new Set;d.moves.forEach(re=>{Object.keys(re).forEach(we=>{we!=="camera_frame"&&we!=="__v"&&ee.add(we)})});const q=Array.from(ee),te=[q.join(",")];d.moves.forEach(re=>{const we=q.map(Te=>{const Le=re[Te];return Le==null||Le===""?"":Array.isArray(Le)||typeof Le=="object"?`"${JSON.stringify(Le).replace(/"/g,'""')}"`:`"${String(Le).replace(/"/g,'""')}"`});te.push(we.join(","))});const Se=te.join(`
`),ve=new Blob([Se],{type:"text/csv;charset=utf-8;"}),ye=URL.createObjectURL(ve),ne=document.createElement("a");ne.href=ye;const oe=`${a}_${new Date().toISOString().split("T")[0]}.csv`;ne.download=oe,ne.click(),URL.revokeObjectURL(ye),console.log("[Admin] Downloaded CSV:",oe)},V=async(ee,q)=>{if(!(!a||!ee||!X))try{const te=await fetch(`${Ho}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(ee)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":X},body:JSON.stringify({player:q})});if(!te.ok)throw new Error(`Failed to update player (${te.status})`);h(Se=>Se&&{...Se,moves:Se.moves.map(ve=>ve._id===ee?{...ve,player:q}:ve)}),console.log("[Admin] Player updated:",ee,q)}catch(te){console.error("[Admin] Error updating player:",te),alert("Failed to update player: "+te.message)}};return l.jsxs("div",{className:"admin-container",children:[l.jsxs("aside",{className:"admin-sidebar",children:[l.jsxs("div",{className:"admin-sidebar-header",children:[l.jsx("h1",{children:"Admin"}),l.jsxs("div",{className:"admin-password-row",children:[l.jsx("input",{type:"password",className:`admin-password-input ${g?"error":""}`,placeholder:"Password",value:X,onChange:ee=>C(ee.target.value),onKeyPress:ee=>{ee.key==="Enter"&&E()}}),l.jsx("button",{className:"admin-refresh-button",onClick:E,disabled:n||!X,children:n?"Refreshing":"Refresh"})]})]}),s&&l.jsx("div",{className:"admin-error",children:s}),l.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&l.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&l.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(ee=>{const q=typeof ee.movesCount=="number"?ee.movesCount:Array.isArray(ee.moves)?ee.moves.length:0,te=ee.sessionGameId===a;return l.jsxs("button",{className:`admin-session-card ${te?"active":""}`,onClick:()=>j(ee.sessionGameId),children:[l.jsx("div",{className:"admin-session-id",children:ee.sessionGameId}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Participant: ",ee.subjectId||""]}),l.jsxs("span",{children:["Condition: ",ee.condition||""]})]}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Moves: ",q]}),l.jsxs("span",{children:["Updated: ",hx(ee.updatedAt)]})]})]},ee.sessionGameId)})]})]}),l.jsxs("main",{className:"admin-content",children:[m&&l.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),S&&l.jsx("div",{className:"admin-error admin-error--content",children:S}),!m&&!S&&d&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"admin-toolbar",children:[l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[l.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),l.jsx("button",{className:`admin-toolbar-button experiment-toggle ${B?"active":""}`,onClick:T,title:B?"Show all moves (including practice)":"Show only experiment phase moves",children:B?"Show All Moves":"Experiment Only"}),l.jsx("button",{className:"admin-toolbar-button edit-players",onClick:D,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[l.jsx("button",{className:"admin-toolbar-button download-json",onClick:H,title:"Download session data as JSON",children:"Download JSON"}),l.jsx("button",{className:"admin-toolbar-button download-csv",onClick:se,title:"Download moves as CSV",children:"Download CSV"})]})]}),l.jsx("div",{className:"admin-summary-wrapper",children:l.jsx(Q2,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((K=d.sessionInfo)==null?void 0:K.sessionGameId)||a||""}${B?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:V})})]}),!m&&!S&&!d&&l.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const S1="adminPassword";function mx(){const[e,t]=N.useState(null),[n,r]=N.useState(!1),[s,i]=N.useState(null),[a,u]=N.useState(null),[d,h]=N.useState(null),[m,w]=N.useState(""),[S,_]=N.useState(!1);N.useEffect(()=>{const X=localStorage.getItem(S1);X&&w(X)},[]);const B=X=>{const C=X.target.files[0];if(!C)return;if(!C.name.endsWith(".json")){u("Please select a JSON file"),t(null);return}t(C),u(null),i(null);const g=new FileReader;g.onload=y=>{var E;try{const j=JSON.parse(y.target.result);h({sessionGameId:j.sessionGameId||"N/A",subjectId:j.subjectId||"N/A",condition:j.condition||"N/A",date:j.date||"N/A",movesCount:((E=j.moves)==null?void 0:E.length)||0,hasColorA:!!j.colorA,hasColorB:!!j.colorB})}catch(j){u("Invalid JSON file: "+j.message),h(null)}},g.readAsText(C)},O=async()=>{var X;if(!e){u("Please select a file first");return}r(!0),u(null),i(null);try{const C=await new Promise((T,D)=>{const H=new FileReader;H.onload=se=>T(se.target.result),H.onerror=D,H.readAsText(e)}),g=JSON.parse(C);if(!g.sessionGameId||!g.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!m)throw new Error("Admin password is required. Please enter it below.");const y=await fetch(`${Lu()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":m},body:JSON.stringify(g)}),E=await y.json();if(y.status===401||y.status===403)throw _(!0),new Error(E.message||"Invalid admin password");if(!y.ok)throw new Error(E.message||"Upload failed");localStorage.setItem(S1,m),_(!1),i(` Successfully uploaded session "${g.sessionGameId}" with ${((X=g.moves)==null?void 0:X.length)||0} moves`),t(null),h(null);const j=document.getElementById("json-file-input");j&&(j.value="")}catch(C){u(C.message||"Failed to upload file")}finally{r(!1)}};return l.jsx("div",{className:"admin-upload-container",children:l.jsxs("div",{className:"admin-upload-card",children:[l.jsx("h1",{children:"Admin: Upload Session JSON"}),l.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),l.jsxs("div",{className:"admin-upload-form",children:[l.jsxs("div",{className:"password-input-wrapper",children:[l.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),l.jsx("input",{id:"admin-password",type:"password",value:m,onChange:X=>{w(X.target.value),_(!1)},placeholder:"Enter admin password",className:S?"error":""}),S&&l.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),l.jsxs("div",{className:"file-input-wrapper",children:[l.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:B,disabled:n}),l.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&l.jsxs("div",{className:"file-preview",children:[l.jsx("h3",{children:"File Preview"}),l.jsxs("div",{className:"preview-grid",children:[l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Condition:"})," ",d.condition]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Date:"})," ",d.date]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&l.jsxs("div",{className:"error-message",children:[l.jsx("strong",{children:"Error:"})," ",a]}),s&&l.jsx("div",{className:"success-message",children:s}),l.jsx("button",{className:"upload-button",onClick:O,disabled:!e||!m||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var pi=typeof self<"u"?self:{};function qs(){throw Error("Invalid UTF8")}function k1(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let fl,Yc;const gx=typeof TextDecoder<"u";let yx;const vx=typeof TextEncoder<"u";function J2(e){if(vx)e=(yx||(yx=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var vh,ou;e:{for(var A1=["CLOSURE_FLAGS"],Xc=pi,Kc=0;Kc<A1.length;Kc++)if((Xc=Xc[A1[Kc]])==null){ou=null;break e}ou=Xc}var Na,E1=ou&&ou[610401301];vh=E1!=null&&E1;const C1=pi.navigator;function of(e){return!!vh&&!!Na&&Na.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function dr(e){var t;return(t=pi.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function Cs(){return!!vh&&!!Na&&Na.brands.length>0}function Qc(){return Cs()?of("Chromium"):(dr("Chrome")||dr("CriOS"))&&!(!Cs()&&dr("Edge"))||dr("Silk")}function wh(e){return wh[" "](e),e}Na=C1&&C1.userAgentData||null,wh[" "]=function(){};var wx=!Cs()&&(dr("Trident")||dr("MSIE"));!dr("Android")||Qc(),Qc(),dr("Safari")&&(Qc()||!Cs()&&dr("Coast")||!Cs()&&dr("Opera")||!Cs()&&dr("Edge")||(Cs()?of("Microsoft Edge"):dr("Edg/"))||Cs()&&of("Opera"));var q2={},Qo=null;function xx(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function u(h){for(;d<i.length;){const m=i.charAt(d++),w=Qo[m];if(w!=null)return w;if(!/^[\s\xa0]*$/.test(m))throw Error("Unknown base64 encoding at char: "+m)}return h}Z2();let d=0;for(;;){const h=u(-1),m=u(0),w=u(64),S=u(64);if(S===64&&h===-1)break;a(h<<2|m>>4),w!=64&&(a(m<<4&240|w>>2),S!=64&&a(w<<6&192|S))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function Z2(){if(!Qo){Qo={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));q2[n]=r;for(let s=0;s<r.length;s++){const i=r[s];Qo[i]===void 0&&(Qo[i]=s)}}}}var ey=typeof Uint8Array<"u",ty=!wx&&typeof btoa=="function";function _1(e){if(!ty){var t;t===void 0&&(t=0),Z2(),t=q2[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],u=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=u+s+i+a}switch(u=0,a=r,e.length-d){case 2:a=t[(15&(u=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|u>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const j1=/[-_.]/g,Sx={"-":"+",_:"/",".":"="};function kx(e){return Sx[e]||""}function ny(e){if(!ty)return xx(e);j1.test(e)&&(e=e.replace(j1,kx)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function Fa(e){return ey&&e!=null&&e instanceof Uint8Array}var lo={};function mi(){return Ax||(Ax=new is(null,lo))}function xh(e){ry(lo);var t=e.g;return(t=t==null||Fa(t)?t:typeof t=="string"?ny(t):null)==null?t:e.g=t}var is=class{h(){return new Uint8Array(xh(this)||0)}constructor(e,t){if(ry(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let Ax,Ex;function ry(e){if(e!==lo)throw Error("illegal external caller")}function sy(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function af(e){return sy(e=Error(e),"warning"),e}var Bu=typeof Symbol=="function"&&typeof Symbol()=="symbol",Cx=new Set;function Oa(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&Cx.add(e),e}var _x=Oa("jas",void 0,!0,!0),N1=Oa(void 0,"0di"),Jc=Oa(void 0,"2ex"),Go=Oa(void 0,"1oa",!0),uo=Oa(void 0,Symbol(),!0);const Me=Bu?_x:"Ga",iy={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},oy=Object.defineProperties;function Fu(e,t){Bu||Me in e||oy(e,iy),e[Me]|=t}function Ht(e,t){Bu||Me in e||oy(e,iy),e[Me]=t}function ko(e){return Fu(e,34),e}function jx(e,t){Ht(t,-30975&(0|e))}function lf(e,t){Ht(t,-30941&(34|e))}function Sh(){return typeof BigInt=="function"}function Bn(e){return Array.prototype.slice.call(e)}var kh,$a={},ay={};function b1(e){return!(!e||typeof e!="object"||e.Ia!==ay)}function Ah(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function Eh(e,t){if(e!=null){if(typeof e=="string")e=e?new is(e,lo):mi();else if(e.constructor!==is)if(Fa(e))e=e.length?new is(new Uint8Array(e),lo):mi();else{if(!t)throw Error();e=void 0}}return e}function au(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[Me]))}const M1=[];function Vs(e){if(2&e)throw Error()}Ht(M1,55),kh=Object.freeze(M1);class lu{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new lu(this.g,this.h,this.m)}}function Ch(e){return uo?e[uo]:void 0}var Nx=Object.freeze({});function Ou(e){return e.Qa=!0,e}var bx=Ou(e=>typeof e=="number"),T1=Ou(e=>typeof e=="string"),Mx=Ou(e=>typeof e=="boolean"),$u=typeof pi.BigInt=="function"&&typeof pi.BigInt(0)=="bigint",uf=Ou(e=>$u?e>=Px&&e<=Rx:e[0]==="-"?P1(e,Tx):P1(e,Ix));const Tx=Number.MIN_SAFE_INTEGER.toString(),Px=$u?BigInt(Number.MIN_SAFE_INTEGER):void 0,Ix=Number.MAX_SAFE_INTEGER.toString(),Rx=$u?BigInt(Number.MAX_SAFE_INTEGER):void 0;function P1(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const Lx=typeof Uint8Array.prototype.slice=="function";let ly,ct=0,Bt=0;function I1(e){const t=e>>>0;ct=t,Bt=(e-t)/4294967296>>>0}function co(e){if(e<0){I1(-e);const[t,n]=bh(ct,Bt);ct=t>>>0,Bt=n>>>0}else I1(e)}function _h(e){const t=ly||(ly=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),Bt=0,ct=t.getUint32(0,!0)}function jh(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:ba(e,t)}function Nh(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=jh(e,t))=="number"?n?-e:e:n?"-"+e:e}function ba(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else Sh()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+R1(n)+R1(e));return n}function R1(e){return e=String(e),"0000000".slice(e.length)+e}function Du(e){if(e.length<16)co(Number(e));else if(Sh())e=BigInt(e),ct=Number(e&BigInt(4294967295))>>>0,Bt=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");Bt=ct=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));Bt*=1e6,ct=1e6*ct+i,ct>=4294967296&&(Bt+=Math.trunc(ct/4294967296),Bt>>>=0,ct>>>=0)}if(t){const[r,s]=bh(ct,Bt);ct=r,Bt=s}}}function bh(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const Mh=typeof BigInt=="function"?BigInt.asIntN:void 0,Bx=typeof BigInt=="function"?BigInt.asUintN:void 0,Qi=Number.isSafeInteger,Uu=Number.isFinite,uu=Math.trunc;function Ys(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function uy(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const Fx=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function zu(e){switch(typeof e){case"bigint":return!0;case"number":return Uu(e);case"string":return Fx.test(e);default:return!1}}function Ao(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Uu(e)?0|e:void 0}function cy(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Uu(e)?e>>>0:void 0}function L1(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Th(e){return e=uu(e),Qi(e)||(co(e),e=Nh(ct,Bt)),e}function Ph(e){var t=uu(Number(e));if(Qi(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if(Du(e),e=ct,2147483648&(t=Bt))if(Sh())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=bh(e,t);e="-"+ba(n,r)}else e=ba(e,t);return e}function cu(e){return e==null?e:typeof e=="bigint"?(uf(e)?e=Number(e):(e=Mh(64,e),e=uf(e)?Number(e):String(e)),e):zu(e)?typeof e=="number"?Th(e):Ph(e):void 0}function Ox(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(Bx(64,e));if(zu(e)){if(t==="string")return t=uu(Number(e)),Qi(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),L1(e)||(Du(e),e=ba(ct,Bt))),e;if(t==="number")return(e=uu(e))>=0&&Qi(e)?e:function(n){if(n<0){co(n);var r=ba(ct,Bt);return n=Number(r),Qi(n)?n:r}return L1(r=String(n))?r:(co(n),jh(ct,Bt))}(e)}}function dy(e){if(typeof e!="string")throw Error();return e}function Eo(e){if(e!=null&&typeof e!="string")throw Error();return e}function fo(e){return e==null||typeof e=="string"?e:void 0}function Ih(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===$a)return e;if(!Array.isArray(e))return n?2&r?((e=t[N1])||(ko((e=new t).u),e=t[N1]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[Me];return s===0&&(s|=32&r),s|=2&r,s!==n&&Ht(e,s),new t(e)}function $x(e,t,n){if(t)e:{if(!zu(t=e))throw af("int64");switch(typeof t){case"string":t=Ph(t);break e;case"bigint":if(e=t=Mh(64,t),T1(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(bx(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=$u?BigInt(t):Mx(t)?t?"1":"0":T1(t)?t.trim()||"0":String(t);break e;default:t=Th(t)}}else t=cu(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&Qi(t=+n)?t:n}const Dx={};let Ux=function(){try{return wh(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class qc{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const zx=Ux?(Object.setPrototypeOf(qc.prototype,Map.prototype),Object.defineProperties(qc.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),qc):class extends Map{constructor(){super()}};function B1(e){return e}function Zc(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var yr=class extends zx{constructor(e,t,n=B1,r=B1){super();let s=0|e[Me];s|=64,Ht(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?Hx:r;for(let i=0;i<e.length;i++){const a=e[i],u=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(u,d)}}na(e=F1){if(this.size!==0)return this.X(e)}X(e=F1){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){Zc(this),super.clear()}delete(e){return Zc(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new lu(e,Gx,this)}keys(){return this.Ha()}values(){var e=this.ma();return new lu(e,yr.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return Zc(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Hx(e,t,n,r,s,i){return e=Ih(e,r,n,i),s&&(e=Gu(e)),e}function F1(e){return e}function Gx(e){return[e,this.get(e)]}let Wx,fy,Vx;function O1(){return Wx||(Wx=new yr(ko([]),void 0,void 0,void 0,Dx))}function Rh(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=au(e)?void 0:s&&2&(0|e[Me])?e:Lh(e,t,n,r!==void 0,s);else if(Ah(e)){const i={};for(let a in e)i[a]=Rh(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function Lh(e,t,n,r,s){const i=r||n?0|e[Me]:0,a=r?!!(32&i):void 0;r=Bn(e);for(let u=0;u<r.length;u++)r[u]=Rh(r[u],t,n,a,s);return n&&((e=Ch(e))&&(r[uo]=Bn(e)),n(i,r)),r}function Yx(e){return Rh(e,hy,void 0,void 0,!1)}function hy(e){return e.W===$a?e.toJSON():e instanceof yr?e.na(Yx):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return uf(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(au(t))return}else{if(Fa(t))return _1(t);if(t instanceof is){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=_1(n)}if(t instanceof yr)return t.na()}}return t}(e)}function py(e){return Lh(e,hy,void 0,void 0,!1)}function Fs(e,t,n){return e=my(e,t[0],t[1],n?1:2),t!==fy&&n&&Fu(e,16384),e}function my(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[Me]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(Ah(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return Ht(e,s),e}function cf(e,t,n=lf){if(e!=null){if(ey&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[Me];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?(Ht(e,-12293&(34|r)),e):Lh(e,cf,4&r?lf:n,!0,!0))}return e.W===$a?e=2&(r=0|(n=e.u)[Me])?e:new e.constructor(Hu(n,r,!0)):e instanceof yr&&!(2&e.L)&&(n=ko(e.X(cf)),e=new yr(n,e.S,e.R,e.Y)),e}}function Hu(e,t,n){const r=n||2&t?lf:jx,s=!!(32&t);return e=function(i,a,u){const d=Bn(i);var h=d.length;const m=256&a?d[h-1]:void 0;for(h+=m?-1:0,a=512&a?1:0;a<h;a++)d[a]=u(d[a]);if(m){a=d[a]={};for(const w in m)a[w]=u(m[w])}return(i=Ch(i))&&(d[uo]=Bn(i)),d}(e,t,i=>cf(i,s,r)),Fu(e,32|(n?2:0)),e}function Gu(e){const t=e.u,n=0|t[Me];return 2&n?new e.constructor(Hu(t,n,!1)):e}function ho(e,t){return ms(e=e.u,0|e[Me],t)}function ms(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&Jc!=null&&((s=(e=Ex??(Ex={}))[Jc]||0)>=4||(e[Jc]=s+1,sy(e=Error(),"incident"),function(a){pi.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function ft(e,t,n){const r=e.u;let s=0|r[Me];return Vs(s),bt(r,s,t,n),e}function bt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},Ht(e,t|=256)):e[i]=r),t)}function bl(e,t){let n=0|(e=e.u)[Me];const r=ms(e,n,t),s=Ys(r);return s!=null&&s!==r&&bt(e,n,t,s),s}function gy(e){let t=0|(e=e.u)[Me];const n=ms(e,t,1),r=Eh(n,!0);return r!=null&&r!==n&&bt(e,t,1,r),r}function si(){return Nx===void 0?2:4}function ii(e,t,n,r,s){const i=e.u,a=2&(e=0|i[Me])?1:r;s=!!s;let u=0|(r=Bh(i,e,t))[Me];if(!(4&u)){4&u&&(r=Bn(r),u=os(u,e),e=bt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const m=n(r[d]);m!=null&&(r[h++]=m)}h<d&&(r.length=h),u=Fh(u,e),n=-4097&(20|u),u=n&=-8193,Ht(r,u),2&u&&Object.freeze(r)}return a===1||a===4&&32&u?rs(u)||(s=u,u|=2,u!==s&&Ht(r,u),Object.freeze(r)):(a===2&&rs(u)&&(r=Bn(r),u=os(u,e),u=Os(u,e,s),Ht(r,u),e=bt(i,e,t,r)),rs(u)||(t=u,u=Os(u,e,s),u!==t&&Ht(r,u))),r}function Bh(e,t,n,r){return e=ms(e,t,n,r),Array.isArray(e)?e:kh}function Fh(e,t){return e===0&&(e=os(e,t)),1|e}function rs(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function yy(e){e=Bn(e);for(let t=0;t<e.length;t++){const n=e[t]=Bn(e[t]);Array.isArray(n[1])&&(n[1]=ko(n[1]))}return e}function df(e,t,n,r){let s=0|(e=e.u)[Me];Vs(s),bt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function Co(e,t,n,r,s){Vs(t);var i=!(!(64&t)&&16384&t);const a=(s=Bh(e,t,n,s))!==kh;if(i||!a){let u=i=a?0|s[Me]:0;(!a||2&u||rs(u)||4&u&&!(32&u))&&(s=Bn(s),u=os(u,t),t=bt(e,t,n,s)),u=-13&Fh(u,t),u=Os(r?-17&u:16|u,t,!0),u!==i&&Ht(s,u)}return s}function ed(e,t){var n=ov;return $h(Oh(e=e.u),e,0|e[Me],n)===t?t:-1}function Oh(e){if(Bu)return e[Go]??(e[Go]=new Map);if(Go in e)return e[Go];const t=new Map;return Object.defineProperty(e,Go,{value:t}),t}function vy(e,t,n,r){const s=Oh(e),i=$h(s,e,t,n);return i!==r&&(i&&(t=bt(e,t,i)),s.set(n,r)),t}function $h(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];ms(t,n,a)!=null&&(s!==0&&(n=bt(t,n,s)),s=a)}return e.set(r,s),s}function Dh(e,t,n,r){let s,i=0|e[Me];if((r=ms(e,i,n,r))!=null&&r.W===$a)return(t=Gu(r))!==r&&bt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[Me];s=2&a?Fs(Hu(r,a,!1),t,!0):64&a?r:Fs(s,t,!0)}else s=Fs(void 0,t,!0);return s!==r&&bt(e,i,n,s),s}function wy(e,t,n,r){let s=0|(e=e.u)[Me];return(t=Ih(r=ms(e,s,n,r),t,!1,s))!==r&&t!=null&&bt(e,s,n,t),t}function tt(e,t,n,r=!1){if((t=wy(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[Me]))){const s=Gu(t);s!==t&&bt(e,r,n,t=s)}return t}function xy(e,t,n,r,s,i,a){e=e.u;var u=!!(2&t);const d=u?1:s;i=!!i,a&&(a=!u);var h=0|(s=Bh(e,t,r))[Me];if(!(u=!!(4&h))){var m=s,w=t;const S=!!(2&(h=Fh(h,t)));S&&(w|=2);let _=!S,B=!0,O=0,X=0;for(;O<m.length;O++){const C=Ih(m[O],n,!1,w);if(C instanceof n){if(!S){const g=!!(2&(0|C.u[Me]));_&&(_=!g),B&&(B=g)}m[X++]=C}}X<O&&(m.length=X),h|=4,h=B?16|h:-17&h,Ht(m,h=_?8|h:-9&h),S&&Object.freeze(m)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(rs(h)&&(s=Bn(s),h=os(h,t),t=bt(e,t,r,s)),n=s,a=h,m=0;m<n.length;m++)(h=n[m])!==(w=Gu(h))&&(n[m]=w);a|=8,Ht(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?rs(h)||(t=h,(h|=!s.length||16&h&&(!u||32&h)?2:2048)!==t&&Ht(s,h),Object.freeze(s)):(d===2&&rs(h)&&(Ht(s=Bn(s),h=Os(h=os(h,t),t,i)),t=bt(e,t,r,s)),rs(h)||(r=h,(h=Os(h,t,i))!==r&&Ht(s,h))),s}function fs(e,t,n){const r=0|e.u[Me];return xy(e,r,t,n,si(),!1,!(2&r))}function Pe(e,t,n,r){return r==null&&(r=void 0),ft(e,n,r)}function la(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[Me];if(Vs(s),r==null){const i=Oh(e);if($h(i,e,s,n)!==t)break e;i.set(n,0)}else s=vy(e,s,n,t);bt(e,s,t,r)}}function os(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function Os(e,t,n){return 32&t&&n||(e&=-33),e}function du(e,t,n,r){const s=0|e.u[Me];Vs(s),e=xy(e,s,n,t,2,!0),r=r??new n,e.push(r),e[Me]=2&(0|r.u[Me])?-9&e[Me]:-17&e[Me]}function hr(e,t){return Ao(ho(e,t))}function vr(e,t){return fo(ho(e,t))}function Ot(e,t){return bl(e,t)??0}function Ma(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);ft(e,t,n)}function Xr(e,t,n){if(n!=null){if(typeof n!="number"||!Uu(n))throw af("int32");n|=0}ft(e,t,n)}function _e(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);ft(e,t,n)}function fu(e,t,n){{const a=e.u;let u=0|a[Me];if(Vs(u),n==null)bt(a,u,t);else{var r=e=0|n[Me],s=rs(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=Bn(n),r=0,e=Os(e=os(e,u),u,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=dy(d);Object.is(d,h)||(i&&(n=Bn(n),r=0,e=Os(e=os(e,u),u,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=Bn(n),e=Os(e=os(e,u),u,!0)),Ht(n,e)),bt(a,u,t,n)}}}function Wu(e,t,n){Vs(0|e.u[Me]),ii(e,t,fo,2,!0).push(dy(n))}function Sy(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Uh(){return Error("Failed to read varint, encoding is invalid.")}function ky(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function zh(e){if(typeof e=="string")return{buffer:ny(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===is)return{buffer:xh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Hh(e,t){let n,r=0,s=0,i=0;const a=e.h;let u=e.g;do n=a[u++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[u++],s|=(127&n)<<i;if(li(e,u),n<128)return t(r>>>0,s>>>0);throw Uh()}function Gh(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return li(e,n),!!(127&t)}throw Uh()}function Us(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Uh();return li(e,n),s}function hs(e){return Us(e)>>>0}function ff(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],li(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function hf(e){var t=ff(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function Xx(e){return Us(e)}function td(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=zh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function li(e,t){if(e.g=t,t>e.l)throw ky(e.l,t)}function Ay(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw ky(t,e.l-n);return e.g=r,n}function Ey(e,t){if(t==0)return mi();var n=Ay(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Lx?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?mi():new is(n,lo)}yr.prototype.toJSON=void 0,yr.prototype.Ia=ay;var $1=[];function Cy(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=hs(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw Sy(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function Ml(e){switch(e.h){case 0:e.h!=0?Ml(e):Gh(e.g);break;case 1:li(e=e.g,e.g+8);break;case 2:if(e.h!=2)Ml(e);else{var t=hs(e.g);li(e=e.g,e.g+t)}break;case 5:li(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!Cy(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}Ml(e)}break;default:throw Sy(e.h,e.l)}}function Da(e,t,n){const r=e.g.l,s=hs(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function Wh(e){var t=hs(e.g),n=Ay(e=e.g,t);if(e=e.h,gx){var r,s=e;(r=Yc)||(r=Yc=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(u){if(fl===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),fl=!0}catch{fl=!1}}throw!fl&&(Yc=void 0),u}}else{t=(i=n)+t,n=[];let u,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?qs():(u=e[i++],a<194||(192&u)!=128?(i--,qs()):n.push((31&a)<<6|63&u)):a<240?i>=t-1?qs():(u=e[i++],(192&u)!=128||a===224&&u<160||a===237&&u>=160||(192&(r=e[i++]))!=128?(i--,qs()):n.push((15&a)<<12|(63&u)<<6|63&r)):a<=244?i>=t-2?qs():(u=e[i++],(192&u)!=128||u-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,qs()):(a=(7&a)<<18|(63&u)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):qs(),n.length>=8192&&(d=k1(d,n),n.length=0)}i=k1(d,n)}return i}function _y(e){const t=hs(e.g);return Ey(e.g,t)}function Vu(e,t,n){var r=hs(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var hl=[];function Kx(e){return e}let Ji;function Tr(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var Ee=class{constructor(e,t){this.u=my(e,t)}toJSON(){const e=!Ji;try{return e&&(Ji=py),jy(this)}finally{e&&(Ji=void 0)}}l(){var e=T5;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(Hu(e,0|e[Me],!1))}N(){return!!(2&(0|this.u[Me]))}};function jy(e){var t=e.u;{t=(e=Ji(t))!==t;let h=e.length;if(h){var n=e[h-1],r=Ah(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,u=!1;if(a)for(let m in a)isNaN(+m)?(i??(i={}))[m]=a[m]:(r=a[m],Array.isArray(r)&&(au(r)||b1(r)&&r.size===0)&&(r=null),r==null&&(u=!0),r!=null&&((i??(i={}))[m]=r));if(u||(i=a),i)for(let m in i){u=i;break e}u=null}a=u==null?n!=null:u!==n}for(;h>0&&((i=s[h-1])==null||au(i)||b1(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||u)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),u&&s.push(u)),d=s}else d=e}return d}function D1(e){return e?/^\d+$/.test(e)?(Du(e),new pf(ct,Bt)):null:Qx||(Qx=new pf(0,0))}Ee.prototype.W=$a,Ee.prototype.toString=function(){try{return Ji=Kx,jy(this).toString()}finally{Ji=void 0}};var pf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Qx;function U1(e){return e?/^-?\d+$/.test(e)?(Du(e),new mf(ct,Bt)):null:Jx||(Jx=new mf(0,0))}var mf=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Jx;function qi(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function _o(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function Yu(e,t){if(t>=0)_o(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function Ta(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function po(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function tr(e,t,n){_o(e.g,8*t+n)}function Vh(e,t){return tr(e,t,2),t=e.g.end(),po(e,t),t.push(e.h),t}function Yh(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function Xu(e,t,n){tr(e,t,2),_o(e.g,n.length),po(e,e.g.end()),po(e,n)}function hu(e,t,n,r){n!=null&&(t=Vh(e,t),r(n,e),Yh(e,t))}function Pr(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var Xh=Pr(),Ny=Pr(),Kh=Pr(),Qh=Pr(),by=Pr(),My=Pr(),Jh=Pr(),Ty=Pr(),Py=Pr(),jo=class{constructor(e,t,n){this.g=e,this.h=t,e=Xh,this.l=!!e&&n===e||!1}};function Ku(e,t){return new jo(e,t,Xh)}function Iy(e,t,n,r,s){hu(e,n,Fy(t,r),s)}const qx=Ku(function(e,t,n,r,s){return e.h===2&&(Da(e,Dh(t,r,n),s),!0)},Iy),Zx=Ku(function(e,t,n,r,s){return e.h===2&&(Da(e,Dh(t,r,n,!0),s),!0)},Iy);var Qu=Symbol(),qh=Symbol(),z1=Symbol(),H1=Symbol();let Ry,Ly;function vi(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(w){switch(typeof w){case"boolean":return fy||(fy=[0,void 0,!0]);case"number":return w>0?void 0:w===0?Vx||(Vx=[0,void 0]):[-w,void 0];case"string":return[0,w];case"object":return w}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Ry??(Ry=i),Ly??(Ly=r[a+1]),i=r[a+=2]));const u={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)u[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let w;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof jo?w=i:(w=qx,a--),w==null?void 0:w.l){i=r[++a],h=r;var m=a;typeof i=="function"&&(i=i(),h[m]=i),h=i}for(m=d+1,typeof(i=r[++a])=="number"&&i<0&&(m-=i,i=r[++a]);d<m;d++){const S=u[d];h?n(s,d,w,h,S):t(s,d,w,S)}}return r[e]=s}function By(e){return Array.isArray(e)?e[0]instanceof jo?e:[Zx,e]:[e,void 0]}function Fy(e,t){return e instanceof Ee?e.u:Array.isArray(e)?Fs(e,t,!1):void 0}function Zh(e,t,n,r){const s=n.g;e[t]=r?(i,a,u)=>s(i,a,u,r):s}function ep(e,t,n,r,s){const i=n.g;let a,u;e[t]=(d,h,m)=>i(d,h,m,u||(u=vi(qh,Zh,ep,r).V),a||(a=tp(r)),s)}function tp(e){let t=e[z1];if(t!=null)return t;const n=vi(qh,Zh,ep,e);return t=n.la?(r,s)=>Ry(r,s,n):(r,s)=>{const i=0|r[Me];for(;Cy(s)&&s.h!=4;){var a=s.m,u=n[a];if(u==null){var d=n.ga;d&&(d=d[a])&&(d=e5(d))!=null&&(u=n[a]=d)}u!=null&&u(s,r,a)||(a=(u=s).l,Ml(u),u.fa?u=void 0:(d=u.g.g-a,u.g.g=a,u=Ey(u.g,d)),a=r,u&&((d=a[uo])?d.push(u):a[uo]=[u]))}return 16384&i&&ko(r),!0},e[z1]=t}function e5(e){const t=(e=By(e))[0].g;if(e=e[1]){const n=tp(e),r=vi(qh,Zh,ep,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function Ju(e,t,n){e[t]=n.h}function qu(e,t,n,r){let s,i;const a=n.h;e[t]=(u,d,h)=>a(u,d,h,i||(i=vi(Qu,Ju,qu,r).V),s||(s=Oy(r)))}function Oy(e){let t=e[H1];if(!t){const n=vi(Qu,Ju,qu,e);t=(r,s)=>$y(r,s,n),e[H1]=t}return t}function $y(e,t,n){for(var r=0|e[Me],s=512&r?0:-1,i=e.length,a=512&r?1:0,u=i+(256&r?-1:0);a<u;a++){const d=e[a];if(d==null)continue;const h=a-s,m=G1(n,h);m&&m(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(u=G1(n,s))&&u(t,i,s)}if(e=Ch(e))for(po(t,t.g.end()),n=0;n<e.length;n++)po(t,xh(e[n])||new Uint8Array(0))}function G1(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=By(n))[0].h;if(n=n[1]){const s=Oy(n),i=vi(Qu,Ju,qu,n).V;n=e.la?Ly(i,s):(a,u,d)=>r(a,u,d,i,s)}else n=r;return e[t]=n}}function No(e,t){if(Array.isArray(t)){var n=0|t[Me];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),Ht(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function En(e,t,n){return new jo(e,t,n)}function bo(e,t,n){return new jo(e,t,n)}function Cn(e,t,n){bt(e,0|e[Me],t,n)}var t5=Ku(function(e,t,n,r,s){return e.h===2&&(e=Da(e,Fs([void 0,void 0],r,!0),s),Vs(r=0|t[Me]),(s=ms(t,r,n))instanceof yr?2&s.L?((s=s.X()).push(e),bt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[Me])&&bt(t,r,n,s=yy(s)),s.push(e)):bt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof yr)t.forEach((i,a)=>{hu(e,n,Fs([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&hu(e,n,Fs(a,r,!1),s)}});function Dy(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String(Mh(64,r));if(zu(r)){if(s==="string")return Ph(r);if(s==="number")return Th(r)}}(t),t!=null&&(typeof t=="string"&&U1(t),t!=null))switch(tr(e,n,0),typeof t){case"number":e=e.g,co(t),qi(e,ct,Bt);break;case"bigint":n=BigInt.asUintN(64,t),n=new mf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),qi(e.g,n.h,n.g);break;default:n=U1(t),qi(e.g,n.h,n.g)}}function Uy(e,t,n){(t=Ao(t))!=null&&t!=null&&(tr(e,n,0),Yu(e.g,t))}function zy(e,t,n){(t=uy(t))!=null&&(tr(e,n,0),e.g.g.push(t?1:0))}function Hy(e,t,n){(t=fo(t))!=null&&Xu(e,n,J2(t))}function Gy(e,t,n,r,s){hu(e,n,Fy(t,r),s)}function Wy(e,t,n){(t=t==null||typeof t=="string"||Fa(t)||t instanceof is?t:void 0)!=null&&Xu(e,n,zh(t).buffer)}function Vy(e,t,n){return(e.h===5||e.h===2)&&(t=Co(t,0|t[Me],n,!1,!1),e.h==2?Vu(e,hf,t):t.push(hf(e.g)),!0)}var Zr=En(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=ff(r);const s=ff(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,Cn(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Ys(t))!=null&&(tr(e,n,1),e=e.g,(n=ly||(ly=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),ct=n.getUint32(0,!0),Bt=n.getUint32(4,!0),Ta(e,ct),Ta(e,Bt))},Pr()),Gt=En(function(e,t,n){return e.h===5&&(Cn(t,n,hf(e.g)),!0)},function(e,t,n){(t=Ys(t))!=null&&(tr(e,n,5),e=e.g,_h(t),Ta(e,ct))},Jh),n5=bo(Vy,function(e,t,n){if((t=No(Ys,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(tr(r,s,5),r=r.g,_h(i),Ta(r,ct))}},Jh),np=bo(Vy,function(e,t,n){if((t=No(Ys,t))!=null&&t.length){tr(e,n,2),_o(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,_h(t[r]),Ta(n,ct)}},Jh),zs=En(function(e,t,n){return e.h===0&&(Cn(t,n,Hh(e.g,Nh)),!0)},Dy,My),nd=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=Hh(e.g,Nh))===0?void 0:e),!0)},Dy,My),r5=En(function(e,t,n){return e.h===0&&(Cn(t,n,Hh(e.g,jh)),!0)},function(e,t,n){if((t=Ox(t))!=null&&(typeof t=="string"&&D1(t),t!=null))switch(tr(e,n,0),typeof t){case"number":e=e.g,co(t),qi(e,ct,Bt);break;case"bigint":n=BigInt.asUintN(64,t),n=new pf(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),qi(e.g,n.h,n.g);break;default:n=D1(t),qi(e.g,n.h,n.g)}},Pr()),Ft=En(function(e,t,n){return e.h===0&&(Cn(t,n,Us(e.g)),!0)},Uy,Qh),Zu=bo(function(e,t,n){return(e.h===0||e.h===2)&&(t=Co(t,0|t[Me],n,!1,!1),e.h==2?Vu(e,Us,t):t.push(Us(e.g)),!0)},function(e,t,n){if((t=No(Ao,t))!=null&&t.length){n=Vh(e,n);for(let r=0;r<t.length;r++)Yu(e.g,t[r]);Yh(e,n)}},Qh),zi=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=Us(e.g))===0?void 0:e),!0)},Uy,Qh),Et=En(function(e,t,n){return e.h===0&&(Cn(t,n,Gh(e.g)),!0)},zy,Ny),Zi=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=Gh(e.g))===!1?void 0:e),!0)},zy,Ny),fn=bo(function(e,t,n){return e.h===2&&(e=Wh(e),Co(t,0|t[Me],n,!1).push(e),!0)},function(e,t,n){if((t=No(fo,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&Xu(r,s,J2(i))}},Kh),_s=En(function(e,t,n){return e.h===2&&(Cn(t,n,(e=Wh(e))===""?void 0:e),!0)},Hy,Kh),it=En(function(e,t,n){return e.h===2&&(Cn(t,n,Wh(e)),!0)},Hy,Kh),Xt=function(e,t,n=Xh){return new jo(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=Fs(void 0,r,!0),Co(t,0|t[Me],n,!0).push(r),Da(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)Gy(e,t[i],n,r,s)}),ot=Ku(function(e,t,n,r,s,i){return e.h===2&&(vy(t,0|t[Me],i,n),Da(e,t=Dh(t,r,n),s),!0)},Gy),Yy=En(function(e,t,n){return e.h===2&&(Cn(t,n,_y(e)),!0)},Wy,Ty),s5=bo(function(e,t,n){return(e.h===0||e.h===2)&&(t=Co(t,0|t[Me],n,!1,!1),e.h==2?Vu(e,hs,t):t.push(hs(e.g)),!0)},function(e,t,n){if((t=No(cy,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(tr(r,s,0),_o(r.g,i))}},by),i5=En(function(e,t,n){return e.h===0&&(Cn(t,n,(e=hs(e.g))===0?void 0:e),!0)},function(e,t,n){(t=cy(t))!=null&&t!=null&&(tr(e,n,0),_o(e.g,t))},by),wr=En(function(e,t,n){return e.h===0&&(Cn(t,n,Us(e.g)),!0)},function(e,t,n){(t=Ao(t))!=null&&(t=parseInt(t,10),tr(e,n,0),Yu(e.g,t))},Py);class o5{constructor(t,n){this.h=t,this.g=n,this.l=tt,this.m=Pe,this.defaultValue=void 0}}function Ir(e,t){return new o5(e,t)}function Xs(e,t){return(n,r)=>{if(hl.length){const i=hl.pop();i.o(r),td(i.g,n,r),n=i}else n=new class{constructor(i,a){if($1.length){const u=$1.pop();td(u,i,a),i=u}else i=new class{constructor(u,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,td(this,u,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;tp(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,hl.length<100&&hl.push(n)}return s}}function ec(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};$y(this.u,t,vi(Qu,Ju,qu,e)),po(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const u=r[a];n.set(u,i),i+=u.length}return t.l=[n],n}}var W1=class extends Ee{constructor(e){super(e)}},V1=[0,_s,En(function(e,t,n){return e.h===2&&(Cn(t,n,(e=_y(e))===mi()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof Ee){const r=t.Ra;return void(r&&(t=r(t),t!=null&&Xu(e,n,zh(t).buffer)))}if(Array.isArray(t))return}Wy(e,t,n)},Ty)];let rd,Y1=globalThis.trustedTypes;function X1(e){rd===void 0&&(rd=function(){let n=null;if(!Y1)return n;try{const r=s=>s;n=Y1.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=rd;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function a5(e,...t){if(t.length===0)return X1(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return X1(n)}var Xy=[0,Ft,wr,Et,-1,Zu,wr,-1],l5=class extends Ee{constructor(e){super(e)}},Ky=[0,Et,it,Et,wr,-1,bo(function(e,t,n){return(e.h===0||e.h===2)&&(t=Co(t,0|t[Me],n,!1,!1),e.h==2?Vu(e,Xx,t):t.push(Us(e.g)),!0)},function(e,t,n){if((t=No(Ao,t))!=null&&t.length){n=Vh(e,n);for(let r=0;r<t.length;r++)Yu(e.g,t[r]);Yh(e,n)}},Py),it,-1,[0,Et,-1],wr,Et,-1],Qy=[0,it,-2],K1=class extends Ee{constructor(e){super(e)}},Jy=[0],qy=[0,Ft,Et,1,Et,-3],qn=class extends Ee{constructor(e){super(e,2)}},Wt={};Wt[336783863]=[0,it,Et,-1,Ft,[0,[1,2,3,4,5,6,7,8],ot,Jy,ot,Ky,ot,Qy,ot,qy,ot,Xy,ot,[0,it,-2],ot,[0,it,wr],ot,[0,wr,it]],[0,it],Et,[0,[1,3],[2,4],ot,[0,Zu],-1,ot,[0,fn],-1,Xt,[0,it,-1]],it];var Q1=[0,nd,-1,Zi,-3,nd,Zu,_s,zi,nd,-1,Zi,zi,Zi,-2,_s];function nr(e,t){df(e,2,Eo(t),"")}function pt(e,t){Wu(e,3,t)}function Je(e,t){Wu(e,4,t)}var Sn=class extends Ee{constructor(e){super(e,500)}o(e){return Pe(this,0,7,e)}},ua=[-1,{}],J1=[0,it,1,ua],q1=[0,it,fn,ua];function rr(e,t){du(e,1,Sn,t)}function wt(e,t){Wu(e,10,t)}function st(e,t){Wu(e,15,t)}var On=class extends Ee{constructor(e){super(e,500)}o(e){return Pe(this,0,1001,e)}},Zy=[-500,Xt,[-500,_s,-1,fn,-3,[-2,Wt,Et],Xt,V1,zi,-1,J1,q1,Xt,[0,_s,Zi],_s,Q1,zi,fn,987,fn],4,Xt,[-500,it,-1,[-1,{}],998,it],Xt,[-500,it,fn,-1,[-2,{},Et],997,fn,-1],zi,Xt,[-500,it,fn,ua,998,fn],fn,zi,J1,q1,Xt,[0,_s,-1,ua],fn,-2,Q1,_s,-1,Zi,[0,Zi,i5],978,ua,Xt,V1];On.prototype.g=ec(Zy);var u5=Xs(On,Zy),c5=class extends Ee{constructor(e){super(e)}},ev=class extends Ee{constructor(e){super(e)}g(){return fs(this,c5,1)}},tv=[0,Xt,[0,Ft,Gt,it,-1]],tc=Xs(ev,tv),d5=class extends Ee{constructor(e){super(e)}},f5=class extends Ee{constructor(e){super(e)}},sd=class extends Ee{constructor(e){super(e)}h(){return tt(this,d5,2)}g(){return fs(this,f5,5)}},nv=Xs(class extends Ee{constructor(e){super(e)}},[0,fn,Zu,np,[0,wr,[0,Ft,-3],[0,Gt,-3],[0,Ft,-1,[0,Xt,[0,Ft,-2]]],Xt,[0,Gt,-1,it,Gt]],it,-1,zs,Xt,[0,Ft,Gt],fn,zs]),rv=class extends Ee{constructor(e){super(e)}},eo=Xs(class extends Ee{constructor(e){super(e)}},[0,Xt,[0,Gt,-4]]),sv=class extends Ee{constructor(e){super(e)}},Ua=Xs(class extends Ee{constructor(e){super(e)}},[0,Xt,[0,Gt,-4]]),h5=class extends Ee{constructor(e){super(e)}},p5=[0,Ft,-1,np,wr],iv=class extends Ee{constructor(e){super(e)}};iv.prototype.g=ec([0,Gt,-4,zs]);var m5=class extends Ee{constructor(e){super(e)}},g5=Xs(class extends Ee{constructor(e){super(e)}},[0,Xt,[0,1,Ft,it,tv],zs]),Z1=class extends Ee{constructor(e){super(e)}},y5=class extends Ee{constructor(e){super(e)}oa(){const e=gy(this);return e??mi()}},v5=class extends Ee{constructor(e){super(e)}},ov=[1,2],w5=Xs(class extends Ee{constructor(e){super(e)}},[0,Xt,[0,ov,ot,[0,np],ot,[0,Yy],Ft,it],zs]),rp=class extends Ee{constructor(e){super(e)}},av=[0,it,Ft,Gt,fn,-1],e0=class extends Ee{constructor(e){super(e)}},x5=[0,Et,-1],t0=class extends Ee{constructor(e){super(e)}},Tl=[1,2,3,4,5],pu=class extends Ee{constructor(e){super(e)}g(){return gy(this)!=null}h(){return vr(this,2)!=null}},Ct=class extends Ee{constructor(e){super(e)}g(){return uy(ho(this,2))??!1}},lv=[0,Yy,it,[0,Ft,zs,-1],[0,r5,zs]],Dt=[0,lv,Et,[0,Tl,ot,qy,ot,Ky,ot,Xy,ot,Jy,ot,Qy],wr],nc=class extends Ee{constructor(e){super(e)}},sp=[0,Dt,Gt,-1,Ft],S5=Ir(502141897,nc);Wt[502141897]=sp;var k5=Xs(class extends Ee{constructor(e){super(e)}},[0,[0,wr,-1,n5,s5],p5]),uv=class extends Ee{constructor(e){super(e)}},cv=class extends Ee{constructor(e){super(e)}},ip=[0,Dt,Gt,[0,Dt],Et],dv=[0,Dt,sp,ip,Gt,[0,[0,lv]]],A5=Ir(508968150,cv);Wt[508968150]=dv,Wt[508968149]=ip;var fv=class extends Ee{constructor(e){super(e)}},E5=Ir(513916220,fv);Wt[513916220]=[0,Dt,dv,Ft];var _i=class extends Ee{constructor(e){super(e)}h(){return tt(this,rp,2)}g(){ft(this,2)}},hv=[0,Dt,av];Wt[478825465]=hv;var C5=class extends Ee{constructor(e){super(e)}},pv=class extends Ee{constructor(e){super(e)}},op=class extends Ee{constructor(e){super(e)}},ap=class extends Ee{constructor(e){super(e)}},mv=class extends Ee{constructor(e){super(e)}},n0=[0,Dt,[0,Dt],hv,-1],gv=[0,Dt,Gt,Ft],lp=[0,Dt,Gt],yv=[0,Dt,gv,lp,Gt],_5=Ir(479097054,mv);Wt[479097054]=[0,Dt,yv,n0],Wt[463370452]=n0,Wt[464864288]=gv;var j5=Ir(462713202,ap);Wt[462713202]=yv,Wt[474472470]=lp;var N5=class extends Ee{constructor(e){super(e)}},vv=class extends Ee{constructor(e){super(e)}},wv=class extends Ee{constructor(e){super(e)}},xv=class extends Ee{constructor(e){super(e)}},up=[0,Dt,Gt,-1,Ft],gf=[0,Dt,Gt,Et];xv.prototype.g=ec([0,Dt,lp,[0,Dt],sp,ip,up,gf]);var Sv=class extends Ee{constructor(e){super(e)}},b5=Ir(456383383,Sv);Wt[456383383]=[0,Dt,av];var kv=class extends Ee{constructor(e){super(e)}},M5=Ir(476348187,kv);Wt[476348187]=[0,Dt,x5];var Av=class extends Ee{constructor(e){super(e)}},r0=class extends Ee{constructor(e){super(e)}},Ev=[0,wr,-1],T5=Ir(458105876,class extends Ee{constructor(e){super(e)}g(){var e=this.u;const t=0|e[Me],n=2&t;return e=function(r,s,i){var a=r0;const u=2&s;let d=!1;if(i==null){if(u)return O1();i=[]}else if(i.constructor===yr){if(!(2&i.L)||u)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[Me])):i=[];if(u){if(!i.length)return O1();d||(d=!0,ko(i))}else d&&(d=!1,i=yy(i));return d||(64&(0|i[Me])?i[Me]&=-33:32&s&&Fu(i,32)),bt(r,s,2,a=new yr(i,a,$x,void 0)),a}(e,t,ms(e,t,2)),!n&&r0&&(e.ra=!0),e}});Wt[458105876]=[0,Ev,t5,[!0,zs,[0,it,-1,fn]]];var cp=class extends Ee{constructor(e){super(e)}},Cv=Ir(458105758,cp);Wt[458105758]=[0,Dt,it,Ev];var _v=class extends Ee{constructor(e){super(e)}},P5=Ir(443442058,_v);Wt[443442058]=[0,Dt,it,Ft,Gt,fn,-1,Et,Gt],Wt[514774813]=up;var jv=class extends Ee{constructor(e){super(e)}},I5=Ir(516587230,jv);function yf(e,t){return t=t?t.clone():new rp,e.displayNamesLocale!==void 0?ft(t,1,Eo(e.displayNamesLocale)):e.displayNamesLocale===void 0&&ft(t,1),e.maxResults!==void 0?Xr(t,2,e.maxResults):"maxResults"in e&&ft(t,2),e.scoreThreshold!==void 0?_e(t,3,e.scoreThreshold):"scoreThreshold"in e&&ft(t,3),e.categoryAllowlist!==void 0?fu(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&ft(t,4),e.categoryDenylist!==void 0?fu(t,5,e.categoryDenylist):"categoryDenylist"in e&&ft(t,5),t}function dp(e,t=-1,n=""){return{categories:e.map(r=>({index:hr(r,1)??0??-1,score:Ot(r,2)??0,categoryName:vr(r,3)??""??"",displayName:vr(r,4)??""??""})),headIndex:t,headName:n}}function Nv(e){var a,u;var t=ii(e,3,Ys,si()),n=ii(e,2,Ao,si()),r=ii(e,1,fo,si()),s=ii(e,9,fo,si());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=tt(e,sd,4))==null?void 0:a.h())&&(i.boundingBox={originX:hr(t,1)??0,originY:hr(t,2)??0,width:hr(t,3)??0,height:hr(t,4)??0,angle:0}),(u=tt(e,sd,4))==null?void 0:u.g().length)for(const d of tt(e,sd,4).g())i.keypoints.push({x:bl(d,1)??0,y:bl(d,2)??0,score:bl(d,4)??0,label:vr(d,3)??""});return i}function rc(e){const t=[];for(const n of fs(e,sv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function ca(e){const t=[];for(const n of fs(e,rv,1))t.push({x:Ot(n,1)??0,y:Ot(n,2)??0,z:Ot(n,3)??0,visibility:Ot(n,4)??0});return t}function s0(e){return Array.from(e,t=>t>127?t-256:t)}function i0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let pl;Wt[516587230]=[0,Dt,up,gf,Gt],Wt[518928384]=gf;const R5=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function bv(){if(pl===void 0)try{await WebAssembly.instantiate(R5),pl=!0}catch{pl=!1}return pl}async function Wo(e,t=a5``){const n=await bv()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var ks=class{};function Mv(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function o0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function Tv(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function be(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function a0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=Tv(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function l0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function Dr(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function ws(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}ks.forVisionTasks=function(e){return Wo("vision",e)},ks.forTextTasks=function(e){return Wo("text",e)},ks.forGenAiExperimentalTasks=function(e){return Wo("genai_experimental",e)},ks.forGenAiTasks=function(e){return Wo("genai",e)},ks.forAudioTasks=function(e){return Wo("audio",e)},ks.isSimdSupported=function(){return bv()};async function L5(e,t,n,r){return e=await(async(s,i,a,u,d)=>{if(i&&await o0(i),!self.ModuleFactory||a&&(await o0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,u)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function id(e,t){const n=tt(e.baseOptions,pu,1)||new pu;typeof t=="string"?(ft(n,2,Eo(t)),ft(n,1)):t instanceof Uint8Array&&(ft(n,1,Eh(t,!1)),ft(n,2)),Pe(e.baseOptions,0,1,n)}function u0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function Ae(e,t){e.B=Math.max(e.B,t)}function sc(e,t){e.A=new Sn,nr(e.A,"PassThroughCalculator"),pt(e.A,"free_memory"),Je(e.A,"free_memory_unused_out"),wt(t,"free_memory"),rr(t,e.A)}function mo(e,t){pt(e.A,t),Je(e.A,t+"_unused_out")}function ic(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var Pl=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,u;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=tt(this.baseOptions,pu,1))!=null&&s.g()||(i=tt(this.baseOptions,pu,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(u=e.baseOptions)!=null&&u.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,m){let w=tt(h.baseOptions,t0,3);if(!w){var S=w=new t0,_=new K1;la(S,4,Tl,_)}"delegate"in m&&(m.delegate==="GPU"?(m=w,S=new l5,la(m,2,Tl,S)):(m=w,S=new K1,la(m,4,Tl,S))),Pe(h.baseOptions,0,3,w)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),id(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)id(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const m=[];for(var w=0;;){const{done:S,value:_}=await h.read();if(S)break;m.push(_),w+=_.length}if(m.length===0)return new Uint8Array(0);if(m.length===1)return m[0];h=new Uint8Array(w),w=0;for(const S of m)h.set(S,w),w+=S.length;return h}(d.modelAssetBuffer).then(h=>{id(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=u5(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,u0(this)}finishProcessing(){this.g.finishProcessing(),u0(this)}close(){this.A=void 0,this.g.closeGraph()}};function as(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Pl.prototype.close=Pl.prototype.close,function(e,t){e=e.split(".");var n,r=pi;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",Pl);class B5{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function c0(e,t,n){const r=e.g;if(n=as(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function d0(e,t){const n=e.g,r=as(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=as(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=as(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new B5(n,r,s,i)}function fp(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function hp(e,t,n,r){return fp(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=d0(e,!0)),n=e.s):(e.v||(e.v=d0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function oc(e,t,n){return fp(e,t),e=as(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function ac(e,t,n){fp(e,t),e.A||(e.A=as(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function pp(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var mp=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=as(e.createProgram(),"Failed to create WebGL program"),this.aa=c0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=c0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function es(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function vf(e){var t=es(e,1);if(!t){if(t=es(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=go(e);var n=gp(e);if(ac(n,r,Pv(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function Pv(e){let t=es(e,2);if(!t){const n=go(e);t=Rv(e);const r=vf(e),s=Iv(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),wf(e)}return t}function go(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=as(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Iv(e){if(e=go(e),!ml)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))ml=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");ml=e.R16F}return ml}function gp(e){return e.l||(e.l=new mp),e.l}function Rv(e){const t=go(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=es(e,2);return n||(n=oc(gp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function wf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var ml,qt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--f0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!es(this,0)}ja(){return!!es(this,1)}P(){return!!es(this,2)}ia(){return(t=es(e=this,0))||(t=vf(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return vf(this)}M(){return Pv(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=go(this),s=gp(this);r.activeTexture(r.TEXTURE1),n=oc(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=Iv(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),ac(s,r,n),hp(s,r,!1,()=>{Rv(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),wf(this)}),pp(s),wf(this)}}e.push(n)}return new qt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&go(this).deleteTexture(es(this,2)),f0=-1}};qt.prototype.close=qt.prototype.close,qt.prototype.clone=qt.prototype.clone,qt.prototype.getAsWebGLTexture=qt.prototype.M,qt.prototype.getAsFloat32Array=qt.prototype.ha,qt.prototype.getAsUint8Array=qt.prototype.ia,qt.prototype.hasWebGLTexture=qt.prototype.P,qt.prototype.hasFloat32Array=qt.prototype.ja,qt.prototype.hasUint8Array=qt.prototype.Fa;var f0=250;function Gr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function Lv(e){var t=Gr(e,0);if(!t){t=yo(e);const n=lc(e),r=new Uint8Array(e.width*e.height*4);ac(n,t,Il(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),pp(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function Il(e){let t=Gr(e,2);if(!t){const n=yo(e);t=Rl(e);const r=Gr(e,1)||Lv(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),Jo(e)}return t}function yo(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=as(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function lc(e){return e.l||(e.l=new mp),e.l}function Rl(e){const t=yo(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Gr(e,2);return n||(n=oc(lc(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Jo(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function h0(e){const t=yo(e);return hp(lc(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var Zt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--p0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Gr(this,0)}ka(){return!!Gr(this,1)}P(){return!!Gr(this,2)}Ca(){return Lv(this)}Ba(){var e=Gr(this,1);return e||(Il(this),Rl(this),e=h0(this),Jo(this),this.g.push(e),this.j=!0),e}M(){return Il(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=yo(this),s=lc(this);r.activeTexture(r.TEXTURE1),n=oc(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),ac(s,r,n),hp(s,r,!1,()=>{Rl(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Jo(this)}),pp(s),Jo(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Il(this),Rl(this),n=h0(this),Jo(this)}e.push(n)}return new Zt(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Gr(this,1).close(),this.m&&yo(this).deleteTexture(Gr(this,2)),p0=-1}};Zt.prototype.close=Zt.prototype.close,Zt.prototype.clone=Zt.prototype.clone,Zt.prototype.getAsWebGLTexture=Zt.prototype.M,Zt.prototype.getAsImageBitmap=Zt.prototype.Ba,Zt.prototype.getAsImageData=Zt.prototype.Ca,Zt.prototype.hasWebGLTexture=Zt.prototype.P,Zt.prototype.hasImageBitmap=Zt.prototype.ka,Zt.prototype.hasImageData=Zt.prototype.Ea;var p0=250;function Rr(...e){return e.map(([t,n])=>({start:t,end:n}))}const F5=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((m0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:Mv()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),be(this,r||"input_audio",i=>{be(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){Dr(this,"__graph_config__",t=>{e(t)}),be(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),be(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){be(this,t,r=>{const[s,i]=a0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){be(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){be(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){be(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){be(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){be(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){be(this,t,r=>{be(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){be(this,t,r=>{l0(this,Object.keys(e),s=>{l0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){be(this,n,s=>{be(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){be(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){be(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){be(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){be(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){be(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){be(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){be(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)be(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){be(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){be(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){be(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){be(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){be(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){be(this,t,n=>{be(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){be(this,n,r=>{be(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){be(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){be(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){be(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){be(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){be(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){be(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)be(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){Dr(this,e,t),be(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){ws(this,e,t),be(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){Dr(this,e,t),be(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){ws(this,e,t),be(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){Dr(this,e,t),be(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){ws(this,e,t),be(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){Dr(this,e,t),be(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){ws(this,e,t),be(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){Dr(this,e,t),be(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){ws(this,e,t),be(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){Dr(this,e,t),be(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){ws(this,e,t),be(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){Dr(this,e,t),be(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){ws(this,e,t),be(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Dr(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),be(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends m0{get ea(){return this.i}qa(e,t,n){be(this,t,r=>{const[s,i]=a0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){Dr(this,e,t),be(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){ws(this,e,t),be(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var m0,xr=class extends F5{};async function Ke(e,t,n){return async function(r,s,i,a){return L5(r,s,i,a)}(e,n.canvas??(Mv()?void 0:document.createElement("canvas")),t,n)}function Bv(e,t,n,r){if(e.T){const i=new iv;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");_e(i,1,(s.left+s.right)/2),_e(i,2,(s.top+s.bottom)/2),_e(i,4,s.right-s.left),_e(i,3,s.bottom-s.top)}else _e(i,1,.5),_e(i,2,.5),_e(i,4,1),_e(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(_e(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,u]=Tv(t);n=Ot(i,3)*u/a,s=Ot(i,4)*a/u,_e(i,4,n),_e(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function Sr(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Bv(e,t,n,e.B+1)}function Kr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Bv(e,t,n,r)}function vo(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new qt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Fn=class extends Pl{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new mp}l(e,t=!0){if("runningMode"in e&&Ma(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Fn.prototype.close=Fn.prototype.close;var or=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Pe(e=this.h=new nc,0,1,t=new Ct),_e(this.h,2,.5),_e(this.h,3,.3)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&_e(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&_e(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},Sr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Kr(this,e,n,t),this.j}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect_in"),st(e,"detections");const t=new qn;Tr(t,S5,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect_in"),Je(n,"DETECTIONS:detections"),n.o(t),rr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=nv(i),this.j.detections.push(Nv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};or.prototype.detectForVideo=or.prototype.F,or.prototype.detect=or.prototype.D,or.prototype.setOptions=or.prototype.o,or.createFromModelPath=async function(e,t){return Ke(or,e,{baseOptions:{modelAssetPath:t}})},or.createFromModelBuffer=function(e,t){return Ke(or,e,{baseOptions:{modelAssetBuffer:t}})},or.createFromOptions=function(e,t){return Ke(or,e,t)};var yp=Rr([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),vp=Rr([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),wp=Rr([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),Fv=Rr([474,475],[475,476],[476,477],[477,474]),xp=Rr([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),Sp=Rr([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Ov=Rr([469,470],[470,471],[471,472],[472,469]),kp=Rr([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),$v=[...yp,...vp,...wp,...xp,...Sp,...kp],Dv=Rr([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function g0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var Rt=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Pe(e=this.h=new cv,0,1,t=new Ct),this.v=new uv,Pe(this.h,0,3,this.v),this.s=new nc,Pe(this.h,0,2,this.s),Xr(this.s,4,1),_e(this.s,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numFaces"in e&&Xr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&_e(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return g0(this),Sr(this,e,t),this.j}F(e,t,n){return g0(this),Kr(this,e,n,t),this.j}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"face_landmarks");const t=new qn;Tr(t,A5,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),rr(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=Ua(i),this.j.faceLandmarks.push(rc(r));Ae(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{Ae(this,r)}),this.outputFaceBlendshapes&&(st(e,"blendshapes"),Je(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=tc(i),this.j.faceBlendshapes.push(dp(r.g()??[]));Ae(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{Ae(this,r)})),this.outputFacialTransformationMatrixes&&(st(e,"face_geometry"),Je(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=tt(k5(i),h5,2))&&this.j.facialTransformationMatrixes.push({rows:hr(r,1)??0??0,columns:hr(r,2)??0??0,data:ii(r,3,Ys,si()).slice()??[]});Ae(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Rt.prototype.detectForVideo=Rt.prototype.F,Rt.prototype.detect=Rt.prototype.D,Rt.prototype.setOptions=Rt.prototype.o,Rt.createFromModelPath=function(e,t){return Ke(Rt,e,{baseOptions:{modelAssetPath:t}})},Rt.createFromModelBuffer=function(e,t){return Ke(Rt,e,{baseOptions:{modelAssetBuffer:t}})},Rt.createFromOptions=function(e,t){return Ke(Rt,e,t)},Rt.FACE_LANDMARKS_LIPS=yp,Rt.FACE_LANDMARKS_LEFT_EYE=vp,Rt.FACE_LANDMARKS_LEFT_EYEBROW=wp,Rt.FACE_LANDMARKS_LEFT_IRIS=Fv,Rt.FACE_LANDMARKS_RIGHT_EYE=xp,Rt.FACE_LANDMARKS_RIGHT_EYEBROW=Sp,Rt.FACE_LANDMARKS_RIGHT_IRIS=Ov,Rt.FACE_LANDMARKS_FACE_OVAL=kp,Rt.FACE_LANDMARKS_CONTOURS=$v,Rt.FACE_LANDMARKS_TESSELATION=Dv;var Ur=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!0),Pe(e=this.j=new fv,0,1,t=new Ct)}get baseOptions(){return tt(this.j,Ct,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,Sr(this,e,r??{}),!this.h)return this.s}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"stylized_image");const t=new qn;Tr(t,E5,this.j);const n=new Sn;nr(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),rr(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,u=r.width;const d=u*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let m=0;m<d;++m)h[4*m]=a[3*m],h[4*m+1]=a[3*m+1],h[4*m+2]=a[3*m+2],h[4*m+3]=255;a=new ImageData(h,u,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),u,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);u=new Zt([a],!1,!1,this.g.i.canvas,this.O,u,r),this.s=i=i?u.clone():u,this.h&&this.h(i),Ae(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ur.prototype.stylize=Ur.prototype.Oa,Ur.prototype.setOptions=Ur.prototype.o,Ur.createFromModelPath=function(e,t){return Ke(Ur,e,{baseOptions:{modelAssetPath:t}})},Ur.createFromModelBuffer=function(e,t){return Ke(Ur,e,{baseOptions:{modelAssetBuffer:t}})},Ur.createFromOptions=function(e,t){return Ke(Ur,e,t)};var Ap=Rr([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function y0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function v0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function w0(e,t=!0){const n=[];for(const s of e){var r=tc(s);e=[];for(const i of r.g())r=t&&hr(i,1)!=null?hr(i,1)??0:-1,e.push({score:Ot(i,2)??0,index:r,categoryName:vr(i,3)??""??"",displayName:vr(i,4)??""??""});n.push(e)}return n}var Gn=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Pe(e=this.j=new mv,0,1,t=new Ct),this.s=new ap,Pe(this.j,0,2,this.s),this.C=new op,Pe(this.s,0,3,this.C),this.v=new pv,Pe(this.s,0,2,this.v),this.h=new C5,Pe(this.j,0,3,this.h),_e(this.v,2,.5),_e(this.s,4,.5),_e(this.C,2,.5)}get baseOptions(){return tt(this.j,Ct,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){var s,i,a,u;if(Xr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new _i,n=t,r=yf(e.cannedGesturesClassifierOptions,(s=tt(this.h,_i,3))==null?void 0:s.h());Pe(n,0,2,r),Pe(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=tt(this.h,_i,3))==null||i.g());return e.customGesturesClassifierOptions?(Pe(n=t=new _i,0,2,r=yf(e.customGesturesClassifierOptions,(a=tt(this.h,_i,4))==null?void 0:a.h())),Pe(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((u=tt(this.h,_i,4))==null||u.g()),this.l(e)}Ja(e,t){return y0(this),Sr(this,e,t),v0(this)}Ka(e,t,n){return y0(this),Kr(this,e,n,t),v0(this)}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"hand_gestures"),st(e,"hand_landmarks"),st(e,"world_hand_landmarks"),st(e,"handedness");const t=new qn;Tr(t,_5,this.j);const n=new Sn;nr(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"HAND_GESTURES:hand_gestures"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),rr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=Ua(i);const a=[];for(const u of fs(r,sv,1))a.push({x:Ot(u,1)??0,y:Ot(u,2)??0,z:Ot(u,3)??0,visibility:Ot(u,4)??0});this.landmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=eo(i);const a=[];for(const u of fs(r,rv,1))a.push({x:Ot(u,1)??0,y:Ot(u,2)??0,z:Ot(u,3)??0,visibility:Ot(u,4)??0});this.worldLandmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...w0(r,!1)),Ae(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...w0(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function x0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Gn.prototype.recognizeForVideo=Gn.prototype.Ka,Gn.prototype.recognize=Gn.prototype.Ja,Gn.prototype.setOptions=Gn.prototype.o,Gn.createFromModelPath=function(e,t){return Ke(Gn,e,{baseOptions:{modelAssetPath:t}})},Gn.createFromModelBuffer=function(e,t){return Ke(Gn,e,{baseOptions:{modelAssetBuffer:t}})},Gn.createFromOptions=function(e,t){return Ke(Gn,e,t)},Gn.HAND_CONNECTIONS=Ap;var Wn=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Pe(e=this.h=new ap,0,1,t=new Ct),this.s=new op,Pe(this.h,0,3,this.s),this.j=new pv,Pe(this.h,0,2,this.j),Xr(this.j,3,1),_e(this.j,2,.5),_e(this.s,2,.5),_e(this.h,4,.5)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numHands"in e&&Xr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Sr(this,e,t),x0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Kr(this,e,n,t),x0(this)}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"hand_landmarks"),st(e,"world_hand_landmarks"),st(e,"handedness");const t=new qn;Tr(t,j5,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),rr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=Ua(i),this.landmarks.push(rc(r));Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=eo(i),this.worldLandmarks.push(ca(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const u=[];for(const d of r){r=tc(d);const h=[];for(const m of r.g())h.push({score:Ot(m,2)??0,index:hr(m,1)??0??-1,categoryName:vr(m,3)??""??"",displayName:vr(m,4)??""??""});u.push(h)}a.call(i,...u),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Wn.prototype.detectForVideo=Wn.prototype.F,Wn.prototype.detect=Wn.prototype.D,Wn.prototype.setOptions=Wn.prototype.o,Wn.createFromModelPath=function(e,t){return Ke(Wn,e,{baseOptions:{modelAssetPath:t}})},Wn.createFromModelBuffer=function(e,t){return Ke(Wn,e,{baseOptions:{modelAssetBuffer:t}})},Wn.createFromOptions=function(e,t){return Ke(Wn,e,t)},Wn.HAND_CONNECTIONS=Ap;var Uv=Rr([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function S0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function k0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{ic(e)}}function gl(e,t){e=Ua(e),t.push(rc(e))}var kt=class extends Fn{constructor(e,t){super(new xr(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Pe(e=this.j=new xv,0,1,t=new Ct),this.J=new op,Pe(this.j,0,2,this.J),this.Z=new N5,Pe(this.j,0,3,this.Z),this.s=new nc,Pe(this.j,0,4,this.s),this.H=new uv,Pe(this.j,0,5,this.H),this.v=new vv,Pe(this.j,0,6,this.v),this.K=new wv,Pe(this.j,0,7,this.K),_e(this.s,2,.5),_e(this.s,3,.3),_e(this.H,2,.5),_e(this.v,2,.5),_e(this.v,3,.3),_e(this.K,2,.5),_e(this.J,2,.5)}get baseOptions(){return tt(this.j,Ct,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&_e(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&_e(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&_e(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&_e(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&_e(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&_e(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,S0(this),Sr(this,e,r),k0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,S0(this),Kr(this,e,s,t),k0(this)}m(){var e=new On;wt(e,"input_frames_image"),st(e,"pose_landmarks"),st(e,"pose_world_landmarks"),st(e,"face_landmarks"),st(e,"left_hand_landmarks"),st(e,"left_hand_world_landmarks"),st(e,"right_hand_landmarks"),st(e,"right_hand_world_landmarks");const t=new qn,n=new W1;df(n,1,Eo("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))ft(s,2,py(i));else{if(!(typeof i=="string"||i instanceof is||Fa(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");df(s,2,Eh(i,!1),mi())}}(n,this.j.g());const r=new Sn;nr(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),du(r,8,W1,n),pt(r,"IMAGE:input_frames_image"),Je(r,"POSE_LANDMARKS:pose_landmarks"),Je(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Je(r,"FACE_LANDMARKS:face_landmarks"),Je(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Je(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Je(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Je(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),rr(e,r),sc(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{gl(s,this.h.poseLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=eo(s),a.push(ca(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{Ae(this,s)}),this.outputPoseSegmentationMasks&&(Je(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),mo(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[vo(this,s,!0,!this.C)],Ae(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],Ae(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{gl(s,this.h.faceLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{Ae(this,s)}),this.outputFaceBlendshapes&&(st(e,"extra_blendshapes"),Je(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=tc(s),a.push(dp(s.g()??[]))),Ae(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{Ae(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{gl(s,this.h.leftHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=eo(s),a.push(ca(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{gl(s,this.h.rightHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=eo(s),a.push(ca(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{Ae(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};kt.prototype.detectForVideo=kt.prototype.F,kt.prototype.detect=kt.prototype.D,kt.prototype.setOptions=kt.prototype.o,kt.createFromModelPath=function(e,t){return Ke(kt,e,{baseOptions:{modelAssetPath:t}})},kt.createFromModelBuffer=function(e,t){return Ke(kt,e,{baseOptions:{modelAssetBuffer:t}})},kt.createFromOptions=function(e,t){return Ke(kt,e,t)},kt.HAND_CONNECTIONS=Ap,kt.POSE_CONNECTIONS=Uv,kt.FACE_LANDMARKS_LIPS=yp,kt.FACE_LANDMARKS_LEFT_EYE=vp,kt.FACE_LANDMARKS_LEFT_EYEBROW=wp,kt.FACE_LANDMARKS_LEFT_IRIS=Fv,kt.FACE_LANDMARKS_RIGHT_EYE=xp,kt.FACE_LANDMARKS_RIGHT_EYEBROW=Sp,kt.FACE_LANDMARKS_RIGHT_IRIS=Ov,kt.FACE_LANDMARKS_FACE_OVAL=kp,kt.FACE_LANDMARKS_CONTOURS=$v,kt.FACE_LANDMARKS_TESSELATION=Dv;var ar=class extends Fn{constructor(e,t){super(new xr(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Pe(e=this.h=new Sv,0,1,t=new Ct)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return Pe(this.h,0,2,yf(e,tt(this.h,rp,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},Sr(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},Kr(this,e,n,t),this.j}m(){var e=new On;wt(e,"input_image"),wt(e,"norm_rect"),st(e,"classifications");const t=new qn;Tr(t,b5,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),pt(n,"IMAGE:input_image"),pt(n,"NORM_RECT:norm_rect"),Je(n,"CLASSIFICATIONS:classifications"),n.o(t),rr(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:fs(i,m5,1).map(u=>{var d;return dp(((d=tt(u,ev,4))==null?void 0:d.g())??[],hr(u,2)??0,vr(u,3)??"")})};return cu(ho(i,2))!=null&&(a.timestampMs=cu(ho(i,2))??0),a}(g5(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ar.prototype.classifyForVideo=ar.prototype.ta,ar.prototype.classify=ar.prototype.sa,ar.prototype.setOptions=ar.prototype.o,ar.createFromModelPath=function(e,t){return Ke(ar,e,{baseOptions:{modelAssetPath:t}})},ar.createFromModelBuffer=function(e,t){return Ke(ar,e,{baseOptions:{modelAssetBuffer:t}})},ar.createFromOptions=function(e,t){return Ke(ar,e,t)};var Vn=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!0),this.h=new kv,this.embeddings={embeddings:[]},Pe(e=this.h,0,1,t=new Ct)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){var t=this.h,n=tt(this.h,e0,2);return n=n?n.clone():new e0,e.l2Normalize!==void 0?Ma(n,1,e.l2Normalize):"l2Normalize"in e&&ft(n,1),e.quantize!==void 0?Ma(n,2,e.quantize):"quantize"in e&&ft(n,2),Pe(t,0,2,n),this.l(e)}za(e,t){return Sr(this,e,t),this.embeddings}Aa(e,t,n){return Kr(this,e,n,t),this.embeddings}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"embeddings_out");const t=new qn;Tr(t,M5,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"EMBEDDINGS:embeddings_out"),n.o(t),rr(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=w5(r),this.embeddings=function(i){return{embeddings:fs(i,v5,1).map(a=>{var d,h;const u={headIndex:hr(a,3)??0??-1,headName:vr(a,4)??""??""};if(wy(a,Z1,ed(a,1))!==void 0)a=ii(a=tt(a,Z1,ed(a,1)),1,Ys,si()),u.floatEmbedding=a.slice();else{const m=new Uint8Array(0);u.quantizedEmbedding=((h=(d=tt(a,y5,ed(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??m}return u}),timestampMs:cu(ho(i,2))??0}}(r),Ae(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Vn.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=i0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=i0(s0(e.quantizedEmbedding),s0(t.quantizedEmbedding))}return e},Vn.prototype.embedForVideo=Vn.prototype.Aa,Vn.prototype.embed=Vn.prototype.za,Vn.prototype.setOptions=Vn.prototype.o,Vn.createFromModelPath=function(e,t){return Ke(Vn,e,{baseOptions:{modelAssetPath:t}})},Vn.createFromModelBuffer=function(e,t){return Ke(Vn,e,{baseOptions:{modelAssetBuffer:t}})},Vn.createFromOptions=function(e,t){return Ke(Vn,e,t)};var xf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function A0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function E0(e){try{const t=new xf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{ic(e)}}xf.prototype.close=xf.prototype.close;var dn=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new cp,this.v=new Av,Pe(this.h,0,3,this.v),Pe(e=this.h,0,1,t=new Ct)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,Eo(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=fs(e.da(),Sn,1).filter(s=>(vr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=tt(t[0],qn,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=vr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,A0(this),Sr(this,e,r),E0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,A0(this),Kr(this,e,s,t),E0(this)}Da(){return this.s}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect");const t=new qn;Tr(t,Cv,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),n.o(t),rr(e,n),sc(this,e),this.outputConfidenceMasks&&(st(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),mo(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>vo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(st(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),mo(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=vo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),st(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};dn.prototype.getLabels=dn.prototype.Da,dn.prototype.segmentForVideo=dn.prototype.Ma,dn.prototype.segment=dn.prototype.segment,dn.prototype.setOptions=dn.prototype.o,dn.createFromModelPath=function(e,t){return Ke(dn,e,{baseOptions:{modelAssetPath:t}})},dn.createFromModelBuffer=function(e,t){return Ke(dn,e,{baseOptions:{modelAssetBuffer:t}})},dn.createFromOptions=function(e,t){return Ke(dn,e,t)};var Sf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};Sf.prototype.close=Sf.prototype.close;var O5=class extends Ee{constructor(e){super(e)}},ji=[0,Ft,-2],mu=[0,Zr,-3,Et,Zr,-1],C0=[0,mu],_0=[0,mu,Ft,-1],od=class extends Ee{constructor(e){super(e)}},j0=[0,Zr,-1,Et],$5=class extends Ee{constructor(e){super(e)}},N0=class extends Ee{constructor(e){super(e)}},kf=[1,2,3,4,5,6,7,8,9,10,14,15],zv=class extends Ee{constructor(e){super(e)}};zv.prototype.g=ec([0,Xt,[0,kf,ot,mu,ot,[0,mu,ji],ot,C0,ot,[0,C0,ji],ot,j0,ot,[0,Zr,-3,Et,wr],ot,[0,Zr,-3,Et],ot,[0,it,Zr,-2,Et,Ft,Et,-1,2,Zr,ji],ot,_0,ot,[0,_0,ji],Zr,ji,it,ot,[0,Zr,-3,Et,ji,-1],ot,[0,Xt,j0]],it,[0,it,Ft,-1,Et]]);var zr=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new cp,this.s=new Av,Pe(this.h,0,3,this.s),Pe(e=this.h,0,1,t=new Ct)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new zv;const i=new N0;var a=new O5;if(Xr(a,1,255),Pe(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var u=new od;Ma(u,3,!0),_e(u,1,t.keypoint.x),_e(u,2,t.keypoint.y),la(i,5,kf,u)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(u of(a=new $5,t.scribble))Ma(t=new od,3,!0),_e(t,1,u.x),_e(t,2,u.y),du(a,1,od,t);la(i,15,kf,a)}du(r,1,N0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),Sr(this,e,s);e:{try{const h=new Sf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{ic(this)}d=void 0}return d}m(){var e=new On;wt(e,"image_in"),wt(e,"roi_in"),wt(e,"norm_rect_in");const t=new qn;Tr(t,Cv,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"ROI:roi_in"),pt(n,"NORM_RECT:norm_rect_in"),n.o(t),rr(e,n),sc(this,e),this.outputConfidenceMasks&&(st(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),mo(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>vo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(st(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),mo(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=vo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),st(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};zr.prototype.segment=zr.prototype.segment,zr.prototype.setOptions=zr.prototype.o,zr.createFromModelPath=function(e,t){return Ke(zr,e,{baseOptions:{modelAssetPath:t}})},zr.createFromModelBuffer=function(e,t){return Ke(zr,e,{baseOptions:{modelAssetBuffer:t}})},zr.createFromOptions=function(e,t){return Ke(zr,e,t)};var lr=class extends Fn{constructor(e,t){super(new xr(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Pe(e=this.h=new _v,0,1,t=new Ct)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,Eo(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),e.maxResults!==void 0?Xr(this.h,3,e.maxResults):"maxResults"in e&&ft(this.h,3),e.scoreThreshold!==void 0?_e(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&ft(this.h,4),e.categoryAllowlist!==void 0?fu(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&ft(this.h,5),e.categoryDenylist!==void 0?fu(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&ft(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},Sr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Kr(this,e,n,t),this.j}m(){var e=new On;wt(e,"input_frame_gpu"),wt(e,"norm_rect"),st(e,"detections");const t=new qn;Tr(t,P5,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),pt(n,"IMAGE:input_frame_gpu"),pt(n,"NORM_RECT:norm_rect"),Je(n,"DETECTIONS:detections"),n.o(t),rr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=nv(i),this.j.detections.push(Nv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};lr.prototype.detectForVideo=lr.prototype.F,lr.prototype.detect=lr.prototype.D,lr.prototype.setOptions=lr.prototype.o,lr.createFromModelPath=async function(e,t){return Ke(lr,e,{baseOptions:{modelAssetPath:t}})},lr.createFromModelBuffer=function(e,t){return Ke(lr,e,{baseOptions:{modelAssetBuffer:t}})},lr.createFromOptions=function(e,t){return Ke(lr,e,t)};var Af=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function b0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function M0(e){try{const t=new Af(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{ic(e)}}Af.prototype.close=Af.prototype.close;var Yn=class extends Fn{constructor(e,t){super(new xr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Pe(e=this.h=new jv,0,1,t=new Ct),this.v=new wv,Pe(this.h,0,3,this.v),this.j=new vv,Pe(this.h,0,2,this.j),Xr(this.j,4,1),_e(this.j,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return tt(this.h,Ct,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numPoses"in e&&Xr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&_e(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&_e(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,b0(this),Sr(this,e,r),M0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,b0(this),Kr(this,e,s,t),M0(this)}m(){var e=new On;wt(e,"image_in"),wt(e,"norm_rect"),st(e,"normalized_landmarks"),st(e,"world_landmarks"),st(e,"segmentation_masks");const t=new qn;Tr(t,I5,this.h);const n=new Sn;nr(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:normalized_landmarks"),Je(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),rr(e,n),sc(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=Ua(i),this.landmarks.push(rc(r));Ae(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],Ae(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=eo(i),this.worldLandmarks.push(ca(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],Ae(this,r)}),this.outputSegmentationMasks&&(Je(n,"SEGMENTATION_MASK:segmentation_masks"),mo(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>vo(this,i,!0,!this.s)),Ae(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Yn.prototype.detectForVideo=Yn.prototype.F,Yn.prototype.detect=Yn.prototype.D,Yn.prototype.setOptions=Yn.prototype.o,Yn.createFromModelPath=function(e,t){return Ke(Yn,e,{baseOptions:{modelAssetPath:t}})},Yn.createFromModelBuffer=function(e,t){return Ke(Yn,e,{baseOptions:{modelAssetBuffer:t}})},Yn.createFromOptions=function(e,t){return Ke(Yn,e,t)},Yn.POSE_CONNECTIONS=Uv;const Hv="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",D5=Hv,gu=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let u=0,d=0,h=0;t>=0&&t<60?(u=s,d=i,h=0):t<120?(u=i,d=s,h=0):t<180?(u=0,d=s,h=i):t<240?(u=0,d=i,h=s):t<300?(u=i,d=0,h=s):(u=s,d=0,h=i);const m=w=>Math.max(0,Math.min(255,Math.round((w+a)*255)));return{r:m(u),g:m(d),b:m(h)}}return null},Ep=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),T0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),P0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},Gv=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const u=e.canvas;return s=u.width,i=u.height,r=u.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(u){console.warn("[ColorDetector] Failed to extract category mask data:",u)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},U5=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=gu(t),a=gu(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:u="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:m=50,minGapRatio:w=.05}=r,S=new Image;S.crossOrigin="anonymous",S.onload=()=>{try{const _=S.width>d?d/S.width:1,B=Math.max(1,Math.round(S.width*_)),O=Math.max(1,Math.round(S.height*_)),X=document.createElement("canvas");X.width=B,X.height=O;const C=X.getContext("2d");if(!C){s({suggestion:"None",stats:{mode:"colorMask"}});return}C.drawImage(S,0,0,B,O);const g=C.getImageData(0,0,B,O),{data:y}=g,E=h*h,j={minY:O,maxY:-1,pixels:0},T={minY:O,maxY:-1,pixels:0},D=new Uint8Array(B*O);for(let q=0;q<O;q+=1)for(let te=0;te<B;te+=1){const Se=(q*B+te)*4,ve=q*B+te,ye=y[Se],ne=y[Se+1],oe=y[Se+2],re=(ye-i.r)*(ye-i.r)+(ne-i.g)*(ne-i.g)+(oe-i.b)*(oe-i.b),we=(ye-a.r)*(ye-a.r)+(ne-a.g)*(ne-a.g)+(oe-a.b)*(oe-a.b);re<E&&re<we?(j.pixels+=1,q<j.minY&&(j.minY=q),q>j.maxY&&(j.maxY=q),D[ve]=1):we<E&&we<re&&(T.pixels+=1,q<T.minY&&(T.minY=q),q>T.maxY&&(T.maxY=q),D[ve]=2)}const H={mode:"colorMask",pixelsA:j.pixels,pixelsB:T.pixels,minYA:j.pixels>0?j.minY:null,maxYA:j.pixels>0?j.maxY:null,minYB:T.pixels>0?T.minY:null,maxYB:T.pixels>0?T.maxY:null,width:B,height:O},se=j.pixels>=m,V=T.pixels>=m;let K="None";if(se&&!V)K="A";else if(!se&&V)K="B";else if(se&&V){let q,te;u==="top"?(q=j.minY,te=T.minY):(q=j.maxY,te=T.maxY);const Se=Math.abs(q-te),ve=O*w;Se>=ve&&(K=u==="top"?q<te?"A":"B":q>te?"A":"B")}let ee=null;try{const q=document.createElement("canvas");q.width=B,q.height=O;const te=q.getContext("2d");te.drawImage(S,0,0,B,O);const Se=te.getImageData(0,0,B,O),ve=Se.data,ye=(re,we)=>{ve[re]=Math.round(ve[re]*.3+we.r*.7),ve[re+1]=Math.round(ve[re+1]*.3+we.g*.7),ve[re+2]=Math.round(ve[re+2]*.3+we.b*.7),ve[re+3]=255},ne={r:255,g:82,b:97},oe={r:80,g:170,b:255};for(let re=0;re<D.length;re+=1)D[re]===1?ye(re*4,ne):D[re]===2&&ye(re*4,oe);te.putImageData(Se,0,0),ee=q.toDataURL("image/png")}catch(q){console.warn("[ColorDetector] Failed generating preview",q)}s({suggestion:K,stats:H,preview:ee})}catch(_){console.error("[ColorDetector] Error processing frame:",_),s({suggestion:"None",stats:{mode:"colorMask"}})}},S.onerror=_=>{console.error("[ColorDetector] Failed to load frame image",_),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?S.src=e:typeof e=="string"?S.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),I0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const _ of e){const B=_.y*t+_.x;B>=0&&B<i.length&&(i[B]=1)}const a=[],u=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const _ of e){const B=_.y*t+_.x;if(B<0||B>=i.length||i[B]!==1)continue;let O=0;const X=[{x:_.x,y:_.y}];i[B]=2;const C=[];let g=0;for(;g<X.length;){const{x:y,y:E}=X[g++];O++,C.push({x:y,y:E});for(const j of u){const T=y+j.dx,D=E+j.dy;if(T>=0&&T<t&&D>=0&&D<n){const H=D*t+T;H>=0&&H<i.length&&i[H]===1&&(i[H]=2,X.push({x:T,y:D}))}}}a.push({size:O,pixels:C})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((_,B)=>B.size>_.size?B:_).size,m=Math.max(1,Math.floor(h*s));let w=0;const S=[];for(const _ of a)_.size>=m&&(w+=_.size,S.push(..._.pixels));return{count:w,pixels:S,largestBlobSize:h,minBlobSize:m,totalBlobs:a.length,filteredBlobs:a.filter(_=>_.size>=m).length}},z5=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=gu(t),i=gu(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await Ep(e),u=a.naturalWidth||a.width,d=a.naturalHeight||a.height,m=(await Cp()).segment(a),{maskData:w,maskWidth:S,maskHeight:_,isRGBA:B}=Gv(m.categoryMask,u,d);if(!w)throw new Error("Failed to extract segmentation mask data");const O=new Uint8ClampedArray(u*d*4),X=u/S,C=d/_;for(let P=0;P<d;P++)for(let U=0;U<u;U++){const J=Math.min(S-1,Math.floor(U/X)),$=(Math.min(_-1,Math.floor(P/C))*S+J)*(B?4:1);let v=0;w&&$<w.length&&(v=w[$]);const R=v!==0&&v!==2?255:0,b=(P*u+U)*4;O[b]=R,O[b+1]=R,O[b+2]=R,O[b+3]=255}const g=document.createElement("canvas");g.width=u,g.height=d;const y=g.getContext("2d");y.drawImage(a,0,0,u,d);const E=y.getImageData(0,0,u,d).data,j=r.maskThreshold||100,T=r.colorThreshold??95,D=r.anchor||"top",H=T*T,se=r.scanDepth??1,V=r.stride||2;let K=D==="top"?d:0,ee=!1;if(D==="top")for(let P=0;P<d;P+=V){for(let U=0;U<u;U+=V)if(O[(P*u+U)*4]>=j){K=P,ee=!0;break}if(ee)break}else for(let P=d-1;P>=0;P-=V){for(let U=0;U<u;U+=V)if(O[(P*u+U)*4]>=j){K=P,ee=!0;break}if(ee)break}let q,te,Se;if(r.manualBounds&&D==="manually")q=r.manualBounds.topY,te=r.manualBounds.bottomY,Se=te-q,ee||(K=q);else{if(!ee)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};Se=se?Math.floor(d*se):d,D==="top"?(q=K,te=Math.min(d,K+Se)):(q=Math.max(0,K-Se),te=K)}const ve=[],ye=[];for(let P=q;P<te;P+=V)for(let U=0;U<u;U+=V){const J=(P*u+U)*4;if(O[J]<j)continue;const de=E[J],$=E[J+1],v=E[J+2],R=T0({r:de,g:$,b:v},s),b=T0({r:de,g:$,b:v},i);R<H&&R<b?ve.push({x:U,y:P}):b<H&&b<R&&ye.push({x:U,y:P})}const ne=r.minBlobRatio??.1,oe=I0(ve,u,d,V,ne),re=I0(ye,u,d,V,ne),we=oe.count,Te=re.count,Le=oe.pixels.map(P=>({...P,idx:(P.y*u+P.x)*4})),$e=re.pixels.map(P=>({...P,idx:(P.y*u+P.x)*4})),Oe=50;let De="None",Y=null;we>Oe&&we>Te?(De="A",Y={color:"A",pixelCount:we,minY:q,maxY:te,anchorY:K,rawPixels:ve.length,largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize}):Te>Oe&&Te>we&&(De="B",Y={color:"B",pixelCount:Te,minY:q,maxY:te,anchorY:K,rawPixels:ye.length,largestBlobSize:re.largestBlobSize,minBlobSize:re.minBlobSize});let Q=null,me=null;try{const P=document.createElement("canvas");P.width=u,P.height=d;const U=P.getContext("2d");U.drawImage(a,0,0,u,d),U.fillStyle="rgba(0,0,0,0.6)",U.fillRect(0,0,u,d),U.globalCompositeOperation="destination-out",U.fillStyle="rgba(0,0,0,1)",U.fillRect(0,q,u,te-q),U.globalCompositeOperation="destination-over",U.drawImage(a,0,0,u,d),U.globalCompositeOperation="source-over";const J=U.createImageData(u,d),de=J.data;for(let z=q;z<te;z+=1)for(let W=0;W<u;W+=1){const fe=(z*u+W)*4;O[fe]>=j&&(de[fe]=0,de[fe+1]=255,de[fe+2]=255,de[fe+3]=90)}U.putImageData(J,0,0);const $=U.createImageData(u,d),v=$.data;for(const z of Le){const W=z.idx;W>=0&&W<v.length-3&&(v[W]=255,v[W+1]=0,v[W+2]=0,v[W+3]=180)}for(const z of $e){const W=z.idx;W>=0&&W<v.length-3&&(v[W]=0,v[W+1]=100,v[W+2]=255,v[W+3]=180)}U.putImageData($,0,0),U.globalCompositeOperation="source-over",U.strokeStyle="#00FF00",U.lineWidth=3,U.setLineDash([]),U.beginPath(),U.moveTo(0,q),U.lineTo(u,q),U.stroke(),U.strokeStyle="#FFFF00",U.lineWidth=3,U.setLineDash([5,5]),U.beginPath(),U.moveTo(0,te),U.lineTo(u,te),U.stroke(),K!==q&&K!==te&&(U.strokeStyle="#FF00FF",U.lineWidth=2,U.setLineDash([2,2]),U.beginPath(),U.moveTo(0,K),U.lineTo(u,K),U.stroke()),Q=P.toDataURL("image/png");const R=document.createElement("canvas");R.width=u,R.height=d;const b=R.getContext("2d"),M=b.createImageData(u,d),F=M.data;for(let z=0;z<u*d;z+=1){const W=z*4,ge=O[z*4]>=j?255:0;F[W]=ge,F[W+1]=ge,F[W+2]=ge,F[W+3]=255}b.putImageData(M,0,0),me=R.toDataURL("image/png")}catch(P){console.warn("[ColorDetector] Failed generating preview",P)}const ue={mode:"segmentation",width:u,height:d,pixelsA:we,pixelsB:Te,rawPixelsA:ve.length,rawPixelsB:ye.length,tipY:K,scanDepth:Se,scanDepthRatio:se,anchor:D,bestArm:Y,blobInfoA:{largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize,totalBlobs:oe.totalBlobs,filteredBlobs:oe.filteredBlobs,droppedPixels:ve.length-we},blobInfoB:{largestBlobSize:re.largestBlobSize,minBlobSize:re.minBlobSize,totalBlobs:re.totalBlobs,filteredBlobs:re.filteredBlobs,droppedPixels:ye.length-Te},minBlobRatio:ne};return{suggestion:De,stats:ue,preview:Q,maskPreview:me}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},H5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},yu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),G5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,u=-1/0;for(const w of e){const S=yu(w,i);S>u&&(u=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let _=0;_<e.length;_++){let B=0,O=1/0;for(let X=0;X<s.length;X++){const C=yu(e[_],s[X]);C<O&&(O=C,B=X)}d[_]!==B&&(d[_]=B,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((_,B)=>{const O=d[B];S[O]+=1;for(let X=0;X<r;X++)w[O][X]+=_[X]});for(let _=0;_<s.length;_++)S[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=w[_].map(B=>B/S[_]);h+=1}return{assignments:d,centroids:s}},W5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await Cp(),r=t.maxFrames||e.length,s=t.stride||2;t.minClothPixels;const i=t.manualBounds||null,a=e.slice(0,r),u=[];let d=0;for(const g of a)try{const y=await Ep(g.frameDataUrl),E=y.naturalWidth||y.width,j=y.naturalHeight||y.height,T=n.segment(y),{maskData:D,maskWidth:H,maskHeight:se,isRGBA:V}=Gv(T.categoryMask,E,j);if(!D){d+=1;continue}const K=document.createElement("canvas");K.width=E,K.height=j;const ee=K.getContext("2d");ee.drawImage(y,0,0,E,j);const q=ee.getImageData(0,0,E,j).data,te=E/H,Se=j/se;let ve;i?ve=i.bottomY-i.topY:ve=j;const ye=Math.floor(ve/s),ne=Math.floor(E/s),oe=ye*ne,we=Math.max(Math.floor(oe*.005),20);let Te=0,Le=0,$e=0,Oe=0,De=0,Y=0;for(let ue=0;ue<j;ue+=s){if(i&&(ue<i.topY||ue>i.bottomY))continue;const P=Math.min(se-1,Math.floor(ue/Se));for(let U=0;U<E;U+=s){const J=Math.min(H-1,Math.floor(U/te)),de=(P*H+J)*(V?4:1);if(D[de]===4){const v=(ue*E+U)*4,R=q[v],b=q[v+1],M=q[v+2];Te+=R,Le+=b,$e+=M,Oe+=U,De+=ue,Y+=1}}}if(Y<we){console.log(`[Cloth] Frame ${g.moveId} SKIPPED - cloth pixels: ${Y}, threshold: ${we}, scan area: ${ve}px, manual bounds: ${i?"YES":"NO"}`),d+=1;continue}console.log(`[Cloth] Frame ${g.moveId} ACCEPTED - cloth pixels: ${Y}, threshold: ${we}, scan area: ${ve}px, manual bounds: ${i?`Y:${i.topY}-${i.bottomY}`:"NO"}`);const Q={r:Te/Y,g:Le/Y,b:$e/Y};let me=null;try{const ue=document.createElement("canvas");ue.width=E,ue.height=j;const P=ue.getContext("2d");P.drawImage(y,0,0,E,j);const U=P.getImageData(0,0,E,j),J=U.data;for(let de=0;de<j;de+=1){const $=Math.min(se-1,Math.floor(de/Se));for(let v=0;v<E;v+=1){const R=Math.min(H-1,Math.floor(v/te)),b=($*H+R)*(V?4:1);if(D[b]===4){const F=(de*E+v)*4;J[F]=Math.round(J[F]*.5+50),J[F+1]=Math.round(J[F+1]*.5+255*.5),J[F+2]=Math.round(J[F+2]*.5+50)}}}P.putImageData(U,0,0),i&&(P.fillStyle="rgba(0, 0, 0, 0.5)",P.fillRect(0,0,E,i.topY),P.fillRect(0,i.bottomY,E,j-i.bottomY),P.strokeStyle="#00FF00",P.lineWidth=3,P.setLineDash([]),P.beginPath(),P.moveTo(0,i.topY),P.lineTo(E,i.topY),P.stroke(),P.strokeStyle="#FFFF00",P.lineWidth=3,P.setLineDash([5,5]),P.beginPath(),P.moveTo(0,i.bottomY),P.lineTo(E,i.bottomY),P.stroke(),P.fillStyle="#00FF00",P.font="bold 16px Arial",P.fillText(`Manual Scan Area (${ve}px)`,10,i.topY-10)),P.fillStyle="rgba(0, 0, 0, 0.7)",P.fillRect(10,10,300,80),P.fillStyle="#FFFFFF",P.font="bold 14px Arial",P.fillText(`Cloth Pixels: ${Y}`,20,30),P.fillText(`Threshold: ${we}`,20,50),P.fillText(`Mean Color: ${P0(Q.r,Q.g,Q.b)}`,20,70),me=ue.toDataURL("image/png")}catch(ue){console.warn("[ColorDetector] Failed to generate debug preview:",ue)}u.push({moveId:g.moveId,meanColor:Q,feature:[Q.r/255,Q.g/255,Q.b/255],centroidX:Oe/Y/E,centroidY:De/Y/j,pixelCount:Y,existingPlayer:g.existingPlayer||null,debugPreview:me})}catch(y){console.warn("[ColorDetector] Cloth analysis failed for frame",g.moveId,y),d+=1}if(u.length<2)throw new Error("Not enough frames with detectable clothing");const h=u.map(g=>g.feature),{assignments:m,centroids:w}=G5(h,Math.min(2,u.length)),S=w.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));m.forEach((g,y)=>{const E=u[y],j=S[g];j.samples.push({moveId:E.moveId,centroidX:E.centroidX,centroidY:E.centroidY,pixelCount:E.pixelCount}),j.sumR+=E.meanColor.r,j.sumG+=E.meanColor.g,j.sumB+=E.meanColor.b,j.sumPixels+=E.pixelCount,j.sumBrightness+=(E.meanColor.r+E.meanColor.g+E.meanColor.b)/3,(E.existingPlayer==="Player A"||E.existingPlayer==="Player B")&&(j.labelCounts[E.existingPlayer]+=1)});const _={};S.forEach((g,y)=>{const E=g.labelCounts["Player A"],j=g.labelCounts["Player B"];E>j?_[y]="Player A":j>E&&(_[y]="Player B")});const B=S.map((g,y)=>{const E=g.sumR/Math.max(1,g.samples.length),j=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length);return{idx:y,hue:H5(E,j,T),brightness:g.sumBrightness/Math.max(1,g.samples.length)}}).sort((g,y)=>g.hue-y.hue||g.brightness-y.brightness),O=["Player A","Player B"];B.forEach(({idx:g})=>{if(!_[g]){const y=Object.values(_),E=O.find(j=>!y.includes(j))||"Player A";_[g]=E}});const X={};m.forEach((g,y)=>{const E=u[y],j=_[g]||(g===0?"Player A":"Player B"),T=w[g],D=w[g===0?1:0],H=yu(E.feature,T),se=D?yu(E.feature,D):H,V=D?Math.max(0,1-H/(H+se+1e-6)):1;X[E.moveId]={player:j,clusterId:g,styleLabel:`Style ${g+1}`,confidence:V,stats:{meanColor:E.meanColor,pixelCount:E.pixelCount,debugPreview:E.debugPreview}}});const C=S.map((g,y)=>{const E=g.sumR/Math.max(1,g.samples.length),j=g.sumG/Math.max(1,g.samples.length),T=g.sumB/Math.max(1,g.samples.length),D=P0(E,j,T);return{id:y,styleLabel:`Style ${y+1}`,assignedPlayer:_[y]||(y===0?"Player A":"Player B"),hexColor:D,meanColor:{r:E,g:j,b:T},sampleCount:g.samples.length,avgPixels:g.sumPixels/Math.max(1,g.samples.length),avgBrightness:g.sumBrightness/Math.max(1,g.samples.length),knownAssignments:g.labelCounts}});return{assignments:X,clusters:C,analytics:{totalFrames:a.length,usedFrames:u.length,skippedFrames:d,clusters:C}}};let ad=null;const Cp=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!ad){const e=await ks.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");ad=await dn.createFromOptions(e,{baseOptions:{modelAssetPath:D5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return ad},V5=async e=>{try{const t=await Ep(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await Cp()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let u;if(i.categoryMask.getAsUint8Array)u=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(u=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,u.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=u[w*4];u=m}}else if(i.categoryMask instanceof Uint8Array)u=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=h[w*4];u=m}else u=h}return await Promise.all(a.map(async h=>{const m=document.createElement("canvas");m.width=n,m.height=r;const w=m.getContext("2d");w.drawImage(t,0,0,n,r);const S=w.getImageData(0,0,n,r),_=S.data;let B=0;for(let O=0;O<u.length;O++)if(u[O]===h.id){B++;const X=O*4;h.id===0?(_[X]=_[X]*.25,_[X+1]=_[X+1]*.25,_[X+2]=_[X+2]*.25):(_[X]=(_[X]+h.color[0])/2,_[X+1]=(_[X+1]+h.color[1])/2,_[X+2]=(_[X+2]+h.color[2])/2)}return w.putImageData(S,0,0),{...h,pixelCount:B,preview:m.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},Y5=Hv,X5=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),K5=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const u=e.canvas;return s=u.width,i=u.height,r=u.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(u){console.warn("[ColorDetectorGeneral] Failed to extract category mask data:",u)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},vu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),Q5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,u=-1/0;for(const w of e){const S=vu(w,i);S>u&&(u=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let _=0;_<e.length;_++){let B=0,O=1/0;for(let X=0;X<s.length;X++){const C=vu(e[_],s[X]);C<O&&(O=C,B=X)}d[_]!==B&&(d[_]=B,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((_,B)=>{const O=d[B];S[O]+=1;for(let X=0;X<r;X++)w[O][X]+=_[X]});for(let _=0;_<s.length;_++)S[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=w[_].map(B=>B/S[_]);h+=1}return{assignments:d,centroids:s}},J5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},R0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()};let ld=null;const q5=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!ld){const e=await ks.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");ld=await dn.createFromOptions(e,{baseOptions:{modelAssetPath:Y5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return ld},Z5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for analysis");const n=await q5(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minPixels||5,a=t.manualBounds||null,u=e.slice(0,r),d=[];let h=0;for(const y of u)try{const E=await X5(y.frameDataUrl),j=E.naturalWidth||E.width,T=E.naturalHeight||E.height,D=n.segment(E),{maskData:H,maskWidth:se,maskHeight:V,isRGBA:K}=K5(D.categoryMask,j,T);if(!H){h+=1;continue}const ee=document.createElement("canvas");ee.width=j,ee.height=T;const q=ee.getContext("2d");q.drawImage(E,0,0,j,T);const te=q.getImageData(0,0,j,T).data,Se=j/se,ve=T/V;let ye=0,ne=T;a&&(ye=Math.max(0,a.topY),ne=Math.min(T,a.bottomY));let oe=0,re=0,we=0,Te=0,Le=0,$e=0;for(let Y=ye;Y<ne;Y+=s){const Q=Math.min(V-1,Math.floor(Y/ve));for(let me=0;me<j;me+=s){const ue=Math.min(se-1,Math.floor(me/Se)),P=(Q*se+ue)*(K?4:1);if(H[P]!==0){const J=(Y*j+me)*4,de=te[J],$=te[J+1],v=te[J+2];oe+=de,re+=$,we+=v,Te+=me,Le+=Y,$e+=1}}}if($e<i){h+=1;continue}const Oe={r:oe/$e,g:re/$e,b:we/$e};let De=null;try{const Y=document.createElement("canvas");Y.width=j,Y.height=T;const Q=Y.getContext("2d");Q.drawImage(E,0,0,j,T);const me=Q.getImageData(0,0,j,T),ue=me.data;for(let P=0;P<T;P+=1){const U=Math.min(V-1,Math.floor(P/ve));for(let J=0;J<j;J+=1){const de=Math.min(se-1,Math.floor(J/Se)),$=(U*se+de)*(K?4:1);if(H[$]!==0){const R=(P*j+J)*4;ue[R]=Math.round(ue[R]*.5+50),ue[R+1]=Math.round(ue[R+1]*.5+100),ue[R+2]=Math.round(ue[R+2]*.5+255*.5)}}}if(Q.putImageData(me,0,0),a){Q.fillStyle="rgba(0, 0, 0, 0.5)",Q.fillRect(0,0,j,a.topY),Q.fillRect(0,a.bottomY,j,T-a.bottomY),Q.strokeStyle="#00FF00",Q.lineWidth=3,Q.setLineDash([]),Q.beginPath(),Q.moveTo(0,a.topY),Q.lineTo(j,a.topY),Q.stroke(),Q.strokeStyle="#FFFF00",Q.lineWidth=3,Q.setLineDash([5,5]),Q.beginPath(),Q.moveTo(0,a.bottomY),Q.lineTo(j,a.bottomY),Q.stroke();const P=a.bottomY-a.topY;Q.fillStyle="#00FF00",Q.font="bold 16px Arial",Q.fillText(`Manual Scan Area (${P}px)`,10,a.topY-10)}Q.fillStyle="rgba(0, 0, 0, 0.7)",Q.fillRect(10,10,300,80),Q.fillStyle="#FFFFFF",Q.font="bold 14px Arial",Q.fillText(`Non-BG Pixels: ${$e}`,20,30),Q.fillText(`Threshold: ${i}`,20,50),Q.fillText(`Mean Color: ${R0(Oe.r,Oe.g,Oe.b)}`,20,70),De=Y.toDataURL("image/png")}catch(Y){console.warn("[ColorDetectorGeneral] Failed to generate debug preview:",Y)}d.push({moveId:y.moveId,meanColor:Oe,feature:[Oe.r/255,Oe.g/255,Oe.b/255],centroidX:Te/$e/j,centroidY:Le/$e/T,pixelCount:$e,existingPlayer:y.existingPlayer||null,debugPreview:De})}catch(E){console.warn("[ColorDetectorGeneral] Analysis failed for frame",y.moveId,E),h+=1}if(d.length<2)throw new Error("Not enough frames with detectable pixels (need at least 2)");const m=d.map(y=>y.feature),{assignments:w,centroids:S}=Q5(m,Math.min(2,d.length)),_=S.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));w.forEach((y,E)=>{const j=d[E],T=_[y];T.samples.push({moveId:j.moveId,centroidX:j.centroidX,centroidY:j.centroidY,pixelCount:j.pixelCount}),T.sumR+=j.meanColor.r,T.sumG+=j.meanColor.g,T.sumB+=j.meanColor.b,T.sumPixels+=j.pixelCount,T.sumBrightness+=(j.meanColor.r+j.meanColor.g+j.meanColor.b)/3,(j.existingPlayer==="Player A"||j.existingPlayer==="Player B")&&(T.labelCounts[j.existingPlayer]+=1)});const B={};_.forEach((y,E)=>{const j=y.labelCounts["Player A"],T=y.labelCounts["Player B"];j>T?B[E]="Player A":T>j&&(B[E]="Player B")});const O=_.map((y,E)=>{const j=y.sumR/Math.max(1,y.samples.length),T=y.sumG/Math.max(1,y.samples.length),D=y.sumB/Math.max(1,y.samples.length);return{idx:E,hue:J5(j,T,D),brightness:y.sumBrightness/Math.max(1,y.samples.length)}}).sort((y,E)=>y.hue-E.hue||y.brightness-E.brightness),X=["Player A","Player B"];O.forEach(({idx:y})=>{if(!B[y]){const E=Object.values(B),j=X.find(T=>!E.includes(T))||"Player A";B[y]=j}});const C={};w.forEach((y,E)=>{const j=d[E],T=B[y]||(y===0?"Player A":"Player B"),D=S[y],H=S[y===0?1:0],se=vu(j.feature,D),V=H?vu(j.feature,H):se,K=H?Math.max(0,1-se/(se+V+1e-6)):1,ee=_[y],q=ee.sumR/Math.max(1,ee.samples.length),te=ee.sumG/Math.max(1,ee.samples.length),Se=ee.sumB/Math.max(1,ee.samples.length);C[j.moveId]={player:T,clusterId:y,styleLabel:`Style ${y+1}`,confidence:K,stats:{meanColor:{r:q,g:te,b:Se},pixelCount:j.pixelCount,debugPreview:j.debugPreview}}});const g=_.map((y,E)=>{const j=y.sumR/Math.max(1,y.samples.length),T=y.sumG/Math.max(1,y.samples.length),D=y.sumB/Math.max(1,y.samples.length),H=R0(j,T,D);return{id:E,styleLabel:`Style ${E+1}`,assignedPlayer:B[E]||(E===0?"Player A":"Player B"),hexColor:H,meanColor:{r:j,g:T,b:D},sampleCount:y.samples.length,avgPixels:y.sumPixels/Math.max(1,y.samples.length),avgBrightness:y.sumBrightness/Math.max(1,y.samples.length),knownAssignments:y.labelCounts}});return{assignments:C,clusters:g,analytics:{totalFrames:u.length,usedFrames:d.length,skippedFrames:h,clusters:g}}},ud=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,e6=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function t6({colorPreview:e,onClose:t}){var _,B,O,X,C,g,y,E,j,T,D,H,se,V;const[n,r]=N.useState("overview"),[s,i]=N.useState(null),[a,u]=N.useState(!1),d=async()=>{if(e!=null&&e.original){u(!0);try{const K=await V5(e.original);i(K)}catch(K){console.error("Failed to run multiclass segmentation:",K)}finally{u(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,m=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,w=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",S=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return l.jsx("div",{className:"image-modal",onClick:t,children:l.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:K=>K.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:t,children:""}),l.jsxs("div",{className:"color-preview-tabs",children:[l.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),l.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"color-preview-grid",children:[l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Original Frame"}),l.jsx("img",{src:e.original,alt:"Original frame"})]}),l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Mask View"}),e.preview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((_=e.stats)==null?void 0:_.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((B=e.stats)==null?void 0:B.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),l.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((O=e.stats)==null?void 0:O.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),l.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):l.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&l.jsxs("div",{className:"color-preview-stats",children:[l.jsxs("div",{className:"color-preview-meta",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${m.toLocaleString()} px)`:""]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Method:"})," ",S]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Anchor:"})," ",w]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&l.jsxs("div",{children:[l.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&l.jsxs("div",{children:[l.jsx("strong",{children:"Person coverage:"})," ",e6(e.stats.personPixels)]}),e.stats.reason&&l.jsxs("div",{children:[l.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),l.jsxs("div",{className:"color-preview-calibration",children:[l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player A color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),l.jsx("code",{children:e.colorA||""}),e.calibrationA&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player B color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),l.jsx("code",{children:e.colorB||""}),e.calibrationB&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Scan Zone"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Depth:"})," ",((X=e.stats.scanDepth)==null?void 0:X.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color A Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((C=e.stats.pixelsA)==null?void 0:C.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((g=e.stats.rawPixelsA)==null?void 0:g.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((y=e.stats.blobInfoA.largestBlobSize)==null?void 0:y.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((E=e.stats.blobInfoA.minBlobSize)==null?void 0:E.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color B Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((j=e.stats.pixelsB)==null?void 0:j.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((T=e.stats.rawPixelsB)==null?void 0:T.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((D=e.stats.blobInfoB.largestBlobSize)==null?void 0:D.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((H=e.stats.blobInfoB.minBlobSize)==null?void 0:H.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&l.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[l.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixel Count:"})," ",((se=e.stats.bestArm.pixelCount)==null?void 0:se.toLocaleString())||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((V=e.stats.armRegions)==null?void 0:V.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((K,ee)=>{const q=e.stats.bestArm&&K.category===e.stats.bestArm.category&&K.dominantColor===e.stats.bestArm.dominantColor;return l.jsxs("div",{className:"segmentation-card",style:{border:q?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:q?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[l.jsxs("h4",{children:["Arm ",ee+1,": ",K.categoryName,q&&l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Dominant Color:"})," ",l.jsxs("span",{style:{color:K.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",K.dominantColor]})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels A:"})," ",K.pixelsA||0," | ",l.jsx("strong",{children:"Pixels B:"})," ",K.pixelsB||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Total arm pixels:"})," ",K.pixelCount||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," Y=",K.minY,"  ",K.maxY," (Anchor Y: ",K.anchorY,")"]})]},ee)}):l.jsx("p",{children:"No arms detected with matching colors"})]}):l.jsxs("div",{className:"color-preview-breakdown",children:[l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player A band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",ud(e.stats.pixelsA,m),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player B band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",ud(e.stats.pixelsB,m),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):l.jsxs("div",{className:"multiclass-view",children:[l.jsxs("div",{className:"multiclass-header",children:[l.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),l.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&l.jsxs("div",{className:"loading-indicator",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&l.jsx("div",{className:"multiclass-grid",children:s.map(K=>l.jsxs("div",{className:"multiclass-card",children:[l.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${K.color.join(",")})`},children:[l.jsxs("h4",{children:[K.id,". ",K.name]}),l.jsx("span",{className:"multiclass-badge",children:ud(K.pixelCount,m)})]}),l.jsx("p",{className:"multiclass-desc",children:K.desc}),l.jsx("div",{className:"multiclass-preview-container",children:l.jsx("img",{src:K.preview,alt:K.name})}),l.jsxs("div",{className:"multiclass-footer",children:[K.pixelCount.toLocaleString()," pixels"]})]},K.id))}),!a&&!s&&l.jsxs("div",{className:"error-message",children:[l.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),l.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function n6({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=N.useState(0),[i,a]=N.useState(0),[u,d]=N.useState(!1),[h,m]=N.useState(!1),w=N.useRef(null),[S,_]=N.useState(0),[B,O]=N.useState(0),X=N.useRef(null),C=W0.useCallback((T,D,H,se,V,K)=>{T.clearRect(0,0,se,V),K&&T.drawImage(K,0,0),T.fillStyle="rgba(0, 255, 0, 0.2)",T.fillRect(0,D,se,H-D),T.strokeStyle="#00FF00",T.lineWidth=3,T.setLineDash([]),T.beginPath(),T.moveTo(0,D),T.lineTo(se,D),T.stroke(),T.strokeStyle="#FFFF00",T.setLineDash([]),T.beginPath(),T.moveTo(0,H),T.lineTo(se,H),T.stroke(),T.fillStyle="#00FF00",T.font="16px Arial",T.fillText("Top",10,D-5),T.fillStyle="#FFFF00",T.fillText("Bottom",10,H+20)},[]);N.useEffect(()=>{if(!e||!w.current)return;const T=new Image;T.crossOrigin="anonymous",T.onload=()=>{const D=w.current,H=D.getContext("2d");D.width=T.width,D.height=T.height,O(T.width),_(T.height),X.current=T;const se=Math.floor(T.height*.2),V=Math.floor(T.height*.8);s(se),a(V),C(H,se,V,T.width,T.height,T)},e.startsWith("data:image")?T.src=e:T.src=`data:image/jpeg;base64,${e}`},[e]),N.useEffect(()=>{if(!w.current||S===0||!X.current)return;const T=w.current.getContext("2d");C(T,r,i,B,S,X.current)},[r,i,B,S]);const g=T=>{const D=w.current,H=D.getBoundingClientRect(),se=Math.floor((T.clientY-H.top)*(D.height/H.height));Math.abs(se-r)<10?d(!0):Math.abs(se-i)<10&&m(!0)},y=T=>{if(!u&&!h)return;const D=w.current,H=D.getBoundingClientRect(),se=Math.floor((T.clientY-H.top)*(D.height/H.height)),V=Math.max(0,Math.min(D.height,se));if(u){const K=Math.min(V,i-10);s(K)}else if(h){const K=Math.max(V,r+10);a(K)}},E=()=>{d(!1),m(!1)},j=()=>{t({topY:r,bottomY:i})};return l.jsx("div",{className:"image-modal",onClick:n,children:l.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:T=>T.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:n,children:""}),l.jsx("h2",{children:"Set Manual Scan Area"}),l.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines to define the scan area"}),l.jsx("canvas",{ref:w,onMouseDown:g,onMouseMove:y,onMouseUp:E,onMouseLeave:E,style:{cursor:u||h?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),l.jsx("div",{className:"manual-scan-info",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Top Y:"})," ",r," | ",l.jsx("strong",{children:"Bottom Y:"})," ",i," | ",l.jsx("strong",{children:"Height:"})," ",i-r,"px"]})}),l.jsxs("div",{className:"manual-scan-actions",children:[l.jsx("button",{onClick:j,className:"save-btn",children:"Save Bounds"}),l.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const Ni=Lu(),r6="adminPassword",bi=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),s6=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function i6({sessionGameId:e}){var zn,wi,za,Qs,xi,Js;const[t,n]=N.useState(null),[r,s]=N.useState(!0),[i,a]=N.useState(null),[u,d]=N.useState(null),[h,m]=N.useState(null),[w,S]=N.useState("all"),[_,B]=N.useState(""),[O,X]=N.useState(!1),[C,g]=N.useState({}),[y,E]=N.useState({current:0,total:0}),[j,T]=N.useState("#FF0000"),[D,H]=N.useState("#0000FF"),[se,V]=N.useState(!1),[K,ee]=N.useState(!1),[q,te]=N.useState({}),[Se,ve]=N.useState({current:0,total:0}),[ye,ne]=N.useState("bottom"),[oe,re]=N.useState(100),[we,Te]=N.useState(null),[Le,$e]=N.useState(null),[Oe,De]=N.useState(!1),[Y,Q]=N.useState(null),[me,ue]=N.useState(!1),[P,U]=N.useState(null),[J,de]=N.useState({}),[$,v]=N.useState(!1),[R,b]=N.useState(""),[M,F]=N.useState(!1),[z,W]=N.useState(null),[fe,ge]=N.useState("chronological"),[Ce,Ie]=N.useState(55),[Ue,Ze]=N.useState(!1),[nt,lt]=N.useState({current:0,total:0}),[ut,He]=N.useState(null),ze=N.useCallback(async L=>{if(!L)return{suggestion:"None",stats:null};try{const ce=await z5(L,j,D,{anchor:ye,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:ye==="manually"&&Le?null:oe/100,manualBounds:ye==="manually"?Le:null});if(ce)return ce}catch(ce){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",ce)}return U5(L,j,D,{anchor:ye})},[j,D,ye,oe,Le]);N.useEffect(()=>{const L=localStorage.getItem(r6);L&&B(L)},[]),N.useEffect(()=>{e&&_&&qe()},[e,_]);const Ge=L=>{if(!L||typeof L.h>"u")return null;const ce=(L.h||0)*2,ae=(L.s||0)/255,Z=(L.v||0)/255,he=Z*ae,je=he*(1-Math.abs(ce/60%2-1)),Xe=Z-he;let Qe=0,Re=0,Ve=0;ce>=0&&ce<60?(Qe=he,Re=je,Ve=0):ce<120?(Qe=je,Re=he,Ve=0):ce<180?(Qe=0,Re=he,Ve=je):ce<240?(Qe=0,Re=je,Ve=he):ce<300?(Qe=je,Re=0,Ve=he):(Qe=he,Re=0,Ve=je);const Vt=jn=>{const Pt=Math.round((jn+Xe)*255).toString(16);return Pt.length===1?"0"+Pt:Pt};return`#${Vt(Qe)}${Vt(Re)}${Vt(Ve)}`.toUpperCase()},qe=async()=>{var L,ce,ae,Z;if(_){s(!0),a(null);try{const he=await fetch(`${Ni}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":_}});if(!he.ok)throw new Error(`Failed to load session (${he.status})`);const je=await he.json();n(je);let Xe=null,Qe=null,Re="";if(je.colorA&&je.colorB?(Xe=je.colorA,Qe=je.colorB,Re="session root"):(ce=(L=je.metadata)==null?void 0:L.config)!=null&&ce.colorA&&((Z=(ae=je.metadata)==null?void 0:ae.config)!=null&&Z.colorB)&&(Xe=je.metadata.config.colorA,Qe=je.metadata.config.colorB,Re="session metadata"),Xe&&Qe)T(Xe),H(Qe),console.log(`[MoveHistoryEditor]  Loaded colors from ${Re}:`,Xe,Qe);else try{const Ve=JSON.parse(localStorage.getItem("calibrationA")||"null"),Vt=JSON.parse(localStorage.getItem("calibrationB")||"null");if(Ve&&Vt){const jn=Ge(Ve),Pt=Ge(Vt);jn&&Pt?(T(jn),H(Pt),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",jn,Pt)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch(Ve){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",Ve),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(he){console.error("[MoveHistoryEditor] Error loading session:",he),a(he.message)}finally{s(!1)}}},xt=async(L,ce)=>{if(!(!e||!L||!_))try{const ae=await fetch(`${Ni}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent(L)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({player:ce})});if(!ae.ok)throw new Error(`Failed to update player (${ae.status})`);n(Z=>Z&&{...Z,moves:Z.moves.map(he=>he._id===L?{...he,player:ce}:he)}),g(Z=>{const he={...Z};return delete he[L],he}),console.log("[MoveHistoryEditor] Player updated:",L,ce)}catch(ae){console.error("[MoveHistoryEditor] Error updating player:",ae),alert("Failed to update player: "+ae.message)}},$n=async()=>{if(!(!e||!_)){X(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",j,"Player B:",D);const L=Qt.filter(ae=>ae.camera_frame);if(L.length===0){alert("No moves with camera frames to process");return}E({current:0,total:L.length}),console.log(`[MoveHistoryEditor] Processing ${L.length} moves one by one...`);let ce=0;for(const ae of L){E({current:ce+1,total:L.length});try{const Z=await fetch(`${Ni}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({sessionGameId:e,moveId:ae._id,colorA:j,colorB:D,cameraPosition:ye==="top"||ye==="bottom"?ye:void 0})});if(Z.ok){const he=await Z.json();b(""),g(je=>({...je,[ae._id]:{player:he.suggestion==="A"?"Player A":he.suggestion==="B"?"Player B":"None",confidence:he.confidence,rawResponse:he.rawResponse}})),ce++,console.log(`[MoveHistoryEditor]  Processed ${ce}/${L.length}: ${he.suggestion}`)}else Z.status===503?b(" Retrying..."):b(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${ae._id}`)}catch(Z){b(""),console.error(`[MoveHistoryEditor] Error processing move ${ae._id}:`,Z)}}console.log("[MoveHistoryEditor] AI identification complete:",ce,"moves processed"),alert(`AI identified ${ce} moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in AI identification:",L),alert("AI identification failed: "+L.message)}finally{X(!1),E({current:0,total:0}),b("")}}},mt=async()=>{if(!(!e||!_)){X(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",j,"Player B:",D);const L=Qt.filter(ae=>ae.camera_frame&&(!ae.player||ae.player==="Unknown"||ae.player==="None"));if(L.length===0){alert("No unknown moves with camera frames to process");return}E({current:0,total:L.length}),console.log(`[MoveHistoryEditor] Processing ${L.length} unknown moves one by one...`);let ce=0;for(const ae of L){E({current:ce+1,total:L.length});try{const Z=await fetch(`${Ni}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({sessionGameId:e,moveId:ae._id,colorA:j,colorB:D,cameraPosition:ye==="top"||ye==="bottom"?ye:void 0})});if(Z.ok){const he=await Z.json();b(""),g(je=>({...je,[ae._id]:{player:he.suggestion==="A"?"Player A":he.suggestion==="B"?"Player B":"None",confidence:he.confidence,rawResponse:he.rawResponse}})),ce++,console.log(`[MoveHistoryEditor]  Processed ${ce}/${L.length}: ${he.suggestion}`)}else Z.status===503?b(" Retrying..."):b(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${ae._id}`)}catch(Z){b(""),console.error(`[MoveHistoryEditor] Error processing move ${ae._id}:`,Z)}}console.log("[MoveHistoryEditor] AI identification complete:",ce,"unknown moves processed"),alert(`AI identified ${ce} unknown moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in AI identification:",L),alert("AI identification failed: "+L.message)}finally{X(!1),E({current:0,total:0}),b("")}}},Ut=async L=>{const ce=C[L];ce&&await xt(L,ce.player)},Tt=async()=>{if(!(!t||!Array.isArray(t.moves))){ee(!0),te({});try{console.log("[MoveHistoryEditor] Starting color identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",j,"Player B:",D);const L=Qt.filter(ae=>ae.camera_frame);if(L.length===0){alert("No moves with camera frames to process (color)");return}ve({current:0,total:L.length});let ce=0;for(const ae of L){ve({current:ce+1,total:L.length});try{const Z=await ze(ae.camera_frame);if(!Z)continue;te(he=>({...he,[ae._id]:{method:"color",player:Z.suggestion==="A"?"Player A":Z.suggestion==="B"?"Player B":"None",stats:Z.stats,preview:Z.preview}})),ce+=1}catch(Z){console.error(`[MoveHistoryEditor] Color identify error for move ${ae._id}:`,Z)}}console.log("[MoveHistoryEditor] Color identification complete:",ce,"moves processed"),alert(`Color-based method suggested players for ${ce} moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in color identification:",L),alert("Color-based identification failed: "+L.message)}finally{ee(!1),ve({current:0,total:0})}}},nn=async()=>{if(!(!t||!Array.isArray(t.moves))){ee(!0),te({});try{console.log("[MoveHistoryEditor] Starting color identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",j,"Player B:",D);const L=Qt.filter(ae=>ae.camera_frame&&(!ae.player||ae.player==="Unknown"||ae.player==="None"));if(L.length===0){alert("No unknown moves with camera frames to process (color)");return}ve({current:0,total:L.length});let ce=0;for(const ae of L){ve({current:ce+1,total:L.length});try{const Z=await ze(ae.camera_frame);if(!Z)continue;te(he=>({...he,[ae._id]:{method:"color",player:Z.suggestion==="A"?"Player A":Z.suggestion==="B"?"Player B":"None",stats:Z.stats,preview:Z.preview}})),ce+=1}catch(Z){console.error(`[MoveHistoryEditor] Color identify error for move ${ae._id}:`,Z)}}console.log("[MoveHistoryEditor] Color identification complete:",ce,"unknown moves processed"),alert(`Color-based method suggested players for ${ce} unknown moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in color identification:",L),alert("Color-based identification failed: "+L.message)}finally{ee(!1),ve({current:0,total:0})}}},mn=async L=>{const ce=q[L];ce&&(await xt(L,ce.player),te(ae=>{const Z={...ae};return delete Z[L],Z}))},gn=async L=>{if(!t||!Array.isArray(t.moves))return;const ce=t.moves.find(ae=>ae._id===L);if(!ce||!ce.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${L}`);const ae=await ze(ce.camera_frame);if(!ae){alert("Color-based identification failed for this move.");return}te(je=>({...je,[L]:{method:"color",player:ae.suggestion==="A"?"Player A":ae.suggestion==="B"?"Player B":"None",stats:ae.stats,preview:ae.preview}}));let Z=null,he=null;try{Z=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{Z=null}try{he=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{he=null}Te({moveId:L,original:ce.camera_frame,preview:ae.preview,maskPreview:ae.maskPreview,stats:ae.stats,suggestion:ae.suggestion,colorA:j,colorB:D,calibrationA:Z,calibrationB:he,anchor:ye})}catch(ae){console.error("[MoveHistoryEditor] Error color-identifying move:",ae),alert("Color-based identification failed: "+ae.message)}},yn=N.useCallback(async({mode:L})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ce=t.moves.filter(Z=>Z.camera_frame);if(ce.length===0){alert("No camera frames available for cloth-based identification.");return}const ae=new Set(t.moves.filter(Z=>!Z.player||Z.player==="Unknown"||Z.player==="None").map(Z=>Z._id));if(L==="unknown"&&ae.size===0){alert("All moves already have players assigned.");return}ue(!0),U(null);try{const Z=ce.map(Re=>({moveId:Re._id,frameDataUrl:Re.camera_frame,existingPlayer:Re.player&&Re.player!=="Unknown"?Re.player:null})),he=await W5(Z,{maxFrames:ce.length,stride:2,minClothPixels:80,manualBounds:ye==="manually"?Le:null});he!=null&&he.analytics&&U(he.analytics);const je={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Re,Ve])=>{var Vt;(Vt=Ve.stats)!=null&&Vt.debugPreview&&(je[Re]=Ve.stats.debugPreview)}),Object.keys(je).length>0&&de(je);const Xe={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Re,Ve])=>{(L==="all"||ae.has(Re))&&(Xe[Re]={method:"cloth",player:Ve.player,styleLabel:Ve.styleLabel,confidence:Ve.confidence,stats:Ve.stats})});const Qe=Object.keys(Xe).length;Qe===0?alert(`Cloth-based method did not find suggestions for any ${L==="all"?"moves":"unknown moves"}.`):(te(Ve=>({...Ve,...Xe})),alert(`Cloth-based method suggested players for ${Qe} ${L==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(Z){console.error("[MoveHistoryEditor] Cloth identification failed:",Z),alert("Cloth-based identification failed: "+Z.message)}finally{ue(!1)}},[t,ye,Le]),_n=N.useCallback(()=>{yn({mode:"all"})},[yn]),Qr=N.useCallback(()=>{yn({mode:"unknown"})},[yn]),Dn=N.useCallback(async({mode:L})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ce=t.moves.filter(Z=>Z.camera_frame);if(ce.length===0){alert("No camera frames available for All-All identification.");return}const ae=new Set(t.moves.filter(Z=>!Z.player||Z.player==="Unknown"||Z.player==="None").map(Z=>Z._id));if(L==="unknown"&&ae.size===0){alert("All moves already have players assigned.");return}F(!0),W(null);try{const Z=ce.map(Re=>({moveId:Re._id,frameDataUrl:Re.camera_frame,existingPlayer:Re.player&&Re.player!=="Unknown"&&Re.player!=="None"?Re.player:null})),he=await Z5(Z,{maxFrames:ce.length,stride:2,minPixels:80,manualBounds:ye==="manually"?Le:null});he!=null&&he.analytics&&W(he.analytics);const je={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Re,Ve])=>{var Vt;(Vt=Ve.stats)!=null&&Vt.debugPreview&&(je[Re]=Ve.stats.debugPreview)}),Object.keys(je).length>0&&de(Re=>({...Re,...je}));const Xe={};he!=null&&he.assignments&&Object.entries(he.assignments).forEach(([Re,Ve])=>{(L==="all"||ae.has(Re))&&(Xe[Re]={method:"allall",player:Ve.player,styleLabel:Ve.styleLabel,confidence:Ve.confidence,stats:Ve.stats})});const Qe=Object.keys(Xe).length;Qe===0?alert(`All-All method did not find suggestions for any ${L==="all"?"moves":"unknown moves"}.`):(te(Ve=>({...Ve,...Xe})),alert(`All-All method suggested players for ${Qe} ${L==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(Z){console.error("[MoveHistoryEditor] All-All identification failed:",Z),alert("All-All identification failed: "+Z.message)}finally{F(!1)}},[t,ye,Le]),Lr=N.useCallback(()=>{Dn({mode:"all"})},[Dn]),Br=N.useCallback(()=>{Dn({mode:"unknown"})},[Dn]),gs=async L=>{if(!(!e||!_))try{console.log(`[MoveHistoryEditor] Identifying single move: ${L}`);const ce=await fetch(`${Ni}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({sessionGameId:e,moveId:L,colorA:j,colorB:D,cameraPosition:ye==="top"||ye==="bottom"?ye:void 0})});if(ce.ok){const ae=await ce.json();g(Z=>({...Z,[L]:{player:ae.suggestion==="A"?"Player A":ae.suggestion==="B"?"Player B":"None",confidence:ae.confidence,rawResponse:ae.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${ae.suggestion}`)}else{const ae=await ce.json();alert(`Failed to identify move: ${ae.message}`)}}catch(ce){console.error("[MoveHistoryEditor] Error identifying move:",ce),alert("AI identification failed: "+ce.message)}},Qt=((zn=t==null?void 0:t.moves)==null?void 0:zn.filter(L=>w==="all"?!0:L.phase===w))||[],Un=(()=>{const L=[...Qt];return fe==="chronological"?L:L.sort((ce,ae)=>{var Qe,Re;const Z=!!q[ce._id],he=!!q[ae._id];if(Z&&!he)return-1;if(!Z&&he)return 1;if(!Z&&!he)return 0;const je=((Qe=q[ce._id])==null?void 0:Qe.confidence)||0,Xe=((Re=q[ae._id])==null?void 0:Re.confidence)||0;return fe==="confidenceDesc"?Xe-je:fe==="confidenceAsc"?je-Xe:0})})(),sr=async()=>{if(!e||!_)return;const L=Object.entries(q).filter(([ce,ae])=>(ae.confidence||0)*100>=Ce).map(([ce,ae])=>({moveId:ce,player:ae.player}));if(L.length===0){alert(`No moves found with confidence above ${Ce}%`);return}if(window.confirm(`Are you sure you want to confirm ${L.length} moves with confidence >= ${Ce}%?`)){Ze(!0),lt({current:0,total:L.length});try{const ce=await fetch(`${Ni}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":_},body:JSON.stringify({updates:L})});if(!ce.ok)throw new Error(`Failed to update players (${ce.status})`);const ae=await ce.json();console.log("[MoveHistoryEditor] Bulk update success:",ae),n(Z=>{if(!Z)return Z;const he=Z.moves.map(je=>{const Xe=L.find(Qe=>Qe.moveId===je._id);return Xe?{...je,player:Xe.player}:je});return{...Z,moves:he}}),te(Z=>{const he={...Z};return L.forEach(({moveId:je})=>{delete he[je]}),he}),alert(`Successfully confirmed ${L.length} moves.`)}catch(ce){console.error("Failed to confirm moves:",ce),alert("Failed to confirm moves: "+ce.message)}finally{Ze(!1),lt({current:0,total:0})}}};if(r)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return l.jsx("div",{className:"move-editor-container",children:l.jsxs("div",{className:"move-editor-error",children:[l.jsx("h2",{children:"Error Loading Session"}),l.jsx("p",{children:i}),l.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-error",children:"Session not found"})});const Ks=((wi=t.moves)==null?void 0:wi.filter(L=>L.phase==="practice").length)||0,St=((za=t.moves)==null?void 0:za.filter(L=>L.phase==="experiment").length)||0;return l.jsxs("div",{className:"move-editor-container",children:[l.jsxs("header",{className:"move-editor-header",children:[l.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),l.jsxs("div",{className:"move-editor-title",children:[l.jsx("h1",{children:"Move History Editor"}),l.jsxs("div",{className:"session-info",children:[l.jsxs("span",{className:"session-id",children:["Session: ",e]}),l.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),l.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]})]}),l.jsxs("div",{className:"phase-filter",children:[l.jsxs("button",{className:`filter-btn ${w==="all"?"active":""}`,onClick:()=>S("all"),children:["All (",((Qs=t.moves)==null?void 0:Qs.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${w==="practice"?"active":""}`,onClick:()=>S("practice"),children:["Practice (",Ks,")"]}),l.jsxs("button",{className:`filter-btn ${w==="experiment"?"active":""}`,onClick:()=>S("experiment"),children:["Experiment (",St,")"]})]}),l.jsxs("div",{className:"bracelet-colors-controls",children:[l.jsx("button",{className:"color-picker-toggle",onClick:()=>V(!se),children:"Bracelet Colors"}),se&&l.jsxs("div",{className:"color-picker-panel",children:[l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player A:"}),l.jsx("input",{type:"color",value:j,onChange:L=>T(L.target.value)}),l.jsx("span",{children:j})]}),l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player B:"}),l.jsx("input",{type:"color",value:D,onChange:L=>H(L.target.value)}),l.jsx("span",{children:D})]})]})]}),l.jsxs("div",{className:"ai-controls",children:[l.jsx("button",{className:"ai-btn ai-btn-all",onClick:$n,disabled:O,children:O&&y.total>0?R?`${R} ${y.current}/${y.total}`:`Processing ${y.current}/${y.total}...`:"AI Identify All"}),l.jsx("button",{className:"ai-btn ai-btn-unknown",onClick:mt,disabled:O,children:O&&y.total>0?R?`${R} ${y.current}/${y.total}`:`Processing ${y.current}/${y.total}...`:"AI Identify Unknown"})]}),l.jsxs("div",{className:"color-controls",children:[l.jsx("button",{className:"ai-btn color-btn-all",onClick:Tt,disabled:K,children:K&&Se.total>0?` Color ${Se.current}/${Se.total}...`:" Color Identify All"}),l.jsx("button",{className:"ai-btn ai-btn-unknown color-btn-unknown",onClick:nn,disabled:K,children:K&&Se.total>0?` Color Unknown ${Se.current}/${Se.total}...`:" Color Identify Unknown"}),l.jsx("button",{className:"ai-btn cloth-btn",onClick:_n,disabled:me,children:me?" Identifying by Cloth...":" Identify by Cloth All"}),l.jsx("button",{className:"ai-btn cloth-btn",onClick:Qr,disabled:me,children:me?" Identifying by Cloth...":" Identify by Cloth Unknown"}),Object.keys(J).length>0&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:`ai-btn debug-btn ${$?"active":""}`,onClick:()=>v(!$),style:{backgroundColor:$?"#4CAF50":"#666",marginLeft:"20px"},children:$?" Debug View ON":" Show Debug View"}),l.jsx("button",{className:"ai-btn debug-btn",onClick:()=>{v(!1),de({})},style:{backgroundColor:"#ff5722"},children:" Clear Debug"})]}),l.jsx("button",{className:"ai-btn allall-btn",onClick:Lr,disabled:M,children:M?" Identifying by All All...":" Identify by All All"}),l.jsx("button",{className:"ai-btn allall-btn",onClick:Br,disabled:M,children:M?" Identifying by All All...":" Identify by All Unknown"}),l.jsxs("div",{className:"color-anchor-toggle",children:[l.jsx("label",{children:"Color anchor:"}),l.jsxs("select",{value:ye,onChange:L=>{if(ne(L.target.value),L.target.value==="manually"){const ce=(t==null?void 0:t.moves)||[];if(ce.length>0){const ae=ce[Math.floor(Math.random()*ce.length)];ae!=null&&ae.camera_frame?(Q(ae.camera_frame),De(!0)):(alert("No frames available. Please ensure moves have camera frames."),ne("bottom"))}else alert("No moves available."),ne("bottom")}else De(!1),$e(null),Q(null)},children:[l.jsx("option",{value:"bottom",children:"Bottom"}),l.jsx("option",{value:"top",children:"Top"}),l.jsx("option",{value:"manually",children:"Manually"})]})]}),ye!=="manually"&&l.jsxs("div",{className:"color-scan-percentage",children:[l.jsxs("label",{children:["Scan area: ",oe,"%"]}),l.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:oe,onChange:L=>re(Number(L.target.value)),style:{width:"120px",marginLeft:"8px"}})]}),ye==="manually"&&Le&&l.jsxs("div",{className:"manual-bounds-info",children:[l.jsxs("span",{children:["Manual: Y=",Le.topY,"  ",Le.bottomY]}),l.jsx("button",{onClick:()=>De(!0),style:{marginLeft:"8px",padding:"4px 8px"},children:"Edit"})]})]})]}),P&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsx("div",{className:"cloth-analytics-header",children:l.jsxs("div",{children:[l.jsx("h3",{children:"Cloth Styles Analytics"}),l.jsxs("p",{children:["Frames analyzed: ",P.usedFrames,"/",P.totalFrames,"  Skipped:"," ",P.skippedFrames]})]})}),l.jsx("div",{className:"cloth-style-grid",children:(xi=P.clusters)==null?void 0:xi.map(L=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:L.styleLabel}),l.jsx("span",{className:"player-label",children:L.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:L.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",L.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",L.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",bi(L.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",bi(L.avgBrightness||0)]})]})]},L.id))})]}),z&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsxs("div",{className:"cloth-analytics-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:" All-All Styles Analytics (Background Excluded)"}),l.jsxs("p",{children:["Frames analyzed: ",z.usedFrames,"/",z.totalFrames,"  Skipped:"," ",z.skippedFrames]})]}),l.jsxs("div",{className:"analytics-controls",style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"15px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#f5f5f5",padding:"4px 8px",borderRadius:"4px"},children:[l.jsxs("label",{style:{fontSize:"14px"},children:["Confirm threshold: ",Ce,"%"]}),l.jsx("input",{type:"range",min:"50",max:"100",value:Ce,onChange:L=>Ie(Number(L.target.value)),style:{width:"100px"}}),l.jsx("button",{onClick:sr,disabled:Ue,style:{backgroundColor:Ue?"#9E9E9E":"#4CAF50",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:Ue?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",minWidth:"140px"},children:Ue?`Saving ${nt.current}/${nt.total}...`:`Confirm All  ${Ce}% (${Object.values(q).filter(L=>(L.confidence||0)*100>=Ce).length})`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("label",{children:"Sort by:"}),l.jsxs("select",{value:fe,onChange:L=>ge(L.target.value),style:{padding:"4px",borderRadius:"4px"},children:[l.jsx("option",{value:"chronological",children:"Chronological"}),l.jsx("option",{value:"confidenceDesc",children:"Confidence (High to Low)"}),l.jsx("option",{value:"confidenceAsc",children:"Confidence (Low to High)"})]})]})]})]}),l.jsx("div",{className:"cloth-style-grid",children:(Js=z.clusters)==null?void 0:Js.map(L=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:L.styleLabel}),l.jsx("span",{className:"player-label",children:L.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:L.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",L.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",L.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",bi(L.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",bi(L.avgBrightness||0)]})]})]},L.id))})]}),l.jsxs("div",{className:"move-editor-content",children:[l.jsx("div",{className:"moves-grid",children:Un.map((L,ce)=>{var ae;return l.jsxs("div",{className:`move-card ${(u==null?void 0:u._id)===L._id?"selected":""}`,onClick:()=>d(L),children:[l.jsxs("div",{className:"move-card-header",children:[l.jsxs("span",{className:"move-number",children:["#",ce+1]}),l.jsx("span",{className:`move-phase ${L.phase}`,children:L.phase})]}),L.camera_frame&&l.jsxs("div",{className:"move-image",onClick:Z=>{Z.stopPropagation(),m($&&J[L._id]?J[L._id]:L.camera_frame)},style:{position:"relative"},children:[l.jsx("img",{src:$&&J[L._id]?J[L._id]:L.camera_frame,alt:`Move ${ce+1}`}),l.jsx("div",{className:"image-overlay",children:" Click to enlarge"}),$&&J[L._id]&&l.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(76, 175, 80, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:" DEBUG"})]}),l.jsxs("div",{className:"move-card-body",children:[l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Type:"}),l.jsx("span",{className:"value",children:L.type})]}),C[L._id]&&(()=>{const Z=C[L._id].player,je=Z==="A"||Z==="Player A"?j:D;return l.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:je,outline:`2px solid ${s6(je,.25)}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:""}),l.jsxs("span",{className:"ai-text",children:["AI suggests: ",l.jsx("strong",{children:C[L._id].player})]})]}),l.jsx("button",{className:"ai-confirm-btn",onClick:Xe=>{Xe.stopPropagation(),Ut(L._id)},children:" Confirm"})]})})(),q[L._id]&&(()=>{const Z=q[L._id],Xe=Z.player==="Player A"?j:D,Qe=Z.method||"color",Re=Qe==="cloth"?"":Qe==="allall"?"":"",Ve=Qe==="cloth"?`Cloth suggests${Z.styleLabel?` (${Z.styleLabel})`:""}:`:Qe==="allall"?`All-All suggests${Z.styleLabel?` (${Z.styleLabel})`:""}:`:"Color suggests:",Vt=typeof Z.confidence=="number"?`  ${Math.round(Z.confidence*100)}% confidence`:"";let jn=Xe;if(Z.stats&&Z.stats.meanColor){const{r:Pt,g:Ha,b:Si}=Z.stats.meanColor,Nn=ki=>{const To=Math.round(ki).toString(16);return To.length===1?"0"+To:To};jn=`#${Nn(Pt)}${Nn(Ha)}${Nn(Si)}`}return l.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:jn,borderWidth:"2px",outline:`4px solid ${jn}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:Re}),l.jsxs("span",{className:"ai-text",children:[Ve," ",l.jsx("strong",{children:Z.player}),Vt]})]}),l.jsx("button",{className:"ai-confirm-btn",disabled:ut===L._id,onClick:async Pt=>{Pt.stopPropagation(),He(L._id),await mn(L._id),He(null)},children:ut===L._id?"...":" Confirm"})]})})(),l.jsxs("div",{className:"move-info-row player-row",style:{borderColor:L.player==="Player A"?j:L.player==="Player B"?D:L.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("span",{className:"label",children:"Player:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[l.jsxs("select",{className:`player-select ${(ae=L.player)==null?void 0:ae.toLowerCase().replace(" ","-")}`,value:L.player||"Unknown",onChange:Z=>xt(L._id,Z.target.value),onClick:Z=>Z.stopPropagation(),style:{flex:1,borderColor:L.player==="Player A"?j:L.player==="Player B"?D:L.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]}),L.camera_frame&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"ai-single-btn",onClick:Z=>{Z.stopPropagation(),gs(L._id)},title:"Identify this move with AI",children:""}),l.jsx("button",{className:"ai-single-btn color-single-btn",onClick:Z=>{Z.stopPropagation(),gn(L._id)},title:"Identify this move by color",children:""})]})]})]}),L.blockId!==null&&L.blockId!==void 0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Block:"}),l.jsx("span",{className:"value",children:L.blockId})]}),Array.isArray(L.position)&&L.position.length===2&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Position:"}),l.jsxs("span",{className:"value",children:["(",L.position[0],", ",L.position[1],")"]})]}),l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Time:"}),l.jsxs("span",{className:"value",children:[bi(L.elapsed,1),"s"]})]}),Number.isFinite(L.holdTime)&&L.holdTime>0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Hold:"}),l.jsxs("span",{className:"value",children:[bi(L.holdTime,2),"s"]})]})]})]},L._id||ce)})}),Qt.length===0&&l.jsx("div",{className:"no-moves",children:l.jsx("p",{children:"No moves found for selected filter."})})]}),h&&l.jsx("div",{className:"image-modal",onClick:()=>m(null),children:l.jsxs("div",{className:"image-modal-content",onClick:L=>L.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:()=>m(null),children:""}),l.jsx("img",{src:h,alt:"Expanded view"})]})}),l.jsx(t6,{colorPreview:we,onClose:()=>Te(null)}),Oe&&Y&&l.jsx(n6,{frameDataUrl:Y,onSave:L=>{$e(L),De(!1)},onCancel:()=>{De(!1),ne("bottom"),Q(null)}})]})}const o6=!1;function a6(){const[e,t]=N.useState(!1),[n,r]=N.useState(null),[s,i]=N.useState(null),[a,u]=N.useState(window.location.hash),[d,h]=N.useState(!1);N.useEffect(()=>{const B=()=>{u(window.location.hash)};return window.addEventListener("hashchange",B),()=>window.removeEventListener("hashchange",B)},[]),N.useEffect(()=>(window.toggleInterface=B=>{h(B),console.log("[App] Interface "+(B?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const m=B=>{r(B),t(!0)},w=()=>{s&&!s.closed&&s.close();const B=window.location.origin+window.location.pathname+"#/detector",O=window.open(B,"BraceletDetector","width=700,height=600,left=100,top=100");i(O)};N.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),N.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(B){console.error("Error ending experience:",B),alert("Error ending experience: "+B.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let S=null;const _=a.match(/^#\/admin\/edit-moves\/(.+)$/);if(a==="#/detector")S=l.jsx(y1,{});else if(a==="#/calibrate")S=l.jsx(dx,{});else if(a==="#/detector2")S=l.jsx(fx,{});else if(a==="#/summary")S=l.jsx(Q2,{});else if(a==="#/admin")S=l.jsx(px,{});else if(a==="#/admin/upload")S=l.jsx(mx,{});else if(_){const B=decodeURIComponent(_[1]);S=l.jsx(i6,{sessionGameId:B},B)}else S=e?l.jsxs(l.Fragment,{children:[l.jsx(ux,{config:n,interfaceHidden:d}),l.jsx(y1,{hidden:d}),o6,!d&&l.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[l.jsx("button",{onClick:w,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),l.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),l.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&l.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:l.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):l.jsx(tx,{onStart:m});return l.jsx("div",{className:"App",children:S})}cd.createRoot(document.getElementById("root")).render(l.jsx(W0.StrictMode,{children:l.jsx(a6,{})}));
