(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var cc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var M0={exports:{}},ou={},P0={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ma=Symbol.for("react.element"),kv=Symbol.for("react.portal"),Ev=Symbol.for("react.fragment"),Av=Symbol.for("react.strict_mode"),_v=Symbol.for("react.profiler"),Cv=Symbol.for("react.provider"),jv=Symbol.for("react.context"),Nv=Symbol.for("react.forward_ref"),Tv=Symbol.for("react.suspense"),Mv=Symbol.for("react.memo"),Pv=Symbol.for("react.lazy"),qp=Symbol.iterator;function bv(e){return e===null||typeof e!="object"?null:(e=qp&&e[qp]||e["@@iterator"],typeof e=="function"?e:null)}var b0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I0=Object.assign,R0={};function qi(e,t,n){this.props=e,this.context=t,this.refs=R0,this.updater=n||b0}qi.prototype.isReactComponent={};qi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};qi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function L0(){}L0.prototype=qi.prototype;function gf(e,t,n){this.props=e,this.context=t,this.refs=R0,this.updater=n||b0}var yf=gf.prototype=new L0;yf.constructor=gf;I0(yf,qi.prototype);yf.isPureReactComponent=!0;var e1=Array.isArray,B0=Object.prototype.hasOwnProperty,vf={current:null},F0={key:!0,ref:!0,__self:!0,__source:!0};function O0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)B0.call(t,r)&&!F0.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var d=Array(l),h=0;h<l;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ma,type:e,key:i,ref:a,props:s,_owner:vf.current}}function Iv(e,t){return{$$typeof:ma,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function wf(e){return typeof e=="object"&&e!==null&&e.$$typeof===ma}function Rv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var t1=/\/+/g;function dc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Rv(""+e.key):t.toString(36)}function il(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ma:case kv:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+dc(a,0):r,e1(s)?(n="",e!=null&&(n=e.replace(t1,"$&/")+"/"),il(s,t,n,"",function(h){return h})):s!=null&&(wf(s)&&(s=Iv(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(t1,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",e1(e))for(var l=0;l<e.length;l++){i=e[l];var d=r+dc(i,l);a+=il(i,t,n,d,s)}else if(d=bv(e),typeof d=="function")for(e=d.call(e),l=0;!(i=e.next()).done;)i=i.value,d=r+dc(i,l++),a+=il(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ba(e,t,n){if(e==null)return e;var r=[],s=0;return il(e,r,"","",function(i){return t.call(n,i,s++)}),r}function Lv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var pn={current:null},ol={transition:null},Bv={ReactCurrentDispatcher:pn,ReactCurrentBatchConfig:ol,ReactCurrentOwner:vf};function $0(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:Ba,forEach:function(e,t,n){Ba(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ba(e,function(){t++}),t},toArray:function(e){return Ba(e,function(t){return t})||[]},only:function(e){if(!wf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};We.Component=qi;We.Fragment=Ev;We.Profiler=_v;We.PureComponent=gf;We.StrictMode=Av;We.Suspense=Tv;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bv;We.act=$0;We.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=I0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=vf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(d in t)B0.call(t,d)&&!F0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&l!==void 0?l[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){l=Array(d);for(var h=0;h<d;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:ma,type:e.type,key:s,ref:i,props:r,_owner:a}};We.createContext=function(e){return e={$$typeof:jv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Cv,_context:e},e.Consumer=e};We.createElement=O0;We.createFactory=function(e){var t=O0.bind(null,e);return t.type=e,t};We.createRef=function(){return{current:null}};We.forwardRef=function(e){return{$$typeof:Nv,render:e}};We.isValidElement=wf;We.lazy=function(e){return{$$typeof:Pv,_payload:{_status:-1,_result:e},_init:Lv}};We.memo=function(e,t){return{$$typeof:Mv,type:e,compare:t===void 0?null:t}};We.startTransition=function(e){var t=ol.transition;ol.transition={};try{e()}finally{ol.transition=t}};We.unstable_act=$0;We.useCallback=function(e,t){return pn.current.useCallback(e,t)};We.useContext=function(e){return pn.current.useContext(e)};We.useDebugValue=function(){};We.useDeferredValue=function(e){return pn.current.useDeferredValue(e)};We.useEffect=function(e,t){return pn.current.useEffect(e,t)};We.useId=function(){return pn.current.useId()};We.useImperativeHandle=function(e,t,n){return pn.current.useImperativeHandle(e,t,n)};We.useInsertionEffect=function(e,t){return pn.current.useInsertionEffect(e,t)};We.useLayoutEffect=function(e,t){return pn.current.useLayoutEffect(e,t)};We.useMemo=function(e,t){return pn.current.useMemo(e,t)};We.useReducer=function(e,t,n){return pn.current.useReducer(e,t,n)};We.useRef=function(e){return pn.current.useRef(e)};We.useState=function(e){return pn.current.useState(e)};We.useSyncExternalStore=function(e,t,n){return pn.current.useSyncExternalStore(e,t,n)};We.useTransition=function(){return pn.current.useTransition()};We.version="18.3.1";P0.exports=We;var C=P0.exports;const D0=Sv(C);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fv=C,Ov=Symbol.for("react.element"),$v=Symbol.for("react.fragment"),Dv=Object.prototype.hasOwnProperty,zv=Fv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Uv={key:!0,ref:!0,__self:!0,__source:!0};function z0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)Dv.call(t,r)&&!Uv.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Ov,type:e,key:i,ref:a,props:s,_owner:zv.current}}ou.Fragment=$v;ou.jsx=z0;ou.jsxs=z0;M0.exports=ou;var c=M0.exports,nd={},U0={exports:{}},Dn={},H0={exports:{}},G0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,oe){var Z=J.length;J.push(oe);e:for(;0<Z;){var pe=Z-1>>>1,Me=J[pe];if(0<s(Me,oe))J[pe]=oe,J[Z]=Me,Z=pe;else break e}}function n(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var oe=J[0],Z=J.pop();if(Z!==oe){J[0]=Z;e:for(var pe=0,Me=J.length,Be=Me>>>1;pe<Be;){var Xe=2*(pe+1)-1,Fe=J[Xe],ze=Xe+1,Q=J[ze];if(0>s(Fe,Z))ze<Me&&0>s(Q,Fe)?(J[pe]=Q,J[ze]=Z,pe=ze):(J[pe]=Fe,J[Xe]=Z,pe=Xe);else if(ze<Me&&0>s(Q,Z))J[pe]=Q,J[ze]=Z,pe=ze;else break e}}return oe}function s(J,oe){var Z=J.sortIndex-oe.sortIndex;return Z!==0?Z:J.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var d=[],h=[],m=1,w=null,S=3,N=!1,R=!1,F=!1,K=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(J){for(var oe=n(h);oe!==null;){if(oe.callback===null)r(h);else if(oe.startTime<=J)r(h),oe.sortIndex=oe.expirationTime,t(d,oe);else break;oe=n(h)}}function T(J){if(F=!1,k(J),!R)if(n(d)!==null)R=!0,xe(b);else{var oe=n(h);oe!==null&&ge(T,oe.startTime-J)}}function b(J,oe){R=!1,F&&(F=!1,A(G),G=-1),N=!0;var Z=S;try{for(k(oe),w=n(d);w!==null&&(!(w.expirationTime>oe)||J&&!Y());){var pe=w.callback;if(typeof pe=="function"){w.callback=null,S=w.priorityLevel;var Me=pe(w.expirationTime<=oe);oe=e.unstable_now(),typeof Me=="function"?w.callback=Me:w===n(d)&&r(d),k(oe)}else r(d);w=n(d)}if(w!==null)var Be=!0;else{var Xe=n(h);Xe!==null&&ge(T,Xe.startTime-oe),Be=!1}return Be}finally{w=null,S=Z,N=!1}}var B=!1,D=null,G=-1,le=5,V=-1;function Y(){return!(e.unstable_now()-V<le)}function te(){if(D!==null){var J=e.unstable_now();V=J;var oe=!0;try{oe=D(!0,J)}finally{oe?X():(B=!1,D=null)}}else B=!1}var X;if(typeof g=="function")X=function(){g(te)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,Ee=ee.port2;ee.port1.onmessage=te,X=function(){Ee.postMessage(null)}}else X=function(){K(te,0)};function xe(J){D=J,B||(B=!0,X())}function ge(J,oe){G=K(function(){J(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){R||N||(R=!0,xe(b))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(J){switch(S){case 1:case 2:case 3:var oe=3;break;default:oe=S}var Z=S;S=oe;try{return J()}finally{S=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,oe){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var Z=S;S=J;try{return oe()}finally{S=Z}},e.unstable_scheduleCallback=function(J,oe,Z){var pe=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?pe+Z:pe):Z=pe,J){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=Z+Me,J={id:m++,callback:oe,priorityLevel:J,startTime:Z,expirationTime:Me,sortIndex:-1},Z>pe?(J.sortIndex=Z,t(h,J),n(d)===null&&J===n(h)&&(F?(A(G),G=-1):F=!0,ge(T,Z-pe))):(J.sortIndex=Me,t(d,J),R||N||(R=!0,xe(b))),J},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(J){var oe=S;return function(){var Z=S;S=oe;try{return J.apply(this,arguments)}finally{S=Z}}}})(G0);H0.exports=G0;var Hv=H0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv=C,On=Hv;function ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var W0=new Set,Ko={};function ri(e,t){Bi(e,t),Bi(e+"Capture",t)}function Bi(e,t){for(Ko[e]=t,e=0;e<t.length;e++)W0.add(t[e])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rd=Object.prototype.hasOwnProperty,Wv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,n1={},r1={};function Vv(e){return rd.call(r1,e)?!0:rd.call(n1,e)?!1:Wv.test(e)?r1[e]=!0:(n1[e]=!0,!1)}function Yv(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Kv(e,t,n,r){if(t===null||typeof t>"u"||Yv(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function mn(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var tn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){tn[e]=new mn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];tn[t]=new mn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){tn[e]=new mn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){tn[e]=new mn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){tn[e]=new mn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){tn[e]=new mn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){tn[e]=new mn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){tn[e]=new mn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){tn[e]=new mn(e,5,!1,e.toLowerCase(),null,!1,!1)});var xf=/[\-:]([a-z])/g;function Sf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(xf,Sf);tn[t]=new mn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(xf,Sf);tn[t]=new mn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(xf,Sf);tn[t]=new mn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){tn[e]=new mn(e,1,!1,e.toLowerCase(),null,!1,!1)});tn.xlinkHref=new mn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){tn[e]=new mn(e,1,!1,e.toLowerCase(),null,!0,!0)});function kf(e,t,n,r){var s=tn.hasOwnProperty(t)?tn[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Kv(t,n,s,r)&&(n=null),r||s===null?Vv(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var is=Gv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fa=Symbol.for("react.element"),di=Symbol.for("react.portal"),fi=Symbol.for("react.fragment"),Ef=Symbol.for("react.strict_mode"),sd=Symbol.for("react.profiler"),V0=Symbol.for("react.provider"),Y0=Symbol.for("react.context"),Af=Symbol.for("react.forward_ref"),id=Symbol.for("react.suspense"),od=Symbol.for("react.suspense_list"),_f=Symbol.for("react.memo"),cs=Symbol.for("react.lazy"),K0=Symbol.for("react.offscreen"),s1=Symbol.iterator;function yo(e){return e===null||typeof e!="object"?null:(e=s1&&e[s1]||e["@@iterator"],typeof e=="function"?e:null)}var Nt=Object.assign,fc;function To(e){if(fc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);fc=t&&t[1]||""}return`
`+fc+e}var hc=!1;function pc(e,t){if(!e||hc)return"";hc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=l);break}}}finally{hc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?To(e):""}function Xv(e){switch(e.tag){case 5:return To(e.type);case 16:return To("Lazy");case 13:return To("Suspense");case 19:return To("SuspenseList");case 0:case 2:case 15:return e=pc(e.type,!1),e;case 11:return e=pc(e.type.render,!1),e;case 1:return e=pc(e.type,!0),e;default:return""}}function ad(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case fi:return"Fragment";case di:return"Portal";case sd:return"Profiler";case Ef:return"StrictMode";case id:return"Suspense";case od:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Y0:return(e.displayName||"Context")+".Consumer";case V0:return(e._context.displayName||"Context")+".Provider";case Af:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _f:return t=e.displayName||null,t!==null?t:ad(e.type)||"Memo";case cs:t=e._payload,e=e._init;try{return ad(e(t))}catch{}}return null}function Qv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ad(t);case 8:return t===Ef?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ns(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function X0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Jv(e){var t=X0(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Oa(e){e._valueTracker||(e._valueTracker=Jv(e))}function Q0(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=X0(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function El(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ld(e,t){var n=t.checked;return Nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function i1(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ns(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function J0(e,t){t=t.checked,t!=null&&kf(e,"checked",t,!1)}function ud(e,t){J0(e,t);var n=Ns(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?cd(e,t.type,n):t.hasOwnProperty("defaultValue")&&cd(e,t.type,Ns(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function o1(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function cd(e,t,n){(t!=="number"||El(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Mo=Array.isArray;function Ai(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ns(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function dd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function a1(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ie(92));if(Mo(n)){if(1<n.length)throw Error(ie(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ns(n)}}function Z0(e,t){var n=Ns(t.value),r=Ns(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function l1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function q0(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?q0(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $a,e2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for($a=$a||document.createElement("div"),$a.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=$a.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Lo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zv=["Webkit","ms","Moz","O"];Object.keys(Lo).forEach(function(e){Zv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Lo[t]=Lo[e]})});function t2(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Lo.hasOwnProperty(e)&&Lo[e]?(""+t).trim():t+"px"}function n2(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=t2(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var qv=Nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hd(e,t){if(t){if(qv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ie(62))}}function pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var md=null;function Cf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gd=null,_i=null,Ci=null;function u1(e){if(e=va(e)){if(typeof gd!="function")throw Error(ie(280));var t=e.stateNode;t&&(t=du(t),gd(e.stateNode,e.type,t))}}function r2(e){_i?Ci?Ci.push(e):Ci=[e]:_i=e}function s2(){if(_i){var e=_i,t=Ci;if(Ci=_i=null,u1(e),t)for(e=0;e<t.length;e++)u1(t[e])}}function i2(e,t){return e(t)}function o2(){}var mc=!1;function a2(e,t,n){if(mc)return e(t,n);mc=!0;try{return i2(e,t,n)}finally{mc=!1,(_i!==null||Ci!==null)&&(o2(),s2())}}function Qo(e,t){var n=e.stateNode;if(n===null)return null;var r=du(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ie(231,t,typeof n));return n}var yd=!1;if(qr)try{var vo={};Object.defineProperty(vo,"passive",{get:function(){yd=!0}}),window.addEventListener("test",vo,vo),window.removeEventListener("test",vo,vo)}catch{yd=!1}function e4(e,t,n,r,s,i,a,l,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(m){this.onError(m)}}var Bo=!1,Al=null,_l=!1,vd=null,t4={onError:function(e){Bo=!0,Al=e}};function n4(e,t,n,r,s,i,a,l,d){Bo=!1,Al=null,e4.apply(t4,arguments)}function r4(e,t,n,r,s,i,a,l,d){if(n4.apply(this,arguments),Bo){if(Bo){var h=Al;Bo=!1,Al=null}else throw Error(ie(198));_l||(_l=!0,vd=h)}}function si(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function l2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function c1(e){if(si(e)!==e)throw Error(ie(188))}function s4(e){var t=e.alternate;if(!t){if(t=si(e),t===null)throw Error(ie(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return c1(s),e;if(i===r)return c1(s),t;i=i.sibling}throw Error(ie(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?e:t}function u2(e){return e=s4(e),e!==null?c2(e):null}function c2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=c2(e);if(t!==null)return t;e=e.sibling}return null}var d2=On.unstable_scheduleCallback,d1=On.unstable_cancelCallback,i4=On.unstable_shouldYield,o4=On.unstable_requestPaint,Bt=On.unstable_now,a4=On.unstable_getCurrentPriorityLevel,jf=On.unstable_ImmediatePriority,f2=On.unstable_UserBlockingPriority,Cl=On.unstable_NormalPriority,l4=On.unstable_LowPriority,h2=On.unstable_IdlePriority,au=null,Or=null;function u4(e){if(Or&&typeof Or.onCommitFiberRoot=="function")try{Or.onCommitFiberRoot(au,e,void 0,(e.current.flags&128)===128)}catch{}}var yr=Math.clz32?Math.clz32:f4,c4=Math.log,d4=Math.LN2;function f4(e){return e>>>=0,e===0?32:31-(c4(e)/d4|0)|0}var Da=64,za=4194304;function Po(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function jl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Po(l):(i&=a,i!==0&&(r=Po(i)))}else a=n&~s,a!==0?r=Po(a):i!==0&&(r=Po(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-yr(t),s=1<<n,r|=e[n],t&=~s;return r}function h4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function p4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-yr(i),l=1<<a,d=s[a];d===-1?(!(l&n)||l&r)&&(s[a]=h4(l,t)):d<=t&&(e.expiredLanes|=l),i&=~l}}function wd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function p2(){var e=Da;return Da<<=1,!(Da&4194240)&&(Da=64),e}function gc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ga(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-yr(t),e[t]=n}function m4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-yr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Nf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-yr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var it=0;function m2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var g2,Tf,y2,v2,w2,xd=!1,Ua=[],vs=null,ws=null,xs=null,Jo=new Map,Zo=new Map,fs=[],g4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function f1(e,t){switch(e){case"focusin":case"focusout":vs=null;break;case"dragenter":case"dragleave":ws=null;break;case"mouseover":case"mouseout":xs=null;break;case"pointerover":case"pointerout":Jo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zo.delete(t.pointerId)}}function wo(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=va(t),t!==null&&Tf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function y4(e,t,n,r,s){switch(t){case"focusin":return vs=wo(vs,e,t,n,r,s),!0;case"dragenter":return ws=wo(ws,e,t,n,r,s),!0;case"mouseover":return xs=wo(xs,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Jo.set(i,wo(Jo.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Zo.set(i,wo(Zo.get(i)||null,e,t,n,r,s)),!0}return!1}function x2(e){var t=Us(e.target);if(t!==null){var n=si(t);if(n!==null){if(t=n.tag,t===13){if(t=l2(n),t!==null){e.blockedOn=t,w2(e.priority,function(){y2(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function al(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Sd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);md=r,n.target.dispatchEvent(r),md=null}else return t=va(n),t!==null&&Tf(t),e.blockedOn=n,!1;t.shift()}return!0}function h1(e,t,n){al(e)&&n.delete(t)}function v4(){xd=!1,vs!==null&&al(vs)&&(vs=null),ws!==null&&al(ws)&&(ws=null),xs!==null&&al(xs)&&(xs=null),Jo.forEach(h1),Zo.forEach(h1)}function xo(e,t){e.blockedOn===t&&(e.blockedOn=null,xd||(xd=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,v4)))}function qo(e){function t(s){return xo(s,e)}if(0<Ua.length){xo(Ua[0],e);for(var n=1;n<Ua.length;n++){var r=Ua[n];r.blockedOn===e&&(r.blockedOn=null)}}for(vs!==null&&xo(vs,e),ws!==null&&xo(ws,e),xs!==null&&xo(xs,e),Jo.forEach(t),Zo.forEach(t),n=0;n<fs.length;n++)r=fs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<fs.length&&(n=fs[0],n.blockedOn===null);)x2(n),n.blockedOn===null&&fs.shift()}var ji=is.ReactCurrentBatchConfig,Nl=!0;function w4(e,t,n,r){var s=it,i=ji.transition;ji.transition=null;try{it=1,Mf(e,t,n,r)}finally{it=s,ji.transition=i}}function x4(e,t,n,r){var s=it,i=ji.transition;ji.transition=null;try{it=4,Mf(e,t,n,r)}finally{it=s,ji.transition=i}}function Mf(e,t,n,r){if(Nl){var s=Sd(e,t,n,r);if(s===null)Cc(e,t,r,Tl,n),f1(e,r);else if(y4(s,e,t,n,r))r.stopPropagation();else if(f1(e,r),t&4&&-1<g4.indexOf(e)){for(;s!==null;){var i=va(s);if(i!==null&&g2(i),i=Sd(e,t,n,r),i===null&&Cc(e,t,r,Tl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Cc(e,t,r,null,n)}}var Tl=null;function Sd(e,t,n,r){if(Tl=null,e=Cf(r),e=Us(e),e!==null)if(t=si(e),t===null)e=null;else if(n=t.tag,n===13){if(e=l2(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Tl=e,null}function S2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(a4()){case jf:return 1;case f2:return 4;case Cl:case l4:return 16;case h2:return 536870912;default:return 16}default:return 16}}var gs=null,Pf=null,ll=null;function k2(){if(ll)return ll;var e,t=Pf,n=t.length,r,s="value"in gs?gs.value:gs.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return ll=s.slice(e,1<r?1-r:void 0)}function ul(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ha(){return!0}function p1(){return!1}function zn(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ha:p1,this.isPropagationStopped=p1,this}return Nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),t}var eo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bf=zn(eo),ya=Nt({},eo,{view:0,detail:0}),S4=zn(ya),yc,vc,So,lu=Nt({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:If,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==So&&(So&&e.type==="mousemove"?(yc=e.screenX-So.screenX,vc=e.screenY-So.screenY):vc=yc=0,So=e),yc)},movementY:function(e){return"movementY"in e?e.movementY:vc}}),m1=zn(lu),k4=Nt({},lu,{dataTransfer:0}),E4=zn(k4),A4=Nt({},ya,{relatedTarget:0}),wc=zn(A4),_4=Nt({},eo,{animationName:0,elapsedTime:0,pseudoElement:0}),C4=zn(_4),j4=Nt({},eo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),N4=zn(j4),T4=Nt({},eo,{data:0}),g1=zn(T4),M4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},b4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=b4[e])?!!t[e]:!1}function If(){return I4}var R4=Nt({},ya,{key:function(e){if(e.key){var t=M4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ul(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?P4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:If,charCode:function(e){return e.type==="keypress"?ul(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ul(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),L4=zn(R4),B4=Nt({},lu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y1=zn(B4),F4=Nt({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:If}),O4=zn(F4),$4=Nt({},eo,{propertyName:0,elapsedTime:0,pseudoElement:0}),D4=zn($4),z4=Nt({},lu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),U4=zn(z4),H4=[9,13,27,32],Rf=qr&&"CompositionEvent"in window,Fo=null;qr&&"documentMode"in document&&(Fo=document.documentMode);var G4=qr&&"TextEvent"in window&&!Fo,E2=qr&&(!Rf||Fo&&8<Fo&&11>=Fo),v1=" ",w1=!1;function A2(e,t){switch(e){case"keyup":return H4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hi=!1;function W4(e,t){switch(e){case"compositionend":return _2(t);case"keypress":return t.which!==32?null:(w1=!0,v1);case"textInput":return e=t.data,e===v1&&w1?null:e;default:return null}}function V4(e,t){if(hi)return e==="compositionend"||!Rf&&A2(e,t)?(e=k2(),ll=Pf=gs=null,hi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return E2&&t.locale!=="ko"?null:t.data;default:return null}}var Y4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Y4[e.type]:t==="textarea"}function C2(e,t,n,r){r2(r),t=Ml(t,"onChange"),0<t.length&&(n=new bf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Oo=null,ea=null;function K4(e){F2(e,0)}function uu(e){var t=gi(e);if(Q0(t))return e}function X4(e,t){if(e==="change")return t}var j2=!1;if(qr){var xc;if(qr){var Sc="oninput"in document;if(!Sc){var S1=document.createElement("div");S1.setAttribute("oninput","return;"),Sc=typeof S1.oninput=="function"}xc=Sc}else xc=!1;j2=xc&&(!document.documentMode||9<document.documentMode)}function k1(){Oo&&(Oo.detachEvent("onpropertychange",N2),ea=Oo=null)}function N2(e){if(e.propertyName==="value"&&uu(ea)){var t=[];C2(t,ea,e,Cf(e)),a2(K4,t)}}function Q4(e,t,n){e==="focusin"?(k1(),Oo=t,ea=n,Oo.attachEvent("onpropertychange",N2)):e==="focusout"&&k1()}function J4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return uu(ea)}function Z4(e,t){if(e==="click")return uu(t)}function q4(e,t){if(e==="input"||e==="change")return uu(t)}function ew(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var wr=typeof Object.is=="function"?Object.is:ew;function ta(e,t){if(wr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!rd.call(t,s)||!wr(e[s],t[s]))return!1}return!0}function E1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function A1(e,t){var n=E1(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=E1(n)}}function T2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?T2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function M2(){for(var e=window,t=El();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=El(e.document)}return t}function Lf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tw(e){var t=M2(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&T2(n.ownerDocument.documentElement,n)){if(r!==null&&Lf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=A1(n,i);var a=A1(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nw=qr&&"documentMode"in document&&11>=document.documentMode,pi=null,kd=null,$o=null,Ed=!1;function _1(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ed||pi==null||pi!==El(r)||(r=pi,"selectionStart"in r&&Lf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$o&&ta($o,r)||($o=r,r=Ml(kd,"onSelect"),0<r.length&&(t=new bf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=pi)))}function Ga(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var mi={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionend:Ga("Transition","TransitionEnd")},kc={},P2={};qr&&(P2=document.createElement("div").style,"AnimationEvent"in window||(delete mi.animationend.animation,delete mi.animationiteration.animation,delete mi.animationstart.animation),"TransitionEvent"in window||delete mi.transitionend.transition);function cu(e){if(kc[e])return kc[e];if(!mi[e])return e;var t=mi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in P2)return kc[e]=t[n];return e}var b2=cu("animationend"),I2=cu("animationiteration"),R2=cu("animationstart"),L2=cu("transitionend"),B2=new Map,C1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bs(e,t){B2.set(e,t),ri(t,[e])}for(var Ec=0;Ec<C1.length;Ec++){var Ac=C1[Ec],rw=Ac.toLowerCase(),sw=Ac[0].toUpperCase()+Ac.slice(1);bs(rw,"on"+sw)}bs(b2,"onAnimationEnd");bs(I2,"onAnimationIteration");bs(R2,"onAnimationStart");bs("dblclick","onDoubleClick");bs("focusin","onFocus");bs("focusout","onBlur");bs(L2,"onTransitionEnd");Bi("onMouseEnter",["mouseout","mouseover"]);Bi("onMouseLeave",["mouseout","mouseover"]);Bi("onPointerEnter",["pointerout","pointerover"]);Bi("onPointerLeave",["pointerout","pointerover"]);ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ri("onBeforeInput",["compositionend","keypress","textInput","paste"]);ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iw=new Set("cancel close invalid load scroll toggle".split(" ").concat(bo));function j1(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,r4(r,t,void 0,e),e.currentTarget=null}function F2(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var l=r[a],d=l.instance,h=l.currentTarget;if(l=l.listener,d!==i&&s.isPropagationStopped())break e;j1(s,l,h),i=d}else for(a=0;a<r.length;a++){if(l=r[a],d=l.instance,h=l.currentTarget,l=l.listener,d!==i&&s.isPropagationStopped())break e;j1(s,l,h),i=d}}}if(_l)throw e=vd,_l=!1,vd=null,e}function mt(e,t){var n=t[Nd];n===void 0&&(n=t[Nd]=new Set);var r=e+"__bubble";n.has(r)||(O2(t,e,2,!1),n.add(r))}function _c(e,t,n){var r=0;t&&(r|=4),O2(n,e,r,t)}var Wa="_reactListening"+Math.random().toString(36).slice(2);function na(e){if(!e[Wa]){e[Wa]=!0,W0.forEach(function(n){n!=="selectionchange"&&(iw.has(n)||_c(n,!1,e),_c(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Wa]||(t[Wa]=!0,_c("selectionchange",!1,t))}}function O2(e,t,n,r){switch(S2(t)){case 1:var s=w4;break;case 4:s=x4;break;default:s=Mf}n=s.bind(null,t,n,e),s=void 0,!yd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Cc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Us(l),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}l=l.parentNode}}r=r.return}a2(function(){var h=i,m=Cf(n),w=[];e:{var S=B2.get(e);if(S!==void 0){var N=bf,R=e;switch(e){case"keypress":if(ul(n)===0)break e;case"keydown":case"keyup":N=L4;break;case"focusin":R="focus",N=wc;break;case"focusout":R="blur",N=wc;break;case"beforeblur":case"afterblur":N=wc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=m1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=E4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=O4;break;case b2:case I2:case R2:N=C4;break;case L2:N=D4;break;case"scroll":N=S4;break;case"wheel":N=U4;break;case"copy":case"cut":case"paste":N=N4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=y1}var F=(t&4)!==0,K=!F&&e==="scroll",A=F?S!==null?S+"Capture":null:S;F=[];for(var g=h,k;g!==null;){k=g;var T=k.stateNode;if(k.tag===5&&T!==null&&(k=T,A!==null&&(T=Qo(g,A),T!=null&&F.push(ra(g,T,k)))),K)break;g=g.return}0<F.length&&(S=new N(S,R,null,n,m),w.push({event:S,listeners:F}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",S&&n!==md&&(R=n.relatedTarget||n.fromElement)&&(Us(R)||R[es]))break e;if((N||S)&&(S=m.window===m?m:(S=m.ownerDocument)?S.defaultView||S.parentWindow:window,N?(R=n.relatedTarget||n.toElement,N=h,R=R?Us(R):null,R!==null&&(K=si(R),R!==K||R.tag!==5&&R.tag!==6)&&(R=null)):(N=null,R=h),N!==R)){if(F=m1,T="onMouseLeave",A="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(F=y1,T="onPointerLeave",A="onPointerEnter",g="pointer"),K=N==null?S:gi(N),k=R==null?S:gi(R),S=new F(T,g+"leave",N,n,m),S.target=K,S.relatedTarget=k,T=null,Us(m)===h&&(F=new F(A,g+"enter",R,n,m),F.target=k,F.relatedTarget=K,T=F),K=T,N&&R)t:{for(F=N,A=R,g=0,k=F;k;k=li(k))g++;for(k=0,T=A;T;T=li(T))k++;for(;0<g-k;)F=li(F),g--;for(;0<k-g;)A=li(A),k--;for(;g--;){if(F===A||A!==null&&F===A.alternate)break t;F=li(F),A=li(A)}F=null}else F=null;N!==null&&N1(w,S,N,F,!1),R!==null&&K!==null&&N1(w,K,R,F,!0)}}e:{if(S=h?gi(h):window,N=S.nodeName&&S.nodeName.toLowerCase(),N==="select"||N==="input"&&S.type==="file")var b=X4;else if(x1(S))if(j2)b=q4;else{b=J4;var B=Q4}else(N=S.nodeName)&&N.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(b=Z4);if(b&&(b=b(e,h))){C2(w,b,n,m);break e}B&&B(e,S,h),e==="focusout"&&(B=S._wrapperState)&&B.controlled&&S.type==="number"&&cd(S,"number",S.value)}switch(B=h?gi(h):window,e){case"focusin":(x1(B)||B.contentEditable==="true")&&(pi=B,kd=h,$o=null);break;case"focusout":$o=kd=pi=null;break;case"mousedown":Ed=!0;break;case"contextmenu":case"mouseup":case"dragend":Ed=!1,_1(w,n,m);break;case"selectionchange":if(nw)break;case"keydown":case"keyup":_1(w,n,m)}var D;if(Rf)e:{switch(e){case"compositionstart":var G="onCompositionStart";break e;case"compositionend":G="onCompositionEnd";break e;case"compositionupdate":G="onCompositionUpdate";break e}G=void 0}else hi?A2(e,n)&&(G="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(G="onCompositionStart");G&&(E2&&n.locale!=="ko"&&(hi||G!=="onCompositionStart"?G==="onCompositionEnd"&&hi&&(D=k2()):(gs=m,Pf="value"in gs?gs.value:gs.textContent,hi=!0)),B=Ml(h,G),0<B.length&&(G=new g1(G,e,null,n,m),w.push({event:G,listeners:B}),D?G.data=D:(D=_2(n),D!==null&&(G.data=D)))),(D=G4?W4(e,n):V4(e,n))&&(h=Ml(h,"onBeforeInput"),0<h.length&&(m=new g1("onBeforeInput","beforeinput",null,n,m),w.push({event:m,listeners:h}),m.data=D))}F2(w,t)})}function ra(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ml(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Qo(e,n),i!=null&&r.unshift(ra(e,i,s)),i=Qo(e,t),i!=null&&r.push(ra(e,i,s))),e=e.return}return r}function li(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function N1(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var l=n,d=l.alternate,h=l.stateNode;if(d!==null&&d===r)break;l.tag===5&&h!==null&&(l=h,s?(d=Qo(n,i),d!=null&&a.unshift(ra(n,d,l))):s||(d=Qo(n,i),d!=null&&a.push(ra(n,d,l)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var ow=/\r\n?/g,aw=/\u0000|\uFFFD/g;function T1(e){return(typeof e=="string"?e:""+e).replace(ow,`
`).replace(aw,"")}function Va(e,t,n){if(t=T1(t),T1(e)!==t&&n)throw Error(ie(425))}function Pl(){}var Ad=null,_d=null;function Cd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jd=typeof setTimeout=="function"?setTimeout:void 0,lw=typeof clearTimeout=="function"?clearTimeout:void 0,M1=typeof Promise=="function"?Promise:void 0,uw=typeof queueMicrotask=="function"?queueMicrotask:typeof M1<"u"?function(e){return M1.resolve(null).then(e).catch(cw)}:jd;function cw(e){setTimeout(function(){throw e})}function jc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),qo(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);qo(t)}function Ss(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function P1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var to=Math.random().toString(36).slice(2),Fr="__reactFiber$"+to,sa="__reactProps$"+to,es="__reactContainer$"+to,Nd="__reactEvents$"+to,dw="__reactListeners$"+to,fw="__reactHandles$"+to;function Us(e){var t=e[Fr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[es]||n[Fr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=P1(e);e!==null;){if(n=e[Fr])return n;e=P1(e)}return t}e=n,n=e.parentNode}return null}function va(e){return e=e[Fr]||e[es],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ie(33))}function du(e){return e[sa]||null}var Td=[],yi=-1;function Is(e){return{current:e}}function gt(e){0>yi||(e.current=Td[yi],Td[yi]=null,yi--)}function ft(e,t){yi++,Td[yi]=e.current,e.current=t}var Ts={},ln=Is(Ts),An=Is(!1),Qs=Ts;function Fi(e,t){var n=e.type.contextTypes;if(!n)return Ts;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function _n(e){return e=e.childContextTypes,e!=null}function bl(){gt(An),gt(ln)}function b1(e,t,n){if(ln.current!==Ts)throw Error(ie(168));ft(ln,t),ft(An,n)}function $2(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(ie(108,Qv(e)||"Unknown",s));return Nt({},n,r)}function Il(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ts,Qs=ln.current,ft(ln,e),ft(An,An.current),!0}function I1(e,t,n){var r=e.stateNode;if(!r)throw Error(ie(169));n?(e=$2(e,t,Qs),r.__reactInternalMemoizedMergedChildContext=e,gt(An),gt(ln),ft(ln,e)):gt(An),ft(An,n)}var Hr=null,fu=!1,Nc=!1;function D2(e){Hr===null?Hr=[e]:Hr.push(e)}function hw(e){fu=!0,D2(e)}function Rs(){if(!Nc&&Hr!==null){Nc=!0;var e=0,t=it;try{var n=Hr;for(it=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Hr=null,fu=!1}catch(s){throw Hr!==null&&(Hr=Hr.slice(e+1)),d2(jf,Rs),s}finally{it=t,Nc=!1}}return null}var vi=[],wi=0,Rl=null,Ll=0,Xn=[],Qn=0,Js=null,Vr=1,Yr="";function $s(e,t){vi[wi++]=Ll,vi[wi++]=Rl,Rl=e,Ll=t}function z2(e,t,n){Xn[Qn++]=Vr,Xn[Qn++]=Yr,Xn[Qn++]=Js,Js=e;var r=Vr;e=Yr;var s=32-yr(r)-1;r&=~(1<<s),n+=1;var i=32-yr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Vr=1<<32-yr(t)+s|n<<s|r,Yr=i+e}else Vr=1<<i|n<<s|r,Yr=e}function Bf(e){e.return!==null&&($s(e,1),z2(e,1,0))}function Ff(e){for(;e===Rl;)Rl=vi[--wi],vi[wi]=null,Ll=vi[--wi],vi[wi]=null;for(;e===Js;)Js=Xn[--Qn],Xn[Qn]=null,Yr=Xn[--Qn],Xn[Qn]=null,Vr=Xn[--Qn],Xn[Qn]=null}var Fn=null,Bn=null,xt=!1,mr=null;function U2(e,t){var n=Zn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function R1(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Fn=e,Bn=Ss(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Fn=e,Bn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Js!==null?{id:Vr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Zn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Fn=e,Bn=null,!0):!1;default:return!1}}function Md(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Pd(e){if(xt){var t=Bn;if(t){var n=t;if(!R1(e,t)){if(Md(e))throw Error(ie(418));t=Ss(n.nextSibling);var r=Fn;t&&R1(e,t)?U2(r,n):(e.flags=e.flags&-4097|2,xt=!1,Fn=e)}}else{if(Md(e))throw Error(ie(418));e.flags=e.flags&-4097|2,xt=!1,Fn=e}}}function L1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Fn=e}function Ya(e){if(e!==Fn)return!1;if(!xt)return L1(e),xt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cd(e.type,e.memoizedProps)),t&&(t=Bn)){if(Md(e))throw H2(),Error(ie(418));for(;t;)U2(e,t),t=Ss(t.nextSibling)}if(L1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Bn=Ss(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Bn=null}}else Bn=Fn?Ss(e.stateNode.nextSibling):null;return!0}function H2(){for(var e=Bn;e;)e=Ss(e.nextSibling)}function Oi(){Bn=Fn=null,xt=!1}function Of(e){mr===null?mr=[e]:mr.push(e)}var pw=is.ReactCurrentBatchConfig;function ko(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,e))}return e}function Ka(e,t){throw e=Object.prototype.toString.call(t),Error(ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function B1(e){var t=e._init;return t(e._payload)}function G2(e){function t(A,g){if(e){var k=A.deletions;k===null?(A.deletions=[g],A.flags|=16):k.push(g)}}function n(A,g){if(!e)return null;for(;g!==null;)t(A,g),g=g.sibling;return null}function r(A,g){for(A=new Map;g!==null;)g.key!==null?A.set(g.key,g):A.set(g.index,g),g=g.sibling;return A}function s(A,g){return A=_s(A,g),A.index=0,A.sibling=null,A}function i(A,g,k){return A.index=k,e?(k=A.alternate,k!==null?(k=k.index,k<g?(A.flags|=2,g):k):(A.flags|=2,g)):(A.flags|=1048576,g)}function a(A){return e&&A.alternate===null&&(A.flags|=2),A}function l(A,g,k,T){return g===null||g.tag!==6?(g=Lc(k,A.mode,T),g.return=A,g):(g=s(g,k),g.return=A,g)}function d(A,g,k,T){var b=k.type;return b===fi?m(A,g,k.props.children,T,k.key):g!==null&&(g.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===cs&&B1(b)===g.type)?(T=s(g,k.props),T.ref=ko(A,g,k),T.return=A,T):(T=gl(k.type,k.key,k.props,null,A.mode,T),T.ref=ko(A,g,k),T.return=A,T)}function h(A,g,k,T){return g===null||g.tag!==4||g.stateNode.containerInfo!==k.containerInfo||g.stateNode.implementation!==k.implementation?(g=Bc(k,A.mode,T),g.return=A,g):(g=s(g,k.children||[]),g.return=A,g)}function m(A,g,k,T,b){return g===null||g.tag!==7?(g=Ks(k,A.mode,T,b),g.return=A,g):(g=s(g,k),g.return=A,g)}function w(A,g,k){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Lc(""+g,A.mode,k),g.return=A,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Fa:return k=gl(g.type,g.key,g.props,null,A.mode,k),k.ref=ko(A,null,g),k.return=A,k;case di:return g=Bc(g,A.mode,k),g.return=A,g;case cs:var T=g._init;return w(A,T(g._payload),k)}if(Mo(g)||yo(g))return g=Ks(g,A.mode,k,null),g.return=A,g;Ka(A,g)}return null}function S(A,g,k,T){var b=g!==null?g.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return b!==null?null:l(A,g,""+k,T);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Fa:return k.key===b?d(A,g,k,T):null;case di:return k.key===b?h(A,g,k,T):null;case cs:return b=k._init,S(A,g,b(k._payload),T)}if(Mo(k)||yo(k))return b!==null?null:m(A,g,k,T,null);Ka(A,k)}return null}function N(A,g,k,T,b){if(typeof T=="string"&&T!==""||typeof T=="number")return A=A.get(k)||null,l(g,A,""+T,b);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Fa:return A=A.get(T.key===null?k:T.key)||null,d(g,A,T,b);case di:return A=A.get(T.key===null?k:T.key)||null,h(g,A,T,b);case cs:var B=T._init;return N(A,g,k,B(T._payload),b)}if(Mo(T)||yo(T))return A=A.get(k)||null,m(g,A,T,b,null);Ka(g,T)}return null}function R(A,g,k,T){for(var b=null,B=null,D=g,G=g=0,le=null;D!==null&&G<k.length;G++){D.index>G?(le=D,D=null):le=D.sibling;var V=S(A,D,k[G],T);if(V===null){D===null&&(D=le);break}e&&D&&V.alternate===null&&t(A,D),g=i(V,g,G),B===null?b=V:B.sibling=V,B=V,D=le}if(G===k.length)return n(A,D),xt&&$s(A,G),b;if(D===null){for(;G<k.length;G++)D=w(A,k[G],T),D!==null&&(g=i(D,g,G),B===null?b=D:B.sibling=D,B=D);return xt&&$s(A,G),b}for(D=r(A,D);G<k.length;G++)le=N(D,A,G,k[G],T),le!==null&&(e&&le.alternate!==null&&D.delete(le.key===null?G:le.key),g=i(le,g,G),B===null?b=le:B.sibling=le,B=le);return e&&D.forEach(function(Y){return t(A,Y)}),xt&&$s(A,G),b}function F(A,g,k,T){var b=yo(k);if(typeof b!="function")throw Error(ie(150));if(k=b.call(k),k==null)throw Error(ie(151));for(var B=b=null,D=g,G=g=0,le=null,V=k.next();D!==null&&!V.done;G++,V=k.next()){D.index>G?(le=D,D=null):le=D.sibling;var Y=S(A,D,V.value,T);if(Y===null){D===null&&(D=le);break}e&&D&&Y.alternate===null&&t(A,D),g=i(Y,g,G),B===null?b=Y:B.sibling=Y,B=Y,D=le}if(V.done)return n(A,D),xt&&$s(A,G),b;if(D===null){for(;!V.done;G++,V=k.next())V=w(A,V.value,T),V!==null&&(g=i(V,g,G),B===null?b=V:B.sibling=V,B=V);return xt&&$s(A,G),b}for(D=r(A,D);!V.done;G++,V=k.next())V=N(D,A,G,V.value,T),V!==null&&(e&&V.alternate!==null&&D.delete(V.key===null?G:V.key),g=i(V,g,G),B===null?b=V:B.sibling=V,B=V);return e&&D.forEach(function(te){return t(A,te)}),xt&&$s(A,G),b}function K(A,g,k,T){if(typeof k=="object"&&k!==null&&k.type===fi&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case Fa:e:{for(var b=k.key,B=g;B!==null;){if(B.key===b){if(b=k.type,b===fi){if(B.tag===7){n(A,B.sibling),g=s(B,k.props.children),g.return=A,A=g;break e}}else if(B.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===cs&&B1(b)===B.type){n(A,B.sibling),g=s(B,k.props),g.ref=ko(A,B,k),g.return=A,A=g;break e}n(A,B);break}else t(A,B);B=B.sibling}k.type===fi?(g=Ks(k.props.children,A.mode,T,k.key),g.return=A,A=g):(T=gl(k.type,k.key,k.props,null,A.mode,T),T.ref=ko(A,g,k),T.return=A,A=T)}return a(A);case di:e:{for(B=k.key;g!==null;){if(g.key===B)if(g.tag===4&&g.stateNode.containerInfo===k.containerInfo&&g.stateNode.implementation===k.implementation){n(A,g.sibling),g=s(g,k.children||[]),g.return=A,A=g;break e}else{n(A,g);break}else t(A,g);g=g.sibling}g=Bc(k,A.mode,T),g.return=A,A=g}return a(A);case cs:return B=k._init,K(A,g,B(k._payload),T)}if(Mo(k))return R(A,g,k,T);if(yo(k))return F(A,g,k,T);Ka(A,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,g!==null&&g.tag===6?(n(A,g.sibling),g=s(g,k),g.return=A,A=g):(n(A,g),g=Lc(k,A.mode,T),g.return=A,A=g),a(A)):n(A,g)}return K}var $i=G2(!0),W2=G2(!1),Bl=Is(null),Fl=null,xi=null,$f=null;function Df(){$f=xi=Fl=null}function zf(e){var t=Bl.current;gt(Bl),e._currentValue=t}function bd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ni(e,t){Fl=e,$f=xi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(En=!0),e.firstContext=null)}function tr(e){var t=e._currentValue;if($f!==e)if(e={context:e,memoizedValue:t,next:null},xi===null){if(Fl===null)throw Error(ie(308));xi=e,Fl.dependencies={lanes:0,firstContext:e}}else xi=xi.next=e;return t}var Hs=null;function Uf(e){Hs===null?Hs=[e]:Hs.push(e)}function V2(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Uf(t)):(n.next=s.next,s.next=n),t.interleaved=n,ts(e,r)}function ts(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ds=!1;function Hf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Xr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ks(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Qe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,ts(e,n)}return s=r.interleaved,s===null?(t.next=t,Uf(r)):(t.next=s.next,s.next=t),r.interleaved=t,ts(e,n)}function cl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nf(e,n)}}function F1(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ol(e,t,n,r){var s=e.updateQueue;ds=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var d=l,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var m=e.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==a&&(l===null?m.firstBaseUpdate=h:l.next=h,m.lastBaseUpdate=d))}if(i!==null){var w=s.baseState;a=0,m=h=d=null,l=i;do{var S=l.lane,N=l.eventTime;if((r&S)===S){m!==null&&(m=m.next={eventTime:N,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=e,F=l;switch(S=t,N=n,F.tag){case 1:if(R=F.payload,typeof R=="function"){w=R.call(N,w,S);break e}w=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=F.payload,S=typeof R=="function"?R.call(N,w,S):R,S==null)break e;w=Nt({},w,S);break e;case 2:ds=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,S=s.effects,S===null?s.effects=[l]:S.push(l))}else N={eventTime:N,lane:S,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(h=m=N,d=w):m=m.next=N,a|=S;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;S=l,l=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(!0);if(m===null&&(d=w),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);qs|=a,e.lanes=a,e.memoizedState=w}}function O1(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ie(191,s));s.call(r)}}}var wa={},$r=Is(wa),ia=Is(wa),oa=Is(wa);function Gs(e){if(e===wa)throw Error(ie(174));return e}function Gf(e,t){switch(ft(oa,t),ft(ia,e),ft($r,wa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=fd(t,e)}gt($r),ft($r,t)}function Di(){gt($r),gt(ia),gt(oa)}function K2(e){Gs(oa.current);var t=Gs($r.current),n=fd(t,e.type);t!==n&&(ft(ia,e),ft($r,n))}function Wf(e){ia.current===e&&(gt($r),gt(ia))}var _t=Is(0);function $l(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Tc=[];function Vf(){for(var e=0;e<Tc.length;e++)Tc[e]._workInProgressVersionPrimary=null;Tc.length=0}var dl=is.ReactCurrentDispatcher,Mc=is.ReactCurrentBatchConfig,Zs=0,Ct=null,Ut=null,Kt=null,Dl=!1,Do=!1,aa=0,mw=0;function rn(){throw Error(ie(321))}function Yf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!wr(e[n],t[n]))return!1;return!0}function Kf(e,t,n,r,s,i){if(Zs=i,Ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,dl.current=e===null||e.memoizedState===null?ww:xw,e=n(r,s),Do){i=0;do{if(Do=!1,aa=0,25<=i)throw Error(ie(301));i+=1,Kt=Ut=null,t.updateQueue=null,dl.current=Sw,e=n(r,s)}while(Do)}if(dl.current=zl,t=Ut!==null&&Ut.next!==null,Zs=0,Kt=Ut=Ct=null,Dl=!1,t)throw Error(ie(300));return e}function Xf(){var e=aa!==0;return aa=0,e}function Lr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?Ct.memoizedState=Kt=e:Kt=Kt.next=e,Kt}function nr(){if(Ut===null){var e=Ct.alternate;e=e!==null?e.memoizedState:null}else e=Ut.next;var t=Kt===null?Ct.memoizedState:Kt.next;if(t!==null)Kt=t,Ut=e;else{if(e===null)throw Error(ie(310));Ut=e,e={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},Kt===null?Ct.memoizedState=Kt=e:Kt=Kt.next=e}return Kt}function la(e,t){return typeof t=="function"?t(e):t}function Pc(e){var t=nr(),n=t.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=e;var r=Ut,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,d=null,h=i;do{var m=h.lane;if((Zs&m)===m)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var w={lane:m,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(l=d=w,a=r):d=d.next=w,Ct.lanes|=m,qs|=m}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=l,wr(r,t.memoizedState)||(En=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Ct.lanes|=i,qs|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function bc(e){var t=nr(),n=t.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);wr(i,t.memoizedState)||(En=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function X2(){}function Q2(e,t){var n=Ct,r=nr(),s=t(),i=!wr(r.memoizedState,s);if(i&&(r.memoizedState=s,En=!0),r=r.queue,Qf(q2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Kt!==null&&Kt.memoizedState.tag&1){if(n.flags|=2048,ua(9,Z2.bind(null,n,r,s,t),void 0,null),Xt===null)throw Error(ie(349));Zs&30||J2(n,t,s)}return s}function J2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ct.updateQueue,t===null?(t={lastEffect:null,stores:null},Ct.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Z2(e,t,n,r){t.value=n,t.getSnapshot=r,eg(t)&&tg(e)}function q2(e,t,n){return n(function(){eg(t)&&tg(e)})}function eg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!wr(e,n)}catch{return!0}}function tg(e){var t=ts(e,1);t!==null&&vr(t,e,1,-1)}function $1(e){var t=Lr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:la,lastRenderedState:e},t.queue=e,e=e.dispatch=vw.bind(null,Ct,e),[t.memoizedState,e]}function ua(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ct.updateQueue,t===null?(t={lastEffect:null,stores:null},Ct.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ng(){return nr().memoizedState}function fl(e,t,n,r){var s=Lr();Ct.flags|=e,s.memoizedState=ua(1|t,n,void 0,r===void 0?null:r)}function hu(e,t,n,r){var s=nr();r=r===void 0?null:r;var i=void 0;if(Ut!==null){var a=Ut.memoizedState;if(i=a.destroy,r!==null&&Yf(r,a.deps)){s.memoizedState=ua(t,n,i,r);return}}Ct.flags|=e,s.memoizedState=ua(1|t,n,i,r)}function D1(e,t){return fl(8390656,8,e,t)}function Qf(e,t){return hu(2048,8,e,t)}function rg(e,t){return hu(4,2,e,t)}function sg(e,t){return hu(4,4,e,t)}function ig(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function og(e,t,n){return n=n!=null?n.concat([e]):null,hu(4,4,ig.bind(null,t,e),n)}function Jf(){}function ag(e,t){var n=nr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Yf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function lg(e,t){var n=nr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Yf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ug(e,t,n){return Zs&21?(wr(n,t)||(n=p2(),Ct.lanes|=n,qs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,En=!0),e.memoizedState=n)}function gw(e,t){var n=it;it=n!==0&&4>n?n:4,e(!0);var r=Mc.transition;Mc.transition={};try{e(!1),t()}finally{it=n,Mc.transition=r}}function cg(){return nr().memoizedState}function yw(e,t,n){var r=As(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},dg(e))fg(t,n);else if(n=V2(e,t,n,r),n!==null){var s=fn();vr(n,e,r,s),hg(n,t,r)}}function vw(e,t,n){var r=As(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(dg(e))fg(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,wr(l,a)){var d=t.interleaved;d===null?(s.next=s,Uf(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=V2(e,t,s,r),n!==null&&(s=fn(),vr(n,e,r,s),hg(n,t,r))}}function dg(e){var t=e.alternate;return e===Ct||t!==null&&t===Ct}function fg(e,t){Do=Dl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nf(e,n)}}var zl={readContext:tr,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},ww={readContext:tr,useCallback:function(e,t){return Lr().memoizedState=[e,t===void 0?null:t],e},useContext:tr,useEffect:D1,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,fl(4194308,4,ig.bind(null,t,e),n)},useLayoutEffect:function(e,t){return fl(4194308,4,e,t)},useInsertionEffect:function(e,t){return fl(4,2,e,t)},useMemo:function(e,t){var n=Lr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Lr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=yw.bind(null,Ct,e),[r.memoizedState,e]},useRef:function(e){var t=Lr();return e={current:e},t.memoizedState=e},useState:$1,useDebugValue:Jf,useDeferredValue:function(e){return Lr().memoizedState=e},useTransition:function(){var e=$1(!1),t=e[0];return e=gw.bind(null,e[1]),Lr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ct,s=Lr();if(xt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=t(),Xt===null)throw Error(ie(349));Zs&30||J2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,D1(q2.bind(null,r,i,e),[e]),r.flags|=2048,ua(9,Z2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Lr(),t=Xt.identifierPrefix;if(xt){var n=Yr,r=Vr;n=(r&~(1<<32-yr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=aa++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=mw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},xw={readContext:tr,useCallback:ag,useContext:tr,useEffect:Qf,useImperativeHandle:og,useInsertionEffect:rg,useLayoutEffect:sg,useMemo:lg,useReducer:Pc,useRef:ng,useState:function(){return Pc(la)},useDebugValue:Jf,useDeferredValue:function(e){var t=nr();return ug(t,Ut.memoizedState,e)},useTransition:function(){var e=Pc(la)[0],t=nr().memoizedState;return[e,t]},useMutableSource:X2,useSyncExternalStore:Q2,useId:cg,unstable_isNewReconciler:!1},Sw={readContext:tr,useCallback:ag,useContext:tr,useEffect:Qf,useImperativeHandle:og,useInsertionEffect:rg,useLayoutEffect:sg,useMemo:lg,useReducer:bc,useRef:ng,useState:function(){return bc(la)},useDebugValue:Jf,useDeferredValue:function(e){var t=nr();return Ut===null?t.memoizedState=e:ug(t,Ut.memoizedState,e)},useTransition:function(){var e=bc(la)[0],t=nr().memoizedState;return[e,t]},useMutableSource:X2,useSyncExternalStore:Q2,useId:cg,unstable_isNewReconciler:!1};function hr(e,t){if(e&&e.defaultProps){t=Nt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Id(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Nt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var pu={isMounted:function(e){return(e=e._reactInternals)?si(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=fn(),s=As(e),i=Xr(r,s);i.payload=t,n!=null&&(i.callback=n),t=ks(e,i,s),t!==null&&(vr(t,e,s,r),cl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=fn(),s=As(e),i=Xr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=ks(e,i,s),t!==null&&(vr(t,e,s,r),cl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=fn(),r=As(e),s=Xr(n,r);s.tag=2,t!=null&&(s.callback=t),t=ks(e,s,r),t!==null&&(vr(t,e,r,n),cl(t,e,r))}};function z1(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!ta(n,r)||!ta(s,i):!0}function pg(e,t,n){var r=!1,s=Ts,i=t.contextType;return typeof i=="object"&&i!==null?i=tr(i):(s=_n(t)?Qs:ln.current,r=t.contextTypes,i=(r=r!=null)?Fi(e,s):Ts),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function U1(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pu.enqueueReplaceState(t,t.state,null)}function Rd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Hf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=tr(i):(i=_n(t)?Qs:ln.current,s.context=Fi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Id(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&pu.enqueueReplaceState(s,s.state,null),Ol(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function zi(e,t){try{var n="",r=t;do n+=Xv(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Ic(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ld(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var kw=typeof WeakMap=="function"?WeakMap:Map;function mg(e,t,n){n=Xr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Wd=r),Ld(e,t)},n}function gg(e,t,n){n=Xr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Ld(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ld(e,t),typeof r!="function"&&(Es===null?Es=new Set([this]):Es.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function H1(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new kw;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Bw.bind(null,e,t,n),t.then(e,e))}function G1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function W1(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Xr(-1,1),t.tag=2,ks(n,t,1))),n.lanes|=1),e)}var Ew=is.ReactCurrentOwner,En=!1;function dn(e,t,n,r){t.child=e===null?W2(t,null,n,r):$i(t,e.child,n,r)}function V1(e,t,n,r,s){n=n.render;var i=t.ref;return Ni(t,s),r=Kf(e,t,n,r,i,s),n=Xf(),e!==null&&!En?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ns(e,t,s)):(xt&&n&&Bf(t),t.flags|=1,dn(e,t,r,s),t.child)}function Y1(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!ih(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,yg(e,t,i,r,s)):(e=gl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ta,n(a,r)&&e.ref===t.ref)return ns(e,t,s)}return t.flags|=1,e=_s(i,r),e.ref=t.ref,e.return=t,t.child=e}function yg(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(ta(i,r)&&e.ref===t.ref)if(En=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(En=!0);else return t.lanes=e.lanes,ns(e,t,s)}return Bd(e,t,n,r,s)}function vg(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ft(ki,Ln),Ln|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ft(ki,Ln),Ln|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ft(ki,Ln),Ln|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,ft(ki,Ln),Ln|=r;return dn(e,t,s,n),t.child}function wg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Bd(e,t,n,r,s){var i=_n(n)?Qs:ln.current;return i=Fi(t,i),Ni(t,s),n=Kf(e,t,n,r,i,s),r=Xf(),e!==null&&!En?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ns(e,t,s)):(xt&&r&&Bf(t),t.flags|=1,dn(e,t,n,s),t.child)}function K1(e,t,n,r,s){if(_n(n)){var i=!0;Il(t)}else i=!1;if(Ni(t,s),t.stateNode===null)hl(e,t),pg(t,n,r),Rd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=tr(h):(h=_n(n)?Qs:ln.current,h=Fi(t,h));var m=n.getDerivedStateFromProps,w=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";w||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||d!==h)&&U1(t,a,r,h),ds=!1;var S=t.memoizedState;a.state=S,Ol(t,r,a,s),d=t.memoizedState,l!==r||S!==d||An.current||ds?(typeof m=="function"&&(Id(t,n,m,r),d=t.memoizedState),(l=ds||z1(t,n,l,r,S,d,h))?(w||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Y2(e,t),l=t.memoizedProps,h=t.type===t.elementType?l:hr(t.type,l),a.props=h,w=t.pendingProps,S=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=tr(d):(d=_n(n)?Qs:ln.current,d=Fi(t,d));var N=n.getDerivedStateFromProps;(m=typeof N=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==w||S!==d)&&U1(t,a,r,d),ds=!1,S=t.memoizedState,a.state=S,Ol(t,r,a,s);var R=t.memoizedState;l!==w||S!==R||An.current||ds?(typeof N=="function"&&(Id(t,n,N,r),R=t.memoizedState),(h=ds||z1(t,n,h,r,S,R,d)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,R,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,R,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=R),a.props=r,a.state=R,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),r=!1)}return Fd(e,t,n,r,i,s)}function Fd(e,t,n,r,s,i){wg(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&I1(t,n,!1),ns(e,t,i);r=t.stateNode,Ew.current=t;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=$i(t,e.child,null,i),t.child=$i(t,null,l,i)):dn(e,t,l,i),t.memoizedState=r.state,s&&I1(t,n,!0),t.child}function xg(e){var t=e.stateNode;t.pendingContext?b1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&b1(e,t.context,!1),Gf(e,t.containerInfo)}function X1(e,t,n,r,s){return Oi(),Of(s),t.flags|=256,dn(e,t,n,r),t.child}var Od={dehydrated:null,treeContext:null,retryLane:0};function $d(e){return{baseLanes:e,cachePool:null,transitions:null}}function Sg(e,t,n){var r=t.pendingProps,s=_t.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ft(_t,s&1),e===null)return Pd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=yu(a,r,0,null),e=Ks(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=$d(n),t.memoizedState=Od,e):Zf(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Aw(e,t,a,r,l,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,l=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=_s(s,d),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=_s(l,i):(i=Ks(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?$d(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Od,r}return i=e.child,e=i.sibling,r=_s(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Zf(e,t){return t=yu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Xa(e,t,n,r){return r!==null&&Of(r),$i(t,e.child,null,n),e=Zf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Aw(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Ic(Error(ie(422))),Xa(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=yu({mode:"visible",children:r.children},s,0,null),i=Ks(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&$i(t,e.child,null,a),t.child.memoizedState=$d(a),t.memoizedState=Od,i);if(!(t.mode&1))return Xa(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(ie(419)),r=Ic(i,r,void 0),Xa(e,t,a,r)}if(l=(a&e.childLanes)!==0,En||l){if(r=Xt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ts(e,s),vr(r,e,s,-1))}return sh(),r=Ic(Error(ie(421))),Xa(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Fw.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Bn=Ss(s.nextSibling),Fn=t,xt=!0,mr=null,e!==null&&(Xn[Qn++]=Vr,Xn[Qn++]=Yr,Xn[Qn++]=Js,Vr=e.id,Yr=e.overflow,Js=t),t=Zf(t,r.children),t.flags|=4096,t)}function Q1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),bd(e.return,t,n)}function Rc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function kg(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(dn(e,t,r.children,n),r=_t.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Q1(e,n,t);else if(e.tag===19)Q1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ft(_t,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&$l(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Rc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&$l(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Rc(t,!0,n,null,i);break;case"together":Rc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ns(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),qs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ie(153));if(t.child!==null){for(e=t.child,n=_s(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=_s(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function _w(e,t,n){switch(t.tag){case 3:xg(t),Oi();break;case 5:K2(t);break;case 1:_n(t.type)&&Il(t);break;case 4:Gf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ft(Bl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ft(_t,_t.current&1),t.flags|=128,null):n&t.child.childLanes?Sg(e,t,n):(ft(_t,_t.current&1),e=ns(e,t,n),e!==null?e.sibling:null);ft(_t,_t.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return kg(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ft(_t,_t.current),r)break;return null;case 22:case 23:return t.lanes=0,vg(e,t,n)}return ns(e,t,n)}var Eg,Dd,Ag,_g;Eg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Dd=function(){};Ag=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Gs($r.current);var i=null;switch(n){case"input":s=ld(e,s),r=ld(e,r),i=[];break;case"select":s=Nt({},s,{value:void 0}),r=Nt({},r,{value:void 0}),i=[];break;case"textarea":s=dd(e,s),r=dd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Pl)}hd(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Ko.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==l&&(d!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&l[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,l=l?l.__html:void 0,d!=null&&l!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Ko.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&mt("scroll",e),i||l===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};_g=function(e,t,n,r){n!==r&&(t.flags|=4)};function Eo(e,t){if(!xt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function sn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Cw(e,t,n){var r=t.pendingProps;switch(Ff(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sn(t),null;case 1:return _n(t.type)&&bl(),sn(t),null;case 3:return r=t.stateNode,Di(),gt(An),gt(ln),Vf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ya(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,mr!==null&&(Kd(mr),mr=null))),Dd(e,t),sn(t),null;case 5:Wf(t);var s=Gs(oa.current);if(n=t.type,e!==null&&t.stateNode!=null)Ag(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ie(166));return sn(t),null}if(e=Gs($r.current),Ya(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Fr]=t,r[sa]=i,e=(t.mode&1)!==0,n){case"dialog":mt("cancel",r),mt("close",r);break;case"iframe":case"object":case"embed":mt("load",r);break;case"video":case"audio":for(s=0;s<bo.length;s++)mt(bo[s],r);break;case"source":mt("error",r);break;case"img":case"image":case"link":mt("error",r),mt("load",r);break;case"details":mt("toggle",r);break;case"input":i1(r,i),mt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},mt("invalid",r);break;case"textarea":a1(r,i),mt("invalid",r)}hd(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Va(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Va(r.textContent,l,e),s=["children",""+l]):Ko.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&mt("scroll",r)}switch(n){case"input":Oa(r),o1(r,i,!0);break;case"textarea":Oa(r),l1(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Pl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=q0(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Fr]=t,e[sa]=r,Eg(e,t,!1,!1),t.stateNode=e;e:{switch(a=pd(n,r),n){case"dialog":mt("cancel",e),mt("close",e),s=r;break;case"iframe":case"object":case"embed":mt("load",e),s=r;break;case"video":case"audio":for(s=0;s<bo.length;s++)mt(bo[s],e);s=r;break;case"source":mt("error",e),s=r;break;case"img":case"image":case"link":mt("error",e),mt("load",e),s=r;break;case"details":mt("toggle",e),s=r;break;case"input":i1(e,r),s=ld(e,r),mt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Nt({},r,{value:void 0}),mt("invalid",e);break;case"textarea":a1(e,r),s=dd(e,r),mt("invalid",e);break;default:s=r}hd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var d=l[i];i==="style"?n2(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&e2(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&Xo(e,d):typeof d=="number"&&Xo(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ko.hasOwnProperty(i)?d!=null&&i==="onScroll"&&mt("scroll",e):d!=null&&kf(e,i,d,a))}switch(n){case"input":Oa(e),o1(e,r,!1);break;case"textarea":Oa(e),l1(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ns(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ai(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ai(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Pl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return sn(t),null;case 6:if(e&&t.stateNode!=null)_g(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ie(166));if(n=Gs(oa.current),Gs($r.current),Ya(t)){if(r=t.stateNode,n=t.memoizedProps,r[Fr]=t,(i=r.nodeValue!==n)&&(e=Fn,e!==null))switch(e.tag){case 3:Va(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Va(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fr]=t,t.stateNode=r}return sn(t),null;case 13:if(gt(_t),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(xt&&Bn!==null&&t.mode&1&&!(t.flags&128))H2(),Oi(),t.flags|=98560,i=!1;else if(i=Ya(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ie(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ie(317));i[Fr]=t}else Oi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;sn(t),i=!1}else mr!==null&&(Kd(mr),mr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?Gt===0&&(Gt=3):sh())),t.updateQueue!==null&&(t.flags|=4),sn(t),null);case 4:return Di(),Dd(e,t),e===null&&na(t.stateNode.containerInfo),sn(t),null;case 10:return zf(t.type._context),sn(t),null;case 17:return _n(t.type)&&bl(),sn(t),null;case 19:if(gt(_t),i=t.memoizedState,i===null)return sn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Eo(i,!1);else{if(Gt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=$l(e),a!==null){for(t.flags|=128,Eo(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ft(_t,_t.current&1|2),t.child}e=e.sibling}i.tail!==null&&Bt()>Ui&&(t.flags|=128,r=!0,Eo(i,!1),t.lanes=4194304)}else{if(!r)if(e=$l(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Eo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!xt)return sn(t),null}else 2*Bt()-i.renderingStartTime>Ui&&n!==1073741824&&(t.flags|=128,r=!0,Eo(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Bt(),t.sibling=null,n=_t.current,ft(_t,r?n&1|2:n&1),t):(sn(t),null);case 22:case 23:return rh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ln&1073741824&&(sn(t),t.subtreeFlags&6&&(t.flags|=8192)):sn(t),null;case 24:return null;case 25:return null}throw Error(ie(156,t.tag))}function jw(e,t){switch(Ff(t),t.tag){case 1:return _n(t.type)&&bl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Di(),gt(An),gt(ln),Vf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Wf(t),null;case 13:if(gt(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ie(340));Oi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return gt(_t),null;case 4:return Di(),null;case 10:return zf(t.type._context),null;case 22:case 23:return rh(),null;case 24:return null;default:return null}}var Qa=!1,an=!1,Nw=typeof WeakSet=="function"?WeakSet:Set,Se=null;function Si(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){bt(e,t,r)}else n.current=null}function zd(e,t,n){try{n()}catch(r){bt(e,t,r)}}var J1=!1;function Tw(e,t){if(Ad=Nl,e=M2(),Lf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,d=-1,h=0,m=0,w=e,S=null;t:for(;;){for(var N;w!==n||s!==0&&w.nodeType!==3||(l=a+s),w!==i||r!==0&&w.nodeType!==3||(d=a+r),w.nodeType===3&&(a+=w.nodeValue.length),(N=w.firstChild)!==null;)S=w,w=N;for(;;){if(w===e)break t;if(S===n&&++h===s&&(l=a),S===i&&++m===r&&(d=a),(N=w.nextSibling)!==null)break;w=S,S=w.parentNode}w=N}n=l===-1||d===-1?null:{start:l,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(_d={focusedElem:e,selectionRange:n},Nl=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var R=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var F=R.memoizedProps,K=R.memoizedState,A=t.stateNode,g=A.getSnapshotBeforeUpdate(t.elementType===t.type?F:hr(t.type,F),K);A.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(T){bt(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return R=J1,J1=!1,R}function zo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&zd(t,n,i)}s=s.next}while(s!==r)}}function mu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ud(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Cg(e){var t=e.alternate;t!==null&&(e.alternate=null,Cg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fr],delete t[sa],delete t[Nd],delete t[dw],delete t[fw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jg(e){return e.tag===5||e.tag===3||e.tag===4}function Z1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Hd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pl));else if(r!==4&&(e=e.child,e!==null))for(Hd(e,t,n),e=e.sibling;e!==null;)Hd(e,t,n),e=e.sibling}function Gd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Gd(e,t,n),e=e.sibling;e!==null;)Gd(e,t,n),e=e.sibling}var qt=null,pr=!1;function ls(e,t,n){for(n=n.child;n!==null;)Ng(e,t,n),n=n.sibling}function Ng(e,t,n){if(Or&&typeof Or.onCommitFiberUnmount=="function")try{Or.onCommitFiberUnmount(au,n)}catch{}switch(n.tag){case 5:an||Si(n,t);case 6:var r=qt,s=pr;qt=null,ls(e,t,n),qt=r,pr=s,qt!==null&&(pr?(e=qt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):qt.removeChild(n.stateNode));break;case 18:qt!==null&&(pr?(e=qt,n=n.stateNode,e.nodeType===8?jc(e.parentNode,n):e.nodeType===1&&jc(e,n),qo(e)):jc(qt,n.stateNode));break;case 4:r=qt,s=pr,qt=n.stateNode.containerInfo,pr=!0,ls(e,t,n),qt=r,pr=s;break;case 0:case 11:case 14:case 15:if(!an&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&zd(n,t,a),s=s.next}while(s!==r)}ls(e,t,n);break;case 1:if(!an&&(Si(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){bt(n,t,l)}ls(e,t,n);break;case 21:ls(e,t,n);break;case 22:n.mode&1?(an=(r=an)||n.memoizedState!==null,ls(e,t,n),an=r):ls(e,t,n);break;default:ls(e,t,n)}}function q1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Nw),t.forEach(function(r){var s=Ow.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function fr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:qt=l.stateNode,pr=!1;break e;case 3:qt=l.stateNode.containerInfo,pr=!0;break e;case 4:qt=l.stateNode.containerInfo,pr=!0;break e}l=l.return}if(qt===null)throw Error(ie(160));Ng(i,a,s),qt=null,pr=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){bt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Tg(t,e),t=t.sibling}function Tg(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fr(t,e),Tr(e),r&4){try{zo(3,e,e.return),mu(3,e)}catch(F){bt(e,e.return,F)}try{zo(5,e,e.return)}catch(F){bt(e,e.return,F)}}break;case 1:fr(t,e),Tr(e),r&512&&n!==null&&Si(n,n.return);break;case 5:if(fr(t,e),Tr(e),r&512&&n!==null&&Si(n,n.return),e.flags&32){var s=e.stateNode;try{Xo(s,"")}catch(F){bt(e,e.return,F)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,l=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&J0(s,i),pd(l,a);var h=pd(l,i);for(a=0;a<d.length;a+=2){var m=d[a],w=d[a+1];m==="style"?n2(s,w):m==="dangerouslySetInnerHTML"?e2(s,w):m==="children"?Xo(s,w):kf(s,m,w,h)}switch(l){case"input":ud(s,i);break;case"textarea":Z0(s,i);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var N=i.value;N!=null?Ai(s,!!i.multiple,N,!1):S!==!!i.multiple&&(i.defaultValue!=null?Ai(s,!!i.multiple,i.defaultValue,!0):Ai(s,!!i.multiple,i.multiple?[]:"",!1))}s[sa]=i}catch(F){bt(e,e.return,F)}}break;case 6:if(fr(t,e),Tr(e),r&4){if(e.stateNode===null)throw Error(ie(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(F){bt(e,e.return,F)}}break;case 3:if(fr(t,e),Tr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qo(t.containerInfo)}catch(F){bt(e,e.return,F)}break;case 4:fr(t,e),Tr(e);break;case 13:fr(t,e),Tr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(th=Bt())),r&4&&q1(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(an=(h=an)||m,fr(t,e),an=h):fr(t,e),Tr(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!m&&e.mode&1)for(Se=e,m=e.child;m!==null;){for(w=Se=m;Se!==null;){switch(S=Se,N=S.child,S.tag){case 0:case 11:case 14:case 15:zo(4,S,S.return);break;case 1:Si(S,S.return);var R=S.stateNode;if(typeof R.componentWillUnmount=="function"){r=S,n=S.return;try{t=r,R.props=t.memoizedProps,R.state=t.memoizedState,R.componentWillUnmount()}catch(F){bt(r,n,F)}}break;case 5:Si(S,S.return);break;case 22:if(S.memoizedState!==null){tm(w);continue}}N!==null?(N.return=S,Se=N):tm(w)}m=m.sibling}e:for(m=null,w=e;;){if(w.tag===5){if(m===null){m=w;try{s=w.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=w.stateNode,d=w.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,l.style.display=t2("display",a))}catch(F){bt(e,e.return,F)}}}else if(w.tag===6){if(m===null)try{w.stateNode.nodeValue=h?"":w.memoizedProps}catch(F){bt(e,e.return,F)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===e)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===e)break e;for(;w.sibling===null;){if(w.return===null||w.return===e)break e;m===w&&(m=null),w=w.return}m===w&&(m=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:fr(t,e),Tr(e),r&4&&q1(e);break;case 21:break;default:fr(t,e),Tr(e)}}function Tr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(jg(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xo(s,""),r.flags&=-33);var i=Z1(e);Gd(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Z1(e);Hd(e,l,a);break;default:throw Error(ie(161))}}catch(d){bt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Mw(e,t,n){Se=e,Mg(e)}function Mg(e,t,n){for(var r=(e.mode&1)!==0;Se!==null;){var s=Se,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Qa;if(!a){var l=s.alternate,d=l!==null&&l.memoizedState!==null||an;l=Qa;var h=an;if(Qa=a,(an=d)&&!h)for(Se=s;Se!==null;)a=Se,d=a.child,a.tag===22&&a.memoizedState!==null?nm(s):d!==null?(d.return=a,Se=d):nm(s);for(;i!==null;)Se=i,Mg(i),i=i.sibling;Se=s,Qa=l,an=h}em(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Se=i):em(e)}}function em(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:an||mu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!an)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:hr(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&O1(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}O1(t,a,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var m=h.memoizedState;if(m!==null){var w=m.dehydrated;w!==null&&qo(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}an||t.flags&512&&Ud(t)}catch(S){bt(t,t.return,S)}}if(t===e){Se=null;break}if(n=t.sibling,n!==null){n.return=t.return,Se=n;break}Se=t.return}}function tm(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Se=n;break}Se=t.return}}function nm(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{mu(4,t)}catch(d){bt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){bt(t,s,d)}}var i=t.return;try{Ud(t)}catch(d){bt(t,i,d)}break;case 5:var a=t.return;try{Ud(t)}catch(d){bt(t,a,d)}}}catch(d){bt(t,t.return,d)}if(t===e){Se=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Se=l;break}Se=t.return}}var Pw=Math.ceil,Ul=is.ReactCurrentDispatcher,qf=is.ReactCurrentOwner,er=is.ReactCurrentBatchConfig,Qe=0,Xt=null,Ot=null,en=0,Ln=0,ki=Is(0),Gt=0,ca=null,qs=0,gu=0,eh=0,Uo=null,kn=null,th=0,Ui=1/0,Ur=null,Hl=!1,Wd=null,Es=null,Ja=!1,ys=null,Gl=0,Ho=0,Vd=null,pl=-1,ml=0;function fn(){return Qe&6?Bt():pl!==-1?pl:pl=Bt()}function As(e){return e.mode&1?Qe&2&&en!==0?en&-en:pw.transition!==null?(ml===0&&(ml=p2()),ml):(e=it,e!==0||(e=window.event,e=e===void 0?16:S2(e.type)),e):1}function vr(e,t,n,r){if(50<Ho)throw Ho=0,Vd=null,Error(ie(185));ga(e,n,r),(!(Qe&2)||e!==Xt)&&(e===Xt&&(!(Qe&2)&&(gu|=n),Gt===4&&hs(e,en)),Cn(e,r),n===1&&Qe===0&&!(t.mode&1)&&(Ui=Bt()+500,fu&&Rs()))}function Cn(e,t){var n=e.callbackNode;p4(e,t);var r=jl(e,e===Xt?en:0);if(r===0)n!==null&&d1(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&d1(n),t===1)e.tag===0?hw(rm.bind(null,e)):D2(rm.bind(null,e)),uw(function(){!(Qe&6)&&Rs()}),n=null;else{switch(m2(r)){case 1:n=jf;break;case 4:n=f2;break;case 16:n=Cl;break;case 536870912:n=h2;break;default:n=Cl}n=Og(n,Pg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Pg(e,t){if(pl=-1,ml=0,Qe&6)throw Error(ie(327));var n=e.callbackNode;if(Ti()&&e.callbackNode!==n)return null;var r=jl(e,e===Xt?en:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Wl(e,r);else{t=r;var s=Qe;Qe|=2;var i=Ig();(Xt!==e||en!==t)&&(Ur=null,Ui=Bt()+500,Ys(e,t));do try{Rw();break}catch(l){bg(e,l)}while(!0);Df(),Ul.current=i,Qe=s,Ot!==null?t=0:(Xt=null,en=0,t=Gt)}if(t!==0){if(t===2&&(s=wd(e),s!==0&&(r=s,t=Yd(e,s))),t===1)throw n=ca,Ys(e,0),hs(e,r),Cn(e,Bt()),n;if(t===6)hs(e,r);else{if(s=e.current.alternate,!(r&30)&&!bw(s)&&(t=Wl(e,r),t===2&&(i=wd(e),i!==0&&(r=i,t=Yd(e,i))),t===1))throw n=ca,Ys(e,0),hs(e,r),Cn(e,Bt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(ie(345));case 2:Ds(e,kn,Ur);break;case 3:if(hs(e,r),(r&130023424)===r&&(t=th+500-Bt(),10<t)){if(jl(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){fn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=jd(Ds.bind(null,e,kn,Ur),t);break}Ds(e,kn,Ur);break;case 4:if(hs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-yr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=Bt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pw(r/1960))-r,10<r){e.timeoutHandle=jd(Ds.bind(null,e,kn,Ur),r);break}Ds(e,kn,Ur);break;case 5:Ds(e,kn,Ur);break;default:throw Error(ie(329))}}}return Cn(e,Bt()),e.callbackNode===n?Pg.bind(null,e):null}function Yd(e,t){var n=Uo;return e.current.memoizedState.isDehydrated&&(Ys(e,t).flags|=256),e=Wl(e,t),e!==2&&(t=kn,kn=n,t!==null&&Kd(t)),e}function Kd(e){kn===null?kn=e:kn.push.apply(kn,e)}function bw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!wr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function hs(e,t){for(t&=~eh,t&=~gu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-yr(t),r=1<<n;e[n]=-1,t&=~r}}function rm(e){if(Qe&6)throw Error(ie(327));Ti();var t=jl(e,0);if(!(t&1))return Cn(e,Bt()),null;var n=Wl(e,t);if(e.tag!==0&&n===2){var r=wd(e);r!==0&&(t=r,n=Yd(e,r))}if(n===1)throw n=ca,Ys(e,0),hs(e,t),Cn(e,Bt()),n;if(n===6)throw Error(ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ds(e,kn,Ur),Cn(e,Bt()),null}function nh(e,t){var n=Qe;Qe|=1;try{return e(t)}finally{Qe=n,Qe===0&&(Ui=Bt()+500,fu&&Rs())}}function ei(e){ys!==null&&ys.tag===0&&!(Qe&6)&&Ti();var t=Qe;Qe|=1;var n=er.transition,r=it;try{if(er.transition=null,it=1,e)return e()}finally{it=r,er.transition=n,Qe=t,!(Qe&6)&&Rs()}}function rh(){Ln=ki.current,gt(ki)}function Ys(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,lw(n)),Ot!==null)for(n=Ot.return;n!==null;){var r=n;switch(Ff(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&bl();break;case 3:Di(),gt(An),gt(ln),Vf();break;case 5:Wf(r);break;case 4:Di();break;case 13:gt(_t);break;case 19:gt(_t);break;case 10:zf(r.type._context);break;case 22:case 23:rh()}n=n.return}if(Xt=e,Ot=e=_s(e.current,null),en=Ln=t,Gt=0,ca=null,eh=gu=qs=0,kn=Uo=null,Hs!==null){for(t=0;t<Hs.length;t++)if(n=Hs[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Hs=null}return e}function bg(e,t){do{var n=Ot;try{if(Df(),dl.current=zl,Dl){for(var r=Ct.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Dl=!1}if(Zs=0,Kt=Ut=Ct=null,Do=!1,aa=0,qf.current=null,n===null||n.return===null){Gt=1,ca=t,Ot=null;break}e:{var i=e,a=n.return,l=n,d=t;if(t=en,l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,m=l,w=m.tag;if(!(m.mode&1)&&(w===0||w===11||w===15)){var S=m.alternate;S?(m.updateQueue=S.updateQueue,m.memoizedState=S.memoizedState,m.lanes=S.lanes):(m.updateQueue=null,m.memoizedState=null)}var N=G1(a);if(N!==null){N.flags&=-257,W1(N,a,l,i,t),N.mode&1&&H1(i,h,t),t=N,d=h;var R=t.updateQueue;if(R===null){var F=new Set;F.add(d),t.updateQueue=F}else R.add(d);break e}else{if(!(t&1)){H1(i,h,t),sh();break e}d=Error(ie(426))}}else if(xt&&l.mode&1){var K=G1(a);if(K!==null){!(K.flags&65536)&&(K.flags|=256),W1(K,a,l,i,t),Of(zi(d,l));break e}}i=d=zi(d,l),Gt!==4&&(Gt=2),Uo===null?Uo=[i]:Uo.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var A=mg(i,d,t);F1(i,A);break e;case 1:l=d;var g=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Es===null||!Es.has(k)))){i.flags|=65536,t&=-t,i.lanes|=t;var T=gg(i,l,t);F1(i,T);break e}}i=i.return}while(i!==null)}Lg(n)}catch(b){t=b,Ot===n&&n!==null&&(Ot=n=n.return);continue}break}while(!0)}function Ig(){var e=Ul.current;return Ul.current=zl,e===null?zl:e}function sh(){(Gt===0||Gt===3||Gt===2)&&(Gt=4),Xt===null||!(qs&268435455)&&!(gu&268435455)||hs(Xt,en)}function Wl(e,t){var n=Qe;Qe|=2;var r=Ig();(Xt!==e||en!==t)&&(Ur=null,Ys(e,t));do try{Iw();break}catch(s){bg(e,s)}while(!0);if(Df(),Qe=n,Ul.current=r,Ot!==null)throw Error(ie(261));return Xt=null,en=0,Gt}function Iw(){for(;Ot!==null;)Rg(Ot)}function Rw(){for(;Ot!==null&&!i4();)Rg(Ot)}function Rg(e){var t=Fg(e.alternate,e,Ln);e.memoizedProps=e.pendingProps,t===null?Lg(e):Ot=t,qf.current=null}function Lg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=jw(n,t),n!==null){n.flags&=32767,Ot=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gt=6,Ot=null;return}}else if(n=Cw(n,t,Ln),n!==null){Ot=n;return}if(t=t.sibling,t!==null){Ot=t;return}Ot=t=e}while(t!==null);Gt===0&&(Gt=5)}function Ds(e,t,n){var r=it,s=er.transition;try{er.transition=null,it=1,Lw(e,t,n,r)}finally{er.transition=s,it=r}return null}function Lw(e,t,n,r){do Ti();while(ys!==null);if(Qe&6)throw Error(ie(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ie(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(m4(e,i),e===Xt&&(Ot=Xt=null,en=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ja||(Ja=!0,Og(Cl,function(){return Ti(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=er.transition,er.transition=null;var a=it;it=1;var l=Qe;Qe|=4,qf.current=null,Tw(e,n),Tg(n,e),tw(_d),Nl=!!Ad,_d=Ad=null,e.current=n,Mw(n),o4(),Qe=l,it=a,er.transition=i}else e.current=n;if(Ja&&(Ja=!1,ys=e,Gl=s),i=e.pendingLanes,i===0&&(Es=null),u4(n.stateNode),Cn(e,Bt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Hl)throw Hl=!1,e=Wd,Wd=null,e;return Gl&1&&e.tag!==0&&Ti(),i=e.pendingLanes,i&1?e===Vd?Ho++:(Ho=0,Vd=e):Ho=0,Rs(),null}function Ti(){if(ys!==null){var e=m2(Gl),t=er.transition,n=it;try{if(er.transition=null,it=16>e?16:e,ys===null)var r=!1;else{if(e=ys,ys=null,Gl=0,Qe&6)throw Error(ie(331));var s=Qe;for(Qe|=4,Se=e.current;Se!==null;){var i=Se,a=i.child;if(Se.flags&16){var l=i.deletions;if(l!==null){for(var d=0;d<l.length;d++){var h=l[d];for(Se=h;Se!==null;){var m=Se;switch(m.tag){case 0:case 11:case 15:zo(8,m,i)}var w=m.child;if(w!==null)w.return=m,Se=w;else for(;Se!==null;){m=Se;var S=m.sibling,N=m.return;if(Cg(m),m===h){Se=null;break}if(S!==null){S.return=N,Se=S;break}Se=N}}}var R=i.alternate;if(R!==null){var F=R.child;if(F!==null){R.child=null;do{var K=F.sibling;F.sibling=null,F=K}while(F!==null)}}Se=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Se=a;else e:for(;Se!==null;){if(i=Se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:zo(9,i,i.return)}var A=i.sibling;if(A!==null){A.return=i.return,Se=A;break e}Se=i.return}}var g=e.current;for(Se=g;Se!==null;){a=Se;var k=a.child;if(a.subtreeFlags&2064&&k!==null)k.return=a,Se=k;else e:for(a=g;Se!==null;){if(l=Se,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:mu(9,l)}}catch(b){bt(l,l.return,b)}if(l===a){Se=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,Se=T;break e}Se=l.return}}if(Qe=s,Rs(),Or&&typeof Or.onPostCommitFiberRoot=="function")try{Or.onPostCommitFiberRoot(au,e)}catch{}r=!0}return r}finally{it=n,er.transition=t}}return!1}function sm(e,t,n){t=zi(n,t),t=mg(e,t,1),e=ks(e,t,1),t=fn(),e!==null&&(ga(e,1,t),Cn(e,t))}function bt(e,t,n){if(e.tag===3)sm(e,e,n);else for(;t!==null;){if(t.tag===3){sm(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Es===null||!Es.has(r))){e=zi(n,e),e=gg(t,e,1),t=ks(t,e,1),e=fn(),t!==null&&(ga(t,1,e),Cn(t,e));break}}t=t.return}}function Bw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=fn(),e.pingedLanes|=e.suspendedLanes&n,Xt===e&&(en&n)===n&&(Gt===4||Gt===3&&(en&130023424)===en&&500>Bt()-th?Ys(e,0):eh|=n),Cn(e,t)}function Bg(e,t){t===0&&(e.mode&1?(t=za,za<<=1,!(za&130023424)&&(za=4194304)):t=1);var n=fn();e=ts(e,t),e!==null&&(ga(e,t,n),Cn(e,n))}function Fw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Bg(e,n)}function Ow(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(t),Bg(e,n)}var Fg;Fg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||An.current)En=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return En=!1,_w(e,t,n);En=!!(e.flags&131072)}else En=!1,xt&&t.flags&1048576&&z2(t,Ll,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;hl(e,t),e=t.pendingProps;var s=Fi(t,ln.current);Ni(t,n),s=Kf(null,t,r,e,s,n);var i=Xf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,_n(r)?(i=!0,Il(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hf(t),s.updater=pu,t.stateNode=s,s._reactInternals=t,Rd(t,r,e,n),t=Fd(null,t,r,!0,i,n)):(t.tag=0,xt&&i&&Bf(t),dn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(hl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Dw(r),e=hr(r,e),s){case 0:t=Bd(null,t,r,e,n);break e;case 1:t=K1(null,t,r,e,n);break e;case 11:t=V1(null,t,r,e,n);break e;case 14:t=Y1(null,t,r,hr(r.type,e),n);break e}throw Error(ie(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),Bd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),K1(e,t,r,s,n);case 3:e:{if(xg(t),e===null)throw Error(ie(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Y2(e,t),Ol(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=zi(Error(ie(423)),t),t=X1(e,t,r,n,s);break e}else if(r!==s){s=zi(Error(ie(424)),t),t=X1(e,t,r,n,s);break e}else for(Bn=Ss(t.stateNode.containerInfo.firstChild),Fn=t,xt=!0,mr=null,n=W2(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Oi(),r===s){t=ns(e,t,n);break e}dn(e,t,r,n)}t=t.child}return t;case 5:return K2(t),e===null&&Pd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Cd(r,s)?a=null:i!==null&&Cd(r,i)&&(t.flags|=32),wg(e,t),dn(e,t,a,n),t.child;case 6:return e===null&&Pd(t),null;case 13:return Sg(e,t,n);case 4:return Gf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=$i(t,null,r,n):dn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),V1(e,t,r,s,n);case 7:return dn(e,t,t.pendingProps,n),t.child;case 8:return dn(e,t,t.pendingProps.children,n),t.child;case 12:return dn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,ft(Bl,r._currentValue),r._currentValue=a,i!==null)if(wr(i.value,a)){if(i.children===s.children&&!An.current){t=ns(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var d=l.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=Xr(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var m=h.pending;m===null?d.next=d:(d.next=m.next,m.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),bd(i.return,n,t),l.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ie(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),bd(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}dn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ni(t,n),s=tr(s),r=r(s),t.flags|=1,dn(e,t,r,n),t.child;case 14:return r=t.type,s=hr(r,t.pendingProps),s=hr(r.type,s),Y1(e,t,r,s,n);case 15:return yg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:hr(r,s),hl(e,t),t.tag=1,_n(r)?(e=!0,Il(t)):e=!1,Ni(t,n),pg(t,r,s),Rd(t,r,s,n),Fd(null,t,r,!0,e,n);case 19:return kg(e,t,n);case 22:return vg(e,t,n)}throw Error(ie(156,t.tag))};function Og(e,t){return d2(e,t)}function $w(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(e,t,n,r){return new $w(e,t,n,r)}function ih(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Dw(e){if(typeof e=="function")return ih(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Af)return 11;if(e===_f)return 14}return 2}function _s(e,t){var n=e.alternate;return n===null?(n=Zn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function gl(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")ih(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case fi:return Ks(n.children,s,i,t);case Ef:a=8,s|=8;break;case sd:return e=Zn(12,n,t,s|2),e.elementType=sd,e.lanes=i,e;case id:return e=Zn(13,n,t,s),e.elementType=id,e.lanes=i,e;case od:return e=Zn(19,n,t,s),e.elementType=od,e.lanes=i,e;case K0:return yu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case V0:a=10;break e;case Y0:a=9;break e;case Af:a=11;break e;case _f:a=14;break e;case cs:a=16,r=null;break e}throw Error(ie(130,e==null?e:typeof e,""))}return t=Zn(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Ks(e,t,n,r){return e=Zn(7,e,r,t),e.lanes=n,e}function yu(e,t,n,r){return e=Zn(22,e,r,t),e.elementType=K0,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return e=Zn(6,e,null,t),e.lanes=n,e}function Bc(e,t,n){return t=Zn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zw(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gc(0),this.expirationTimes=gc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function oh(e,t,n,r,s,i,a,l,d){return e=new zw(e,t,n,l,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Zn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hf(i),e}function Uw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:di,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function $g(e){if(!e)return Ts;e=e._reactInternals;e:{if(si(e)!==e||e.tag!==1)throw Error(ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(_n(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ie(171))}if(e.tag===1){var n=e.type;if(_n(n))return $2(e,n,t)}return t}function Dg(e,t,n,r,s,i,a,l,d){return e=oh(n,r,!0,e,s,i,a,l,d),e.context=$g(null),n=e.current,r=fn(),s=As(n),i=Xr(r,s),i.callback=t??null,ks(n,i,s),e.current.lanes=s,ga(e,s,r),Cn(e,r),e}function vu(e,t,n,r){var s=t.current,i=fn(),a=As(s);return n=$g(n),t.context===null?t.context=n:t.pendingContext=n,t=Xr(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ks(s,t,a),e!==null&&(vr(e,s,a,i),cl(e,s,a)),a}function Vl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function im(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ah(e,t){im(e,t),(e=e.alternate)&&im(e,t)}function Hw(){return null}var zg=typeof reportError=="function"?reportError:function(e){console.error(e)};function lh(e){this._internalRoot=e}wu.prototype.render=lh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ie(409));vu(e,t,null,null)};wu.prototype.unmount=lh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ei(function(){vu(null,e,null,null)}),t[es]=null}};function wu(e){this._internalRoot=e}wu.prototype.unstable_scheduleHydration=function(e){if(e){var t=v2();e={blockedOn:null,target:e,priority:t};for(var n=0;n<fs.length&&t!==0&&t<fs[n].priority;n++);fs.splice(n,0,e),n===0&&x2(e)}};function uh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function xu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function om(){}function Gw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=Vl(a);i.call(h)}}var a=Dg(t,r,e,0,null,!1,!1,"",om);return e._reactRootContainer=a,e[es]=a.current,na(e.nodeType===8?e.parentNode:e),ei(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=Vl(d);l.call(h)}}var d=oh(e,0,!1,null,null,!1,!1,"",om);return e._reactRootContainer=d,e[es]=d.current,na(e.nodeType===8?e.parentNode:e),ei(function(){vu(t,d,n,r)}),d}function Su(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var d=Vl(a);l.call(d)}}vu(t,a,e,s)}else a=Gw(n,t,e,s,r);return Vl(a)}g2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Po(t.pendingLanes);n!==0&&(Nf(t,n|1),Cn(t,Bt()),!(Qe&6)&&(Ui=Bt()+500,Rs()))}break;case 13:ei(function(){var r=ts(e,1);if(r!==null){var s=fn();vr(r,e,1,s)}}),ah(e,1)}};Tf=function(e){if(e.tag===13){var t=ts(e,134217728);if(t!==null){var n=fn();vr(t,e,134217728,n)}ah(e,134217728)}};y2=function(e){if(e.tag===13){var t=As(e),n=ts(e,t);if(n!==null){var r=fn();vr(n,e,t,r)}ah(e,t)}};v2=function(){return it};w2=function(e,t){var n=it;try{return it=e,t()}finally{it=n}};gd=function(e,t,n){switch(t){case"input":if(ud(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=du(r);if(!s)throw Error(ie(90));Q0(r),ud(r,s)}}}break;case"textarea":Z0(e,n);break;case"select":t=n.value,t!=null&&Ai(e,!!n.multiple,t,!1)}};i2=nh;o2=ei;var Ww={usingClientEntryPoint:!1,Events:[va,gi,du,r2,s2,nh]},Ao={findFiberByHostInstance:Us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Vw={bundleType:Ao.bundleType,version:Ao.version,rendererPackageName:Ao.rendererPackageName,rendererConfig:Ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:is.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=u2(e),e===null?null:e.stateNode},findFiberByHostInstance:Ao.findFiberByHostInstance||Hw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Za=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Za.isDisabled&&Za.supportsFiber)try{au=Za.inject(Vw),Or=Za}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ww;Dn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uh(t))throw Error(ie(200));return Uw(e,t,null,n)};Dn.createRoot=function(e,t){if(!uh(e))throw Error(ie(299));var n=!1,r="",s=zg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=oh(e,1,!1,null,null,n,!1,r,s),e[es]=t.current,na(e.nodeType===8?e.parentNode:e),new lh(t)};Dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ie(188)):(e=Object.keys(e).join(","),Error(ie(268,e)));return e=u2(t),e=e===null?null:e.stateNode,e};Dn.flushSync=function(e){return ei(e)};Dn.hydrate=function(e,t,n){if(!xu(t))throw Error(ie(200));return Su(null,e,t,!0,n)};Dn.hydrateRoot=function(e,t,n){if(!uh(e))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=zg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Dg(t,null,e,1,n??null,s,!1,i,a),e[es]=t.current,na(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new wu(t)};Dn.render=function(e,t,n){if(!xu(t))throw Error(ie(200));return Su(null,e,t,!1,n)};Dn.unmountComponentAtNode=function(e){if(!xu(e))throw Error(ie(40));return e._reactRootContainer?(ei(function(){Su(null,null,e,!1,function(){e._reactRootContainer=null,e[es]=null})}),!0):!1};Dn.unstable_batchedUpdates=nh;Dn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!xu(n))throw Error(ie(200));if(e==null||e._reactInternals===void 0)throw Error(ie(38));return Su(e,t,n,!1,r)};Dn.version="18.3.1-next-f1338f8080-20240426";function Ug(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ug)}catch(e){console.error(e)}}Ug(),U0.exports=Dn;var Yw=U0.exports,am=Yw;nd.createRoot=am.createRoot,nd.hydrateRoot=am.hydrateRoot;const Mi={},Hg="production",lm={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-server.onrender.com/api",healthUrl:"https://cfg-server.onrender.com/health"}},Gg=lm[Hg]||lm.development,ku=()=>{if(!(Mi!=null&&Mi.VITE_API_BASE_URL))return Gg.baseUrl},Kw=()=>{if(!(Mi!=null&&Mi.VITE_HEALTH_URL))return Gg.healthUrl},Xw=async()=>{try{const e=await fetch(Kw(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},Qw=()=>Hg;function Jw({onStart:e}){const[t,n]=C.useState("1"),[r,s]=C.useState("individual"),[i,a]=C.useState("15"),[l,d]=C.useState({status:"checking",version:"...",commit:"...",healthy:!1});C.useEffect(()=>{const S=async()=>{const R=await Xw();d(R),console.log("[StartDialog] Server health:",R)};S();const N=setInterval(S,3e4);return()=>clearInterval(N)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const S={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(S)},m=()=>{window.close()},w=()=>l.status==="checking"?"checking":l.healthy?"healthy":"unhealthy";return c.jsx("div",{className:"dialog-overlay",children:c.jsxs("div",{className:"dialog-box",children:[c.jsxs("div",{className:"dialog-header",children:[c.jsx("h2",{children:"The Creative Game"}),c.jsxs("div",{className:`server-health-indicator ${w()}`,title:`Server: ${l.status}
Version: ${l.version}
Commit: ${l.commit}
Environment: ${Qw()}`,children:[c.jsx("span",{className:"health-light"}),c.jsx("span",{className:"health-text",children:"Server"})]})]}),c.jsxs("div",{className:"dialog-field",children:[c.jsx("label",{children:"ID:"}),c.jsx("input",{type:"text",value:t,onChange:S=>n(S.target.value)})]}),c.jsxs("div",{className:"dialog-field",children:[c.jsx("label",{children:"Condition:"}),c.jsxs("select",{value:r,onChange:S=>s(S.target.value),children:[c.jsx("option",{value:"individual",children:"individual"}),c.jsx("option",{value:"group",children:"group"})]})]}),c.jsxs("div",{className:"dialog-field",children:[c.jsx("label",{children:"Time (in minutes):"}),c.jsx("input",{type:"number",value:i,onChange:S=>a(S.target.value),min:"1"})]}),c.jsxs("div",{className:"dialog-buttons",children:[c.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),c.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),c.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),c.jsx("button",{className:"dialog-button cancel",onClick:m,children:"Cancel"})]})]})})}class um{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const Zw=.035;class qw{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=ku(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),l=s-i;let d=0,h=0,m=0;n>=0&&n<60?(d=i,h=a,m=0):n<120?(d=a,h=i,m=0):n<180?(d=0,h=i,m=a):n<240?(d=0,h=a,m=i):n<300?(d=a,h=0,m=i):(d=i,h=0,m=a);const w=S=>{const N=Math.round((S+l)*255).toString(16);return N.length===1?"0"+N:N};return`#${w(d)}${w(h)}${w(m)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const l=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${l}

Please choose a different Session ID.`),this.stop(),new Error(l)):new Error(l)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/Zw,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),l=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(S=>this.relativeToGrid(S)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:l,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:l,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(S=>this.relativeToGrid(S)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(S=>this.relativeToGrid(S)):null)),this.moves.push(h),this.persistMove(h).catch(S=>{console.error("[GameTracker] Failed to persist move to server:",S)});const m=this.getCurrentBraceletStatus(),w=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:l,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:m,lastKnownPlayer:w,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(S=>({status:S.status,elapsed:S.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(l=>l.timestamp>=s&&l.timestamp<=i);if(a.length>0){const l={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(l[h.status]=(l[h.status]||0)+1)});const d=Object.keys(l).reduce((h,m)=>l[h]>l[m]?h:m,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let Fc=null;const cm=()=>(Fc||(Fc=new qw),Fc),gr=.07,Go=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),At=e=>Math.round(e*1e3)/1e3,e5=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[At(i.position[0]-gr),At(i.position[1])],[At(i.position[0]+gr),At(i.position[1])],[At(i.position[0]),At(i.position[1]-gr)],[At(i.position[0]),At(i.position[1]+gr)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},t5=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},Xd=e=>e.map(t=>{const n=[],r=[[At(t.position[0]-gr),At(t.position[1])],[At(t.position[0]+gr),At(t.position[1])],[At(t.position[0]),At(t.position[1]-gr)],[At(t.position[0]),At(t.position[1]+gr)]];return e.forEach(s=>{r.forEach(i=>{At(s.position[0])===i[0]&&At(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),n5=e=>{const t=new Set;if(e.forEach((a,l)=>{a.forEach((d,h)=>{d&&t.add(`${l},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,l]=i.shift(),d=`${a},${l}`;s.has(d)||(s.add(d),n.forEach(([h,m])=>{const w=`${a+h},${l+m}`;t.has(w)&&!s.has(w)&&i.push([a+h,l+m])}))}return s.size===t.size},r5=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=gr)n.push(At(i));const r=[];for(let i=-.7;i<0;i+=gr)r.push(At(i));for(let i=0;i<=.77;i+=gr)r.push(At(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const l=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);l!==-1&&d!==-1&&(s[d][l]=!0)}}),n5(s)},Qd=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=r5(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},dm=e=>{if(e.length===0)return null;try{const t=e.map(m=>m[0]),n=e.map(m=>m[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(m=>{const w=Math.sqrt(Math.pow(m[0]-r,2)+Math.pow(m[1]-s,2));w<i&&(i=w,a=m)});const l=-a[0],d=-a[1],h=e.map(m=>[At(m[0]+l),At(m[1]+d)]);return h.sort((m,w)=>m[0]-w[0]||m[1]-w[1]),h}catch{return null}},s5=60,fm=.07,Oc=120;function i5({config:e,interfaceHidden:t=!1}){const[n,r]=C.useState(Go()),[s,i]=C.useState(null),[a,l]=C.useState({x:0,y:0}),[d,h]=C.useState(!0),[m,w]=C.useState(e.timeSeconds),[S,N]=C.useState(0),[R,F]=C.useState(null),[K,A]=C.useState(!0),[g,k]=C.useState(""),[T,b]=C.useState(!1),[B,D]=C.useState({blockSize:s5,bottomPadding:Oc}),G=C.useRef(null),le=C.useRef(new um(e)),V=C.useRef(cm()),Y=C.useRef(null),te=C.useRef(Date.now()),X=C.useRef(Oc),ee=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,Ee=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,xe="The experiment is done. Thank you very much for your participation!",ge=C.useCallback(()=>{const O=G.current;if(!O)return;const H=O.offsetWidth,q=O.offsetHeight;if(!H||!q)return;const ue=X.current||Oc;let $=Math.max(1,Math.min(H,q-ue)),y=Math.max(38,Math.min($*fm*.95,$/4)),P=Math.max(y*2.5,110);$=Math.max(1,Math.min(H,q-P)),y=Math.max(38,Math.min($*fm*.95,$/4)),P=Math.max(y*2.5,110),X.current=P,D(j=>{const _=Math.abs(j.blockSize-y),I=Math.abs(j.bottomPadding-P);return _<.5&&I<.5?j:{blockSize:y,bottomPadding:P}})},[]);C.useEffect(()=>(k(ee),(async()=>{try{V.current.start(),await V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(H){console.error("[GameCanvas] Failed to initialize tracker:",H),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{A(!0),k(xe),b(!0),V.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,V.current.stop()}),[]),C.useEffect(()=>{ge()},[ge,t]),C.useEffect(()=>{const O=()=>{ge()};return O(),window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[ge]),C.useEffect(()=>{if(!d&&m>0){const O=setInterval(()=>{w(H=>H<=1?(clearInterval(O),A(!0),k(xe),b(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):H-1)},1e3);return()=>clearInterval(O)}},[d,m]),C.useEffect(()=>{r(O=>Qd(Xd(O),d))},[d]);const J=()=>(Date.now()-te.current)/1e3,oe=(O,H)=>{const q=G.current;if(!q)return 0;const ue=q.offsetHeight-X.current,$=Math.min(q.offsetWidth,ue),y=H==="x"?(q.offsetWidth-$)/2:(q.offsetHeight-X.current-$)/2;return(O-y)/$-.5},Z=(O,H)=>{const q=G.current;if(!q)return 0;const ue=q.offsetHeight-X.current,$=Math.min(q.offsetWidth,ue),y=H==="x"?(q.offsetWidth-$)/2:(q.offsetHeight-X.current-$)/2;return(O+.5)*$+y},pe=O=>{var $,y,P,j;const H=G.current.getBoundingClientRect(),q=O.clientX!==void 0?O.clientX:(y=($=O.touches)==null?void 0:$[0])==null?void 0:y.clientX,ue=O.clientY!==void 0?O.clientY:(j=(P=O.touches)==null?void 0:P[0])==null?void 0:j.clientY;return{x:q-H.left,y:ue-H.top}},Me=(O,H)=>{const q=n.find(P=>P.id===H);if(!q||!q.canMove)return;O.preventDefault();const ue=pe(O),$=Z(q.position[0],"x"),y=Z(q.position[1],"y");Y.current=Date.now(),i(H),l({x:ue.x-$,y:ue.y-y})},Be=O=>{if(s===null)return;O.preventDefault();const H=pe(O),q=oe(H.x-a.x,"x"),ue=oe(H.y-a.y,"y");r($=>$.map(y=>y.id===s?{...y,position:[q,ue]}:y))},Xe=()=>{try{const O=window.braceletDetectorVideo;if(!O||!O.videoWidth||O.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const H=document.createElement("canvas"),q=640,ue=480;let $=O.videoWidth,y=O.videoHeight;const P=$/y;return $>q&&($=q,y=$/P),y>ue&&(y=ue,$=y*P),H.width=Math.floor($),H.height=Math.floor(y),H.getContext("2d").drawImage(O,0,0,H.width,H.height),H.toDataURL("image/jpeg",.6)}catch(O){return console.error("[GameCanvas] Error capturing camera frame:",O),null}},Fe=()=>{if(s===null)return;const O=n.find(_=>_.id===s),H=e5(n,s),q=t5(H,O.position),ue=Y.current?(Date.now()-Y.current)/1e3:0,$=n.map(_=>_.id===s?{..._,position:q}:_),y=Xe(),P=window.currentBraceletStatus||"Unknown",j={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:J(),unit:s,end_position:q,all_positions:$.map(_=>_.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:y,player:P};le.current.write(j),V.current.recordMove(j,ue,y),r(_=>{const I=_.map(z=>z.id===s?{...z,position:q}:z);return Qd(Xd(I),d)}),i(null),Y.current=null},ze=()=>{const O=n.map(j=>j.position),H=dm(O),q=S+1,ue=Xe(),$=window.currentBraceletStatus||"Unknown",y={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:J(),unit:null,end_position:null,all_positions:null,gallery_shape_number:q,gallery:O,gallery_normalized:H,camera_frame:ue,player:$};le.current.write(y),V.current.recordMove(y,0,ue);const P=Q();F(P),N(q)},Q=()=>{const O=document.createElement("canvas");O.width=400,O.height=400;const H=O.getContext("2d");H.fillStyle="#000",H.fillRect(0,0,400,400);const q=n.map($=>$.position),ue=dm(q);return ue&&ue.forEach($=>{const y=($[0]+.5)*400,P=($[1]+.5)*400;H.fillStyle="green",H.fillRect(y-15,P-15,30,30)}),O.toDataURL()},de=C.useCallback(O=>{O.key==="p"&&d?(h(!1),A(!0),k(Ee),te.current=Date.now(),r(Go()),F(null),N(0),le.current=new um(e),V.current.stop(),V.current=cm(),V.current.start(),V.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):O.key==="q"&&!d&&(A(!0),k(xe),b(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);C.useEffect(()=>(window.addEventListener("keydown",de),()=>window.removeEventListener("keydown",de)),[de]);const ye=()=>{if(T&&g===xe){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&g===Ee)try{const O=new(window.AudioContext||window.webkitAudioContext),H=O.createOscillator(),q=O.createGain();H.connect(q),q.connect(O.destination),H.frequency.setValueAtTime(800,O.currentTime),H.frequency.setValueAtTime(600,O.currentTime+.15),q.gain.setValueAtTime(.3,O.currentTime),q.gain.exponentialRampToValueAtTime(.01,O.currentTime+.3),H.start(O.currentTime),H.stop(O.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(O){console.error("[GameCanvas] Error playing sound:",O)}A(!1)},ve=O=>{O.preventDefault()};return c.jsxs("div",{className:"game-canvas",ref:G,style:{"--block-size":`${B.blockSize}px`,"--bottom-padding":`${B.bottomPadding}px`},onMouseMove:Be,onMouseUp:Fe,onMouseLeave:Fe,onTouchMove:Be,onTouchEnd:Fe,onTouchCancel:Fe,onContextMenu:ve,children:[c.jsx("div",{className:"gallery",onClick:ze,children:c.jsx("div",{className:"gallery-frame",children:R?c.jsx("img",{src:R,alt:"Gallery",className:"gallery-image"}):c.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&c.jsxs("div",{className:"timer",children:["Time: ",Math.floor(m/60),":",(m%60).toString().padStart(2,"0")]}),n.map(O=>c.jsx("div",{className:`block ${O.canMove?"movable":""}`,style:{left:`${Z(O.position[0],"x")}px`,top:`${Z(O.position[1],"y")}px`,backgroundColor:O.color||"green",cursor:O.canMove?"grab":"default"},onMouseDown:H=>Me(H,O.id),onTouchStart:H=>Me(H,O.id)},O.id)),K&&c.jsx("div",{className:"message-overlay",onClick:ye,children:c.jsxs("div",{className:"message-box",children:[g,c.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var Yl={};(function(){var e;function t(o){var u=0;return function(){return u<o.length?{done:!1,value:o[u++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,f){return o==Array.prototype||o==Object.prototype||(o[u]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof cc=="object"&&cc];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,u){if(u)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var v=o[p];if(!(v in f))break e;f=f[v]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&n(f,o,{configurable:!0,writable:!0,value:u})}}i("Symbol",function(o){function u(E){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return new f(p+(E||"")+"_"+v++,E)}function f(E,x){this.h=E,n(this,"description",{configurable:!0,writable:!0,value:x})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",v=0;return u}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var u="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<u.length;f++){var p=s[u[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function l(o){var u=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return u?u.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=l(o);for(var u,f=[];!(u=o.next()).done;)f.push(u.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,u){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&(o[v]=p[v])}return o};i("Object.assign",function(o){return o||h});var m=typeof Object.create=="function"?Object.create:function(o){function u(){}return u.prototype=o,new u},w;if(typeof Object.setPrototypeOf=="function")w=Object.setPrototypeOf;else{var S;e:{var N={a:!0},R={};try{R.__proto__=N,S=R.a;break e}catch{}S=!1}w=S?function(o,u){if(o.__proto__=u,o.__proto__!==u)throw new TypeError(o+" is not extensible");return o}:null}var F=w;function K(o,u){if(o.prototype=m(u.prototype),o.prototype.constructor=o,F)F(o,u);else for(var f in u)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(u,f);p&&Object.defineProperty(o,f,p)}else o[f]=u[f];o.ya=u.prototype}function A(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function g(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}A.prototype.u=function(o){this.i=o};function k(o,u){o.l={ma:u,na:!0},o.h=o.s||o.v}A.prototype.return=function(o){this.l={return:o},this.h=this.v};function T(o,u,f){return o.h=f,{value:u}}function b(o){this.h=new A,this.i=o}function B(o,u){g(o.h);var f=o.h.j;return f?D(o,"return"in f?f.return:function(p){return{value:p,done:!0}},u,o.h.return):(o.h.return(u),G(o))}function D(o,u,f,p){try{var v=u.call(o.h.j,f);if(!(v instanceof Object))throw new TypeError("Iterator result "+v+" is not an object");if(!v.done)return o.h.m=!1,v;var E=v.value}catch(x){return o.h.j=null,k(o.h,x),G(o)}return o.h.j=null,p.call(o.h,E),G(o)}function G(o){for(;o.h.h;)try{var u=o.i(o.h);if(u)return o.h.m=!1,{value:u.value,done:!1}}catch(f){o.h.i=void 0,k(o.h,f)}if(o.h.m=!1,o.h.l){if(u=o.h.l,o.h.l=null,u.na)throw u.ma;return{value:u.return,done:!0}}return{value:void 0,done:!0}}function le(o){this.next=function(u){return g(o.h),o.h.j?u=D(o,o.h.j.next,u,o.h.u):(o.h.u(u),u=G(o)),u},this.throw=function(u){return g(o.h),o.h.j?u=D(o,o.h.j.throw,u,o.h.u):(k(o.h,u),u=G(o)),u},this.return=function(u){return B(o,u)},this[Symbol.iterator]=function(){return this}}function V(o){function u(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,v){function E(x){x.done?p(x.value):Promise.resolve(x.value).then(u,f).then(E,v)}E(o.next())})}function Y(o){return V(new le(new b(o)))}i("Promise",function(o){function u(x){this.i=0,this.j=void 0,this.h=[],this.u=!1;var M=this.l();try{x(M.resolve,M.reject)}catch(U){M.reject(U)}}function f(){this.h=null}function p(x){return x instanceof u?x:new u(function(M){M(x)})}if(o)return o;f.prototype.i=function(x){if(this.h==null){this.h=[];var M=this;this.j(function(){M.m()})}this.h.push(x)};var v=s.setTimeout;f.prototype.j=function(x){v(x,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var x=this.h;this.h=[];for(var M=0;M<x.length;++M){var U=x[M];x[M]=null;try{U()}catch(se){this.l(se)}}}this.h=null},f.prototype.l=function(x){this.j(function(){throw x})},u.prototype.l=function(){function x(se){return function(fe){U||(U=!0,se.call(M,fe))}}var M=this,U=!1;return{resolve:x(this.I),reject:x(this.m)}},u.prototype.I=function(x){if(x===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(x instanceof u)this.L(x);else{e:switch(typeof x){case"object":var M=x!=null;break e;case"function":M=!0;break e;default:M=!1}M?this.F(x):this.s(x)}},u.prototype.F=function(x){var M=void 0;try{M=x.then}catch(U){this.m(U);return}typeof M=="function"?this.M(M,x):this.s(x)},u.prototype.m=function(x){this.v(2,x)},u.prototype.s=function(x){this.v(1,x)},u.prototype.v=function(x,M){if(this.i!=0)throw Error("Cannot settle("+x+", "+M+"): Promise already settled in state"+this.i);this.i=x,this.j=M,this.i===2&&this.K(),this.H()},u.prototype.K=function(){var x=this;v(function(){if(x.D()){var M=s.console;typeof M<"u"&&M.error(x.j)}},1)},u.prototype.D=function(){if(this.u)return!1;var x=s.CustomEvent,M=s.Event,U=s.dispatchEvent;return typeof U>"u"?!0:(typeof x=="function"?x=new x("unhandledrejection",{cancelable:!0}):typeof M=="function"?x=new M("unhandledrejection",{cancelable:!0}):(x=s.document.createEvent("CustomEvent"),x.initCustomEvent("unhandledrejection",!1,!0,x)),x.promise=this,x.reason=this.j,U(x))},u.prototype.H=function(){if(this.h!=null){for(var x=0;x<this.h.length;++x)E.i(this.h[x]);this.h=null}};var E=new f;return u.prototype.L=function(x){var M=this.l();x.T(M.resolve,M.reject)},u.prototype.M=function(x,M){var U=this.l();try{x.call(M,U.resolve,U.reject)}catch(se){U.reject(se)}},u.prototype.then=function(x,M){function U(Ce,me){return typeof Ce=="function"?function(Re){try{se(Ce(Re))}catch(He){fe(He)}}:me}var se,fe,Ie=new u(function(Ce,me){se=Ce,fe=me});return this.T(U(x,se),U(M,fe)),Ie},u.prototype.catch=function(x){return this.then(void 0,x)},u.prototype.T=function(x,M){function U(){switch(se.i){case 1:x(se.j);break;case 2:M(se.j);break;default:throw Error("Unexpected state: "+se.i)}}var se=this;this.h==null?E.i(U):this.h.push(U),this.u=!0},u.resolve=p,u.reject=function(x){return new u(function(M,U){U(x)})},u.race=function(x){return new u(function(M,U){for(var se=l(x),fe=se.next();!fe.done;fe=se.next())p(fe.value).T(M,U)})},u.all=function(x){var M=l(x),U=M.next();return U.done?p([]):new u(function(se,fe){function Ie(Re){return function(He){Ce[Re]=He,me--,me==0&&se(Ce)}}var Ce=[],me=0;do Ce.push(void 0),me++,p(U.value).T(Ie(Ce.length-1),fe),U=M.next();while(!U.done)})},u});function te(o,u){o instanceof String&&(o+="");var f=0,p=!1,v={next:function(){if(!p&&f<o.length){var E=f++;return{value:u(E,o[E]),done:!1}}return p=!0,{done:!0,value:void 0}}};return v[Symbol.iterator]=function(){return v},v}i("Array.prototype.keys",function(o){return o||function(){return te(this,function(u){return u})}}),i("Array.prototype.fill",function(o){return o||function(u,f,p){var v=this.length||0;for(0>f&&(f=Math.max(0,v+f)),(p==null||p>v)&&(p=v),p=Number(p),0>p&&(p=Math.max(0,v+p)),f=Number(f||0);f<p;f++)this[f]=u;return this}});function X(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",X),i("Uint8Array.prototype.fill",X),i("Uint8ClampedArray.prototype.fill",X),i("Int16Array.prototype.fill",X),i("Uint16Array.prototype.fill",X),i("Int32Array.prototype.fill",X),i("Uint32Array.prototype.fill",X),i("Float32Array.prototype.fill",X),i("Float64Array.prototype.fill",X),i("Object.is",function(o){return o||function(u,f){return u===f?u!==0||1/u===1/f:u!==u&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(u,f){var p=this;p instanceof String&&(p=String(p));var v=p.length;for(f=f||0,0>f&&(f=Math.max(f+v,0));f<v;f++){var E=p[f];if(E===u||Object.is(E,u))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(u,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(u instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(u,f||0)!==-1}});var ee=this||self;function Ee(o,u){o=o.split(".");var f=ee;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||u===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=u}function xe(o){var u;e:{if((u=ee.navigator)&&(u=u.userAgent))break e;u=""}return u.indexOf(o)!=-1}var ge=Array.prototype.map?function(o,u){return Array.prototype.map.call(o,u,void 0)}:function(o,u){for(var f=o.length,p=Array(f),v=typeof o=="string"?o.split(""):o,E=0;E<f;E++)E in v&&(p[E]=u.call(void 0,v[E],E,o));return p},J={},oe=null;function Z(o){var u=o.length,f=3*u/4;f%3?f=Math.floor(f):"=.".indexOf(o[u-1])!=-1&&(f="=.".indexOf(o[u-2])!=-1?f-2:f-1);var p=new Uint8Array(f),v=0;return pe(o,function(E){p[v++]=E}),v!==f?p.subarray(0,v):p}function pe(o,u){function f(U){for(;p<o.length;){var se=o.charAt(p++),fe=oe[se];if(fe!=null)return fe;if(!/^[\s\xa0]*$/.test(se))throw Error("Unknown base64 encoding at char: "+se)}return U}Me();for(var p=0;;){var v=f(-1),E=f(0),x=f(64),M=f(64);if(M===64&&v===-1)break;u(v<<2|E>>4),x!=64&&(u(E<<4&240|x>>2),M!=64&&u(x<<6&192|M))}}function Me(){if(!oe){oe={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),u=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(u[f].split(""));J[f]=p;for(var v=0;v<p.length;v++){var E=p[v];oe[E]===void 0&&(oe[E]=v)}}}}var Be=typeof Uint8Array<"u",Xe=!(xe("Trident")||xe("MSIE"))&&typeof ee.btoa=="function";function Fe(o){if(!Xe){var u;u===void 0&&(u=0),Me(),u=J[u];for(var f=Array(Math.floor(o.length/3)),p=u[64]||"",v=0,E=0;v<o.length-2;v+=3){var x=o[v],M=o[v+1],U=o[v+2],se=u[x>>2];x=u[(x&3)<<4|M>>4],M=u[(M&15)<<2|U>>6],U=u[U&63],f[E++]=se+x+M+U}switch(se=0,U=p,o.length-v){case 2:se=o[v+1],U=u[(se&15)<<2]||p;case 1:o=o[v],f[E]=u[o>>2]+u[(o&3)<<4|se>>4]+U+p}return f.join("")}for(u="";10240<o.length;)u+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return u+=String.fromCharCode.apply(null,o),btoa(u)}var ze=RegExp("[-_.]","g");function Q(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function de(o){if(!Xe)return Z(o);ze.test(o)&&(o=o.replace(ze,Q)),o=atob(o);for(var u=new Uint8Array(o.length),f=0;f<o.length;f++)u[f]=o.charCodeAt(f);return u}var ye;function ve(){return ye||(ye=new Uint8Array(0))}var O={},H=typeof Uint8Array.prototype.slice=="function",q=0,ue=0;function $(o){var u=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),u&&(f=l(P(f,o)),u=f.next().value,o=f.next().value,f=u),q=f>>>0,ue=o>>>0}var y=typeof BigInt=="function";function P(o,u){return u=~u,o?o=~o+1:u+=1,[o,u]}function j(o,u){this.i=o>>>0,this.h=u>>>0}function _(o){if(!o)return I||(I=new j(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)$(Number(o));else if(y)o=BigInt(o),q=Number(o&BigInt(4294967295))>>>0,ue=Number(o>>BigInt(32)&BigInt(4294967295));else{var u=+(o[0]==="-");ue=q=0;for(var f=o.length,p=u,v=(f-u)%6+u;v<=f;p=v,v+=6)p=Number(o.slice(p,v)),ue*=1e6,q=1e6*q+p,4294967296<=q&&(ue+=q/4294967296|0,q%=4294967296);u&&(u=l(P(q,ue)),o=u.next().value,u=u.next().value,q=o,ue=u)}return new j(q,ue)}var I;function z(o,u){return Error("Invalid wire type: "+o+" (at position "+u+")")}function W(){return Error("Failed to read varint, encoding is invalid.")}function ce(o,u){return Error("Tried to read past the end of the data "+u+" > "+o)}function he(){throw Error("Invalid UTF8")}function be(o,u){return u=String.fromCharCode.apply(null,u),o==null?u:o+u}var Te=void 0,$e,Ze=typeof TextDecoder<"u",nt,qe=typeof TextEncoder<"u",at;function Ge(o){if(o!==O)throw Error("illegal external caller")}function Oe(o,u){if(Ge(u),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ue(){return at||(at=new Oe(null,O))}function Ye(o){Ge(O);var u=o.V;return u=u==null||Be&&u!=null&&u instanceof Uint8Array?u:typeof u=="string"?de(u):null,u==null?u:o.V=u}function Et(o){if(typeof o=="string")return{buffer:de(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Oe)return{buffer:Ye(o)||ve(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function vn(o,u){this.i=null,this.m=!1,this.h=this.j=this.l=0,L(this,o,u)}function L(o,u,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,u&&(u=Et(u),o.i=u.buffer,o.m=u.C,o.l=0,o.j=o.i.length,o.h=o.l)}vn.prototype.reset=function(){this.h=this.l};function ae(o,u){if(o.h=u,u>o.j)throw ce(o.j,u)}function ne(o){var u=o.i,f=o.h,p=u[f++],v=p&127;if(p&128&&(p=u[f++],v|=(p&127)<<7,p&128&&(p=u[f++],v|=(p&127)<<14,p&128&&(p=u[f++],v|=(p&127)<<21,p&128&&(p=u[f++],v|=p<<28,p&128&&u[f++]&128&&u[f++]&128&&u[f++]&128&&u[f++]&128&&u[f++]&128)))))throw W();return ae(o,f),v}function re(o,u){if(0>u)throw Error("Tried to read a negative byte length: "+u);var f=o.h,p=f+u;if(p>o.j)throw ce(u,o.j-f);return o.h=p,f}var we=[];function Le(){this.h=[]}Le.prototype.length=function(){return this.h.length},Le.prototype.end=function(){var o=this.h;return this.h=[],o};function ut(o,u,f){for(;0<f||127<u;)o.h.push(u&127|128),u=(u>>>7|f<<25)>>>0,f>>>=7;o.h.push(u)}function De(o,u){for(;127<u;)o.h.push(u&127|128),u>>>=7;o.h.push(u)}function ot(o,u){if(we.length){var f=we.pop();L(f,o,u),o=f}else o=new vn(o,u);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(u)}ot.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},ot.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function vt(o){var u=o.h;if(u.h==u.j)return!1;o.j=o.h.h;var f=ne(o.h)>>>0;if(u=f>>>3,f&=7,!(0<=f&&5>=f))throw z(f,o.j);if(1>u)throw Error("Invalid field number: "+u+" (at position "+o.j+")");return o.l=u,o.i=f,!0}function Qt(o){switch(o.i){case 0:if(o.i!=0)Qt(o);else e:{o=o.h;for(var u=o.h,f=u+10,p=o.i;u<f;)if(!(p[u++]&128)){ae(o,u);break e}throw W()}break;case 1:o=o.h,ae(o,o.h+8);break;case 2:o.i!=2?Qt(o):(u=ne(o.h)>>>0,o=o.h,ae(o,o.h+u));break;case 5:o=o.h,ae(o,o.h+4);break;case 3:u=o.l;do{if(!vt(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=u)throw Error("Unmatched end-group tag");break}Qt(o)}while(!0);break;default:throw z(o.i,o.j)}}var nn=[];function wn(){this.j=[],this.i=0,this.h=new Le}function lr(o,u){u.length!==0&&(o.j.push(u),o.i+=u.length)}function _a(o,u){if(u=u.R){lr(o,o.h.end());for(var f=0;f<u.length;f++)lr(o,Ye(u[f])||ve())}}var ur=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Ar(o,u){return ur?o[ur]|=u:o.A!==void 0?o.A|=u:(Object.defineProperties(o,{A:{value:u,configurable:!0,writable:!0,enumerable:!1}}),u)}function co(o,u){ur?o[ur]&&(o[ur]&=~u):o.A!==void 0&&(o.A&=~u)}function Tt(o){var u;return ur?u=o[ur]:u=o.A,u??0}function _r(o,u){ur?o[ur]=u:o.A!==void 0?o.A=u:Object.defineProperties(o,{A:{value:u,configurable:!0,writable:!0,enumerable:!1}})}function Qu(o){return Ar(o,1),o}function $3(o,u){_r(u,(o|0)&-51)}function Ca(o,u){_r(u,(o|18)&-41)}var Ju={};function ja(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var fo,vp=[];_r(vp,23),fo=Object.freeze(vp);function Zu(o){if(Tt(o.o)&2)throw Error("Cannot mutate an immutable Message")}function qu(o){var u=o.length;(u=u?o[u-1]:void 0)&&ja(u)?u.g=1:(u={},o.push((u.g=1,u)))}function wp(o){var u=o.i+o.G;return o.B||(o.B=o.o[u]={})}function cr(o,u){return u===-1?null:u>=o.i?o.B?o.B[u]:void 0:o.o[u+o.G]}function Cr(o,u,f,p){Zu(o),ho(o,u,f,p)}function ho(o,u,f,p){o.j&&(o.j=void 0),u>=o.i||p?wp(o)[u]=f:(o.o[u+o.G]=f,(o=o.B)&&u in o&&delete o[u])}function ec(o,u,f,p){var v=cr(o,u);Array.isArray(v)||(v=fo);var E=Tt(v);if(E&1||Qu(v),p)E&2||Ar(v,2),f&1||Object.freeze(v);else{p=!(f&2);var x=E&2;f&1||!x?p&&E&16&&!x&&co(v,16):(v=Qu(Array.prototype.slice.call(v)),ho(o,u,v))}return v}function tc(o,u){var f=cr(o,u),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&ho(o,u,p),p}function xp(o,u,f,p,v){o.h||(o.h={});var E=o.h[f],x=ec(o,f,3,v);if(!E){var M=x;E=[];var U=!!(Tt(o.o)&16);x=!!(Tt(M)&2);var se=M;!v&&x&&(M=Array.prototype.slice.call(M));for(var fe=x,Ie=0;Ie<M.length;Ie++){var Ce=M[Ie],me=u,Re=!1;if(Re=Re===void 0?!1:Re,Ce=Array.isArray(Ce)?new me(Ce):Re?new me:void 0,Ce!==void 0){me=Ce.o;var He=Re=Tt(me);x&&(He|=2),U&&(He|=16),He!=Re&&_r(me,He),me=He,fe=fe||!!(2&me),E.push(Ce)}}return o.h[f]=E,U=Tt(M),u=U|33,u=fe?u&-9:u|8,U!=u&&(fe=M,Object.isFrozen(fe)&&(fe=Array.prototype.slice.call(fe)),_r(fe,u),M=fe),se!==M&&ho(o,f,M),(v||p&&x)&&Ar(E,2),p&&Object.freeze(E),E}return v||(v=Object.isFrozen(E),p&&!v?Object.freeze(E):!p&&v&&(E=Array.prototype.slice.call(E),o.h[f]=E)),E}function Na(o,u,f){var p=!!(Tt(o.o)&2);if(u=xp(o,u,f,p,p),o=ec(o,f,3,p),!(p||Tt(o)&8)){for(p=0;p<u.length;p++){if(f=u[p],Tt(f.o)&2){var v=Cp(f,!1);v.j=f}else v=f;f!==v&&(u[p]=v,o[p]=v.o)}Ar(o,8)}return u}function jr(o,u,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);Cr(o,u,f)}function Sp(o,u,f,p,v){Zu(o);var E=xp(o,f,u,!1,!1);return f=p??new f,o=ec(o,u,2,!1),v!=null?(E.splice(v,0,f),o.splice(v,0,f.o)):(E.push(f),o.push(f.o)),f.C()&&co(o,8),f}function Ta(o,u){return o??u}function Nr(o,u,f){return f=f===void 0?0:f,Ta(tc(o,u),f)}var Ma;function D3(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(Tt(o)&128)return o=Array.prototype.slice.call(o),qu(o),o}else{if(Be&&o!=null&&o instanceof Uint8Array)return Fe(o);if(o instanceof Oe){var u=o.V;return u==null?"":typeof u=="string"?u:o.V=Fe(u)}}}return o}function kp(o,u,f,p){if(o!=null){if(Array.isArray(o))o=nc(o,u,f,p!==void 0);else if(ja(o)){var v={},E;for(E in o)v[E]=kp(o[E],u,f,p);o=v}else o=u(o,p);return o}}function nc(o,u,f,p){var v=Tt(o);p=p?!!(v&16):void 0,o=Array.prototype.slice.call(o);for(var E=0;E<o.length;E++)o[E]=kp(o[E],u,f,p);return f(v,o),o}function z3(o){return o.ja===Ju?o.toJSON():D3(o)}function U3(o,u){o&128&&qu(u)}function Ep(o,u,f){if(f=f===void 0?Ca:f,o!=null){if(Be&&o instanceof Uint8Array)return o.length?new Oe(new Uint8Array(o),O):Ue();if(Array.isArray(o)){var p=Tt(o);return p&2?o:u&&!(p&32)&&(p&16||p===0)?(_r(o,p|2),o):(o=nc(o,Ep,p&4?Ca:f,!0),u=Tt(o),u&4&&u&2&&Object.freeze(o),o)}return o.ja===Ju?_p(o):o}}function Ap(o,u,f,p,v,E,x){if(o=o.h&&o.h[f]){if(p=Tt(o),p&2?p=o:(E=ge(o,_p),Ca(p,E),Object.freeze(E),p=E),Zu(u),x=p==null?fo:Qu([]),p!=null){for(E=!!p.length,o=0;o<p.length;o++){var M=p[o];E=E&&!(Tt(M.o)&2),x[o]=M.o}E=(E?8:0)|1,o=Tt(x),(o&E)!==E&&(Object.isFrozen(x)&&(x=Array.prototype.slice.call(x)),_r(x,o|E)),u.h||(u.h={}),u.h[f]=p}else u.h&&(u.h[f]=void 0);ho(u,f,x,v)}else Cr(u,f,Ep(p,E,x),v)}function _p(o){return Tt(o.o)&2||(o=Cp(o,!0),Ar(o.o,2)),o}function Cp(o,u){var f=o.o,p=[];Ar(p,16);var v=o.constructor.h;if(v&&p.push(v),v=o.B,v){p.length=f.length,p.fill(void 0,p.length,f.length);var E={};p[p.length-1]=E}Tt(f)&128&&qu(p),u=u||o.C()?Ca:$3,E=o.constructor,Ma=p,p=new E(p),Ma=void 0,o.R&&(p.R=o.R.slice()),E=!!(Tt(f)&16);for(var x=v?f.length-1:f.length,M=0;M<x;M++)Ap(o,p,M-o.G,f[M],!1,E,u);if(v)for(var U in v)Ap(o,p,+U,v[U],!0,E,u);return p}function xn(o,u,f){o==null&&(o=Ma),Ma=void 0;var p=this.constructor.i||0,v=0<p,E=this.constructor.h,x=!1;if(o==null){o=E?[E]:[];var M=48,U=!0;v&&(p=0,M|=128),_r(o,M)}else{if(!Array.isArray(o)||E&&E!==o[0])throw Error();var se=M=Ar(o,0);if((U=(16&se)!==0)&&((x=(32&se)!==0)||(se|=32)),v){if(128&se)p=0;else if(0<o.length){var fe=o[o.length-1];if(ja(fe)&&"g"in fe){p=0,se|=128,delete fe.g;var Ie=!0,Ce;for(Ce in fe){Ie=!1;break}Ie&&o.pop()}}}else if(128&se)throw Error();M!==se&&_r(o,se)}this.G=(E?0:-1)-p,this.h=void 0,this.o=o;e:{if(E=this.o.length,p=E-1,E&&(E=this.o[p],ja(E))){this.B=E,this.i=p-this.G;break e}u!==void 0&&-1<u?(this.i=Math.max(u,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!v&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){u=U&&!x&&!0,v=this.i;var me;for(U=0;U<f.length;U++)x=f[U],x<v?(x+=this.G,(p=o[x])?jp(p,u):o[x]=fo):(me||(me=wp(this)),(p=me[x])?jp(p,u):me[x]=fo)}}xn.prototype.toJSON=function(){return nc(this.o,z3,U3)},xn.prototype.C=function(){return!!(Tt(this.o)&2)};function jp(o,u){if(Array.isArray(o)){var f=Tt(o),p=1;!u||f&2||(p|=16),(f&p)!==p&&_r(o,f|p)}}xn.prototype.ja=Ju,xn.prototype.toString=function(){return this.o.toString()};function Np(o,u,f){if(f){var p={},v;for(v in f){var E=f[v],x=E.qa;x||(p.J=E.wa||E.oa.W,E.ia?(p.aa=Ip(E.ia),x=function(M){return function(U,se,fe){return M.J(U,se,fe,M.aa)}}(p)):E.ka?(p.Z=Rp(E.da.P,E.ka),x=function(M){return function(U,se,fe){return M.J(U,se,fe,M.Z)}}(p)):x=p.J,E.qa=x),x(u,o,E.da),p={J:p.J,aa:p.aa,Z:p.Z}}}_a(u,o)}var Pa=Symbol();function Tp(o,u,f){return o[Pa]||(o[Pa]=function(p,v){return u(p,v,f)})}function Mp(o){var u=o[Pa];if(!u){var f=sc(o);u=function(p,v){return Lp(p,v,f)},o[Pa]=u}return u}function H3(o){var u=o.ia;if(u)return Mp(u);if(u=o.va)return Tp(o.da.P,u,o.ka)}function G3(o){var u=H3(o),f=o.da,p=o.oa.U;return u?function(v,E){return p(v,E,f,u)}:function(v,E){return p(v,E,f)}}function Pp(o,u){var f=o[u];return typeof f=="function"&&f.length===0&&(f=f(),o[u]=f),Array.isArray(f)&&(mo in f||po in f||0<f.length&&typeof f[0]=="function")?f:void 0}function bp(o,u,f,p,v,E){u.P=o[0];var x=1;if(o.length>x&&typeof o[x]!="number"){var M=o[x++];f(u,M)}for(;x<o.length;){f=o[x++];for(var U=x+1;U<o.length&&typeof o[U]!="number";)U++;switch(M=o[x++],U-=x,U){case 0:p(u,f,M);break;case 1:(U=Pp(o,x))?(x++,v(u,f,M,U)):p(u,f,M,o[x++]);break;case 2:U=x++,U=Pp(o,U),v(u,f,M,U,o[x++]);break;case 3:E(u,f,M,o[x++],o[x++],o[x++]);break;case 4:E(u,f,M,o[x++],o[x++],o[x++],o[x++]);break;default:throw Error("unexpected number of binary field arguments: "+U)}}return u}var ba=Symbol();function Ip(o){var u=o[ba];if(!u){var f=rc(o);u=function(p,v){return Bp(p,v,f)},o[ba]=u}return u}function Rp(o,u){var f=o[ba];return f||(f=function(p,v){return Np(p,v,u)},o[ba]=f),f}var po=Symbol();function W3(o,u){o.push(u)}function V3(o,u,f){o.push(u,f.W)}function Y3(o,u,f,p){var v=Ip(p),E=rc(p).P,x=f.W;o.push(u,function(M,U,se){return x(M,U,se,E,v)})}function K3(o,u,f,p,v,E){var x=Rp(p,E),M=f.W;o.push(u,function(U,se,fe){return M(U,se,fe,p,x)})}function rc(o){var u=o[po];return u||(u=bp(o,o[po]=[],W3,V3,Y3,K3),mo in o&&po in o&&(o.length=0),u)}var mo=Symbol();function X3(o,u){o[0]=u}function Q3(o,u,f,p){var v=f.U;o[u]=p?function(E,x,M){return v(E,x,M,p)}:v}function J3(o,u,f,p,v){var E=f.U,x=Mp(p),M=sc(p).P;o[u]=function(U,se,fe){return E(U,se,fe,M,x,v)}}function Z3(o,u,f,p,v,E,x){var M=f.U,U=Tp(p,v,E);o[u]=function(se,fe,Ie){return M(se,fe,Ie,p,U,x)}}function sc(o){var u=o[mo];return u||(u=bp(o,o[mo]={},X3,Q3,J3,Z3),mo in o&&po in o&&(o.length=0),u)}function Lp(o,u,f){for(;vt(u)&&u.i!=4;){var p=u.l,v=f[p];if(!v){var E=f[0];E&&(E=E[p])&&(v=f[p]=G3(E))}if(!v||!v(u,o,p)){v=u,p=o,E=v.j,Qt(v);var x=v;if(!x.ca){if(v=x.h.h-E,x.h.h=E,x=x.h,v==0)v=Ue();else{if(E=re(x,v),x.S&&x.m)v=x.i.subarray(E,E+v);else{x=x.i;var M=E;v=E+v,v=M===v?ve():H?x.slice(M,v):new Uint8Array(x.subarray(M,v))}v=v.length==0?Ue():new Oe(v,O)}(E=p.R)?E.push(v):p.R=[v]}}}return o}function Bp(o,u,f){for(var p=f.length,v=p%2==1,E=v?1:0;E<p;E+=2)(0,f[E+1])(u,o,f[E]);Np(o,u,v?f[0]:void 0)}function go(o,u){return{U:o,W:u}}var dr=go(function(o,u,f){if(o.i!==5)return!1;o=o.h;var p=o.i,v=o.h,E=p[v],x=p[v+1],M=p[v+2];return p=p[v+3],ae(o,o.h+4),x=(E<<0|x<<8|M<<16|p<<24)>>>0,o=2*(x>>31)+1,E=x>>>23&255,x&=8388607,Cr(u,f,E==255?x?NaN:1/0*o:E==0?o*Math.pow(2,-149)*x:o*Math.pow(2,E-150)*(x+Math.pow(2,23))),!0},function(o,u,f){if(u=tc(u,f),u!=null){De(o.h,8*f+5),o=o.h;var p=+u;p===0?0<1/p?q=ue=0:(ue=0,q=2147483648):isNaN(p)?(ue=0,q=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(ue=0,q=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),ue=0,q=(f|p)>>>0):(u=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-u),p=Math.round(8388608*p),16777216<=p&&++u,ue=0,q=(f|u+127<<23|p&8388607)>>>0)),f=q,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),q3=go(function(o,u,f){if(o.i!==0)return!1;var p=o.h,v=0,E=o=0,x=p.i,M=p.h;do{var U=x[M++];v|=(U&127)<<E,E+=7}while(32>E&&U&128);for(32<E&&(o|=(U&127)>>4),E=3;32>E&&U&128;E+=7)U=x[M++],o|=(U&127)<<E;if(ae(p,M),128>U)p=v>>>0,U=o>>>0,(o=U&2147483648)&&(p=~p+1>>>0,U=~U>>>0,p==0&&(U=U+1>>>0)),p=4294967296*U+(p>>>0);else throw W();return Cr(u,f,o?-p:p),!0},function(o,u,f){u=cr(u,f),u!=null&&(typeof u=="string"&&_(u),u!=null&&(De(o.h,8*f),typeof u=="number"?(o=o.h,$(u),ut(o,q,ue)):(f=_(u),ut(o.h,f.i,f.h))))}),ev=go(function(o,u,f){return o.i!==0?!1:(Cr(u,f,ne(o.h)),!0)},function(o,u,f){if(u=cr(u,f),u!=null&&u!=null)if(De(o.h,8*f),o=o.h,f=u,0<=f)De(o,f);else{for(u=0;9>u;u++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),Fp=go(function(o,u,f){if(o.i!==2)return!1;var p=ne(o.h)>>>0;o=o.h;var v=re(o,p);if(o=o.i,Ze){var E=o,x;(x=$e)||(x=$e=new TextDecoder("utf-8",{fatal:!0})),o=v+p,E=v===0&&o===E.length?E:E.subarray(v,o);try{var M=x.decode(E)}catch(Ie){if(Te===void 0){try{x.decode(new Uint8Array([128]))}catch{}try{x.decode(new Uint8Array([97])),Te=!0}catch{Te=!1}}throw!Te&&($e=void 0),Ie}}else{M=v,p=M+p,v=[];for(var U=null,se,fe;M<p;)se=o[M++],128>se?v.push(se):224>se?M>=p?he():(fe=o[M++],194>se||(fe&192)!==128?(M--,he()):v.push((se&31)<<6|fe&63)):240>se?M>=p-1?he():(fe=o[M++],(fe&192)!==128||se===224&&160>fe||se===237&&160<=fe||((E=o[M++])&192)!==128?(M--,he()):v.push((se&15)<<12|(fe&63)<<6|E&63)):244>=se?M>=p-2?he():(fe=o[M++],(fe&192)!==128||(se<<28)+(fe-144)>>30||((E=o[M++])&192)!==128||((x=o[M++])&192)!==128?(M--,he()):(se=(se&7)<<18|(fe&63)<<12|(E&63)<<6|x&63,se-=65536,v.push((se>>10&1023)+55296,(se&1023)+56320))):he(),8192<=v.length&&(U=be(U,v),v.length=0);M=be(U,v)}return Cr(u,f,M),!0},function(o,u,f){if(u=cr(u,f),u!=null){var p=!1;if(p=p===void 0?!1:p,qe){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(u))throw Error("Found an unpaired surrogate");u=(nt||(nt=new TextEncoder)).encode(u)}else{for(var v=0,E=new Uint8Array(3*u.length),x=0;x<u.length;x++){var M=u.charCodeAt(x);if(128>M)E[v++]=M;else{if(2048>M)E[v++]=M>>6|192;else{if(55296<=M&&57343>=M){if(56319>=M&&x<u.length){var U=u.charCodeAt(++x);if(56320<=U&&57343>=U){M=1024*(M-55296)+U-56320+65536,E[v++]=M>>18|240,E[v++]=M>>12&63|128,E[v++]=M>>6&63|128,E[v++]=M&63|128;continue}else x--}if(p)throw Error("Found an unpaired surrogate");M=65533}E[v++]=M>>12|224,E[v++]=M>>6&63|128}E[v++]=M&63|128}}u=v===E.length?E:E.subarray(0,v)}De(o.h,8*f+2),De(o.h,u.length),lr(o,o.h.end()),lr(o,u)}}),Op=go(function(o,u,f,p,v){if(o.i!==2)return!1;u=Sp(u,f,p),f=o.h.j,p=ne(o.h)>>>0;var E=o.h.h+p,x=E-f;if(0>=x&&(o.h.j=E,v(u,o,void 0,void 0,void 0),x=E-o.h.h),x)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-x)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=E,o.h.j=f,!0},function(o,u,f,p,v){if(u=Na(u,p,f),u!=null)for(p=0;p<u.length;p++){var E=o;De(E.h,8*f+2);var x=E.h.end();lr(E,x),x.push(E.i),E=x,v(u[p],o),x=o;var M=E.pop();for(M=x.i+x.h.length()-M;127<M;)E.push(M&127|128),M>>>=7,x.i++;E.push(M),x.i++}});function ic(o){return function(u,f){e:{if(nn.length){var p=nn.pop();p.setOptions(f),L(p.h,u,f),u=p}else u=new ot(u,f);try{var v=sc(o),E=Lp(new v.P,u,v);break e}finally{v=u.h,v.i=null,v.m=!1,v.l=0,v.j=0,v.h=0,v.S=!1,u.l=-1,u.i=-1,100>nn.length&&nn.push(u)}E=void 0}return E}}function oc(o){return function(){var u=new wn;Bp(this,u,rc(o)),lr(u,u.h.end());for(var f=new Uint8Array(u.i),p=u.j,v=p.length,E=0,x=0;x<v;x++){var M=p[x];f.set(M,E),E+=M.length}return u.j=[f],f}}function oi(o){xn.call(this,o)}K(oi,xn);var $p=[oi,1,ev,2,dr,3,Fp,4,Fp];oi.prototype.l=oc($p);function ac(o){xn.call(this,o,-1,tv)}K(ac,xn),ac.prototype.addClassification=function(o,u){return Sp(this,1,oi,o,u),this};var tv=[1],Dp=ic([ac,1,Op,$p]);function ai(o){xn.call(this,o)}K(ai,xn);var zp=[ai,1,dr,2,dr,3,dr,4,dr,5,dr];ai.prototype.l=oc(zp);function Up(o){xn.call(this,o,-1,nv)}K(Up,xn);var nv=[1],Hp=ic([Up,1,Op,zp]);function Ia(o){xn.call(this,o)}K(Ia,xn);var Gp=[Ia,1,dr,2,dr,3,dr,4,dr,5,dr,6,q3],rv=ic(Gp);Ia.prototype.l=oc(Gp);function Wp(o,u,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,u),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function Vp(o){return Na(o,oi,1).map(function(u){var f=cr(u,1);return{index:f??0,score:Nr(u,2),label:cr(u,3)!=null?Ta(cr(u,3),""):void 0,displayName:cr(u,4)!=null?Ta(cr(u,4),""):void 0}})}function Yp(o){return{x:Nr(o,1),y:Nr(o,2),z:Nr(o,3),visibility:tc(o,4)!=null?Nr(o,4):void 0}}function Kp(o){return o.map(function(u){return Na(Hp(u),ai,1).map(Yp)})}function lc(o,u){this.i=o,this.h=u,this.m=0}function Xp(o,u,f){return sv(o,u),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function sv(o,u){var f=o.h;if(o.s===void 0){var p=Wp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),v=Wp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),E=f.createProgram();if(f.attachShader(E,p),f.attachShader(E,v),f.linkProgram(E),!f.getProgramParameter(E,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(E));p=o.s=E,f.useProgram(p),v=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:v},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(v,0)}p=o.l,f.useProgram(o.s),f.canvas.width=u.width,f.canvas.height=u.height,f.viewport(0,0,u.width,u.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(u.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function iv(o){this.h=o}var ov=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function av(o,u){return u+o}function Qp(o,u){window[o]=u}function lv(o){var u=document.createElement("script");return u.setAttribute("src",o),u.setAttribute("crossorigin","anonymous"),new Promise(function(f){u.addEventListener("load",function(){f()},!1),u.addEventListener("error",function(){f()},!1),document.body.appendChild(u)})}function uv(){return Y(function(o){switch(o.h){case 1:return o.s=2,T(o,WebAssembly.instantiate(ov),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function uc(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||av,typeof window=="object")var u=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")u=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=u,o.options){u=l(Object.keys(o.options));for(var f=u.next();!f.done;f=u.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=uc.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function cv(o){var u,f,p,v,E,x,M,U,se,fe,Ie;return Y(function(Ce){switch(Ce.h){case 1:return o.ga?(u=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,T(Ce,uv(),2)):Ce.return();case 2:if(f=Ce.i,typeof window=="object")return Qp("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),Qp("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),x=u.filter(function(me){return me.data!==void 0}),M=u.filter(function(me){return me.data===void 0}),U=Promise.all(x.map(function(me){var Re=Ra(o,me.url);if(me.path!==void 0){var He=me.path;Re=Re.then(function(pt){return o.overrideFile(He,pt),Promise.resolve(pt)})}return Re})),se=Promise.all(M.map(function(me){return me.simd===void 0||me.simd&&f||!me.simd&&!f?lv(o.locateFile(me.url,o.ha)):Promise.resolve()})).then(function(){var me,Re,He;return Y(function(pt){if(pt.h==1)return me=window.createMediapipeSolutionsWasm,Re=window.createMediapipeSolutionsPackedAssets,He=o,T(pt,me(Re),2);He.i=pt.i,pt.h=0})}),fe=function(){return Y(function(me){return o.h.graph&&o.h.graph.url?me=T(me,Ra(o,o.h.graph.url),0):(me.h=0,me=void 0),me})}(),T(Ce,Promise.all([se,U,fe]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=u.filter(function(me){return me.simd===void 0||me.simd&&f||!me.simd&&!f}).map(function(me){return o.locateFile(me.url,o.ha)}),importScripts.apply(null,d(p)),v=o,T(Ce,createMediapipeSolutionsWasm(Module),6);case 6:v.i=Ce.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,E=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(E),Ce.h=4;break;case 7:if(o.m=document.createElement("canvas"),Ie=o.m.getContext("webgl2",{}),!Ie&&(Ie=o.m.getContext("webgl",{}),!Ie))return alert("Failed to create WebGL canvas context when passing video frame."),Ce.return();o.K=Ie,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,Ce.h=0}})}function dv(o){var u,f,p,v,E,x,M,U;return Y(function(se){if(se.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return se.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){se.h=2;return}return o.fa=o.h.graph.url,T(se,Ra(o,o.h.graph.url),3)}for(se.h!=2&&(u=se.i,o.j.loadGraph(u)),f=l(Object.keys(o.D)),p=f.next();!p.done;p=f.next())v=p.value,o.j.overrideFile(v,o.D[v]);if(o.D={},o.h.listeners)for(E=l(o.h.listeners),x=E.next();!x.done;x=E.next())M=x.value,mv(o,M);U=o.l,o.l={},o.setOptions(U),se.h=0})}e.reset=function(){var o=this;return Y(function(u){o.j&&(o.j.reset(),o.s={},o.v={}),u.h=0})},e.setOptions=function(o,u){var f=this;if(u=u||this.h.options){for(var p=[],v=[],E={},x=l(Object.keys(o)),M=x.next();!M.done;E={X:E.X,Y:E.Y},M=x.next())if(M=M.value,!(M in this.l&&this.l[M]===o[M])){this.l[M]=o[M];var U=u[M];U!==void 0&&(U.onChange&&(E.X=U.onChange,E.Y=o[M],p.push(function(se){return function(){var fe;return Y(function(Ie){if(Ie.h==1)return T(Ie,se.X(se.Y),2);fe=Ie.i,fe===!0&&(f.u=!0),Ie.h=0})}}(E))),U.graphOptionXref&&(M=Object.assign({},{calculatorName:"",calculatorIndex:0},U.graphOptionXref,{valueNumber:U.type===1?o[M]:0,valueBoolean:U.type===0?o[M]:!1,valueString:U.type===2?o[M]:""}),v.push(M)))}(p.length!==0||v.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(v),this.F=(this.F===void 0?[]:this.F).concat(p))}};function fv(o){var u,f,p,v,E,x,M;return Y(function(U){switch(U.h){case 1:if(!o.u)return U.return();if(!o.F){U.h=2;break}u=l(o.F),f=u.next();case 3:if(f.done){U.h=5;break}return p=f.value,T(U,p(),4);case 4:f=u.next(),U.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(v=new o.i.GraphOptionChangeRequestList,E=l(o.H),x=E.next();!x.done;x=E.next())M=x.value,v.push_back(M);o.j.changeOptions(v),v.delete(),o.H=void 0}o.u=!1,U.h=0}})}e.initialize=function(){var o=this;return Y(function(u){return u.h==1?T(u,cv(o),2):u.h!=3?T(u,dv(o),3):T(u,fv(o),0)})};function Ra(o,u){var f,p;return Y(function(v){return u in o.L?v.return(o.L[u]):(f=o.locateFile(u,""),p=fetch(f).then(function(E){return E.arrayBuffer()}),o.L[u]=p,v.return(p))})}e.overrideFile=function(o,u){this.j?this.j.overrideFile(o,u):this.D[o]=u},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,u){var f=this,p,v,E,x,M,U,se,fe,Ie;return Y(function(Ce){switch(Ce.h){case 1:return f.h.inputs?(p=1e3*(u??performance.now()),T(Ce,f.I,2)):Ce.return();case 2:return T(Ce,f.initialize(),3);case 3:for(v=new f.i.PacketDataList,E=l(Object.keys(o)),x=E.next();!x.done;x=E.next())if(M=x.value,U=f.h.inputs[M]){e:{var me=o[M];switch(U.type){case"video":var Re=f.s[U.stream];if(Re||(Re=new lc(f.i,f.K),f.s[U.stream]=Re),Re.m===0&&(Re.m=Re.i.createTexture()),typeof HTMLVideoElement<"u"&&me instanceof HTMLVideoElement)var He=me.videoWidth,pt=me.videoHeight;else typeof HTMLImageElement<"u"&&me instanceof HTMLImageElement?(He=me.naturalWidth,pt=me.naturalHeight):(He=me.width,pt=me.height);pt={glName:Re.m,width:He,height:pt},He=Re.h,He.canvas.width=pt.width,He.canvas.height=pt.height,He.activeTexture(He.TEXTURE0),Re.i.bindTexture2d(Re.m),He.texImage2D(He.TEXTURE_2D,0,He.RGBA,He.RGBA,He.UNSIGNED_BYTE,me),Re.i.bindTexture2d(0),Re=pt;break e;case"detections":for(Re=f.s[U.stream],Re||(Re=new iv(f.i),f.s[U.stream]=Re),Re.data||(Re.data=new Re.h.DetectionListData),Re.data.reset(me.length),pt=0;pt<me.length;++pt){He=me[pt];var ct=Re.data,Jt=ct.setBoundingBox,Wn=pt,Sn=He.la,et=new Ia;if(jr(et,1,Sn.ra),jr(et,2,Sn.sa),jr(et,3,Sn.height),jr(et,4,Sn.width),jr(et,5,Sn.rotation),Cr(et,6,Sn.pa),Sn=et.l(),Jt.call(ct,Wn,Sn),He.ea)for(ct=0;ct<He.ea.length;++ct){et=He.ea[ct],Jt=Re.data,Wn=Jt.addNormalizedLandmark,Sn=pt,et=Object.assign({},et,{visibility:et.visibility?et.visibility:0});var Zt=new ai;jr(Zt,1,et.x),jr(Zt,2,et.y),jr(Zt,3,et.z),et.visibility&&jr(Zt,4,et.visibility),et=Zt.l(),Wn.call(Jt,Sn,et)}if(He.ba)for(ct=0;ct<He.ba.length;++ct)Jt=Re.data,Wn=Jt.addClassification,Sn=pt,et=He.ba[ct],Zt=new oi,jr(Zt,2,et.score),et.index&&Cr(Zt,1,et.index),et.label&&Cr(Zt,3,et.label),et.displayName&&Cr(Zt,4,et.displayName),et=Zt.l(),Wn.call(Jt,Sn,et)}Re=Re.data;break e;default:Re={}}}switch(se=Re,fe=U.stream,U.type){case"video":v.pushTexture2d(Object.assign({},se,{stream:fe,timestamp:p}));break;case"detections":Ie=se,Ie.stream=fe,Ie.timestamp=p,v.pushDetectionList(Ie);break;default:throw Error("Unknown input config type: '"+U.type+"'")}}return f.j.send(v),T(Ce,f.I,4);case 4:v.delete(),Ce.h=0}})};function hv(o,u,f){var p,v,E,x,M,U,se,fe,Ie,Ce,me,Re,He,pt;return Y(function(ct){switch(ct.h){case 1:if(!f)return ct.return(u);for(p={},v=0,E=l(Object.keys(f)),x=E.next();!x.done;x=E.next())M=x.value,U=f[M],typeof U!="string"&&U.type==="texture"&&u[U.stream]!==void 0&&++v;1<v&&(o.M=!1),se=l(Object.keys(f)),x=se.next();case 2:if(x.done){ct.h=4;break}if(fe=x.value,Ie=f[fe],typeof Ie=="string")return He=p,pt=fe,T(ct,pv(o,fe,u[Ie]),14);if(Ce=u[Ie.stream],Ie.type==="detection_list"){if(Ce){for(var Jt=Ce.getRectList(),Wn=Ce.getLandmarksList(),Sn=Ce.getClassificationsList(),et=[],Zt=0;Zt<Jt.size();++Zt){var as=rv(Jt.get(Zt)),gv=Nr(as,1),yv=Nr(as,2),vv=Nr(as,3),wv=Nr(as,4),xv=Nr(as,5,0),La=void 0;La=La===void 0?0:La,as={la:{ra:gv,sa:yv,height:vv,width:wv,rotation:xv,pa:Ta(cr(as,6),La)},ea:Na(Hp(Wn.get(Zt)),ai,1).map(Yp),ba:Vp(Dp(Sn.get(Zt)))},et.push(as)}Jt=et}else Jt=[];p[fe]=Jt,ct.h=7;break}if(Ie.type==="proto_list"){if(Ce){for(Jt=Array(Ce.size()),Wn=0;Wn<Ce.size();Wn++)Jt[Wn]=Ce.get(Wn);Ce.delete()}else Jt=[];p[fe]=Jt,ct.h=7;break}if(Ce===void 0){ct.h=3;break}if(Ie.type==="float_list"){p[fe]=Ce,ct.h=7;break}if(Ie.type==="proto"){p[fe]=Ce,ct.h=7;break}if(Ie.type!=="texture")throw Error("Unknown output config type: '"+Ie.type+"'");return me=o.v[fe],me||(me=new lc(o.i,o.K),o.v[fe]=me),T(ct,Xp(me,Ce,o.M),13);case 13:Re=ct.i,p[fe]=Re;case 7:Ie.transform&&p[fe]&&(p[fe]=Ie.transform(p[fe])),ct.h=3;break;case 14:He[pt]=ct.i;case 3:x=se.next(),ct.h=2;break;case 4:return ct.return(p)}})}function pv(o,u,f){var p;return Y(function(v){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?v.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[u],p||(p=new lc(o.i,o.K),o.v[u]=p),v.return(Xp(p,f,o.M))):v.return(void 0)})}function mv(o,u){for(var f=u.name||"$",p=[].concat(d(u.wants)),v=new o.i.StringList,E=l(u.wants),x=E.next();!x.done;x=E.next())v.push_back(x.value);E=o.i.PacketListener.implement({onResults:function(M){for(var U={},se=0;se<u.wants.length;++se)U[p[se]]=M.get(se);var fe=o.listeners[f];fe&&(o.I=hv(o,U,u.outs).then(function(Ie){Ie=fe(Ie);for(var Ce=0;Ce<u.wants.length;++Ce){var me=U[p[Ce]];typeof me=="object"&&me.hasOwnProperty&&me.hasOwnProperty("delete")&&me.delete()}Ie&&(o.I=Ie)}))}}),o.j.attachMultiListener(v,E),v.delete()}e.onResults=function(o,u){this.listeners[u||"$"]=o},Ee("Solution",uc),Ee("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Jp(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function Zp(o){var u=this;o=o||{},this.h=new uc({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:Jp(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:Kp},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:Kp},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return Vp(Dp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,v,E;return Y(function(x){return x.h==1?(p=Jp(f),v="third_party/mediapipe/modules/hand_landmark/"+p,T(x,Ra(u.h,p),2)):(E=x.i,u.h.overrideFile(v,E),x.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=Zp.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return Y(function(u){return T(u,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var u=this;return Y(function(f){return T(f,u.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},Ee("Hands",Zp),Ee("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),Ee("VERSION","0.4.1675469240")}).call(cc);const Mn=(...e)=>{},Mr={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},Mt={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function hm({hidden:e=!1}){const t=C.useRef(null),n=C.useRef(null),r=C.useRef(null),s=C.useRef(null),[i,a]=C.useState(!1),[l,d]=C.useState("None"),[h,m]=C.useState([]),[w,S]=C.useState(null),[N,R]=C.useState(null),[F,K]=C.useState(null),[A,g]=C.useState({a:null,b:null}),k=C.useRef(null),T=C.useRef(null),b=($,y)=>{const P=localStorage.getItem($);if(P===null)return y;const j=parseFloat(P);return Number.isFinite(j)?j:y},[B,D]=C.useState(()=>({roiSize:(()=>{const $=b(Mt.roiSize,44);return $>10?$:44})(),hueWeight:b(Mt.hueWeight,4),satWeight:b(Mt.satWeight,2),valWeight:b(Mt.valWeight,1),sensitivity:b(Mt.sensitivity,0)})),G=C.useRef(B),le=C.useRef(null),V=C.useRef(!1),Y=C.useRef(0),te=C.useRef(null),[X,ee]=C.useState([]),Ee=C.useRef([]),[xe,ge]=C.useState(()=>localStorage.getItem(Mt.selectedCamera)||""),J=C.useCallback(async()=>{try{const y=(await navigator.mediaDevices.enumerateDevices()).filter(P=>P.kind==="videoinput");return ee(y),Ee.current=y,y}catch{return[]}},[]),oe=C.useCallback($=>{},[Mn]),Z=C.useCallback(async($=null)=>{const y=t.current;if(!y)return;le.current&&(le.current.getTracks().forEach(_=>_.stop()),le.current=null),O();const P=++Y.current;te.current=null;const j=$!==null?$:xe;try{const _=j?{video:{deviceId:{exact:j}}}:{video:!0};if(j){const W=Ee.current.find(ce=>ce.deviceId===j);console.log("[Detector]  Loading SELECTED camera:",{deviceId:j,label:(W==null?void 0:W.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const I=await navigator.mediaDevices.getUserMedia(_);if(!V.current||P!==Y.current){Mn("Stale camera request (unmounted or superseded). Stopping stream."),I.getTracks().forEach(W=>W.stop());return}le.current=I;const z=I.getVideoTracks();if(Mn("getUserMedia success. Tracks:",z),z.length>0){const W=z[0];console.log("[Detector]  Camera loaded successfully:",{label:W.label,deviceId:W.getSettings().deviceId,resolution:`${W.getSettings().width}x${W.getSettings().height}`,frameRate:W.getSettings().frameRate})}if(y.srcObject=I,await new Promise(W=>{if(y.readyState>=1&&y.videoWidth>0&&y.videoHeight>0)return W();const he=()=>{y.removeEventListener("loadedmetadata",he),W()};y.addEventListener("loadedmetadata",he,{once:!0}),setTimeout(()=>{y.removeEventListener("loadedmetadata",he),W()},1500)}),!V.current||P!==Y.current){Mn("Stale request before play(). Stopping stream."),I.getTracks().forEach(W=>W.stop());return}try{await y.play(),Mn("video.play() promise resolved. Video should be playing.")}catch(W){if(console.error("[Detector] video.play() promise rejected:",W),Mn("video.play() promise rejected:",W.name,W.message),P!==Y.current){Mn("play() aborted due to newer request."),I.getTracks().forEach(ce=>ce.stop());return}}if(te.current!==P&&(te.current=P,Mn("Initializing MediaPipe for request id",P),Fe()),V.current){const W=await J();if(!j||!$){const ce=W.find(he=>he.deviceId);ce&&ce.deviceId&&ce.deviceId!==xe&&(ge(ce.deviceId),localStorage.setItem(Mt.selectedCamera,ce.deviceId))}}}catch(_){console.error("[Detector] Error accessing camera:",_),Mn("getUserMedia error:",_.name,_.message)}},[Mn,J,oe,xe]),pe=($,y,P)=>{const j=($||0)*2,_=(y||0)/255,I=(P||0)/255,z=I*_,W=z*(1-Math.abs(j/60%2-1)),ce=I-z;let he=0,be=0,Te=0;j>=0&&j<60?(he=z,be=W,Te=0):j<120?(he=W,be=z,Te=0):j<180?(he=0,be=z,Te=W):j<240?(he=0,be=W,Te=z):j<300?(he=W,be=0,Te=z):(he=z,be=0,Te=W);const $e=Math.round((he+ce)*255),Ze=Math.round((be+ce)*255),nt=Math.round((Te+ce)*255);return`rgb(${$e}, ${Ze}, ${nt})`},Me=$=>$?pe($.h,$.s,$.v):"#ffffff",Be=$=>$==="Player A"&&N?Me(N):$==="Player B"&&F?Me(F):$==="Red"?"#ff0000":$==="Blue"?"#0000ff":"#ffffff";C.useEffect(()=>{V.current=!0;const $=()=>{try{const j=JSON.parse(localStorage.getItem("calibrationA")||"null"),_=JSON.parse(localStorage.getItem("calibrationB")||"null");j&&R({h:j.h,s:j.s,v:j.v}),_&&K({h:_.h,s:_.s,v:_.v})}catch{}},y=j=>{!j||!j.key||(["calibrationA","calibrationB"].includes(j.key)&&$(),[Mt.roiSize,Mt.hueWeight,Mt.satWeight,Mt.valWeight,Mt.sensitivity].includes(j.key)&&D(_=>({roiSize:(()=>{const I=b(Mt.roiSize,(_==null?void 0:_.roiSize)??44);return I>10?I:(_==null?void 0:_.roiSize)??44})(),hueWeight:b(Mt.hueWeight,(_==null?void 0:_.hueWeight)??4),satWeight:b(Mt.satWeight,(_==null?void 0:_.satWeight)??2),valWeight:b(Mt.valWeight,(_==null?void 0:_.valWeight)??1),sensitivity:b(Mt.sensitivity,(_==null?void 0:_.sensitivity)??0)})))};return(async()=>{const j=await J();if(!V.current)return;const _=localStorage.getItem(Mt.selectedCamera);let I="";if(_&&j.some(z=>z.deviceId&&z.deviceId===_)){const z=j.find(W=>W.deviceId===_);I=_,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:_,label:(z==null?void 0:z.label)||"Unknown"})}else{_&&localStorage.removeItem(Mt.selectedCamera);const z=j.find(W=>W.deviceId);z&&z.deviceId?(I=z.deviceId,localStorage.setItem(Mt.selectedCamera,z.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:z.deviceId,label:z.label||"Unknown",savedCameraWas:_||"none"}),Mn("Saved camera not found, using default camera:",z.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}ge(I?z=>z===I?z:I:z=>z||""),$()})(),window.addEventListener("storage",y),()=>{V.current=!1,Y.current+=1,te.current=null,s.current&&(s.current.stop(),s.current=null),le.current&&(le.current.getTracks().forEach(_=>_.stop()),le.current=null);const j=t.current;j&&(j.srcObject=null,oe(j)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",y)}},[]),C.useEffect(()=>{k.current=N},[N]),C.useEffect(()=>{T.current=F},[F]),C.useEffect(()=>{G.current=B},[B]),C.useEffect(()=>{Z(xe||null)},[xe,Z]),C.useEffect(()=>{const $=setInterval(()=>{d(y=>(Xe(y),y))},1e3);return()=>clearInterval($)},[]);const Xe=$=>{const P={timestamp:new Date().toISOString(),status:$};m(_=>[..._,P]);const j=JSON.parse(localStorage.getItem("braceletDetections")||"[]");j.push(P),localStorage.setItem("braceletDetections",JSON.stringify(j))},Fe=async()=>{try{const $=await(async()=>{try{if(typeof Yl.Hands=="function")return Yl.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((P,j)=>{const _="mp-hands-cdn-script";if(document.getElementById(_))return P();const I=document.createElement("script");I.id=_,I.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",I.async=!0,I.onload=()=>P(),I.onerror=z=>j(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(I)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),y=new $({locateFile:P=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${P}`});if(y.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),y.onResults(ze),r.current=y,t.current){const P=t.current;console.log("[Detector]  Starting manual frame capture from video element");let j;const _=async()=>{if(P.readyState>=2&&P.videoWidth>0)try{await y.send({image:P})}catch(I){console.error("[Detector] Error sending frame to MediaPipe:",I)}j=requestAnimationFrame(_)};_(),s.current={stop:()=>{j&&(cancelAnimationFrame(j),console.log("[Detector]  Stopped frame capture"))}}}}catch($){console.error("MediaPipe initialization error:",$),S(`MediaPipe error: ${$.message}`)}},ze=$=>{var z;const y=n.current,P=t.current;if(!y||!P)return;const j=y.getContext("2d");y.width=P.videoWidth,y.height=P.videoHeight,j.drawImage(P,0,0,y.width,y.height);let _="None";if($.multiHandLandmarks&&$.multiHandLandmarks.length>0){Mn("onResults: hands=",$.multiHandLandmarks.length);let W=null,ce=0;if($.multiHandLandmarks.forEach(he=>{const be=he[0];be.y>ce&&(ce=be.y,W=he)}),$.multiHandLandmarks.forEach(he=>{Q(j,he,y.width,y.height)}),W){const he=W[0],be=he.x*y.width,Te=he.y*y.height;j.fillStyle="lime",j.beginPath(),j.arc(be,Te,10,0,2*Math.PI),j.fill(),j.fillStyle="lime",j.font="16px Arial",j.fillText("SELECTED",be-40,Te-15);const Ze=Math.max(10,Math.min(300,Math.floor(((z=G.current)==null?void 0:z.roiSize)||60)))/2,nt=Math.max(0,be-Ze),qe=Math.max(0,Te-Ze),at=Math.min(y.width,be+Ze),Ge=Math.min(y.height,Te+Ze);j.strokeStyle="lime",j.lineWidth=3,j.strokeRect(nt,qe,at-nt,Ge-qe);const Oe=at-nt,Ue=Ge-qe;if(Oe>0&&Ue>0)try{const Ye=j.getImageData(nt,qe,Oe,Ue),Et=k.current,vn=T.current,L=ye(Ye,Et,vn);_=L.status,g({a:L.percentA,b:L.percentB}),Mn("Detection result:",_,{roi:{x1:nt,y1:qe,w:Oe,h:Ue}})}catch(Ye){console.warn("[Detector] Failed to get ROI image data:",Ye.message),_="None",g({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:Oe,height:Ue}),_="None",g({a:null,b:null})}}let I="#ffffff";_==="Player A"&&k.current?I=Me(k.current):_==="Player B"&&T.current&&(I=Me(T.current)),j.fillStyle=I,j.font="bold 32px Arial",j.fillText(`Status: ${_}`,10,40),d(_),typeof window<"u"&&(window.currentBraceletStatus=_,window.braceletDetectorCanvas=y,window.braceletDetectorVideo=P)},Q=($,y,P,j)=>{$.strokeStyle="white",$.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([I,z])=>{const W=y[I],ce=y[z];$.beginPath(),$.moveTo(W.x*P,W.y*j),$.lineTo(ce.x*P,ce.y*j),$.stroke()}),y.forEach(I=>{$.fillStyle="red",$.beginPath(),$.arc(I.x*P,I.y*j,5,0,2*Math.PI),$.fill()})},de=$=>{const y=$.data;let P=0,j=0;for(let _=0;_<y.length;_+=4){const I=y[_],z=y[_+1],W=y[_+2],ce=ve(I,z,W);(ce[0]>=Mr.red.lower1[0]&&ce[0]<=Mr.red.upper1[0]||ce[0]>=Mr.red.lower2[0]&&ce[0]<=Mr.red.upper2[0])&&ce[1]>=Mr.red.lower1[1]&&ce[2]>=Mr.red.lower1[2]&&P++,ce[0]>=Mr.blue.lower[0]&&ce[0]<=Mr.blue.upper[0]&&ce[1]>=Mr.blue.lower[1]&&ce[2]>=Mr.blue.lower[2]&&j++}return{redCount:P,blueCount:j}},ye=($,y,P)=>{var Ze,nt,qe,at;const j=$.data;if(y&&!P)return{status:"Player A",percentA:null,percentB:null};if(P&&!y)return{status:"Player B",percentA:null,percentB:null};const _=((Ze=G.current)==null?void 0:Ze.hueWeight)??4,I=((nt=G.current)==null?void 0:nt.satWeight)??2,z=((qe=G.current)==null?void 0:qe.valWeight)??1,W=((at=G.current)==null?void 0:at.sensitivity)??0;if(y&&P){let Ge=0,Oe=0,Ue=0;for(let L=0;L<j.length;L+=4){const ae=j[L],ne=j[L+1],re=j[L+2],[we,Le,ut]=ve(ae,ne,re),De=Math.min(1,Math.max(0,Le/255)),ot=Math.min(1,Math.max(0,ut/255)),vt=Math.max(.05,.5*De+.5*ot),Qt=Math.min(Math.abs(we-y.h),180-Math.abs(we-y.h)),nn=Math.min(Math.abs(we-P.h),180-Math.abs(we-P.h)),wn=Math.abs(Le-y.s),lr=Math.abs(Le-P.s),_a=Math.abs(ut-y.v),ur=Math.abs(ut-P.v),Ar=Qt*_+wn*I+_a*z,co=nn*_+lr*I+ur*z;Math.min(Ar,co)>180||(Ar<=co?Ge+=vt:Oe+=vt,Ue+=vt)}if(Ue===0)return{status:"None",percentA:0,percentB:0};const Ye=Ge/Math.max(1e-6,Ue),Et=Oe/Math.max(1e-6,Ue),vn=.12*(1+.8*Math.max(0,Math.min(1,W)));return Ye>=vn&&Ye>=Et?{status:"Player A",percentA:Ye,percentB:Et}:Et>=vn&&Et>Ye?{status:"Player B",percentA:Ye,percentB:Et}:{status:"None",percentA:Ye,percentB:Et}}const{redCount:ce,blueCount:he}=de($),be=ce+he;if(be===0)return{status:"None",percentA:0,percentB:0};const Te=ce/be,$e=he/be;return Te>=.15&&Te>=$e?{status:"Player A",percentA:Te,percentB:$e}:$e>=.15&&$e>Te?{status:"Player B",percentA:Te,percentB:$e}:{status:"None",percentA:Te,percentB:$e}},ve=($,y,P)=>{$/=255,y/=255,P/=255;const j=Math.max($,y,P),_=Math.min($,y,P),I=j-_;let z=0;I!==0&&(j===$?z=60*((y-P)/I%6):j===y?z=60*((P-$)/I+2):z=60*(($-y)/I+4)),z<0&&(z+=360);const W=j===0?0:I/j*255,ce=j*255;return[z/2,W,ce]},O=$=>{},H=$=>{ge($),$?localStorage.setItem(Mt.selectedCamera,$):localStorage.removeItem(Mt.selectedCamera)},q=()=>{const $=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),y=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),P=URL.createObjectURL(y),j=document.createElement("a");j.href=P,j.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,j.click();const _=$.map(ce=>`${ce.timestamp}: ${ce.status}`).join(`
`),I=new Blob([_],{type:"text/plain"}),z=URL.createObjectURL(I),W=document.createElement("a");W.href=z,W.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,W.click()},ue=()=>{localStorage.removeItem("braceletDetections"),m([])};return c.jsx(c.Fragment,{children:c.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[c.jsxs("div",{className:"detector-header",children:[c.jsx("span",{children:"Bracelet Detector"}),c.jsxs("div",{className:"detector-controls",children:[c.jsx("button",{onClick:q,title:"Download Logs",children:""}),c.jsx("button",{onClick:ue,title:"Clear Logs",children:""}),c.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),c.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[c.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[c.jsx("span",{children:"Camera:"}),c.jsxs("select",{value:xe,onChange:$=>H($.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[c.jsx("option",{value:"",children:"System Default"}),X.map(($,y)=>{var W;const P=!!$.deviceId,j=P?$.deviceId:"",_=P?$.deviceId:`camera-${y}`,I=((W=$.label)==null?void 0:W.trim())||`Camera ${y+1}`,z=P?`  ${$.deviceId.slice(0,8)}`:" (needs permission)";return c.jsxs("option",{value:j,disabled:!P,children:[I,z]},_)})]})]}),c.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),c.jsx("canvas",{ref:n,className:"output_canvas"}),c.jsxs("div",{className:"detector-info",children:[c.jsxs("div",{className:"status-display",children:["Status: ",c.jsx("span",{style:{color:Be(l),fontWeight:700},children:l})]}),c.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[c.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),c.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:N?Me(N):"#444"}}),c.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:A.a==null?"":`${Math.round(Math.max(0,Math.min(1,A.a))*100)}%`})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[c.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),c.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:F?Me(F):"#444"}}),c.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:A.b==null?"":`${Math.round(Math.max(0,Math.min(1,A.b))*100)}%`})]})]}),c.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),c.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[c.jsxs("div",{children:["A: ",N?`h${Math.round(N.h)} s${Math.round(N.s)} v${Math.round(N.v)}`:""]}),c.jsxs("div",{children:["B: ",F?`h${Math.round(F.h)} s${Math.round(F.s)} v${Math.round(F.v)}`:""]})]})]})]})]})})}const $c=(...e)=>{console.log("[Calibrate]",...e)},Pr={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},o5=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,l=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,m=0,w=0;r>=0&&r<60?(h=a,m=l,w=0):r<120?(h=l,m=a,w=0):r<180?(h=0,m=a,w=l):r<240?(h=0,m=l,w=a):r<300?(h=l,m=0,w=a):(h=a,m=0,w=l);const S=Math.round((h+d)*255),N=Math.round((m+d)*255),R=Math.round((w+d)*255);return`rgb(${S}, ${N}, ${R})`},pm=e=>e?o5(e.h,e.s,e.v):"#444";function a5(){const e=C.useRef(null),t=C.useRef(null),n=C.useRef(null),r=C.useRef(!1),s=C.useRef(0),[i,a]=C.useState(!1),[l,d]=C.useState(""),[h,m]=C.useState(null),[w,S]=C.useState(null),N=(Q,de)=>{const ye=localStorage.getItem(Q);if(ye===null)return de;const ve=parseFloat(ye);return Number.isFinite(ve)?ve:de},[R,F]=C.useState(()=>{const Q=N(Pr.roiSize,44);return Q>10?Q:44}),[K,A]=C.useState(()=>N(Pr.hueWeight,4)),[g,k]=C.useState(()=>N(Pr.satWeight,2)),[T,b]=C.useState(()=>N(Pr.valWeight,1)),[B,D]=C.useState(()=>N(Pr.sensitivity,0)),[G,le]=C.useState(!1),[V,Y]=C.useState("idle"),[te,X]=C.useState(5),ee=C.useRef({A:[],B:[]});C.useEffect(()=>{r.current=!0;try{const Q=JSON.parse(localStorage.getItem("calibrationA")||"null"),de=JSON.parse(localStorage.getItem("calibrationB")||"null");Q&&m(Q),de&&S(de)}catch{}return(async()=>await Ee())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(de=>de.stop()),n.current=null);const Q=e.current;Q&&(Q.srcObject=null)}},[]),C.useEffect(()=>{localStorage.setItem(Pr.roiSize,String(R))},[R]),C.useEffect(()=>{localStorage.setItem(Pr.hueWeight,String(K))},[K]),C.useEffect(()=>{localStorage.setItem(Pr.satWeight,String(g))},[g]),C.useEffect(()=>{localStorage.setItem(Pr.valWeight,String(T))},[T]),C.useEffect(()=>{localStorage.setItem(Pr.sensitivity,String(B))},[B]);const Ee=C.useCallback(async()=>{const Q=e.current;if(!Q)return;n.current&&(n.current.getTracks().forEach(ye=>ye.stop()),n.current=null);const de=++s.current;a(!1),d("Requesting camera...");try{const ye=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||de!==s.current){ye.getTracks().forEach(ve=>ve.stop());return}if(n.current=ye,Q.srcObject=ye,await new Promise(ve=>{if(Q.readyState>=1&&Q.videoWidth>0)return ve();const H=()=>{Q.removeEventListener("loadedmetadata",H),ve()};Q.addEventListener("loadedmetadata",H,{once:!0}),setTimeout(()=>{Q.removeEventListener("loadedmetadata",H),ve()},1500)}),!r.current||de!==s.current){ye.getTracks().forEach(ve=>ve.stop());return}try{await Q.play(),$c("video.play resolved")}catch(ve){$c("video.play rejected",ve)}a(!0),d("")}catch(ye){d(`Camera error: ${(ye==null?void 0:ye.message)||ye}`),$c("getUserMedia error",ye)}},[]),xe=(Q,de,ye)=>{Q/=255,de/=255,ye/=255;const ve=Math.max(Q,de,ye),O=Math.min(Q,de,ye),H=ve-O;let q=0;H!==0&&(ve===Q?q=60*((de-ye)/H%6):ve===de?q=60*((ye-Q)/H+2):q=60*((Q-de)/H+4)),q<0&&(q+=360);const ue=ve===0?0:H/ve*255,$=ve*255;return[q/2,ue,$]},ge=()=>{const Q=e.current,de=t.current;if(!Q||!de||Q.videoWidth===0)return null;const ye=Q.videoWidth,ve=Q.videoHeight;de.width=ye,de.height=ve;const O=de.getContext("2d");O.drawImage(Q,0,0,ye,ve);const H=Math.max(10,Math.min(300,Math.floor(R))),q=Math.floor(ye/2-H/2),ue=Math.floor(ve/2-H/2),y=O.getImageData(q,ue,H,H).data;let P=0,j=0,_=0,I=0,z=0;for(let nt=0;nt<y.length;nt+=4){const[qe,at,Ge]=xe(y[nt],y[nt+1],y[nt+2]),Oe=qe*2*(Math.PI/180);P+=Math.cos(Oe),j+=Math.sin(Oe),_+=at,I+=Ge,z++}if(z===0)return null;const W=_/z,ce=I/z,he=P/z,be=j/z;let $e=Math.atan2(be,he)*(180/Math.PI);return $e<0&&($e+=360),{h:$e/2,s:W,v:ce}},J=Q=>{const de=ge();if(!de){d("Could not sample video frame.");return}Q==="A"?(localStorage.setItem("calibrationA",JSON.stringify(de)),m(de),d(`Saved Player A: h${de.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(de)),S(de),d(`Saved Player B: h${de.h.toFixed(0)}`))},oe=Q=>{Q==="A"?(localStorage.removeItem("calibrationA"),m(null)):(localStorage.removeItem("calibrationB"),S(null)),d("Cleared")},Z=()=>{le(!0),Y("playerA"),X(5),ee.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};C.useEffect(()=>{if(!(!G||V==="idle"||V==="optimizing"||V==="complete"))if(te>0){const Q=setTimeout(()=>{X(te-1)},1e3);return()=>clearTimeout(Q)}else V==="playerA"?(Y("switching"),X(3),d("Switch to Player B... Get ready!")):V==="switching"?(Y("playerB"),X(5),d("Hold Player B bracelet in center square...")):V==="playerB"&&(Y("optimizing"),pe())},[G,V,te]),C.useEffect(()=>{if(!G||V==="idle"||V==="switching"||V==="optimizing"||V==="complete")return;const Q=setInterval(()=>{const de=ge();de&&(V==="playerA"?ee.current.A.push(de):V==="playerB"&&ee.current.B.push(de))},200);return()=>clearInterval(Q)},[G,V]);const pe=()=>{d("Optimizing parameters...");const Q=ee.current.A,de=ee.current.B;if(Q.length===0||de.length===0){d("Error: Not enough samples collected!"),le(!1),Y("idle");return}const ye=Me(Q),ve=Me(de),O=Math.min(Math.abs(ye.h-ve.h),180-Math.abs(ye.h-ve.h)),H=Math.abs(ye.s-ve.s),q=Math.abs(ye.v-ve.v),ue=O/90,$=H/255,y=q/255,P=Be(Q),j=Be(de),_={h:(P.h+j.h)/2,s:(P.s+j.s)/2,v:(P.v+j.v)/2},I=ue+$+y,z=I>0?ue/I*(1/(1+_.h/20))*6:2,W=I>0?$/I*(1/(1+_.s/50))*4:1,ce=I>0?y/I*(1/(1+_.v/50))*3:.5;A(Math.max(.5,Math.min(6,z))),k(Math.max(.1,Math.min(4,W))),b(Math.max(.1,Math.min(3,ce)));const he=Xe(Q,de,ye,ve),be=Math.max(0,Math.min(.8,he*.5));D(be),localStorage.setItem("calibrationA",JSON.stringify(ye)),localStorage.setItem("calibrationB",JSON.stringify(ve)),m(ye),S(ve),Y("complete"),d(` Auto-calibration complete! Collected ${Q.length+de.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{le(!1),Y("idle")},3e3)},Me=Q=>{const de=Q.map(j=>j.h),ye=Q.map(j=>j.s).sort((j,_)=>j-_),ve=Q.map(j=>j.v).sort((j,_)=>j-_);let O=0,H=0;de.forEach(j=>{const _=j*2*(Math.PI/180);O+=Math.cos(_),H+=Math.sin(_)});let ue=Math.atan2(H/de.length,O/de.length)*(180/Math.PI);ue<0&&(ue+=360);const $=ue/2,y=ye[Math.floor(ye.length/2)],P=ve[Math.floor(ve.length/2)];return{h:$,s:y,v:P}},Be=Q=>{const de=Q.reduce((ve,O)=>({h:ve.h+O.h,s:ve.s+O.s,v:ve.v+O.v}),{h:0,s:0,v:0});de.h/=Q.length,de.s/=Q.length,de.v/=Q.length;const ye=Q.reduce((ve,O)=>({h:ve.h+Math.pow(O.h-de.h,2),s:ve.s+Math.pow(O.s-de.s,2),v:ve.v+Math.pow(O.v-de.v,2)}),{h:0,s:0,v:0});return{h:ye.h/Q.length,s:ye.s/Q.length,v:ye.v/Q.length}},Xe=(Q,de,ye,ve)=>{let O=0;const H=Math.min(Q.length,de.length)*2;return Q.forEach(q=>{const ue=Fe(q,ye);Fe(q,ve)<ue*1.5&&O++}),de.forEach(q=>{const ue=Fe(q,ye),$=Fe(q,ve);ue<$*1.5&&O++}),O/H},Fe=(Q,de)=>{const ye=Math.min(Math.abs(Q.h-de.h),180-Math.abs(Q.h-de.h)),ve=Math.abs(Q.s-de.s),O=Math.abs(Q.v-de.v);return Math.sqrt(ye*ye+ve*ve+O*O)},ze=()=>{le(!1),Y("idle"),X(5),d("Generic mode cancelled")};return c.jsxs("div",{className:"calib-root",children:[c.jsxs("div",{className:"calib-header",children:[c.jsx("h2",{children:"Color Calibration"}),c.jsxs("div",{className:"calib-actions",children:[c.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),c.jsx("button",{onClick:Ee,children:"Restart Camera"})]})]}),l&&c.jsx("div",{className:"calib-message",children:l}),c.jsxs("div",{className:"calib-content",children:[c.jsx("div",{children:c.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[c.jsx("div",{className:"label",children:"Live Preview"}),c.jsx("div",{className:"value",style:{marginBottom:8},children:G?`Generic Mode Active: ${V==="playerA"?"Player A":V==="switching"?"Switching...":V==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),c.jsxs("div",{className:"calib-video-wrap",children:[c.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),c.jsx("div",{className:"calib-center-box",style:{width:R,height:R,borderColor:"#22d3ee",borderWidth:G?"4px":"3px",boxShadow:G?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),G&&te>0&&c.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:te})]})]})}),c.jsxs("div",{className:"calib-controls",children:[c.jsxs("div",{className:"calib-block",style:{background:G?"#1a2332":"#0f172a",border:G?"2px solid #22d3ee":"1px solid #1f2937"},children:[c.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),c.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),G?c.jsxs("div",{style:{marginTop:8},children:[c.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[V==="playerA"&&`Player A: Hold bracelet steady... ${te}s`,V==="switching"&&`Switch hands! Get Player B ready... ${te}s`,V==="playerB"&&`Player B: Hold bracelet steady... ${te}s`,V==="optimizing"&&"Optimizing parameters...",V==="complete"&&" Complete!"]}),c.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[V==="playerA"&&`Samples collected: ${ee.current.A.length}`,V==="switching"&&`Player A: ${ee.current.A.length} samples collected`,V==="playerB"&&`Samples collected: ${ee.current.B.length}`]}),V!=="complete"&&c.jsx("button",{onClick:ze,style:{background:"#ef4444"},children:"Cancel"})]}):c.jsx("div",{className:"buttons",children:c.jsx("button",{onClick:Z,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),c.jsxs("div",{className:"calib-block",children:[c.jsx("div",{className:"label",children:"Detector Settings"}),c.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[c.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[c.jsx("span",{children:"Detection square size"}),c.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:R,onChange:Q=>F(Number(Q.target.value))}),c.jsxs("span",{style:{textAlign:"right"},children:[R,"px"]})]}),c.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[c.jsx("span",{children:"Hue weight"}),c.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:K,onChange:Q=>A(Number(Q.target.value))}),c.jsx("span",{style:{textAlign:"right"},children:K.toFixed(1)})]}),c.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[c.jsx("span",{children:"Saturation weight"}),c.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:g,onChange:Q=>k(Number(Q.target.value))}),c.jsx("span",{style:{textAlign:"right"},children:g.toFixed(1)})]}),c.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[c.jsx("span",{children:"Value weight"}),c.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:T,onChange:Q=>b(Number(Q.target.value))}),c.jsx("span",{style:{textAlign:"right"},children:T.toFixed(1)})]}),c.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[c.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),c.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:B,onChange:Q=>D(Number(Q.target.value))}),c.jsxs("span",{style:{textAlign:"right"},children:[(B*100).toFixed(0),"%"]})]}),c.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),c.jsxs("div",{className:"calib-block",children:[c.jsx("div",{className:"label",children:"Player A"}),c.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:pm(h)}}),c.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),c.jsxs("div",{className:"buttons",children:[c.jsx("button",{onClick:()=>J("A"),disabled:!i,children:"Save A"}),c.jsx("button",{onClick:()=>oe("A"),children:"Clear A"})]})]}),c.jsxs("div",{className:"calib-block",children:[c.jsx("div",{className:"label",children:"Player B"}),c.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:pm(w)}}),c.jsx("span",{children:w?`h${w.h.toFixed(0)} s${w.s.toFixed(0)} v${w.v.toFixed(0)}`:""})]}),c.jsxs("div",{className:"buttons",children:[c.jsx("button",{onClick:()=>J("B"),disabled:!i,children:"Save B"}),c.jsx("button",{onClick:()=>oe("B"),children:"Clear B"})]})]})]})]}),c.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function Wg({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var $;const[a,l]=C.useState(e),[d,h]=C.useState(0),[m,w]=C.useState(!1),[S,N]=C.useState(1),[R,F]=C.useState(Go()),[K,A]=C.useState(!0),[g,k]=C.useState([]),[T,b]=C.useState(null),[B,D]=C.useState(!1),G=C.useRef(null),le=C.useRef(null),V=C.useRef(null),Y=n&&!e,te=["summary-container",r].filter(Boolean).join(" "),X=(y,P)=>{const j=V.current;if(!j)return 0;const _=j.offsetHeight;return(y+.5)*_},ee=C.useCallback((y,P=null)=>{const j=P||a;if(!j)return;let _=Go(),I=!0;const z=[];let W=null;for(let ce=0;ce<=y&&ce<j.moves.length;ce++){const he=j.moves[ce];he.phase==="experiment"&&I&&(I=!1,_=Go());const be=he.all_positions||(he.allPositions?he.allPositions.map(Te=>[Te[0]*.07,Te[1]*.07]):null);if(he.type==="moveblock"&&be)be.length===10&&_.length===10?_=_.map((Te,$e)=>{const Ze=be[$e];return Ze&&Array.isArray(Ze)&&Ze.length===2?{...Te,position:[Ze[0],Ze[1]]}:Te}):console.warn(`Position count mismatch: blocks=${_.length}, positions=${be==null?void 0:be.length}`),_=Qd(Xd(_),I),W=he.blockId!==void 0?he.blockId:he.unit;else if(he.type==="added shape to gallery"&&he.gallery_normalized){const Te=document.createElement("canvas");Te.width=400,Te.height=400;const $e=Te.getContext("2d");$e.fillStyle="#000",$e.fillRect(0,0,400,400),he.gallery_normalized.forEach(Ze=>{const nt=(Ze[0]+.5)*400,qe=(Ze[1]+.5)*400;$e.fillStyle="green";const at=60;$e.fillRect(nt-at/2,qe-at/2,at,at)}),z.push({number:he.gallery_shape_number,image:Te.toDataURL()}),W=null}}F(_),A(I),k(z),b(W)},[a]),Ee=y=>{l(y),h(0),w(!1),setTimeout(()=>{ee(0,y)},0)},xe=y=>{if(!Y)return;const P=y.target.files[0];if(!P)return;const j=new FileReader;j.onload=_=>{try{const I=JSON.parse(_.target.result);Ee(I)}catch(I){alert("Failed to parse JSON file: "+I.message)}},j.readAsText(P)};C.useEffect(()=>{e&&Ee(e)},[e]),C.useEffect(()=>{a&&d>=0&&ee(d)},[a,d,ee]),C.useEffect(()=>{const y=()=>{a&&d>=0&&setTimeout(()=>{ee(d)},100)};return window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[a,d,ee]);const ge=y=>{a&&(y<0||y>=a.moves.length||(ee(y),h(y)))},J=()=>{if(!a||m)return;w(!0),h(0),ee(0);let y=0;le.current=setInterval(()=>{if(y>=a.moves.length){oe();return}y++,ee(y),h(y)},1e3/S)},oe=()=>{le.current&&(clearInterval(le.current),le.current=null),w(!1)};if(C.useEffect(()=>()=>{le.current&&clearInterval(le.current)},[]),C.useEffect(()=>{if(m&&le.current){clearInterval(le.current),le.current=null;const y=d;h(0),w(!1),setTimeout(()=>{h(y),J()},0)}},[S]),!a)return Y?c.jsx("div",{className:te,children:c.jsxs("div",{className:"summary-upload",children:[c.jsx("h1",{children:t}),c.jsx("p",{children:"Load a game session JSON file to view the replay"}),c.jsx("input",{ref:G,type:"file",accept:".json",onChange:xe,style:{display:"none"}}),c.jsx("button",{onClick:()=>{var y;return(y=G.current)==null?void 0:y.click()},children:"Load JSON File"})]})}):null;const Z=a.moves[d],pe=a.moves.length,Me=(($=a.summary)==null?void 0:$.movesByPlayer)||{},Be=Object.entries(Me||{}),Xe=(y,P=1)=>Number.isFinite(y)?y.toFixed(P):"",Fe=a.sessionInfo||{},ze=Fe.subjectId||Fe.id||a.subjectId||a.id||null,Q=Fe.sessionGameId||a.sessionGameId||ze||null,de=Fe.condition||a.condition||null,ye=a.startTime||Fe.startedAt||Fe.date||null,ve=a.endTime||Fe.endedAt||null,O=y=>{if(!y)return null;try{const P=new Date(y);if(!Number.isNaN(P.getTime()))return P.toLocaleString()}catch{}return y},H=[];Q&&H.push({label:"Session ID",value:Q}),ze&&ze!==Q&&H.push({label:"Participant",value:ze}),de&&H.push({label:"Condition",value:de});const q=O(ye);q&&H.push({label:"Start",value:q});const ue=O(ve);return ue&&H.push({label:"End",value:ue}),c.jsxs("div",{className:te,children:[c.jsxs("div",{className:"summary-header",children:[c.jsx("h1",{children:t}),H.length>0&&c.jsx("div",{className:"summary-session-info",children:H.map(y=>c.jsxs("div",{className:"summary-session-info-item",children:[c.jsx("span",{className:"summary-session-info-label",children:y.label}),c.jsx("span",{className:"summary-session-info-value",children:y.value})]},`${y.label}-${y.value}`))})]}),c.jsxs("div",{className:"summary-main",children:[c.jsxs("div",{className:"summary-left",children:[c.jsx("div",{className:"summary-game-area",children:c.jsxs("div",{className:"game-canvas",ref:V,children:[c.jsx("div",{className:"gallery",children:c.jsx("div",{className:"gallery-frame",children:g.length>0?c.jsx("img",{src:g[g.length-1].image,alt:"Gallery",className:"gallery-image"}):c.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),R.map((y,P)=>{const j=y.position||[0,0];return!Array.isArray(j)||j.length!==2||!Number.isFinite(j[0])||!Number.isFinite(j[1])?(console.warn(`Invalid position for block ${y.id}:`,j),null):c.jsx("div",{className:`block ${y.canMove?"movable":""} ${y.id===T?"highlighted":""}`,style:{left:`${X(j[0])}px`,top:`${X(j[1])}px`,backgroundColor:y.color||"green",cursor:y.canMove?"grab":"default",zIndex:y.id===T?20:P+1}},y.id)})]})}),c.jsxs("div",{className:"summary-progress",children:[c.jsx("input",{type:"range",min:"0",max:Math.max(0,pe-1),value:d,onChange:y=>ge(parseInt(y.target.value)),style:{width:"100%"}}),c.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",pe,Z&&c.jsxs("span",{className:"move-info",children:[" "," Player: ",Z.player,Array.isArray(Z.position)&&Z.position.length===2&&`  Position: (${Z.position[0]}, ${Z.position[1]})`,Number.isFinite(Z.holdTime)&&`  Hold: ${Xe(Z.holdTime,2)}s`," "," Time: ",Xe(Z.elapsed,1),"s"]})]})]})]}),c.jsxs("div",{className:"summary-right",children:[c.jsxs("div",{className:"summary-stats",children:[c.jsxs("div",{className:"summary-stats-row",children:[c.jsx("span",{className:"summary-stats-label",children:"Duration"}),c.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),c.jsxs("div",{className:"summary-stats-row",children:[c.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),c.jsx("span",{className:"summary-stats-value",children:pe})]}),c.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[c.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),c.jsx("div",{className:"summary-stats-value",children:Be.length===0?c.jsx("span",{children:""}):Be.map(([y,P])=>c.jsxs("div",{children:[y,": ",P]},y))})]})]}),c.jsxs("div",{className:"summary-controls",children:[c.jsx("button",{onClick:()=>ge(0),disabled:d===0,children:" First"}),c.jsx("button",{onClick:()=>ge(d-1),disabled:d===0,children:" Previous"}),c.jsx("button",{onClick:m?oe:J,children:m?" Pause":" Play"}),c.jsx("button",{onClick:()=>ge(d+1),disabled:d>=pe-1,children:" Next"}),c.jsx("button",{onClick:()=>ge(pe-1),disabled:d>=pe-1,children:" Last"}),c.jsxs("div",{className:"speed-control",children:[c.jsx("label",{children:"Speed:"}),c.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:S,onChange:y=>N(parseFloat(y.target.value))}),c.jsxs("span",{children:[S,"x"]})]}),Y&&c.jsxs(c.Fragment,{children:[c.jsx("input",{ref:G,type:"file",accept:".json",onChange:xe,style:{display:"none"}}),c.jsx("button",{onClick:()=>{var y;return(y=G.current)==null?void 0:y.click()},children:" Load New File"})]})]}),c.jsxs("div",{className:"summary-moves-list",children:[c.jsxs("div",{className:"move-list-header",children:[c.jsx("h2",{children:"Move History"}),i&&c.jsx("button",{className:`edit-mode-toggle ${B?"active":""}`,onClick:()=>D(!B),children:B?" Done Editing":"Edit Players"})]}),c.jsx("div",{className:"moves-scroll",children:a.moves.map((y,P)=>c.jsxs("div",{className:`move-item ${P===d?"active":""} ${B?"edit-mode":""}`,onClick:()=>!B&&ge(P),children:[c.jsx("div",{className:"move-number",children:P+1}),y.camera_frame&&c.jsx("div",{className:"move-camera-frame",children:c.jsx("img",{src:y.camera_frame,alt:`Camera frame for move ${P+1}`,className:"camera-frame-thumbnail"})}),c.jsxs("div",{className:"move-details",children:[c.jsx("div",{className:"move-type",children:y.type}),B&&i?c.jsxs("div",{className:"move-player-edit",children:[c.jsx("label",{children:"Player:"}),c.jsxs("select",{value:y.player||"Unknown",onChange:j=>{const _=j.target.value;i(y._id,_)},onClick:j=>j.stopPropagation(),children:[c.jsx("option",{value:"Player A",children:"Player A"}),c.jsx("option",{value:"Player B",children:"Player B"}),c.jsx("option",{value:"None",children:"None"}),c.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):c.jsxs("div",{className:"move-player",children:["Player: ",y.player]}),y.blockId!==null&&y.blockId!==void 0||y.unit!==null&&y.unit!==void 0?c.jsxs("div",{className:"move-unit",children:["Block: ",y.blockId!==void 0?y.blockId:y.unit]}):null,Array.isArray(y.position)&&y.position.length===2&&c.jsxs("div",{className:"move-position",children:["Position: (",y.position[0],", ",y.position[1],")"]}),Number.isFinite(y.holdTime)&&y.holdTime>0&&c.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",Xe(y.holdTime,2),"s"]}),c.jsxs("div",{className:"move-time",children:["Time: ",Xe(y.elapsed,1),"s"]})]})]},P))})]})]})]})]})}const Wt=(...e)=>{console.log("[Detector2]",...e)},un={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function l5(){const e=C.useRef(null),t=C.useRef(null),n=C.useRef(null),r=C.useRef(null),s=C.useRef(null),i=C.useRef(null),a=C.useRef(null),l=C.useRef(null),d=C.useRef(null),[h,m]=C.useState(""),[w,S]=C.useState(!1),[N,R]=C.useState({camA:"None",camB:"None",merged:"None"}),[F,K]=C.useState(!0),[A,g]=C.useState(null),[k,T]=C.useState(null),b=C.useRef(null),B=C.useRef(null),D=(y,P)=>{const j=localStorage.getItem(y);if(j===null)return P;const _=parseFloat(j);return Number.isFinite(_)?_:P},[G,le]=C.useState(()=>({roiSize:(()=>{const y=D(un.roiSize,44);return y>10?y:44})(),hueWeight:D(un.hueWeight,4),satWeight:D(un.satWeight,2),valWeight:D(un.valWeight,1),sensitivity:D(un.sensitivity,0)})),V=C.useRef(G),[Y,te]=C.useState([]),[X,ee]=C.useState(""),[Ee,xe]=C.useState("");C.useEffect(()=>{let y=!0;(async()=>{try{const I=(await navigator.mediaDevices.enumerateDevices()).filter(W=>W.kind==="videoinput");if(I.length===0){m("No cameras found");return}te(I);const z=I.slice(0,2).map(W=>W.deviceId);ee(z[0]||""),xe(z[1]||z[0]||""),await ge(z[0],e,l),z[1]?await ge(z[1],t,d):await ge(z[0],t,d),await Xe(),await Fe("A",e,i),await Fe("B",t,a)}catch(_){if(!y)return;m((_==null?void 0:_.message)||String(_))}})();const P=()=>{try{const _=JSON.parse(localStorage.getItem("calibrationA")||"null"),I=JSON.parse(localStorage.getItem("calibrationB")||"null");_&&g({h:_.h,s:_.s,v:_.v}),I&&T({h:I.h,s:I.s,v:I.v})}catch{Wt("No existing calibrations")}};P();const j=_=>{!_||!_.key||(["calibrationA","calibrationB"].includes(_.key)&&P(),[un.roiSize,un.hueWeight,un.satWeight,un.valWeight,un.sensitivity].includes(_.key)&&le(I=>({roiSize:(()=>{const z=D(un.roiSize,(I==null?void 0:I.roiSize)??44);return z>10?z:(I==null?void 0:I.roiSize)??44})(),hueWeight:D(un.hueWeight,(I==null?void 0:I.hueWeight)??4),satWeight:D(un.satWeight,(I==null?void 0:I.satWeight)??2),valWeight:D(un.valWeight,(I==null?void 0:I.valWeight)??1),sensitivity:D(un.sensitivity,(I==null?void 0:I.sensitivity)??0)})))};return window.addEventListener("storage",j),()=>{if(y=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),l.current&&(l.current.getTracks().forEach(z=>z.stop()),l.current=null),d.current&&(d.current.getTracks().forEach(z=>z.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const _=e.current;_&&(_.srcObject=null);const I=t.current;I&&(I.srcObject=null),window.removeEventListener("storage",j)}},[]);const ge=async(y,P,j)=>{const _={video:{deviceId:{exact:y}}};Wt("Starting camera with deviceId:",y);const I=await navigator.mediaDevices.getUserMedia(_);j.current=I;const z=P.current;if(!z){Wt("Video element not found!");return}z.srcObject=I,Wt("Stream assigned to video element, waiting for metadata..."),await new Promise(W=>{if(z.readyState>=2&&z.videoWidth>0&&z.videoHeight>0)return Wt("Video already ready:",z.videoWidth,"x",z.videoHeight),W();const he=()=>{Wt("loadedmetadata event fired:",z.videoWidth,"x",z.videoHeight),z.removeEventListener("loadedmetadata",he),W()};z.addEventListener("loadedmetadata",he,{once:!0}),setTimeout(()=>{Wt("Metadata timeout - proceeding anyway"),z.removeEventListener("loadedmetadata",he),W()},2e3)});try{await z.play(),Wt("Video play() succeeded")}catch(W){Wt("Video play() failed:",W)}},J=C.useRef(null),oe=C.useRef(null),Z=C.useRef(null),pe=C.useRef(!1),Me=async()=>{if(!pe.current){pe.current=!0;try{for(;oe.current||Z.current;){const y=s.current;if(!y)break;let P=null,j=null;if(oe.current?(P="A",j=oe.current,oe.current=null):Z.current&&(P="B",j=Z.current,Z.current=null),!!j){J.current=P;try{await y.send({image:j})}catch(_){console.error("[Detector2] hands.send error:",_);break}}}}finally{pe.current=!1}}},Be=(y,P)=>{y==="A"?oe.current=P:Z.current=P,Promise.resolve().then(Me)},Xe=async()=>{if(s.current)return s.current;try{const y=await(async()=>{try{if(typeof Yl.Hands=="function")return Yl.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const j=document.getElementById("mp-hands-cdn-script");if(j&&(await new Promise(_=>{if(window.Hands&&typeof window.Hands=="function")return _();const I=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(I),_())},50);setTimeout(()=>{clearInterval(I),_()},3e3)}),window.Hands&&typeof window.Hands=="function")||(j||await new Promise((_,I)=>{const z=document.createElement("script");z.id="mp-hands-cdn-script",z.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",z.async=!0,z.onload=()=>_(),z.onerror=W=>I(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(z)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),P=new y({locateFile:j=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${j}`});return P.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),P.onResults(j=>{const _=J.current;_==="A"?de(j):_==="B"&&ye(j)}),s.current=P,P}catch(y){return console.error("MediaPipe initialization error:",y),m(`MediaPipe error: ${y.message}`),null}},Fe=async(y,P,j)=>{if(!await Xe())return;const I=P.current;if(!I){Wt(`Video ref for ${y} not found`);return}Wt(`Initializing manual frame capture for camera ${y}, video dimensions:`,I.videoWidth,"x",I.videoHeight);let z=null;const W=()=>{const ce=P.current;ce&&ce.readyState>=2&&ce.videoWidth>0&&Be(y,ce),z=requestAnimationFrame(W)};z=requestAnimationFrame(W),j.current={stop:()=>{z&&(cancelAnimationFrame(z),z=null,Wt(`Stopped manual frame capture for camera ${y}`))}},Wt(`Manual frame capture started for camera ${y}`)},ze=C.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),Q=C.useRef({wristY:null,player:"None",landmarks:null,wristX:null});C.useEffect(()=>{b.current=A},[A]),C.useEffect(()=>{B.current=k},[k]),C.useEffect(()=>{V.current=G},[G]);const de=y=>ve(y,n,"A"),ye=y=>ve(y,r,"B"),ve=(y,P,j)=>{var at;const _=P.current;if(!_)return;const I=_.getContext("2d");if(!I)return;const z=j==="A"?e.current:t.current;if(!z||z.videoWidth===0||z.videoHeight===0){j==="A"?ze.current={wristY:null,wristX:null,landmarks:null,player:"None"}:Q.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}_.width=z.videoWidth,_.height=z.videoHeight,I.drawImage(z,0,0,_.width,_.height),I.fillStyle="rgba(0, 0, 0, 0.6)",I.fillRect(_.width-80,5,75,20),I.fillStyle="white",I.font="bold 14px Arial",I.fillText(`Camera ${j}`,_.width-75,20);let W=null,ce=null,he=null,be=[];if(y.multiHandLandmarks&&y.multiHandLandmarks.length>0)for(const Ge of y.multiHandLandmarks){const Oe=Ge[0],Ue=Oe.x*_.width,Ye=Oe.y*_.height;be.push({x:Ue,y:Ye,landmarks:Ge}),(W===null||(F?Ye<W:Ye>W))&&(W=Ye,ce=Ge,he=Ue)}be.forEach(({x:Ge,y:Oe})=>{I.fillStyle="orange",I.beginPath(),I.arc(Ge,Oe,8,0,Math.PI*2),I.fill()});let Te="None";if(ce){I.fillStyle="lime",I.beginPath(),I.arc(he,W,10,0,2*Math.PI),I.fill(),I.fillStyle="lime",I.font="16px Arial",I.fillText("SELECTED",he-40,W-15);const Oe=Math.max(10,Math.min(300,Math.floor(((at=V.current)==null?void 0:at.roiSize)||60)))/2,Ue=Math.max(0,he-Oe),Ye=Math.max(0,W-Oe),Et=Math.min(_.width,he+Oe),vn=Math.min(_.height,W+Oe),L=Math.max(0,Math.floor(Ue)),ae=Math.max(0,Math.floor(Ye));let ne=Math.floor(Et-Ue),re=Math.floor(vn-Ye);if(ne=Math.max(1,ne),re=Math.max(1,re),ne=Math.min(ne,_.width-L),re=Math.min(re,_.height-ae),ne>0&&re>0){I.strokeStyle="lime",I.lineWidth=3,I.strokeRect(L,ae,ne,re);try{const we=I.getImageData(L,ae,ne,re),Le=b.current,ut=B.current;Te=H(we,Le,ut).status}catch(we){console.warn("[Detector2] ROI sampling failed:",we),Te="None"}}else Wt("ROI skipped due to zero width/height",{width:ne,height:re,left:L,top:ae})}if(be.length>=1){let Ge=be[0].y,Oe=be[0].y;be.forEach(Et=>{Et.y<Ge&&(Ge=Et.y),Et.y>Oe&&(Oe=Et.y)}),I.strokeStyle="yellow",I.setLineDash([6,4]),I.beginPath(),I.moveTo(0,F?Ge:Oe),I.lineTo(_.width,F?Ge:Oe),I.stroke(),I.strokeStyle="cyan",I.beginPath(),I.moveTo(0,F?Oe:Ge),I.lineTo(_.width,F?Oe:Ge),I.stroke(),I.setLineDash([]);const Ue=F?"A (top)":"A (bottom)",Ye=F?"B (bottom)":"B (top)";I.fillStyle="lime",I.font="16px Arial",I.fillText(Ue,6,Math.max(14,(F?Ge:Oe)-6)),I.fillStyle="dodgerblue",I.fillText(Ye,6,Math.min(_.height-6,(F?Oe:Ge)+18))}const $e={wristY:W,wristX:he,landmarks:ce,player:Te};j==="A"?ze.current=$e:Q.current=$e;const Ze=ze.current.wristY,nt=Q.current.wristY;let qe="None";if(Ze!=null||nt!=null){const Ge=F?(Ue,Ye)=>Ue==null?Ye:Math.min(Ue,Ye):(Ue,Ye)=>Ue==null?Ye:Math.max(Ue,Ye);[Ze,nt].filter(Ue=>Ue!=null).reduce(Ge,null)===Ze?qe=ze.current.player:qe=Q.current.player}R({camA:ze.current.player,camB:Q.current.player,merged:qe})},O=(y,P,j)=>{y/=255,P/=255,j/=255;const _=Math.max(y,P,j),I=Math.min(y,P,j),z=_-I;let W=0;z!==0&&(_===y?W=60*((P-j)/z%6):_===P?W=60*((j-y)/z+2):W=60*((y-P)/z+4)),W<0&&(W+=360);const ce=_===0?0:z/_*255,he=_*255;return[W/2,ce,he]},H=(y,P,j)=>{var he,be,Te,$e;const _=y.data;if(P&&!j)return{status:"Player A",percentA:null,percentB:null};if(j&&!P)return{status:"Player B",percentA:null,percentB:null};const I=((he=V.current)==null?void 0:he.hueWeight)??4,z=((be=V.current)==null?void 0:be.satWeight)??2,W=((Te=V.current)==null?void 0:Te.valWeight)??1,ce=(($e=V.current)==null?void 0:$e.sensitivity)??0;if(P&&j){let Ze=0,nt=0,qe=0;for(let Ue=0;Ue<_.length;Ue+=4){const Ye=_[Ue],Et=_[Ue+1],vn=_[Ue+2],[L,ae,ne]=O(Ye,Et,vn),re=Math.min(1,Math.max(0,ae/255)),we=Math.min(1,Math.max(0,ne/255)),Le=Math.max(.05,.5*re+.5*we),ut=Math.min(Math.abs(L-P.h),180-Math.abs(L-P.h)),De=Math.min(Math.abs(L-j.h),180-Math.abs(L-j.h)),ot=Math.abs(ae-P.s),vt=Math.abs(ae-j.s),Qt=Math.abs(ne-P.v),nn=Math.abs(ne-j.v),wn=ut*I+ot*z+Qt*W,lr=De*I+vt*z+nn*W;Math.min(wn,lr)>180||(wn<=lr?Ze+=Le:nt+=Le,qe+=Le)}if(qe===0)return{status:"None",percentA:0,percentB:0};const at=Ze/Math.max(1e-6,qe),Ge=nt/Math.max(1e-6,qe),Oe=.12*(1+.8*Math.max(0,Math.min(1,ce)));return at>=Oe&&at>=Ge?{status:"Player A",percentA:at,percentB:Ge}:Ge>=Oe&&Ge>at?{status:"Player B",percentA:at,percentB:Ge}:{status:"None",percentA:at,percentB:Ge}}return{status:"None",percentA:0,percentB:0}},q=(y,P,j)=>{const _=(y||0)*2,I=(P||0)/255,z=(j||0)/255,W=z*I,ce=W*(1-Math.abs(_/60%2-1)),he=z-W;let be=0,Te=0,$e=0;_>=0&&_<60?(be=W,Te=ce,$e=0):_<120?(be=ce,Te=W,$e=0):_<180?(be=0,Te=W,$e=ce):_<240?(be=0,Te=ce,$e=W):_<300?(be=ce,Te=0,$e=W):(be=W,Te=0,$e=ce);const Ze=Math.round((be+he)*255),nt=Math.round((Te+he)*255),qe=Math.round(($e+he)*255);return`rgb(${Ze}, ${nt}, ${qe})`},ue=y=>y?q(y.h,y.s,y.v):"#ffffff",$=async(y,P)=>{try{if(y==="A"){if(ee(P),i.current){try{i.current.stop()}catch(_){Wt("Stop camA error:",_)}i.current=null}l.current&&(l.current.getTracks().forEach(_=>_.stop()),l.current=null);const j=e.current;j&&(j.srcObject=null),await new Promise(_=>setTimeout(_,100)),await ge(P,e,l),await new Promise(_=>setTimeout(_,200)),await Xe(),await Fe("A",e,i),Wt("Camera A switched to:",P)}else{if(xe(P),a.current){try{a.current.stop()}catch(_){Wt("Stop camB error:",_)}a.current=null}d.current&&(d.current.getTracks().forEach(_=>_.stop()),d.current=null);const j=t.current;j&&(j.srcObject=null),await new Promise(_=>setTimeout(_,100)),await ge(P,t,d),await new Promise(_=>setTimeout(_,200)),await Xe(),await Fe("B",t,a),Wt("Camera B switched to:",P)}}catch(j){console.error("[Detector2] Camera switch error:",j),m(`Camera switch error: ${j.message}`)}};return c.jsxs("div",{className:`detector-window ${w?"minimized":""}`,children:[c.jsxs("div",{className:"detector-header",children:[c.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),c.jsxs("div",{className:"detector-controls",children:[c.jsx("button",{onClick:()=>S(!w),children:w?"":""}),c.jsx("button",{onClick:()=>K(!F),title:"Toggle A criterion",children:F?"A=Top":"A=Bottom"})]})]}),c.jsxs("div",{className:"detector-content",style:{display:w?"none":"block"},children:[c.jsxs("div",{style:{display:"flex",gap:8},children:[c.jsxs("div",{style:{flex:1},children:[c.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[c.jsx("span",{children:"Camera A:"}),c.jsx("select",{value:X,onChange:y=>$("A",y.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:Y.map(y=>c.jsx("option",{value:y.deviceId,children:y.label||`Camera ${y.deviceId.slice(0,8)}`},y.deviceId))})]}),c.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),c.jsx("canvas",{ref:n,className:"output_canvas"})]}),c.jsxs("div",{style:{flex:1},children:[c.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[c.jsx("span",{children:"Camera B:"}),c.jsx("select",{value:Ee,onChange:y=>$("B",y.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:Y.map(y=>c.jsx("option",{value:y.deviceId,children:y.label||`Camera ${y.deviceId.slice(0,8)}`},y.deviceId))})]}),c.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),c.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),c.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[c.jsxs("div",{className:"status-display",children:["Merged: ",c.jsx("strong",{children:N.merged})]}),c.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[c.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),c.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:A?ue(A):"#444"}})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[c.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),c.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:k?ue(k):"#444"}})]})]}),c.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[c.jsxs("div",{children:["A: ",A?`h${Math.round(A.h)} s${Math.round(A.s)} v${Math.round(A.v)}`:""]}),c.jsxs("div",{children:["B: ",k?`h${Math.round(k.h)} s${Math.round(k.s)} v${Math.round(k.v)}`:""]})]}),h&&c.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),c.jsxs("div",{style:{fontSize:12,marginTop:6},children:[c.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const _o=ku(),mm=e=>{var i,a,l,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((m,w)=>typeof w.elapsed=="number"&&w.elapsed>m?w.elapsed:m,0),r={},s={};return t.forEach(m=>{const w=(m==null?void 0:m.player)||"Unknown";r[w]=(r[w]||0)+1;const S=(m==null?void 0:m.phase)||"unknown";s[S]=(s[S]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((l=(a=e.metadata)==null?void 0:a.config)==null?void 0:l.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},u5=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},gm="adminPassword";function c5(){var Y;const[e,t]=C.useState([]),[n,r]=C.useState(!0),[s,i]=C.useState(null),[a,l]=C.useState(null),[d,h]=C.useState(null),[m,w]=C.useState(!1),[S,N]=C.useState(null),[R,F]=C.useState(!1),[K,A]=C.useState(""),[g,k]=C.useState(!1);C.useEffect(()=>{const te=localStorage.getItem(gm);te&&A(te)},[]);const T=C.useCallback(async()=>{if(!K){i("Password required"),r(!1);return}r(!0),i(null),k(!1);try{const te=await fetch(`${_o}/sessions`,{headers:{"x-admin-password":K}});if(te.status===401||te.status===403)throw k(!0),new Error("Invalid password");if(!te.ok)throw new Error(`Failed to load sessions (${te.status})`);const X=await te.json(),ee=Array.isArray(X)?X:[];localStorage.setItem(gm,K),t(ee),l(Ee=>Ee&&ee.some(xe=>xe.sessionGameId===Ee)?Ee:ee.length>0?ee[0].sessionGameId:null)}catch(te){console.error("[Admin] Error fetching sessions:",te),i(te.message||"Failed to load sessions"),t([]),l(null)}finally{r(!1)}},[K]);C.useEffect(()=>{T()},[T]),C.useEffect(()=>{if(!a){h(null);return}let te=!1;return(async()=>{if(K){w(!0),N(null);try{const ee=await fetch(`${_o}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":K}});if(!ee.ok)throw ee.status===404?new Error("Session not found"):new Error(`Failed to load session (${ee.status})`);const Ee=await ee.json();te||h(mm(Ee))}catch(ee){console.error("[Admin] Error fetching session detail:",ee),te||(N(ee.message||"Failed to load session"),h(null))}finally{te||w(!1)}}})(),()=>{te=!0}},[a]);const b=te=>{l(te),F(!1)},B=async()=>{if(!a||!K)return;const te=!R;F(te),w(!0),N(null);try{const X=te?`${_o}/sessions/${encodeURIComponent(a)}/experiment-only`:`${_o}/sessions/${encodeURIComponent(a)}`,ee=await fetch(X,{headers:{"x-admin-password":K}});if(!ee.ok)throw new Error(`Failed to load session data (${ee.status})`);const Ee=await ee.json();h(mm(Ee))}catch(X){console.error("[Admin] Error loading session data:",X),N(X.message||"Failed to load session data"),F(!te)}finally{w(!1)}},D=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},G=()=>{if(!d)return;const te=JSON.stringify(d,null,2),X=new Blob([te],{type:"application/json"}),ee=URL.createObjectURL(X),Ee=document.createElement("a");Ee.href=ee;const xe=`${a}_${new Date().toISOString().split("T")[0]}.json`;Ee.download=xe,Ee.click(),URL.revokeObjectURL(ee),console.log("[Admin] Downloaded JSON:",xe)},le=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const te=new Set;d.moves.forEach(Z=>{Object.keys(Z).forEach(pe=>{pe!=="camera_frame"&&pe!=="__v"&&te.add(pe)})});const X=Array.from(te),ee=[X.join(",")];d.moves.forEach(Z=>{const pe=X.map(Me=>{const Be=Z[Me];return Be==null||Be===""?"":Array.isArray(Be)||typeof Be=="object"?`"${JSON.stringify(Be).replace(/"/g,'""')}"`:`"${String(Be).replace(/"/g,'""')}"`});ee.push(pe.join(","))});const Ee=ee.join(`
`),xe=new Blob([Ee],{type:"text/csv;charset=utf-8;"}),ge=URL.createObjectURL(xe),J=document.createElement("a");J.href=ge;const oe=`${a}_${new Date().toISOString().split("T")[0]}.csv`;J.download=oe,J.click(),URL.revokeObjectURL(ge),console.log("[Admin] Downloaded CSV:",oe)},V=async(te,X)=>{if(!(!a||!te||!K))try{const ee=await fetch(`${_o}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(te)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":K},body:JSON.stringify({player:X})});if(!ee.ok)throw new Error(`Failed to update player (${ee.status})`);h(Ee=>Ee&&{...Ee,moves:Ee.moves.map(xe=>xe._id===te?{...xe,player:X}:xe)}),console.log("[Admin] Player updated:",te,X)}catch(ee){console.error("[Admin] Error updating player:",ee),alert("Failed to update player: "+ee.message)}};return c.jsxs("div",{className:"admin-container",children:[c.jsxs("aside",{className:"admin-sidebar",children:[c.jsxs("div",{className:"admin-sidebar-header",children:[c.jsx("h1",{children:"Admin"}),c.jsxs("div",{className:"admin-password-row",children:[c.jsx("input",{type:"password",className:`admin-password-input ${g?"error":""}`,placeholder:"Password",value:K,onChange:te=>A(te.target.value),onKeyPress:te=>{te.key==="Enter"&&T()}}),c.jsx("button",{className:"admin-refresh-button",onClick:T,disabled:n||!K,children:n?"Refreshing":"Refresh"})]})]}),s&&c.jsx("div",{className:"admin-error",children:s}),c.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&c.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&c.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(te=>{const X=typeof te.movesCount=="number"?te.movesCount:Array.isArray(te.moves)?te.moves.length:0,ee=te.sessionGameId===a;return c.jsxs("button",{className:`admin-session-card ${ee?"active":""}`,onClick:()=>b(te.sessionGameId),children:[c.jsx("div",{className:"admin-session-id",children:te.sessionGameId}),c.jsxs("div",{className:"admin-session-meta",children:[c.jsxs("span",{children:["Participant: ",te.subjectId||""]}),c.jsxs("span",{children:["Condition: ",te.condition||""]})]}),c.jsxs("div",{className:"admin-session-meta",children:[c.jsxs("span",{children:["Moves: ",X]}),c.jsxs("span",{children:["Updated: ",u5(te.updatedAt)]})]})]},te.sessionGameId)})]})]}),c.jsxs("main",{className:"admin-content",children:[m&&c.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),S&&c.jsx("div",{className:"admin-error admin-error--content",children:S}),!m&&!S&&d&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-toolbar",children:[c.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[c.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),c.jsx("button",{className:`admin-toolbar-button experiment-toggle ${R?"active":""}`,onClick:B,title:R?"Show all moves (including practice)":"Show only experiment phase moves",children:R?"Show All Moves":"Experiment Only"}),c.jsx("button",{className:"admin-toolbar-button edit-players",onClick:D,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),c.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[c.jsx("button",{className:"admin-toolbar-button download-json",onClick:G,title:"Download session data as JSON",children:"Download JSON"}),c.jsx("button",{className:"admin-toolbar-button download-csv",onClick:le,title:"Download moves as CSV",children:"Download CSV"})]})]}),c.jsx("div",{className:"admin-summary-wrapper",children:c.jsx(Wg,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((Y=d.sessionInfo)==null?void 0:Y.sessionGameId)||a||""}${R?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:V})})]}),!m&&!S&&!d&&c.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const ym="adminPassword";function d5(){const[e,t]=C.useState(null),[n,r]=C.useState(!1),[s,i]=C.useState(null),[a,l]=C.useState(null),[d,h]=C.useState(null),[m,w]=C.useState(""),[S,N]=C.useState(!1);C.useEffect(()=>{const K=localStorage.getItem(ym);K&&w(K)},[]);const R=K=>{const A=K.target.files[0];if(!A)return;if(!A.name.endsWith(".json")){l("Please select a JSON file"),t(null);return}t(A),l(null),i(null);const g=new FileReader;g.onload=k=>{var T;try{const b=JSON.parse(k.target.result);h({sessionGameId:b.sessionGameId||"N/A",subjectId:b.subjectId||"N/A",condition:b.condition||"N/A",date:b.date||"N/A",movesCount:((T=b.moves)==null?void 0:T.length)||0,hasColorA:!!b.colorA,hasColorB:!!b.colorB})}catch(b){l("Invalid JSON file: "+b.message),h(null)}},g.readAsText(A)},F=async()=>{var K;if(!e){l("Please select a file first");return}r(!0),l(null),i(null);try{const A=await new Promise((B,D)=>{const G=new FileReader;G.onload=le=>B(le.target.result),G.onerror=D,G.readAsText(e)}),g=JSON.parse(A);if(!g.sessionGameId||!g.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!m)throw new Error("Admin password is required. Please enter it below.");const k=await fetch(`${ku()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":m},body:JSON.stringify(g)}),T=await k.json();if(k.status===401||k.status===403)throw N(!0),new Error(T.message||"Invalid admin password");if(!k.ok)throw new Error(T.message||"Upload failed");localStorage.setItem(ym,m),N(!1),i(` Successfully uploaded session "${g.sessionGameId}" with ${((K=g.moves)==null?void 0:K.length)||0} moves`),t(null),h(null);const b=document.getElementById("json-file-input");b&&(b.value="")}catch(A){l(A.message||"Failed to upload file")}finally{r(!1)}};return c.jsx("div",{className:"admin-upload-container",children:c.jsxs("div",{className:"admin-upload-card",children:[c.jsx("h1",{children:"Admin: Upload Session JSON"}),c.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),c.jsxs("div",{className:"admin-upload-form",children:[c.jsxs("div",{className:"password-input-wrapper",children:[c.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),c.jsx("input",{id:"admin-password",type:"password",value:m,onChange:K=>{w(K.target.value),N(!1)},placeholder:"Enter admin password",className:S?"error":""}),S&&c.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),c.jsxs("div",{className:"file-input-wrapper",children:[c.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:R,disabled:n}),c.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&c.jsxs("div",{className:"file-preview",children:[c.jsx("h3",{children:"File Preview"}),c.jsxs("div",{className:"preview-grid",children:[c.jsxs("div",{className:"preview-item",children:[c.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),c.jsxs("div",{className:"preview-item",children:[c.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),c.jsxs("div",{className:"preview-item",children:[c.jsx("strong",{children:"Condition:"})," ",d.condition]}),c.jsxs("div",{className:"preview-item",children:[c.jsx("strong",{children:"Date:"})," ",d.date]}),c.jsxs("div",{className:"preview-item",children:[c.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),c.jsxs("div",{className:"preview-item",children:[c.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),c.jsxs("div",{className:"preview-item",children:[c.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&c.jsxs("div",{className:"error-message",children:[c.jsx("strong",{children:"Error:"})," ",a]}),s&&c.jsx("div",{className:"success-message",children:s}),c.jsx("button",{className:"upload-button",onClick:F,disabled:!e||!m||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var ti=typeof self<"u"?self:{};function Os(){throw Error("Invalid UTF8")}function vm(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let qa,Dc;const f5=typeof TextDecoder<"u";let h5;const p5=typeof TextEncoder<"u";function Vg(e){if(p5)e=(h5||(h5=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var ch,Kl;e:{for(var wm=["CLOSURE_FLAGS"],zc=ti,Uc=0;Uc<wm.length;Uc++)if((zc=zc[wm[Uc]])==null){Kl=null;break e}Kl=zc}var da,xm=Kl&&Kl[610401301];ch=xm!=null&&xm;const Sm=ti.navigator;function Jd(e){return!!ch&&!!da&&da.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function Jn(e){var t;return(t=ti.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function ps(){return!!ch&&!!da&&da.brands.length>0}function Hc(){return ps()?Jd("Chromium"):(Jn("Chrome")||Jn("CriOS"))&&!(!ps()&&Jn("Edge"))||Jn("Silk")}function dh(e){return dh[" "](e),e}da=Sm&&Sm.userAgentData||null,dh[" "]=function(){};var m5=!ps()&&(Jn("Trident")||Jn("MSIE"));!Jn("Android")||Hc(),Hc(),Jn("Safari")&&(Hc()||!ps()&&Jn("Coast")||!ps()&&Jn("Opera")||!ps()&&Jn("Edge")||(ps()?Jd("Microsoft Edge"):Jn("Edg/"))||ps()&&Jd("Opera"));var Yg={},Io=null;function g5(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function l(h){for(;d<i.length;){const m=i.charAt(d++),w=Io[m];if(w!=null)return w;if(!/^[\s\xa0]*$/.test(m))throw Error("Unknown base64 encoding at char: "+m)}return h}Kg();let d=0;for(;;){const h=l(-1),m=l(0),w=l(64),S=l(64);if(S===64&&h===-1)break;a(h<<2|m>>4),w!=64&&(a(m<<4&240|w>>2),S!=64&&a(w<<6&192|S))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function Kg(){if(!Io){Io={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));Yg[n]=r;for(let s=0;s<r.length;s++){const i=r[s];Io[i]===void 0&&(Io[i]=s)}}}}var Xg=typeof Uint8Array<"u",Qg=!m5&&typeof btoa=="function";function km(e){if(!Qg){var t;t===void 0&&(t=0),Kg(),t=Yg[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],l=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=l+s+i+a}switch(l=0,a=r,e.length-d){case 2:a=t[(15&(l=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|l>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const Em=/[-_.]/g,y5={"-":"+",_:"/",".":"="};function v5(e){return y5[e]||""}function Jg(e){if(!Qg)return g5(e);Em.test(e)&&(e=e.replace(Em,v5)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function xa(e){return Xg&&e!=null&&e instanceof Uint8Array}var Hi={};function ni(){return w5||(w5=new Qr(null,Hi))}function fh(e){Zg(Hi);var t=e.g;return(t=t==null||xa(t)?t:typeof t=="string"?Jg(t):null)==null?t:e.g=t}var Qr=class{h(){return new Uint8Array(fh(this)||0)}constructor(e,t){if(Zg(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let w5,x5;function Zg(e){if(e!==Hi)throw Error("illegal external caller")}function qg(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function Zd(e){return qg(e=Error(e),"warning"),e}var Eu=typeof Symbol=="function"&&typeof Symbol()=="symbol",S5=new Set;function Sa(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&S5.add(e),e}var k5=Sa("jas",void 0,!0,!0),Am=Sa(void 0,"0di"),Gc=Sa(void 0,"2ex"),Co=Sa(void 0,"1oa",!0),Gi=Sa(void 0,Symbol(),!0);const Ne=Eu?k5:"Ga",ey={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},ty=Object.defineProperties;function Au(e,t){Eu||Ne in e||ty(e,ey),e[Ne]|=t}function $t(e,t){Eu||Ne in e||ty(e,ey),e[Ne]=t}function no(e){return Au(e,34),e}function E5(e,t){$t(t,-30975&(0|e))}function qd(e,t){$t(t,-30941&(34|e))}function hh(){return typeof BigInt=="function"}function jn(e){return Array.prototype.slice.call(e)}var ph,ka={},ny={};function _m(e){return!(!e||typeof e!="object"||e.Ia!==ny)}function mh(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function gh(e,t){if(e!=null){if(typeof e=="string")e=e?new Qr(e,Hi):ni();else if(e.constructor!==Qr)if(xa(e))e=e.length?new Qr(new Uint8Array(e),Hi):ni();else{if(!t)throw Error();e=void 0}}return e}function Xl(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[Ne]))}const Cm=[];function Ls(e){if(2&e)throw Error()}$t(Cm,55),ph=Object.freeze(Cm);class Ql{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new Ql(this.g,this.h,this.m)}}function yh(e){return Gi?e[Gi]:void 0}var A5=Object.freeze({});function _u(e){return e.Qa=!0,e}var _5=_u(e=>typeof e=="number"),jm=_u(e=>typeof e=="string"),C5=_u(e=>typeof e=="boolean"),Cu=typeof ti.BigInt=="function"&&typeof ti.BigInt(0)=="bigint",ef=_u(e=>Cu?e>=N5&&e<=M5:e[0]==="-"?Nm(e,j5):Nm(e,T5));const j5=Number.MIN_SAFE_INTEGER.toString(),N5=Cu?BigInt(Number.MIN_SAFE_INTEGER):void 0,T5=Number.MAX_SAFE_INTEGER.toString(),M5=Cu?BigInt(Number.MAX_SAFE_INTEGER):void 0;function Nm(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const P5=typeof Uint8Array.prototype.slice=="function";let ry,lt=0,It=0;function Tm(e){const t=e>>>0;lt=t,It=(e-t)/4294967296>>>0}function Wi(e){if(e<0){Tm(-e);const[t,n]=Sh(lt,It);lt=t>>>0,It=n>>>0}else Tm(e)}function vh(e){const t=ry||(ry=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),It=0,lt=t.getUint32(0,!0)}function wh(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:fa(e,t)}function xh(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=wh(e,t))=="number"?n?-e:e:n?"-"+e:e}function fa(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else hh()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+Mm(n)+Mm(e));return n}function Mm(e){return e=String(e),"0000000".slice(e.length)+e}function ju(e){if(e.length<16)Wi(Number(e));else if(hh())e=BigInt(e),lt=Number(e&BigInt(4294967295))>>>0,It=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");It=lt=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));It*=1e6,lt=1e6*lt+i,lt>=4294967296&&(It+=Math.trunc(lt/4294967296),It>>>=0,lt>>>=0)}if(t){const[r,s]=Sh(lt,It);lt=r,It=s}}}function Sh(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const kh=typeof BigInt=="function"?BigInt.asIntN:void 0,b5=typeof BigInt=="function"?BigInt.asUintN:void 0,Pi=Number.isSafeInteger,Nu=Number.isFinite,Jl=Math.trunc;function Bs(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function sy(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const I5=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Tu(e){switch(typeof e){case"bigint":return!0;case"number":return Nu(e);case"string":return I5.test(e);default:return!1}}function ro(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Nu(e)?0|e:void 0}function iy(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Nu(e)?e>>>0:void 0}function Pm(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Eh(e){return e=Jl(e),Pi(e)||(Wi(e),e=xh(lt,It)),e}function Ah(e){var t=Jl(Number(e));if(Pi(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if(ju(e),e=lt,2147483648&(t=It))if(hh())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=Sh(e,t);e="-"+fa(n,r)}else e=fa(e,t);return e}function Zl(e){return e==null?e:typeof e=="bigint"?(ef(e)?e=Number(e):(e=kh(64,e),e=ef(e)?Number(e):String(e)),e):Tu(e)?typeof e=="number"?Eh(e):Ah(e):void 0}function R5(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(b5(64,e));if(Tu(e)){if(t==="string")return t=Jl(Number(e)),Pi(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),Pm(e)||(ju(e),e=fa(lt,It))),e;if(t==="number")return(e=Jl(e))>=0&&Pi(e)?e:function(n){if(n<0){Wi(n);var r=fa(lt,It);return n=Number(r),Pi(n)?n:r}return Pm(r=String(n))?r:(Wi(n),wh(lt,It))}(e)}}function oy(e){if(typeof e!="string")throw Error();return e}function so(e){if(e!=null&&typeof e!="string")throw Error();return e}function Vi(e){return e==null||typeof e=="string"?e:void 0}function _h(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===ka)return e;if(!Array.isArray(e))return n?2&r?((e=t[Am])||(no((e=new t).u),e=t[Am]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[Ne];return s===0&&(s|=32&r),s|=2&r,s!==n&&$t(e,s),new t(e)}function L5(e,t,n){if(t)e:{if(!Tu(t=e))throw Zd("int64");switch(typeof t){case"string":t=Ah(t);break e;case"bigint":if(e=t=kh(64,t),jm(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(_5(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=Cu?BigInt(t):C5(t)?t?"1":"0":jm(t)?t.trim()||"0":String(t);break e;default:t=Eh(t)}}else t=Zl(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&Pi(t=+n)?t:n}const B5={};let F5=function(){try{return dh(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class Wc{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const O5=F5?(Object.setPrototypeOf(Wc.prototype,Map.prototype),Object.defineProperties(Wc.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),Wc):class extends Map{constructor(){super()}};function bm(e){return e}function Vc(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var rr=class extends O5{constructor(e,t,n=bm,r=bm){super();let s=0|e[Ne];s|=64,$t(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?$5:r;for(let i=0;i<e.length;i++){const a=e[i],l=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(l,d)}}na(e=Im){if(this.size!==0)return this.X(e)}X(e=Im){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){Vc(this),super.clear()}delete(e){return Vc(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new Ql(e,D5,this)}keys(){return this.Ha()}values(){var e=this.ma();return new Ql(e,rr.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return Vc(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function $5(e,t,n,r,s,i){return e=_h(e,r,n,i),s&&(e=Pu(e)),e}function Im(e){return e}function D5(e){return[e,this.get(e)]}let z5,ay,U5;function Rm(){return z5||(z5=new rr(no([]),void 0,void 0,void 0,B5))}function Ch(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=Xl(e)?void 0:s&&2&(0|e[Ne])?e:jh(e,t,n,r!==void 0,s);else if(mh(e)){const i={};for(let a in e)i[a]=Ch(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function jh(e,t,n,r,s){const i=r||n?0|e[Ne]:0,a=r?!!(32&i):void 0;r=jn(e);for(let l=0;l<r.length;l++)r[l]=Ch(r[l],t,n,a,s);return n&&((e=yh(e))&&(r[Gi]=jn(e)),n(i,r)),r}function H5(e){return Ch(e,ly,void 0,void 0,!1)}function ly(e){return e.W===ka?e.toJSON():e instanceof rr?e.na(H5):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return ef(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(Xl(t))return}else{if(xa(t))return km(t);if(t instanceof Qr){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=km(n)}if(t instanceof rr)return t.na()}}return t}(e)}function uy(e){return jh(e,ly,void 0,void 0,!1)}function Cs(e,t,n){return e=cy(e,t[0],t[1],n?1:2),t!==ay&&n&&Au(e,16384),e}function cy(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[Ne]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(mh(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return $t(e,s),e}function tf(e,t,n=qd){if(e!=null){if(Xg&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[Ne];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?($t(e,-12293&(34|r)),e):jh(e,tf,4&r?qd:n,!0,!0))}return e.W===ka?e=2&(r=0|(n=e.u)[Ne])?e:new e.constructor(Mu(n,r,!0)):e instanceof rr&&!(2&e.L)&&(n=no(e.X(tf)),e=new rr(n,e.S,e.R,e.Y)),e}}function Mu(e,t,n){const r=n||2&t?qd:E5,s=!!(32&t);return e=function(i,a,l){const d=jn(i);var h=d.length;const m=256&a?d[h-1]:void 0;for(h+=m?-1:0,a=512&a?1:0;a<h;a++)d[a]=l(d[a]);if(m){a=d[a]={};for(const w in m)a[w]=l(m[w])}return(i=yh(i))&&(d[Gi]=jn(i)),d}(e,t,i=>tf(i,s,r)),Au(e,32|(n?2:0)),e}function Pu(e){const t=e.u,n=0|t[Ne];return 2&n?new e.constructor(Mu(t,n,!1)):e}function Yi(e,t){return os(e=e.u,0|e[Ne],t)}function os(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&Gc!=null&&((s=(e=x5??(x5={}))[Gc]||0)>=4||(e[Gc]=s+1,qg(e=Error(),"incident"),function(a){ti.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function dt(e,t,n){const r=e.u;let s=0|r[Ne];return Ls(s),jt(r,s,t,n),e}function jt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},$t(e,t|=256)):e[i]=r),t)}function yl(e,t){let n=0|(e=e.u)[Ne];const r=os(e,n,t),s=Bs(r);return s!=null&&s!==r&&jt(e,n,t,s),s}function dy(e){let t=0|(e=e.u)[Ne];const n=os(e,t,1),r=gh(n,!0);return r!=null&&r!==n&&jt(e,t,1,r),r}function Ws(){return A5===void 0?2:4}function Vs(e,t,n,r,s){const i=e.u,a=2&(e=0|i[Ne])?1:r;s=!!s;let l=0|(r=Nh(i,e,t))[Ne];if(!(4&l)){4&l&&(r=jn(r),l=Jr(l,e),e=jt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const m=n(r[d]);m!=null&&(r[h++]=m)}h<d&&(r.length=h),l=Th(l,e),n=-4097&(20|l),l=n&=-8193,$t(r,l),2&l&&Object.freeze(r)}return a===1||a===4&&32&l?Kr(l)||(s=l,l|=2,l!==s&&$t(r,l),Object.freeze(r)):(a===2&&Kr(l)&&(r=jn(r),l=Jr(l,e),l=js(l,e,s),$t(r,l),e=jt(i,e,t,r)),Kr(l)||(t=l,l=js(l,e,s),l!==t&&$t(r,l))),r}function Nh(e,t,n,r){return e=os(e,t,n,r),Array.isArray(e)?e:ph}function Th(e,t){return e===0&&(e=Jr(e,t)),1|e}function Kr(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function fy(e){e=jn(e);for(let t=0;t<e.length;t++){const n=e[t]=jn(e[t]);Array.isArray(n[1])&&(n[1]=no(n[1]))}return e}function nf(e,t,n,r){let s=0|(e=e.u)[Ne];Ls(s),jt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function io(e,t,n,r,s){Ls(t);var i=!(!(64&t)&&16384&t);const a=(s=Nh(e,t,n,s))!==ph;if(i||!a){let l=i=a?0|s[Ne]:0;(!a||2&l||Kr(l)||4&l&&!(32&l))&&(s=jn(s),l=Jr(l,t),t=jt(e,t,n,s)),l=-13&Th(l,t),l=js(r?-17&l:16|l,t,!0),l!==i&&$t(s,l)}return s}function Yc(e,t){var n=t3;return Ph(Mh(e=e.u),e,0|e[Ne],n)===t?t:-1}function Mh(e){if(Eu)return e[Co]??(e[Co]=new Map);if(Co in e)return e[Co];const t=new Map;return Object.defineProperty(e,Co,{value:t}),t}function hy(e,t,n,r){const s=Mh(e),i=Ph(s,e,t,n);return i!==r&&(i&&(t=jt(e,t,i)),s.set(n,r)),t}function Ph(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];os(t,n,a)!=null&&(s!==0&&(n=jt(t,n,s)),s=a)}return e.set(r,s),s}function bh(e,t,n,r){let s,i=0|e[Ne];if((r=os(e,i,n,r))!=null&&r.W===ka)return(t=Pu(r))!==r&&jt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[Ne];s=2&a?Cs(Mu(r,a,!1),t,!0):64&a?r:Cs(s,t,!0)}else s=Cs(void 0,t,!0);return s!==r&&jt(e,i,n,s),s}function py(e,t,n,r){let s=0|(e=e.u)[Ne];return(t=_h(r=os(e,s,n,r),t,!1,s))!==r&&t!=null&&jt(e,s,n,t),t}function Je(e,t,n,r=!1){if((t=py(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[Ne]))){const s=Pu(t);s!==t&&jt(e,r,n,t=s)}return t}function my(e,t,n,r,s,i,a){e=e.u;var l=!!(2&t);const d=l?1:s;i=!!i,a&&(a=!l);var h=0|(s=Nh(e,t,r))[Ne];if(!(l=!!(4&h))){var m=s,w=t;const S=!!(2&(h=Th(h,t)));S&&(w|=2);let N=!S,R=!0,F=0,K=0;for(;F<m.length;F++){const A=_h(m[F],n,!1,w);if(A instanceof n){if(!S){const g=!!(2&(0|A.u[Ne]));N&&(N=!g),R&&(R=g)}m[K++]=A}}K<F&&(m.length=K),h|=4,h=R?16|h:-17&h,$t(m,h=N?8|h:-9&h),S&&Object.freeze(m)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(Kr(h)&&(s=jn(s),h=Jr(h,t),t=jt(e,t,r,s)),n=s,a=h,m=0;m<n.length;m++)(h=n[m])!==(w=Pu(h))&&(n[m]=w);a|=8,$t(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?Kr(h)||(t=h,(h|=!s.length||16&h&&(!l||32&h)?2:2048)!==t&&$t(s,h),Object.freeze(s)):(d===2&&Kr(h)&&($t(s=jn(s),h=js(h=Jr(h,t),t,i)),t=jt(e,t,r,s)),Kr(h)||(r=h,(h=js(h,t,i))!==r&&$t(s,h))),s}function rs(e,t,n){const r=0|e.u[Ne];return my(e,r,t,n,Ws(),!1,!(2&r))}function Pe(e,t,n,r){return r==null&&(r=void 0),dt(e,n,r)}function Wo(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[Ne];if(Ls(s),r==null){const i=Mh(e);if(Ph(i,e,s,n)!==t)break e;i.set(n,0)}else s=hy(e,s,n,t);jt(e,s,t,r)}}function Jr(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function js(e,t,n){return 32&t&&n||(e&=-33),e}function ql(e,t,n,r){const s=0|e.u[Ne];Ls(s),e=my(e,s,n,t,2,!0),r=r??new n,e.push(r),e[Ne]=2&(0|r.u[Ne])?-9&e[Ne]:-17&e[Ne]}function qn(e,t){return ro(Yi(e,t))}function sr(e,t){return Vi(Yi(e,t))}function Lt(e,t){return yl(e,t)??0}function ha(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);dt(e,t,n)}function Dr(e,t,n){if(n!=null){if(typeof n!="number"||!Nu(n))throw Zd("int32");n|=0}dt(e,t,n)}function _e(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);dt(e,t,n)}function eu(e,t,n){{const a=e.u;let l=0|a[Ne];if(Ls(l),n==null)jt(a,l,t);else{var r=e=0|n[Ne],s=Kr(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=jn(n),r=0,e=js(e=Jr(e,l),l,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=oy(d);Object.is(d,h)||(i&&(n=jn(n),r=0,e=js(e=Jr(e,l),l,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=jn(n),e=js(e=Jr(e,l),l,!0)),$t(n,e)),jt(a,l,t,n)}}}function bu(e,t,n){Ls(0|e.u[Ne]),Vs(e,t,Vi,2,!0).push(oy(n))}function gy(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Ih(){return Error("Failed to read varint, encoding is invalid.")}function yy(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function Rh(e){if(typeof e=="string")return{buffer:Jg(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Qr)return{buffer:fh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Lh(e,t){let n,r=0,s=0,i=0;const a=e.h;let l=e.g;do n=a[l++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[l++],s|=(127&n)<<i;if(Xs(e,l),n<128)return t(r>>>0,s>>>0);throw Ih()}function Bh(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return Xs(e,n),!!(127&t)}throw Ih()}function Ms(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Ih();return Xs(e,n),s}function ss(e){return Ms(e)>>>0}function rf(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],Xs(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function sf(e){var t=rf(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function G5(e){return Ms(e)}function Kc(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=Rh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function Xs(e,t){if(e.g=t,t>e.l)throw yy(e.l,t)}function vy(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw yy(t,e.l-n);return e.g=r,n}function wy(e,t){if(t==0)return ni();var n=vy(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):P5?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?ni():new Qr(n,Hi)}rr.prototype.toJSON=void 0,rr.prototype.Ia=ny;var Lm=[];function xy(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=ss(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw gy(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function vl(e){switch(e.h){case 0:e.h!=0?vl(e):Bh(e.g);break;case 1:Xs(e=e.g,e.g+8);break;case 2:if(e.h!=2)vl(e);else{var t=ss(e.g);Xs(e=e.g,e.g+t)}break;case 5:Xs(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!xy(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}vl(e)}break;default:throw gy(e.h,e.l)}}function Ea(e,t,n){const r=e.g.l,s=ss(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function Fh(e){var t=ss(e.g),n=vy(e=e.g,t);if(e=e.h,f5){var r,s=e;(r=Dc)||(r=Dc=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(l){if(qa===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),qa=!0}catch{qa=!1}}throw!qa&&(Dc=void 0),l}}else{t=(i=n)+t,n=[];let l,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?Os():(l=e[i++],a<194||(192&l)!=128?(i--,Os()):n.push((31&a)<<6|63&l)):a<240?i>=t-1?Os():(l=e[i++],(192&l)!=128||a===224&&l<160||a===237&&l>=160||(192&(r=e[i++]))!=128?(i--,Os()):n.push((15&a)<<12|(63&l)<<6|63&r)):a<=244?i>=t-2?Os():(l=e[i++],(192&l)!=128||l-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,Os()):(a=(7&a)<<18|(63&l)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):Os(),n.length>=8192&&(d=vm(d,n),n.length=0)}i=vm(d,n)}return i}function Sy(e){const t=ss(e.g);return wy(e.g,t)}function Iu(e,t,n){var r=ss(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var el=[];function W5(e){return e}let bi;function xr(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var Ae=class{constructor(e,t){this.u=cy(e,t)}toJSON(){const e=!bi;try{return e&&(bi=uy),ky(this)}finally{e&&(bi=void 0)}}l(){var e=jx;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(Mu(e,0|e[Ne],!1))}N(){return!!(2&(0|this.u[Ne]))}};function ky(e){var t=e.u;{t=(e=bi(t))!==t;let h=e.length;if(h){var n=e[h-1],r=mh(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,l=!1;if(a)for(let m in a)isNaN(+m)?(i??(i={}))[m]=a[m]:(r=a[m],Array.isArray(r)&&(Xl(r)||_m(r)&&r.size===0)&&(r=null),r==null&&(l=!0),r!=null&&((i??(i={}))[m]=r));if(l||(i=a),i)for(let m in i){l=i;break e}l=null}a=l==null?n!=null:l!==n}for(;h>0&&((i=s[h-1])==null||Xl(i)||_m(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||l)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),l&&s.push(l)),d=s}else d=e}return d}function Bm(e){return e?/^\d+$/.test(e)?(ju(e),new of(lt,It)):null:V5||(V5=new of(0,0))}Ae.prototype.W=ka,Ae.prototype.toString=function(){try{return bi=W5,ky(this).toString()}finally{bi=void 0}};var of=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let V5;function Fm(e){return e?/^-?\d+$/.test(e)?(ju(e),new af(lt,It)):null:Y5||(Y5=new af(0,0))}var af=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let Y5;function Ii(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function oo(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function Ru(e,t){if(t>=0)oo(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function pa(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function Ki(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function Un(e,t,n){oo(e.g,8*t+n)}function Oh(e,t){return Un(e,t,2),t=e.g.end(),Ki(e,t),t.push(e.h),t}function $h(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function Lu(e,t,n){Un(e,t,2),oo(e.g,n.length),Ki(e,e.g.end()),Ki(e,n)}function tu(e,t,n,r){n!=null&&(t=Oh(e,t),r(n,e),$h(e,t))}function Sr(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var Dh=Sr(),Ey=Sr(),zh=Sr(),Uh=Sr(),Ay=Sr(),_y=Sr(),Hh=Sr(),Cy=Sr(),jy=Sr(),ao=class{constructor(e,t,n){this.g=e,this.h=t,e=Dh,this.l=!!e&&n===e||!1}};function Bu(e,t){return new ao(e,t,Dh)}function Ny(e,t,n,r,s){tu(e,n,by(t,r),s)}const K5=Bu(function(e,t,n,r,s){return e.h===2&&(Ea(e,bh(t,r,n),s),!0)},Ny),X5=Bu(function(e,t,n,r,s){return e.h===2&&(Ea(e,bh(t,r,n,!0),s),!0)},Ny);var Fu=Symbol(),Gh=Symbol(),Om=Symbol(),$m=Symbol();let Ty,My;function ii(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(w){switch(typeof w){case"boolean":return ay||(ay=[0,void 0,!0]);case"number":return w>0?void 0:w===0?U5||(U5=[0,void 0]):[-w,void 0];case"string":return[0,w];case"object":return w}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Ty??(Ty=i),My??(My=r[a+1]),i=r[a+=2]));const l={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)l[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let w;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof ao?w=i:(w=K5,a--),w==null?void 0:w.l){i=r[++a],h=r;var m=a;typeof i=="function"&&(i=i(),h[m]=i),h=i}for(m=d+1,typeof(i=r[++a])=="number"&&i<0&&(m-=i,i=r[++a]);d<m;d++){const S=l[d];h?n(s,d,w,h,S):t(s,d,w,S)}}return r[e]=s}function Py(e){return Array.isArray(e)?e[0]instanceof ao?e:[X5,e]:[e,void 0]}function by(e,t){return e instanceof Ae?e.u:Array.isArray(e)?Cs(e,t,!1):void 0}function Wh(e,t,n,r){const s=n.g;e[t]=r?(i,a,l)=>s(i,a,l,r):s}function Vh(e,t,n,r,s){const i=n.g;let a,l;e[t]=(d,h,m)=>i(d,h,m,l||(l=ii(Gh,Wh,Vh,r).V),a||(a=Yh(r)),s)}function Yh(e){let t=e[Om];if(t!=null)return t;const n=ii(Gh,Wh,Vh,e);return t=n.la?(r,s)=>Ty(r,s,n):(r,s)=>{const i=0|r[Ne];for(;xy(s)&&s.h!=4;){var a=s.m,l=n[a];if(l==null){var d=n.ga;d&&(d=d[a])&&(d=Q5(d))!=null&&(l=n[a]=d)}l!=null&&l(s,r,a)||(a=(l=s).l,vl(l),l.fa?l=void 0:(d=l.g.g-a,l.g.g=a,l=wy(l.g,d)),a=r,l&&((d=a[Gi])?d.push(l):a[Gi]=[l]))}return 16384&i&&no(r),!0},e[Om]=t}function Q5(e){const t=(e=Py(e))[0].g;if(e=e[1]){const n=Yh(e),r=ii(Gh,Wh,Vh,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function Ou(e,t,n){e[t]=n.h}function $u(e,t,n,r){let s,i;const a=n.h;e[t]=(l,d,h)=>a(l,d,h,i||(i=ii(Fu,Ou,$u,r).V),s||(s=Iy(r)))}function Iy(e){let t=e[$m];if(!t){const n=ii(Fu,Ou,$u,e);t=(r,s)=>Ry(r,s,n),e[$m]=t}return t}function Ry(e,t,n){for(var r=0|e[Ne],s=512&r?0:-1,i=e.length,a=512&r?1:0,l=i+(256&r?-1:0);a<l;a++){const d=e[a];if(d==null)continue;const h=a-s,m=Dm(n,h);m&&m(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(l=Dm(n,s))&&l(t,i,s)}if(e=yh(e))for(Ki(t,t.g.end()),n=0;n<e.length;n++)Ki(t,fh(e[n])||new Uint8Array(0))}function Dm(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=Py(n))[0].h;if(n=n[1]){const s=Iy(n),i=ii(Fu,Ou,$u,n).V;n=e.la?My(i,s):(a,l,d)=>r(a,l,d,i,s)}else n=r;return e[t]=n}}function lo(e,t){if(Array.isArray(t)){var n=0|t[Ne];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),$t(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function gn(e,t,n){return new ao(e,t,n)}function uo(e,t,n){return new ao(e,t,n)}function yn(e,t,n){jt(e,0|e[Ne],t,n)}var J5=Bu(function(e,t,n,r,s){return e.h===2&&(e=Ea(e,Cs([void 0,void 0],r,!0),s),Ls(r=0|t[Ne]),(s=os(t,r,n))instanceof rr?2&s.L?((s=s.X()).push(e),jt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[Ne])&&jt(t,r,n,s=fy(s)),s.push(e)):jt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof rr)t.forEach((i,a)=>{tu(e,n,Cs([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&tu(e,n,Cs(a,r,!1),s)}});function Ly(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String(kh(64,r));if(Tu(r)){if(s==="string")return Ah(r);if(s==="number")return Eh(r)}}(t),t!=null&&(typeof t=="string"&&Fm(t),t!=null))switch(Un(e,n,0),typeof t){case"number":e=e.g,Wi(t),Ii(e,lt,It);break;case"bigint":n=BigInt.asUintN(64,t),n=new af(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ii(e.g,n.h,n.g);break;default:n=Fm(t),Ii(e.g,n.h,n.g)}}function By(e,t,n){(t=ro(t))!=null&&t!=null&&(Un(e,n,0),Ru(e.g,t))}function Fy(e,t,n){(t=sy(t))!=null&&(Un(e,n,0),e.g.g.push(t?1:0))}function Oy(e,t,n){(t=Vi(t))!=null&&Lu(e,n,Vg(t))}function $y(e,t,n,r,s){tu(e,n,by(t,r),s)}function Dy(e,t,n){(t=t==null||typeof t=="string"||xa(t)||t instanceof Qr?t:void 0)!=null&&Lu(e,n,Rh(t).buffer)}function zy(e,t,n){return(e.h===5||e.h===2)&&(t=io(t,0|t[Ne],n,!1,!1),e.h==2?Iu(e,sf,t):t.push(sf(e.g)),!0)}var Gr=gn(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=rf(r);const s=rf(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,yn(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Bs(t))!=null&&(Un(e,n,1),e=e.g,(n=ry||(ry=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),lt=n.getUint32(0,!0),It=n.getUint32(4,!0),pa(e,lt),pa(e,It))},Sr()),Dt=gn(function(e,t,n){return e.h===5&&(yn(t,n,sf(e.g)),!0)},function(e,t,n){(t=Bs(t))!=null&&(Un(e,n,5),e=e.g,vh(t),pa(e,lt))},Hh),Z5=uo(zy,function(e,t,n){if((t=lo(Bs,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(Un(r,s,5),r=r.g,vh(i),pa(r,lt))}},Hh),Kh=uo(zy,function(e,t,n){if((t=lo(Bs,t))!=null&&t.length){Un(e,n,2),oo(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,vh(t[r]),pa(n,lt)}},Hh),Ps=gn(function(e,t,n){return e.h===0&&(yn(t,n,Lh(e.g,xh)),!0)},Ly,_y),Xc=gn(function(e,t,n){return e.h===0&&(yn(t,n,(e=Lh(e.g,xh))===0?void 0:e),!0)},Ly,_y),q5=gn(function(e,t,n){return e.h===0&&(yn(t,n,Lh(e.g,wh)),!0)},function(e,t,n){if((t=R5(t))!=null&&(typeof t=="string"&&Bm(t),t!=null))switch(Un(e,n,0),typeof t){case"number":e=e.g,Wi(t),Ii(e,lt,It);break;case"bigint":n=BigInt.asUintN(64,t),n=new of(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),Ii(e.g,n.h,n.g);break;default:n=Bm(t),Ii(e.g,n.h,n.g)}},Sr()),Rt=gn(function(e,t,n){return e.h===0&&(yn(t,n,Ms(e.g)),!0)},By,Uh),Du=uo(function(e,t,n){return(e.h===0||e.h===2)&&(t=io(t,0|t[Ne],n,!1,!1),e.h==2?Iu(e,Ms,t):t.push(Ms(e.g)),!0)},function(e,t,n){if((t=lo(ro,t))!=null&&t.length){n=Oh(e,n);for(let r=0;r<t.length;r++)Ru(e.g,t[r]);$h(e,n)}},Uh),Ei=gn(function(e,t,n){return e.h===0&&(yn(t,n,(e=Ms(e.g))===0?void 0:e),!0)},By,Uh),St=gn(function(e,t,n){return e.h===0&&(yn(t,n,Bh(e.g)),!0)},Fy,Ey),Ri=gn(function(e,t,n){return e.h===0&&(yn(t,n,(e=Bh(e.g))===!1?void 0:e),!0)},Fy,Ey),on=uo(function(e,t,n){return e.h===2&&(e=Fh(e),io(t,0|t[Ne],n,!1).push(e),!0)},function(e,t,n){if((t=lo(Vi,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&Lu(r,s,Vg(i))}},zh),ms=gn(function(e,t,n){return e.h===2&&(yn(t,n,(e=Fh(e))===""?void 0:e),!0)},Oy,zh),rt=gn(function(e,t,n){return e.h===2&&(yn(t,n,Fh(e)),!0)},Oy,zh),Ht=function(e,t,n=Dh){return new ao(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=Cs(void 0,r,!0),io(t,0|t[Ne],n,!0).push(r),Ea(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)$y(e,t[i],n,r,s)}),st=Bu(function(e,t,n,r,s,i){return e.h===2&&(hy(t,0|t[Ne],i,n),Ea(e,t=bh(t,r,n),s),!0)},$y),Uy=gn(function(e,t,n){return e.h===2&&(yn(t,n,Sy(e)),!0)},Dy,Cy),ex=uo(function(e,t,n){return(e.h===0||e.h===2)&&(t=io(t,0|t[Ne],n,!1,!1),e.h==2?Iu(e,ss,t):t.push(ss(e.g)),!0)},function(e,t,n){if((t=lo(iy,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(Un(r,s,0),oo(r.g,i))}},Ay),tx=gn(function(e,t,n){return e.h===0&&(yn(t,n,(e=ss(e.g))===0?void 0:e),!0)},function(e,t,n){(t=iy(t))!=null&&t!=null&&(Un(e,n,0),oo(e.g,t))},Ay),ir=gn(function(e,t,n){return e.h===0&&(yn(t,n,Ms(e.g)),!0)},function(e,t,n){(t=ro(t))!=null&&(t=parseInt(t,10),Un(e,n,0),Ru(e.g,t))},jy);class nx{constructor(t,n){this.h=t,this.g=n,this.l=Je,this.m=Pe,this.defaultValue=void 0}}function kr(e,t){return new nx(e,t)}function Fs(e,t){return(n,r)=>{if(el.length){const i=el.pop();i.o(r),Kc(i.g,n,r),n=i}else n=new class{constructor(i,a){if(Lm.length){const l=Lm.pop();Kc(l,i,a),i=l}else i=new class{constructor(l,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,Kc(this,l,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;Yh(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,el.length<100&&el.push(n)}return s}}function zu(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};Ry(this.u,t,ii(Fu,Ou,$u,e)),Ki(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const l=r[a];n.set(l,i),i+=l.length}return t.l=[n],n}}var zm=class extends Ae{constructor(e){super(e)}},Um=[0,ms,gn(function(e,t,n){return e.h===2&&(yn(t,n,(e=Sy(e))===ni()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof Ae){const r=t.Ra;return void(r&&(t=r(t),t!=null&&Lu(e,n,Rh(t).buffer)))}if(Array.isArray(t))return}Dy(e,t,n)},Cy)];let Qc,Hm=globalThis.trustedTypes;function Gm(e){Qc===void 0&&(Qc=function(){let n=null;if(!Hm)return n;try{const r=s=>s;n=Hm.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=Qc;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function rx(e,...t){if(t.length===0)return Gm(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return Gm(n)}var Hy=[0,Rt,ir,St,-1,Du,ir,-1],sx=class extends Ae{constructor(e){super(e)}},Gy=[0,St,rt,St,ir,-1,uo(function(e,t,n){return(e.h===0||e.h===2)&&(t=io(t,0|t[Ne],n,!1,!1),e.h==2?Iu(e,G5,t):t.push(Ms(e.g)),!0)},function(e,t,n){if((t=lo(ro,t))!=null&&t.length){n=Oh(e,n);for(let r=0;r<t.length;r++)Ru(e.g,t[r]);$h(e,n)}},jy),rt,-1,[0,St,-1],ir,St,-1],Wy=[0,rt,-2],Wm=class extends Ae{constructor(e){super(e)}},Vy=[0],Yy=[0,Rt,St,1,St,-3],$n=class extends Ae{constructor(e){super(e,2)}},zt={};zt[336783863]=[0,rt,St,-1,Rt,[0,[1,2,3,4,5,6,7,8],st,Vy,st,Gy,st,Wy,st,Yy,st,Hy,st,[0,rt,-2],st,[0,rt,ir],st,[0,ir,rt]],[0,rt],St,[0,[1,3],[2,4],st,[0,Du],-1,st,[0,on],-1,Ht,[0,rt,-1]],rt];var Vm=[0,Xc,-1,Ri,-3,Xc,Du,ms,Ei,Xc,-1,Ri,Ei,Ri,-2,ms];function Hn(e,t){nf(e,2,so(t),"")}function ht(e,t){bu(e,3,t)}function Ke(e,t){bu(e,4,t)}var hn=class extends Ae{constructor(e){super(e,500)}o(e){return Pe(this,0,7,e)}},Vo=[-1,{}],Ym=[0,rt,1,Vo],Km=[0,rt,on,Vo];function Gn(e,t){ql(e,1,hn,t)}function yt(e,t){bu(e,10,t)}function tt(e,t){bu(e,15,t)}var Tn=class extends Ae{constructor(e){super(e,500)}o(e){return Pe(this,0,1001,e)}},Ky=[-500,Ht,[-500,ms,-1,on,-3,[-2,zt,St],Ht,Um,Ei,-1,Ym,Km,Ht,[0,ms,Ri],ms,Vm,Ei,on,987,on],4,Ht,[-500,rt,-1,[-1,{}],998,rt],Ht,[-500,rt,on,-1,[-2,{},St],997,on,-1],Ei,Ht,[-500,rt,on,Vo,998,on],on,Ei,Ym,Km,Ht,[0,ms,-1,Vo],on,-2,Vm,ms,-1,Ri,[0,Ri,tx],978,Vo,Ht,Um];Tn.prototype.g=zu(Ky);var ix=Fs(Tn,Ky),ox=class extends Ae{constructor(e){super(e)}},Xy=class extends Ae{constructor(e){super(e)}g(){return rs(this,ox,1)}},Qy=[0,Ht,[0,Rt,Dt,rt,-1]],Uu=Fs(Xy,Qy),ax=class extends Ae{constructor(e){super(e)}},lx=class extends Ae{constructor(e){super(e)}},Jc=class extends Ae{constructor(e){super(e)}h(){return Je(this,ax,2)}g(){return rs(this,lx,5)}},Jy=Fs(class extends Ae{constructor(e){super(e)}},[0,on,Du,Kh,[0,ir,[0,Rt,-3],[0,Dt,-3],[0,Rt,-1,[0,Ht,[0,Rt,-2]]],Ht,[0,Dt,-1,rt,Dt]],rt,-1,Ps,Ht,[0,Rt,Dt],on,Ps]),Zy=class extends Ae{constructor(e){super(e)}},Li=Fs(class extends Ae{constructor(e){super(e)}},[0,Ht,[0,Dt,-4]]),qy=class extends Ae{constructor(e){super(e)}},Aa=Fs(class extends Ae{constructor(e){super(e)}},[0,Ht,[0,Dt,-4]]),ux=class extends Ae{constructor(e){super(e)}},cx=[0,Rt,-1,Kh,ir],e3=class extends Ae{constructor(e){super(e)}};e3.prototype.g=zu([0,Dt,-4,Ps]);var dx=class extends Ae{constructor(e){super(e)}},fx=Fs(class extends Ae{constructor(e){super(e)}},[0,Ht,[0,1,Rt,rt,Qy],Ps]),Xm=class extends Ae{constructor(e){super(e)}},hx=class extends Ae{constructor(e){super(e)}oa(){const e=dy(this);return e??ni()}},px=class extends Ae{constructor(e){super(e)}},t3=[1,2],mx=Fs(class extends Ae{constructor(e){super(e)}},[0,Ht,[0,t3,st,[0,Kh],st,[0,Uy],Rt,rt],Ps]),Xh=class extends Ae{constructor(e){super(e)}},n3=[0,rt,Rt,Dt,on,-1],Qm=class extends Ae{constructor(e){super(e)}},gx=[0,St,-1],Jm=class extends Ae{constructor(e){super(e)}},wl=[1,2,3,4,5],nu=class extends Ae{constructor(e){super(e)}g(){return dy(this)!=null}h(){return sr(this,2)!=null}},kt=class extends Ae{constructor(e){super(e)}g(){return sy(Yi(this,2))??!1}},r3=[0,Uy,rt,[0,Rt,Ps,-1],[0,q5,Ps]],Ft=[0,r3,St,[0,wl,st,Yy,st,Gy,st,Hy,st,Vy,st,Wy],ir],Hu=class extends Ae{constructor(e){super(e)}},Qh=[0,Ft,Dt,-1,Rt],yx=kr(502141897,Hu);zt[502141897]=Qh;var vx=Fs(class extends Ae{constructor(e){super(e)}},[0,[0,ir,-1,Z5,ex],cx]),s3=class extends Ae{constructor(e){super(e)}},i3=class extends Ae{constructor(e){super(e)}},Jh=[0,Ft,Dt,[0,Ft],St],o3=[0,Ft,Qh,Jh,Dt,[0,[0,r3]]],wx=kr(508968150,i3);zt[508968150]=o3,zt[508968149]=Jh;var a3=class extends Ae{constructor(e){super(e)}},xx=kr(513916220,a3);zt[513916220]=[0,Ft,o3,Rt];var ui=class extends Ae{constructor(e){super(e)}h(){return Je(this,Xh,2)}g(){dt(this,2)}},l3=[0,Ft,n3];zt[478825465]=l3;var Sx=class extends Ae{constructor(e){super(e)}},u3=class extends Ae{constructor(e){super(e)}},Zh=class extends Ae{constructor(e){super(e)}},qh=class extends Ae{constructor(e){super(e)}},c3=class extends Ae{constructor(e){super(e)}},Zm=[0,Ft,[0,Ft],l3,-1],d3=[0,Ft,Dt,Rt],ep=[0,Ft,Dt],f3=[0,Ft,d3,ep,Dt],kx=kr(479097054,c3);zt[479097054]=[0,Ft,f3,Zm],zt[463370452]=Zm,zt[464864288]=d3;var Ex=kr(462713202,qh);zt[462713202]=f3,zt[474472470]=ep;var Ax=class extends Ae{constructor(e){super(e)}},h3=class extends Ae{constructor(e){super(e)}},p3=class extends Ae{constructor(e){super(e)}},m3=class extends Ae{constructor(e){super(e)}},tp=[0,Ft,Dt,-1,Rt],lf=[0,Ft,Dt,St];m3.prototype.g=zu([0,Ft,ep,[0,Ft],Qh,Jh,tp,lf]);var g3=class extends Ae{constructor(e){super(e)}},_x=kr(456383383,g3);zt[456383383]=[0,Ft,n3];var y3=class extends Ae{constructor(e){super(e)}},Cx=kr(476348187,y3);zt[476348187]=[0,Ft,gx];var v3=class extends Ae{constructor(e){super(e)}},qm=class extends Ae{constructor(e){super(e)}},w3=[0,ir,-1],jx=kr(458105876,class extends Ae{constructor(e){super(e)}g(){var e=this.u;const t=0|e[Ne],n=2&t;return e=function(r,s,i){var a=qm;const l=2&s;let d=!1;if(i==null){if(l)return Rm();i=[]}else if(i.constructor===rr){if(!(2&i.L)||l)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[Ne])):i=[];if(l){if(!i.length)return Rm();d||(d=!0,no(i))}else d&&(d=!1,i=fy(i));return d||(64&(0|i[Ne])?i[Ne]&=-33:32&s&&Au(i,32)),jt(r,s,2,a=new rr(i,a,L5,void 0)),a}(e,t,os(e,t,2)),!n&&qm&&(e.ra=!0),e}});zt[458105876]=[0,w3,J5,[!0,Ps,[0,rt,-1,on]]];var np=class extends Ae{constructor(e){super(e)}},x3=kr(458105758,np);zt[458105758]=[0,Ft,rt,w3];var S3=class extends Ae{constructor(e){super(e)}},Nx=kr(443442058,S3);zt[443442058]=[0,Ft,rt,Rt,Dt,on,-1,St,Dt],zt[514774813]=tp;var k3=class extends Ae{constructor(e){super(e)}},Tx=kr(516587230,k3);function uf(e,t){return t=t?t.clone():new Xh,e.displayNamesLocale!==void 0?dt(t,1,so(e.displayNamesLocale)):e.displayNamesLocale===void 0&&dt(t,1),e.maxResults!==void 0?Dr(t,2,e.maxResults):"maxResults"in e&&dt(t,2),e.scoreThreshold!==void 0?_e(t,3,e.scoreThreshold):"scoreThreshold"in e&&dt(t,3),e.categoryAllowlist!==void 0?eu(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&dt(t,4),e.categoryDenylist!==void 0?eu(t,5,e.categoryDenylist):"categoryDenylist"in e&&dt(t,5),t}function rp(e,t=-1,n=""){return{categories:e.map(r=>({index:qn(r,1)??0??-1,score:Lt(r,2)??0,categoryName:sr(r,3)??""??"",displayName:sr(r,4)??""??""})),headIndex:t,headName:n}}function E3(e){var a,l;var t=Vs(e,3,Bs,Ws()),n=Vs(e,2,ro,Ws()),r=Vs(e,1,Vi,Ws()),s=Vs(e,9,Vi,Ws());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=Je(e,Jc,4))==null?void 0:a.h())&&(i.boundingBox={originX:qn(t,1)??0,originY:qn(t,2)??0,width:qn(t,3)??0,height:qn(t,4)??0,angle:0}),(l=Je(e,Jc,4))==null?void 0:l.g().length)for(const d of Je(e,Jc,4).g())i.keypoints.push({x:yl(d,1)??0,y:yl(d,2)??0,score:yl(d,4)??0,label:sr(d,3)??""});return i}function Gu(e){const t=[];for(const n of rs(e,qy,1))t.push({x:Lt(n,1)??0,y:Lt(n,2)??0,z:Lt(n,3)??0,visibility:Lt(n,4)??0});return t}function Yo(e){const t=[];for(const n of rs(e,Zy,1))t.push({x:Lt(n,1)??0,y:Lt(n,2)??0,z:Lt(n,3)??0,visibility:Lt(n,4)??0});return t}function e0(e){return Array.from(e,t=>t>127?t-256:t)}function t0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let tl;zt[516587230]=[0,Ft,tp,lf,Dt],zt[518928384]=lf;const Mx=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function A3(){if(tl===void 0)try{await WebAssembly.instantiate(Mx),tl=!0}catch{tl=!1}return tl}async function jo(e,t=rx``){const n=await A3()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var zs=class{};function _3(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function n0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function C3(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function je(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function r0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=C3(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function s0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function br(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function us(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}zs.forVisionTasks=function(e){return jo("vision",e)},zs.forTextTasks=function(e){return jo("text",e)},zs.forGenAiExperimentalTasks=function(e){return jo("genai_experimental",e)},zs.forGenAiTasks=function(e){return jo("genai",e)},zs.forAudioTasks=function(e){return jo("audio",e)},zs.isSimdSupported=function(){return A3()};async function Px(e,t,n,r){return e=await(async(s,i,a,l,d)=>{if(i&&await n0(i),!self.ModuleFactory||a&&(await n0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,l)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function Zc(e,t){const n=Je(e.baseOptions,nu,1)||new nu;typeof t=="string"?(dt(n,2,so(t)),dt(n,1)):t instanceof Uint8Array&&(dt(n,1,gh(t,!1)),dt(n,2)),Pe(e.baseOptions,0,1,n)}function i0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function ke(e,t){e.B=Math.max(e.B,t)}function Wu(e,t){e.A=new hn,Hn(e.A,"PassThroughCalculator"),ht(e.A,"free_memory"),Ke(e.A,"free_memory_unused_out"),yt(t,"free_memory"),Gn(t,e.A)}function Xi(e,t){ht(e.A,t),Ke(e.A,t+"_unused_out")}function Vu(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var xl=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,l;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=Je(this.baseOptions,nu,1))!=null&&s.g()||(i=Je(this.baseOptions,nu,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(l=e.baseOptions)!=null&&l.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,m){let w=Je(h.baseOptions,Jm,3);if(!w){var S=w=new Jm,N=new Wm;Wo(S,4,wl,N)}"delegate"in m&&(m.delegate==="GPU"?(m=w,S=new sx,Wo(m,2,wl,S)):(m=w,S=new Wm,Wo(m,4,wl,S))),Pe(h.baseOptions,0,3,w)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),Zc(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)Zc(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const m=[];for(var w=0;;){const{done:S,value:N}=await h.read();if(S)break;m.push(N),w+=N.length}if(m.length===0)return new Uint8Array(0);if(m.length===1)return m[0];h=new Uint8Array(w),w=0;for(const S of m)h.set(S,w),w+=S.length;return h}(d.modelAssetBuffer).then(h=>{Zc(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=ix(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,i0(this)}finishProcessing(){this.g.finishProcessing(),i0(this)}close(){this.A=void 0,this.g.closeGraph()}};function Zr(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}xl.prototype.close=xl.prototype.close,function(e,t){e=e.split(".");var n,r=ti;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",xl);class bx{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function o0(e,t,n){const r=e.g;if(n=Zr(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function a0(e,t){const n=e.g,r=Zr(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=Zr(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=Zr(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new bx(n,r,s,i)}function sp(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function ip(e,t,n,r){return sp(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=a0(e,!0)),n=e.s):(e.v||(e.v=a0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function Yu(e,t,n){return sp(e,t),e=Zr(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function Ku(e,t,n){sp(e,t),e.A||(e.A=Zr(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function op(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var ap=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=Zr(e.createProgram(),"Failed to create WebGL program"),this.aa=o0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=o0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function Wr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function cf(e){var t=Wr(e,1);if(!t){if(t=Wr(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=Qi(e);var n=lp(e);if(Ku(n,r,j3(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function j3(e){let t=Wr(e,2);if(!t){const n=Qi(e);t=T3(e);const r=cf(e),s=N3(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),df(e)}return t}function Qi(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=Zr(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function N3(e){if(e=Qi(e),!nl)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))nl=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");nl=e.R16F}return nl}function lp(e){return e.l||(e.l=new ap),e.l}function T3(e){const t=Qi(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Wr(e,2);return n||(n=Yu(lp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function df(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var nl,Vt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--l0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!Wr(this,0)}ja(){return!!Wr(this,1)}P(){return!!Wr(this,2)}ia(){return(t=Wr(e=this,0))||(t=cf(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return cf(this)}M(){return j3(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=Qi(this),s=lp(this);r.activeTexture(r.TEXTURE1),n=Yu(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=N3(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),Ku(s,r,n),ip(s,r,!1,()=>{T3(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),df(this)}),op(s),df(this)}}e.push(n)}return new Vt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Qi(this).deleteTexture(Wr(this,2)),l0=-1}};Vt.prototype.close=Vt.prototype.close,Vt.prototype.clone=Vt.prototype.clone,Vt.prototype.getAsWebGLTexture=Vt.prototype.M,Vt.prototype.getAsFloat32Array=Vt.prototype.ha,Vt.prototype.getAsUint8Array=Vt.prototype.ia,Vt.prototype.hasWebGLTexture=Vt.prototype.P,Vt.prototype.hasFloat32Array=Vt.prototype.ja,Vt.prototype.hasUint8Array=Vt.prototype.Fa;var l0=250;function Br(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function M3(e){var t=Br(e,0);if(!t){t=Ji(e);const n=Xu(e),r=new Uint8Array(e.width*e.height*4);Ku(n,t,Sl(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),op(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function Sl(e){let t=Br(e,2);if(!t){const n=Ji(e);t=kl(e);const r=Br(e,1)||M3(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),Ro(e)}return t}function Ji(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=Zr(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function Xu(e){return e.l||(e.l=new ap),e.l}function kl(e){const t=Ji(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Br(e,2);return n||(n=Yu(Xu(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Ro(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function u0(e){const t=Ji(e);return ip(Xu(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var Yt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--c0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Br(this,0)}ka(){return!!Br(this,1)}P(){return!!Br(this,2)}Ca(){return M3(this)}Ba(){var e=Br(this,1);return e||(Sl(this),kl(this),e=u0(this),Ro(this),this.g.push(e),this.j=!0),e}M(){return Sl(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=Ji(this),s=Xu(this);r.activeTexture(r.TEXTURE1),n=Yu(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),Ku(s,r,n),ip(s,r,!1,()=>{kl(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Ro(this)}),op(s),Ro(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Sl(this),kl(this),n=u0(this),Ro(this)}e.push(n)}return new Yt(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Br(this,1).close(),this.m&&Ji(this).deleteTexture(Br(this,2)),c0=-1}};Yt.prototype.close=Yt.prototype.close,Yt.prototype.clone=Yt.prototype.clone,Yt.prototype.getAsWebGLTexture=Yt.prototype.M,Yt.prototype.getAsImageBitmap=Yt.prototype.Ba,Yt.prototype.getAsImageData=Yt.prototype.Ca,Yt.prototype.hasWebGLTexture=Yt.prototype.P,Yt.prototype.hasImageBitmap=Yt.prototype.ka,Yt.prototype.hasImageData=Yt.prototype.Ea;var c0=250;function Er(...e){return e.map(([t,n])=>({start:t,end:n}))}const Ix=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((d0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:_3()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),je(this,r||"input_audio",i=>{je(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){br(this,"__graph_config__",t=>{e(t)}),je(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),je(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){je(this,t,r=>{const[s,i]=r0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){je(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){je(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){je(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){je(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){je(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){je(this,t,r=>{je(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){je(this,t,r=>{s0(this,Object.keys(e),s=>{s0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){je(this,n,s=>{je(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){je(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){je(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)je(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){je(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){je(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){je(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){je(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){je(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){je(this,t,n=>{je(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){je(this,n,r=>{je(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){je(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)je(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){br(this,e,t),je(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){us(this,e,t),je(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){br(this,e,t),je(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){us(this,e,t),je(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){br(this,e,t),je(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){us(this,e,t),je(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){br(this,e,t),je(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){us(this,e,t),je(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){br(this,e,t),je(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){us(this,e,t),je(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){br(this,e,t),je(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){us(this,e,t),je(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){br(this,e,t),je(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){us(this,e,t),je(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),br(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),je(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends d0{get ea(){return this.i}qa(e,t,n){je(this,t,r=>{const[s,i]=r0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){br(this,e,t),je(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){us(this,e,t),je(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var d0,or=class extends Ix{};async function Ve(e,t,n){return async function(r,s,i,a){return Px(r,s,i,a)}(e,n.canvas??(_3()?void 0:document.createElement("canvas")),t,n)}function P3(e,t,n,r){if(e.T){const i=new e3;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");_e(i,1,(s.left+s.right)/2),_e(i,2,(s.top+s.bottom)/2),_e(i,4,s.right-s.left),_e(i,3,s.bottom-s.top)}else _e(i,1,.5),_e(i,2,.5),_e(i,4,1),_e(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(_e(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,l]=C3(t);n=Lt(i,3)*l/a,s=Lt(i,4)*a/l,_e(i,4,n),_e(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function ar(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");P3(e,t,n,e.B+1)}function zr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");P3(e,t,n,r)}function Zi(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new Vt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Nn=class extends xl{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new ap}l(e,t=!0){if("runningMode"in e&&ha(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Nn.prototype.close=Nn.prototype.close;var Vn=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Pe(e=this.h=new Hu,0,1,t=new kt),_e(this.h,2,.5),_e(this.h,3,.3)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&_e(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&_e(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},ar(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},zr(this,e,n,t),this.j}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect_in"),tt(e,"detections");const t=new $n;xr(t,yx,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect_in"),Ke(n,"DETECTIONS:detections"),n.o(t),Gn(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=Jy(i),this.j.detections.push(E3(r));ke(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Vn.prototype.detectForVideo=Vn.prototype.F,Vn.prototype.detect=Vn.prototype.D,Vn.prototype.setOptions=Vn.prototype.o,Vn.createFromModelPath=async function(e,t){return Ve(Vn,e,{baseOptions:{modelAssetPath:t}})},Vn.createFromModelBuffer=function(e,t){return Ve(Vn,e,{baseOptions:{modelAssetBuffer:t}})},Vn.createFromOptions=function(e,t){return Ve(Vn,e,t)};var up=Er([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),cp=Er([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),dp=Er([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),b3=Er([474,475],[475,476],[476,477],[477,474]),fp=Er([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),hp=Er([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),I3=Er([469,470],[470,471],[471,472],[472,469]),pp=Er([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),R3=[...up,...cp,...dp,...fp,...hp,...pp],L3=Er([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function f0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var Pt=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Pe(e=this.h=new i3,0,1,t=new kt),this.v=new s3,Pe(this.h,0,3,this.v),this.s=new Hu,Pe(this.h,0,2,this.s),Dr(this.s,4,1),_e(this.s,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numFaces"in e&&Dr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&_e(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return f0(this),ar(this,e,t),this.j}F(e,t,n){return f0(this),zr(this,e,n,t),this.j}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect"),tt(e,"face_landmarks");const t=new $n;xr(t,wx,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),Gn(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=Aa(i),this.j.faceLandmarks.push(Gu(r));ke(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{ke(this,r)}),this.outputFaceBlendshapes&&(tt(e,"blendshapes"),Ke(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=Uu(i),this.j.faceBlendshapes.push(rp(r.g()??[]));ke(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{ke(this,r)})),this.outputFacialTransformationMatrixes&&(tt(e,"face_geometry"),Ke(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=Je(vx(i),ux,2))&&this.j.facialTransformationMatrixes.push({rows:qn(r,1)??0??0,columns:qn(r,2)??0??0,data:Vs(r,3,Bs,Ws()).slice()??[]});ke(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{ke(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Pt.prototype.detectForVideo=Pt.prototype.F,Pt.prototype.detect=Pt.prototype.D,Pt.prototype.setOptions=Pt.prototype.o,Pt.createFromModelPath=function(e,t){return Ve(Pt,e,{baseOptions:{modelAssetPath:t}})},Pt.createFromModelBuffer=function(e,t){return Ve(Pt,e,{baseOptions:{modelAssetBuffer:t}})},Pt.createFromOptions=function(e,t){return Ve(Pt,e,t)},Pt.FACE_LANDMARKS_LIPS=up,Pt.FACE_LANDMARKS_LEFT_EYE=cp,Pt.FACE_LANDMARKS_LEFT_EYEBROW=dp,Pt.FACE_LANDMARKS_LEFT_IRIS=b3,Pt.FACE_LANDMARKS_RIGHT_EYE=fp,Pt.FACE_LANDMARKS_RIGHT_EYEBROW=hp,Pt.FACE_LANDMARKS_RIGHT_IRIS=I3,Pt.FACE_LANDMARKS_FACE_OVAL=pp,Pt.FACE_LANDMARKS_CONTOURS=R3,Pt.FACE_LANDMARKS_TESSELATION=L3;var Ir=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect",!0),Pe(e=this.j=new a3,0,1,t=new kt)}get baseOptions(){return Je(this.j,kt,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,ar(this,e,r??{}),!this.h)return this.s}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect"),tt(e,"stylized_image");const t=new $n;xr(t,xx,this.j);const n=new hn;Hn(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),Gn(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,l=r.width;const d=l*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let m=0;m<d;++m)h[4*m]=a[3*m],h[4*m+1]=a[3*m+1],h[4*m+2]=a[3*m+2],h[4*m+3]=255;a=new ImageData(h,l,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),l,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);l=new Yt([a],!1,!1,this.g.i.canvas,this.O,l,r),this.s=i=i?l.clone():l,this.h&&this.h(i),ke(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ir.prototype.stylize=Ir.prototype.Oa,Ir.prototype.setOptions=Ir.prototype.o,Ir.createFromModelPath=function(e,t){return Ve(Ir,e,{baseOptions:{modelAssetPath:t}})},Ir.createFromModelBuffer=function(e,t){return Ve(Ir,e,{baseOptions:{modelAssetBuffer:t}})},Ir.createFromOptions=function(e,t){return Ve(Ir,e,t)};var mp=Er([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function h0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function p0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function m0(e,t=!0){const n=[];for(const s of e){var r=Uu(s);e=[];for(const i of r.g())r=t&&qn(i,1)!=null?qn(i,1)??0:-1,e.push({score:Lt(i,2)??0,index:r,categoryName:sr(i,3)??""??"",displayName:sr(i,4)??""??""});n.push(e)}return n}var Pn=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Pe(e=this.j=new c3,0,1,t=new kt),this.s=new qh,Pe(this.j,0,2,this.s),this.C=new Zh,Pe(this.s,0,3,this.C),this.v=new u3,Pe(this.s,0,2,this.v),this.h=new Sx,Pe(this.j,0,3,this.h),_e(this.v,2,.5),_e(this.s,4,.5),_e(this.C,2,.5)}get baseOptions(){return Je(this.j,kt,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){var s,i,a,l;if(Dr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new ui,n=t,r=uf(e.cannedGesturesClassifierOptions,(s=Je(this.h,ui,3))==null?void 0:s.h());Pe(n,0,2,r),Pe(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=Je(this.h,ui,3))==null||i.g());return e.customGesturesClassifierOptions?(Pe(n=t=new ui,0,2,r=uf(e.customGesturesClassifierOptions,(a=Je(this.h,ui,4))==null?void 0:a.h())),Pe(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((l=Je(this.h,ui,4))==null||l.g()),this.l(e)}Ja(e,t){return h0(this),ar(this,e,t),p0(this)}Ka(e,t,n){return h0(this),zr(this,e,n,t),p0(this)}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect"),tt(e,"hand_gestures"),tt(e,"hand_landmarks"),tt(e,"world_hand_landmarks"),tt(e,"handedness");const t=new $n;xr(t,kx,this.j);const n=new hn;Hn(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"HAND_GESTURES:hand_gestures"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),Gn(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=Aa(i);const a=[];for(const l of rs(r,qy,1))a.push({x:Lt(l,1)??0,y:Lt(l,2)??0,z:Lt(l,3)??0,visibility:Lt(l,4)??0});this.landmarks.push(a)}ke(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=Li(i);const a=[];for(const l of rs(r,Zy,1))a.push({x:Lt(l,1)??0,y:Lt(l,2)??0,z:Lt(l,3)??0,visibility:Lt(l,4)??0});this.worldLandmarks.push(a)}ke(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...m0(r,!1)),ke(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{ke(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...m0(r)),ke(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function g0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Pn.prototype.recognizeForVideo=Pn.prototype.Ka,Pn.prototype.recognize=Pn.prototype.Ja,Pn.prototype.setOptions=Pn.prototype.o,Pn.createFromModelPath=function(e,t){return Ve(Pn,e,{baseOptions:{modelAssetPath:t}})},Pn.createFromModelBuffer=function(e,t){return Ve(Pn,e,{baseOptions:{modelAssetBuffer:t}})},Pn.createFromOptions=function(e,t){return Ve(Pn,e,t)},Pn.HAND_CONNECTIONS=mp;var bn=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Pe(e=this.h=new qh,0,1,t=new kt),this.s=new Zh,Pe(this.h,0,3,this.s),this.j=new u3,Pe(this.h,0,2,this.j),Dr(this.j,3,1),_e(this.j,2,.5),_e(this.s,2,.5),_e(this.h,4,.5)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numHands"in e&&Dr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&_e(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&_e(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],ar(this,e,t),g0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],zr(this,e,n,t),g0(this)}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect"),tt(e,"hand_landmarks"),tt(e,"world_hand_landmarks"),tt(e,"handedness");const t=new $n;xr(t,Ex,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"LANDMARKS:hand_landmarks"),Ke(n,"WORLD_LANDMARKS:world_hand_landmarks"),Ke(n,"HANDEDNESS:handedness"),n.o(t),Gn(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=Aa(i),this.landmarks.push(Gu(r));ke(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=Li(i),this.worldLandmarks.push(Yo(r));ke(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{ke(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const l=[];for(const d of r){r=Uu(d);const h=[];for(const m of r.g())h.push({score:Lt(m,2)??0,index:qn(m,1)??0??-1,categoryName:sr(m,3)??""??"",displayName:sr(m,4)??""??""});l.push(h)}a.call(i,...l),ke(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};bn.prototype.detectForVideo=bn.prototype.F,bn.prototype.detect=bn.prototype.D,bn.prototype.setOptions=bn.prototype.o,bn.createFromModelPath=function(e,t){return Ve(bn,e,{baseOptions:{modelAssetPath:t}})},bn.createFromModelBuffer=function(e,t){return Ve(bn,e,{baseOptions:{modelAssetBuffer:t}})},bn.createFromOptions=function(e,t){return Ve(bn,e,t)},bn.HAND_CONNECTIONS=mp;var B3=Er([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function y0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function v0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{Vu(e)}}function rl(e,t){e=Aa(e),t.push(Gu(e))}var wt=class extends Nn{constructor(e,t){super(new or(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Pe(e=this.j=new m3,0,1,t=new kt),this.J=new Zh,Pe(this.j,0,2,this.J),this.Z=new Ax,Pe(this.j,0,3,this.Z),this.s=new Hu,Pe(this.j,0,4,this.s),this.H=new s3,Pe(this.j,0,5,this.H),this.v=new h3,Pe(this.j,0,6,this.v),this.K=new p3,Pe(this.j,0,7,this.K),_e(this.s,2,.5),_e(this.s,3,.3),_e(this.H,2,.5),_e(this.v,2,.5),_e(this.v,3,.3),_e(this.K,2,.5),_e(this.J,2,.5)}get baseOptions(){return Je(this.j,kt,1)}set baseOptions(e){Pe(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&_e(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&_e(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&_e(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&_e(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&_e(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&_e(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&_e(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,y0(this),ar(this,e,r),v0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,y0(this),zr(this,e,s,t),v0(this)}m(){var e=new Tn;yt(e,"input_frames_image"),tt(e,"pose_landmarks"),tt(e,"pose_world_landmarks"),tt(e,"face_landmarks"),tt(e,"left_hand_landmarks"),tt(e,"left_hand_world_landmarks"),tt(e,"right_hand_landmarks"),tt(e,"right_hand_world_landmarks");const t=new $n,n=new zm;nf(n,1,so("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))dt(s,2,uy(i));else{if(!(typeof i=="string"||i instanceof Qr||xa(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");nf(s,2,gh(i,!1),ni())}}(n,this.j.g());const r=new hn;Hn(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),ql(r,8,zm,n),ht(r,"IMAGE:input_frames_image"),Ke(r,"POSE_LANDMARKS:pose_landmarks"),Ke(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Ke(r,"FACE_LANDMARKS:face_landmarks"),Ke(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Ke(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Ke(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Ke(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),Gn(e,r),Wu(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{rl(s,this.h.poseLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=Li(s),a.push(Yo(s)),ke(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{ke(this,s)}),this.outputPoseSegmentationMasks&&(Ke(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),Xi(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[Zi(this,s,!0,!this.C)],ke(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],ke(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{rl(s,this.h.faceLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{ke(this,s)}),this.outputFaceBlendshapes&&(tt(e,"extra_blendshapes"),Ke(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=Uu(s),a.push(rp(s.g()??[]))),ke(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{ke(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{rl(s,this.h.leftHandLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=Li(s),a.push(Yo(s)),ke(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{rl(s,this.h.rightHandLandmarks),ke(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{ke(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=Li(s),a.push(Yo(s)),ke(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{ke(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};wt.prototype.detectForVideo=wt.prototype.F,wt.prototype.detect=wt.prototype.D,wt.prototype.setOptions=wt.prototype.o,wt.createFromModelPath=function(e,t){return Ve(wt,e,{baseOptions:{modelAssetPath:t}})},wt.createFromModelBuffer=function(e,t){return Ve(wt,e,{baseOptions:{modelAssetBuffer:t}})},wt.createFromOptions=function(e,t){return Ve(wt,e,t)},wt.HAND_CONNECTIONS=mp,wt.POSE_CONNECTIONS=B3,wt.FACE_LANDMARKS_LIPS=up,wt.FACE_LANDMARKS_LEFT_EYE=cp,wt.FACE_LANDMARKS_LEFT_EYEBROW=dp,wt.FACE_LANDMARKS_LEFT_IRIS=b3,wt.FACE_LANDMARKS_RIGHT_EYE=fp,wt.FACE_LANDMARKS_RIGHT_EYEBROW=hp,wt.FACE_LANDMARKS_RIGHT_IRIS=I3,wt.FACE_LANDMARKS_FACE_OVAL=pp,wt.FACE_LANDMARKS_CONTOURS=R3,wt.FACE_LANDMARKS_TESSELATION=L3;var Yn=class extends Nn{constructor(e,t){super(new or(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Pe(e=this.h=new g3,0,1,t=new kt)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return Pe(this.h,0,2,uf(e,Je(this.h,Xh,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},ar(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},zr(this,e,n,t),this.j}m(){var e=new Tn;yt(e,"input_image"),yt(e,"norm_rect"),tt(e,"classifications");const t=new $n;xr(t,_x,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),ht(n,"IMAGE:input_image"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"CLASSIFICATIONS:classifications"),n.o(t),Gn(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:rs(i,dx,1).map(l=>{var d;return rp(((d=Je(l,Xy,4))==null?void 0:d.g())??[],qn(l,2)??0,sr(l,3)??"")})};return Zl(Yi(i,2))!=null&&(a.timestampMs=Zl(Yi(i,2))??0),a}(fx(r)),ke(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Yn.prototype.classifyForVideo=Yn.prototype.ta,Yn.prototype.classify=Yn.prototype.sa,Yn.prototype.setOptions=Yn.prototype.o,Yn.createFromModelPath=function(e,t){return Ve(Yn,e,{baseOptions:{modelAssetPath:t}})},Yn.createFromModelBuffer=function(e,t){return Ve(Yn,e,{baseOptions:{modelAssetBuffer:t}})},Yn.createFromOptions=function(e,t){return Ve(Yn,e,t)};var In=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect",!0),this.h=new y3,this.embeddings={embeddings:[]},Pe(e=this.h,0,1,t=new kt)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){var t=this.h,n=Je(this.h,Qm,2);return n=n?n.clone():new Qm,e.l2Normalize!==void 0?ha(n,1,e.l2Normalize):"l2Normalize"in e&&dt(n,1),e.quantize!==void 0?ha(n,2,e.quantize):"quantize"in e&&dt(n,2),Pe(t,0,2,n),this.l(e)}za(e,t){return ar(this,e,t),this.embeddings}Aa(e,t,n){return zr(this,e,n,t),this.embeddings}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect"),tt(e,"embeddings_out");const t=new $n;xr(t,Cx,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"EMBEDDINGS:embeddings_out"),n.o(t),Gn(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=mx(r),this.embeddings=function(i){return{embeddings:rs(i,px,1).map(a=>{var d,h;const l={headIndex:qn(a,3)??0??-1,headName:sr(a,4)??""??""};if(py(a,Xm,Yc(a,1))!==void 0)a=Vs(a=Je(a,Xm,Yc(a,1)),1,Bs,Ws()),l.floatEmbedding=a.slice();else{const m=new Uint8Array(0);l.quantizedEmbedding=((h=(d=Je(a,hx,Yc(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??m}return l}),timestampMs:Zl(Yi(i,2))??0}}(r),ke(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};In.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=t0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=t0(e0(e.quantizedEmbedding),e0(t.quantizedEmbedding))}return e},In.prototype.embedForVideo=In.prototype.Aa,In.prototype.embed=In.prototype.za,In.prototype.setOptions=In.prototype.o,In.createFromModelPath=function(e,t){return Ve(In,e,{baseOptions:{modelAssetPath:t}})},In.createFromModelBuffer=function(e,t){return Ve(In,e,{baseOptions:{modelAssetBuffer:t}})},In.createFromOptions=function(e,t){return Ve(In,e,t)};var ff=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function w0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function x0(e){try{const t=new ff(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{Vu(e)}}ff.prototype.close=ff.prototype.close;var cn=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new np,this.v=new v3,Pe(this.h,0,3,this.v),Pe(e=this.h,0,1,t=new kt)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?dt(this.h,2,so(e.displayNamesLocale)):"displayNamesLocale"in e&&dt(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=rs(e.da(),hn,1).filter(s=>(sr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=Je(t[0],$n,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=sr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,w0(this),ar(this,e,r),x0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,w0(this),zr(this,e,s,t),x0(this)}Da(){return this.s}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect");const t=new $n;xr(t,x3,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect"),n.o(t),Gn(e,n),Wu(this,e),this.outputConfidenceMasks&&(tt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),Xi(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>Zi(this,i,!0,!this.j)),ke(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],ke(this,r)})),this.outputCategoryMask&&(tt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),Xi(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=Zi(this,r,!1,!this.j),ke(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,ke(this,r)})),tt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,ke(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};cn.prototype.getLabels=cn.prototype.Da,cn.prototype.segmentForVideo=cn.prototype.Ma,cn.prototype.segment=cn.prototype.segment,cn.prototype.setOptions=cn.prototype.o,cn.createFromModelPath=function(e,t){return Ve(cn,e,{baseOptions:{modelAssetPath:t}})},cn.createFromModelBuffer=function(e,t){return Ve(cn,e,{baseOptions:{modelAssetBuffer:t}})},cn.createFromOptions=function(e,t){return Ve(cn,e,t)};var hf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};hf.prototype.close=hf.prototype.close;var Rx=class extends Ae{constructor(e){super(e)}},ci=[0,Rt,-2],ru=[0,Gr,-3,St,Gr,-1],S0=[0,ru],k0=[0,ru,Rt,-1],qc=class extends Ae{constructor(e){super(e)}},E0=[0,Gr,-1,St],Lx=class extends Ae{constructor(e){super(e)}},A0=class extends Ae{constructor(e){super(e)}},pf=[1,2,3,4,5,6,7,8,9,10,14,15],F3=class extends Ae{constructor(e){super(e)}};F3.prototype.g=zu([0,Ht,[0,pf,st,ru,st,[0,ru,ci],st,S0,st,[0,S0,ci],st,E0,st,[0,Gr,-3,St,ir],st,[0,Gr,-3,St],st,[0,rt,Gr,-2,St,Rt,St,-1,2,Gr,ci],st,k0,st,[0,k0,ci],Gr,ci,rt,st,[0,Gr,-3,St,ci,-1],st,[0,Ht,E0]],rt,[0,rt,Rt,-1,St]]);var Rr=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new np,this.s=new v3,Pe(this.h,0,3,this.s),Pe(e=this.h,0,1,t=new kt)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new F3;const i=new A0;var a=new Rx;if(Dr(a,1,255),Pe(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var l=new qc;ha(l,3,!0),_e(l,1,t.keypoint.x),_e(l,2,t.keypoint.y),Wo(i,5,pf,l)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(l of(a=new Lx,t.scribble))ha(t=new qc,3,!0),_e(t,1,l.x),_e(t,2,l.y),ql(a,1,qc,t);Wo(i,15,pf,a)}ql(r,1,A0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),ar(this,e,s);e:{try{const h=new hf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{Vu(this)}d=void 0}return d}m(){var e=new Tn;yt(e,"image_in"),yt(e,"roi_in"),yt(e,"norm_rect_in");const t=new $n;xr(t,x3,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),ht(n,"IMAGE:image_in"),ht(n,"ROI:roi_in"),ht(n,"NORM_RECT:norm_rect_in"),n.o(t),Gn(e,n),Wu(this,e),this.outputConfidenceMasks&&(tt(e,"confidence_masks"),Ke(n,"CONFIDENCE_MASKS:confidence_masks"),Xi(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>Zi(this,i,!0,!this.j)),ke(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],ke(this,r)})),this.outputCategoryMask&&(tt(e,"category_mask"),Ke(n,"CATEGORY_MASK:category_mask"),Xi(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=Zi(this,r,!1,!this.j),ke(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,ke(this,r)})),tt(e,"quality_scores"),Ke(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,ke(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Rr.prototype.segment=Rr.prototype.segment,Rr.prototype.setOptions=Rr.prototype.o,Rr.createFromModelPath=function(e,t){return Ve(Rr,e,{baseOptions:{modelAssetPath:t}})},Rr.createFromModelBuffer=function(e,t){return Ve(Rr,e,{baseOptions:{modelAssetBuffer:t}})},Rr.createFromOptions=function(e,t){return Ve(Rr,e,t)};var Kn=class extends Nn{constructor(e,t){super(new or(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Pe(e=this.h=new S3,0,1,t=new kt)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?dt(this.h,2,so(e.displayNamesLocale)):"displayNamesLocale"in e&&dt(this.h,2),e.maxResults!==void 0?Dr(this.h,3,e.maxResults):"maxResults"in e&&dt(this.h,3),e.scoreThreshold!==void 0?_e(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&dt(this.h,4),e.categoryAllowlist!==void 0?eu(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&dt(this.h,5),e.categoryDenylist!==void 0?eu(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&dt(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},ar(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},zr(this,e,n,t),this.j}m(){var e=new Tn;yt(e,"input_frame_gpu"),yt(e,"norm_rect"),tt(e,"detections");const t=new $n;xr(t,Nx,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),ht(n,"IMAGE:input_frame_gpu"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"DETECTIONS:detections"),n.o(t),Gn(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=Jy(i),this.j.detections.push(E3(r));ke(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{ke(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Kn.prototype.detectForVideo=Kn.prototype.F,Kn.prototype.detect=Kn.prototype.D,Kn.prototype.setOptions=Kn.prototype.o,Kn.createFromModelPath=async function(e,t){return Ve(Kn,e,{baseOptions:{modelAssetPath:t}})},Kn.createFromModelBuffer=function(e,t){return Ve(Kn,e,{baseOptions:{modelAssetBuffer:t}})},Kn.createFromOptions=function(e,t){return Ve(Kn,e,t)};var mf=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function _0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function C0(e){try{const t=new mf(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{Vu(e)}}mf.prototype.close=mf.prototype.close;var Rn=class extends Nn{constructor(e,t){super(new or(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Pe(e=this.h=new k3,0,1,t=new kt),this.v=new p3,Pe(this.h,0,3,this.v),this.j=new h3,Pe(this.h,0,2,this.j),Dr(this.j,4,1),_e(this.j,2,.5),_e(this.v,2,.5),_e(this.h,4,.5)}get baseOptions(){return Je(this.h,kt,1)}set baseOptions(e){Pe(this.h,0,1,e)}o(e){return"numPoses"in e&&Dr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&_e(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&_e(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&_e(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,_0(this),ar(this,e,r),C0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,_0(this),zr(this,e,s,t),C0(this)}m(){var e=new Tn;yt(e,"image_in"),yt(e,"norm_rect"),tt(e,"normalized_landmarks"),tt(e,"world_landmarks"),tt(e,"segmentation_masks");const t=new $n;xr(t,Tx,this.h);const n=new hn;Hn(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),ht(n,"IMAGE:image_in"),ht(n,"NORM_RECT:norm_rect"),Ke(n,"NORM_LANDMARKS:normalized_landmarks"),Ke(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),Gn(e,n),Wu(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=Aa(i),this.landmarks.push(Gu(r));ke(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],ke(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=Li(i),this.worldLandmarks.push(Yo(r));ke(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],ke(this,r)}),this.outputSegmentationMasks&&(Ke(n,"SEGMENTATION_MASK:segmentation_masks"),Xi(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>Zi(this,i,!0,!this.s)),ke(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],ke(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Rn.prototype.detectForVideo=Rn.prototype.F,Rn.prototype.detect=Rn.prototype.D,Rn.prototype.setOptions=Rn.prototype.o,Rn.createFromModelPath=function(e,t){return Ve(Rn,e,{baseOptions:{modelAssetPath:t}})},Rn.createFromModelBuffer=function(e,t){return Ve(Rn,e,{baseOptions:{modelAssetBuffer:t}})},Rn.createFromOptions=function(e,t){return Ve(Rn,e,t)},Rn.POSE_CONNECTIONS=B3;const Bx="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",Fx=Bx,su=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let l=0,d=0,h=0;t>=0&&t<60?(l=s,d=i,h=0):t<120?(l=i,d=s,h=0):t<180?(l=0,d=s,h=i):t<240?(l=0,d=i,h=s):t<300?(l=i,d=0,h=s):(l=s,d=0,h=i);const m=w=>Math.max(0,Math.min(255,Math.round((w+a)*255)));return{r:m(l),g:m(d),b:m(h)}}return null},gp=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),j0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),Ox=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},O3=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const l=e.canvas;return s=l.width,i=l.height,r=l.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(l){console.warn("[ColorDetector] Failed to extract category mask data:",l)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},$x=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=su(t),a=su(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:l="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:m=50,minGapRatio:w=.05}=r,S=new Image;S.crossOrigin="anonymous",S.onload=()=>{try{const N=S.width>d?d/S.width:1,R=Math.max(1,Math.round(S.width*N)),F=Math.max(1,Math.round(S.height*N)),K=document.createElement("canvas");K.width=R,K.height=F;const A=K.getContext("2d");if(!A){s({suggestion:"None",stats:{mode:"colorMask"}});return}A.drawImage(S,0,0,R,F);const g=A.getImageData(0,0,R,F),{data:k}=g,T=h*h,b={minY:F,maxY:-1,pixels:0},B={minY:F,maxY:-1,pixels:0},D=new Uint8Array(R*F);for(let X=0;X<F;X+=1)for(let ee=0;ee<R;ee+=1){const Ee=(X*R+ee)*4,xe=X*R+ee,ge=k[Ee],J=k[Ee+1],oe=k[Ee+2],Z=(ge-i.r)*(ge-i.r)+(J-i.g)*(J-i.g)+(oe-i.b)*(oe-i.b),pe=(ge-a.r)*(ge-a.r)+(J-a.g)*(J-a.g)+(oe-a.b)*(oe-a.b);Z<T&&Z<pe?(b.pixels+=1,X<b.minY&&(b.minY=X),X>b.maxY&&(b.maxY=X),D[xe]=1):pe<T&&pe<Z&&(B.pixels+=1,X<B.minY&&(B.minY=X),X>B.maxY&&(B.maxY=X),D[xe]=2)}const G={mode:"colorMask",pixelsA:b.pixels,pixelsB:B.pixels,minYA:b.pixels>0?b.minY:null,maxYA:b.pixels>0?b.maxY:null,minYB:B.pixels>0?B.minY:null,maxYB:B.pixels>0?B.maxY:null,width:R,height:F},le=b.pixels>=m,V=B.pixels>=m;let Y="None";if(le&&!V)Y="A";else if(!le&&V)Y="B";else if(le&&V){let X,ee;l==="top"?(X=b.minY,ee=B.minY):(X=b.maxY,ee=B.maxY);const Ee=Math.abs(X-ee),xe=F*w;Ee>=xe&&(Y=l==="top"?X<ee?"A":"B":X>ee?"A":"B")}let te=null;try{const X=document.createElement("canvas");X.width=R,X.height=F;const ee=X.getContext("2d");ee.drawImage(S,0,0,R,F);const Ee=ee.getImageData(0,0,R,F),xe=Ee.data,ge=(Z,pe)=>{xe[Z]=Math.round(xe[Z]*.3+pe.r*.7),xe[Z+1]=Math.round(xe[Z+1]*.3+pe.g*.7),xe[Z+2]=Math.round(xe[Z+2]*.3+pe.b*.7),xe[Z+3]=255},J={r:255,g:82,b:97},oe={r:80,g:170,b:255};for(let Z=0;Z<D.length;Z+=1)D[Z]===1?ge(Z*4,J):D[Z]===2&&ge(Z*4,oe);ee.putImageData(Ee,0,0),te=X.toDataURL("image/png")}catch(X){console.warn("[ColorDetector] Failed generating preview",X)}s({suggestion:Y,stats:G,preview:te})}catch(N){console.error("[ColorDetector] Error processing frame:",N),s({suggestion:"None",stats:{mode:"colorMask"}})}},S.onerror=N=>{console.error("[ColorDetector] Failed to load frame image",N),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?S.src=e:typeof e=="string"?S.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),N0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const N of e){const R=N.y*t+N.x;R>=0&&R<i.length&&(i[R]=1)}const a=[],l=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const N of e){const R=N.y*t+N.x;if(R<0||R>=i.length||i[R]!==1)continue;let F=0;const K=[{x:N.x,y:N.y}];i[R]=2;const A=[];let g=0;for(;g<K.length;){const{x:k,y:T}=K[g++];F++,A.push({x:k,y:T});for(const b of l){const B=k+b.dx,D=T+b.dy;if(B>=0&&B<t&&D>=0&&D<n){const G=D*t+B;G>=0&&G<i.length&&i[G]===1&&(i[G]=2,K.push({x:B,y:D}))}}}a.push({size:F,pixels:A})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((N,R)=>R.size>N.size?R:N).size,m=Math.max(1,Math.floor(h*s));let w=0;const S=[];for(const N of a)N.size>=m&&(w+=N.size,S.push(...N.pixels));return{count:w,pixels:S,largestBlobSize:h,minBlobSize:m,totalBlobs:a.length,filteredBlobs:a.filter(N=>N.size>=m).length}},Dx=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=su(t),i=su(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await gp(e),l=a.naturalWidth||a.width,d=a.naturalHeight||a.height,m=(await yp()).segment(a),{maskData:w,maskWidth:S,maskHeight:N,isRGBA:R}=O3(m.categoryMask,l,d);if(!w)throw new Error("Failed to extract segmentation mask data");const F=new Uint8ClampedArray(l*d*4),K=l/S,A=d/N;for(let O=0;O<d;O++)for(let H=0;H<l;H++){const q=Math.min(S-1,Math.floor(H/K)),$=(Math.min(N-1,Math.floor(O/A))*S+q)*(R?4:1);let y=0;w&&$<w.length&&(y=w[$]);const P=y!==0&&y!==2?255:0,j=(O*l+H)*4;F[j]=P,F[j+1]=P,F[j+2]=P,F[j+3]=255}const g=document.createElement("canvas");g.width=l,g.height=d;const k=g.getContext("2d");k.drawImage(a,0,0,l,d);const T=k.getImageData(0,0,l,d).data,b=r.maskThreshold||100,B=r.colorThreshold??95,D=r.anchor||"top",G=B*B,le=r.scanDepth??1,V=r.stride||2;let Y=D==="top"?d:0,te=!1;if(D==="top")for(let O=0;O<d;O+=V){for(let H=0;H<l;H+=V)if(F[(O*l+H)*4]>=b){Y=O,te=!0;break}if(te)break}else for(let O=d-1;O>=0;O-=V){for(let H=0;H<l;H+=V)if(F[(O*l+H)*4]>=b){Y=O,te=!0;break}if(te)break}let X,ee,Ee;if(r.manualBounds&&D==="manually")X=r.manualBounds.topY,ee=r.manualBounds.bottomY,Ee=ee-X,te||(Y=X);else{if(!te)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};Ee=le?Math.floor(d*le):d,D==="top"?(X=Y,ee=Math.min(d,Y+Ee)):(X=Math.max(0,Y-Ee),ee=Y)}const xe=[],ge=[];for(let O=X;O<ee;O+=V)for(let H=0;H<l;H+=V){const q=(O*l+H)*4;if(F[q]<b)continue;const ue=T[q],$=T[q+1],y=T[q+2],P=j0({r:ue,g:$,b:y},s),j=j0({r:ue,g:$,b:y},i);P<G&&P<j?xe.push({x:H,y:O}):j<G&&j<P&&ge.push({x:H,y:O})}const J=r.minBlobRatio??.1,oe=N0(xe,l,d,V,J),Z=N0(ge,l,d,V,J),pe=oe.count,Me=Z.count,Be=oe.pixels.map(O=>({...O,idx:(O.y*l+O.x)*4})),Xe=Z.pixels.map(O=>({...O,idx:(O.y*l+O.x)*4})),Fe=50;let ze="None",Q=null;pe>Fe&&pe>Me?(ze="A",Q={color:"A",pixelCount:pe,minY:X,maxY:ee,anchorY:Y,rawPixels:xe.length,largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize}):Me>Fe&&Me>pe&&(ze="B",Q={color:"B",pixelCount:Me,minY:X,maxY:ee,anchorY:Y,rawPixels:ge.length,largestBlobSize:Z.largestBlobSize,minBlobSize:Z.minBlobSize});let de=null,ye=null;try{const O=document.createElement("canvas");O.width=l,O.height=d;const H=O.getContext("2d");H.drawImage(a,0,0,l,d),H.fillStyle="rgba(0,0,0,0.6)",H.fillRect(0,0,l,d),H.globalCompositeOperation="destination-out",H.fillStyle="rgba(0,0,0,1)",H.fillRect(0,X,l,ee-X),H.globalCompositeOperation="destination-over",H.drawImage(a,0,0,l,d),H.globalCompositeOperation="source-over";const q=H.createImageData(l,d),ue=q.data;for(let z=X;z<ee;z+=1)for(let W=0;W<l;W+=1){const ce=(z*l+W)*4;F[ce]>=b&&(ue[ce]=0,ue[ce+1]=255,ue[ce+2]=255,ue[ce+3]=90)}H.putImageData(q,0,0);const $=H.createImageData(l,d),y=$.data;for(const z of Be){const W=z.idx;W>=0&&W<y.length-3&&(y[W]=255,y[W+1]=0,y[W+2]=0,y[W+3]=180)}for(const z of Xe){const W=z.idx;W>=0&&W<y.length-3&&(y[W]=0,y[W+1]=100,y[W+2]=255,y[W+3]=180)}H.putImageData($,0,0),H.globalCompositeOperation="source-over",H.strokeStyle="#00FF00",H.lineWidth=3,H.setLineDash([]),H.beginPath(),H.moveTo(0,X),H.lineTo(l,X),H.stroke(),H.strokeStyle="#FFFF00",H.lineWidth=3,H.setLineDash([5,5]),H.beginPath(),H.moveTo(0,ee),H.lineTo(l,ee),H.stroke(),Y!==X&&Y!==ee&&(H.strokeStyle="#FF00FF",H.lineWidth=2,H.setLineDash([2,2]),H.beginPath(),H.moveTo(0,Y),H.lineTo(l,Y),H.stroke()),de=O.toDataURL("image/png");const P=document.createElement("canvas");P.width=l,P.height=d;const j=P.getContext("2d"),_=j.createImageData(l,d),I=_.data;for(let z=0;z<l*d;z+=1){const W=z*4,he=F[z*4]>=b?255:0;I[W]=he,I[W+1]=he,I[W+2]=he,I[W+3]=255}j.putImageData(_,0,0),ye=P.toDataURL("image/png")}catch(O){console.warn("[ColorDetector] Failed generating preview",O)}const ve={mode:"segmentation",width:l,height:d,pixelsA:pe,pixelsB:Me,rawPixelsA:xe.length,rawPixelsB:ge.length,tipY:Y,scanDepth:Ee,scanDepthRatio:le,anchor:D,bestArm:Q,blobInfoA:{largestBlobSize:oe.largestBlobSize,minBlobSize:oe.minBlobSize,totalBlobs:oe.totalBlobs,filteredBlobs:oe.filteredBlobs,droppedPixels:xe.length-pe},blobInfoB:{largestBlobSize:Z.largestBlobSize,minBlobSize:Z.minBlobSize,totalBlobs:Z.totalBlobs,filteredBlobs:Z.filteredBlobs,droppedPixels:ge.length-Me},minBlobRatio:J};return{suggestion:ze,stats:ve,preview:de,maskPreview:ye}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},zx=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},iu=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),Ux=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,l=-1/0;for(const w of e){const S=iu(w,i);S>l&&(l=S,a=w)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,m=!0;for(;m&&h<n;){m=!1;for(let N=0;N<e.length;N++){let R=0,F=1/0;for(let K=0;K<s.length;K++){const A=iu(e[N],s[K]);A<F&&(F=A,R=K)}d[N]!==R&&(d[N]=R,m=!0)}const w=Array.from({length:s.length},()=>new Array(r).fill(0)),S=new Array(s.length).fill(0);e.forEach((N,R)=>{const F=d[R];S[F]+=1;for(let K=0;K<r;K++)w[F][K]+=N[K]});for(let N=0;N<s.length;N++)S[N]===0?s[N]=e[Math.floor(Math.random()*e.length)].slice():s[N]=w[N].map(R=>R/S[N]);h+=1}return{assignments:d,centroids:s}},Hx=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await yp(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minClothPixels||80,a=e.slice(0,r),l=[];let d=0;for(const g of a)try{const k=await gp(g.frameDataUrl),T=k.naturalWidth||k.width,b=k.naturalHeight||k.height,B=n.segment(k),{maskData:D,maskWidth:G,maskHeight:le,isRGBA:V}=O3(B.categoryMask,T,b);if(!D){d+=1;continue}const Y=document.createElement("canvas");Y.width=T,Y.height=b;const te=Y.getContext("2d");te.drawImage(k,0,0,T,b);const X=te.getImageData(0,0,T,b).data,ee=T/G,Ee=b/le;let xe=0,ge=0,J=0,oe=0,Z=0,pe=0;for(let Be=0;Be<b;Be+=s){const Xe=Math.min(le-1,Math.floor(Be/Ee));for(let Fe=0;Fe<T;Fe+=s){const ze=Math.min(G-1,Math.floor(Fe/ee)),Q=(Xe*G+ze)*(V?4:1);if(D[Q]===4){const ye=(Be*T+Fe)*4,ve=X[ye],O=X[ye+1],H=X[ye+2];xe+=ve,ge+=O,J+=H,oe+=Fe,Z+=Be,pe+=1}}}if(pe<i){d+=1;continue}const Me={r:xe/pe,g:ge/pe,b:J/pe};l.push({moveId:g.moveId,meanColor:Me,feature:[Me.r/255,Me.g/255,Me.b/255],centroidX:oe/pe/T,centroidY:Z/pe/b,pixelCount:pe,existingPlayer:g.existingPlayer||null})}catch(k){console.warn("[ColorDetector] Cloth analysis failed for frame",g.moveId,k),d+=1}if(l.length<2)throw new Error("Not enough frames with detectable clothing");const h=l.map(g=>g.feature),{assignments:m,centroids:w}=Ux(h,Math.min(2,l.length)),S=w.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));m.forEach((g,k)=>{const T=l[k],b=S[g];b.samples.push({moveId:T.moveId,centroidX:T.centroidX,centroidY:T.centroidY,pixelCount:T.pixelCount}),b.sumR+=T.meanColor.r,b.sumG+=T.meanColor.g,b.sumB+=T.meanColor.b,b.sumPixels+=T.pixelCount,b.sumBrightness+=(T.meanColor.r+T.meanColor.g+T.meanColor.b)/3,(T.existingPlayer==="Player A"||T.existingPlayer==="Player B")&&(b.labelCounts[T.existingPlayer]+=1)});const N={};S.forEach((g,k)=>{const T=g.labelCounts["Player A"],b=g.labelCounts["Player B"];T>b?N[k]="Player A":b>T&&(N[k]="Player B")});const R=S.map((g,k)=>{const T=g.sumR/Math.max(1,g.samples.length),b=g.sumG/Math.max(1,g.samples.length),B=g.sumB/Math.max(1,g.samples.length);return{idx:k,hue:zx(T,b,B),brightness:g.sumBrightness/Math.max(1,g.samples.length)}}).sort((g,k)=>g.hue-k.hue||g.brightness-k.brightness),F=["Player A","Player B"];R.forEach(({idx:g})=>{if(!N[g]){const k=Object.values(N),T=F.find(b=>!k.includes(b))||"Player A";N[g]=T}});const K={};m.forEach((g,k)=>{const T=l[k],b=N[g]||(g===0?"Player A":"Player B"),B=w[g],D=w[g===0?1:0],G=iu(T.feature,B),le=D?iu(T.feature,D):G,V=D?Math.max(0,1-G/(G+le+1e-6)):1;K[T.moveId]={player:b,clusterId:g,styleLabel:`Style ${g+1}`,confidence:V,stats:{meanColor:T.meanColor,pixelCount:T.pixelCount}}});const A=S.map((g,k)=>{const T=g.sumR/Math.max(1,g.samples.length),b=g.sumG/Math.max(1,g.samples.length),B=g.sumB/Math.max(1,g.samples.length),D=Ox(T,b,B);return{id:k,styleLabel:`Style ${k+1}`,assignedPlayer:N[k]||(k===0?"Player A":"Player B"),hexColor:D,meanColor:{r:T,g:b,b:B},sampleCount:g.samples.length,avgPixels:g.sumPixels/Math.max(1,g.samples.length),avgBrightness:g.sumBrightness/Math.max(1,g.samples.length),knownAssignments:g.labelCounts}});return{assignments:K,clusters:A,analytics:{totalFrames:a.length,usedFrames:l.length,skippedFrames:d,clusters:A}}};let ed=null;const yp=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!ed){const e=await zs.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");ed=await cn.createFromOptions(e,{baseOptions:{modelAssetPath:Fx,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return ed},Gx=async e=>{try{const t=await gp(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await yp()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let l;if(i.categoryMask.getAsUint8Array)l=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(l=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,l.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=l[w*4];l=m}}else if(i.categoryMask instanceof Uint8Array)l=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const m=new Uint8Array(n*r);for(let w=0;w<n*r;w++)m[w]=h[w*4];l=m}else l=h}return await Promise.all(a.map(async h=>{const m=document.createElement("canvas");m.width=n,m.height=r;const w=m.getContext("2d");w.drawImage(t,0,0,n,r);const S=w.getImageData(0,0,n,r),N=S.data;let R=0;for(let F=0;F<l.length;F++)if(l[F]===h.id){R++;const K=F*4;h.id===0?(N[K]=N[K]*.25,N[K+1]=N[K+1]*.25,N[K+2]=N[K+2]*.25):(N[K]=(N[K]+h.color[0])/2,N[K+1]=(N[K+1]+h.color[1])/2,N[K+2]=(N[K+2]+h.color[2])/2)}return w.putImageData(S,0,0),{...h,pixelCount:R,preview:m.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},td=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,Wx=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function Vx({colorPreview:e,onClose:t}){var N,R,F,K,A,g,k,T,b,B,D,G,le,V;const[n,r]=C.useState("overview"),[s,i]=C.useState(null),[a,l]=C.useState(!1),d=async()=>{if(e!=null&&e.original){l(!0);try{const Y=await Gx(e.original);i(Y)}catch(Y){console.error("Failed to run multiclass segmentation:",Y)}finally{l(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,m=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,w=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",S=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return c.jsx("div",{className:"image-modal",onClick:t,children:c.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:Y=>Y.stopPropagation(),children:[c.jsx("button",{className:"close-modal",onClick:t,children:""}),c.jsxs("div",{className:"color-preview-tabs",children:[c.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),c.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"color-preview-grid",children:[c.jsxs("div",{className:"color-preview-panel",children:[c.jsx("h3",{children:"Original Frame"}),c.jsx("img",{src:e.original,alt:"Original frame"})]}),c.jsxs("div",{className:"color-preview-panel",children:[c.jsx("h3",{children:"Mask View"}),e.preview?c.jsxs(c.Fragment,{children:[c.jsx("p",{className:"mask-label",children:((N=e.stats)==null?void 0:N.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((R=e.stats)==null?void 0:R.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),c.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?c.jsxs(c.Fragment,{children:[c.jsx("p",{className:"mask-label",children:((F=e.stats)==null?void 0:F.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),c.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):c.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&c.jsxs("div",{className:"color-preview-stats",children:[c.jsxs("div",{className:"color-preview-meta",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${m.toLocaleString()} px)`:""]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Method:"})," ",S]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Anchor:"})," ",w]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&c.jsxs("div",{children:[c.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&c.jsxs("div",{children:[c.jsx("strong",{children:"Person coverage:"})," ",Wx(e.stats.personPixels)]}),e.stats.reason&&c.jsxs("div",{children:[c.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),c.jsxs("div",{className:"color-preview-calibration",children:[c.jsxs("div",{className:"calibration-card",children:[c.jsxs("div",{className:"calibration-header",children:[c.jsx("span",{className:"player-label",children:"Player A color"}),c.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),c.jsx("code",{children:e.colorA||""}),e.calibrationA&&c.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),c.jsxs("div",{className:"calibration-card",children:[c.jsxs("div",{className:"calibration-header",children:[c.jsx("span",{className:"player-label",children:"Player B color"}),c.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),c.jsx("code",{children:e.colorB||""}),e.calibrationB&&c.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?c.jsxs("div",{className:"segmentation-breakdown",children:[c.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),c.jsxs("div",{className:"segmentation-card",children:[c.jsx("h4",{children:"Scan Zone"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Scan Depth:"})," ",((K=e.stats.scanDepth)==null?void 0:K.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&c.jsxs("p",{children:[c.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),c.jsxs("div",{className:"segmentation-card",children:[c.jsx("h4",{children:"Color A Pixels"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Filtered:"})," ",((A=e.stats.pixelsA)==null?void 0:A.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&c.jsxs("p",{children:[c.jsx("strong",{children:"Raw (before blob filter):"})," ",((g=e.stats.rawPixelsA)==null?void 0:g.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Largest blob:"})," ",((k=e.stats.blobInfoA.largestBlobSize)==null?void 0:k.toLocaleString())||0," px"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Min blob size:"})," ",((T=e.stats.blobInfoA.minBlobSize)==null?void 0:T.toLocaleString())||0," px"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),c.jsxs("div",{className:"segmentation-card",children:[c.jsx("h4",{children:"Color B Pixels"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Filtered:"})," ",((b=e.stats.pixelsB)==null?void 0:b.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&c.jsxs("p",{children:[c.jsx("strong",{children:"Raw (before blob filter):"})," ",((B=e.stats.rawPixelsB)==null?void 0:B.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Largest blob:"})," ",((D=e.stats.blobInfoB.largestBlobSize)==null?void 0:D.toLocaleString())||0," px"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Min blob size:"})," ",((G=e.stats.blobInfoB.minBlobSize)==null?void 0:G.toLocaleString())||0," px"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&c.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[c.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,c.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Pixel Count:"})," ",((le=e.stats.bestArm.pixelCount)==null?void 0:le.toLocaleString())||0]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?c.jsxs("div",{className:"segmentation-breakdown",children:[c.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((V=e.stats.armRegions)==null?void 0:V.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((Y,te)=>{const X=e.stats.bestArm&&Y.category===e.stats.bestArm.category&&Y.dominantColor===e.stats.bestArm.dominantColor;return c.jsxs("div",{className:"segmentation-card",style:{border:X?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:X?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[c.jsxs("h4",{children:["Arm ",te+1,": ",Y.categoryName,X&&c.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Dominant Color:"})," ",c.jsxs("span",{style:{color:Y.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",Y.dominantColor]})]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Pixels A:"})," ",Y.pixelsA||0," | ",c.jsx("strong",{children:"Pixels B:"})," ",Y.pixelsB||0]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Total arm pixels:"})," ",Y.pixelCount||0]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Vertical span:"})," Y=",Y.minY,"  ",Y.maxY," (Anchor Y: ",Y.anchorY,")"]})]},te)}):c.jsx("p",{children:"No arms detected with matching colors"})]}):c.jsxs("div",{className:"color-preview-breakdown",children:[c.jsxs("div",{className:"breakdown-card",children:[c.jsx("h4",{children:"Player A band"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",td(e.stats.pixelsA,m),")"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),c.jsxs("div",{className:"breakdown-card",children:[c.jsx("h4",{children:"Player B band"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",td(e.stats.pixelsB,m),")"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):c.jsxs("div",{className:"multiclass-view",children:[c.jsxs("div",{className:"multiclass-header",children:[c.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),c.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&c.jsxs("div",{className:"loading-indicator",children:[c.jsx("div",{className:"spinner"}),c.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&c.jsx("div",{className:"multiclass-grid",children:s.map(Y=>c.jsxs("div",{className:"multiclass-card",children:[c.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${Y.color.join(",")})`},children:[c.jsxs("h4",{children:[Y.id,". ",Y.name]}),c.jsx("span",{className:"multiclass-badge",children:td(Y.pixelCount,m)})]}),c.jsx("p",{className:"multiclass-desc",children:Y.desc}),c.jsx("div",{className:"multiclass-preview-container",children:c.jsx("img",{src:Y.preview,alt:Y.name})}),c.jsxs("div",{className:"multiclass-footer",children:[Y.pixelCount.toLocaleString()," pixels"]})]},Y.id))}),!a&&!s&&c.jsxs("div",{className:"error-message",children:[c.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),c.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function Yx({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=C.useState(0),[i,a]=C.useState(0),[l,d]=C.useState(!1),[h,m]=C.useState(!1),w=C.useRef(null),[S,N]=C.useState(0),[R,F]=C.useState(0),K=C.useRef(null),A=D0.useCallback((B,D,G,le,V,Y)=>{B.clearRect(0,0,le,V),Y&&B.drawImage(Y,0,0),B.fillStyle="rgba(0, 255, 0, 0.2)",B.fillRect(0,D,le,G-D),B.strokeStyle="#00FF00",B.lineWidth=3,B.setLineDash([]),B.beginPath(),B.moveTo(0,D),B.lineTo(le,D),B.stroke(),B.strokeStyle="#FFFF00",B.setLineDash([]),B.beginPath(),B.moveTo(0,G),B.lineTo(le,G),B.stroke(),B.fillStyle="#00FF00",B.font="16px Arial",B.fillText("Top",10,D-5),B.fillStyle="#FFFF00",B.fillText("Bottom",10,G+20)},[]);C.useEffect(()=>{if(!e||!w.current)return;const B=new Image;B.crossOrigin="anonymous",B.onload=()=>{const D=w.current,G=D.getContext("2d");D.width=B.width,D.height=B.height,F(B.width),N(B.height),K.current=B;const le=Math.floor(B.height*.2),V=Math.floor(B.height*.8);s(le),a(V),A(G,le,V,B.width,B.height,B)},e.startsWith("data:image")?B.src=e:B.src=`data:image/jpeg;base64,${e}`},[e]),C.useEffect(()=>{if(!w.current||S===0||!K.current)return;const B=w.current.getContext("2d");A(B,r,i,R,S,K.current)},[r,i,R,S]);const g=B=>{const D=w.current,G=D.getBoundingClientRect(),le=Math.floor((B.clientY-G.top)*(D.height/G.height));Math.abs(le-r)<10?d(!0):Math.abs(le-i)<10&&m(!0)},k=B=>{if(!l&&!h)return;const D=w.current,G=D.getBoundingClientRect(),le=Math.floor((B.clientY-G.top)*(D.height/G.height)),V=Math.max(0,Math.min(D.height,le));if(l){const Y=Math.min(V,i-10);s(Y)}else if(h){const Y=Math.max(V,r+10);a(Y)}},T=()=>{d(!1),m(!1)},b=()=>{t({topY:r,bottomY:i})};return c.jsx("div",{className:"image-modal",onClick:n,children:c.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:B=>B.stopPropagation(),children:[c.jsx("button",{className:"close-modal",onClick:n,children:""}),c.jsx("h2",{children:"Set Manual Scan Area"}),c.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines to define the scan area"}),c.jsx("canvas",{ref:w,onMouseDown:g,onMouseMove:k,onMouseUp:T,onMouseLeave:T,style:{cursor:l||h?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),c.jsx("div",{className:"manual-scan-info",children:c.jsxs("p",{children:[c.jsx("strong",{children:"Top Y:"})," ",r," | ",c.jsx("strong",{children:"Bottom Y:"})," ",i," | ",c.jsx("strong",{children:"Height:"})," ",i-r,"px"]})}),c.jsxs("div",{className:"manual-scan-actions",children:[c.jsx("button",{onClick:b,className:"save-btn",children:"Save Bounds"}),c.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const No=ku(),Kx="adminPassword",sl=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),T0=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function Xx({sessionGameId:e}){var Oe,Ue,Ye,Et,vn;const[t,n]=C.useState(null),[r,s]=C.useState(!0),[i,a]=C.useState(null),[l,d]=C.useState(null),[h,m]=C.useState(null),[w,S]=C.useState("all"),[N,R]=C.useState(""),[F,K]=C.useState(!1),[A,g]=C.useState({}),[k,T]=C.useState({current:0,total:0}),[b,B]=C.useState("#FF0000"),[D,G]=C.useState("#0000FF"),[le,V]=C.useState(!1),[Y,te]=C.useState(!1),[X,ee]=C.useState({}),[Ee,xe]=C.useState({current:0,total:0}),[ge,J]=C.useState("bottom"),[oe,Z]=C.useState(100),[pe,Me]=C.useState(null),[Be,Xe]=C.useState(null),[Fe,ze]=C.useState(!1),[Q,de]=C.useState(null),[ye,ve]=C.useState(!1),[O,H]=C.useState(null),[q,ue]=C.useState(""),$=C.useCallback(async L=>{if(!L)return{suggestion:"None",stats:null};try{const ae=await Dx(L,b,D,{anchor:ge,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:ge==="manually"&&Be?null:oe/100,manualBounds:ge==="manually"?Be:null});if(ae)return ae}catch(ae){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",ae)}return $x(L,b,D,{anchor:ge})},[b,D,ge,oe,Be]);C.useEffect(()=>{const L=localStorage.getItem(Kx);L&&R(L)},[]),C.useEffect(()=>{e&&N&&P()},[e,N]);const y=L=>{if(!L||typeof L.h>"u")return null;const ae=(L.h||0)*2,ne=(L.s||0)/255,re=(L.v||0)/255,we=re*ne,Le=we*(1-Math.abs(ae/60%2-1)),ut=re-we;let De=0,ot=0,vt=0;ae>=0&&ae<60?(De=we,ot=Le,vt=0):ae<120?(De=Le,ot=we,vt=0):ae<180?(De=0,ot=we,vt=Le):ae<240?(De=0,ot=Le,vt=we):ae<300?(De=Le,ot=0,vt=we):(De=we,ot=0,vt=Le);const Qt=nn=>{const wn=Math.round((nn+ut)*255).toString(16);return wn.length===1?"0"+wn:wn};return`#${Qt(De)}${Qt(ot)}${Qt(vt)}`.toUpperCase()},P=async()=>{var L,ae,ne,re;if(N){s(!0),a(null);try{const we=await fetch(`${No}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":N}});if(!we.ok)throw new Error(`Failed to load session (${we.status})`);const Le=await we.json();n(Le);let ut=null,De=null,ot="";if(Le.colorA&&Le.colorB?(ut=Le.colorA,De=Le.colorB,ot="session root"):(ae=(L=Le.metadata)==null?void 0:L.config)!=null&&ae.colorA&&((re=(ne=Le.metadata)==null?void 0:ne.config)!=null&&re.colorB)&&(ut=Le.metadata.config.colorA,De=Le.metadata.config.colorB,ot="session metadata"),ut&&De)B(ut),G(De),console.log(`[MoveHistoryEditor]  Loaded colors from ${ot}:`,ut,De);else try{const vt=JSON.parse(localStorage.getItem("calibrationA")||"null"),Qt=JSON.parse(localStorage.getItem("calibrationB")||"null");if(vt&&Qt){const nn=y(vt),wn=y(Qt);nn&&wn?(B(nn),G(wn),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",nn,wn)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch(vt){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",vt),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(we){console.error("[MoveHistoryEditor] Error loading session:",we),a(we.message)}finally{s(!1)}}},j=async(L,ae)=>{if(!(!e||!L||!N))try{const ne=await fetch(`${No}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent(L)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":N},body:JSON.stringify({player:ae})});if(!ne.ok)throw new Error(`Failed to update player (${ne.status})`);n(re=>re&&{...re,moves:re.moves.map(we=>we._id===L?{...we,player:ae}:we)}),g(re=>{const we={...re};return delete we[L],we}),console.log("[MoveHistoryEditor] Player updated:",L,ae)}catch(ne){console.error("[MoveHistoryEditor] Error updating player:",ne),alert("Failed to update player: "+ne.message)}},_=async()=>{if(!(!e||!N)){K(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",b,"Player B:",D);const L=qe.filter(ne=>ne.camera_frame);if(L.length===0){alert("No moves with camera frames to process");return}T({current:0,total:L.length}),console.log(`[MoveHistoryEditor] Processing ${L.length} moves one by one...`);let ae=0;for(const ne of L){T({current:ae+1,total:L.length});try{const re=await fetch(`${No}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":N},body:JSON.stringify({sessionGameId:e,moveId:ne._id,colorA:b,colorB:D,cameraPosition:ge==="top"||ge==="bottom"?ge:void 0})});if(re.ok){const we=await re.json();ue(""),g(Le=>({...Le,[ne._id]:{player:we.suggestion==="A"?"Player A":we.suggestion==="B"?"Player B":"None",confidence:we.confidence,rawResponse:we.rawResponse}})),ae++,console.log(`[MoveHistoryEditor]  Processed ${ae}/${L.length}: ${we.suggestion}`)}else re.status===503?ue(" Retrying..."):ue(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${ne._id}`)}catch(re){ue(""),console.error(`[MoveHistoryEditor] Error processing move ${ne._id}:`,re)}}console.log("[MoveHistoryEditor] AI identification complete:",ae,"moves processed"),alert(`AI identified ${ae} moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in AI identification:",L),alert("AI identification failed: "+L.message)}finally{K(!1),T({current:0,total:0}),ue("")}}},I=async()=>{if(!(!e||!N)){K(!0),g({});try{console.log("[MoveHistoryEditor] Starting AI identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",b,"Player B:",D);const L=qe.filter(ne=>ne.camera_frame&&(!ne.player||ne.player==="Unknown"||ne.player==="None"));if(L.length===0){alert("No unknown moves with camera frames to process");return}T({current:0,total:L.length}),console.log(`[MoveHistoryEditor] Processing ${L.length} unknown moves one by one...`);let ae=0;for(const ne of L){T({current:ae+1,total:L.length});try{const re=await fetch(`${No}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":N},body:JSON.stringify({sessionGameId:e,moveId:ne._id,colorA:b,colorB:D,cameraPosition:ge==="top"||ge==="bottom"?ge:void 0})});if(re.ok){const we=await re.json();ue(""),g(Le=>({...Le,[ne._id]:{player:we.suggestion==="A"?"Player A":we.suggestion==="B"?"Player B":"None",confidence:we.confidence,rawResponse:we.rawResponse}})),ae++,console.log(`[MoveHistoryEditor]  Processed ${ae}/${L.length}: ${we.suggestion}`)}else re.status===503?ue(" Retrying..."):ue(""),console.warn(`[MoveHistoryEditor]  Failed to process move ${ne._id}`)}catch(re){ue(""),console.error(`[MoveHistoryEditor] Error processing move ${ne._id}:`,re)}}console.log("[MoveHistoryEditor] AI identification complete:",ae,"unknown moves processed"),alert(`AI identified ${ae} unknown moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in AI identification:",L),alert("AI identification failed: "+L.message)}finally{K(!1),T({current:0,total:0}),ue("")}}},z=async L=>{const ae=A[L];ae&&await j(L,ae.player)},W=async()=>{if(!(!t||!Array.isArray(t.moves))){te(!0),ee({});try{console.log("[MoveHistoryEditor] Starting color identification for all moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",b,"Player B:",D);const L=qe.filter(ne=>ne.camera_frame);if(L.length===0){alert("No moves with camera frames to process (color)");return}xe({current:0,total:L.length});let ae=0;for(const ne of L){xe({current:ae+1,total:L.length});try{const re=await $(ne.camera_frame);if(!re)continue;ee(we=>({...we,[ne._id]:{method:"color",player:re.suggestion==="A"?"Player A":re.suggestion==="B"?"Player B":"None",stats:re.stats,preview:re.preview}})),ae+=1}catch(re){console.error(`[MoveHistoryEditor] Color identify error for move ${ne._id}:`,re)}}console.log("[MoveHistoryEditor] Color identification complete:",ae,"moves processed"),alert(`Color-based method suggested players for ${ae} moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in color identification:",L),alert("Color-based identification failed: "+L.message)}finally{te(!1),xe({current:0,total:0})}}},ce=async()=>{if(!(!t||!Array.isArray(t.moves))){te(!0),ee({});try{console.log("[MoveHistoryEditor] Starting color identification for unknown moves..."),console.log("[MoveHistoryEditor]  Using colors - Player A:",b,"Player B:",D);const L=qe.filter(ne=>ne.camera_frame&&(!ne.player||ne.player==="Unknown"||ne.player==="None"));if(L.length===0){alert("No unknown moves with camera frames to process (color)");return}xe({current:0,total:L.length});let ae=0;for(const ne of L){xe({current:ae+1,total:L.length});try{const re=await $(ne.camera_frame);if(!re)continue;ee(we=>({...we,[ne._id]:{method:"color",player:re.suggestion==="A"?"Player A":re.suggestion==="B"?"Player B":"None",stats:re.stats,preview:re.preview}})),ae+=1}catch(re){console.error(`[MoveHistoryEditor] Color identify error for move ${ne._id}:`,re)}}console.log("[MoveHistoryEditor] Color identification complete:",ae,"unknown moves processed"),alert(`Color-based method suggested players for ${ae} unknown moves. Review and confirm suggestions below.`)}catch(L){console.error("[MoveHistoryEditor] Error in color identification:",L),alert("Color-based identification failed: "+L.message)}finally{te(!1),xe({current:0,total:0})}}},he=async L=>{const ae=X[L];ae&&(await j(L,ae.player),ee(ne=>{const re={...ne};return delete re[L],re}))},be=async L=>{if(!t||!Array.isArray(t.moves))return;const ae=t.moves.find(ne=>ne._id===L);if(!ae||!ae.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${L}`);const ne=await $(ae.camera_frame);if(!ne){alert("Color-based identification failed for this move.");return}ee(Le=>({...Le,[L]:{method:"color",player:ne.suggestion==="A"?"Player A":ne.suggestion==="B"?"Player B":"None",stats:ne.stats,preview:ne.preview}}));let re=null,we=null;try{re=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{re=null}try{we=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{we=null}Me({moveId:L,original:ae.camera_frame,preview:ne.preview,maskPreview:ne.maskPreview,stats:ne.stats,suggestion:ne.suggestion,colorA:b,colorB:D,calibrationA:re,calibrationB:we,anchor:ge})}catch(ne){console.error("[MoveHistoryEditor] Error color-identifying move:",ne),alert("Color-based identification failed: "+ne.message)}},Te=C.useCallback(async({mode:L})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ae=t.moves.filter(re=>re.camera_frame);if(ae.length===0){alert("No camera frames available for cloth-based identification.");return}const ne=new Set(t.moves.filter(re=>!re.player||re.player==="Unknown"||re.player==="None").map(re=>re._id));if(L==="unknown"&&ne.size===0){alert("All moves already have players assigned.");return}ve(!0),H(null);try{const re=ae.map(De=>({moveId:De._id,frameDataUrl:De.camera_frame,existingPlayer:De.player&&De.player!=="Unknown"?De.player:null})),we=await Hx(re,{maxFrames:ae.length,stride:2,minClothPixels:80});we!=null&&we.analytics&&H(we.analytics);const Le={};we!=null&&we.assignments&&Object.entries(we.assignments).forEach(([De,ot])=>{(L==="all"||ne.has(De))&&(Le[De]={method:"cloth",player:ot.player,styleLabel:ot.styleLabel,confidence:ot.confidence,stats:ot.stats})});const ut=Object.keys(Le).length;ut===0?alert(`Cloth-based method did not find suggestions for any ${L==="all"?"moves":"unknown moves"}.`):(ee(ot=>({...ot,...Le})),alert(`Cloth-based method suggested players for ${ut} ${L==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(re){console.error("[MoveHistoryEditor] Cloth identification failed:",re),alert("Cloth-based identification failed: "+re.message)}finally{ve(!1)}},[t]),$e=C.useCallback(()=>{Te({mode:"all"})},[Te]),Ze=C.useCallback(()=>{Te({mode:"unknown"})},[Te]),nt=async L=>{if(!(!e||!N))try{console.log(`[MoveHistoryEditor] Identifying single move: ${L}`);const ae=await fetch(`${No}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":N},body:JSON.stringify({sessionGameId:e,moveId:L,colorA:b,colorB:D,cameraPosition:ge==="top"||ge==="bottom"?ge:void 0})});if(ae.ok){const ne=await ae.json();g(re=>({...re,[L]:{player:ne.suggestion==="A"?"Player A":ne.suggestion==="B"?"Player B":"None",confidence:ne.confidence,rawResponse:ne.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${ne.suggestion}`)}else{const ne=await ae.json();alert(`Failed to identify move: ${ne.message}`)}}catch(ae){console.error("[MoveHistoryEditor] Error identifying move:",ae),alert("AI identification failed: "+ae.message)}},qe=((Oe=t==null?void 0:t.moves)==null?void 0:Oe.filter(L=>w==="all"?!0:L.phase===w))||[];if(r)return c.jsx("div",{className:"move-editor-container",children:c.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return c.jsx("div",{className:"move-editor-container",children:c.jsxs("div",{className:"move-editor-error",children:[c.jsx("h2",{children:"Error Loading Session"}),c.jsx("p",{children:i}),c.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return c.jsx("div",{className:"move-editor-container",children:c.jsx("div",{className:"move-editor-error",children:"Session not found"})});const at=((Ue=t.moves)==null?void 0:Ue.filter(L=>L.phase==="practice").length)||0,Ge=((Ye=t.moves)==null?void 0:Ye.filter(L=>L.phase==="experiment").length)||0;return c.jsxs("div",{className:"move-editor-container",children:[c.jsxs("header",{className:"move-editor-header",children:[c.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),c.jsxs("div",{className:"move-editor-title",children:[c.jsx("h1",{children:"Move History Editor"}),c.jsxs("div",{className:"session-info",children:[c.jsxs("span",{className:"session-id",children:["Session: ",e]}),c.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),c.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]})]}),c.jsxs("div",{className:"phase-filter",children:[c.jsxs("button",{className:`filter-btn ${w==="all"?"active":""}`,onClick:()=>S("all"),children:["All (",((Et=t.moves)==null?void 0:Et.length)||0,")"]}),c.jsxs("button",{className:`filter-btn ${w==="practice"?"active":""}`,onClick:()=>S("practice"),children:["Practice (",at,")"]}),c.jsxs("button",{className:`filter-btn ${w==="experiment"?"active":""}`,onClick:()=>S("experiment"),children:["Experiment (",Ge,")"]})]}),c.jsxs("div",{className:"bracelet-colors-controls",children:[c.jsx("button",{className:"color-picker-toggle",onClick:()=>V(!le),children:"Bracelet Colors"}),le&&c.jsxs("div",{className:"color-picker-panel",children:[c.jsxs("div",{className:"color-input-group",children:[c.jsx("label",{children:"Player A:"}),c.jsx("input",{type:"color",value:b,onChange:L=>B(L.target.value)}),c.jsx("span",{children:b})]}),c.jsxs("div",{className:"color-input-group",children:[c.jsx("label",{children:"Player B:"}),c.jsx("input",{type:"color",value:D,onChange:L=>G(L.target.value)}),c.jsx("span",{children:D})]})]})]}),c.jsxs("div",{className:"ai-controls",children:[c.jsx("button",{className:"ai-btn ai-btn-all",onClick:_,disabled:F,children:F&&k.total>0?q?`${q} ${k.current}/${k.total}`:`Processing ${k.current}/${k.total}...`:"AI Identify All"}),c.jsx("button",{className:"ai-btn ai-btn-unknown",onClick:I,disabled:F,children:F&&k.total>0?q?`${q} ${k.current}/${k.total}`:`Processing ${k.current}/${k.total}...`:"AI Identify Unknown"})]}),c.jsxs("div",{className:"color-controls",children:[c.jsx("button",{className:"ai-btn color-btn-all",onClick:W,disabled:Y,children:Y&&Ee.total>0?` Color ${Ee.current}/${Ee.total}...`:" Color Identify All"}),c.jsx("button",{className:"ai-btn ai-btn-unknown color-btn-unknown",onClick:ce,disabled:Y,children:Y&&Ee.total>0?` Color Unknown ${Ee.current}/${Ee.total}...`:" Color Identify Unknown"}),c.jsx("button",{className:"ai-btn cloth-btn",onClick:$e,disabled:ye,children:ye?" Identifying by Cloth...":" Identify by Cloth All"}),c.jsx("button",{className:"ai-btn cloth-btn",onClick:Ze,disabled:ye,children:ye?" Identifying by Cloth...":" Identify by Cloth Unknown"}),c.jsxs("div",{className:"color-anchor-toggle",children:[c.jsx("label",{children:"Color anchor:"}),c.jsxs("select",{value:ge,onChange:L=>{if(J(L.target.value),L.target.value==="manually"){const ae=(t==null?void 0:t.moves)||[];if(ae.length>0){const ne=ae[Math.floor(Math.random()*ae.length)];ne!=null&&ne.camera_frame?(de(ne.camera_frame),ze(!0)):(alert("No frames available. Please ensure moves have camera frames."),J("bottom"))}else alert("No moves available."),J("bottom")}else ze(!1),Xe(null),de(null)},children:[c.jsx("option",{value:"bottom",children:"Bottom"}),c.jsx("option",{value:"top",children:"Top"}),c.jsx("option",{value:"manually",children:"Manually"})]})]}),ge!=="manually"&&c.jsxs("div",{className:"color-scan-percentage",children:[c.jsxs("label",{children:["Scan area: ",oe,"%"]}),c.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:oe,onChange:L=>Z(Number(L.target.value)),style:{width:"120px",marginLeft:"8px"}})]}),ge==="manually"&&Be&&c.jsxs("div",{className:"manual-bounds-info",children:[c.jsxs("span",{children:["Manual: Y=",Be.topY,"  ",Be.bottomY]}),c.jsx("button",{onClick:()=>ze(!0),style:{marginLeft:"8px",padding:"4px 8px"},children:"Edit"})]})]})]}),O&&c.jsxs("section",{className:"cloth-analytics",children:[c.jsx("div",{className:"cloth-analytics-header",children:c.jsxs("div",{children:[c.jsx("h3",{children:"Cloth Styles Analytics"}),c.jsxs("p",{children:["Frames analyzed: ",O.usedFrames,"/",O.totalFrames,"  Skipped:"," ",O.skippedFrames]})]})}),c.jsx("div",{className:"cloth-style-grid",children:(vn=O.clusters)==null?void 0:vn.map(L=>c.jsxs("div",{className:"cloth-style-card",children:[c.jsxs("div",{className:"cloth-style-card-header",children:[c.jsx("span",{className:"style-label",children:L.styleLabel}),c.jsx("span",{className:"player-label",children:L.assignedPlayer})]}),c.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:L.hexColor}}),c.jsxs("div",{className:"cloth-style-stats",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Mean color:"})," ",L.hexColor]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Frames:"})," ",L.sampleCount]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Avg pixels:"})," ",sl(L.avgPixels||0)]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Avg brightness:"})," ",sl(L.avgBrightness||0)]})]})]},L.id))})]}),c.jsxs("div",{className:"move-editor-content",children:[c.jsx("div",{className:"moves-grid",children:qe.map((L,ae)=>{var ne;return c.jsxs("div",{className:`move-card ${(l==null?void 0:l._id)===L._id?"selected":""}`,onClick:()=>d(L),children:[c.jsxs("div",{className:"move-card-header",children:[c.jsxs("span",{className:"move-number",children:["#",ae+1]}),c.jsx("span",{className:`move-phase ${L.phase}`,children:L.phase})]}),L.camera_frame&&c.jsxs("div",{className:"move-image",onClick:re=>{re.stopPropagation(),m(L.camera_frame)},children:[c.jsx("img",{src:L.camera_frame,alt:`Move ${ae+1}`}),c.jsx("div",{className:"image-overlay",children:" Click to enlarge"})]}),c.jsxs("div",{className:"move-card-body",children:[c.jsxs("div",{className:"move-info-row",children:[c.jsx("span",{className:"label",children:"Type:"}),c.jsx("span",{className:"value",children:L.type})]}),A[L._id]&&(()=>{const re=A[L._id].player,Le=re==="A"||re==="Player A"?b:D;return c.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:Le,outline:`2px solid ${T0(Le,.25)}`,outlineOffset:"2px"},children:[c.jsxs("div",{className:"ai-suggestion-content",children:[c.jsx("span",{className:"ai-icon",children:""}),c.jsxs("span",{className:"ai-text",children:["AI suggests: ",c.jsx("strong",{children:A[L._id].player})]})]}),c.jsx("button",{className:"ai-confirm-btn",onClick:ut=>{ut.stopPropagation(),z(L._id)},children:" Confirm"})]})})(),X[L._id]&&(()=>{const re=X[L._id],ut=re.player==="Player A"?b:D,De=re.method||"color",ot=De==="cloth"?"":"",vt=De==="cloth"?`Cloth suggests${re.styleLabel?` (${re.styleLabel})`:""}:`:"Color suggests:",Qt=typeof re.confidence=="number"?`  ${Math.round(re.confidence*100)}% confidence`:"";return c.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:ut,outline:`2px solid ${T0(ut,.25)}`,outlineOffset:"2px"},children:[c.jsxs("div",{className:"ai-suggestion-content",children:[c.jsx("span",{className:"ai-icon",children:ot}),c.jsxs("span",{className:"ai-text",children:[vt," ",c.jsx("strong",{children:re.player}),Qt]})]}),c.jsx("button",{className:"ai-confirm-btn",onClick:nn=>{nn.stopPropagation(),he(L._id)},children:" Confirm"})]})})(),c.jsxs("div",{className:"move-info-row player-row",style:{borderColor:L.player==="Player A"?b:L.player==="Player B"?D:L.player==="None"?"#9E9E9E":"#FFC107"},children:[c.jsx("span",{className:"label",children:"Player:"}),c.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[c.jsxs("select",{className:`player-select ${(ne=L.player)==null?void 0:ne.toLowerCase().replace(" ","-")}`,value:L.player||"Unknown",onChange:re=>j(L._id,re.target.value),onClick:re=>re.stopPropagation(),style:{flex:1,borderColor:L.player==="Player A"?b:L.player==="Player B"?D:L.player==="None"?"#9E9E9E":"#FFC107"},children:[c.jsx("option",{value:"Player A",children:"Player A"}),c.jsx("option",{value:"Player B",children:"Player B"}),c.jsx("option",{value:"None",children:"None"}),c.jsx("option",{value:"Unknown",children:"Unknown"})]}),L.camera_frame&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"ai-single-btn",onClick:re=>{re.stopPropagation(),nt(L._id)},title:"Identify this move with AI",children:""}),c.jsx("button",{className:"ai-single-btn color-single-btn",onClick:re=>{re.stopPropagation(),be(L._id)},title:"Identify this move by color",children:""})]})]})]}),L.blockId!==null&&L.blockId!==void 0&&c.jsxs("div",{className:"move-info-row",children:[c.jsx("span",{className:"label",children:"Block:"}),c.jsx("span",{className:"value",children:L.blockId})]}),Array.isArray(L.position)&&L.position.length===2&&c.jsxs("div",{className:"move-info-row",children:[c.jsx("span",{className:"label",children:"Position:"}),c.jsxs("span",{className:"value",children:["(",L.position[0],", ",L.position[1],")"]})]}),c.jsxs("div",{className:"move-info-row",children:[c.jsx("span",{className:"label",children:"Time:"}),c.jsxs("span",{className:"value",children:[sl(L.elapsed,1),"s"]})]}),Number.isFinite(L.holdTime)&&L.holdTime>0&&c.jsxs("div",{className:"move-info-row",children:[c.jsx("span",{className:"label",children:"Hold:"}),c.jsxs("span",{className:"value",children:[sl(L.holdTime,2),"s"]})]})]})]},L._id||ae)})}),qe.length===0&&c.jsx("div",{className:"no-moves",children:c.jsx("p",{children:"No moves found for selected filter."})})]}),h&&c.jsx("div",{className:"image-modal",onClick:()=>m(null),children:c.jsxs("div",{className:"image-modal-content",onClick:L=>L.stopPropagation(),children:[c.jsx("button",{className:"close-modal",onClick:()=>m(null),children:""}),c.jsx("img",{src:h,alt:"Expanded view"})]})}),c.jsx(Vx,{colorPreview:pe,onClose:()=>Me(null)}),Fe&&Q&&c.jsx(Yx,{frameDataUrl:Q,onSave:L=>{Xe(L),ze(!1)},onCancel:()=>{ze(!1),J("bottom"),de(null)}})]})}const Qx=!1;function Jx(){const[e,t]=C.useState(!1),[n,r]=C.useState(null),[s,i]=C.useState(null),[a,l]=C.useState(window.location.hash),[d,h]=C.useState(!1);C.useEffect(()=>{const R=()=>{l(window.location.hash)};return window.addEventListener("hashchange",R),()=>window.removeEventListener("hashchange",R)},[]),C.useEffect(()=>(window.toggleInterface=R=>{h(R),console.log("[App] Interface "+(R?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const m=R=>{r(R),t(!0)},w=()=>{s&&!s.closed&&s.close();const R=window.location.origin+window.location.pathname+"#/detector",F=window.open(R,"BraceletDetector","width=700,height=600,left=100,top=100");i(F)};C.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),C.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(R){console.error("Error ending experience:",R),alert("Error ending experience: "+R.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let S=null;const N=a.match(/^#\/admin\/edit-moves\/(.+)$/);if(a==="#/detector")S=c.jsx(hm,{});else if(a==="#/calibrate")S=c.jsx(a5,{});else if(a==="#/detector2")S=c.jsx(l5,{});else if(a==="#/summary")S=c.jsx(Wg,{});else if(a==="#/admin")S=c.jsx(c5,{});else if(a==="#/admin/upload")S=c.jsx(d5,{});else if(N){const R=decodeURIComponent(N[1]);S=c.jsx(Xx,{sessionGameId:R},R)}else S=e?c.jsxs(c.Fragment,{children:[c.jsx(i5,{config:n,interfaceHidden:d}),c.jsx(hm,{hidden:d}),Qx,!d&&c.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[c.jsx("button",{onClick:w,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),c.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),c.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&c.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:c.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):c.jsx(Jw,{onStart:m});return c.jsx("div",{className:"App",children:S})}nd.createRoot(document.getElementById("root")).render(c.jsx(D0.StrictMode,{children:c.jsx(Jx,{})}));
