(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var z0={exports:{}},bc={},U0={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Da=Symbol.for("react.element"),P3=Symbol.for("react.portal"),T3=Symbol.for("react.fragment"),I3=Symbol.for("react.strict_mode"),B3=Symbol.for("react.profiler"),R3=Symbol.for("react.provider"),L3=Symbol.for("react.context"),F3=Symbol.for("react.forward_ref"),O3=Symbol.for("react.suspense"),$3=Symbol.for("react.memo"),D3=Symbol.for("react.lazy"),im=Symbol.iterator;function z3(e){return e===null||typeof e!="object"?null:(e=im&&e[im]||e["@@iterator"],typeof e=="function"?e:null)}var H0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},W0=Object.assign,G0={};function Co(e,t,n){this.props=e,this.context=t,this.refs=G0,this.updater=n||H0}Co.prototype.isReactComponent={};Co.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Co.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function V0(){}V0.prototype=Co.prototype;function If(e,t,n){this.props=e,this.context=t,this.refs=G0,this.updater=n||H0}var Bf=If.prototype=new V0;Bf.constructor=If;W0(Bf,Co.prototype);Bf.isPureReactComponent=!0;var om=Array.isArray,Y0=Object.prototype.hasOwnProperty,Rf={current:null},X0={key:!0,ref:!0,__self:!0,__source:!0};function K0(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Y0.call(t,r)&&!X0.hasOwnProperty(r)&&(s[r]=t[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var d=Array(c),h=0;h<c;h++)d[h]=arguments[h+2];s.children=d}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Da,type:e,key:i,ref:a,props:s,_owner:Rf.current}}function U3(e,t){return{$$typeof:Da,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Lf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Da}function H3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var am=/\/+/g;function _u(e,t){return typeof e=="object"&&e!==null&&e.key!=null?H3(""+e.key):t.toString(36)}function Nl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Da:case P3:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+_u(a,0):r,om(s)?(n="",e!=null&&(n=e.replace(am,"$&/")+"/"),Nl(s,t,n,"",function(h){return h})):s!=null&&(Lf(s)&&(s=U3(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(am,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",om(e))for(var c=0;c<e.length;c++){i=e[c];var d=r+_u(i,c);a+=Nl(i,t,n,d,s)}else if(d=z3(e),typeof d=="function")for(e=d.call(e),c=0;!(i=e.next()).done;)i=i.value,d=r+_u(i,c++),a+=Nl(i,t,n,d,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function il(e,t,n){if(e==null)return e;var r=[],s=0;return Nl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function W3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var wn={current:null},bl={transition:null},G3={ReactCurrentDispatcher:wn,ReactCurrentBatchConfig:bl,ReactCurrentOwner:Rf};function Q0(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:il,forEach:function(e,t,n){il(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return il(e,function(){t++}),t},toArray:function(e){return il(e,function(t){return t})||[]},only:function(e){if(!Lf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=Co;Xe.Fragment=T3;Xe.Profiler=B3;Xe.PureComponent=If;Xe.StrictMode=I3;Xe.Suspense=O3;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G3;Xe.act=Q0;Xe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=W0({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Rf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(d in t)Y0.call(t,d)&&!X0.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&c!==void 0?c[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){c=Array(d);for(var h=0;h<d;h++)c[h]=arguments[h+2];r.children=c}return{$$typeof:Da,type:e.type,key:s,ref:i,props:r,_owner:a}};Xe.createContext=function(e){return e={$$typeof:L3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:R3,_context:e},e.Consumer=e};Xe.createElement=K0;Xe.createFactory=function(e){var t=K0.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:F3,render:e}};Xe.isValidElement=Lf;Xe.lazy=function(e){return{$$typeof:D3,_payload:{_status:-1,_result:e},_init:W3}};Xe.memo=function(e,t){return{$$typeof:$3,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=bl.transition;bl.transition={};try{e()}finally{bl.transition=t}};Xe.unstable_act=Q0;Xe.useCallback=function(e,t){return wn.current.useCallback(e,t)};Xe.useContext=function(e){return wn.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return wn.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return wn.current.useEffect(e,t)};Xe.useId=function(){return wn.current.useId()};Xe.useImperativeHandle=function(e,t,n){return wn.current.useImperativeHandle(e,t,n)};Xe.useInsertionEffect=function(e,t){return wn.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return wn.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return wn.current.useMemo(e,t)};Xe.useReducer=function(e,t,n){return wn.current.useReducer(e,t,n)};Xe.useRef=function(e){return wn.current.useRef(e)};Xe.useState=function(e){return wn.current.useState(e)};Xe.useSyncExternalStore=function(e,t,n){return wn.current.useSyncExternalStore(e,t,n)};Xe.useTransition=function(){return wn.current.useTransition()};Xe.version="18.3.1";U0.exports=Xe;var k=U0.exports;const J0=M3(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V3=k,Y3=Symbol.for("react.element"),X3=Symbol.for("react.fragment"),K3=Object.prototype.hasOwnProperty,Q3=V3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J3={key:!0,ref:!0,__self:!0,__source:!0};function q0(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)K3.call(t,r)&&!J3.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Y3,type:e,key:i,ref:a,props:s,_owner:Q3.current}}bc.Fragment=X3;bc.jsx=q0;bc.jsxs=q0;z0.exports=bc;var l=z0.exports,xd={},Z0={exports:{}},er={},eg={exports:{}},tg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,ne){var ee=ie.length;ie.push(ne);e:for(;0<ee;){var he=ee-1>>>1,_e=ie[he];if(0<s(_e,ne))ie[he]=ne,ie[ee]=_e,ee=he;else break e}}function n(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var ne=ie[0],ee=ie.pop();if(ee!==ne){ie[0]=ee;e:for(var he=0,_e=ie.length,We=_e>>>1;he<We;){var ze=2*(he+1)-1,Ne=ie[ze],De=ze+1,se=ie[De];if(0>s(Ne,ee))De<_e&&0>s(se,Ne)?(ie[he]=se,ie[De]=ee,he=De):(ie[he]=Ne,ie[ze]=ee,he=ze);else if(De<_e&&0>s(se,ee))ie[he]=se,ie[De]=ee,he=De;else break e}}return ne}function s(ie,ne){var ee=ie.sortIndex-ne.sortIndex;return ee!==0?ee:ie.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();e.unstable_now=function(){return a.now()-c}}var d=[],h=[],g=1,x=null,w=3,_=!1,D=!1,I=!1,Y=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(ie){for(var ne=n(h);ne!==null;){if(ne.callback===null)r(h);else if(ne.startTime<=ie)r(h),ne.sortIndex=ne.expirationTime,t(d,ne);else break;ne=n(h)}}function M(ie){if(I=!1,A(ie),!D)if(n(d)!==null)D=!0,me(b);else{var ne=n(h);ne!==null&&Se(M,ne.startTime-ie)}}function b(ie,ne){D=!1,I&&(I=!1,j(O),O=-1),_=!0;var ee=w;try{for(A(ne),x=n(d);x!==null&&(!(x.expirationTime>ne)||ie&&!X());){var he=x.callback;if(typeof he=="function"){x.callback=null,w=x.priorityLevel;var _e=he(x.expirationTime<=ne);ne=e.unstable_now(),typeof _e=="function"?x.callback=_e:x===n(d)&&r(d),A(ne)}else r(d);x=n(d)}if(x!==null)var We=!0;else{var ze=n(h);ze!==null&&Se(M,ze.startTime-ne),We=!1}return We}finally{x=null,w=ee,_=!1}}var H=!1,R=null,O=-1,z=5,W=-1;function X(){return!(e.unstable_now()-W<z)}function q(){if(R!==null){var ie=e.unstable_now();W=ie;var ne=!0;try{ne=R(!0,ie)}finally{ne?J():(H=!1,R=null)}}else H=!1}var J;if(typeof y=="function")J=function(){y(q)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,pe=re.port2;re.port1.onmessage=q,J=function(){pe.postMessage(null)}}else J=function(){Y(q,0)};function me(ie){R=ie,H||(H=!0,J())}function Se(ie,ne){O=Y(function(){ie(e.unstable_now())},ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){D||_||(D=!0,me(b))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return w},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(ie){switch(w){case 1:case 2:case 3:var ne=3;break;default:ne=w}var ee=w;w=ne;try{return ie()}finally{w=ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,ne){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ee=w;w=ie;try{return ne()}finally{w=ee}},e.unstable_scheduleCallback=function(ie,ne,ee){var he=e.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?he+ee:he):ee=he,ie){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=ee+_e,ie={id:g++,callback:ne,priorityLevel:ie,startTime:ee,expirationTime:_e,sortIndex:-1},ee>he?(ie.sortIndex=ee,t(h,ie),n(d)===null&&ie===n(h)&&(I?(j(O),O=-1):I=!0,Se(M,ee-he))):(ie.sortIndex=_e,t(d,ie),D||_||(D=!0,me(b))),ie},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(ie){var ne=w;return function(){var ee=w;w=ne;try{return ie.apply(this,arguments)}finally{w=ee}}}})(tg);eg.exports=tg;var q3=eg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z3=k,qn=q3;function de(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ng=new Set,xa={};function vi(e,t){ao(e,t),ao(e+"Capture",t)}function ao(e,t){for(xa[e]=t,e=0;e<t.length;e++)ng.add(t[e])}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wd=Object.prototype.hasOwnProperty,e4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lm={},cm={};function t4(e){return wd.call(cm,e)?!0:wd.call(lm,e)?!1:e4.test(e)?cm[e]=!0:(lm[e]=!0,!1)}function n4(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function r4(e,t,n,r){if(t===null||typeof t>"u"||n4(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Sn(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var an={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){an[e]=new Sn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];an[t]=new Sn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){an[e]=new Sn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){an[e]=new Sn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){an[e]=new Sn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){an[e]=new Sn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){an[e]=new Sn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){an[e]=new Sn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){an[e]=new Sn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ff=/[\-:]([a-z])/g;function Of(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ff,Of);an[t]=new Sn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ff,Of);an[t]=new Sn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ff,Of);an[t]=new Sn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){an[e]=new Sn(e,1,!1,e.toLowerCase(),null,!1,!1)});an.xlinkHref=new Sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){an[e]=new Sn(e,1,!1,e.toLowerCase(),null,!0,!0)});function $f(e,t,n,r){var s=an.hasOwnProperty(t)?an[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(r4(t,n,s,r)&&(n=null),r||s===null?t4(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ms=Z3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ol=Symbol.for("react.element"),Ri=Symbol.for("react.portal"),Li=Symbol.for("react.fragment"),Df=Symbol.for("react.strict_mode"),Sd=Symbol.for("react.profiler"),rg=Symbol.for("react.provider"),sg=Symbol.for("react.context"),zf=Symbol.for("react.forward_ref"),kd=Symbol.for("react.suspense"),Ad=Symbol.for("react.suspense_list"),Uf=Symbol.for("react.memo"),ks=Symbol.for("react.lazy"),ig=Symbol.for("react.offscreen"),um=Symbol.iterator;function Ho(e){return e===null||typeof e!="object"?null:(e=um&&e[um]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,Nu;function ea(e){if(Nu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Nu=t&&t[1]||""}return`
`+Nu+e}var bu=!1;function Mu(e,t){if(!e||bu)return"";bu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var d=`
`+s[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=a&&0<=c);break}}}finally{bu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ea(e):""}function s4(e){switch(e.tag){case 5:return ea(e.type);case 16:return ea("Lazy");case 13:return ea("Suspense");case 19:return ea("SuspenseList");case 0:case 2:case 15:return e=Mu(e.type,!1),e;case 11:return e=Mu(e.type.render,!1),e;case 1:return e=Mu(e.type,!0),e;default:return""}}function Ed(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Li:return"Fragment";case Ri:return"Portal";case Sd:return"Profiler";case Df:return"StrictMode";case kd:return"Suspense";case Ad:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sg:return(e.displayName||"Context")+".Consumer";case rg:return(e._context.displayName||"Context")+".Provider";case zf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Uf:return t=e.displayName||null,t!==null?t:Ed(e.type)||"Memo";case ks:t=e._payload,e=e._init;try{return Ed(e(t))}catch{}}return null}function i4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ed(t);case 8:return t===Df?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function zs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function og(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function o4(e){var t=og(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function al(e){e._valueTracker||(e._valueTracker=o4(e))}function ag(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=og(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Vl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cd(e,t){var n=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function dm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=zs(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function lg(e,t){t=t.checked,t!=null&&$f(e,"checked",t,!1)}function jd(e,t){lg(e,t);var n=zs(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_d(e,t.type,n):t.hasOwnProperty("defaultValue")&&_d(e,t.type,zs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function fm(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _d(e,t,n){(t!=="number"||Vl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ta=Array.isArray;function Ki(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+zs(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Nd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(de(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(de(92));if(ta(n)){if(1<n.length)throw Error(de(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:zs(n)}}function cg(e,t){var n=zs(t.value),r=zs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function pm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ug(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ug(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ll,dg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ll=ll||document.createElement("div"),ll.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ll.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function wa(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var oa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a4=["Webkit","ms","Moz","O"];Object.keys(oa).forEach(function(e){a4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),oa[t]=oa[e]})});function fg(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||oa.hasOwnProperty(e)&&oa[e]?(""+t).trim():t+"px"}function hg(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=fg(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var l4=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Md(e,t){if(t){if(l4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(de(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(de(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(de(61))}if(t.style!=null&&typeof t.style!="object")throw Error(de(62))}}function Pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Td=null;function Hf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Id=null,Qi=null,Ji=null;function mm(e){if(e=Ha(e)){if(typeof Id!="function")throw Error(de(280));var t=e.stateNode;t&&(t=Bc(t),Id(e.stateNode,e.type,t))}}function pg(e){Qi?Ji?Ji.push(e):Ji=[e]:Qi=e}function mg(){if(Qi){var e=Qi,t=Ji;if(Ji=Qi=null,mm(e),t)for(e=0;e<t.length;e++)mm(t[e])}}function gg(e,t){return e(t)}function yg(){}var Pu=!1;function vg(e,t,n){if(Pu)return e(t,n);Pu=!0;try{return gg(e,t,n)}finally{Pu=!1,(Qi!==null||Ji!==null)&&(yg(),mg())}}function Sa(e,t){var n=e.stateNode;if(n===null)return null;var r=Bc(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(de(231,t,typeof n));return n}var Bd=!1;if(cs)try{var Wo={};Object.defineProperty(Wo,"passive",{get:function(){Bd=!0}}),window.addEventListener("test",Wo,Wo),window.removeEventListener("test",Wo,Wo)}catch{Bd=!1}function c4(e,t,n,r,s,i,a,c,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(g){this.onError(g)}}var aa=!1,Yl=null,Xl=!1,Rd=null,u4={onError:function(e){aa=!0,Yl=e}};function d4(e,t,n,r,s,i,a,c,d){aa=!1,Yl=null,c4.apply(u4,arguments)}function f4(e,t,n,r,s,i,a,c,d){if(d4.apply(this,arguments),aa){if(aa){var h=Yl;aa=!1,Yl=null}else throw Error(de(198));Xl||(Xl=!0,Rd=h)}}function xi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function xg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gm(e){if(xi(e)!==e)throw Error(de(188))}function h4(e){var t=e.alternate;if(!t){if(t=xi(e),t===null)throw Error(de(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return gm(s),e;if(i===r)return gm(s),t;i=i.sibling}throw Error(de(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a)throw Error(de(189))}}if(n.alternate!==r)throw Error(de(190))}if(n.tag!==3)throw Error(de(188));return n.stateNode.current===n?e:t}function wg(e){return e=h4(e),e!==null?Sg(e):null}function Sg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Sg(e);if(t!==null)return t;e=e.sibling}return null}var kg=qn.unstable_scheduleCallback,ym=qn.unstable_cancelCallback,p4=qn.unstable_shouldYield,m4=qn.unstable_requestPaint,Ot=qn.unstable_now,g4=qn.unstable_getCurrentPriorityLevel,Wf=qn.unstable_ImmediatePriority,Ag=qn.unstable_UserBlockingPriority,Kl=qn.unstable_NormalPriority,y4=qn.unstable_LowPriority,Eg=qn.unstable_IdlePriority,Mc=null,Yr=null;function v4(e){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(Mc,e,void 0,(e.current.flags&128)===128)}catch{}}var Mr=Math.clz32?Math.clz32:S4,x4=Math.log,w4=Math.LN2;function S4(e){return e>>>=0,e===0?32:31-(x4(e)/w4|0)|0}var cl=64,ul=4194304;function na(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ql(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=na(c):(i&=a,i!==0&&(r=na(i)))}else a=n&~s,a!==0?r=na(a):i!==0&&(r=na(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Mr(t),s=1<<n,r|=e[n],t&=~s;return r}function k4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function A4(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Mr(i),c=1<<a,d=s[a];d===-1?(!(c&n)||c&r)&&(s[a]=k4(c,t)):d<=t&&(e.expiredLanes|=c),i&=~c}}function Ld(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Cg(){var e=cl;return cl<<=1,!(cl&4194240)&&(cl=64),e}function Tu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function za(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mr(t),e[t]=n}function E4(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Mr(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Gf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Mr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function jg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _g,Vf,Ng,bg,Mg,Fd=!1,dl=[],Ps=null,Ts=null,Is=null,ka=new Map,Aa=new Map,Cs=[],C4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vm(e,t){switch(e){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Ts=null;break;case"mouseover":case"mouseout":Is=null;break;case"pointerover":case"pointerout":ka.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Aa.delete(t.pointerId)}}function Go(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ha(t),t!==null&&Vf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function j4(e,t,n,r,s){switch(t){case"focusin":return Ps=Go(Ps,e,t,n,r,s),!0;case"dragenter":return Ts=Go(Ts,e,t,n,r,s),!0;case"mouseover":return Is=Go(Is,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return ka.set(i,Go(ka.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Aa.set(i,Go(Aa.get(i)||null,e,t,n,r,s)),!0}return!1}function Pg(e){var t=ri(e.target);if(t!==null){var n=xi(t);if(n!==null){if(t=n.tag,t===13){if(t=xg(n),t!==null){e.blockedOn=t,Mg(e.priority,function(){Ng(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ml(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Od(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Td=r,n.target.dispatchEvent(r),Td=null}else return t=Ha(n),t!==null&&Vf(t),e.blockedOn=n,!1;t.shift()}return!0}function xm(e,t,n){Ml(e)&&n.delete(t)}function _4(){Fd=!1,Ps!==null&&Ml(Ps)&&(Ps=null),Ts!==null&&Ml(Ts)&&(Ts=null),Is!==null&&Ml(Is)&&(Is=null),ka.forEach(xm),Aa.forEach(xm)}function Vo(e,t){e.blockedOn===t&&(e.blockedOn=null,Fd||(Fd=!0,qn.unstable_scheduleCallback(qn.unstable_NormalPriority,_4)))}function Ea(e){function t(s){return Vo(s,e)}if(0<dl.length){Vo(dl[0],e);for(var n=1;n<dl.length;n++){var r=dl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ps!==null&&Vo(Ps,e),Ts!==null&&Vo(Ts,e),Is!==null&&Vo(Is,e),ka.forEach(t),Aa.forEach(t),n=0;n<Cs.length;n++)r=Cs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Cs.length&&(n=Cs[0],n.blockedOn===null);)Pg(n),n.blockedOn===null&&Cs.shift()}var qi=ms.ReactCurrentBatchConfig,Jl=!0;function N4(e,t,n,r){var s=at,i=qi.transition;qi.transition=null;try{at=1,Yf(e,t,n,r)}finally{at=s,qi.transition=i}}function b4(e,t,n,r){var s=at,i=qi.transition;qi.transition=null;try{at=4,Yf(e,t,n,r)}finally{at=s,qi.transition=i}}function Yf(e,t,n,r){if(Jl){var s=Od(e,t,n,r);if(s===null)Uu(e,t,r,ql,n),vm(e,r);else if(j4(s,e,t,n,r))r.stopPropagation();else if(vm(e,r),t&4&&-1<C4.indexOf(e)){for(;s!==null;){var i=Ha(s);if(i!==null&&_g(i),i=Od(e,t,n,r),i===null&&Uu(e,t,r,ql,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Uu(e,t,r,null,n)}}var ql=null;function Od(e,t,n,r){if(ql=null,e=Hf(r),e=ri(e),e!==null)if(t=xi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=xg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ql=e,null}function Tg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g4()){case Wf:return 1;case Ag:return 4;case Kl:case y4:return 16;case Eg:return 536870912;default:return 16}default:return 16}}var bs=null,Xf=null,Pl=null;function Ig(){if(Pl)return Pl;var e,t=Xf,n=t.length,r,s="value"in bs?bs.value:bs.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return Pl=s.slice(e,1<r?1-r:void 0)}function Tl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function fl(){return!0}function wm(){return!1}function tr(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?fl:wm,this.isPropagationStopped=wm,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fl)},persist:function(){},isPersistent:fl}),t}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kf=tr(jo),Ua=Mt({},jo,{view:0,detail:0}),M4=tr(Ua),Iu,Bu,Yo,Pc=Mt({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yo&&(Yo&&e.type==="mousemove"?(Iu=e.screenX-Yo.screenX,Bu=e.screenY-Yo.screenY):Bu=Iu=0,Yo=e),Iu)},movementY:function(e){return"movementY"in e?e.movementY:Bu}}),Sm=tr(Pc),P4=Mt({},Pc,{dataTransfer:0}),T4=tr(P4),I4=Mt({},Ua,{relatedTarget:0}),Ru=tr(I4),B4=Mt({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),R4=tr(B4),L4=Mt({},jo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),F4=tr(L4),O4=Mt({},jo,{data:0}),km=tr(O4),$4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},D4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function U4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=z4[e])?!!t[e]:!1}function Qf(){return U4}var H4=Mt({},Ua,{key:function(e){if(e.key){var t=$4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?D4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qf,charCode:function(e){return e.type==="keypress"?Tl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),W4=tr(H4),G4=Mt({},Pc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Am=tr(G4),V4=Mt({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qf}),Y4=tr(V4),X4=Mt({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),K4=tr(X4),Q4=Mt({},Pc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),J4=tr(Q4),q4=[9,13,27,32],Jf=cs&&"CompositionEvent"in window,la=null;cs&&"documentMode"in document&&(la=document.documentMode);var Z4=cs&&"TextEvent"in window&&!la,Bg=cs&&(!Jf||la&&8<la&&11>=la),Em=" ",Cm=!1;function Rg(e,t){switch(e){case"keyup":return q4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Fi=!1;function ex(e,t){switch(e){case"compositionend":return Lg(t);case"keypress":return t.which!==32?null:(Cm=!0,Em);case"textInput":return e=t.data,e===Em&&Cm?null:e;default:return null}}function tx(e,t){if(Fi)return e==="compositionend"||!Jf&&Rg(e,t)?(e=Ig(),Pl=Xf=bs=null,Fi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bg&&t.locale!=="ko"?null:t.data;default:return null}}var nx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nx[e.type]:t==="textarea"}function Fg(e,t,n,r){pg(r),t=Zl(t,"onChange"),0<t.length&&(n=new Kf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ca=null,Ca=null;function rx(e){Xg(e,0)}function Tc(e){var t=Di(e);if(ag(t))return e}function sx(e,t){if(e==="change")return t}var Og=!1;if(cs){var Lu;if(cs){var Fu="oninput"in document;if(!Fu){var _m=document.createElement("div");_m.setAttribute("oninput","return;"),Fu=typeof _m.oninput=="function"}Lu=Fu}else Lu=!1;Og=Lu&&(!document.documentMode||9<document.documentMode)}function Nm(){ca&&(ca.detachEvent("onpropertychange",$g),Ca=ca=null)}function $g(e){if(e.propertyName==="value"&&Tc(Ca)){var t=[];Fg(t,Ca,e,Hf(e)),vg(rx,t)}}function ix(e,t,n){e==="focusin"?(Nm(),ca=t,Ca=n,ca.attachEvent("onpropertychange",$g)):e==="focusout"&&Nm()}function ox(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Tc(Ca)}function ax(e,t){if(e==="click")return Tc(t)}function lx(e,t){if(e==="input"||e==="change")return Tc(t)}function cx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tr=typeof Object.is=="function"?Object.is:cx;function ja(e,t){if(Tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!wd.call(t,s)||!Tr(e[s],t[s]))return!1}return!0}function bm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Mm(e,t){var n=bm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=bm(n)}}function Dg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Dg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function zg(){for(var e=window,t=Vl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Vl(e.document)}return t}function qf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ux(e){var t=zg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Dg(n.ownerDocument.documentElement,n)){if(r!==null&&qf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Mm(n,i);var a=Mm(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var dx=cs&&"documentMode"in document&&11>=document.documentMode,Oi=null,$d=null,ua=null,Dd=!1;function Pm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Dd||Oi==null||Oi!==Vl(r)||(r=Oi,"selectionStart"in r&&qf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ua&&ja(ua,r)||(ua=r,r=Zl($d,"onSelect"),0<r.length&&(t=new Kf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Oi)))}function hl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var $i={animationend:hl("Animation","AnimationEnd"),animationiteration:hl("Animation","AnimationIteration"),animationstart:hl("Animation","AnimationStart"),transitionend:hl("Transition","TransitionEnd")},Ou={},Ug={};cs&&(Ug=document.createElement("div").style,"AnimationEvent"in window||(delete $i.animationend.animation,delete $i.animationiteration.animation,delete $i.animationstart.animation),"TransitionEvent"in window||delete $i.transitionend.transition);function Ic(e){if(Ou[e])return Ou[e];if(!$i[e])return e;var t=$i[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ug)return Ou[e]=t[n];return e}var Hg=Ic("animationend"),Wg=Ic("animationiteration"),Gg=Ic("animationstart"),Vg=Ic("transitionend"),Yg=new Map,Tm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gs(e,t){Yg.set(e,t),vi(t,[e])}for(var $u=0;$u<Tm.length;$u++){var Du=Tm[$u],fx=Du.toLowerCase(),hx=Du[0].toUpperCase()+Du.slice(1);Gs(fx,"on"+hx)}Gs(Hg,"onAnimationEnd");Gs(Wg,"onAnimationIteration");Gs(Gg,"onAnimationStart");Gs("dblclick","onDoubleClick");Gs("focusin","onFocus");Gs("focusout","onBlur");Gs(Vg,"onTransitionEnd");ao("onMouseEnter",["mouseout","mouseover"]);ao("onMouseLeave",["mouseout","mouseover"]);ao("onPointerEnter",["pointerout","pointerover"]);ao("onPointerLeave",["pointerout","pointerover"]);vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),px=new Set("cancel close invalid load scroll toggle".split(" ").concat(ra));function Im(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,f4(r,t,void 0,e),e.currentTarget=null}function Xg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var c=r[a],d=c.instance,h=c.currentTarget;if(c=c.listener,d!==i&&s.isPropagationStopped())break e;Im(s,c,h),i=d}else for(a=0;a<r.length;a++){if(c=r[a],d=c.instance,h=c.currentTarget,c=c.listener,d!==i&&s.isPropagationStopped())break e;Im(s,c,h),i=d}}}if(Xl)throw e=Rd,Xl=!1,Rd=null,e}function yt(e,t){var n=t[Gd];n===void 0&&(n=t[Gd]=new Set);var r=e+"__bubble";n.has(r)||(Kg(t,e,2,!1),n.add(r))}function zu(e,t,n){var r=0;t&&(r|=4),Kg(n,e,r,t)}var pl="_reactListening"+Math.random().toString(36).slice(2);function _a(e){if(!e[pl]){e[pl]=!0,ng.forEach(function(n){n!=="selectionchange"&&(px.has(n)||zu(n,!1,e),zu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[pl]||(t[pl]=!0,zu("selectionchange",!1,t))}}function Kg(e,t,n,r){switch(Tg(t)){case 1:var s=N4;break;case 4:s=b4;break;default:s=Yf}n=s.bind(null,t,n,e),s=void 0,!Bd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Uu(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;c!==null;){if(a=ri(c),a===null)return;if(d=a.tag,d===5||d===6){r=i=a;continue e}c=c.parentNode}}r=r.return}vg(function(){var h=i,g=Hf(n),x=[];e:{var w=Yg.get(e);if(w!==void 0){var _=Kf,D=e;switch(e){case"keypress":if(Tl(n)===0)break e;case"keydown":case"keyup":_=W4;break;case"focusin":D="focus",_=Ru;break;case"focusout":D="blur",_=Ru;break;case"beforeblur":case"afterblur":_=Ru;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=Sm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=T4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=Y4;break;case Hg:case Wg:case Gg:_=R4;break;case Vg:_=K4;break;case"scroll":_=M4;break;case"wheel":_=J4;break;case"copy":case"cut":case"paste":_=F4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Am}var I=(t&4)!==0,Y=!I&&e==="scroll",j=I?w!==null?w+"Capture":null:w;I=[];for(var y=h,A;y!==null;){A=y;var M=A.stateNode;if(A.tag===5&&M!==null&&(A=M,j!==null&&(M=Sa(y,j),M!=null&&I.push(Na(y,M,A)))),Y)break;y=y.return}0<I.length&&(w=new _(w,D,null,n,g),x.push({event:w,listeners:I}))}}if(!(t&7)){e:{if(w=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",w&&n!==Td&&(D=n.relatedTarget||n.fromElement)&&(ri(D)||D[us]))break e;if((_||w)&&(w=g.window===g?g:(w=g.ownerDocument)?w.defaultView||w.parentWindow:window,_?(D=n.relatedTarget||n.toElement,_=h,D=D?ri(D):null,D!==null&&(Y=xi(D),D!==Y||D.tag!==5&&D.tag!==6)&&(D=null)):(_=null,D=h),_!==D)){if(I=Sm,M="onMouseLeave",j="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(I=Am,M="onPointerLeave",j="onPointerEnter",y="pointer"),Y=_==null?w:Di(_),A=D==null?w:Di(D),w=new I(M,y+"leave",_,n,g),w.target=Y,w.relatedTarget=A,M=null,ri(g)===h&&(I=new I(j,y+"enter",D,n,g),I.target=A,I.relatedTarget=Y,M=I),Y=M,_&&D)t:{for(I=_,j=D,y=0,A=I;A;A=Pi(A))y++;for(A=0,M=j;M;M=Pi(M))A++;for(;0<y-A;)I=Pi(I),y--;for(;0<A-y;)j=Pi(j),A--;for(;y--;){if(I===j||j!==null&&I===j.alternate)break t;I=Pi(I),j=Pi(j)}I=null}else I=null;_!==null&&Bm(x,w,_,I,!1),D!==null&&Y!==null&&Bm(x,Y,D,I,!0)}}e:{if(w=h?Di(h):window,_=w.nodeName&&w.nodeName.toLowerCase(),_==="select"||_==="input"&&w.type==="file")var b=sx;else if(jm(w))if(Og)b=lx;else{b=ox;var H=ix}else(_=w.nodeName)&&_.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(b=ax);if(b&&(b=b(e,h))){Fg(x,b,n,g);break e}H&&H(e,w,h),e==="focusout"&&(H=w._wrapperState)&&H.controlled&&w.type==="number"&&_d(w,"number",w.value)}switch(H=h?Di(h):window,e){case"focusin":(jm(H)||H.contentEditable==="true")&&(Oi=H,$d=h,ua=null);break;case"focusout":ua=$d=Oi=null;break;case"mousedown":Dd=!0;break;case"contextmenu":case"mouseup":case"dragend":Dd=!1,Pm(x,n,g);break;case"selectionchange":if(dx)break;case"keydown":case"keyup":Pm(x,n,g)}var R;if(Jf)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Fi?Rg(e,n)&&(O="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(Bg&&n.locale!=="ko"&&(Fi||O!=="onCompositionStart"?O==="onCompositionEnd"&&Fi&&(R=Ig()):(bs=g,Xf="value"in bs?bs.value:bs.textContent,Fi=!0)),H=Zl(h,O),0<H.length&&(O=new km(O,e,null,n,g),x.push({event:O,listeners:H}),R?O.data=R:(R=Lg(n),R!==null&&(O.data=R)))),(R=Z4?ex(e,n):tx(e,n))&&(h=Zl(h,"onBeforeInput"),0<h.length&&(g=new km("onBeforeInput","beforeinput",null,n,g),x.push({event:g,listeners:h}),g.data=R))}Xg(x,t)})}function Na(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Zl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Sa(e,n),i!=null&&r.unshift(Na(e,i,s)),i=Sa(e,t),i!=null&&r.push(Na(e,i,s))),e=e.return}return r}function Pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Bm(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var c=n,d=c.alternate,h=c.stateNode;if(d!==null&&d===r)break;c.tag===5&&h!==null&&(c=h,s?(d=Sa(n,i),d!=null&&a.unshift(Na(n,d,c))):s||(d=Sa(n,i),d!=null&&a.push(Na(n,d,c)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var mx=/\r\n?/g,gx=/\u0000|\uFFFD/g;function Rm(e){return(typeof e=="string"?e:""+e).replace(mx,`
`).replace(gx,"")}function ml(e,t,n){if(t=Rm(t),Rm(e)!==t&&n)throw Error(de(425))}function ec(){}var zd=null,Ud=null;function Hd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wd=typeof setTimeout=="function"?setTimeout:void 0,yx=typeof clearTimeout=="function"?clearTimeout:void 0,Lm=typeof Promise=="function"?Promise:void 0,vx=typeof queueMicrotask=="function"?queueMicrotask:typeof Lm<"u"?function(e){return Lm.resolve(null).then(e).catch(xx)}:Wd;function xx(e){setTimeout(function(){throw e})}function Hu(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Ea(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ea(t)}function Bs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Fm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var _o=Math.random().toString(36).slice(2),Vr="__reactFiber$"+_o,ba="__reactProps$"+_o,us="__reactContainer$"+_o,Gd="__reactEvents$"+_o,wx="__reactListeners$"+_o,Sx="__reactHandles$"+_o;function ri(e){var t=e[Vr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[us]||n[Vr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Fm(e);e!==null;){if(n=e[Vr])return n;e=Fm(e)}return t}e=n,n=e.parentNode}return null}function Ha(e){return e=e[Vr]||e[us],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Di(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(de(33))}function Bc(e){return e[ba]||null}var Vd=[],zi=-1;function Vs(e){return{current:e}}function vt(e){0>zi||(e.current=Vd[zi],Vd[zi]=null,zi--)}function ht(e,t){zi++,Vd[zi]=e.current,e.current=t}var Us={},mn=Vs(Us),Tn=Vs(!1),di=Us;function lo(e,t){var n=e.type.contextTypes;if(!n)return Us;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function In(e){return e=e.childContextTypes,e!=null}function tc(){vt(Tn),vt(mn)}function Om(e,t,n){if(mn.current!==Us)throw Error(de(168));ht(mn,t),ht(Tn,n)}function Qg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(de(108,i4(e)||"Unknown",s));return Mt({},n,r)}function nc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Us,di=mn.current,ht(mn,e),ht(Tn,Tn.current),!0}function $m(e,t,n){var r=e.stateNode;if(!r)throw Error(de(169));n?(e=Qg(e,t,di),r.__reactInternalMemoizedMergedChildContext=e,vt(Tn),vt(mn),ht(mn,e)):vt(Tn),ht(Tn,n)}var Zr=null,Rc=!1,Wu=!1;function Jg(e){Zr===null?Zr=[e]:Zr.push(e)}function kx(e){Rc=!0,Jg(e)}function Ys(){if(!Wu&&Zr!==null){Wu=!0;var e=0,t=at;try{var n=Zr;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Zr=null,Rc=!1}catch(s){throw Zr!==null&&(Zr=Zr.slice(e+1)),kg(Wf,Ys),s}finally{at=t,Wu=!1}}return null}var Ui=[],Hi=0,rc=null,sc=0,ur=[],dr=0,fi=null,ns=1,rs="";function ti(e,t){Ui[Hi++]=sc,Ui[Hi++]=rc,rc=e,sc=t}function qg(e,t,n){ur[dr++]=ns,ur[dr++]=rs,ur[dr++]=fi,fi=e;var r=ns;e=rs;var s=32-Mr(r)-1;r&=~(1<<s),n+=1;var i=32-Mr(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ns=1<<32-Mr(t)+s|n<<s|r,rs=i+e}else ns=1<<i|n<<s|r,rs=e}function Zf(e){e.return!==null&&(ti(e,1),qg(e,1,0))}function eh(e){for(;e===rc;)rc=Ui[--Hi],Ui[Hi]=null,sc=Ui[--Hi],Ui[Hi]=null;for(;e===fi;)fi=ur[--dr],ur[dr]=null,rs=ur[--dr],ur[dr]=null,ns=ur[--dr],ur[dr]=null}var Jn=null,Qn=null,kt=!1,Nr=null;function Zg(e,t){var n=hr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Dm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Jn=e,Qn=Bs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Jn=e,Qn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=fi!==null?{id:ns,overflow:rs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Jn=e,Qn=null,!0):!1;default:return!1}}function Yd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xd(e){if(kt){var t=Qn;if(t){var n=t;if(!Dm(e,t)){if(Yd(e))throw Error(de(418));t=Bs(n.nextSibling);var r=Jn;t&&Dm(e,t)?Zg(r,n):(e.flags=e.flags&-4097|2,kt=!1,Jn=e)}}else{if(Yd(e))throw Error(de(418));e.flags=e.flags&-4097|2,kt=!1,Jn=e}}}function zm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Jn=e}function gl(e){if(e!==Jn)return!1;if(!kt)return zm(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Hd(e.type,e.memoizedProps)),t&&(t=Qn)){if(Yd(e))throw e2(),Error(de(418));for(;t;)Zg(e,t),t=Bs(t.nextSibling)}if(zm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(de(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Qn=Bs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Qn=null}}else Qn=Jn?Bs(e.stateNode.nextSibling):null;return!0}function e2(){for(var e=Qn;e;)e=Bs(e.nextSibling)}function co(){Qn=Jn=null,kt=!1}function th(e){Nr===null?Nr=[e]:Nr.push(e)}var Ax=ms.ReactCurrentBatchConfig;function Xo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(de(309));var r=n.stateNode}if(!r)throw Error(de(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var c=s.refs;a===null?delete c[i]:c[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(de(284));if(!n._owner)throw Error(de(290,e))}return e}function yl(e,t){throw e=Object.prototype.toString.call(t),Error(de(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Um(e){var t=e._init;return t(e._payload)}function t2(e){function t(j,y){if(e){var A=j.deletions;A===null?(j.deletions=[y],j.flags|=16):A.push(y)}}function n(j,y){if(!e)return null;for(;y!==null;)t(j,y),y=y.sibling;return null}function r(j,y){for(j=new Map;y!==null;)y.key!==null?j.set(y.key,y):j.set(y.index,y),y=y.sibling;return j}function s(j,y){return j=Os(j,y),j.index=0,j.sibling=null,j}function i(j,y,A){return j.index=A,e?(A=j.alternate,A!==null?(A=A.index,A<y?(j.flags|=2,y):A):(j.flags|=2,y)):(j.flags|=1048576,y)}function a(j){return e&&j.alternate===null&&(j.flags|=2),j}function c(j,y,A,M){return y===null||y.tag!==6?(y=Ju(A,j.mode,M),y.return=j,y):(y=s(y,A),y.return=j,y)}function d(j,y,A,M){var b=A.type;return b===Li?g(j,y,A.props.children,M,A.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ks&&Um(b)===y.type)?(M=s(y,A.props),M.ref=Xo(j,y,A),M.return=j,M):(M=$l(A.type,A.key,A.props,null,j.mode,M),M.ref=Xo(j,y,A),M.return=j,M)}function h(j,y,A,M){return y===null||y.tag!==4||y.stateNode.containerInfo!==A.containerInfo||y.stateNode.implementation!==A.implementation?(y=qu(A,j.mode,M),y.return=j,y):(y=s(y,A.children||[]),y.return=j,y)}function g(j,y,A,M,b){return y===null||y.tag!==7?(y=ci(A,j.mode,M,b),y.return=j,y):(y=s(y,A),y.return=j,y)}function x(j,y,A){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ju(""+y,j.mode,A),y.return=j,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ol:return A=$l(y.type,y.key,y.props,null,j.mode,A),A.ref=Xo(j,null,y),A.return=j,A;case Ri:return y=qu(y,j.mode,A),y.return=j,y;case ks:var M=y._init;return x(j,M(y._payload),A)}if(ta(y)||Ho(y))return y=ci(y,j.mode,A,null),y.return=j,y;yl(j,y)}return null}function w(j,y,A,M){var b=y!==null?y.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return b!==null?null:c(j,y,""+A,M);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ol:return A.key===b?d(j,y,A,M):null;case Ri:return A.key===b?h(j,y,A,M):null;case ks:return b=A._init,w(j,y,b(A._payload),M)}if(ta(A)||Ho(A))return b!==null?null:g(j,y,A,M,null);yl(j,A)}return null}function _(j,y,A,M,b){if(typeof M=="string"&&M!==""||typeof M=="number")return j=j.get(A)||null,c(y,j,""+M,b);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case ol:return j=j.get(M.key===null?A:M.key)||null,d(y,j,M,b);case Ri:return j=j.get(M.key===null?A:M.key)||null,h(y,j,M,b);case ks:var H=M._init;return _(j,y,A,H(M._payload),b)}if(ta(M)||Ho(M))return j=j.get(A)||null,g(y,j,M,b,null);yl(y,M)}return null}function D(j,y,A,M){for(var b=null,H=null,R=y,O=y=0,z=null;R!==null&&O<A.length;O++){R.index>O?(z=R,R=null):z=R.sibling;var W=w(j,R,A[O],M);if(W===null){R===null&&(R=z);break}e&&R&&W.alternate===null&&t(j,R),y=i(W,y,O),H===null?b=W:H.sibling=W,H=W,R=z}if(O===A.length)return n(j,R),kt&&ti(j,O),b;if(R===null){for(;O<A.length;O++)R=x(j,A[O],M),R!==null&&(y=i(R,y,O),H===null?b=R:H.sibling=R,H=R);return kt&&ti(j,O),b}for(R=r(j,R);O<A.length;O++)z=_(R,j,O,A[O],M),z!==null&&(e&&z.alternate!==null&&R.delete(z.key===null?O:z.key),y=i(z,y,O),H===null?b=z:H.sibling=z,H=z);return e&&R.forEach(function(X){return t(j,X)}),kt&&ti(j,O),b}function I(j,y,A,M){var b=Ho(A);if(typeof b!="function")throw Error(de(150));if(A=b.call(A),A==null)throw Error(de(151));for(var H=b=null,R=y,O=y=0,z=null,W=A.next();R!==null&&!W.done;O++,W=A.next()){R.index>O?(z=R,R=null):z=R.sibling;var X=w(j,R,W.value,M);if(X===null){R===null&&(R=z);break}e&&R&&X.alternate===null&&t(j,R),y=i(X,y,O),H===null?b=X:H.sibling=X,H=X,R=z}if(W.done)return n(j,R),kt&&ti(j,O),b;if(R===null){for(;!W.done;O++,W=A.next())W=x(j,W.value,M),W!==null&&(y=i(W,y,O),H===null?b=W:H.sibling=W,H=W);return kt&&ti(j,O),b}for(R=r(j,R);!W.done;O++,W=A.next())W=_(R,j,O,W.value,M),W!==null&&(e&&W.alternate!==null&&R.delete(W.key===null?O:W.key),y=i(W,y,O),H===null?b=W:H.sibling=W,H=W);return e&&R.forEach(function(q){return t(j,q)}),kt&&ti(j,O),b}function Y(j,y,A,M){if(typeof A=="object"&&A!==null&&A.type===Li&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case ol:e:{for(var b=A.key,H=y;H!==null;){if(H.key===b){if(b=A.type,b===Li){if(H.tag===7){n(j,H.sibling),y=s(H,A.props.children),y.return=j,j=y;break e}}else if(H.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ks&&Um(b)===H.type){n(j,H.sibling),y=s(H,A.props),y.ref=Xo(j,H,A),y.return=j,j=y;break e}n(j,H);break}else t(j,H);H=H.sibling}A.type===Li?(y=ci(A.props.children,j.mode,M,A.key),y.return=j,j=y):(M=$l(A.type,A.key,A.props,null,j.mode,M),M.ref=Xo(j,y,A),M.return=j,j=M)}return a(j);case Ri:e:{for(H=A.key;y!==null;){if(y.key===H)if(y.tag===4&&y.stateNode.containerInfo===A.containerInfo&&y.stateNode.implementation===A.implementation){n(j,y.sibling),y=s(y,A.children||[]),y.return=j,j=y;break e}else{n(j,y);break}else t(j,y);y=y.sibling}y=qu(A,j.mode,M),y.return=j,j=y}return a(j);case ks:return H=A._init,Y(j,y,H(A._payload),M)}if(ta(A))return D(j,y,A,M);if(Ho(A))return I(j,y,A,M);yl(j,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,y!==null&&y.tag===6?(n(j,y.sibling),y=s(y,A),y.return=j,j=y):(n(j,y),y=Ju(A,j.mode,M),y.return=j,j=y),a(j)):n(j,y)}return Y}var uo=t2(!0),n2=t2(!1),ic=Vs(null),oc=null,Wi=null,nh=null;function rh(){nh=Wi=oc=null}function sh(e){var t=ic.current;vt(ic),e._currentValue=t}function Kd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Zi(e,t){oc=e,nh=Wi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Pn=!0),e.firstContext=null)}function gr(e){var t=e._currentValue;if(nh!==e)if(e={context:e,memoizedValue:t,next:null},Wi===null){if(oc===null)throw Error(de(308));Wi=e,oc.dependencies={lanes:0,firstContext:e}}else Wi=Wi.next=e;return t}var si=null;function ih(e){si===null?si=[e]:si.push(e)}function r2(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,ih(t)):(n.next=s.next,s.next=n),t.interleaved=n,ds(e,r)}function ds(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var As=!1;function oh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function is(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,et&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,ds(e,n)}return s=r.interleaved,s===null?(t.next=t,ih(r)):(t.next=s.next,s.next=t),r.interleaved=t,ds(e,n)}function Il(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gf(e,n)}}function Hm(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ac(e,t,n,r){var s=e.updateQueue;As=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var d=c,h=d.next;d.next=null,a===null?i=h:a.next=h,a=d;var g=e.alternate;g!==null&&(g=g.updateQueue,c=g.lastBaseUpdate,c!==a&&(c===null?g.firstBaseUpdate=h:c.next=h,g.lastBaseUpdate=d))}if(i!==null){var x=s.baseState;a=0,g=h=d=null,c=i;do{var w=c.lane,_=c.eventTime;if((r&w)===w){g!==null&&(g=g.next={eventTime:_,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var D=e,I=c;switch(w=t,_=n,I.tag){case 1:if(D=I.payload,typeof D=="function"){x=D.call(_,x,w);break e}x=D;break e;case 3:D.flags=D.flags&-65537|128;case 0:if(D=I.payload,w=typeof D=="function"?D.call(_,x,w):D,w==null)break e;x=Mt({},x,w);break e;case 2:As=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,w=s.effects,w===null?s.effects=[c]:w.push(c))}else _={eventTime:_,lane:w,tag:c.tag,payload:c.payload,callback:c.callback,next:null},g===null?(h=g=_,d=x):g=g.next=_,a|=w;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;w=c,c=w.next,w.next=null,s.lastBaseUpdate=w,s.shared.pending=null}}while(!0);if(g===null&&(d=x),s.baseState=d,s.firstBaseUpdate=h,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);pi|=a,e.lanes=a,e.memoizedState=x}}function Wm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(de(191,s));s.call(r)}}}var Wa={},Xr=Vs(Wa),Ma=Vs(Wa),Pa=Vs(Wa);function ii(e){if(e===Wa)throw Error(de(174));return e}function ah(e,t){switch(ht(Pa,t),ht(Ma,e),ht(Xr,Wa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bd(t,e)}vt(Xr),ht(Xr,t)}function fo(){vt(Xr),vt(Ma),vt(Pa)}function i2(e){ii(Pa.current);var t=ii(Xr.current),n=bd(t,e.type);t!==n&&(ht(Ma,e),ht(Xr,n))}function lh(e){Ma.current===e&&(vt(Xr),vt(Ma))}var _t=Vs(0);function lc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Gu=[];function ch(){for(var e=0;e<Gu.length;e++)Gu[e]._workInProgressVersionPrimary=null;Gu.length=0}var Bl=ms.ReactCurrentDispatcher,Vu=ms.ReactCurrentBatchConfig,hi=0,Nt=null,Gt=null,Zt=null,cc=!1,da=!1,Ta=0,Ex=0;function un(){throw Error(de(321))}function uh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Tr(e[n],t[n]))return!1;return!0}function dh(e,t,n,r,s,i){if(hi=i,Nt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bl.current=e===null||e.memoizedState===null?Nx:bx,e=n(r,s),da){i=0;do{if(da=!1,Ta=0,25<=i)throw Error(de(301));i+=1,Zt=Gt=null,t.updateQueue=null,Bl.current=Mx,e=n(r,s)}while(da)}if(Bl.current=uc,t=Gt!==null&&Gt.next!==null,hi=0,Zt=Gt=Nt=null,cc=!1,t)throw Error(de(300));return e}function fh(){var e=Ta!==0;return Ta=0,e}function Wr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Nt.memoizedState=Zt=e:Zt=Zt.next=e,Zt}function yr(){if(Gt===null){var e=Nt.alternate;e=e!==null?e.memoizedState:null}else e=Gt.next;var t=Zt===null?Nt.memoizedState:Zt.next;if(t!==null)Zt=t,Gt=e;else{if(e===null)throw Error(de(310));Gt=e,e={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Zt===null?Nt.memoizedState=Zt=e:Zt=Zt.next=e}return Zt}function Ia(e,t){return typeof t=="function"?t(e):t}function Yu(e){var t=yr(),n=t.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=e;var r=Gt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=a=null,d=null,h=i;do{var g=h.lane;if((hi&g)===g)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var x={lane:g,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(c=d=x,a=r):d=d.next=x,Nt.lanes|=g,pi|=g}h=h.next}while(h!==null&&h!==i);d===null?a=r:d.next=c,Tr(r,t.memoizedState)||(Pn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Nt.lanes|=i,pi|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Xu(e){var t=yr(),n=t.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Tr(i,t.memoizedState)||(Pn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function o2(){}function a2(e,t){var n=Nt,r=yr(),s=t(),i=!Tr(r.memoizedState,s);if(i&&(r.memoizedState=s,Pn=!0),r=r.queue,hh(u2.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Zt!==null&&Zt.memoizedState.tag&1){if(n.flags|=2048,Ba(9,c2.bind(null,n,r,s,t),void 0,null),en===null)throw Error(de(349));hi&30||l2(n,t,s)}return s}function l2(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function c2(e,t,n,r){t.value=n,t.getSnapshot=r,d2(t)&&f2(e)}function u2(e,t,n){return n(function(){d2(t)&&f2(e)})}function d2(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Tr(e,n)}catch{return!0}}function f2(e){var t=ds(e,1);t!==null&&Pr(t,e,1,-1)}function Gm(e){var t=Wr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:e},t.queue=e,e=e.dispatch=_x.bind(null,Nt,e),[t.memoizedState,e]}function Ba(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Nt.updateQueue,t===null?(t={lastEffect:null,stores:null},Nt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function h2(){return yr().memoizedState}function Rl(e,t,n,r){var s=Wr();Nt.flags|=e,s.memoizedState=Ba(1|t,n,void 0,r===void 0?null:r)}function Lc(e,t,n,r){var s=yr();r=r===void 0?null:r;var i=void 0;if(Gt!==null){var a=Gt.memoizedState;if(i=a.destroy,r!==null&&uh(r,a.deps)){s.memoizedState=Ba(t,n,i,r);return}}Nt.flags|=e,s.memoizedState=Ba(1|t,n,i,r)}function Vm(e,t){return Rl(8390656,8,e,t)}function hh(e,t){return Lc(2048,8,e,t)}function p2(e,t){return Lc(4,2,e,t)}function m2(e,t){return Lc(4,4,e,t)}function g2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function y2(e,t,n){return n=n!=null?n.concat([e]):null,Lc(4,4,g2.bind(null,t,e),n)}function ph(){}function v2(e,t){var n=yr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&uh(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function x2(e,t){var n=yr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&uh(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function w2(e,t,n){return hi&21?(Tr(n,t)||(n=Cg(),Nt.lanes|=n,pi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Pn=!0),e.memoizedState=n)}function Cx(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=Vu.transition;Vu.transition={};try{e(!1),t()}finally{at=n,Vu.transition=r}}function S2(){return yr().memoizedState}function jx(e,t,n){var r=Fs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},k2(e))A2(t,n);else if(n=r2(e,t,n,r),n!==null){var s=vn();Pr(n,e,r,s),E2(n,t,r)}}function _x(e,t,n){var r=Fs(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(k2(e))A2(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,c=i(a,n);if(s.hasEagerState=!0,s.eagerState=c,Tr(c,a)){var d=t.interleaved;d===null?(s.next=s,ih(t)):(s.next=d.next,d.next=s),t.interleaved=s;return}}catch{}finally{}n=r2(e,t,s,r),n!==null&&(s=vn(),Pr(n,e,r,s),E2(n,t,r))}}function k2(e){var t=e.alternate;return e===Nt||t!==null&&t===Nt}function A2(e,t){da=cc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function E2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gf(e,n)}}var uc={readContext:gr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},Nx={readContext:gr,useCallback:function(e,t){return Wr().memoizedState=[e,t===void 0?null:t],e},useContext:gr,useEffect:Vm,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Rl(4194308,4,g2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Rl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Rl(4,2,e,t)},useMemo:function(e,t){var n=Wr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Wr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=jx.bind(null,Nt,e),[r.memoizedState,e]},useRef:function(e){var t=Wr();return e={current:e},t.memoizedState=e},useState:Gm,useDebugValue:ph,useDeferredValue:function(e){return Wr().memoizedState=e},useTransition:function(){var e=Gm(!1),t=e[0];return e=Cx.bind(null,e[1]),Wr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Nt,s=Wr();if(kt){if(n===void 0)throw Error(de(407));n=n()}else{if(n=t(),en===null)throw Error(de(349));hi&30||l2(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Vm(u2.bind(null,r,i,e),[e]),r.flags|=2048,Ba(9,c2.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Wr(),t=en.identifierPrefix;if(kt){var n=rs,r=ns;n=(r&~(1<<32-Mr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ta++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Ex++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bx={readContext:gr,useCallback:v2,useContext:gr,useEffect:hh,useImperativeHandle:y2,useInsertionEffect:p2,useLayoutEffect:m2,useMemo:x2,useReducer:Yu,useRef:h2,useState:function(){return Yu(Ia)},useDebugValue:ph,useDeferredValue:function(e){var t=yr();return w2(t,Gt.memoizedState,e)},useTransition:function(){var e=Yu(Ia)[0],t=yr().memoizedState;return[e,t]},useMutableSource:o2,useSyncExternalStore:a2,useId:S2,unstable_isNewReconciler:!1},Mx={readContext:gr,useCallback:v2,useContext:gr,useEffect:hh,useImperativeHandle:y2,useInsertionEffect:p2,useLayoutEffect:m2,useMemo:x2,useReducer:Xu,useRef:h2,useState:function(){return Xu(Ia)},useDebugValue:ph,useDeferredValue:function(e){var t=yr();return Gt===null?t.memoizedState=e:w2(t,Gt.memoizedState,e)},useTransition:function(){var e=Xu(Ia)[0],t=yr().memoizedState;return[e,t]},useMutableSource:o2,useSyncExternalStore:a2,useId:S2,unstable_isNewReconciler:!1};function jr(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Qd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Mt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Fc={isMounted:function(e){return(e=e._reactInternals)?xi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Fs(e),i=is(r,s);i.payload=t,n!=null&&(i.callback=n),t=Rs(e,i,s),t!==null&&(Pr(t,e,s,r),Il(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=vn(),s=Fs(e),i=is(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Rs(e,i,s),t!==null&&(Pr(t,e,s,r),Il(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=vn(),r=Fs(e),s=is(n,r);s.tag=2,t!=null&&(s.callback=t),t=Rs(e,s,r),t!==null&&(Pr(t,e,r,n),Il(t,e,r))}};function Ym(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!ja(n,r)||!ja(s,i):!0}function C2(e,t,n){var r=!1,s=Us,i=t.contextType;return typeof i=="object"&&i!==null?i=gr(i):(s=In(t)?di:mn.current,r=t.contextTypes,i=(r=r!=null)?lo(e,s):Us),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Fc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Xm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Fc.enqueueReplaceState(t,t.state,null)}function Jd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},oh(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=gr(i):(i=In(t)?di:mn.current,s.context=lo(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Qd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Fc.enqueueReplaceState(s,s.state,null),ac(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ho(e,t){try{var n="",r=t;do n+=s4(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Ku(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function qd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Px=typeof WeakMap=="function"?WeakMap:Map;function j2(e,t,n){n=is(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){fc||(fc=!0,cf=r),qd(e,t)},n}function _2(e,t,n){n=is(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){qd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qd(e,t),typeof r!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Km(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Px;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Gx.bind(null,e,t,n),t.then(e,e))}function Qm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jm(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=is(-1,1),t.tag=2,Rs(n,t,1))),n.lanes|=1),e)}var Tx=ms.ReactCurrentOwner,Pn=!1;function yn(e,t,n,r){t.child=e===null?n2(t,null,n,r):uo(t,e.child,n,r)}function qm(e,t,n,r,s){n=n.render;var i=t.ref;return Zi(t,s),r=dh(e,t,n,r,i,s),n=fh(),e!==null&&!Pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fs(e,t,s)):(kt&&n&&Zf(t),t.flags|=1,yn(e,t,r,s),t.child)}function Zm(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!kh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,N2(e,t,i,r,s)):(e=$l(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ja,n(a,r)&&e.ref===t.ref)return fs(e,t,s)}return t.flags|=1,e=Os(i,r),e.ref=t.ref,e.return=t,t.child=e}function N2(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(ja(i,r)&&e.ref===t.ref)if(Pn=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Pn=!0);else return t.lanes=e.lanes,fs(e,t,s)}return Zd(e,t,n,r,s)}function b2(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(Vi,Kn),Kn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(Vi,Kn),Kn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ht(Vi,Kn),Kn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,ht(Vi,Kn),Kn|=r;return yn(e,t,s,n),t.child}function M2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Zd(e,t,n,r,s){var i=In(n)?di:mn.current;return i=lo(t,i),Zi(t,s),n=dh(e,t,n,r,i,s),r=fh(),e!==null&&!Pn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,fs(e,t,s)):(kt&&r&&Zf(t),t.flags|=1,yn(e,t,n,s),t.child)}function e1(e,t,n,r,s){if(In(n)){var i=!0;nc(t)}else i=!1;if(Zi(t,s),t.stateNode===null)Ll(e,t),C2(t,n,r),Jd(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,c=t.memoizedProps;a.props=c;var d=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=gr(h):(h=In(n)?di:mn.current,h=lo(t,h));var g=n.getDerivedStateFromProps,x=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function";x||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||d!==h)&&Xm(t,a,r,h),As=!1;var w=t.memoizedState;a.state=w,ac(t,r,a,s),d=t.memoizedState,c!==r||w!==d||Tn.current||As?(typeof g=="function"&&(Qd(t,n,g,r),d=t.memoizedState),(c=As||Ym(t,n,c,r,w,d,h))?(x||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=h,r=c):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,s2(e,t),c=t.memoizedProps,h=t.type===t.elementType?c:jr(t.type,c),a.props=h,x=t.pendingProps,w=a.context,d=n.contextType,typeof d=="object"&&d!==null?d=gr(d):(d=In(n)?di:mn.current,d=lo(t,d));var _=n.getDerivedStateFromProps;(g=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==x||w!==d)&&Xm(t,a,r,d),As=!1,w=t.memoizedState,a.state=w,ac(t,r,a,s);var D=t.memoizedState;c!==x||w!==D||Tn.current||As?(typeof _=="function"&&(Qd(t,n,_,r),D=t.memoizedState),(h=As||Ym(t,n,h,r,w,D,d)||!1)?(g||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,D,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,D,d)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=D),a.props=r,a.state=D,a.context=d,r=h):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),r=!1)}return ef(e,t,n,r,i,s)}function ef(e,t,n,r,s,i){M2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&$m(t,n,!1),fs(e,t,i);r=t.stateNode,Tx.current=t;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=uo(t,e.child,null,i),t.child=uo(t,null,c,i)):yn(e,t,c,i),t.memoizedState=r.state,s&&$m(t,n,!0),t.child}function P2(e){var t=e.stateNode;t.pendingContext?Om(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Om(e,t.context,!1),ah(e,t.containerInfo)}function t1(e,t,n,r,s){return co(),th(s),t.flags|=256,yn(e,t,n,r),t.child}var tf={dehydrated:null,treeContext:null,retryLane:0};function nf(e){return{baseLanes:e,cachePool:null,transitions:null}}function T2(e,t,n){var r=t.pendingProps,s=_t.current,i=!1,a=(t.flags&128)!==0,c;if((c=a)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ht(_t,s&1),e===null)return Xd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Dc(a,r,0,null),e=ci(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=nf(n),t.memoizedState=tf,e):mh(t,a));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Ix(e,t,a,r,c,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,c=s.sibling;var d={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Os(s,d),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Os(c,i):(i=ci(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?nf(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=tf,r}return i=e.child,e=i.sibling,r=Os(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function mh(e,t){return t=Dc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function vl(e,t,n,r){return r!==null&&th(r),uo(t,e.child,null,n),e=mh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ix(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Ku(Error(de(422))),vl(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Dc({mode:"visible",children:r.children},s,0,null),i=ci(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&uo(t,e.child,null,a),t.child.memoizedState=nf(a),t.memoizedState=tf,i);if(!(t.mode&1))return vl(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(de(419)),r=Ku(i,r,void 0),vl(e,t,a,r)}if(c=(a&e.childLanes)!==0,Pn||c){if(r=en,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ds(e,s),Pr(r,e,s,-1))}return Sh(),r=Ku(Error(de(421))),vl(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Vx.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Qn=Bs(s.nextSibling),Jn=t,kt=!0,Nr=null,e!==null&&(ur[dr++]=ns,ur[dr++]=rs,ur[dr++]=fi,ns=e.id,rs=e.overflow,fi=t),t=mh(t,r.children),t.flags|=4096,t)}function n1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Kd(e.return,t,n)}function Qu(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function I2(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(yn(e,t,r.children,n),r=_t.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&n1(e,n,t);else if(e.tag===19)n1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ht(_t,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&lc(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Qu(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&lc(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Qu(t,!0,n,null,i);break;case"together":Qu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ll(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),pi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(de(153));if(t.child!==null){for(e=t.child,n=Os(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Os(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Bx(e,t,n){switch(t.tag){case 3:P2(t),co();break;case 5:i2(t);break;case 1:In(t.type)&&nc(t);break;case 4:ah(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ht(ic,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ht(_t,_t.current&1),t.flags|=128,null):n&t.child.childLanes?T2(e,t,n):(ht(_t,_t.current&1),e=fs(e,t,n),e!==null?e.sibling:null);ht(_t,_t.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return I2(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ht(_t,_t.current),r)break;return null;case 22:case 23:return t.lanes=0,b2(e,t,n)}return fs(e,t,n)}var B2,rf,R2,L2;B2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rf=function(){};R2=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ii(Xr.current);var i=null;switch(n){case"input":s=Cd(e,s),r=Cd(e,r),i=[];break;case"select":s=Mt({},s,{value:void 0}),r=Mt({},r,{value:void 0}),i=[];break;case"textarea":s=Nd(e,s),r=Nd(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ec)}Md(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var c=s[h];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(xa.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var d=r[h];if(c=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&d!==c&&(d!=null||c!=null))if(h==="style")if(c){for(a in c)!c.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in d)d.hasOwnProperty(a)&&c[a]!==d[a]&&(n||(n={}),n[a]=d[a])}else n||(i||(i=[]),i.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(i=i||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(xa.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&yt("scroll",e),i||c===d||(i=[])):(i=i||[]).push(h,d))}n&&(i=i||[]).push("style",n);var h=i;(t.updateQueue=h)&&(t.flags|=4)}};L2=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ko(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function dn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Rx(e,t,n){var r=t.pendingProps;switch(eh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(t),null;case 1:return In(t.type)&&tc(),dn(t),null;case 3:return r=t.stateNode,fo(),vt(Tn),vt(mn),ch(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(gl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nr!==null&&(ff(Nr),Nr=null))),rf(e,t),dn(t),null;case 5:lh(t);var s=ii(Pa.current);if(n=t.type,e!==null&&t.stateNode!=null)R2(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(de(166));return dn(t),null}if(e=ii(Xr.current),gl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Vr]=t,r[ba]=i,e=(t.mode&1)!==0,n){case"dialog":yt("cancel",r),yt("close",r);break;case"iframe":case"object":case"embed":yt("load",r);break;case"video":case"audio":for(s=0;s<ra.length;s++)yt(ra[s],r);break;case"source":yt("error",r);break;case"img":case"image":case"link":yt("error",r),yt("load",r);break;case"details":yt("toggle",r);break;case"input":dm(r,i),yt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},yt("invalid",r);break;case"textarea":hm(r,i),yt("invalid",r)}Md(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&ml(r.textContent,c,e),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&ml(r.textContent,c,e),s=["children",""+c]):xa.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&yt("scroll",r)}switch(n){case"input":al(r),fm(r,i,!0);break;case"textarea":al(r),pm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ec)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ug(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Vr]=t,e[ba]=r,B2(e,t,!1,!1),t.stateNode=e;e:{switch(a=Pd(n,r),n){case"dialog":yt("cancel",e),yt("close",e),s=r;break;case"iframe":case"object":case"embed":yt("load",e),s=r;break;case"video":case"audio":for(s=0;s<ra.length;s++)yt(ra[s],e);s=r;break;case"source":yt("error",e),s=r;break;case"img":case"image":case"link":yt("error",e),yt("load",e),s=r;break;case"details":yt("toggle",e),s=r;break;case"input":dm(e,r),s=Cd(e,r),yt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Mt({},r,{value:void 0}),yt("invalid",e);break;case"textarea":hm(e,r),s=Nd(e,r),yt("invalid",e);break;default:s=r}Md(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var d=c[i];i==="style"?hg(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&dg(e,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&wa(e,d):typeof d=="number"&&wa(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xa.hasOwnProperty(i)?d!=null&&i==="onScroll"&&yt("scroll",e):d!=null&&$f(e,i,d,a))}switch(n){case"input":al(e),fm(e,r,!1);break;case"textarea":al(e),pm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+zs(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ki(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ki(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ec)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dn(t),null;case 6:if(e&&t.stateNode!=null)L2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(de(166));if(n=ii(Pa.current),ii(Xr.current),gl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Vr]=t,(i=r.nodeValue!==n)&&(e=Jn,e!==null))switch(e.tag){case 3:ml(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ml(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vr]=t,t.stateNode=r}return dn(t),null;case 13:if(vt(_t),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&Qn!==null&&t.mode&1&&!(t.flags&128))e2(),co(),t.flags|=98560,i=!1;else if(i=gl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(de(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(de(317));i[Vr]=t}else co(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dn(t),i=!1}else Nr!==null&&(ff(Nr),Nr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?Yt===0&&(Yt=3):Sh())),t.updateQueue!==null&&(t.flags|=4),dn(t),null);case 4:return fo(),rf(e,t),e===null&&_a(t.stateNode.containerInfo),dn(t),null;case 10:return sh(t.type._context),dn(t),null;case 17:return In(t.type)&&tc(),dn(t),null;case 19:if(vt(_t),i=t.memoizedState,i===null)return dn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Ko(i,!1);else{if(Yt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=lc(e),a!==null){for(t.flags|=128,Ko(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ht(_t,_t.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ot()>po&&(t.flags|=128,r=!0,Ko(i,!1),t.lanes=4194304)}else{if(!r)if(e=lc(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ko(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!kt)return dn(t),null}else 2*Ot()-i.renderingStartTime>po&&n!==1073741824&&(t.flags|=128,r=!0,Ko(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ot(),t.sibling=null,n=_t.current,ht(_t,r?n&1|2:n&1),t):(dn(t),null);case 22:case 23:return wh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Kn&1073741824&&(dn(t),t.subtreeFlags&6&&(t.flags|=8192)):dn(t),null;case 24:return null;case 25:return null}throw Error(de(156,t.tag))}function Lx(e,t){switch(eh(t),t.tag){case 1:return In(t.type)&&tc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fo(),vt(Tn),vt(mn),ch(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lh(t),null;case 13:if(vt(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(de(340));co()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vt(_t),null;case 4:return fo(),null;case 10:return sh(t.type._context),null;case 22:case 23:return wh(),null;case 24:return null;default:return null}}var xl=!1,pn=!1,Fx=typeof WeakSet=="function"?WeakSet:Set,ke=null;function Gi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Bt(e,t,r)}else n.current=null}function sf(e,t,n){try{n()}catch(r){Bt(e,t,r)}}var r1=!1;function Ox(e,t){if(zd=Jl,e=zg(),qf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,c=-1,d=-1,h=0,g=0,x=e,w=null;t:for(;;){for(var _;x!==n||s!==0&&x.nodeType!==3||(c=a+s),x!==i||r!==0&&x.nodeType!==3||(d=a+r),x.nodeType===3&&(a+=x.nodeValue.length),(_=x.firstChild)!==null;)w=x,x=_;for(;;){if(x===e)break t;if(w===n&&++h===s&&(c=a),w===i&&++g===r&&(d=a),(_=x.nextSibling)!==null)break;x=w,w=x.parentNode}x=_}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ud={focusedElem:e,selectionRange:n},Jl=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var D=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(D!==null){var I=D.memoizedProps,Y=D.memoizedState,j=t.stateNode,y=j.getSnapshotBeforeUpdate(t.elementType===t.type?I:jr(t.type,I),Y);j.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var A=t.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(M){Bt(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return D=r1,r1=!1,D}function fa(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&sf(t,n,i)}s=s.next}while(s!==r)}}function Oc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function of(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function F2(e){var t=e.alternate;t!==null&&(e.alternate=null,F2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vr],delete t[ba],delete t[Gd],delete t[wx],delete t[Sx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function O2(e){return e.tag===5||e.tag===3||e.tag===4}function s1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||O2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function af(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ec));else if(r!==4&&(e=e.child,e!==null))for(af(e,t,n),e=e.sibling;e!==null;)af(e,t,n),e=e.sibling}function lf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(lf(e,t,n),e=e.sibling;e!==null;)lf(e,t,n),e=e.sibling}var sn=null,_r=!1;function ws(e,t,n){for(n=n.child;n!==null;)$2(e,t,n),n=n.sibling}function $2(e,t,n){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(Mc,n)}catch{}switch(n.tag){case 5:pn||Gi(n,t);case 6:var r=sn,s=_r;sn=null,ws(e,t,n),sn=r,_r=s,sn!==null&&(_r?(e=sn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):sn.removeChild(n.stateNode));break;case 18:sn!==null&&(_r?(e=sn,n=n.stateNode,e.nodeType===8?Hu(e.parentNode,n):e.nodeType===1&&Hu(e,n),Ea(e)):Hu(sn,n.stateNode));break;case 4:r=sn,s=_r,sn=n.stateNode.containerInfo,_r=!0,ws(e,t,n),sn=r,_r=s;break;case 0:case 11:case 14:case 15:if(!pn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&sf(n,t,a),s=s.next}while(s!==r)}ws(e,t,n);break;case 1:if(!pn&&(Gi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Bt(n,t,c)}ws(e,t,n);break;case 21:ws(e,t,n);break;case 22:n.mode&1?(pn=(r=pn)||n.memoizedState!==null,ws(e,t,n),pn=r):ws(e,t,n);break;default:ws(e,t,n)}}function i1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Fx),t.forEach(function(r){var s=Yx.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Cr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,c=a;e:for(;c!==null;){switch(c.tag){case 5:sn=c.stateNode,_r=!1;break e;case 3:sn=c.stateNode.containerInfo,_r=!0;break e;case 4:sn=c.stateNode.containerInfo,_r=!0;break e}c=c.return}if(sn===null)throw Error(de(160));$2(i,a,s),sn=null,_r=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(h){Bt(s,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)D2(t,e),t=t.sibling}function D2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Cr(t,e),Or(e),r&4){try{fa(3,e,e.return),Oc(3,e)}catch(I){Bt(e,e.return,I)}try{fa(5,e,e.return)}catch(I){Bt(e,e.return,I)}}break;case 1:Cr(t,e),Or(e),r&512&&n!==null&&Gi(n,n.return);break;case 5:if(Cr(t,e),Or(e),r&512&&n!==null&&Gi(n,n.return),e.flags&32){var s=e.stateNode;try{wa(s,"")}catch(I){Bt(e,e.return,I)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,c=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&lg(s,i),Pd(c,a);var h=Pd(c,i);for(a=0;a<d.length;a+=2){var g=d[a],x=d[a+1];g==="style"?hg(s,x):g==="dangerouslySetInnerHTML"?dg(s,x):g==="children"?wa(s,x):$f(s,g,x,h)}switch(c){case"input":jd(s,i);break;case"textarea":cg(s,i);break;case"select":var w=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Ki(s,!!i.multiple,_,!1):w!==!!i.multiple&&(i.defaultValue!=null?Ki(s,!!i.multiple,i.defaultValue,!0):Ki(s,!!i.multiple,i.multiple?[]:"",!1))}s[ba]=i}catch(I){Bt(e,e.return,I)}}break;case 6:if(Cr(t,e),Or(e),r&4){if(e.stateNode===null)throw Error(de(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(I){Bt(e,e.return,I)}}break;case 3:if(Cr(t,e),Or(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ea(t.containerInfo)}catch(I){Bt(e,e.return,I)}break;case 4:Cr(t,e),Or(e);break;case 13:Cr(t,e),Or(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(vh=Ot())),r&4&&i1(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(pn=(h=pn)||g,Cr(t,e),pn=h):Cr(t,e),Or(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!g&&e.mode&1)for(ke=e,g=e.child;g!==null;){for(x=ke=g;ke!==null;){switch(w=ke,_=w.child,w.tag){case 0:case 11:case 14:case 15:fa(4,w,w.return);break;case 1:Gi(w,w.return);var D=w.stateNode;if(typeof D.componentWillUnmount=="function"){r=w,n=w.return;try{t=r,D.props=t.memoizedProps,D.state=t.memoizedState,D.componentWillUnmount()}catch(I){Bt(r,n,I)}}break;case 5:Gi(w,w.return);break;case 22:if(w.memoizedState!==null){a1(x);continue}}_!==null?(_.return=w,ke=_):a1(x)}g=g.sibling}e:for(g=null,x=e;;){if(x.tag===5){if(g===null){g=x;try{s=x.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=x.stateNode,d=x.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=fg("display",a))}catch(I){Bt(e,e.return,I)}}}else if(x.tag===6){if(g===null)try{x.stateNode.nodeValue=h?"":x.memoizedProps}catch(I){Bt(e,e.return,I)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===e)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===e)break e;for(;x.sibling===null;){if(x.return===null||x.return===e)break e;g===x&&(g=null),x=x.return}g===x&&(g=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:Cr(t,e),Or(e),r&4&&i1(e);break;case 21:break;default:Cr(t,e),Or(e)}}function Or(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(O2(n)){var r=n;break e}n=n.return}throw Error(de(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(wa(s,""),r.flags&=-33);var i=s1(e);lf(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=s1(e);af(e,c,a);break;default:throw Error(de(161))}}catch(d){Bt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $x(e,t,n){ke=e,z2(e)}function z2(e,t,n){for(var r=(e.mode&1)!==0;ke!==null;){var s=ke,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||xl;if(!a){var c=s.alternate,d=c!==null&&c.memoizedState!==null||pn;c=xl;var h=pn;if(xl=a,(pn=d)&&!h)for(ke=s;ke!==null;)a=ke,d=a.child,a.tag===22&&a.memoizedState!==null?l1(s):d!==null?(d.return=a,ke=d):l1(s);for(;i!==null;)ke=i,z2(i),i=i.sibling;ke=s,xl=c,pn=h}o1(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ke=i):o1(e)}}function o1(e){for(;ke!==null;){var t=ke;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pn||Oc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:jr(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Wm(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Wm(t,a,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var g=h.memoizedState;if(g!==null){var x=g.dehydrated;x!==null&&Ea(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}pn||t.flags&512&&of(t)}catch(w){Bt(t,t.return,w)}}if(t===e){ke=null;break}if(n=t.sibling,n!==null){n.return=t.return,ke=n;break}ke=t.return}}function a1(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ke=n;break}ke=t.return}}function l1(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Oc(4,t)}catch(d){Bt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(d){Bt(t,s,d)}}var i=t.return;try{of(t)}catch(d){Bt(t,i,d)}break;case 5:var a=t.return;try{of(t)}catch(d){Bt(t,a,d)}}}catch(d){Bt(t,t.return,d)}if(t===e){ke=null;break}var c=t.sibling;if(c!==null){c.return=t.return,ke=c;break}ke=t.return}}var Dx=Math.ceil,dc=ms.ReactCurrentDispatcher,gh=ms.ReactCurrentOwner,mr=ms.ReactCurrentBatchConfig,et=0,en=null,zt=null,on=0,Kn=0,Vi=Vs(0),Yt=0,Ra=null,pi=0,$c=0,yh=0,ha=null,Mn=null,vh=0,po=1/0,qr=null,fc=!1,cf=null,Ls=null,wl=!1,Ms=null,hc=0,pa=0,uf=null,Fl=-1,Ol=0;function vn(){return et&6?Ot():Fl!==-1?Fl:Fl=Ot()}function Fs(e){return e.mode&1?et&2&&on!==0?on&-on:Ax.transition!==null?(Ol===0&&(Ol=Cg()),Ol):(e=at,e!==0||(e=window.event,e=e===void 0?16:Tg(e.type)),e):1}function Pr(e,t,n,r){if(50<pa)throw pa=0,uf=null,Error(de(185));za(e,n,r),(!(et&2)||e!==en)&&(e===en&&(!(et&2)&&($c|=n),Yt===4&&js(e,on)),Bn(e,r),n===1&&et===0&&!(t.mode&1)&&(po=Ot()+500,Rc&&Ys()))}function Bn(e,t){var n=e.callbackNode;A4(e,t);var r=Ql(e,e===en?on:0);if(r===0)n!==null&&ym(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&ym(n),t===1)e.tag===0?kx(c1.bind(null,e)):Jg(c1.bind(null,e)),vx(function(){!(et&6)&&Ys()}),n=null;else{switch(jg(r)){case 1:n=Wf;break;case 4:n=Ag;break;case 16:n=Kl;break;case 536870912:n=Eg;break;default:n=Kl}n=K2(n,U2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function U2(e,t){if(Fl=-1,Ol=0,et&6)throw Error(de(327));var n=e.callbackNode;if(eo()&&e.callbackNode!==n)return null;var r=Ql(e,e===en?on:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=pc(e,r);else{t=r;var s=et;et|=2;var i=W2();(en!==e||on!==t)&&(qr=null,po=Ot()+500,li(e,t));do try{Hx();break}catch(c){H2(e,c)}while(!0);rh(),dc.current=i,et=s,zt!==null?t=0:(en=null,on=0,t=Yt)}if(t!==0){if(t===2&&(s=Ld(e),s!==0&&(r=s,t=df(e,s))),t===1)throw n=Ra,li(e,0),js(e,r),Bn(e,Ot()),n;if(t===6)js(e,r);else{if(s=e.current.alternate,!(r&30)&&!zx(s)&&(t=pc(e,r),t===2&&(i=Ld(e),i!==0&&(r=i,t=df(e,i))),t===1))throw n=Ra,li(e,0),js(e,r),Bn(e,Ot()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(de(345));case 2:ni(e,Mn,qr);break;case 3:if(js(e,r),(r&130023424)===r&&(t=vh+500-Ot(),10<t)){if(Ql(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){vn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Wd(ni.bind(null,e,Mn,qr),t);break}ni(e,Mn,qr);break;case 4:if(js(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Mr(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=Ot()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Dx(r/1960))-r,10<r){e.timeoutHandle=Wd(ni.bind(null,e,Mn,qr),r);break}ni(e,Mn,qr);break;case 5:ni(e,Mn,qr);break;default:throw Error(de(329))}}}return Bn(e,Ot()),e.callbackNode===n?U2.bind(null,e):null}function df(e,t){var n=ha;return e.current.memoizedState.isDehydrated&&(li(e,t).flags|=256),e=pc(e,t),e!==2&&(t=Mn,Mn=n,t!==null&&ff(t)),e}function ff(e){Mn===null?Mn=e:Mn.push.apply(Mn,e)}function zx(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Tr(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function js(e,t){for(t&=~yh,t&=~$c,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Mr(t),r=1<<n;e[n]=-1,t&=~r}}function c1(e){if(et&6)throw Error(de(327));eo();var t=Ql(e,0);if(!(t&1))return Bn(e,Ot()),null;var n=pc(e,t);if(e.tag!==0&&n===2){var r=Ld(e);r!==0&&(t=r,n=df(e,r))}if(n===1)throw n=Ra,li(e,0),js(e,t),Bn(e,Ot()),n;if(n===6)throw Error(de(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ni(e,Mn,qr),Bn(e,Ot()),null}function xh(e,t){var n=et;et|=1;try{return e(t)}finally{et=n,et===0&&(po=Ot()+500,Rc&&Ys())}}function mi(e){Ms!==null&&Ms.tag===0&&!(et&6)&&eo();var t=et;et|=1;var n=mr.transition,r=at;try{if(mr.transition=null,at=1,e)return e()}finally{at=r,mr.transition=n,et=t,!(et&6)&&Ys()}}function wh(){Kn=Vi.current,vt(Vi)}function li(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,yx(n)),zt!==null)for(n=zt.return;n!==null;){var r=n;switch(eh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tc();break;case 3:fo(),vt(Tn),vt(mn),ch();break;case 5:lh(r);break;case 4:fo();break;case 13:vt(_t);break;case 19:vt(_t);break;case 10:sh(r.type._context);break;case 22:case 23:wh()}n=n.return}if(en=e,zt=e=Os(e.current,null),on=Kn=t,Yt=0,Ra=null,yh=$c=pi=0,Mn=ha=null,si!==null){for(t=0;t<si.length;t++)if(n=si[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}si=null}return e}function H2(e,t){do{var n=zt;try{if(rh(),Bl.current=uc,cc){for(var r=Nt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cc=!1}if(hi=0,Zt=Gt=Nt=null,da=!1,Ta=0,gh.current=null,n===null||n.return===null){Yt=1,Ra=t,zt=null;break}e:{var i=e,a=n.return,c=n,d=t;if(t=on,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,g=c,x=g.tag;if(!(g.mode&1)&&(x===0||x===11||x===15)){var w=g.alternate;w?(g.updateQueue=w.updateQueue,g.memoizedState=w.memoizedState,g.lanes=w.lanes):(g.updateQueue=null,g.memoizedState=null)}var _=Qm(a);if(_!==null){_.flags&=-257,Jm(_,a,c,i,t),_.mode&1&&Km(i,h,t),t=_,d=h;var D=t.updateQueue;if(D===null){var I=new Set;I.add(d),t.updateQueue=I}else D.add(d);break e}else{if(!(t&1)){Km(i,h,t),Sh();break e}d=Error(de(426))}}else if(kt&&c.mode&1){var Y=Qm(a);if(Y!==null){!(Y.flags&65536)&&(Y.flags|=256),Jm(Y,a,c,i,t),th(ho(d,c));break e}}i=d=ho(d,c),Yt!==4&&(Yt=2),ha===null?ha=[i]:ha.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var j=j2(i,d,t);Hm(i,j);break e;case 1:c=d;var y=i.type,A=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ls===null||!Ls.has(A)))){i.flags|=65536,t&=-t,i.lanes|=t;var M=_2(i,c,t);Hm(i,M);break e}}i=i.return}while(i!==null)}V2(n)}catch(b){t=b,zt===n&&n!==null&&(zt=n=n.return);continue}break}while(!0)}function W2(){var e=dc.current;return dc.current=uc,e===null?uc:e}function Sh(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),en===null||!(pi&268435455)&&!($c&268435455)||js(en,on)}function pc(e,t){var n=et;et|=2;var r=W2();(en!==e||on!==t)&&(qr=null,li(e,t));do try{Ux();break}catch(s){H2(e,s)}while(!0);if(rh(),et=n,dc.current=r,zt!==null)throw Error(de(261));return en=null,on=0,Yt}function Ux(){for(;zt!==null;)G2(zt)}function Hx(){for(;zt!==null&&!p4();)G2(zt)}function G2(e){var t=X2(e.alternate,e,Kn);e.memoizedProps=e.pendingProps,t===null?V2(e):zt=t,gh.current=null}function V2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Lx(n,t),n!==null){n.flags&=32767,zt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Yt=6,zt=null;return}}else if(n=Rx(n,t,Kn),n!==null){zt=n;return}if(t=t.sibling,t!==null){zt=t;return}zt=t=e}while(t!==null);Yt===0&&(Yt=5)}function ni(e,t,n){var r=at,s=mr.transition;try{mr.transition=null,at=1,Wx(e,t,n,r)}finally{mr.transition=s,at=r}return null}function Wx(e,t,n,r){do eo();while(Ms!==null);if(et&6)throw Error(de(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(de(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(E4(e,i),e===en&&(zt=en=null,on=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wl||(wl=!0,K2(Kl,function(){return eo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=mr.transition,mr.transition=null;var a=at;at=1;var c=et;et|=4,gh.current=null,Ox(e,n),D2(n,e),ux(Ud),Jl=!!zd,Ud=zd=null,e.current=n,$x(n),m4(),et=c,at=a,mr.transition=i}else e.current=n;if(wl&&(wl=!1,Ms=e,hc=s),i=e.pendingLanes,i===0&&(Ls=null),v4(n.stateNode),Bn(e,Ot()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(fc)throw fc=!1,e=cf,cf=null,e;return hc&1&&e.tag!==0&&eo(),i=e.pendingLanes,i&1?e===uf?pa++:(pa=0,uf=e):pa=0,Ys(),null}function eo(){if(Ms!==null){var e=jg(hc),t=mr.transition,n=at;try{if(mr.transition=null,at=16>e?16:e,Ms===null)var r=!1;else{if(e=Ms,Ms=null,hc=0,et&6)throw Error(de(331));var s=et;for(et|=4,ke=e.current;ke!==null;){var i=ke,a=i.child;if(ke.flags&16){var c=i.deletions;if(c!==null){for(var d=0;d<c.length;d++){var h=c[d];for(ke=h;ke!==null;){var g=ke;switch(g.tag){case 0:case 11:case 15:fa(8,g,i)}var x=g.child;if(x!==null)x.return=g,ke=x;else for(;ke!==null;){g=ke;var w=g.sibling,_=g.return;if(F2(g),g===h){ke=null;break}if(w!==null){w.return=_,ke=w;break}ke=_}}}var D=i.alternate;if(D!==null){var I=D.child;if(I!==null){D.child=null;do{var Y=I.sibling;I.sibling=null,I=Y}while(I!==null)}}ke=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ke=a;else e:for(;ke!==null;){if(i=ke,i.flags&2048)switch(i.tag){case 0:case 11:case 15:fa(9,i,i.return)}var j=i.sibling;if(j!==null){j.return=i.return,ke=j;break e}ke=i.return}}var y=e.current;for(ke=y;ke!==null;){a=ke;var A=a.child;if(a.subtreeFlags&2064&&A!==null)A.return=a,ke=A;else e:for(a=y;ke!==null;){if(c=ke,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Oc(9,c)}}catch(b){Bt(c,c.return,b)}if(c===a){ke=null;break e}var M=c.sibling;if(M!==null){M.return=c.return,ke=M;break e}ke=c.return}}if(et=s,Ys(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(Mc,e)}catch{}r=!0}return r}finally{at=n,mr.transition=t}}return!1}function u1(e,t,n){t=ho(n,t),t=j2(e,t,1),e=Rs(e,t,1),t=vn(),e!==null&&(za(e,1,t),Bn(e,t))}function Bt(e,t,n){if(e.tag===3)u1(e,e,n);else for(;t!==null;){if(t.tag===3){u1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ls===null||!Ls.has(r))){e=ho(n,e),e=_2(t,e,1),t=Rs(t,e,1),e=vn(),t!==null&&(za(t,1,e),Bn(t,e));break}}t=t.return}}function Gx(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=vn(),e.pingedLanes|=e.suspendedLanes&n,en===e&&(on&n)===n&&(Yt===4||Yt===3&&(on&130023424)===on&&500>Ot()-vh?li(e,0):yh|=n),Bn(e,t)}function Y2(e,t){t===0&&(e.mode&1?(t=ul,ul<<=1,!(ul&130023424)&&(ul=4194304)):t=1);var n=vn();e=ds(e,t),e!==null&&(za(e,t,n),Bn(e,n))}function Vx(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Y2(e,n)}function Yx(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(de(314))}r!==null&&r.delete(t),Y2(e,n)}var X2;X2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Tn.current)Pn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Pn=!1,Bx(e,t,n);Pn=!!(e.flags&131072)}else Pn=!1,kt&&t.flags&1048576&&qg(t,sc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ll(e,t),e=t.pendingProps;var s=lo(t,mn.current);Zi(t,n),s=dh(null,t,r,e,s,n);var i=fh();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,In(r)?(i=!0,nc(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,oh(t),s.updater=Fc,t.stateNode=s,s._reactInternals=t,Jd(t,r,e,n),t=ef(null,t,r,!0,i,n)):(t.tag=0,kt&&i&&Zf(t),yn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ll(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Kx(r),e=jr(r,e),s){case 0:t=Zd(null,t,r,e,n);break e;case 1:t=e1(null,t,r,e,n);break e;case 11:t=qm(null,t,r,e,n);break e;case 14:t=Zm(null,t,r,jr(r.type,e),n);break e}throw Error(de(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),Zd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),e1(e,t,r,s,n);case 3:e:{if(P2(t),e===null)throw Error(de(387));r=t.pendingProps,i=t.memoizedState,s=i.element,s2(e,t),ac(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=ho(Error(de(423)),t),t=t1(e,t,r,n,s);break e}else if(r!==s){s=ho(Error(de(424)),t),t=t1(e,t,r,n,s);break e}else for(Qn=Bs(t.stateNode.containerInfo.firstChild),Jn=t,kt=!0,Nr=null,n=n2(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(co(),r===s){t=fs(e,t,n);break e}yn(e,t,r,n)}t=t.child}return t;case 5:return i2(t),e===null&&Xd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Hd(r,s)?a=null:i!==null&&Hd(r,i)&&(t.flags|=32),M2(e,t),yn(e,t,a,n),t.child;case 6:return e===null&&Xd(t),null;case 13:return T2(e,t,n);case 4:return ah(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=uo(t,null,r,n):yn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),qm(e,t,r,s,n);case 7:return yn(e,t,t.pendingProps,n),t.child;case 8:return yn(e,t,t.pendingProps.children,n),t.child;case 12:return yn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,ht(ic,r._currentValue),r._currentValue=a,i!==null)if(Tr(i.value,a)){if(i.children===s.children&&!Tn.current){t=fs(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var d=c.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=is(-1,n&-n),d.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var g=h.pending;g===null?d.next=d:(d.next=g.next,g.next=d),h.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),Kd(i.return,n,t),c.lanes|=n;break}d=d.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(de(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Kd(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}yn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Zi(t,n),s=gr(s),r=r(s),t.flags|=1,yn(e,t,r,n),t.child;case 14:return r=t.type,s=jr(r,t.pendingProps),s=jr(r.type,s),Zm(e,t,r,s,n);case 15:return N2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jr(r,s),Ll(e,t),t.tag=1,In(r)?(e=!0,nc(t)):e=!1,Zi(t,n),C2(t,r,s),Jd(t,r,s,n),ef(null,t,r,!0,e,n);case 19:return I2(e,t,n);case 22:return b2(e,t,n)}throw Error(de(156,t.tag))};function K2(e,t){return kg(e,t)}function Xx(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(e,t,n,r){return new Xx(e,t,n,r)}function kh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Kx(e){if(typeof e=="function")return kh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zf)return 11;if(e===Uf)return 14}return 2}function Os(e,t){var n=e.alternate;return n===null?(n=hr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function $l(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")kh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Li:return ci(n.children,s,i,t);case Df:a=8,s|=8;break;case Sd:return e=hr(12,n,t,s|2),e.elementType=Sd,e.lanes=i,e;case kd:return e=hr(13,n,t,s),e.elementType=kd,e.lanes=i,e;case Ad:return e=hr(19,n,t,s),e.elementType=Ad,e.lanes=i,e;case ig:return Dc(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case rg:a=10;break e;case sg:a=9;break e;case zf:a=11;break e;case Uf:a=14;break e;case ks:a=16,r=null;break e}throw Error(de(130,e==null?e:typeof e,""))}return t=hr(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ci(e,t,n,r){return e=hr(7,e,r,t),e.lanes=n,e}function Dc(e,t,n,r){return e=hr(22,e,r,t),e.elementType=ig,e.lanes=n,e.stateNode={isHidden:!1},e}function Ju(e,t,n){return e=hr(6,e,null,t),e.lanes=n,e}function qu(e,t,n){return t=hr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qx(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tu(0),this.expirationTimes=Tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ah(e,t,n,r,s,i,a,c,d){return e=new Qx(e,t,n,c,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=hr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},oh(i),e}function Jx(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ri,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Q2(e){if(!e)return Us;e=e._reactInternals;e:{if(xi(e)!==e||e.tag!==1)throw Error(de(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(In(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(de(171))}if(e.tag===1){var n=e.type;if(In(n))return Qg(e,n,t)}return t}function J2(e,t,n,r,s,i,a,c,d){return e=Ah(n,r,!0,e,s,i,a,c,d),e.context=Q2(null),n=e.current,r=vn(),s=Fs(n),i=is(r,s),i.callback=t??null,Rs(n,i,s),e.current.lanes=s,za(e,s,r),Bn(e,r),e}function zc(e,t,n,r){var s=t.current,i=vn(),a=Fs(s);return n=Q2(n),t.context===null?t.context=n:t.pendingContext=n,t=is(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Rs(s,t,a),e!==null&&(Pr(e,s,a,i),Il(e,s,a)),a}function mc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function d1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Eh(e,t){d1(e,t),(e=e.alternate)&&d1(e,t)}function qx(){return null}var q2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ch(e){this._internalRoot=e}Uc.prototype.render=Ch.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(de(409));zc(e,t,null,null)};Uc.prototype.unmount=Ch.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;mi(function(){zc(null,e,null,null)}),t[us]=null}};function Uc(e){this._internalRoot=e}Uc.prototype.unstable_scheduleHydration=function(e){if(e){var t=bg();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Cs.length&&t!==0&&t<Cs[n].priority;n++);Cs.splice(n,0,e),n===0&&Pg(e)}};function jh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Hc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function f1(){}function Zx(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=mc(a);i.call(h)}}var a=J2(t,r,e,0,null,!1,!1,"",f1);return e._reactRootContainer=a,e[us]=a.current,_a(e.nodeType===8?e.parentNode:e),mi(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var h=mc(d);c.call(h)}}var d=Ah(e,0,!1,null,null,!1,!1,"",f1);return e._reactRootContainer=d,e[us]=d.current,_a(e.nodeType===8?e.parentNode:e),mi(function(){zc(t,d,n,r)}),d}function Wc(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var d=mc(a);c.call(d)}}zc(t,a,e,s)}else a=Zx(n,t,e,s,r);return mc(a)}_g=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=na(t.pendingLanes);n!==0&&(Gf(t,n|1),Bn(t,Ot()),!(et&6)&&(po=Ot()+500,Ys()))}break;case 13:mi(function(){var r=ds(e,1);if(r!==null){var s=vn();Pr(r,e,1,s)}}),Eh(e,1)}};Vf=function(e){if(e.tag===13){var t=ds(e,134217728);if(t!==null){var n=vn();Pr(t,e,134217728,n)}Eh(e,134217728)}};Ng=function(e){if(e.tag===13){var t=Fs(e),n=ds(e,t);if(n!==null){var r=vn();Pr(n,e,t,r)}Eh(e,t)}};bg=function(){return at};Mg=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Id=function(e,t,n){switch(t){case"input":if(jd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Bc(r);if(!s)throw Error(de(90));ag(r),jd(r,s)}}}break;case"textarea":cg(e,n);break;case"select":t=n.value,t!=null&&Ki(e,!!n.multiple,t,!1)}};gg=xh;yg=mi;var ew={usingClientEntryPoint:!1,Events:[Ha,Di,Bc,pg,mg,xh]},Qo={findFiberByHostInstance:ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tw={bundleType:Qo.bundleType,version:Qo.version,rendererPackageName:Qo.rendererPackageName,rendererConfig:Qo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wg(e),e===null?null:e.stateNode},findFiberByHostInstance:Qo.findFiberByHostInstance||qx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sl.isDisabled&&Sl.supportsFiber)try{Mc=Sl.inject(tw),Yr=Sl}catch{}}er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ew;er.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jh(t))throw Error(de(200));return Jx(e,t,null,n)};er.createRoot=function(e,t){if(!jh(e))throw Error(de(299));var n=!1,r="",s=q2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ah(e,1,!1,null,null,n,!1,r,s),e[us]=t.current,_a(e.nodeType===8?e.parentNode:e),new Ch(t)};er.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(de(188)):(e=Object.keys(e).join(","),Error(de(268,e)));return e=wg(t),e=e===null?null:e.stateNode,e};er.flushSync=function(e){return mi(e)};er.hydrate=function(e,t,n){if(!Hc(t))throw Error(de(200));return Wc(null,e,t,!0,n)};er.hydrateRoot=function(e,t,n){if(!jh(e))throw Error(de(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=q2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=J2(t,null,e,1,n??null,s,!1,i,a),e[us]=t.current,_a(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Uc(t)};er.render=function(e,t,n){if(!Hc(t))throw Error(de(200));return Wc(null,e,t,!1,n)};er.unmountComponentAtNode=function(e){if(!Hc(e))throw Error(de(40));return e._reactRootContainer?(mi(function(){Wc(null,null,e,!1,function(){e._reactRootContainer=null,e[us]=null})}),!0):!1};er.unstable_batchedUpdates=xh;er.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Hc(n))throw Error(de(200));if(e==null||e._reactInternals===void 0)throw Error(de(38));return Wc(e,t,n,!1,r)};er.version="18.3.1-next-f1338f8080-20240426";function Z2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z2)}catch(e){console.error(e)}}Z2(),Z0.exports=er;var nw=Z0.exports,h1=nw;xd.createRoot=h1.createRoot,xd.hydrateRoot=h1.hydrateRoot;const to={},ey="production",p1={development:{baseUrl:"http://localhost:4000/api",healthUrl:"http://localhost:4000/health"},production:{baseUrl:"https://cfg-279108523744.europe-west1.run.app/api",healthUrl:"https://cfg-279108523744.europe-west1.run.app/health"}},ty=p1[ey]||p1.development,Ga=()=>{if(!(to!=null&&to.VITE_API_BASE_URL))return ty.baseUrl},rw=()=>{if(!(to!=null&&to.VITE_HEALTH_URL))return ty.healthUrl},sw=async()=>{try{const e=await fetch(rw(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Health check failed: ${e.status}`);const t=await e.json();return{status:t.status||"unknown",version:t.version||"unknown",commit:t.commit||"unknown",healthy:t.status==="ok"}}catch(e){return console.error("[API Config] Health check error:",e),{status:"error",version:"unknown",commit:"unknown",healthy:!1,error:e.message}}},iw=()=>ey;function ow({onStart:e}){const[t,n]=k.useState("1"),[r,s]=k.useState("individual"),[i,a]=k.useState("15"),[c,d]=k.useState({status:"checking",version:"...",commit:"...",healthy:!1});k.useEffect(()=>{const w=async()=>{const D=await sw();d(D),console.log("[StartDialog] Server health:",D)};w();const _=setInterval(w,3e4);return()=>clearInterval(_)},[]);const h=()=>{if(!t||!i){alert("Please fill in all fields");return}const w={id:t,sessionGameId:t,condition:r,timeSeconds:parseInt(i)*60,date:new Date().toISOString().replace("T"," ").substring(0,19)};e(w)},g=()=>{window.close()},x=()=>c.status==="checking"?"checking":c.healthy?"healthy":"unhealthy";return l.jsx("div",{className:"dialog-overlay",children:l.jsxs("div",{className:"dialog-box",children:[l.jsxs("div",{className:"dialog-header",children:[l.jsx("h2",{children:"The Creative Game"}),l.jsxs("div",{className:`server-health-indicator ${x()}`,title:`Server: ${c.status}
Version: ${c.version}
Commit: ${c.commit}
Environment: ${iw()}`,children:[l.jsx("span",{className:"health-light"}),l.jsx("span",{className:"health-text",children:"Server"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"ID:"}),l.jsx("input",{type:"text",value:t,onChange:w=>n(w.target.value)})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Condition:"}),l.jsxs("select",{value:r,onChange:w=>s(w.target.value),children:[l.jsx("option",{value:"individual",children:"individual"}),l.jsx("option",{value:"group",children:"group"})]})]}),l.jsxs("div",{className:"dialog-field",children:[l.jsx("label",{children:"Time (in minutes):"}),l.jsx("input",{type:"number",value:i,onChange:w=>a(w.target.value),min:"1"})]}),l.jsxs("div",{className:"dialog-buttons",children:[l.jsx("button",{className:"dialog-button",onClick:()=>{window.location.hash="/calibrate"},children:"Calibrate Colors"}),l.jsx("button",{className:"dialog-button small-button",onClick:()=>{window.location.hash="/admin"},children:"Admin"}),l.jsx("button",{className:"dialog-button ok",onClick:h,children:"OK"}),l.jsx("button",{className:"dialog-button cancel",onClick:g,children:"Cancel"})]})]})})}class m1{constructor(t){this.subjectId=(t==null?void 0:t.id)||"",this.sessionId=(t==null?void 0:t.sessionGameId)||this.subjectId,this.logs=[],this.header=["date","id","sessionGameId","condition","phase","type","time","unit","end_position","all_positions","gallery_shape_number","gallery","gallery_normalized"]}write(t){this.logs.push(t)}clear(){this.logs=[]}}const aw=.035;class lw{constructor(){this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.isTracking=!1,this.trackingWindow=1e3,this.lastKnownPlayer=null,this.sessionInfo=null,this.apiBaseUrl=Ga(),this.sessionInitialized=!1,this.setupBraceletListener()}setupBraceletListener(){this.braceletInterval=setInterval(()=>{this.recordBraceletStatus()},100)}recordBraceletStatus(){if(!this.isTracking)return;const t=Date.now(),n=(t-this.startTime)/1e3,r=this.getCurrentBraceletStatus();if((r==="Player A"||r==="Player B")&&(this.lastKnownPlayer=r,this.braceletHistory.length>0)){const i=this.braceletHistory[this.braceletHistory.length-1];if(t-i.timestamp<200&&(i.status==="None"||i.status==="Unknown")){i.status=r,i.timestamp=t;return}}this.braceletHistory.push({timestamp:t,elapsed:n,status:r});const s=t-1e4;this.braceletHistory=this.braceletHistory.filter(i=>i.timestamp>=s)}getCurrentBraceletStatus(){return window.currentBraceletStatus?window.currentBraceletStatus:"None"}async setSessionInfo(t={}){var s;const{colorA:n,colorB:r}=this.getCalibrationColors();this.sessionInfo={...t,colorA:n,colorB:r,startedAt:((s=this.sessionInfo)==null?void 0:s.startedAt)||new Date(this.startTime).toISOString()},console.log("[GameTracker] Session info set with colors:",{colorA:n,colorB:r}),await this.initializeSession()}hsvToHex(t){if(!t||typeof t.h>"u")return null;const n=(t.h||0)*2,r=(t.s||0)/255,s=(t.v||0)/255,i=s*r,a=i*(1-Math.abs(n/60%2-1)),c=s-i;let d=0,h=0,g=0;n>=0&&n<60?(d=i,h=a,g=0):n<120?(d=a,h=i,g=0):n<180?(d=0,h=i,g=a):n<240?(d=0,h=a,g=i):n<300?(d=a,h=0,g=i):(d=i,h=0,g=a);const x=w=>{const _=Math.round((w+c)*255).toString(16);return _.length===1?"0"+_:_};return`#${x(d)}${x(h)}${x(g)}`.toUpperCase()}getCalibrationColors(){try{const t=JSON.parse(localStorage.getItem("calibrationA")||"null"),n=JSON.parse(localStorage.getItem("calibrationB")||"null");return{colorA:this.hsvToHex(t),colorB:this.hsvToHex(n)}}catch(t){return console.warn("[GameTracker] Error reading calibration colors:",t),{colorA:null,colorB:null}}}async initializeSession(){var s;if(this.sessionInitialized||!((s=this.sessionInfo)!=null&&s.sessionGameId))return;const{colorA:t,colorB:n}=this.getCalibrationColors(),r={sessionGameId:this.sessionInfo.sessionGameId,subjectId:this.sessionInfo.id,condition:this.sessionInfo.condition,date:this.sessionInfo.date,timeSeconds:this.sessionInfo.timeSeconds,colorA:t,colorB:n,metadata:{config:this.sessionInfo}};console.log("[GameTracker] Initializing session with colors:",{colorA:t,colorB:n});try{const i=await fetch(`${this.apiBaseUrl}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok){const c=(await i.json().catch(()=>({}))).message||`Failed to initialize session (${i.status})`;throw i.status===409?(alert(` Session ID Conflict

${c}

Please choose a different Session ID.`),this.stop(),new Error(c)):new Error(c)}this.sessionInitialized=!0,console.log("[GameTracker] Session initialized on server:",this.sessionInfo.sessionGameId)}catch(i){throw console.error("[GameTracker] Failed to initialize session:",i),i}}start(){this.isTracking=!0,this.startTime=Date.now(),this.moves=[],this.braceletHistory=[],this.sessionInfo&&(this.sessionInfo.startedAt=new Date(this.startTime).toISOString())}stop(){this.isTracking=!1,this.braceletInterval&&clearInterval(this.braceletInterval)}relativeToGrid(t){if(!t)return null;const n=r=>{const s=r/aw,i=Math.round(s);return Math.max(-20,Math.min(20,i))};return[n(t[0]),n(t[1])]}async recordMove(t,n=0,r=null){if(!this.isTracking)return;const s=Date.now(),i=(s-this.startTime)/1e3,a=t.player||this.determinePlayer(s),c=t.grid_end_position??(t.end_position?this.relativeToGrid(t.end_position):null),d=t.grid_all_positions??(t.all_positions?t.all_positions.map(w=>this.relativeToGrid(w)):null),h={timestamp:s,elapsed:i,player:a,holdTime:n,blockId:t.unit,position:c,allPositions:d,phase:t.phase,type:t.type,subjectId:t.id,sessionGameId:t.sessionGameId,condition:t.condition,date:t.date,end_position:t.end_position,all_positions:t.all_positions,grid_end_position:c,grid_all_positions:d};(r||t.camera_frame)&&(h.camera_frame=r||t.camera_frame),t.gallery_shape_number!==void 0&&(h.gallery_shape_number=t.gallery_shape_number,h.gallery=t.gallery,h.gallery_normalized=t.gallery_normalized,h.grid_gallery=t.grid_gallery??(t.gallery?t.gallery.map(w=>this.relativeToGrid(w)):null),h.grid_gallery_normalized=t.grid_gallery_normalized??(t.gallery_normalized?t.gallery_normalized.map(w=>this.relativeToGrid(w)):null)),this.moves.push(h),this.persistMove(h).catch(w=>{console.error("[GameTracker] Failed to persist move to server:",w)});const g=this.getCurrentBraceletStatus(),x=this.lastKnownPlayer;console.log("[GameTracker] Move recorded:",{player:a,blockId:t.unit,position:c,holdTime:n.toFixed(2)+"s",elapsed:i.toFixed(2)+"s",phase:t.phase,debug:{currentStatus:g,lastKnownPlayer:x,historyLength:this.braceletHistory.length,recentHistory:this.braceletHistory.slice(-5).map(w=>({status:w.status,elapsed:w.elapsed.toFixed(2)}))}})}async persistMove(t){var r;if(!this.sessionInitialized||!((r=this.sessionInfo)!=null&&r.sessionGameId)){console.warn("[GameTracker] Cannot persist move - session not initialized");return}const n=`${this.apiBaseUrl}/sessions/${encodeURIComponent(this.sessionInfo.sessionGameId)}/moves`;console.log(`[GameTracker] Persisting move to: ${n}`);try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const a=await s.text();throw console.error(`[GameTracker] Server error (${s.status}):`,a),new Error(`Failed to persist move (${s.status}): ${a}`)}const i=await s.json();return console.log("[GameTracker]  Move persisted successfully:",i),i}catch(s){throw console.error("[GameTracker]  persistMove error:",s),s}}determinePlayer(t){const n=this.getCurrentBraceletStatus();if(n==="Player A"||n==="Player B")return n;let r=this.findStatusAtTime(t);if(r&&(r.status==="Player A"||r.status==="Player B"))return r.status;const s=t-this.trackingWindow,i=t+this.trackingWindow,a=this.braceletHistory.filter(c=>c.timestamp>=s&&c.timestamp<=i);if(a.length>0){const c={};a.forEach(h=>{(h.status==="Player A"||h.status==="Player B")&&(c[h.status]=(c[h.status]||0)+1)});const d=Object.keys(c).reduce((h,g)=>c[h]>c[g]?h:g,null);if(d)return d}return this.lastKnownPlayer?this.lastKnownPlayer:n!=="None"?n:"Unknown"}findStatusAtTime(t){if(this.braceletHistory.length===0)return null;let n=null,r=1/0;for(const s of this.braceletHistory){const i=Math.abs(s.timestamp-t);i<r&&i<=1e3&&(r=i,n=s)}return n}exportToJSON(){const t={startTime:new Date(this.startTime).toISOString(),endTime:new Date().toISOString(),duration:(Date.now()-this.startTime)/1e3,sessionInfo:this.sessionInfo,moves:this.moves,braceletHistory:this.braceletHistory,summary:{totalMoves:this.moves.length,movesByPlayer:this.getMovesByPlayer(),movesByPhase:this.getMovesByPhase()}};return JSON.stringify(t,null,2)}getMovesByPlayer(){const t={};return this.moves.forEach(n=>{t[n.player]=(t[n.player]||0)+1}),t}getMovesByPhase(){const t={};return this.moves.forEach(n=>{const r=n.phase||"unknown";t[r]=(t[r]||0)+1}),t}static loadFromJSON(t){try{return JSON.parse(t)}catch(n){return console.error("Failed to parse game JSON:",n),null}}}let Zu=null;const g1=()=>(Zu||(Zu=new lw),Zu),br=.07,ma=()=>[[-.315,0],[-.245,0],[-.175,0],[-.105,0],[-.035,0],[.035,0],[.105,0],[.175,0],[.245,0],[.315,0]].map((t,n)=>({id:n,position:[...t],neighbors:[],canMove:!1})),jt=e=>Math.round(e*1e3)/1e3,cw=(e,t)=>{let n=[];e.forEach(i=>{if(i.id!==t){const a=[[jt(i.position[0]-br),jt(i.position[1])],[jt(i.position[0]+br),jt(i.position[1])],[jt(i.position[0]),jt(i.position[1]-br)],[jt(i.position[0]),jt(i.position[1]+br)]];n.push(...a)}});const r=new Set(n.map(i=>`${i[0]},${i[1]}`));n=Array.from(r).map(i=>i.split(",").map(Number));const s=e.map(i=>`${i.position[0]},${i.position[1]}`);return n=n.filter(i=>!s.includes(`${i[0]},${i[1]}`)),n=n.filter(i=>i[0]<.735&&i[0]>-.735&&i[1]<.42&&i[1]>-.49),n},uw=(e,t)=>{if(e.length===0)return t;let n=1/0,r=e[0];return e.forEach(s=>{const i=Math.sqrt(Math.pow(s[0]-t[0],2)+Math.pow(s[1]-t[1],2));i<n&&(n=i,r=s)}),r},hf=e=>e.map(t=>{const n=[],r=[[jt(t.position[0]-br),jt(t.position[1])],[jt(t.position[0]+br),jt(t.position[1])],[jt(t.position[0]),jt(t.position[1]-br)],[jt(t.position[0]),jt(t.position[1]+br)]];return e.forEach(s=>{r.forEach(i=>{jt(s.position[0])===i[0]&&jt(s.position[1])===i[1]&&n.push(s.position)})}),{...t,neighbors:n}}),dw=e=>{const t=new Set;if(e.forEach((a,c)=>{a.forEach((d,h)=>{d&&t.add(`${c},${h}`)})}),t.size===0)return!0;const n=[[0,1],[1,0],[-1,0],[0,-1]],r=Array.from(t)[0].split(",").map(Number),s=new Set,i=[r];for(;i.length>0;){const[a,c]=i.shift(),d=`${a},${c}`;s.has(d)||(s.add(d),n.forEach(([h,g])=>{const x=`${a+h},${c+g}`;t.has(x)&&!s.has(x)&&i.push([a+h,c+g])}))}return s.size===t.size},fw=(e,t)=>{const n=[];for(let i=-.945;i<=1.015;i+=br)n.push(jt(i));const r=[];for(let i=-.7;i<0;i+=br)r.push(jt(i));for(let i=0;i<=.77;i+=br)r.push(jt(i));const s=Array(r.length).fill(null).map(()=>Array(n.length).fill(!1));return e.forEach((i,a)=>{if(a!==t){const c=n.findIndex(h=>Math.abs(h-i[0])<.001),d=r.findIndex(h=>Math.abs(h-i[1])<.001);c!==-1&&d!==-1&&(s[d][c]=!0)}}),dw(s)},pf=(e,t)=>{const n=e.map(r=>r.position);return e.map((r,s)=>{const i=fw(n,s);return{...r,canMove:i,color:t&&i?"blue":"green"}})},y1=e=>{if(e.length===0)return null;try{const t=e.map(g=>g[0]),n=e.map(g=>g[1]),r=(Math.max(...t)+Math.min(...t))/2,s=(Math.max(...n)+Math.min(...n))/2;let i=1/0,a=e[0];e.forEach(g=>{const x=Math.sqrt(Math.pow(g[0]-r,2)+Math.pow(g[1]-s,2));x<i&&(i=x,a=g)});const c=-a[0],d=-a[1],h=e.map(g=>[jt(g[0]+c),jt(g[1]+d)]);return h.sort((g,x)=>g[0]-x[0]||g[1]-x[1]),h}catch{return null}},hw=60,v1=.07,ed=120;function pw({config:e,interfaceHidden:t=!1}){const[n,r]=k.useState(ma()),[s,i]=k.useState(null),[a,c]=k.useState({x:0,y:0}),[d,h]=k.useState(!0),[g,x]=k.useState(e.timeSeconds),[w,_]=k.useState(0),[D,I]=k.useState(null),[Y,j]=k.useState(!0),[y,A]=k.useState(""),[M,b]=k.useState(!1),[H,R]=k.useState({blockSize:hw,bottomPadding:ed}),O=k.useRef(null),z=k.useRef(new m1(e)),W=k.useRef(g1()),X=k.useRef(null),q=k.useRef(Date.now()),J=k.useRef(ed),re=`Welcome to the creative game!

Your task is to move around blocks to create interesting and beautiful figures.

Everytime you have created a figure you like, tap on the gallery in the upper right corner in order to save your figure to the gallery.

The experiment proceeds through ${e.timeSeconds/60} minutes.

Tell the experimenter when you are ready for the practice round.`,pe=`This was the end of the practice round.

Let the experimenter know when you are ready to begin the actual experiment.`,me="The experiment is done. Thank you very much for your participation!",Se=k.useCallback(()=>{const U=O.current;if(!U)return;const G=U.offsetWidth,Q=U.offsetHeight;if(!G||!Q)return;const te=J.current||ed;let $=Math.max(1,Math.min(G,Q-te)),m=Math.max(38,Math.min($*v1*.95,$/4)),P=Math.max(m*2.5,110);$=Math.max(1,Math.min(G,Q-P)),m=Math.max(38,Math.min($*v1*.95,$/4)),P=Math.max(m*2.5,110),J.current=P,R(N=>{const v=Math.abs(N.blockSize-m),T=Math.abs(N.bottomPadding-P);return v<.5&&T<.5?N:{blockSize:m,bottomPadding:P}})},[]);k.useEffect(()=>(A(re),(async()=>{try{W.current.start(),await W.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker started")}catch(G){console.error("[GameCanvas] Failed to initialize tracker:",G),setTimeout(()=>{alert("Failed to start session. Please try again with a different Session ID."),window.location.reload()},100)}})(),window.endGameExperience=()=>{j(!0),A(me),b(!0),W.current.stop(),console.log("[GameCanvas] Game ended via endGameExperience(). All data saved to server.")},()=>{window.endGameExperience&&delete window.endGameExperience,W.current.stop()}),[]),k.useEffect(()=>{Se()},[Se,t]),k.useEffect(()=>{const U=()=>{Se()};return U(),window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[Se]),k.useEffect(()=>{if(!d&&g>0){const U=setInterval(()=>{x(G=>G<=1?(clearInterval(U),j(!0),A(me),b(!0),console.log("[GameCanvas] Game ended by timer. All data saved to server."),0):G-1)},1e3);return()=>clearInterval(U)}},[d,g]),k.useEffect(()=>{r(U=>pf(hf(U),d))},[d]);const ie=()=>(Date.now()-q.current)/1e3,ne=(U,G)=>{const Q=O.current;if(!Q)return 0;const te=Q.offsetHeight-J.current,$=Math.min(Q.offsetWidth,te),m=G==="x"?(Q.offsetWidth-$)/2:(Q.offsetHeight-J.current-$)/2;return(U-m)/$-.5},ee=(U,G)=>{const Q=O.current;if(!Q)return 0;const te=Q.offsetHeight-J.current,$=Math.min(Q.offsetWidth,te),m=G==="x"?(Q.offsetWidth-$)/2:(Q.offsetHeight-J.current-$)/2;return(U+.5)*$+m},he=U=>{var $,m,P,N;const G=O.current.getBoundingClientRect(),Q=U.clientX!==void 0?U.clientX:(m=($=U.touches)==null?void 0:$[0])==null?void 0:m.clientX,te=U.clientY!==void 0?U.clientY:(N=(P=U.touches)==null?void 0:P[0])==null?void 0:N.clientY;return{x:Q-G.left,y:te-G.top}},_e=(U,G)=>{const Q=n.find(P=>P.id===G);if(!Q||!Q.canMove)return;U.preventDefault();const te=he(U),$=ee(Q.position[0],"x"),m=ee(Q.position[1],"y");X.current=Date.now(),i(G),c({x:te.x-$,y:te.y-m})},We=U=>{if(s===null)return;U.preventDefault();const G=he(U),Q=ne(G.x-a.x,"x"),te=ne(G.y-a.y,"y");r($=>$.map(m=>m.id===s?{...m,position:[Q,te]}:m))},ze=()=>{try{const U=window.braceletDetectorVideo;if(!U||!U.videoWidth||U.videoWidth===0)return console.warn("[GameCanvas] No raw video source available for frame capture"),null;const G=document.createElement("canvas"),Q=640,te=480;let $=U.videoWidth,m=U.videoHeight;const P=$/m;return $>Q&&($=Q,m=$/P),m>te&&(m=te,$=m*P),G.width=Math.floor($),G.height=Math.floor(m),G.getContext("2d").drawImage(U,0,0,G.width,G.height),G.toDataURL("image/jpeg",.6)}catch(U){return console.error("[GameCanvas] Error capturing camera frame:",U),null}},Ne=()=>{if(s===null)return;const U=n.find(v=>v.id===s),G=cw(n,s),Q=uw(G,U.position),te=X.current?(Date.now()-X.current)/1e3:0,$=n.map(v=>v.id===s?{...v,position:Q}:v),m=ze(),P=window.currentBraceletStatus||"Unknown",N={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"moveblock",time:ie(),unit:s,end_position:Q,all_positions:$.map(v=>v.position),gallery_shape_number:null,gallery:null,gallery_normalized:null,camera_frame:m,player:P};z.current.write(N),W.current.recordMove(N,te,m),r(v=>{const T=v.map(F=>F.id===s?{...F,position:Q}:F);return pf(hf(T),d)}),i(null),X.current=null},De=()=>{const U=n.map(N=>N.position),G=y1(U),Q=w+1,te=ze(),$=window.currentBraceletStatus||"Unknown",m={date:e.date,id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,phase:d?"practice":"experiment",type:"added shape to gallery",time:ie(),unit:null,end_position:null,all_positions:null,gallery_shape_number:Q,gallery:U,gallery_normalized:G,camera_frame:te,player:$};z.current.write(m),W.current.recordMove(m,0,te);const P=se();I(P),_(Q)},se=()=>{const U=document.createElement("canvas");U.width=400,U.height=400;const G=U.getContext("2d");G.fillStyle="#000",G.fillRect(0,0,400,400);const Q=n.map($=>$.position),te=y1(Q);return te&&te.forEach($=>{const m=($[0]+.5)*400,P=($[1]+.5)*400;G.fillStyle="green",G.fillRect(m-15,P-15,30,30)}),U.toDataURL()},le=k.useCallback(U=>{U.key==="p"&&d?(h(!1),j(!0),A(pe),q.current=Date.now(),r(ma()),I(null),_(0),z.current=new m1(e),W.current.stop(),W.current=g1(),W.current.start(),W.current.setSessionInfo({id:e.id,sessionGameId:e.sessionGameId,condition:e.condition,timeSeconds:e.timeSeconds,date:e.date}),console.log("[GameCanvas] Game tracker restarted for real game")):U.key==="q"&&!d&&(j(!0),A(me),b(!0),console.log("[GameCanvas] Game ended manually (q key). All data saved to server."))},[d,e.id]);k.useEffect(()=>(window.addEventListener("keydown",le),()=>window.removeEventListener("keydown",le)),[le]);const ve=()=>{if(M&&y===me){console.log("[GameCanvas] Game ended - redirecting to start dialog"),window.toggleInterface&&window.toggleInterface(!1),window.location.hash="#/",window.location.reload();return}if(!d&&y===pe)try{const U=new(window.AudioContext||window.webkitAudioContext),G=U.createOscillator(),Q=U.createGain();G.connect(Q),Q.connect(U.destination),G.frequency.setValueAtTime(800,U.currentTime),G.frequency.setValueAtTime(600,U.currentTime+.15),Q.gain.setValueAtTime(.3,U.currentTime),Q.gain.exponentialRampToValueAtTime(.01,U.currentTime+.3),G.start(U.currentTime),G.stop(U.currentTime+.3),console.log("[GameCanvas] Playing start sound - Real experiment begins!")}catch(U){console.error("[GameCanvas] Error playing sound:",U)}j(!1)},fe=U=>{U.preventDefault()};return l.jsxs("div",{className:"game-canvas",ref:O,style:{"--block-size":`${H.blockSize}px`,"--bottom-padding":`${H.bottomPadding}px`},onMouseMove:We,onMouseUp:Ne,onMouseLeave:Ne,onTouchMove:We,onTouchEnd:Ne,onTouchCancel:Ne,onContextMenu:fe,children:[l.jsx("div",{className:"gallery",onClick:De,children:l.jsx("div",{className:"gallery-frame",children:D?l.jsx("img",{src:D,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),!d&&!t&&l.jsxs("div",{className:"timer",children:["Time: ",Math.floor(g/60),":",(g%60).toString().padStart(2,"0")]}),n.map(U=>l.jsx("div",{className:`block ${U.canMove?"movable":""}`,style:{left:`${ee(U.position[0],"x")}px`,top:`${ee(U.position[1],"y")}px`,backgroundColor:U.color||"green",cursor:U.canMove?"grab":"default"},onMouseDown:G=>_e(G,U.id),onTouchStart:G=>_e(G,U.id)},U.id)),Y&&l.jsx("div",{className:"message-overlay",onClick:ve,children:l.jsxs("div",{className:"message-box",children:[y,l.jsx("div",{className:"message-hint",children:"(Click to continue)"})]})})]})}var gc={};(function(){var e;function t(o){var u=0;return function(){return u<o.length?{done:!1,value:o[u++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,f){return o==Array.prototype||o==Object.prototype||(o[u]=f.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ju=="object"&&ju];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var s=r(this);function i(o,u){if(u)e:{var f=s;o=o.split(".");for(var p=0;p<o.length-1;p++){var S=o[p];if(!(S in f))break e;f=f[S]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&n(f,o,{configurable:!0,writable:!0,value:u})}}i("Symbol",function(o){function u(C){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return new f(p+(C||"")+"_"+S++,C)}function f(C,E){this.h=C,n(this,"description",{configurable:!0,writable:!0,value:E})}if(o)return o;f.prototype.toString=function(){return this.h};var p="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",S=0;return u}),i("Symbol.iterator",function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var u="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<u.length;f++){var p=s[u[f]];typeof p=="function"&&typeof p.prototype[o]!="function"&&n(p.prototype,o,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return o});function a(o){return o={next:o},o[Symbol.iterator]=function(){return this},o}function c(o){var u=typeof Symbol<"u"&&Symbol.iterator&&o[Symbol.iterator];return u?u.call(o):{next:t(o)}}function d(o){if(!(o instanceof Array)){o=c(o);for(var u,f=[];!(u=o.next()).done;)f.push(u.value);o=f}return o}var h=typeof Object.assign=="function"?Object.assign:function(o,u){for(var f=1;f<arguments.length;f++){var p=arguments[f];if(p)for(var S in p)Object.prototype.hasOwnProperty.call(p,S)&&(o[S]=p[S])}return o};i("Object.assign",function(o){return o||h});var g=typeof Object.create=="function"?Object.create:function(o){function u(){}return u.prototype=o,new u},x;if(typeof Object.setPrototypeOf=="function")x=Object.setPrototypeOf;else{var w;e:{var _={a:!0},D={};try{D.__proto__=_,w=D.a;break e}catch{}w=!1}x=w?function(o,u){if(o.__proto__=u,o.__proto__!==u)throw new TypeError(o+" is not extensible");return o}:null}var I=x;function Y(o,u){if(o.prototype=g(u.prototype),o.prototype.constructor=o,I)I(o,u);else for(var f in u)if(f!="prototype")if(Object.defineProperties){var p=Object.getOwnPropertyDescriptor(u,f);p&&Object.defineProperty(o,f,p)}else o[f]=u[f];o.ya=u.prototype}function j(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function y(o){if(o.m)throw new TypeError("Generator is already running");o.m=!0}j.prototype.u=function(o){this.i=o};function A(o,u){o.l={ma:u,na:!0},o.h=o.s||o.v}j.prototype.return=function(o){this.l={return:o},this.h=this.v};function M(o,u,f){return o.h=f,{value:u}}function b(o){this.h=new j,this.i=o}function H(o,u){y(o.h);var f=o.h.j;return f?R(o,"return"in f?f.return:function(p){return{value:p,done:!0}},u,o.h.return):(o.h.return(u),O(o))}function R(o,u,f,p){try{var S=u.call(o.h.j,f);if(!(S instanceof Object))throw new TypeError("Iterator result "+S+" is not an object");if(!S.done)return o.h.m=!1,S;var C=S.value}catch(E){return o.h.j=null,A(o.h,E),O(o)}return o.h.j=null,p.call(o.h,C),O(o)}function O(o){for(;o.h.h;)try{var u=o.i(o.h);if(u)return o.h.m=!1,{value:u.value,done:!1}}catch(f){o.h.i=void 0,A(o.h,f)}if(o.h.m=!1,o.h.l){if(u=o.h.l,o.h.l=null,u.na)throw u.ma;return{value:u.return,done:!0}}return{value:void 0,done:!0}}function z(o){this.next=function(u){return y(o.h),o.h.j?u=R(o,o.h.j.next,u,o.h.u):(o.h.u(u),u=O(o)),u},this.throw=function(u){return y(o.h),o.h.j?u=R(o,o.h.j.throw,u,o.h.u):(A(o.h,u),u=O(o)),u},this.return=function(u){return H(o,u)},this[Symbol.iterator]=function(){return this}}function W(o){function u(p){return o.next(p)}function f(p){return o.throw(p)}return new Promise(function(p,S){function C(E){E.done?p(E.value):Promise.resolve(E.value).then(u,f).then(C,S)}C(o.next())})}function X(o){return W(new z(new b(o)))}i("Promise",function(o){function u(E){this.i=0,this.j=void 0,this.h=[],this.u=!1;var B=this.l();try{E(B.resolve,B.reject)}catch(K){B.reject(K)}}function f(){this.h=null}function p(E){return E instanceof u?E:new u(function(B){B(E)})}if(o)return o;f.prototype.i=function(E){if(this.h==null){this.h=[];var B=this;this.j(function(){B.m()})}this.h.push(E)};var S=s.setTimeout;f.prototype.j=function(E){S(E,0)},f.prototype.m=function(){for(;this.h&&this.h.length;){var E=this.h;this.h=[];for(var B=0;B<E.length;++B){var K=E[B];E[B]=null;try{K()}catch(oe){this.l(oe)}}}this.h=null},f.prototype.l=function(E){this.j(function(){throw E})},u.prototype.l=function(){function E(oe){return function(ye){K||(K=!0,oe.call(B,ye))}}var B=this,K=!1;return{resolve:E(this.I),reject:E(this.m)}},u.prototype.I=function(E){if(E===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(E instanceof u)this.L(E);else{e:switch(typeof E){case"object":var B=E!=null;break e;case"function":B=!0;break e;default:B=!1}B?this.F(E):this.s(E)}},u.prototype.F=function(E){var B=void 0;try{B=E.then}catch(K){this.m(K);return}typeof B=="function"?this.M(B,E):this.s(E)},u.prototype.m=function(E){this.v(2,E)},u.prototype.s=function(E){this.v(1,E)},u.prototype.v=function(E,B){if(this.i!=0)throw Error("Cannot settle("+E+", "+B+"): Promise already settled in state"+this.i);this.i=E,this.j=B,this.i===2&&this.K(),this.H()},u.prototype.K=function(){var E=this;S(function(){if(E.D()){var B=s.console;typeof B<"u"&&B.error(E.j)}},1)},u.prototype.D=function(){if(this.u)return!1;var E=s.CustomEvent,B=s.Event,K=s.dispatchEvent;return typeof K>"u"?!0:(typeof E=="function"?E=new E("unhandledrejection",{cancelable:!0}):typeof B=="function"?E=new B("unhandledrejection",{cancelable:!0}):(E=s.document.createEvent("CustomEvent"),E.initCustomEvent("unhandledrejection",!1,!0,E)),E.promise=this,E.reason=this.j,K(E))},u.prototype.H=function(){if(this.h!=null){for(var E=0;E<this.h.length;++E)C.i(this.h[E]);this.h=null}};var C=new f;return u.prototype.L=function(E){var B=this.l();E.T(B.resolve,B.reject)},u.prototype.M=function(E,B){var K=this.l();try{E.call(B,K.resolve,K.reject)}catch(oe){K.reject(oe)}},u.prototype.then=function(E,B){function K(Me,we){return typeof Me=="function"?function($e){try{oe(Me($e))}catch(Ye){ye(Ye)}}:we}var oe,ye,Oe=new u(function(Me,we){oe=Me,ye=we});return this.T(K(E,oe),K(B,ye)),Oe},u.prototype.catch=function(E){return this.then(void 0,E)},u.prototype.T=function(E,B){function K(){switch(oe.i){case 1:E(oe.j);break;case 2:B(oe.j);break;default:throw Error("Unexpected state: "+oe.i)}}var oe=this;this.h==null?C.i(K):this.h.push(K),this.u=!0},u.resolve=p,u.reject=function(E){return new u(function(B,K){K(E)})},u.race=function(E){return new u(function(B,K){for(var oe=c(E),ye=oe.next();!ye.done;ye=oe.next())p(ye.value).T(B,K)})},u.all=function(E){var B=c(E),K=B.next();return K.done?p([]):new u(function(oe,ye){function Oe($e){return function(Ye){Me[$e]=Ye,we--,we==0&&oe(Me)}}var Me=[],we=0;do Me.push(void 0),we++,p(K.value).T(Oe(Me.length-1),ye),K=B.next();while(!K.done)})},u});function q(o,u){o instanceof String&&(o+="");var f=0,p=!1,S={next:function(){if(!p&&f<o.length){var C=f++;return{value:u(C,o[C]),done:!1}}return p=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}i("Array.prototype.keys",function(o){return o||function(){return q(this,function(u){return u})}}),i("Array.prototype.fill",function(o){return o||function(u,f,p){var S=this.length||0;for(0>f&&(f=Math.max(0,S+f)),(p==null||p>S)&&(p=S),p=Number(p),0>p&&(p=Math.max(0,S+p)),f=Number(f||0);f<p;f++)this[f]=u;return this}});function J(o){return o||Array.prototype.fill}i("Int8Array.prototype.fill",J),i("Uint8Array.prototype.fill",J),i("Uint8ClampedArray.prototype.fill",J),i("Int16Array.prototype.fill",J),i("Uint16Array.prototype.fill",J),i("Int32Array.prototype.fill",J),i("Uint32Array.prototype.fill",J),i("Float32Array.prototype.fill",J),i("Float64Array.prototype.fill",J),i("Object.is",function(o){return o||function(u,f){return u===f?u!==0||1/u===1/f:u!==u&&f!==f}}),i("Array.prototype.includes",function(o){return o||function(u,f){var p=this;p instanceof String&&(p=String(p));var S=p.length;for(f=f||0,0>f&&(f=Math.max(f+S,0));f<S;f++){var C=p[f];if(C===u||Object.is(C,u))return!0}return!1}}),i("String.prototype.includes",function(o){return o||function(u,f){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(u instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(u,f||0)!==-1}});var re=this||self;function pe(o,u){o=o.split(".");var f=re;o[0]in f||typeof f.execScript>"u"||f.execScript("var "+o[0]);for(var p;o.length&&(p=o.shift());)o.length||u===void 0?f[p]&&f[p]!==Object.prototype[p]?f=f[p]:f=f[p]={}:f[p]=u}function me(o){var u;e:{if((u=re.navigator)&&(u=u.userAgent))break e;u=""}return u.indexOf(o)!=-1}var Se=Array.prototype.map?function(o,u){return Array.prototype.map.call(o,u,void 0)}:function(o,u){for(var f=o.length,p=Array(f),S=typeof o=="string"?o.split(""):o,C=0;C<f;C++)C in S&&(p[C]=u.call(void 0,S[C],C,o));return p},ie={},ne=null;function ee(o){var u=o.length,f=3*u/4;f%3?f=Math.floor(f):"=.".indexOf(o[u-1])!=-1&&(f="=.".indexOf(o[u-2])!=-1?f-2:f-1);var p=new Uint8Array(f),S=0;return he(o,function(C){p[S++]=C}),S!==f?p.subarray(0,S):p}function he(o,u){function f(K){for(;p<o.length;){var oe=o.charAt(p++),ye=ne[oe];if(ye!=null)return ye;if(!/^[\s\xa0]*$/.test(oe))throw Error("Unknown base64 encoding at char: "+oe)}return K}_e();for(var p=0;;){var S=f(-1),C=f(0),E=f(64),B=f(64);if(B===64&&S===-1)break;u(S<<2|C>>4),E!=64&&(u(C<<4&240|E>>2),B!=64&&u(E<<6&192|B))}}function _e(){if(!ne){ne={};for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),u=["+/=","+/","-_=","-_.","-_"],f=0;5>f;f++){var p=o.concat(u[f].split(""));ie[f]=p;for(var S=0;S<p.length;S++){var C=p[S];ne[C]===void 0&&(ne[C]=S)}}}}var We=typeof Uint8Array<"u",ze=!(me("Trident")||me("MSIE"))&&typeof re.btoa=="function";function Ne(o){if(!ze){var u;u===void 0&&(u=0),_e(),u=ie[u];for(var f=Array(Math.floor(o.length/3)),p=u[64]||"",S=0,C=0;S<o.length-2;S+=3){var E=o[S],B=o[S+1],K=o[S+2],oe=u[E>>2];E=u[(E&3)<<4|B>>4],B=u[(B&15)<<2|K>>6],K=u[K&63],f[C++]=oe+E+B+K}switch(oe=0,K=p,o.length-S){case 2:oe=o[S+1],K=u[(oe&15)<<2]||p;case 1:o=o[S],f[C]=u[o>>2]+u[(o&3)<<4|oe>>4]+K+p}return f.join("")}for(u="";10240<o.length;)u+=String.fromCharCode.apply(null,o.subarray(0,10240)),o=o.subarray(10240);return u+=String.fromCharCode.apply(null,o),btoa(u)}var De=RegExp("[-_.]","g");function se(o){switch(o){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function le(o){if(!ze)return ee(o);De.test(o)&&(o=o.replace(De,se)),o=atob(o);for(var u=new Uint8Array(o.length),f=0;f<o.length;f++)u[f]=o.charCodeAt(f);return u}var ve;function fe(){return ve||(ve=new Uint8Array(0))}var U={},G=typeof Uint8Array.prototype.slice=="function",Q=0,te=0;function $(o){var u=0>o;o=Math.abs(o);var f=o>>>0;o=Math.floor((o-f)/4294967296),u&&(f=c(P(f,o)),u=f.next().value,o=f.next().value,f=u),Q=f>>>0,te=o>>>0}var m=typeof BigInt=="function";function P(o,u){return u=~u,o?o=~o+1:u+=1,[o,u]}function N(o,u){this.i=o>>>0,this.h=u>>>0}function v(o){if(!o)return T||(T=new N(0,0));if(!/^-?\d+$/.test(o))return null;if(16>o.length)$(Number(o));else if(m)o=BigInt(o),Q=Number(o&BigInt(4294967295))>>>0,te=Number(o>>BigInt(32)&BigInt(4294967295));else{var u=+(o[0]==="-");te=Q=0;for(var f=o.length,p=u,S=(f-u)%6+u;S<=f;p=S,S+=6)p=Number(o.slice(p,S)),te*=1e6,Q=1e6*Q+p,4294967296<=Q&&(te+=Q/4294967296|0,Q%=4294967296);u&&(u=c(P(Q,te)),o=u.next().value,u=u.next().value,Q=o,te=u)}return new N(Q,te)}var T;function F(o,u){return Error("Invalid wire type: "+o+" (at position "+u+")")}function V(){return Error("Failed to read varint, encoding is invalid.")}function Z(o,u){return Error("Tried to read past the end of the data "+u+" > "+o)}function ce(){throw Error("Invalid UTF8")}function Ee(o,u){return u=String.fromCharCode.apply(null,u),o==null?u:o+u}var Be=void 0,Fe,nt=typeof TextDecoder<"u",qe,lt=typeof TextEncoder<"u",ct;function Ge(o){if(o!==U)throw Error("illegal external caller")}function Ue(o,u){if(Ge(u),this.V=o,o!=null&&o.length===0)throw Error("ByteString should be constructed with non-empty values")}function Ve(){return ct||(ct=new Ue(null,U))}function Ze(o){Ge(U);var u=o.V;return u=u==null||We&&u!=null&&u instanceof Uint8Array?u:typeof u=="string"?le(u):null,u==null?u:o.V=u}function Ct(o){if(typeof o=="string")return{buffer:le(o),C:!1};if(Array.isArray(o))return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Uint8Array)return{buffer:o,C:!1};if(o.constructor===ArrayBuffer)return{buffer:new Uint8Array(o),C:!1};if(o.constructor===Ue)return{buffer:Ze(o)||fe(),C:!0};if(o instanceof Uint8Array)return{buffer:new Uint8Array(o.buffer,o.byteOffset,o.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function On(o,u){this.i=null,this.m=!1,this.h=this.j=this.l=0,mt(this,o,u)}function mt(o,u,f){f=f===void 0?{}:f,o.S=f.S===void 0?!1:f.S,u&&(u=Ct(u),o.i=u.buffer,o.m=u.C,o.l=0,o.j=o.i.length,o.h=o.l)}On.prototype.reset=function(){this.h=this.l};function Dt(o,u){if(o.h=u,u>o.j)throw Z(o.j,u)}function Pt(o){var u=o.i,f=o.h,p=u[f++],S=p&127;if(p&128&&(p=u[f++],S|=(p&127)<<7,p&128&&(p=u[f++],S|=(p&127)<<14,p&128&&(p=u[f++],S|=(p&127)<<21,p&128&&(p=u[f++],S|=p<<28,p&128&&u[f++]&128&&u[f++]&128&&u[f++]&128&&u[f++]&128&&u[f++]&128)))))throw V();return Dt(o,f),S}function tn(o,u){if(0>u)throw Error("Tried to read a negative byte length: "+u);var f=o.h,p=f+u;if(p>o.j)throw Z(u,o.j-f);return o.h=p,f}var ln=[];function cn(){this.h=[]}cn.prototype.length=function(){return this.h.length},cn.prototype.end=function(){var o=this.h;return this.h=[],o};function En(o,u,f){for(;0<f||127<u;)o.h.push(u&127|128),u=(u>>>7|f<<25)>>>0,f>>>=7;o.h.push(u)}function Cn(o,u){for(;127<u;)o.h.push(u&127|128),u>>>=7;o.h.push(u)}function Jr(o,u){if(ln.length){var f=ln.pop();mt(f,o,u),o=f}else o=new On(o,u);this.h=o,this.j=this.h.h,this.i=this.l=-1,this.setOptions(u)}Jr.prototype.setOptions=function(o){o=o===void 0?{}:o,this.ca=o.ca===void 0?!1:o.ca},Jr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Fr(o){var u=o.h;if(u.h==u.j)return!1;o.j=o.h.h;var f=Pt(o.h)>>>0;if(u=f>>>3,f&=7,!(0<=f&&5>=f))throw F(f,o.j);if(1>u)throw Error("Invalid field number: "+u+" (at position "+o.j+")");return o.l=u,o.i=f,!0}function $n(o){switch(o.i){case 0:if(o.i!=0)$n(o);else e:{o=o.h;for(var u=o.h,f=u+10,p=o.i;u<f;)if(!(p[u++]&128)){Dt(o,u);break e}throw V()}break;case 1:o=o.h,Dt(o,o.h+8);break;case 2:o.i!=2?$n(o):(u=Pt(o.h)>>>0,o=o.h,Dt(o,o.h+u));break;case 5:o=o.h,Dt(o,o.h+4);break;case 3:u=o.l;do{if(!Fr(o))throw Error("Unmatched start-group tag: stream EOF");if(o.i==4){if(o.l!=u)throw Error("Unmatched end-group tag");break}$n(o)}while(!0);break;default:throw F(o.i,o.j)}}var Dn=[];function ys(){this.j=[],this.i=0,this.h=new cn}function zn(o,u){u.length!==0&&(o.j.push(u),o.i+=u.length)}function Si(o,u){if(u=u.R){zn(o,o.h.end());for(var f=0;f<u.length;f++)zn(o,Ze(u[f])||fe())}}var jn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function Ar(o,u){return jn?o[jn]|=u:o.A!==void 0?o.A|=u:(Object.defineProperties(o,{A:{value:u,configurable:!0,writable:!0,enumerable:!1}}),u)}function Js(o,u){jn?o[jn]&&(o[jn]&=~u):o.A!==void 0&&(o.A&=~u)}function wt(o){var u;return jn?u=o[jn]:u=o.A,u??0}function Un(o,u){jn?o[jn]=u:o.A!==void 0?o.A=u:Object.defineProperties(o,{A:{value:u,configurable:!0,writable:!0,enumerable:!1}})}function Lo(o){return Ar(o,1),o}function vu(o,u){Un(u,(o|0)&-51)}function ki(o,u){Un(u,(o|18)&-41)}var Ai={};function qs(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)&&o.constructor===Object}var Zs,Fo=[];Un(Fo,23),Zs=Object.freeze(Fo);function Ei(o){if(wt(o.o)&2)throw Error("Cannot mutate an immutable Message")}function Ci(o){var u=o.length;(u=u?o[u-1]:void 0)&&qs(u)?u.g=1:(u={},o.push((u.g=1,u)))}function Oo(o){var u=o.i+o.G;return o.B||(o.B=o.o[u]={})}function _n(o,u){return u===-1?null:u>=o.i?o.B?o.B[u]:void 0:o.o[u+o.G]}function Hn(o,u,f,p){Ei(o),vs(o,u,f,p)}function vs(o,u,f,p){o.j&&(o.j=void 0),u>=o.i||p?Oo(o)[u]=f:(o.o[u+o.G]=f,(o=o.B)&&u in o&&delete o[u])}function ji(o,u,f,p){var S=_n(o,u);Array.isArray(S)||(S=Zs);var C=wt(S);if(C&1||Lo(S),p)C&2||Ar(S,2),f&1||Object.freeze(S);else{p=!(f&2);var E=C&2;f&1||!E?p&&C&16&&!E&&Js(S,16):(S=Lo(Array.prototype.slice.call(S)),vs(o,u,S))}return S}function _i(o,u){var f=_n(o,u),p=f==null?f:typeof f=="number"||f==="NaN"||f==="Infinity"||f==="-Infinity"?Number(f):void 0;return p!=null&&p!==f&&vs(o,u,p),p}function $o(o,u,f,p,S){o.h||(o.h={});var C=o.h[f],E=ji(o,f,3,S);if(!C){var B=E;C=[];var K=!!(wt(o.o)&16);E=!!(wt(B)&2);var oe=B;!S&&E&&(B=Array.prototype.slice.call(B));for(var ye=E,Oe=0;Oe<B.length;Oe++){var Me=B[Oe],we=u,$e=!1;if($e=$e===void 0?!1:$e,Me=Array.isArray(Me)?new we(Me):$e?new we:void 0,Me!==void 0){we=Me.o;var Ye=$e=wt(we);E&&(Ye|=2),K&&(Ye|=16),Ye!=$e&&Un(we,Ye),we=Ye,ye=ye||!!(2&we),C.push(Me)}}return o.h[f]=C,K=wt(B),u=K|33,u=ye?u&-9:u|8,K!=u&&(ye=B,Object.isFrozen(ye)&&(ye=Array.prototype.slice.call(ye)),Un(ye,u),B=ye),oe!==B&&vs(o,f,B),(S||p&&E)&&Ar(C,2),p&&Object.freeze(C),C}return S||(S=Object.isFrozen(C),p&&!S?Object.freeze(C):!p&&S&&(C=Array.prototype.slice.call(C),o.h[f]=C)),C}function L(o,u,f){var p=!!(wt(o.o)&2);if(u=$o(o,u,f,p,p),o=ji(o,f,3,p),!(p||wt(o)&8)){for(p=0;p<u.length;p++){if(f=u[p],wt(f.o)&2){var S=qa(f,!1);S.j=f}else S=f;f!==S&&(u[p]=S,o[p]=S.o)}Ar(o,8)}return u}function ue(o,u,f){if(f!=null&&typeof f!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof f+": "+f);Hn(o,u,f)}function ge(o,u,f,p,S){Ei(o);var C=$o(o,f,u,!1,!1);return f=p??new f,o=ji(o,u,2,!1),S!=null?(C.splice(S,0,f),o.splice(S,0,f.o)):(C.push(f),o.push(f.o)),f.C()&&Js(o,8),f}function ae(o,u){return o??u}function xe(o,u,f){return f=f===void 0?0:f,ae(_i(o,u),f)}var Le;function Ce(o){switch(typeof o){case"number":return isFinite(o)?o:String(o);case"object":if(o)if(Array.isArray(o)){if(wt(o)&128)return o=Array.prototype.slice.call(o),Ci(o),o}else{if(We&&o!=null&&o instanceof Uint8Array)return Ne(o);if(o instanceof Ue){var u=o.V;return u==null?"":typeof u=="string"?u:o.V=Ne(u)}}}return o}function He(o,u,f,p){if(o!=null){if(Array.isArray(o))o=Re(o,u,f,p!==void 0);else if(qs(o)){var S={},C;for(C in o)S[C]=He(o[C],u,f,p);o=S}else o=u(o,p);return o}}function Re(o,u,f,p){var S=wt(o);p=p?!!(S&16):void 0,o=Array.prototype.slice.call(o);for(var C=0;C<o.length;C++)o[C]=He(o[C],u,f,p);return f(S,o),o}function Ke(o){return o.ja===Ai?o.toJSON():Ce(o)}function Xt(o,u){o&128&&Ci(u)}function ir(o,u,f){if(f=f===void 0?ki:f,o!=null){if(We&&o instanceof Uint8Array)return o.length?new Ue(new Uint8Array(o),U):Ve();if(Array.isArray(o)){var p=wt(o);return p&2?o:u&&!(p&32)&&(p&16||p===0)?(Un(o,p|2),o):(o=Re(o,ir,p&4?ki:f,!0),u=wt(o),u&4&&u&2&&Object.freeze(o),o)}return o.ja===Ai?Ja(o):o}}function Nn(o,u,f,p,S,C,E){if(o=o.h&&o.h[f]){if(p=wt(o),p&2?p=o:(C=Se(o,Ja),ki(p,C),Object.freeze(C),p=C),Ei(u),E=p==null?Zs:Lo([]),p!=null){for(C=!!p.length,o=0;o<p.length;o++){var B=p[o];C=C&&!(wt(B.o)&2),E[o]=B.o}C=(C?8:0)|1,o=wt(E),(o&C)!==C&&(Object.isFrozen(E)&&(E=Array.prototype.slice.call(E)),Un(E,o|C)),u.h||(u.h={}),u.h[f]=p}else u.h&&(u.h[f]=void 0);vs(u,f,E,S)}else Hn(u,f,ir(p,C,E),S)}function Ja(o){return wt(o.o)&2||(o=qa(o,!0),Ar(o.o,2)),o}function qa(o,u){var f=o.o,p=[];Ar(p,16);var S=o.constructor.h;if(S&&p.push(S),S=o.B,S){p.length=f.length,p.fill(void 0,p.length,f.length);var C={};p[p.length-1]=C}wt(f)&128&&Ci(p),u=u||o.C()?ki:vu,C=o.constructor,Le=p,p=new C(p),Le=void 0,o.R&&(p.R=o.R.slice()),C=!!(wt(f)&16);for(var E=S?f.length-1:f.length,B=0;B<E;B++)Nn(o,p,B-o.G,f[B],!1,C,u);if(S)for(var K in S)Nn(o,p,+K,S[K],!0,C,u);return p}function Kt(o,u,f){o==null&&(o=Le),Le=void 0;var p=this.constructor.i||0,S=0<p,C=this.constructor.h,E=!1;if(o==null){o=C?[C]:[];var B=48,K=!0;S&&(p=0,B|=128),Un(o,B)}else{if(!Array.isArray(o)||C&&C!==o[0])throw Error();var oe=B=Ar(o,0);if((K=(16&oe)!==0)&&((E=(32&oe)!==0)||(oe|=32)),S){if(128&oe)p=0;else if(0<o.length){var ye=o[o.length-1];if(qs(ye)&&"g"in ye){p=0,oe|=128,delete ye.g;var Oe=!0,Me;for(Me in ye){Oe=!1;break}Oe&&o.pop()}}}else if(128&oe)throw Error();B!==oe&&Un(o,oe)}this.G=(C?0:-1)-p,this.h=void 0,this.o=o;e:{if(C=this.o.length,p=C-1,C&&(C=this.o[p],qs(C))){this.B=C,this.i=p-this.G;break e}u!==void 0&&-1<u?(this.i=Math.max(u,p+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!S&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(f){u=K&&!E&&!0,S=this.i;var we;for(K=0;K<f.length;K++)E=f[K],E<S?(E+=this.G,(p=o[E])?Za(p,u):o[E]=Zs):(we||(we=Oo(this)),(p=we[E])?Za(p,u):we[E]=Zs)}}Kt.prototype.toJSON=function(){return Re(this.o,Ke,Xt)},Kt.prototype.C=function(){return!!(wt(this.o)&2)};function Za(o,u){if(Array.isArray(o)){var f=wt(o),p=1;!u||f&2||(p|=16),(f&p)!==p&&Un(o,f|p)}}Kt.prototype.ja=Ai,Kt.prototype.toString=function(){return this.o.toString()};function Ni(o,u,f){if(f){var p={},S;for(S in f){var C=f[S],E=C.qa;E||(p.J=C.wa||C.oa.W,C.ia?(p.aa=$p(C.ia),E=function(B){return function(K,oe,ye){return B.J(K,oe,ye,B.aa)}}(p)):C.ka?(p.Z=Dp(C.da.P,C.ka),E=function(B){return function(K,oe,ye){return B.J(K,oe,ye,B.Z)}}(p)):E=p.J,C.qa=E),E(u,o,C.da),p={J:p.J,aa:p.aa,Z:p.Z}}}Si(u,o)}var el=Symbol();function Rp(o,u,f){return o[el]||(o[el]=function(p,S){return u(p,S,f)})}function Lp(o){var u=o[el];if(!u){var f=wu(o);u=function(p,S){return zp(p,S,f)},o[el]=u}return u}function qv(o){var u=o.ia;if(u)return Lp(u);if(u=o.va)return Rp(o.da.P,u,o.ka)}function Zv(o){var u=qv(o),f=o.da,p=o.oa.U;return u?function(S,C){return p(S,C,f,u)}:function(S,C){return p(S,C,f)}}function Fp(o,u){var f=o[u];return typeof f=="function"&&f.length===0&&(f=f(),o[u]=f),Array.isArray(f)&&(zo in f||Do in f||0<f.length&&typeof f[0]=="function")?f:void 0}function Op(o,u,f,p,S,C){u.P=o[0];var E=1;if(o.length>E&&typeof o[E]!="number"){var B=o[E++];f(u,B)}for(;E<o.length;){f=o[E++];for(var K=E+1;K<o.length&&typeof o[K]!="number";)K++;switch(B=o[E++],K-=E,K){case 0:p(u,f,B);break;case 1:(K=Fp(o,E))?(E++,S(u,f,B,K)):p(u,f,B,o[E++]);break;case 2:K=E++,K=Fp(o,K),S(u,f,B,K,o[E++]);break;case 3:C(u,f,B,o[E++],o[E++],o[E++]);break;case 4:C(u,f,B,o[E++],o[E++],o[E++],o[E++]);break;default:throw Error("unexpected number of binary field arguments: "+K)}}return u}var tl=Symbol();function $p(o){var u=o[tl];if(!u){var f=xu(o);u=function(p,S){return Up(p,S,f)},o[tl]=u}return u}function Dp(o,u){var f=o[tl];return f||(f=function(p,S){return Ni(p,S,u)},o[tl]=f),f}var Do=Symbol();function e3(o,u){o.push(u)}function t3(o,u,f){o.push(u,f.W)}function n3(o,u,f,p){var S=$p(p),C=xu(p).P,E=f.W;o.push(u,function(B,K,oe){return E(B,K,oe,C,S)})}function r3(o,u,f,p,S,C){var E=Dp(p,C),B=f.W;o.push(u,function(K,oe,ye){return B(K,oe,ye,p,E)})}function xu(o){var u=o[Do];return u||(u=Op(o,o[Do]=[],e3,t3,n3,r3),zo in o&&Do in o&&(o.length=0),u)}var zo=Symbol();function s3(o,u){o[0]=u}function i3(o,u,f,p){var S=f.U;o[u]=p?function(C,E,B){return S(C,E,B,p)}:S}function o3(o,u,f,p,S){var C=f.U,E=Lp(p),B=wu(p).P;o[u]=function(K,oe,ye){return C(K,oe,ye,B,E,S)}}function a3(o,u,f,p,S,C,E){var B=f.U,K=Rp(p,S,C);o[u]=function(oe,ye,Oe){return B(oe,ye,Oe,p,K,E)}}function wu(o){var u=o[zo];return u||(u=Op(o,o[zo]={},s3,i3,o3,a3),zo in o&&Do in o&&(o.length=0),u)}function zp(o,u,f){for(;Fr(u)&&u.i!=4;){var p=u.l,S=f[p];if(!S){var C=f[0];C&&(C=C[p])&&(S=f[p]=Zv(C))}if(!S||!S(u,o,p)){S=u,p=o,C=S.j,$n(S);var E=S;if(!E.ca){if(S=E.h.h-C,E.h.h=C,E=E.h,S==0)S=Ve();else{if(C=tn(E,S),E.S&&E.m)S=E.i.subarray(C,C+S);else{E=E.i;var B=C;S=C+S,S=B===S?fe():G?E.slice(B,S):new Uint8Array(E.subarray(B,S))}S=S.length==0?Ve():new Ue(S,U)}(C=p.R)?C.push(S):p.R=[S]}}}return o}function Up(o,u,f){for(var p=f.length,S=p%2==1,C=S?1:0;C<p;C+=2)(0,f[C+1])(u,o,f[C]);Ni(o,u,S?f[0]:void 0)}function Uo(o,u){return{U:o,W:u}}var Er=Uo(function(o,u,f){if(o.i!==5)return!1;o=o.h;var p=o.i,S=o.h,C=p[S],E=p[S+1],B=p[S+2];return p=p[S+3],Dt(o,o.h+4),E=(C<<0|E<<8|B<<16|p<<24)>>>0,o=2*(E>>31)+1,C=E>>>23&255,E&=8388607,Hn(u,f,C==255?E?NaN:1/0*o:C==0?o*Math.pow(2,-149)*E:o*Math.pow(2,C-150)*(E+Math.pow(2,23))),!0},function(o,u,f){if(u=_i(u,f),u!=null){Cn(o.h,8*f+5),o=o.h;var p=+u;p===0?0<1/p?Q=te=0:(te=0,Q=2147483648):isNaN(p)?(te=0,Q=2147483647):(p=(f=0>p?-2147483648:0)?-p:p,34028234663852886e22<p?(te=0,Q=(f|2139095040)>>>0):11754943508222875e-54>p?(p=Math.round(p/Math.pow(2,-149)),te=0,Q=(f|p)>>>0):(u=Math.floor(Math.log(p)/Math.LN2),p*=Math.pow(2,-u),p=Math.round(8388608*p),16777216<=p&&++u,te=0,Q=(f|u+127<<23|p&8388607)>>>0)),f=Q,o.h.push(f>>>0&255),o.h.push(f>>>8&255),o.h.push(f>>>16&255),o.h.push(f>>>24&255)}}),l3=Uo(function(o,u,f){if(o.i!==0)return!1;var p=o.h,S=0,C=o=0,E=p.i,B=p.h;do{var K=E[B++];S|=(K&127)<<C,C+=7}while(32>C&&K&128);for(32<C&&(o|=(K&127)>>4),C=3;32>C&&K&128;C+=7)K=E[B++],o|=(K&127)<<C;if(Dt(p,B),128>K)p=S>>>0,K=o>>>0,(o=K&2147483648)&&(p=~p+1>>>0,K=~K>>>0,p==0&&(K=K+1>>>0)),p=4294967296*K+(p>>>0);else throw V();return Hn(u,f,o?-p:p),!0},function(o,u,f){u=_n(u,f),u!=null&&(typeof u=="string"&&v(u),u!=null&&(Cn(o.h,8*f),typeof u=="number"?(o=o.h,$(u),En(o,Q,te)):(f=v(u),En(o.h,f.i,f.h))))}),c3=Uo(function(o,u,f){return o.i!==0?!1:(Hn(u,f,Pt(o.h)),!0)},function(o,u,f){if(u=_n(u,f),u!=null&&u!=null)if(Cn(o.h,8*f),o=o.h,f=u,0<=f)Cn(o,f);else{for(u=0;9>u;u++)o.h.push(f&127|128),f>>=7;o.h.push(1)}}),Hp=Uo(function(o,u,f){if(o.i!==2)return!1;var p=Pt(o.h)>>>0;o=o.h;var S=tn(o,p);if(o=o.i,nt){var C=o,E;(E=Fe)||(E=Fe=new TextDecoder("utf-8",{fatal:!0})),o=S+p,C=S===0&&o===C.length?C:C.subarray(S,o);try{var B=E.decode(C)}catch(Oe){if(Be===void 0){try{E.decode(new Uint8Array([128]))}catch{}try{E.decode(new Uint8Array([97])),Be=!0}catch{Be=!1}}throw!Be&&(Fe=void 0),Oe}}else{B=S,p=B+p,S=[];for(var K=null,oe,ye;B<p;)oe=o[B++],128>oe?S.push(oe):224>oe?B>=p?ce():(ye=o[B++],194>oe||(ye&192)!==128?(B--,ce()):S.push((oe&31)<<6|ye&63)):240>oe?B>=p-1?ce():(ye=o[B++],(ye&192)!==128||oe===224&&160>ye||oe===237&&160<=ye||((C=o[B++])&192)!==128?(B--,ce()):S.push((oe&15)<<12|(ye&63)<<6|C&63)):244>=oe?B>=p-2?ce():(ye=o[B++],(ye&192)!==128||(oe<<28)+(ye-144)>>30||((C=o[B++])&192)!==128||((E=o[B++])&192)!==128?(B--,ce()):(oe=(oe&7)<<18|(ye&63)<<12|(C&63)<<6|E&63,oe-=65536,S.push((oe>>10&1023)+55296,(oe&1023)+56320))):ce(),8192<=S.length&&(K=Ee(K,S),S.length=0);B=Ee(K,S)}return Hn(u,f,B),!0},function(o,u,f){if(u=_n(u,f),u!=null){var p=!1;if(p=p===void 0?!1:p,lt){if(p&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(u))throw Error("Found an unpaired surrogate");u=(qe||(qe=new TextEncoder)).encode(u)}else{for(var S=0,C=new Uint8Array(3*u.length),E=0;E<u.length;E++){var B=u.charCodeAt(E);if(128>B)C[S++]=B;else{if(2048>B)C[S++]=B>>6|192;else{if(55296<=B&&57343>=B){if(56319>=B&&E<u.length){var K=u.charCodeAt(++E);if(56320<=K&&57343>=K){B=1024*(B-55296)+K-56320+65536,C[S++]=B>>18|240,C[S++]=B>>12&63|128,C[S++]=B>>6&63|128,C[S++]=B&63|128;continue}else E--}if(p)throw Error("Found an unpaired surrogate");B=65533}C[S++]=B>>12|224,C[S++]=B>>6&63|128}C[S++]=B&63|128}}u=S===C.length?C:C.subarray(0,S)}Cn(o.h,8*f+2),Cn(o.h,u.length),zn(o,o.h.end()),zn(o,u)}}),Wp=Uo(function(o,u,f,p,S){if(o.i!==2)return!1;u=ge(u,f,p),f=o.h.j,p=Pt(o.h)>>>0;var C=o.h.h+p,E=C-f;if(0>=E&&(o.h.j=C,S(u,o,void 0,void 0,void 0),E=C-o.h.h),E)throw Error("Message parsing ended unexpectedly. Expected to read "+(p+" bytes, instead read "+(p-E)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return o.h.h=C,o.h.j=f,!0},function(o,u,f,p,S){if(u=L(u,p,f),u!=null)for(p=0;p<u.length;p++){var C=o;Cn(C.h,8*f+2);var E=C.h.end();zn(C,E),E.push(C.i),C=E,S(u[p],o),E=o;var B=C.pop();for(B=E.i+E.h.length()-B;127<B;)C.push(B&127|128),B>>>=7,E.i++;C.push(B),E.i++}});function Su(o){return function(u,f){e:{if(Dn.length){var p=Dn.pop();p.setOptions(f),mt(p.h,u,f),u=p}else u=new Jr(u,f);try{var S=wu(o),C=zp(new S.P,u,S);break e}finally{S=u.h,S.i=null,S.m=!1,S.l=0,S.j=0,S.h=0,S.S=!1,u.l=-1,u.i=-1,100>Dn.length&&Dn.push(u)}C=void 0}return C}}function ku(o){return function(){var u=new ys;Up(this,u,xu(o)),zn(u,u.h.end());for(var f=new Uint8Array(u.i),p=u.j,S=p.length,C=0,E=0;E<S;E++){var B=p[E];f.set(B,C),C+=B.length}return u.j=[f],f}}function bi(o){Kt.call(this,o)}Y(bi,Kt);var Gp=[bi,1,c3,2,Er,3,Hp,4,Hp];bi.prototype.l=ku(Gp);function Au(o){Kt.call(this,o,-1,u3)}Y(Au,Kt),Au.prototype.addClassification=function(o,u){return ge(this,1,bi,o,u),this};var u3=[1],Vp=Su([Au,1,Wp,Gp]);function Mi(o){Kt.call(this,o)}Y(Mi,Kt);var Yp=[Mi,1,Er,2,Er,3,Er,4,Er,5,Er];Mi.prototype.l=ku(Yp);function Xp(o){Kt.call(this,o,-1,d3)}Y(Xp,Kt);var d3=[1],Kp=Su([Xp,1,Wp,Yp]);function nl(o){Kt.call(this,o)}Y(nl,Kt);var Qp=[nl,1,Er,2,Er,3,Er,4,Er,5,Er,6,l3],f3=Su(Qp);nl.prototype.l=ku(Qp);function Jp(o,u,f){if(f=o.createShader(f===0?o.VERTEX_SHADER:o.FRAGMENT_SHADER),o.shaderSource(f,u),o.compileShader(f),!o.getShaderParameter(f,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+o.getShaderInfoLog(f));return f}function qp(o){return L(o,bi,1).map(function(u){var f=_n(u,1);return{index:f??0,score:xe(u,2),label:_n(u,3)!=null?ae(_n(u,3),""):void 0,displayName:_n(u,4)!=null?ae(_n(u,4),""):void 0}})}function Zp(o){return{x:xe(o,1),y:xe(o,2),z:xe(o,3),visibility:_i(o,4)!=null?xe(o,4):void 0}}function em(o){return o.map(function(u){return L(Kp(u),Mi,1).map(Zp)})}function Eu(o,u){this.i=o,this.h=u,this.m=0}function tm(o,u,f){return h3(o,u),typeof o.h.canvas.transferToImageBitmap=="function"?Promise.resolve(o.h.canvas.transferToImageBitmap()):f?Promise.resolve(o.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(o.h.canvas):(o.j===void 0&&(o.j=document.createElement("canvas")),new Promise(function(p){o.j.height=o.h.canvas.height,o.j.width=o.h.canvas.width,o.j.getContext("2d",{}).drawImage(o.h.canvas,0,0,o.h.canvas.width,o.h.canvas.height),p(o.j)}))}function h3(o,u){var f=o.h;if(o.s===void 0){var p=Jp(f,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),S=Jp(f,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),C=f.createProgram();if(f.attachShader(C,p),f.attachShader(C,S),f.linkProgram(C),!f.getProgramParameter(C,f.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+f.getProgramInfoLog(C));p=o.s=C,f.useProgram(p),S=f.getUniformLocation(p,"sampler0"),o.l={O:f.getAttribLocation(p,"aVertex"),N:f.getAttribLocation(p,"aTex"),xa:S},o.v=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.enableVertexAttribArray(o.l.O),f.vertexAttribPointer(o.l.O,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),o.u=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.enableVertexAttribArray(o.l.N),f.vertexAttribPointer(o.l.N,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),f.uniform1i(S,0)}p=o.l,f.useProgram(o.s),f.canvas.width=u.width,f.canvas.height=u.height,f.viewport(0,0,u.width,u.height),f.activeTexture(f.TEXTURE0),o.i.bindTexture2d(u.glName),f.enableVertexAttribArray(p.O),f.bindBuffer(f.ARRAY_BUFFER,o.v),f.vertexAttribPointer(p.O,2,f.FLOAT,!1,0,0),f.enableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,o.u),f.vertexAttribPointer(p.N,2,f.FLOAT,!1,0,0),f.bindFramebuffer(f.DRAW_FRAMEBUFFER?f.DRAW_FRAMEBUFFER:f.FRAMEBUFFER,null),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT),f.colorMask(!0,!0,!0,!0),f.drawArrays(f.TRIANGLE_FAN,0,4),f.disableVertexAttribArray(p.O),f.disableVertexAttribArray(p.N),f.bindBuffer(f.ARRAY_BUFFER,null),o.i.bindTexture2d(0)}function p3(o){this.h=o}var m3=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function g3(o,u){return u+o}function nm(o,u){window[o]=u}function y3(o){var u=document.createElement("script");return u.setAttribute("src",o),u.setAttribute("crossorigin","anonymous"),new Promise(function(f){u.addEventListener("load",function(){f()},!1),u.addEventListener("error",function(){f()},!1),document.body.appendChild(u)})}function v3(){return X(function(o){switch(o.h){case 1:return o.s=2,M(o,WebAssembly.instantiate(m3),4);case 4:o.h=3,o.s=0;break;case 2:return o.s=0,o.l=null,o.return(!1);case 3:return o.return(!0)}})}function Cu(o){if(this.h=o,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=o&&o.locateFile||g3,typeof window=="object")var u=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")u=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=u,o.options){u=c(Object.keys(o.options));for(var f=u.next();!f.done;f=u.next()){f=f.value;var p=o.options[f].default;p!==void 0&&(this.l[f]=typeof p=="function"?p():p)}}}e=Cu.prototype,e.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function x3(o){var u,f,p,S,C,E,B,K,oe,ye,Oe;return X(function(Me){switch(Me.h){case 1:return o.ga?(u=o.h.files===void 0?[]:typeof o.h.files=="function"?o.h.files(o.l):o.h.files,M(Me,v3(),2)):Me.return();case 2:if(f=Me.i,typeof window=="object")return nm("createMediapipeSolutionsWasm",{locateFile:o.locateFile}),nm("createMediapipeSolutionsPackedAssets",{locateFile:o.locateFile}),E=u.filter(function(we){return we.data!==void 0}),B=u.filter(function(we){return we.data===void 0}),K=Promise.all(E.map(function(we){var $e=rl(o,we.url);if(we.path!==void 0){var Ye=we.path;$e=$e.then(function(gt){return o.overrideFile(Ye,gt),Promise.resolve(gt)})}return $e})),oe=Promise.all(B.map(function(we){return we.simd===void 0||we.simd&&f||!we.simd&&!f?y3(o.locateFile(we.url,o.ha)):Promise.resolve()})).then(function(){var we,$e,Ye;return X(function(gt){if(gt.h==1)return we=window.createMediapipeSolutionsWasm,$e=window.createMediapipeSolutionsPackedAssets,Ye=o,M(gt,we($e),2);Ye.i=gt.i,gt.h=0})}),ye=function(){return X(function(we){return o.h.graph&&o.h.graph.url?we=M(we,rl(o,o.h.graph.url),0):(we.h=0,we=void 0),we})}(),M(Me,Promise.all([oe,K,ye]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return p=u.filter(function(we){return we.simd===void 0||we.simd&&f||!we.simd&&!f}).map(function(we){return o.locateFile(we.url,o.ha)}),importScripts.apply(null,d(p)),S=o,M(Me,createMediapipeSolutionsWasm(Module),6);case 6:S.i=Me.i,o.m=new OffscreenCanvas(1,1),o.i.canvas=o.m,C=o.i.GL.createContext(o.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),o.i.GL.makeContextCurrent(C),Me.h=4;break;case 7:if(o.m=document.createElement("canvas"),Oe=o.m.getContext("webgl2",{}),!Oe&&(Oe=o.m.getContext("webgl",{}),!Oe))return alert("Failed to create WebGL canvas context when passing video frame."),Me.return();o.K=Oe,o.i.canvas=o.m,o.i.createContext(o.m,!0,!0,{});case 4:o.j=new o.i.SolutionWasm,o.ga=!1,Me.h=0}})}function w3(o){var u,f,p,S,C,E,B,K;return X(function(oe){if(oe.h==1){if(o.h.graph&&o.h.graph.url&&o.fa===o.h.graph.url)return oe.return();if(o.u=!0,!o.h.graph||!o.h.graph.url){oe.h=2;return}return o.fa=o.h.graph.url,M(oe,rl(o,o.h.graph.url),3)}for(oe.h!=2&&(u=oe.i,o.j.loadGraph(u)),f=c(Object.keys(o.D)),p=f.next();!p.done;p=f.next())S=p.value,o.j.overrideFile(S,o.D[S]);if(o.D={},o.h.listeners)for(C=c(o.h.listeners),E=C.next();!E.done;E=C.next())B=E.value,E3(o,B);K=o.l,o.l={},o.setOptions(K),oe.h=0})}e.reset=function(){var o=this;return X(function(u){o.j&&(o.j.reset(),o.s={},o.v={}),u.h=0})},e.setOptions=function(o,u){var f=this;if(u=u||this.h.options){for(var p=[],S=[],C={},E=c(Object.keys(o)),B=E.next();!B.done;C={X:C.X,Y:C.Y},B=E.next())if(B=B.value,!(B in this.l&&this.l[B]===o[B])){this.l[B]=o[B];var K=u[B];K!==void 0&&(K.onChange&&(C.X=K.onChange,C.Y=o[B],p.push(function(oe){return function(){var ye;return X(function(Oe){if(Oe.h==1)return M(Oe,oe.X(oe.Y),2);ye=Oe.i,ye===!0&&(f.u=!0),Oe.h=0})}}(C))),K.graphOptionXref&&(B=Object.assign({},{calculatorName:"",calculatorIndex:0},K.graphOptionXref,{valueNumber:K.type===1?o[B]:0,valueBoolean:K.type===0?o[B]:!1,valueString:K.type===2?o[B]:""}),S.push(B)))}(p.length!==0||S.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(S),this.F=(this.F===void 0?[]:this.F).concat(p))}};function S3(o){var u,f,p,S,C,E,B;return X(function(K){switch(K.h){case 1:if(!o.u)return K.return();if(!o.F){K.h=2;break}u=c(o.F),f=u.next();case 3:if(f.done){K.h=5;break}return p=f.value,M(K,p(),4);case 4:f=u.next(),K.h=3;break;case 5:o.F=void 0;case 2:if(o.H){for(S=new o.i.GraphOptionChangeRequestList,C=c(o.H),E=C.next();!E.done;E=C.next())B=E.value,S.push_back(B);o.j.changeOptions(S),S.delete(),o.H=void 0}o.u=!1,K.h=0}})}e.initialize=function(){var o=this;return X(function(u){return u.h==1?M(u,x3(o),2):u.h!=3?M(u,w3(o),3):M(u,S3(o),0)})};function rl(o,u){var f,p;return X(function(S){return u in o.L?S.return(o.L[u]):(f=o.locateFile(u,""),p=fetch(f).then(function(C){return C.arrayBuffer()}),o.L[u]=p,S.return(p))})}e.overrideFile=function(o,u){this.j?this.j.overrideFile(o,u):this.D[o]=u},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(o,u){var f=this,p,S,C,E,B,K,oe,ye,Oe;return X(function(Me){switch(Me.h){case 1:return f.h.inputs?(p=1e3*(u??performance.now()),M(Me,f.I,2)):Me.return();case 2:return M(Me,f.initialize(),3);case 3:for(S=new f.i.PacketDataList,C=c(Object.keys(o)),E=C.next();!E.done;E=C.next())if(B=E.value,K=f.h.inputs[B]){e:{var we=o[B];switch(K.type){case"video":var $e=f.s[K.stream];if($e||($e=new Eu(f.i,f.K),f.s[K.stream]=$e),$e.m===0&&($e.m=$e.i.createTexture()),typeof HTMLVideoElement<"u"&&we instanceof HTMLVideoElement)var Ye=we.videoWidth,gt=we.videoHeight;else typeof HTMLImageElement<"u"&&we instanceof HTMLImageElement?(Ye=we.naturalWidth,gt=we.naturalHeight):(Ye=we.width,gt=we.height);gt={glName:$e.m,width:Ye,height:gt},Ye=$e.h,Ye.canvas.width=gt.width,Ye.canvas.height=gt.height,Ye.activeTexture(Ye.TEXTURE0),$e.i.bindTexture2d($e.m),Ye.texImage2D(Ye.TEXTURE_2D,0,Ye.RGBA,Ye.RGBA,Ye.UNSIGNED_BYTE,we),$e.i.bindTexture2d(0),$e=gt;break e;case"detections":for($e=f.s[K.stream],$e||($e=new p3(f.i),f.s[K.stream]=$e),$e.data||($e.data=new $e.h.DetectionListData),$e.data.reset(we.length),gt=0;gt<we.length;++gt){Ye=we[gt];var dt=$e.data,nn=dt.setBoundingBox,or=gt,bn=Ye.la,rt=new nl;if(ue(rt,1,bn.ra),ue(rt,2,bn.sa),ue(rt,3,bn.height),ue(rt,4,bn.width),ue(rt,5,bn.rotation),Hn(rt,6,bn.pa),bn=rt.l(),nn.call(dt,or,bn),Ye.ea)for(dt=0;dt<Ye.ea.length;++dt){rt=Ye.ea[dt],nn=$e.data,or=nn.addNormalizedLandmark,bn=gt,rt=Object.assign({},rt,{visibility:rt.visibility?rt.visibility:0});var rn=new Mi;ue(rn,1,rt.x),ue(rn,2,rt.y),ue(rn,3,rt.z),rt.visibility&&ue(rn,4,rt.visibility),rt=rn.l(),or.call(nn,bn,rt)}if(Ye.ba)for(dt=0;dt<Ye.ba.length;++dt)nn=$e.data,or=nn.addClassification,bn=gt,rt=Ye.ba[dt],rn=new bi,ue(rn,2,rt.score),rt.index&&Hn(rn,1,rt.index),rt.label&&Hn(rn,3,rt.label),rt.displayName&&Hn(rn,4,rt.displayName),rt=rn.l(),or.call(nn,bn,rt)}$e=$e.data;break e;default:$e={}}}switch(oe=$e,ye=K.stream,K.type){case"video":S.pushTexture2d(Object.assign({},oe,{stream:ye,timestamp:p}));break;case"detections":Oe=oe,Oe.stream=ye,Oe.timestamp=p,S.pushDetectionList(Oe);break;default:throw Error("Unknown input config type: '"+K.type+"'")}}return f.j.send(S),M(Me,f.I,4);case 4:S.delete(),Me.h=0}})};function k3(o,u,f){var p,S,C,E,B,K,oe,ye,Oe,Me,we,$e,Ye,gt;return X(function(dt){switch(dt.h){case 1:if(!f)return dt.return(u);for(p={},S=0,C=c(Object.keys(f)),E=C.next();!E.done;E=C.next())B=E.value,K=f[B],typeof K!="string"&&K.type==="texture"&&u[K.stream]!==void 0&&++S;1<S&&(o.M=!1),oe=c(Object.keys(f)),E=oe.next();case 2:if(E.done){dt.h=4;break}if(ye=E.value,Oe=f[ye],typeof Oe=="string")return Ye=p,gt=ye,M(dt,A3(o,ye,u[Oe]),14);if(Me=u[Oe.stream],Oe.type==="detection_list"){if(Me){for(var nn=Me.getRectList(),or=Me.getLandmarksList(),bn=Me.getClassificationsList(),rt=[],rn=0;rn<nn.size();++rn){var xs=f3(nn.get(rn)),C3=xe(xs,1),j3=xe(xs,2),_3=xe(xs,3),N3=xe(xs,4),b3=xe(xs,5,0),sl=void 0;sl=sl===void 0?0:sl,xs={la:{ra:C3,sa:j3,height:_3,width:N3,rotation:b3,pa:ae(_n(xs,6),sl)},ea:L(Kp(or.get(rn)),Mi,1).map(Zp),ba:qp(Vp(bn.get(rn)))},rt.push(xs)}nn=rt}else nn=[];p[ye]=nn,dt.h=7;break}if(Oe.type==="proto_list"){if(Me){for(nn=Array(Me.size()),or=0;or<Me.size();or++)nn[or]=Me.get(or);Me.delete()}else nn=[];p[ye]=nn,dt.h=7;break}if(Me===void 0){dt.h=3;break}if(Oe.type==="float_list"){p[ye]=Me,dt.h=7;break}if(Oe.type==="proto"){p[ye]=Me,dt.h=7;break}if(Oe.type!=="texture")throw Error("Unknown output config type: '"+Oe.type+"'");return we=o.v[ye],we||(we=new Eu(o.i,o.K),o.v[ye]=we),M(dt,tm(we,Me,o.M),13);case 13:$e=dt.i,p[ye]=$e;case 7:Oe.transform&&p[ye]&&(p[ye]=Oe.transform(p[ye])),dt.h=3;break;case 14:Ye[gt]=dt.i;case 3:E=oe.next(),dt.h=2;break;case 4:return dt.return(p)}})}function A3(o,u,f){var p;return X(function(S){return typeof f=="number"||f instanceof Uint8Array||f instanceof o.i.Uint8BlobList?S.return(f):f instanceof o.i.Texture2dDataOut?(p=o.v[u],p||(p=new Eu(o.i,o.K),o.v[u]=p),S.return(tm(p,f,o.M))):S.return(void 0)})}function E3(o,u){for(var f=u.name||"$",p=[].concat(d(u.wants)),S=new o.i.StringList,C=c(u.wants),E=C.next();!E.done;E=C.next())S.push_back(E.value);C=o.i.PacketListener.implement({onResults:function(B){for(var K={},oe=0;oe<u.wants.length;++oe)K[p[oe]]=B.get(oe);var ye=o.listeners[f];ye&&(o.I=k3(o,K,u.outs).then(function(Oe){Oe=ye(Oe);for(var Me=0;Me<u.wants.length;++Me){var we=K[p[Me]];typeof we=="object"&&we.hasOwnProperty&&we.hasOwnProperty("delete")&&we.delete()}Oe&&(o.I=Oe)}))}}),o.j.attachMultiListener(S,C),S.delete()}e.onResults=function(o,u){this.listeners[u||"$"]=o},pe("Solution",Cu),pe("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function rm(o){return o===void 0&&(o=0),o===1?"hand_landmark_full.tflite":"hand_landmark_lite.tflite"}function sm(o){var u=this;o=o||{},this.h=new Cu({locateFile:o.locateFile,files:function(f){return[{url:"hands_solution_packed_assets_loader.js"},{simd:!1,url:"hands_solution_wasm_bin.js"},{simd:!0,url:"hands_solution_simd_wasm_bin.js"},{data:!0,url:rm(f.modelComplexity)}]},graph:{url:"hands.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:["multi_hand_landmarks","multi_hand_world_landmarks","image_transformed","multi_handedness"],outs:{image:"image_transformed",multiHandLandmarks:{type:"proto_list",stream:"multi_hand_landmarks",transform:em},multiHandWorldLandmarks:{type:"proto_list",stream:"multi_hand_world_landmarks",transform:em},multiHandedness:{type:"proto_list",stream:"multi_handedness",transform:function(f){return f.map(function(p){return qp(Vp(p))[0]})}}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumHands:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculator",fieldName:"int_value"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(f){var p,S,C;return X(function(E){return E.h==1?(p=rm(f),S="third_party/mediapipe/modules/hand_landmark/"+p,M(E,rl(u.h,p),2)):(C=E.i,u.h.overrideFile(S,C),E.return(!0))})}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"handlandmarktrackinggpu__palmdetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"handlandmarktrackinggpu__handlandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}}}})}e=sm.prototype,e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(o){this.h.onResults(o)},e.initialize=function(){var o=this;return X(function(u){return M(u,o.h.initialize(),0)})},e.reset=function(){this.h.reset()},e.send=function(o){var u=this;return X(function(f){return M(f,u.h.send(o),0)})},e.setOptions=function(o){this.h.setOptions(o)},pe("Hands",sm),pe("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),pe("VERSION","0.4.1675469240")}).call(ju);const Wn=(...e)=>{},$r={red:{lower1:[0,120,70],upper1:[10,255,255],lower2:[170,120,70],upper2:[180,255,255]},blue:{lower:[100,150,70],upper:[130,255,255]}},Tt={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity",selectedCamera:"detectorSelectedCamera"};function x1({hidden:e=!1}){const t=k.useRef(null),n=k.useRef(null),r=k.useRef(null),s=k.useRef(null),[i,a]=k.useState(!1),[c,d]=k.useState("None"),[h,g]=k.useState([]),[x,w]=k.useState(null),[_,D]=k.useState(null),[I,Y]=k.useState(null),[j,y]=k.useState({a:null,b:null}),A=k.useRef(null),M=k.useRef(null),b=($,m)=>{const P=localStorage.getItem($);if(P===null)return m;const N=parseFloat(P);return Number.isFinite(N)?N:m},[H,R]=k.useState(()=>({roiSize:(()=>{const $=b(Tt.roiSize,44);return $>10?$:44})(),hueWeight:b(Tt.hueWeight,4),satWeight:b(Tt.satWeight,2),valWeight:b(Tt.valWeight,1),sensitivity:b(Tt.sensitivity,0)})),O=k.useRef(H),z=k.useRef(null),W=k.useRef(!1),X=k.useRef(0),q=k.useRef(null),[J,re]=k.useState([]),pe=k.useRef([]),[me,Se]=k.useState(()=>localStorage.getItem(Tt.selectedCamera)||""),ie=k.useCallback(async()=>{try{const m=(await navigator.mediaDevices.enumerateDevices()).filter(P=>P.kind==="videoinput");return re(m),pe.current=m,m}catch{return[]}},[]),ne=k.useCallback($=>{},[Wn]),ee=k.useCallback(async($=null)=>{const m=t.current;if(!m)return;z.current&&(z.current.getTracks().forEach(v=>v.stop()),z.current=null),U();const P=++X.current;q.current=null;const N=$!==null?$:me;try{const v=N?{video:{deviceId:{exact:N}}}:{video:!0};if(N){const V=pe.current.find(Z=>Z.deviceId===N);console.log("[Detector]  Loading SELECTED camera:",{deviceId:N,label:(V==null?void 0:V.label)||"Unknown",source:"localStorage or user selection"})}else console.log("[Detector]  Loading DEFAULT camera (no selection saved)");const T=await navigator.mediaDevices.getUserMedia(v);if(!W.current||P!==X.current){Wn("Stale camera request (unmounted or superseded). Stopping stream."),T.getTracks().forEach(V=>V.stop());return}z.current=T;const F=T.getVideoTracks();if(Wn("getUserMedia success. Tracks:",F),F.length>0){const V=F[0];console.log("[Detector]  Camera loaded successfully:",{label:V.label,deviceId:V.getSettings().deviceId,resolution:`${V.getSettings().width}x${V.getSettings().height}`,frameRate:V.getSettings().frameRate})}if(m.srcObject=T,await new Promise(V=>{if(m.readyState>=1&&m.videoWidth>0&&m.videoHeight>0)return V();const ce=()=>{m.removeEventListener("loadedmetadata",ce),V()};m.addEventListener("loadedmetadata",ce,{once:!0}),setTimeout(()=>{m.removeEventListener("loadedmetadata",ce),V()},1500)}),!W.current||P!==X.current){Wn("Stale request before play(). Stopping stream."),T.getTracks().forEach(V=>V.stop());return}try{await m.play(),Wn("video.play() promise resolved. Video should be playing.")}catch(V){if(console.error("[Detector] video.play() promise rejected:",V),Wn("video.play() promise rejected:",V.name,V.message),P!==X.current){Wn("play() aborted due to newer request."),T.getTracks().forEach(Z=>Z.stop());return}}if(q.current!==P&&(q.current=P,Wn("Initializing MediaPipe for request id",P),Ne()),W.current){const V=await ie();if(!N||!$){const Z=V.find(ce=>ce.deviceId);Z&&Z.deviceId&&Z.deviceId!==me&&(Se(Z.deviceId),localStorage.setItem(Tt.selectedCamera,Z.deviceId))}}}catch(v){console.error("[Detector] Error accessing camera:",v),Wn("getUserMedia error:",v.name,v.message)}},[Wn,ie,ne,me]),he=($,m,P)=>{const N=($||0)*2,v=(m||0)/255,T=(P||0)/255,F=T*v,V=F*(1-Math.abs(N/60%2-1)),Z=T-F;let ce=0,Ee=0,Be=0;N>=0&&N<60?(ce=F,Ee=V,Be=0):N<120?(ce=V,Ee=F,Be=0):N<180?(ce=0,Ee=F,Be=V):N<240?(ce=0,Ee=V,Be=F):N<300?(ce=V,Ee=0,Be=F):(ce=F,Ee=0,Be=V);const Fe=Math.round((ce+Z)*255),nt=Math.round((Ee+Z)*255),qe=Math.round((Be+Z)*255);return`rgb(${Fe}, ${nt}, ${qe})`},_e=$=>$?he($.h,$.s,$.v):"#ffffff",We=$=>$==="Player A"&&_?_e(_):$==="Player B"&&I?_e(I):$==="Red"?"#ff0000":$==="Blue"?"#0000ff":"#ffffff";k.useEffect(()=>{W.current=!0;const $=()=>{try{const N=JSON.parse(localStorage.getItem("calibrationA")||"null"),v=JSON.parse(localStorage.getItem("calibrationB")||"null");N&&D({h:N.h,s:N.s,v:N.v}),v&&Y({h:v.h,s:v.s,v:v.v})}catch{}},m=N=>{!N||!N.key||(["calibrationA","calibrationB"].includes(N.key)&&$(),[Tt.roiSize,Tt.hueWeight,Tt.satWeight,Tt.valWeight,Tt.sensitivity].includes(N.key)&&R(v=>({roiSize:(()=>{const T=b(Tt.roiSize,(v==null?void 0:v.roiSize)??44);return T>10?T:(v==null?void 0:v.roiSize)??44})(),hueWeight:b(Tt.hueWeight,(v==null?void 0:v.hueWeight)??4),satWeight:b(Tt.satWeight,(v==null?void 0:v.satWeight)??2),valWeight:b(Tt.valWeight,(v==null?void 0:v.valWeight)??1),sensitivity:b(Tt.sensitivity,(v==null?void 0:v.sensitivity)??0)})))};return(async()=>{const N=await ie();if(!W.current)return;const v=localStorage.getItem(Tt.selectedCamera);let T="";if(v&&N.some(F=>F.deviceId&&F.deviceId===v)){const F=N.find(V=>V.deviceId===v);T=v,console.log("[Detector]  Found saved camera in localStorage:",{deviceId:v,label:(F==null?void 0:F.label)||"Unknown"})}else{v&&localStorage.removeItem(Tt.selectedCamera);const F=N.find(V=>V.deviceId);F&&F.deviceId?(T=F.deviceId,localStorage.setItem(Tt.selectedCamera,F.deviceId),console.log("[Detector]  No saved camera found, using system default:",{deviceId:F.deviceId,label:F.label||"Unknown",savedCameraWas:v||"none"}),Wn("Saved camera not found, using default camera:",F.deviceId)):console.log("[Detector]  No camera identifiers available yet (likely awaiting permission).")}Se(T?F=>F===T?F:T:F=>F||""),$()})(),window.addEventListener("storage",m),()=>{W.current=!1,X.current+=1,q.current=null,s.current&&(s.current.stop(),s.current=null),z.current&&(z.current.getTracks().forEach(v=>v.stop()),z.current=null);const N=t.current;N&&(N.srcObject=null,ne(N)),r.current&&(r.current.close(),r.current=null),window.removeEventListener("storage",m)}},[]),k.useEffect(()=>{A.current=_},[_]),k.useEffect(()=>{M.current=I},[I]),k.useEffect(()=>{O.current=H},[H]),k.useEffect(()=>{ee(me||null)},[me,ee]),k.useEffect(()=>{const $=setInterval(()=>{d(m=>(ze(m),m))},1e3);return()=>clearInterval($)},[]);const ze=$=>{const P={timestamp:new Date().toISOString(),status:$};g(v=>[...v,P]);const N=JSON.parse(localStorage.getItem("braceletDetections")||"[]");N.push(P),localStorage.setItem("braceletDetections",JSON.stringify(N))},Ne=async()=>{try{const $=await(async()=>{try{if(typeof gc.Hands=="function")return gc.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function"||(await new Promise((P,N)=>{const v="mp-hands-cdn-script";if(document.getElementById(v))return P();const T=document.createElement("script");T.id=v,T.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",T.async=!0,T.onload=()=>P(),T.onerror=F=>N(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(T)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),m=new $({locateFile:P=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${P}`});if(m.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),m.onResults(De),r.current=m,t.current){const P=t.current;console.log("[Detector]  Starting manual frame capture from video element");let N;const v=async()=>{if(P.readyState>=2&&P.videoWidth>0)try{await m.send({image:P})}catch(T){console.error("[Detector] Error sending frame to MediaPipe:",T)}N=requestAnimationFrame(v)};v(),s.current={stop:()=>{N&&(cancelAnimationFrame(N),console.log("[Detector]  Stopped frame capture"))}}}}catch($){console.error("MediaPipe initialization error:",$),w(`MediaPipe error: ${$.message}`)}},De=$=>{var F;const m=n.current,P=t.current;if(!m||!P)return;const N=m.getContext("2d");m.width=P.videoWidth,m.height=P.videoHeight,N.drawImage(P,0,0,m.width,m.height);let v="None";if($.multiHandLandmarks&&$.multiHandLandmarks.length>0){Wn("onResults: hands=",$.multiHandLandmarks.length);let V=null,Z=0;if($.multiHandLandmarks.forEach(ce=>{const Ee=ce[0];Ee.y>Z&&(Z=Ee.y,V=ce)}),$.multiHandLandmarks.forEach(ce=>{se(N,ce,m.width,m.height)}),V){const ce=V[0],Ee=ce.x*m.width,Be=ce.y*m.height;N.fillStyle="lime",N.beginPath(),N.arc(Ee,Be,10,0,2*Math.PI),N.fill(),N.fillStyle="lime",N.font="16px Arial",N.fillText("SELECTED",Ee-40,Be-15);const nt=Math.max(10,Math.min(300,Math.floor(((F=O.current)==null?void 0:F.roiSize)||60)))/2,qe=Math.max(0,Ee-nt),lt=Math.max(0,Be-nt),ct=Math.min(m.width,Ee+nt),Ge=Math.min(m.height,Be+nt);N.strokeStyle="lime",N.lineWidth=3,N.strokeRect(qe,lt,ct-qe,Ge-lt);const Ue=ct-qe,Ve=Ge-lt;if(Ue>0&&Ve>0)try{const Ze=N.getImageData(qe,lt,Ue,Ve),Ct=A.current,On=M.current,mt=ve(Ze,Ct,On);v=mt.status,y({a:mt.percentA,b:mt.percentB}),Wn("Detection result:",v,{roi:{x1:qe,y1:lt,w:Ue,h:Ve}})}catch(Ze){console.warn("[Detector] Failed to get ROI image data:",Ze.message),v="None",y({a:null,b:null})}else console.warn("[Detector] Invalid ROI dimensions:",{width:Ue,height:Ve}),v="None",y({a:null,b:null})}}let T="#ffffff";v==="Player A"&&A.current?T=_e(A.current):v==="Player B"&&M.current&&(T=_e(M.current)),N.fillStyle=T,N.font="bold 32px Arial",N.fillText(`Status: ${v}`,10,40),d(v),typeof window<"u"&&(window.currentBraceletStatus=v,window.braceletDetectorCanvas=m,window.braceletDetectorVideo=P)},se=($,m,P,N)=>{$.strokeStyle="white",$.lineWidth=2,[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,13],[13,17],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20]].forEach(([T,F])=>{const V=m[T],Z=m[F];$.beginPath(),$.moveTo(V.x*P,V.y*N),$.lineTo(Z.x*P,Z.y*N),$.stroke()}),m.forEach(T=>{$.fillStyle="red",$.beginPath(),$.arc(T.x*P,T.y*N,5,0,2*Math.PI),$.fill()})},le=$=>{const m=$.data;let P=0,N=0;for(let v=0;v<m.length;v+=4){const T=m[v],F=m[v+1],V=m[v+2],Z=fe(T,F,V);(Z[0]>=$r.red.lower1[0]&&Z[0]<=$r.red.upper1[0]||Z[0]>=$r.red.lower2[0]&&Z[0]<=$r.red.upper2[0])&&Z[1]>=$r.red.lower1[1]&&Z[2]>=$r.red.lower1[2]&&P++,Z[0]>=$r.blue.lower[0]&&Z[0]<=$r.blue.upper[0]&&Z[1]>=$r.blue.lower[1]&&Z[2]>=$r.blue.lower[2]&&N++}return{redCount:P,blueCount:N}},ve=($,m,P)=>{var nt,qe,lt,ct;const N=$.data;if(m&&!P)return{status:"Player A",percentA:null,percentB:null};if(P&&!m)return{status:"Player B",percentA:null,percentB:null};const v=((nt=O.current)==null?void 0:nt.hueWeight)??4,T=((qe=O.current)==null?void 0:qe.satWeight)??2,F=((lt=O.current)==null?void 0:lt.valWeight)??1,V=((ct=O.current)==null?void 0:ct.sensitivity)??0;if(m&&P){let Ge=0,Ue=0,Ve=0;for(let mt=0;mt<N.length;mt+=4){const Dt=N[mt],Pt=N[mt+1],tn=N[mt+2],[ln,cn,En]=fe(Dt,Pt,tn),Cn=Math.min(1,Math.max(0,cn/255)),Jr=Math.min(1,Math.max(0,En/255)),Fr=Math.max(.05,.5*Cn+.5*Jr),$n=Math.min(Math.abs(ln-m.h),180-Math.abs(ln-m.h)),Dn=Math.min(Math.abs(ln-P.h),180-Math.abs(ln-P.h)),ys=Math.abs(cn-m.s),zn=Math.abs(cn-P.s),Si=Math.abs(En-m.v),jn=Math.abs(En-P.v),Ar=$n*v+ys*T+Si*F,Js=Dn*v+zn*T+jn*F;Math.min(Ar,Js)>180||(Ar<=Js?Ge+=Fr:Ue+=Fr,Ve+=Fr)}if(Ve===0)return{status:"None",percentA:0,percentB:0};const Ze=Ge/Math.max(1e-6,Ve),Ct=Ue/Math.max(1e-6,Ve),On=.12*(1+.8*Math.max(0,Math.min(1,V)));return Ze>=On&&Ze>=Ct?{status:"Player A",percentA:Ze,percentB:Ct}:Ct>=On&&Ct>Ze?{status:"Player B",percentA:Ze,percentB:Ct}:{status:"None",percentA:Ze,percentB:Ct}}const{redCount:Z,blueCount:ce}=le($),Ee=Z+ce;if(Ee===0)return{status:"None",percentA:0,percentB:0};const Be=Z/Ee,Fe=ce/Ee;return Be>=.15&&Be>=Fe?{status:"Player A",percentA:Be,percentB:Fe}:Fe>=.15&&Fe>Be?{status:"Player B",percentA:Be,percentB:Fe}:{status:"None",percentA:Be,percentB:Fe}},fe=($,m,P)=>{$/=255,m/=255,P/=255;const N=Math.max($,m,P),v=Math.min($,m,P),T=N-v;let F=0;T!==0&&(N===$?F=60*((m-P)/T%6):N===m?F=60*((P-$)/T+2):F=60*(($-m)/T+4)),F<0&&(F+=360);const V=N===0?0:T/N*255,Z=N*255;return[F/2,V,Z]},U=$=>{},G=$=>{Se($),$?localStorage.setItem(Tt.selectedCamera,$):localStorage.removeItem(Tt.selectedCamera)},Q=()=>{const $=JSON.parse(localStorage.getItem("braceletDetections")||"[]"),m=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),P=URL.createObjectURL(m),N=document.createElement("a");N.href=P,N.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.json`,N.click();const v=$.map(Z=>`${Z.timestamp}: ${Z.status}`).join(`
`),T=new Blob([v],{type:"text/plain"}),F=URL.createObjectURL(T),V=document.createElement("a");V.href=F,V.download=`bracelet_detections_${new Date().toISOString().split("T")[0]}.txt`,V.click()},te=()=>{localStorage.removeItem("braceletDetections"),g([])};return l.jsx(l.Fragment,{children:l.jsxs("div",{className:`detector-window ${i?"minimized":""}`,style:e?{opacity:0,pointerEvents:"none",visibility:"hidden"}:void 0,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:Q,title:"Download Logs",children:""}),l.jsx("button",{onClick:te,title:"Clear Logs",children:""}),l.jsx("button",{onClick:()=>a(!i),children:i?"":""})]})]}),l.jsxs("div",{className:"detector-content",style:{display:i?"none":"block"},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:8,display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{children:"Camera:"}),l.jsxs("select",{value:me,onChange:$=>G($.target.value),style:{fontSize:11,padding:"3px 6px",flex:1,maxWidth:200},children:[l.jsx("option",{value:"",children:"System Default"}),J.map(($,m)=>{var V;const P=!!$.deviceId,N=P?$.deviceId:"",v=P?$.deviceId:`camera-${m}`,T=((V=$.label)==null?void 0:V.trim())||`Camera ${m+1}`,F=P?`  ${$.deviceId.slice(0,8)}`:" (needs permission)";return l.jsxs("option",{value:N,disabled:!P,children:[T,F]},v)})]})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:"1px",height:"1px"}}),l.jsx("canvas",{ref:n,className:"output_canvas"}),l.jsxs("div",{className:"detector-info",children:[l.jsxs("div",{className:"status-display",children:["Status: ",l.jsx("span",{style:{color:We(c),fontWeight:700},children:c})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:_?_e(_):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"A confidence",children:j.a==null?"":`${Math.round(Math.max(0,Math.min(1,j.a))*100)}%`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:I?_e(I):"#444"}}),l.jsx("span",{style:{fontSize:12,opacity:.8,minWidth:36,textAlign:"right"},title:"B confidence",children:j.b==null?"":`${Math.round(Math.max(0,Math.min(1,j.b))*100)}%`})]})]}),l.jsxs("div",{className:"log-count",children:["Logs: ",h?h.length:0]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",_?`h${Math.round(_.h)} s${Math.round(_.s)} v${Math.round(_.v)}`:""]}),l.jsxs("div",{children:["B: ",I?`h${Math.round(I.h)} s${Math.round(I.s)} v${Math.round(I.v)}`:""]})]})]})]})]})})}const td=(...e)=>{console.log("[Calibrate]",...e)},Dr={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"},mw=(e,t,n)=>{const r=(e||0)*2,s=(t||0)/255,i=(n||0)/255,a=i*s,c=a*(1-Math.abs(r/60%2-1)),d=i-a;let h=0,g=0,x=0;r>=0&&r<60?(h=a,g=c,x=0):r<120?(h=c,g=a,x=0):r<180?(h=0,g=a,x=c):r<240?(h=0,g=c,x=a):r<300?(h=c,g=0,x=a):(h=a,g=0,x=c);const w=Math.round((h+d)*255),_=Math.round((g+d)*255),D=Math.round((x+d)*255);return`rgb(${w}, ${_}, ${D})`},w1=e=>e?mw(e.h,e.s,e.v):"#444";function gw(){const e=k.useRef(null),t=k.useRef(null),n=k.useRef(null),r=k.useRef(!1),s=k.useRef(0),[i,a]=k.useState(!1),[c,d]=k.useState(""),[h,g]=k.useState(null),[x,w]=k.useState(null),_=(se,le)=>{const ve=localStorage.getItem(se);if(ve===null)return le;const fe=parseFloat(ve);return Number.isFinite(fe)?fe:le},[D,I]=k.useState(()=>{const se=_(Dr.roiSize,44);return se>10?se:44}),[Y,j]=k.useState(()=>_(Dr.hueWeight,4)),[y,A]=k.useState(()=>_(Dr.satWeight,2)),[M,b]=k.useState(()=>_(Dr.valWeight,1)),[H,R]=k.useState(()=>_(Dr.sensitivity,0)),[O,z]=k.useState(!1),[W,X]=k.useState("idle"),[q,J]=k.useState(5),re=k.useRef({A:[],B:[]});k.useEffect(()=>{r.current=!0;try{const se=JSON.parse(localStorage.getItem("calibrationA")||"null"),le=JSON.parse(localStorage.getItem("calibrationB")||"null");se&&g(se),le&&w(le)}catch{}return(async()=>await pe())(),()=>{r.current=!1,s.current+=1,n.current&&(n.current.getTracks().forEach(le=>le.stop()),n.current=null);const se=e.current;se&&(se.srcObject=null)}},[]),k.useEffect(()=>{localStorage.setItem(Dr.roiSize,String(D))},[D]),k.useEffect(()=>{localStorage.setItem(Dr.hueWeight,String(Y))},[Y]),k.useEffect(()=>{localStorage.setItem(Dr.satWeight,String(y))},[y]),k.useEffect(()=>{localStorage.setItem(Dr.valWeight,String(M))},[M]),k.useEffect(()=>{localStorage.setItem(Dr.sensitivity,String(H))},[H]);const pe=k.useCallback(async()=>{const se=e.current;if(!se)return;n.current&&(n.current.getTracks().forEach(ve=>ve.stop()),n.current=null);const le=++s.current;a(!1),d("Requesting camera...");try{const ve=await navigator.mediaDevices.getUserMedia({video:!0});if(!r.current||le!==s.current){ve.getTracks().forEach(fe=>fe.stop());return}if(n.current=ve,se.srcObject=ve,await new Promise(fe=>{if(se.readyState>=1&&se.videoWidth>0)return fe();const G=()=>{se.removeEventListener("loadedmetadata",G),fe()};se.addEventListener("loadedmetadata",G,{once:!0}),setTimeout(()=>{se.removeEventListener("loadedmetadata",G),fe()},1500)}),!r.current||le!==s.current){ve.getTracks().forEach(fe=>fe.stop());return}try{await se.play(),td("video.play resolved")}catch(fe){td("video.play rejected",fe)}a(!0),d("")}catch(ve){d(`Camera error: ${(ve==null?void 0:ve.message)||ve}`),td("getUserMedia error",ve)}},[]),me=(se,le,ve)=>{se/=255,le/=255,ve/=255;const fe=Math.max(se,le,ve),U=Math.min(se,le,ve),G=fe-U;let Q=0;G!==0&&(fe===se?Q=60*((le-ve)/G%6):fe===le?Q=60*((ve-se)/G+2):Q=60*((se-le)/G+4)),Q<0&&(Q+=360);const te=fe===0?0:G/fe*255,$=fe*255;return[Q/2,te,$]},Se=()=>{const se=e.current,le=t.current;if(!se||!le||se.videoWidth===0)return null;const ve=se.videoWidth,fe=se.videoHeight;le.width=ve,le.height=fe;const U=le.getContext("2d");U.drawImage(se,0,0,ve,fe);const G=Math.max(10,Math.min(300,Math.floor(D))),Q=Math.floor(ve/2-G/2),te=Math.floor(fe/2-G/2),m=U.getImageData(Q,te,G,G).data;let P=0,N=0,v=0,T=0,F=0;for(let qe=0;qe<m.length;qe+=4){const[lt,ct,Ge]=me(m[qe],m[qe+1],m[qe+2]),Ue=lt*2*(Math.PI/180);P+=Math.cos(Ue),N+=Math.sin(Ue),v+=ct,T+=Ge,F++}if(F===0)return null;const V=v/F,Z=T/F,ce=P/F,Ee=N/F;let Fe=Math.atan2(Ee,ce)*(180/Math.PI);return Fe<0&&(Fe+=360),{h:Fe/2,s:V,v:Z}},ie=se=>{const le=Se();if(!le){d("Could not sample video frame.");return}se==="A"?(localStorage.setItem("calibrationA",JSON.stringify(le)),g(le),d(`Saved Player A: h${le.h.toFixed(0)}`)):(localStorage.setItem("calibrationB",JSON.stringify(le)),w(le),d(`Saved Player B: h${le.h.toFixed(0)}`))},ne=se=>{se==="A"?(localStorage.removeItem("calibrationA"),g(null)):(localStorage.removeItem("calibrationB"),w(null)),d("Cleared")},ee=()=>{z(!0),X("playerA"),J(5),re.current={A:[],B:[]},d("Hold Player A bracelet in center square...")};k.useEffect(()=>{if(!(!O||W==="idle"||W==="optimizing"||W==="complete"))if(q>0){const se=setTimeout(()=>{J(q-1)},1e3);return()=>clearTimeout(se)}else W==="playerA"?(X("switching"),J(3),d("Switch to Player B... Get ready!")):W==="switching"?(X("playerB"),J(5),d("Hold Player B bracelet in center square...")):W==="playerB"&&(X("optimizing"),he())},[O,W,q]),k.useEffect(()=>{if(!O||W==="idle"||W==="switching"||W==="optimizing"||W==="complete")return;const se=setInterval(()=>{const le=Se();le&&(W==="playerA"?re.current.A.push(le):W==="playerB"&&re.current.B.push(le))},200);return()=>clearInterval(se)},[O,W]);const he=()=>{d("Optimizing parameters...");const se=re.current.A,le=re.current.B;if(se.length===0||le.length===0){d("Error: Not enough samples collected!"),z(!1),X("idle");return}const ve=_e(se),fe=_e(le),U=Math.min(Math.abs(ve.h-fe.h),180-Math.abs(ve.h-fe.h)),G=Math.abs(ve.s-fe.s),Q=Math.abs(ve.v-fe.v),te=U/90,$=G/255,m=Q/255,P=We(se),N=We(le),v={h:(P.h+N.h)/2,s:(P.s+N.s)/2,v:(P.v+N.v)/2},T=te+$+m,F=T>0?te/T*(1/(1+v.h/20))*6:2,V=T>0?$/T*(1/(1+v.s/50))*4:1,Z=T>0?m/T*(1/(1+v.v/50))*3:.5;j(Math.max(.5,Math.min(6,F))),A(Math.max(.1,Math.min(4,V))),b(Math.max(.1,Math.min(3,Z)));const ce=ze(se,le,ve,fe),Ee=Math.max(0,Math.min(.8,ce*.5));R(Ee),localStorage.setItem("calibrationA",JSON.stringify(ve)),localStorage.setItem("calibrationB",JSON.stringify(fe)),g(ve),w(fe),X("complete"),d(` Auto-calibration complete! Collected ${se.length+le.length} samples. Optimized parameters for best separation.`),setTimeout(()=>{z(!1),X("idle")},3e3)},_e=se=>{const le=se.map(N=>N.h),ve=se.map(N=>N.s).sort((N,v)=>N-v),fe=se.map(N=>N.v).sort((N,v)=>N-v);let U=0,G=0;le.forEach(N=>{const v=N*2*(Math.PI/180);U+=Math.cos(v),G+=Math.sin(v)});let te=Math.atan2(G/le.length,U/le.length)*(180/Math.PI);te<0&&(te+=360);const $=te/2,m=ve[Math.floor(ve.length/2)],P=fe[Math.floor(fe.length/2)];return{h:$,s:m,v:P}},We=se=>{const le=se.reduce((fe,U)=>({h:fe.h+U.h,s:fe.s+U.s,v:fe.v+U.v}),{h:0,s:0,v:0});le.h/=se.length,le.s/=se.length,le.v/=se.length;const ve=se.reduce((fe,U)=>({h:fe.h+Math.pow(U.h-le.h,2),s:fe.s+Math.pow(U.s-le.s,2),v:fe.v+Math.pow(U.v-le.v,2)}),{h:0,s:0,v:0});return{h:ve.h/se.length,s:ve.s/se.length,v:ve.v/se.length}},ze=(se,le,ve,fe)=>{let U=0;const G=Math.min(se.length,le.length)*2;return se.forEach(Q=>{const te=Ne(Q,ve);Ne(Q,fe)<te*1.5&&U++}),le.forEach(Q=>{const te=Ne(Q,ve),$=Ne(Q,fe);te<$*1.5&&U++}),U/G},Ne=(se,le)=>{const ve=Math.min(Math.abs(se.h-le.h),180-Math.abs(se.h-le.h)),fe=Math.abs(se.s-le.s),U=Math.abs(se.v-le.v);return Math.sqrt(ve*ve+fe*fe+U*U)},De=()=>{z(!1),X("idle"),J(5),d("Generic mode cancelled")};return l.jsxs("div",{className:"calib-root",children:[l.jsxs("div",{className:"calib-header",children:[l.jsx("h2",{children:"Color Calibration"}),l.jsxs("div",{className:"calib-actions",children:[l.jsx("button",{onClick:()=>window.location.hash="",children:"Back"}),l.jsx("button",{onClick:pe,children:"Restart Camera"})]})]}),c&&l.jsx("div",{className:"calib-message",children:c}),l.jsxs("div",{className:"calib-content",children:[l.jsx("div",{children:l.jsxs("div",{className:"calib-block",style:{marginBottom:12},children:[l.jsx("div",{className:"label",children:"Live Preview"}),l.jsx("div",{className:"value",style:{marginBottom:8},children:O?`Generic Mode Active: ${W==="playerA"?"Player A":W==="switching"?"Switching...":W==="playerB"?"Player B":"Processing..."}`:"Place the bracelet color inside the center square to sample accurate HSV."}),l.jsxs("div",{className:"calib-video-wrap",children:[l.jsx("video",{ref:e,className:"calib-video",autoPlay:!0,playsInline:!0,muted:!0}),l.jsx("div",{className:"calib-center-box",style:{width:D,height:D,borderColor:"#22d3ee",borderWidth:O?"4px":"3px",boxShadow:O?"0 0 20px rgba(34, 211, 238, 0.6)":"0 0 0 2000px rgba(0,0,0,0.35)"}}),O&&q>0&&l.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"72px",fontWeight:"bold",color:"#22d3ee",textShadow:"0 0 20px rgba(34, 211, 238, 0.8), 0 0 40px rgba(34, 211, 238, 0.5)",pointerEvents:"none",zIndex:10},children:q})]})]})}),l.jsxs("div",{className:"calib-controls",children:[l.jsxs("div",{className:"calib-block",style:{background:O?"#1a2332":"#0f172a",border:O?"2px solid #22d3ee":"1px solid #1f2937"},children:[l.jsx("div",{className:"label",children:" Generic Mode (Auto-Calibration)"}),l.jsx("div",{className:"value",style:{fontSize:13,marginBottom:8},children:"Automatically calibrate both players with optimized parameters. Hold each bracelet in the center square for 5 seconds."}),O?l.jsxs("div",{style:{marginTop:8},children:[l.jsxs("div",{style:{fontSize:16,fontWeight:"bold",color:"#22d3ee",marginBottom:8},children:[W==="playerA"&&`Player A: Hold bracelet steady... ${q}s`,W==="switching"&&`Switch hands! Get Player B ready... ${q}s`,W==="playerB"&&`Player B: Hold bracelet steady... ${q}s`,W==="optimizing"&&"Optimizing parameters...",W==="complete"&&" Complete!"]}),l.jsxs("div",{style:{fontSize:12,opacity:.7,marginBottom:8},children:[W==="playerA"&&`Samples collected: ${re.current.A.length}`,W==="switching"&&`Player A: ${re.current.A.length} samples collected`,W==="playerB"&&`Samples collected: ${re.current.B.length}`]}),W!=="complete"&&l.jsx("button",{onClick:De,style:{background:"#ef4444"},children:"Cancel"})]}):l.jsx("div",{className:"buttons",children:l.jsx("button",{onClick:ee,disabled:!i,style:{background:"#22d3ee",color:"#000",fontWeight:"bold"},children:"Start Generic Mode"})})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Detector Settings"}),l.jsxs("div",{className:"value",style:{display:"grid",gap:8},children:[l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Detection square size"}),l.jsx("input",{type:"range",min:"20",max:"240",step:"2",value:D,onChange:se=>I(Number(se.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[D,"px"]})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Hue weight"}),l.jsx("input",{type:"range",min:"0",max:"6",step:"0.1",value:Y,onChange:se=>j(Number(se.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:Y.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Saturation weight"}),l.jsx("input",{type:"range",min:"0",max:"4",step:"0.1",value:y,onChange:se=>A(Number(se.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:y.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Value weight"}),l.jsx("input",{type:"range",min:"0",max:"3",step:"0.1",value:M,onChange:se=>b(Number(se.target.value))}),l.jsx("span",{style:{textAlign:"right"},children:M.toFixed(1)})]}),l.jsxs("label",{style:{display:"grid",gridTemplateColumns:"180px 1fr 60px",alignItems:"center",gap:8},children:[l.jsx("span",{children:"Sensitivity (lower = more sensitive)"}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:H,onChange:se=>R(Number(se.target.value))}),l.jsxs("span",{style:{textAlign:"right"},children:[(H*100).toFixed(0),"%"]})]}),l.jsx("div",{style:{fontSize:12,opacity:.7},children:"These settings are saved to local storage and used by the detector (wrist ROI, A/B decision weights, and sensitivity gate)."})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player A"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player A color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:w1(h)}}),l.jsx("span",{children:h?`h${h.h.toFixed(0)} s${h.s.toFixed(0)} v${h.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>ie("A"),disabled:!i,children:"Save A"}),l.jsx("button",{onClick:()=>ne("A"),children:"Clear A"})]})]}),l.jsxs("div",{className:"calib-block",children:[l.jsx("div",{className:"label",children:"Player B"}),l.jsxs("div",{className:"value",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("span",{title:"Player B color",style:{width:16,height:16,borderRadius:3,border:"1px solid #666",display:"inline-block",background:w1(x)}}),l.jsx("span",{children:x?`h${x.h.toFixed(0)} s${x.s.toFixed(0)} v${x.v.toFixed(0)}`:""})]}),l.jsxs("div",{className:"buttons",children:[l.jsx("button",{onClick:()=>ie("B"),disabled:!i,children:"Save B"}),l.jsx("button",{onClick:()=>ne("B"),children:"Clear B"})]})]})]})]}),l.jsx("canvas",{ref:t,className:"calib-offscreen"})]})}function ny({initialData:e=null,title:t="Game Summary",enableFileUpload:n=!0,className:r="",sessionGameId:s=null,onPlayerUpdate:i=null}){var $;const[a,c]=k.useState(e),[d,h]=k.useState(0),[g,x]=k.useState(!1),[w,_]=k.useState(1),[D,I]=k.useState(ma()),[Y,j]=k.useState(!0),[y,A]=k.useState([]),[M,b]=k.useState(null),[H,R]=k.useState(!1),O=k.useRef(null),z=k.useRef(null),W=k.useRef(null),X=n&&!e,q=["summary-container",r].filter(Boolean).join(" "),J=(m,P)=>{const N=W.current;if(!N)return 0;const v=N.offsetHeight;return(m+.5)*v},re=k.useCallback((m,P=null)=>{const N=P||a;if(!N)return;let v=ma(),T=!0;const F=[];let V=null;for(let Z=0;Z<=m&&Z<N.moves.length;Z++){const ce=N.moves[Z];ce.phase==="experiment"&&T&&(T=!1,v=ma());const Ee=ce.all_positions||(ce.allPositions?ce.allPositions.map(Be=>[Be[0]*.07,Be[1]*.07]):null);if(ce.type==="moveblock"&&Ee)Ee.length===10&&v.length===10?v=v.map((Be,Fe)=>{const nt=Ee[Fe];return nt&&Array.isArray(nt)&&nt.length===2?{...Be,position:[nt[0],nt[1]]}:Be}):console.warn(`Position count mismatch: blocks=${v.length}, positions=${Ee==null?void 0:Ee.length}`),v=pf(hf(v),T),V=ce.blockId!==void 0?ce.blockId:ce.unit;else if(ce.type==="added shape to gallery"&&ce.gallery_normalized){const Be=document.createElement("canvas");Be.width=400,Be.height=400;const Fe=Be.getContext("2d");Fe.fillStyle="#000",Fe.fillRect(0,0,400,400),ce.gallery_normalized.forEach(nt=>{const qe=(nt[0]+.5)*400,lt=(nt[1]+.5)*400;Fe.fillStyle="green";const ct=60;Fe.fillRect(qe-ct/2,lt-ct/2,ct,ct)}),F.push({number:ce.gallery_shape_number,image:Be.toDataURL()}),V=null}}I(v),j(T),A(F),b(V)},[a]),pe=m=>{c(m),h(0),x(!1),setTimeout(()=>{re(0,m)},0)},me=m=>{if(!X)return;const P=m.target.files[0];if(!P)return;const N=new FileReader;N.onload=v=>{try{const T=JSON.parse(v.target.result);pe(T)}catch(T){alert("Failed to parse JSON file: "+T.message)}},N.readAsText(P)};k.useEffect(()=>{e&&pe(e)},[e]),k.useEffect(()=>{a&&d>=0&&re(d)},[a,d,re]),k.useEffect(()=>{const m=()=>{a&&d>=0&&setTimeout(()=>{re(d)},100)};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[a,d,re]);const Se=m=>{a&&(m<0||m>=a.moves.length||(re(m),h(m)))},ie=()=>{if(!a||g)return;x(!0),h(0),re(0);let m=0;z.current=setInterval(()=>{if(m>=a.moves.length){ne();return}m++,re(m),h(m)},1e3/w)},ne=()=>{z.current&&(clearInterval(z.current),z.current=null),x(!1)};if(k.useEffect(()=>()=>{z.current&&clearInterval(z.current)},[]),k.useEffect(()=>{if(g&&z.current){clearInterval(z.current),z.current=null;const m=d;h(0),x(!1),setTimeout(()=>{h(m),ie()},0)}},[w]),!a)return X?l.jsx("div",{className:q,children:l.jsxs("div",{className:"summary-upload",children:[l.jsx("h1",{children:t}),l.jsx("p",{children:"Load a game session JSON file to view the replay"}),l.jsx("input",{ref:O,type:"file",accept:".json",onChange:me,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var m;return(m=O.current)==null?void 0:m.click()},children:"Load JSON File"})]})}):null;const ee=a.moves[d],he=a.moves.length,_e=(($=a.summary)==null?void 0:$.movesByPlayer)||{},We=Object.entries(_e||{}),ze=(m,P=1)=>Number.isFinite(m)?m.toFixed(P):"",Ne=a.sessionInfo||{},De=Ne.subjectId||Ne.id||a.subjectId||a.id||null,se=Ne.sessionGameId||a.sessionGameId||De||null,le=Ne.condition||a.condition||null,ve=a.startTime||Ne.startedAt||Ne.date||null,fe=a.endTime||Ne.endedAt||null,U=m=>{if(!m)return null;try{const P=new Date(m);if(!Number.isNaN(P.getTime()))return P.toLocaleString()}catch{}return m},G=[];se&&G.push({label:"Session ID",value:se}),De&&De!==se&&G.push({label:"Participant",value:De}),le&&G.push({label:"Condition",value:le});const Q=U(ve);Q&&G.push({label:"Start",value:Q});const te=U(fe);return te&&G.push({label:"End",value:te}),l.jsxs("div",{className:q,children:[l.jsxs("div",{className:"summary-header",children:[l.jsx("h1",{children:t}),G.length>0&&l.jsx("div",{className:"summary-session-info",children:G.map(m=>l.jsxs("div",{className:"summary-session-info-item",children:[l.jsx("span",{className:"summary-session-info-label",children:m.label}),l.jsx("span",{className:"summary-session-info-value",children:m.value})]},`${m.label}-${m.value}`))})]}),l.jsxs("div",{className:"summary-main",children:[l.jsxs("div",{className:"summary-left",children:[l.jsx("div",{className:"summary-game-area",children:l.jsxs("div",{className:"game-canvas",ref:W,children:[l.jsx("div",{className:"gallery",children:l.jsx("div",{className:"gallery-frame",children:y.length>0?l.jsx("img",{src:y[y.length-1].image,alt:"Gallery",className:"gallery-image"}):l.jsx("div",{className:"gallery-placeholder",children:"Gallery"})})}),D.map((m,P)=>{const N=m.position||[0,0];return!Array.isArray(N)||N.length!==2||!Number.isFinite(N[0])||!Number.isFinite(N[1])?(console.warn(`Invalid position for block ${m.id}:`,N),null):l.jsx("div",{className:`block ${m.canMove?"movable":""} ${m.id===M?"highlighted":""}`,style:{left:`${J(N[0])}px`,top:`${J(N[1])}px`,backgroundColor:m.color||"green",cursor:m.canMove?"grab":"default",zIndex:m.id===M?20:P+1}},m.id)})]})}),l.jsxs("div",{className:"summary-progress",children:[l.jsx("input",{type:"range",min:"0",max:Math.max(0,he-1),value:d,onChange:m=>Se(parseInt(m.target.value)),style:{width:"100%"}}),l.jsxs("div",{className:"progress-info",children:["Move ",d+1," of ",he,ee&&l.jsxs("span",{className:"move-info",children:[" "," Player: ",ee.player,Array.isArray(ee.position)&&ee.position.length===2&&`  Position: (${ee.position[0]}, ${ee.position[1]})`,Number.isFinite(ee.holdTime)&&`  Hold: ${ze(ee.holdTime,2)}s`," "," Time: ",ze(ee.elapsed,1),"s"]})]})]})]}),l.jsxs("div",{className:"summary-right",children:[l.jsxs("div",{className:"summary-stats",children:[l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Duration"}),l.jsxs("span",{className:"summary-stats-value",children:[Math.floor(a.duration/60),":",(a.duration%60).toFixed(0).padStart(2,"0")]})]}),l.jsxs("div",{className:"summary-stats-row",children:[l.jsx("span",{className:"summary-stats-label",children:"Total Moves"}),l.jsx("span",{className:"summary-stats-value",children:he})]}),l.jsxs("div",{className:"summary-stats-row summary-stats-column",children:[l.jsx("span",{className:"summary-stats-label",children:"Moves by Player"}),l.jsx("div",{className:"summary-stats-value",children:We.length===0?l.jsx("span",{children:""}):We.map(([m,P])=>l.jsxs("div",{children:[m,": ",P]},m))})]})]}),l.jsxs("div",{className:"summary-controls",children:[l.jsx("button",{onClick:()=>Se(0),disabled:d===0,children:" First"}),l.jsx("button",{onClick:()=>Se(d-1),disabled:d===0,children:" Previous"}),l.jsx("button",{onClick:g?ne:ie,children:g?" Pause":" Play"}),l.jsx("button",{onClick:()=>Se(d+1),disabled:d>=he-1,children:" Next"}),l.jsx("button",{onClick:()=>Se(he-1),disabled:d>=he-1,children:" Last"}),l.jsxs("div",{className:"speed-control",children:[l.jsx("label",{children:"Speed:"}),l.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:w,onChange:m=>_(parseFloat(m.target.value))}),l.jsxs("span",{children:[w,"x"]})]}),X&&l.jsxs(l.Fragment,{children:[l.jsx("input",{ref:O,type:"file",accept:".json",onChange:me,style:{display:"none"}}),l.jsx("button",{onClick:()=>{var m;return(m=O.current)==null?void 0:m.click()},children:" Load New File"})]})]}),l.jsxs("div",{className:"summary-moves-list",children:[l.jsxs("div",{className:"move-list-header",children:[l.jsx("h2",{children:"Move History"}),i&&l.jsx("button",{className:`edit-mode-toggle ${H?"active":""}`,onClick:()=>R(!H),children:H?" Done Editing":"Edit Players"})]}),l.jsx("div",{className:"moves-scroll",children:a.moves.map((m,P)=>l.jsxs("div",{className:`move-item ${P===d?"active":""} ${H?"edit-mode":""}`,onClick:()=>!H&&Se(P),children:[l.jsx("div",{className:"move-number",children:P+1}),m.camera_frame&&l.jsx("div",{className:"move-camera-frame",children:l.jsx("img",{src:m.camera_frame,alt:`Camera frame for move ${P+1}`,className:"camera-frame-thumbnail"})}),l.jsxs("div",{className:"move-details",children:[l.jsx("div",{className:"move-type",children:m.type}),H&&i?l.jsxs("div",{className:"move-player-edit",children:[l.jsx("label",{children:"Player:"}),l.jsxs("select",{value:m.player||"Unknown",onChange:N=>{const v=N.target.value;i(m._id,v)},onClick:N=>N.stopPropagation(),children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]})]}):l.jsxs("div",{className:"move-player",children:["Player: ",m.player]}),m.blockId!==null&&m.blockId!==void 0||m.unit!==null&&m.unit!==void 0?l.jsxs("div",{className:"move-unit",children:["Block: ",m.blockId!==void 0?m.blockId:m.unit]}):null,Array.isArray(m.position)&&m.position.length===2&&l.jsxs("div",{className:"move-position",children:["Position: (",m.position[0],", ",m.position[1],")"]}),Number.isFinite(m.holdTime)&&m.holdTime>0&&l.jsxs("div",{className:"move-hold-time",children:["Hold Time: ",ze(m.holdTime,2),"s"]}),l.jsxs("div",{className:"move-time",children:["Time: ",ze(m.elapsed,1),"s"]})]})]},P))})]})]})]})]})}const Qt=(...e)=>{console.log("[Detector2]",...e)},gn={roiSize:"detectorRoiSize",hueWeight:"detectorHueWeight",satWeight:"detectorSatWeight",valWeight:"detectorValWeight",sensitivity:"detectorSensitivity"};function yw(){const e=k.useRef(null),t=k.useRef(null),n=k.useRef(null),r=k.useRef(null),s=k.useRef(null),i=k.useRef(null),a=k.useRef(null),c=k.useRef(null),d=k.useRef(null),[h,g]=k.useState(""),[x,w]=k.useState(!1),[_,D]=k.useState({camA:"None",camB:"None",merged:"None"}),[I,Y]=k.useState(!0),[j,y]=k.useState(null),[A,M]=k.useState(null),b=k.useRef(null),H=k.useRef(null),R=(m,P)=>{const N=localStorage.getItem(m);if(N===null)return P;const v=parseFloat(N);return Number.isFinite(v)?v:P},[O,z]=k.useState(()=>({roiSize:(()=>{const m=R(gn.roiSize,44);return m>10?m:44})(),hueWeight:R(gn.hueWeight,4),satWeight:R(gn.satWeight,2),valWeight:R(gn.valWeight,1),sensitivity:R(gn.sensitivity,0)})),W=k.useRef(O),[X,q]=k.useState([]),[J,re]=k.useState(""),[pe,me]=k.useState("");k.useEffect(()=>{let m=!0;(async()=>{try{const T=(await navigator.mediaDevices.enumerateDevices()).filter(V=>V.kind==="videoinput");if(T.length===0){g("No cameras found");return}q(T);const F=T.slice(0,2).map(V=>V.deviceId);re(F[0]||""),me(F[1]||F[0]||""),await Se(F[0],e,c),F[1]?await Se(F[1],t,d):await Se(F[0],t,d),await ze(),await Ne("A",e,i),await Ne("B",t,a)}catch(v){if(!m)return;g((v==null?void 0:v.message)||String(v))}})();const P=()=>{try{const v=JSON.parse(localStorage.getItem("calibrationA")||"null"),T=JSON.parse(localStorage.getItem("calibrationB")||"null");v&&y({h:v.h,s:v.s,v:v.v}),T&&M({h:T.h,s:T.s,v:T.v})}catch{Qt("No existing calibrations")}};P();const N=v=>{!v||!v.key||(["calibrationA","calibrationB"].includes(v.key)&&P(),[gn.roiSize,gn.hueWeight,gn.satWeight,gn.valWeight,gn.sensitivity].includes(v.key)&&z(T=>({roiSize:(()=>{const F=R(gn.roiSize,(T==null?void 0:T.roiSize)??44);return F>10?F:(T==null?void 0:T.roiSize)??44})(),hueWeight:R(gn.hueWeight,(T==null?void 0:T.hueWeight)??4),satWeight:R(gn.satWeight,(T==null?void 0:T.satWeight)??2),valWeight:R(gn.valWeight,(T==null?void 0:T.valWeight)??1),sensitivity:R(gn.sensitivity,(T==null?void 0:T.sensitivity)??0)})))};return window.addEventListener("storage",N),()=>{if(m=!1,i.current&&(i.current.stop(),i.current=null),a.current&&(a.current.stop(),a.current=null),c.current&&(c.current.getTracks().forEach(F=>F.stop()),c.current=null),d.current&&(d.current.getTracks().forEach(F=>F.stop()),d.current=null),s.current){try{s.current.close()}catch{}s.current=null}const v=e.current;v&&(v.srcObject=null);const T=t.current;T&&(T.srcObject=null),window.removeEventListener("storage",N)}},[]);const Se=async(m,P,N)=>{const v={video:{deviceId:{exact:m}}};Qt("Starting camera with deviceId:",m);const T=await navigator.mediaDevices.getUserMedia(v);N.current=T;const F=P.current;if(!F){Qt("Video element not found!");return}F.srcObject=T,Qt("Stream assigned to video element, waiting for metadata..."),await new Promise(V=>{if(F.readyState>=2&&F.videoWidth>0&&F.videoHeight>0)return Qt("Video already ready:",F.videoWidth,"x",F.videoHeight),V();const ce=()=>{Qt("loadedmetadata event fired:",F.videoWidth,"x",F.videoHeight),F.removeEventListener("loadedmetadata",ce),V()};F.addEventListener("loadedmetadata",ce,{once:!0}),setTimeout(()=>{Qt("Metadata timeout - proceeding anyway"),F.removeEventListener("loadedmetadata",ce),V()},2e3)});try{await F.play(),Qt("Video play() succeeded")}catch(V){Qt("Video play() failed:",V)}},ie=k.useRef(null),ne=k.useRef(null),ee=k.useRef(null),he=k.useRef(!1),_e=async()=>{if(!he.current){he.current=!0;try{for(;ne.current||ee.current;){const m=s.current;if(!m)break;let P=null,N=null;if(ne.current?(P="A",N=ne.current,ne.current=null):ee.current&&(P="B",N=ee.current,ee.current=null),!!N){ie.current=P;try{await m.send({image:N})}catch(v){console.error("[Detector2] hands.send error:",v);break}}}}finally{he.current=!1}}},We=(m,P)=>{m==="A"?ne.current=P:ee.current=P,Promise.resolve().then(_e)},ze=async()=>{if(s.current)return s.current;try{const m=await(async()=>{try{if(typeof gc.Hands=="function")return gc.Hands}catch{}if(typeof window<"u"&&window.Hands&&typeof window.Hands=="function")return window.Hands;const N=document.getElementById("mp-hands-cdn-script");if(N&&(await new Promise(v=>{if(window.Hands&&typeof window.Hands=="function")return v();const T=setInterval(()=>{window.Hands&&typeof window.Hands=="function"&&(clearInterval(T),v())},50);setTimeout(()=>{clearInterval(T),v()},3e3)}),window.Hands&&typeof window.Hands=="function")||(N||await new Promise((v,T)=>{const F=document.createElement("script");F.id="mp-hands-cdn-script",F.src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js",F.async=!0,F.onload=()=>v(),F.onerror=V=>T(new Error("Failed to load MediaPipe Hands from CDN")),document.head.appendChild(F)}),window.Hands&&typeof window.Hands=="function"))return window.Hands;throw new Error("MediaPipe Hands constructor not available after CDN load")})(),P=new m({locateFile:N=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${N}`});return P.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5}),P.onResults(N=>{const v=ie.current;v==="A"?le(N):v==="B"&&ve(N)}),s.current=P,P}catch(m){return console.error("MediaPipe initialization error:",m),g(`MediaPipe error: ${m.message}`),null}},Ne=async(m,P,N)=>{if(!await ze())return;const T=P.current;if(!T){Qt(`Video ref for ${m} not found`);return}Qt(`Initializing manual frame capture for camera ${m}, video dimensions:`,T.videoWidth,"x",T.videoHeight);let F=null;const V=()=>{const Z=P.current;Z&&Z.readyState>=2&&Z.videoWidth>0&&We(m,Z),F=requestAnimationFrame(V)};F=requestAnimationFrame(V),N.current={stop:()=>{F&&(cancelAnimationFrame(F),F=null,Qt(`Stopped manual frame capture for camera ${m}`))}},Qt(`Manual frame capture started for camera ${m}`)},De=k.useRef({wristY:null,player:"None",landmarks:null,wristX:null}),se=k.useRef({wristY:null,player:"None",landmarks:null,wristX:null});k.useEffect(()=>{b.current=j},[j]),k.useEffect(()=>{H.current=A},[A]),k.useEffect(()=>{W.current=O},[O]);const le=m=>fe(m,n,"A"),ve=m=>fe(m,r,"B"),fe=(m,P,N)=>{var ct;const v=P.current;if(!v)return;const T=v.getContext("2d");if(!T)return;const F=N==="A"?e.current:t.current;if(!F||F.videoWidth===0||F.videoHeight===0){N==="A"?De.current={wristY:null,wristX:null,landmarks:null,player:"None"}:se.current={wristY:null,wristX:null,landmarks:null,player:"None"};return}v.width=F.videoWidth,v.height=F.videoHeight,T.drawImage(F,0,0,v.width,v.height),T.fillStyle="rgba(0, 0, 0, 0.6)",T.fillRect(v.width-80,5,75,20),T.fillStyle="white",T.font="bold 14px Arial",T.fillText(`Camera ${N}`,v.width-75,20);let V=null,Z=null,ce=null,Ee=[];if(m.multiHandLandmarks&&m.multiHandLandmarks.length>0)for(const Ge of m.multiHandLandmarks){const Ue=Ge[0],Ve=Ue.x*v.width,Ze=Ue.y*v.height;Ee.push({x:Ve,y:Ze,landmarks:Ge}),(V===null||(I?Ze<V:Ze>V))&&(V=Ze,Z=Ge,ce=Ve)}Ee.forEach(({x:Ge,y:Ue})=>{T.fillStyle="orange",T.beginPath(),T.arc(Ge,Ue,8,0,Math.PI*2),T.fill()});let Be="None";if(Z){T.fillStyle="lime",T.beginPath(),T.arc(ce,V,10,0,2*Math.PI),T.fill(),T.fillStyle="lime",T.font="16px Arial",T.fillText("SELECTED",ce-40,V-15);const Ue=Math.max(10,Math.min(300,Math.floor(((ct=W.current)==null?void 0:ct.roiSize)||60)))/2,Ve=Math.max(0,ce-Ue),Ze=Math.max(0,V-Ue),Ct=Math.min(v.width,ce+Ue),On=Math.min(v.height,V+Ue),mt=Math.max(0,Math.floor(Ve)),Dt=Math.max(0,Math.floor(Ze));let Pt=Math.floor(Ct-Ve),tn=Math.floor(On-Ze);if(Pt=Math.max(1,Pt),tn=Math.max(1,tn),Pt=Math.min(Pt,v.width-mt),tn=Math.min(tn,v.height-Dt),Pt>0&&tn>0){T.strokeStyle="lime",T.lineWidth=3,T.strokeRect(mt,Dt,Pt,tn);try{const ln=T.getImageData(mt,Dt,Pt,tn),cn=b.current,En=H.current;Be=G(ln,cn,En).status}catch(ln){console.warn("[Detector2] ROI sampling failed:",ln),Be="None"}}else Qt("ROI skipped due to zero width/height",{width:Pt,height:tn,left:mt,top:Dt})}if(Ee.length>=1){let Ge=Ee[0].y,Ue=Ee[0].y;Ee.forEach(Ct=>{Ct.y<Ge&&(Ge=Ct.y),Ct.y>Ue&&(Ue=Ct.y)}),T.strokeStyle="yellow",T.setLineDash([6,4]),T.beginPath(),T.moveTo(0,I?Ge:Ue),T.lineTo(v.width,I?Ge:Ue),T.stroke(),T.strokeStyle="cyan",T.beginPath(),T.moveTo(0,I?Ue:Ge),T.lineTo(v.width,I?Ue:Ge),T.stroke(),T.setLineDash([]);const Ve=I?"A (top)":"A (bottom)",Ze=I?"B (bottom)":"B (top)";T.fillStyle="lime",T.font="16px Arial",T.fillText(Ve,6,Math.max(14,(I?Ge:Ue)-6)),T.fillStyle="dodgerblue",T.fillText(Ze,6,Math.min(v.height-6,(I?Ue:Ge)+18))}const Fe={wristY:V,wristX:ce,landmarks:Z,player:Be};N==="A"?De.current=Fe:se.current=Fe;const nt=De.current.wristY,qe=se.current.wristY;let lt="None";if(nt!=null||qe!=null){const Ge=I?(Ve,Ze)=>Ve==null?Ze:Math.min(Ve,Ze):(Ve,Ze)=>Ve==null?Ze:Math.max(Ve,Ze);[nt,qe].filter(Ve=>Ve!=null).reduce(Ge,null)===nt?lt=De.current.player:lt=se.current.player}D({camA:De.current.player,camB:se.current.player,merged:lt})},U=(m,P,N)=>{m/=255,P/=255,N/=255;const v=Math.max(m,P,N),T=Math.min(m,P,N),F=v-T;let V=0;F!==0&&(v===m?V=60*((P-N)/F%6):v===P?V=60*((N-m)/F+2):V=60*((m-P)/F+4)),V<0&&(V+=360);const Z=v===0?0:F/v*255,ce=v*255;return[V/2,Z,ce]},G=(m,P,N)=>{var ce,Ee,Be,Fe;const v=m.data;if(P&&!N)return{status:"Player A",percentA:null,percentB:null};if(N&&!P)return{status:"Player B",percentA:null,percentB:null};const T=((ce=W.current)==null?void 0:ce.hueWeight)??4,F=((Ee=W.current)==null?void 0:Ee.satWeight)??2,V=((Be=W.current)==null?void 0:Be.valWeight)??1,Z=((Fe=W.current)==null?void 0:Fe.sensitivity)??0;if(P&&N){let nt=0,qe=0,lt=0;for(let Ve=0;Ve<v.length;Ve+=4){const Ze=v[Ve],Ct=v[Ve+1],On=v[Ve+2],[mt,Dt,Pt]=U(Ze,Ct,On),tn=Math.min(1,Math.max(0,Dt/255)),ln=Math.min(1,Math.max(0,Pt/255)),cn=Math.max(.05,.5*tn+.5*ln),En=Math.min(Math.abs(mt-P.h),180-Math.abs(mt-P.h)),Cn=Math.min(Math.abs(mt-N.h),180-Math.abs(mt-N.h)),Jr=Math.abs(Dt-P.s),Fr=Math.abs(Dt-N.s),$n=Math.abs(Pt-P.v),Dn=Math.abs(Pt-N.v),ys=En*T+Jr*F+$n*V,zn=Cn*T+Fr*F+Dn*V;Math.min(ys,zn)>180||(ys<=zn?nt+=cn:qe+=cn,lt+=cn)}if(lt===0)return{status:"None",percentA:0,percentB:0};const ct=nt/Math.max(1e-6,lt),Ge=qe/Math.max(1e-6,lt),Ue=.12*(1+.8*Math.max(0,Math.min(1,Z)));return ct>=Ue&&ct>=Ge?{status:"Player A",percentA:ct,percentB:Ge}:Ge>=Ue&&Ge>ct?{status:"Player B",percentA:ct,percentB:Ge}:{status:"None",percentA:ct,percentB:Ge}}return{status:"None",percentA:0,percentB:0}},Q=(m,P,N)=>{const v=(m||0)*2,T=(P||0)/255,F=(N||0)/255,V=F*T,Z=V*(1-Math.abs(v/60%2-1)),ce=F-V;let Ee=0,Be=0,Fe=0;v>=0&&v<60?(Ee=V,Be=Z,Fe=0):v<120?(Ee=Z,Be=V,Fe=0):v<180?(Ee=0,Be=V,Fe=Z):v<240?(Ee=0,Be=Z,Fe=V):v<300?(Ee=Z,Be=0,Fe=V):(Ee=V,Be=0,Fe=Z);const nt=Math.round((Ee+ce)*255),qe=Math.round((Be+ce)*255),lt=Math.round((Fe+ce)*255);return`rgb(${nt}, ${qe}, ${lt})`},te=m=>m?Q(m.h,m.s,m.v):"#ffffff",$=async(m,P)=>{try{if(m==="A"){if(re(P),i.current){try{i.current.stop()}catch(v){Qt("Stop camA error:",v)}i.current=null}c.current&&(c.current.getTracks().forEach(v=>v.stop()),c.current=null);const N=e.current;N&&(N.srcObject=null),await new Promise(v=>setTimeout(v,100)),await Se(P,e,c),await new Promise(v=>setTimeout(v,200)),await ze(),await Ne("A",e,i),Qt("Camera A switched to:",P)}else{if(me(P),a.current){try{a.current.stop()}catch(v){Qt("Stop camB error:",v)}a.current=null}d.current&&(d.current.getTracks().forEach(v=>v.stop()),d.current=null);const N=t.current;N&&(N.srcObject=null),await new Promise(v=>setTimeout(v,100)),await Se(P,t,d),await new Promise(v=>setTimeout(v,200)),await ze(),await Ne("B",t,a),Qt("Camera B switched to:",P)}}catch(N){console.error("[Detector2] Camera switch error:",N),g(`Camera switch error: ${N.message}`)}};return l.jsxs("div",{className:`detector-window ${x?"minimized":""}`,children:[l.jsxs("div",{className:"detector-header",children:[l.jsx("span",{children:"Bracelet Detector 2 (Two Cameras)"}),l.jsxs("div",{className:"detector-controls",children:[l.jsx("button",{onClick:()=>w(!x),children:x?"":""}),l.jsx("button",{onClick:()=>Y(!I),title:"Toggle A criterion",children:I?"A=Top":"A=Bottom"})]})]}),l.jsxs("div",{className:"detector-content",style:{display:x?"none":"block"},children:[l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera A:"}),l.jsx("select",{value:J,onChange:m=>$("A",m.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:X.map(m=>l.jsx("option",{value:m.deviceId,children:m.label||`Camera ${m.deviceId.slice(0,8)}`},m.deviceId))})]}),l.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:n,className:"output_canvas"})]}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{fontSize:12,opacity:.8,marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{children:"Camera B:"}),l.jsx("select",{value:pe,onChange:m=>$("B",m.target.value),style:{fontSize:10,padding:"2px 4px",maxWidth:120},children:X.map(m=>l.jsx("option",{value:m.deviceId,children:m.label||`Camera ${m.deviceId.slice(0,8)}`},m.deviceId))})]}),l.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:"-9999px",left:"-9999px",width:1,height:1}}),l.jsx("canvas",{ref:r,className:"output_canvas"})]})]}),l.jsxs("div",{className:"detector-info",style:{marginTop:8},children:[l.jsxs("div",{className:"status-display",children:["Merged: ",l.jsx("strong",{children:_.merged})]}),l.jsxs("div",{className:"color-swatches",style:{display:"flex",alignItems:"center",gap:12,marginTop:4},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"A"}),l.jsx("span",{title:"Player A calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:j?te(j):"#444"}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[l.jsx("span",{style:{fontSize:12,opacity:.8},children:"B"}),l.jsx("span",{title:"Player B calibrated color",style:{width:14,height:14,borderRadius:3,border:"1px solid #666",display:"inline-block",background:A?te(A):"#444"}})]})]}),l.jsxs("div",{className:"calib-summary",style:{fontSize:12,opacity:.8,marginTop:4,lineHeight:1.4},children:[l.jsxs("div",{children:["A: ",j?`h${Math.round(j.h)} s${Math.round(j.s)} v${Math.round(j.v)}`:""]}),l.jsxs("div",{children:["B: ",A?`h${Math.round(A.h)} s${Math.round(A.s)} v${Math.round(A.v)}`:""]})]}),h&&l.jsxs("div",{style:{color:"#f55",marginTop:4},children:["Camera error: ",h]}),l.jsxs("div",{style:{fontSize:12,marginTop:6},children:[l.jsx("strong",{children:"Note:"})," Detects topmost hand across both cameras. Use A=Top/A=Bottom to switch criterion."]})]})]})]})}const Jo=Ga(),S1=e=>{var i,a,c,d,h;if(!e)return null;const t=Array.isArray(e.moves)?e.moves:[],n=t.reduce((g,x)=>typeof x.elapsed=="number"&&x.elapsed>g?x.elapsed:g,0),r={},s={};return t.forEach(g=>{const x=(g==null?void 0:g.player)||"Unknown";r[x]=(r[x]||0)+1;const w=(g==null?void 0:g.phase)||"unknown";s[w]=(s[w]||0)+1}),{startTime:((i=e.sessionInfo)==null?void 0:i.startedAt)||((c=(a=e.metadata)==null?void 0:a.config)==null?void 0:c.date)||e.createdAt,endTime:((d=e.sessionInfo)==null?void 0:d.endedAt)||e.updatedAt,duration:n,sessionInfo:{...((h=e.metadata)==null?void 0:h.config)||{},...e.sessionInfo||{},sessionGameId:e.sessionGameId,subjectId:e.subjectId,condition:e.condition,date:e.date,createdAt:e.createdAt,updatedAt:e.updatedAt},moves:t,braceletHistory:e.braceletHistory||[],summary:{totalMoves:t.length,movesByPlayer:r,movesByPhase:s}}},vw=e=>{if(!e)return"";try{const t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toLocaleString()}catch{}return e},k1="adminPassword";function xw(){var X;const[e,t]=k.useState([]),[n,r]=k.useState(!0),[s,i]=k.useState(null),[a,c]=k.useState(null),[d,h]=k.useState(null),[g,x]=k.useState(!1),[w,_]=k.useState(null),[D,I]=k.useState(!1),[Y,j]=k.useState(""),[y,A]=k.useState(!1);k.useEffect(()=>{const q=localStorage.getItem(k1);q&&j(q)},[]);const M=k.useCallback(async()=>{if(!Y){i("Password required"),r(!1);return}r(!0),i(null),A(!1);try{const q=await fetch(`${Jo}/sessions`,{headers:{"x-admin-password":Y}});if(q.status===401||q.status===403)throw A(!0),new Error("Invalid password");if(!q.ok)throw new Error(`Failed to load sessions (${q.status})`);const J=await q.json(),re=Array.isArray(J)?J:[];localStorage.setItem(k1,Y),t(re),c(pe=>pe&&re.some(me=>me.sessionGameId===pe)?pe:re.length>0?re[0].sessionGameId:null)}catch(q){console.error("[Admin] Error fetching sessions:",q),i(q.message||"Failed to load sessions"),t([]),c(null)}finally{r(!1)}},[Y]);k.useEffect(()=>{M()},[M]),k.useEffect(()=>{if(!a){h(null);return}let q=!1;return(async()=>{if(Y){x(!0),_(null);try{const re=await fetch(`${Jo}/sessions/${encodeURIComponent(a)}`,{headers:{"x-admin-password":Y}});if(!re.ok)throw re.status===404?new Error("Session not found"):new Error(`Failed to load session (${re.status})`);const pe=await re.json();q||h(S1(pe))}catch(re){console.error("[Admin] Error fetching session detail:",re),q||(_(re.message||"Failed to load session"),h(null))}finally{q||x(!1)}}})(),()=>{q=!0}},[a]);const b=q=>{c(q),I(!1)},H=async()=>{if(!a||!Y)return;const q=!D;I(q),x(!0),_(null);try{const J=q?`${Jo}/sessions/${encodeURIComponent(a)}/experiment-only`:`${Jo}/sessions/${encodeURIComponent(a)}`,re=await fetch(J,{headers:{"x-admin-password":Y}});if(!re.ok)throw new Error(`Failed to load session data (${re.status})`);const pe=await re.json();h(S1(pe))}catch(J){console.error("[Admin] Error loading session data:",J),_(J.message||"Failed to load session data"),I(!q)}finally{x(!1)}},R=()=>{a&&(window.location.hash=`#/admin/edit-moves/${encodeURIComponent(a)}`)},O=()=>{if(!d)return;const q=JSON.stringify(d,null,2),J=new Blob([q],{type:"application/json"}),re=URL.createObjectURL(J),pe=document.createElement("a");pe.href=re;const me=`${a}_${new Date().toISOString().split("T")[0]}.json`;pe.download=me,pe.click(),URL.revokeObjectURL(re),console.log("[Admin] Downloaded JSON:",me)},z=()=>{if(!d||!d.moves||d.moves.length===0){alert("No moves to export");return}const q=new Set;d.moves.forEach(ee=>{Object.keys(ee).forEach(he=>{he!=="camera_frame"&&he!=="__v"&&q.add(he)})});const J=Array.from(q),re=[J.join(",")];d.moves.forEach(ee=>{const he=J.map(_e=>{const We=ee[_e];return We==null||We===""?"":Array.isArray(We)||typeof We=="object"?`"${JSON.stringify(We).replace(/"/g,'""')}"`:`"${String(We).replace(/"/g,'""')}"`});re.push(he.join(","))});const pe=re.join(`
`),me=new Blob([pe],{type:"text/csv;charset=utf-8;"}),Se=URL.createObjectURL(me),ie=document.createElement("a");ie.href=Se;const ne=`${a}_${new Date().toISOString().split("T")[0]}.csv`;ie.download=ne,ie.click(),URL.revokeObjectURL(Se),console.log("[Admin] Downloaded CSV:",ne)},W=async(q,J)=>{if(!(!a||!q||!Y))try{const re=await fetch(`${Jo}/sessions/${encodeURIComponent(a)}/moves/${encodeURIComponent(q)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":Y},body:JSON.stringify({player:J})});if(!re.ok)throw new Error(`Failed to update player (${re.status})`);h(pe=>pe&&{...pe,moves:pe.moves.map(me=>me._id===q?{...me,player:J}:me)}),console.log("[Admin] Player updated:",q,J)}catch(re){console.error("[Admin] Error updating player:",re),alert("Failed to update player: "+re.message)}};return l.jsxs("div",{className:"admin-container",children:[l.jsxs("aside",{className:"admin-sidebar",children:[l.jsxs("div",{className:"admin-sidebar-header",children:[l.jsx("h1",{children:"Admin"}),l.jsxs("div",{className:"admin-password-row",children:[l.jsx("input",{type:"password",className:`admin-password-input ${y?"error":""}`,placeholder:"Password",value:Y,onChange:q=>j(q.target.value),onKeyPress:q=>{q.key==="Enter"&&M()}}),l.jsx("button",{className:"admin-refresh-button",onClick:M,disabled:n||!Y,children:n?"Refreshing":"Refresh"})]})]}),s&&l.jsx("div",{className:"admin-error",children:s}),l.jsxs("div",{className:"admin-session-list",children:[n&&e.length===0&&l.jsx("div",{className:"admin-status",children:"Loading sessions"}),!n&&e.length===0&&!s&&l.jsx("div",{className:"admin-status",children:"No sessions found."}),e.map(q=>{const J=typeof q.movesCount=="number"?q.movesCount:Array.isArray(q.moves)?q.moves.length:0,re=q.sessionGameId===a;return l.jsxs("button",{className:`admin-session-card ${re?"active":""}`,onClick:()=>b(q.sessionGameId),children:[l.jsx("div",{className:"admin-session-id",children:q.sessionGameId}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Participant: ",q.subjectId||""]}),l.jsxs("span",{children:["Condition: ",q.condition||""]})]}),l.jsxs("div",{className:"admin-session-meta",children:[l.jsxs("span",{children:["Moves: ",J]}),l.jsxs("span",{children:["Updated: ",vw(q.updatedAt)]})]})]},q.sessionGameId)})]})]}),l.jsxs("main",{className:"admin-content",children:[g&&l.jsx("div",{className:"admin-status admin-status--content",children:"Loading session"}),w&&l.jsx("div",{className:"admin-error admin-error--content",children:w}),!g&&!w&&d&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"admin-toolbar",children:[l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--primary",children:[l.jsx("button",{className:"admin-toolbar-button back-button",onClick:()=>{window.location.hash="/"},title:"Return to start dialog",children:" Back"}),l.jsx("button",{className:`admin-toolbar-button experiment-toggle ${D?"active":""}`,onClick:H,title:D?"Show all moves (including practice)":"Show only experiment phase moves",children:D?"Show All Moves":"Experiment Only"}),l.jsx("button",{className:"admin-toolbar-button edit-players",onClick:R,title:"Open dedicated editor for player assignments",children:"Edit Players"})]}),l.jsxs("div",{className:"admin-toolbar-group admin-toolbar-group--secondary",children:[l.jsx("button",{className:"admin-toolbar-button download-json",onClick:O,title:"Download session data as JSON",children:"Download JSON"}),l.jsx("button",{className:"admin-toolbar-button download-csv",onClick:z,title:"Download moves as CSV",children:"Download CSV"})]})]}),l.jsx("div",{className:"admin-summary-wrapper",children:l.jsx(ny,{initialData:d,enableFileUpload:!1,className:"embedded-summary",title:`Session ${((X=d.sessionInfo)==null?void 0:X.sessionGameId)||a||""}${D?" (Experiment Only)":""}`,sessionGameId:a,onPlayerUpdate:W})})]}),!g&&!w&&!d&&l.jsx("div",{className:"admin-status admin-status--content",children:"Select a session to view its moves."})]})]})}const A1="adminPassword";function ww(){const[e,t]=k.useState(null),[n,r]=k.useState(!1),[s,i]=k.useState(null),[a,c]=k.useState(null),[d,h]=k.useState(null),[g,x]=k.useState(""),[w,_]=k.useState(!1);k.useEffect(()=>{const Y=localStorage.getItem(A1);Y&&x(Y)},[]);const D=Y=>{const j=Y.target.files[0];if(!j)return;if(!j.name.endsWith(".json")){c("Please select a JSON file"),t(null);return}t(j),c(null),i(null);const y=new FileReader;y.onload=A=>{var M;try{const b=JSON.parse(A.target.result);h({sessionGameId:b.sessionGameId||"N/A",subjectId:b.subjectId||"N/A",condition:b.condition||"N/A",date:b.date||"N/A",movesCount:((M=b.moves)==null?void 0:M.length)||0,hasColorA:!!b.colorA,hasColorB:!!b.colorB})}catch(b){c("Invalid JSON file: "+b.message),h(null)}},y.readAsText(j)},I=async()=>{var Y;if(!e){c("Please select a file first");return}r(!0),c(null),i(null);try{const j=await new Promise((H,R)=>{const O=new FileReader;O.onload=z=>H(z.target.result),O.onerror=R,O.readAsText(e)}),y=JSON.parse(j);if(!y.sessionGameId||!y.subjectId)throw new Error("Missing required fields: sessionGameId and subjectId are required");if(!g)throw new Error("Admin password is required. Please enter it below.");const A=await fetch(`${Ga()}/admin/upload`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":g},body:JSON.stringify(y)}),M=await A.json();if(A.status===401||A.status===403)throw _(!0),new Error(M.message||"Invalid admin password");if(!A.ok)throw new Error(M.message||"Upload failed");localStorage.setItem(A1,g),_(!1),i(` Successfully uploaded session "${y.sessionGameId}" with ${((Y=y.moves)==null?void 0:Y.length)||0} moves`),t(null),h(null);const b=document.getElementById("json-file-input");b&&(b.value="")}catch(j){c(j.message||"Failed to upload file")}finally{r(!1)}};return l.jsx("div",{className:"admin-upload-container",children:l.jsxs("div",{className:"admin-upload-card",children:[l.jsx("h1",{children:"Admin: Upload Session JSON"}),l.jsx("p",{className:"admin-upload-description",children:"Upload a session JSON file to the server. The file will be validated to ensure it matches the expected format."}),l.jsxs("div",{className:"admin-upload-form",children:[l.jsxs("div",{className:"password-input-wrapper",children:[l.jsx("label",{htmlFor:"admin-password",children:"Admin Password:"}),l.jsx("input",{id:"admin-password",type:"password",value:g,onChange:Y=>{x(Y.target.value),_(!1)},placeholder:"Enter admin password",className:w?"error":""}),w&&l.jsx("span",{className:"password-error-hint",children:"Invalid password"})]}),l.jsxs("div",{className:"file-input-wrapper",children:[l.jsx("input",{id:"json-file-input",type:"file",accept:".json",onChange:D,disabled:n}),l.jsx("label",{htmlFor:"json-file-input",className:"file-input-label",children:e?e.name:"Choose JSON File"})]}),d&&l.jsxs("div",{className:"file-preview",children:[l.jsx("h3",{children:"File Preview"}),l.jsxs("div",{className:"preview-grid",children:[l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Session ID:"})," ",d.sessionGameId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Subject ID:"})," ",d.subjectId]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Condition:"})," ",d.condition]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Date:"})," ",d.date]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Moves:"})," ",d.movesCount]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color A:"})," ",d.hasColorA?"":""]}),l.jsxs("div",{className:"preview-item",children:[l.jsx("strong",{children:"Color B:"})," ",d.hasColorB?"":""]})]})]}),a&&l.jsxs("div",{className:"error-message",children:[l.jsx("strong",{children:"Error:"})," ",a]}),s&&l.jsx("div",{className:"success-message",children:s}),l.jsx("button",{className:"upload-button",onClick:I,disabled:!e||!g||n,children:n?"Uploading...":"Upload to Server"})]})]})})}var gi=typeof self<"u"?self:{};function ei(){throw Error("Invalid UTF8")}function E1(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let kl,nd;const Sw=typeof TextDecoder<"u";let kw;const Aw=typeof TextEncoder<"u";function ry(e){if(Aw)e=(kw||(kw=new TextEncoder)).encode(e);else{let n=0;const r=new Uint8Array(3*e.length);for(let s=0;s<e.length;s++){var t=e.charCodeAt(s);if(t<128)r[n++]=t;else{if(t<2048)r[n++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&s<e.length){const i=e.charCodeAt(++s);if(i>=56320&&i<=57343){t=1024*(t-55296)+i-56320+65536,r[n++]=t>>18|240,r[n++]=t>>12&63|128,r[n++]=t>>6&63|128,r[n++]=63&t|128;continue}s--}t=65533}r[n++]=t>>12|224,r[n++]=t>>6&63|128}r[n++]=63&t|128}}e=n===r.length?r:r.subarray(0,n)}return e}var _h,yc;e:{for(var C1=["CLOSURE_FLAGS"],rd=gi,sd=0;sd<C1.length;sd++)if((rd=rd[C1[sd]])==null){yc=null;break e}yc=rd}var La,j1=yc&&yc[610401301];_h=j1!=null&&j1;const _1=gi.navigator;function mf(e){return!!_h&&!!La&&La.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function fr(e){var t;return(t=gi.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function _s(){return!!_h&&!!La&&La.brands.length>0}function id(){return _s()?mf("Chromium"):(fr("Chrome")||fr("CriOS"))&&!(!_s()&&fr("Edge"))||fr("Silk")}function Nh(e){return Nh[" "](e),e}La=_1&&_1.userAgentData||null,Nh[" "]=function(){};var Ew=!_s()&&(fr("Trident")||fr("MSIE"));!fr("Android")||id(),id(),fr("Safari")&&(id()||!_s()&&fr("Coast")||!_s()&&fr("Opera")||!_s()&&fr("Edge")||(_s()?mf("Microsoft Edge"):fr("Edg/"))||_s()&&mf("Opera"));var sy={},sa=null;function Cw(e){const t=e.length;let n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);const r=new Uint8Array(n);let s=0;return function(i,a){function c(h){for(;d<i.length;){const g=i.charAt(d++),x=sa[g];if(x!=null)return x;if(!/^[\s\xa0]*$/.test(g))throw Error("Unknown base64 encoding at char: "+g)}return h}iy();let d=0;for(;;){const h=c(-1),g=c(0),x=c(64),w=c(64);if(w===64&&h===-1)break;a(h<<2|g>>4),x!=64&&(a(g<<4&240|x>>2),w!=64&&a(x<<6&192|w))}}(e,function(i){r[s++]=i}),s!==n?r.subarray(0,s):r}function iy(){if(!sa){sa={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let n=0;n<5;n++){const r=e.concat(t[n].split(""));sy[n]=r;for(let s=0;s<r.length;s++){const i=r[s];sa[i]===void 0&&(sa[i]=s)}}}}var oy=typeof Uint8Array<"u",ay=!Ew&&typeof btoa=="function";function N1(e){if(!ay){var t;t===void 0&&(t=0),iy(),t=sy[t];var n=Array(Math.floor(e.length/3)),r=t[64]||"";let d=0,h=0;for(;d<e.length-2;d+=3){var s=e[d],i=e[d+1],a=e[d+2],c=t[s>>2];s=t[(3&s)<<4|i>>4],i=t[(15&i)<<2|a>>6],a=t[63&a],n[h++]=c+s+i+a}switch(c=0,a=r,e.length-d){case 2:a=t[(15&(c=e[d+1]))<<2]||r;case 1:e=e[d],n[h]=t[e>>2]+t[(3&e)<<4|c>>4]+a+r}return n.join("")}for(t="",n=0,r=e.length-10240;n<r;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const b1=/[-_.]/g,jw={"-":"+",_:"/",".":"="};function _w(e){return jw[e]||""}function ly(e){if(!ay)return Cw(e);b1.test(e)&&(e=e.replace(b1,_w)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function Va(e){return oy&&e!=null&&e instanceof Uint8Array}var mo={};function yi(){return Nw||(Nw=new os(null,mo))}function bh(e){cy(mo);var t=e.g;return(t=t==null||Va(t)?t:typeof t=="string"?ly(t):null)==null?t:e.g=t}var os=class{h(){return new Uint8Array(bh(this)||0)}constructor(e,t){if(cy(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let Nw,bw;function cy(e){if(e!==mo)throw Error("illegal external caller")}function uy(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function gf(e){return uy(e=Error(e),"warning"),e}var Gc=typeof Symbol=="function"&&typeof Symbol()=="symbol",Mw=new Set;function Ya(e,t,n=!1,r=!1){return e=typeof Symbol=="function"&&typeof Symbol()=="symbol"?r&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t,n&&Mw.add(e),e}var Pw=Ya("jas",void 0,!0,!0),M1=Ya(void 0,"0di"),od=Ya(void 0,"2ex"),qo=Ya(void 0,"1oa",!0),go=Ya(void 0,Symbol(),!0);const Te=Gc?Pw:"Ga",dy={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},fy=Object.defineProperties;function Vc(e,t){Gc||Te in e||fy(e,dy),e[Te]|=t}function Ut(e,t){Gc||Te in e||fy(e,dy),e[Te]=t}function No(e){return Vc(e,34),e}function Tw(e,t){Ut(t,-30975&(0|e))}function yf(e,t){Ut(t,-30941&(34|e))}function Mh(){return typeof BigInt=="function"}function Rn(e){return Array.prototype.slice.call(e)}var Ph,Xa={},hy={};function P1(e){return!(!e||typeof e!="object"||e.Ia!==hy)}function Th(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function Ih(e,t){if(e!=null){if(typeof e=="string")e=e?new os(e,mo):yi();else if(e.constructor!==os)if(Va(e))e=e.length?new os(new Uint8Array(e),mo):yi();else{if(!t)throw Error();e=void 0}}return e}function vc(e){return!(!Array.isArray(e)||e.length)&&!!(1&(0|e[Te]))}const T1=[];function Xs(e){if(2&e)throw Error()}Ut(T1,55),Ph=Object.freeze(T1);class xc{constructor(t,n,r){this.l=0,this.g=t,this.h=n,this.m=r}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new xc(this.g,this.h,this.m)}}function Bh(e){return go?e[go]:void 0}var Iw=Object.freeze({});function Yc(e){return e.Qa=!0,e}var Bw=Yc(e=>typeof e=="number"),I1=Yc(e=>typeof e=="string"),Rw=Yc(e=>typeof e=="boolean"),Xc=typeof gi.BigInt=="function"&&typeof gi.BigInt(0)=="bigint",vf=Yc(e=>Xc?e>=Fw&&e<=$w:e[0]==="-"?B1(e,Lw):B1(e,Ow));const Lw=Number.MIN_SAFE_INTEGER.toString(),Fw=Xc?BigInt(Number.MIN_SAFE_INTEGER):void 0,Ow=Number.MAX_SAFE_INTEGER.toString(),$w=Xc?BigInt(Number.MAX_SAFE_INTEGER):void 0;function B1(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r>s)return!1;if(r<s)return!0}}const Dw=typeof Uint8Array.prototype.slice=="function";let py,ut=0,Rt=0;function R1(e){const t=e>>>0;ut=t,Rt=(e-t)/4294967296>>>0}function yo(e){if(e<0){R1(-e);const[t,n]=Oh(ut,Rt);ut=t>>>0,Rt=n>>>0}else R1(e)}function Rh(e){const t=py||(py=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),Rt=0,ut=t.getUint32(0,!0)}function Lh(e,t){const n=4294967296*t+(e>>>0);return Number.isSafeInteger(n)?n:Fa(e,t)}function Fh(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=Lh(e,t))=="number"?n?-e:e:n?"-"+e:e}function Fa(e,t){if(e>>>=0,(t>>>=0)<=2097151)var n=""+(4294967296*t+e);else Mh()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,e>=1e7&&(n+=e/1e7>>>0,e%=1e7),n>=1e7&&(t+=n/1e7>>>0,n%=1e7),n=t+L1(n)+L1(e));return n}function L1(e){return e=String(e),"0000000".slice(e.length)+e}function Kc(e){if(e.length<16)yo(Number(e));else if(Mh())e=BigInt(e),ut=Number(e&BigInt(4294967295))>>>0,Rt=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");Rt=ut=0;const n=e.length;for(let r=t,s=(n-t)%6+t;s<=n;r=s,s+=6){const i=Number(e.slice(r,s));Rt*=1e6,ut=1e6*ut+i,ut>=4294967296&&(Rt+=Math.trunc(ut/4294967296),Rt>>>=0,ut>>>=0)}if(t){const[r,s]=Oh(ut,Rt);ut=r,Rt=s}}}function Oh(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const $h=typeof BigInt=="function"?BigInt.asIntN:void 0,zw=typeof BigInt=="function"?BigInt.asUintN:void 0,no=Number.isSafeInteger,Qc=Number.isFinite,wc=Math.trunc;function Ks(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function my(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const Uw=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function Jc(e){switch(typeof e){case"bigint":return!0;case"number":return Qc(e);case"string":return Uw.test(e);default:return!1}}function bo(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Qc(e)?0|e:void 0}function gy(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Qc(e)?e>>>0:void 0}function F1(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Dh(e){return e=wc(e),no(e)||(yo(e),e=Fh(ut,Rt)),e}function zh(e){var t=wc(Number(e));if(no(t))return String(t);if((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),t=e.length,!(e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337))if(Kc(e),e=ut,2147483648&(t=Rt))if(Mh())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,r]=Oh(e,t);e="-"+Fa(n,r)}else e=Fa(e,t);return e}function Sc(e){return e==null?e:typeof e=="bigint"?(vf(e)?e=Number(e):(e=$h(64,e),e=vf(e)?Number(e):String(e)),e):Jc(e)?typeof e=="number"?Dh(e):zh(e):void 0}function Hw(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(zw(64,e));if(Jc(e)){if(t==="string")return t=wc(Number(e)),no(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),F1(e)||(Kc(e),e=Fa(ut,Rt))),e;if(t==="number")return(e=wc(e))>=0&&no(e)?e:function(n){if(n<0){yo(n);var r=Fa(ut,Rt);return n=Number(r),no(n)?n:r}return F1(r=String(n))?r:(yo(n),Lh(ut,Rt))}(e)}}function yy(e){if(typeof e!="string")throw Error();return e}function Mo(e){if(e!=null&&typeof e!="string")throw Error();return e}function vo(e){return e==null||typeof e=="string"?e:void 0}function Uh(e,t,n,r){if(e!=null&&typeof e=="object"&&e.W===Xa)return e;if(!Array.isArray(e))return n?2&r?((e=t[M1])||(No((e=new t).u),e=t[M1]=e),t=e):t=new t:t=void 0,t;let s=n=0|e[Te];return s===0&&(s|=32&r),s|=2&r,s!==n&&Ut(e,s),new t(e)}function Ww(e,t,n){if(t)e:{if(!Jc(t=e))throw gf("int64");switch(typeof t){case"string":t=zh(t);break e;case"bigint":if(e=t=$h(64,t),I1(e)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(e))throw Error(String(e))}else if(Bw(e)&&!Number.isSafeInteger(e))throw Error(String(e));t=Xc?BigInt(t):Rw(t)?t?"1":"0":I1(t)?t.trim()||"0":String(t);break e;default:t=Dh(t)}}else t=Sc(e);return typeof(n=(e=t)==null?n?0:void 0:e)=="string"&&no(t=+n)?t:n}const Gw={};let Vw=function(){try{return Nh(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class ad{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const Yw=Vw?(Object.setPrototypeOf(ad.prototype,Map.prototype),Object.defineProperties(ad.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),ad):class extends Map{constructor(){super()}};function O1(e){return e}function ld(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var vr=class extends Yw{constructor(e,t,n=O1,r=O1){super();let s=0|e[Te];s|=64,Ut(e,s),this.L=s,this.S=t,this.R=n,this.Y=this.S?Xw:r;for(let i=0;i<e.length;i++){const a=e[i],c=n(a[0],!1,!0);let d=a[1];t?d===void 0&&(d=null):d=r(a[1],!1,!0,void 0,void 0,s),super.set(c,d)}}na(e=$1){if(this.size!==0)return this.X(e)}X(e=$1){const t=[],n=super.entries();for(var r;!(r=n.next()).done;)(r=r.value)[0]=e(r[0]),r[1]=e(r[1]),t.push(r);return t}clear(){ld(this),super.clear()}delete(e){return ld(this),super.delete(this.R(e,!0,!1))}entries(){var e=this.ma();return new xc(e,Kw,this)}keys(){return this.Ha()}values(){var e=this.ma();return new xc(e,vr.prototype.get,this)}forEach(e,t){super.forEach((n,r)=>{e.call(t,this.get(r),r,this)})}set(e,t){return ld(this),(e=this.R(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Y(t,!0,!0,this.S,!1,this.L))}Na(e){const t=this.R(e[0],!1,!0);e=e[1],e=this.S?e===void 0?null:e:this.Y(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.R(e,!1,!1))}get(e){e=this.R(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.S;return n?((n=this.Y(t,!1,!0,n,this.ra,this.L))!==t&&super.set(e,n),n):t}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function Xw(e,t,n,r,s,i){return e=Uh(e,r,n,i),s&&(e=Zc(e)),e}function $1(e){return e}function Kw(e){return[e,this.get(e)]}let Qw,vy,Jw;function D1(){return Qw||(Qw=new vr(No([]),void 0,void 0,void 0,Gw))}function Hh(e,t,n,r,s){if(e!=null){if(Array.isArray(e))e=vc(e)?void 0:s&&2&(0|e[Te])?e:Wh(e,t,n,r!==void 0,s);else if(Th(e)){const i={};for(let a in e)i[a]=Hh(e[a],t,n,r,s);e=i}else e=t(e,r);return e}}function Wh(e,t,n,r,s){const i=r||n?0|e[Te]:0,a=r?!!(32&i):void 0;r=Rn(e);for(let c=0;c<r.length;c++)r[c]=Hh(r[c],t,n,a,s);return n&&((e=Bh(e))&&(r[go]=Rn(e)),n(i,r)),r}function qw(e){return Hh(e,xy,void 0,void 0,!1)}function xy(e){return e.W===Xa?e.toJSON():e instanceof vr?e.na(qw):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"bigint":return vf(t)?Number(t):String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(vc(t))return}else{if(Va(t))return N1(t);if(t instanceof os){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=N1(n)}if(t instanceof vr)return t.na()}}return t}(e)}function wy(e){return Wh(e,xy,void 0,void 0,!1)}function $s(e,t,n){return e=Sy(e,t[0],t[1],n?1:2),t!==vy&&n&&Vc(e,16384),e}function Sy(e,t,n,r){if(e==null){var s=96;n?(e=[n],s|=512):e=[],t&&(s=-33521665&s|(1023&t)<<15)}else{if(!Array.isArray(e))throw Error("narr");if(2048&(s=0|e[Te]))throw Error("farr");if(64&s)return e;if(r===1||r===2||(s|=64),n&&(s|=512,n!==e[0]))throw Error("mid");e:{if(r=(n=e).length){const i=r-1;if(Th(n[i])){if((t=i-(512&(s|=256)?0:-1))>=1024)throw Error("pvtlmt");s=-33521665&s|(1023&t)<<15;break e}}if(t){if((t=Math.max(t,r-(512&s?0:-1)))>1024)throw Error("spvt");s=-33521665&s|(1023&t)<<15}}}return Ut(e,s),e}function xf(e,t,n=yf){if(e!=null){if(oy&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var r=0|e[Te];return 2&r?e:(t&&(t=r===0||!!(32&r)&&!(64&r||!(16&r))),t?(Ut(e,-12293&(34|r)),e):Wh(e,xf,4&r?yf:n,!0,!0))}return e.W===Xa?e=2&(r=0|(n=e.u)[Te])?e:new e.constructor(qc(n,r,!0)):e instanceof vr&&!(2&e.L)&&(n=No(e.X(xf)),e=new vr(n,e.S,e.R,e.Y)),e}}function qc(e,t,n){const r=n||2&t?yf:Tw,s=!!(32&t);return e=function(i,a,c){const d=Rn(i);var h=d.length;const g=256&a?d[h-1]:void 0;for(h+=g?-1:0,a=512&a?1:0;a<h;a++)d[a]=c(d[a]);if(g){a=d[a]={};for(const x in g)a[x]=c(g[x])}return(i=Bh(i))&&(d[go]=Rn(i)),d}(e,t,i=>xf(i,s,r)),Vc(e,32|(n?2:0)),e}function Zc(e){const t=e.u,n=0|t[Te];return 2&n?new e.constructor(qc(t,n,!1)):e}function xo(e,t){return gs(e=e.u,0|e[Te],t)}function gs(e,t,n,r){if(n===-1)return null;var s=n+(512&t?0:-1);const i=e.length-1;return s>=i&&256&t?e[i][n]:r&&256&t&&(t=e[i][n])!=null?(e[s]!=null&&od!=null&&((s=(e=bw??(bw={}))[od]||0)>=4||(e[od]=s+1,uy(e=Error(),"incident"),function(a){gi.setTimeout(()=>{throw a},0)}(e))),t):s<=i?e[s]:void 0}function ft(e,t,n){const r=e.u;let s=0|r[Te];return Xs(s),bt(r,s,t,n),e}function bt(e,t,n,r){const s=512&t?0:-1,i=n+s;var a=e.length-1;return i>=a&&256&t?(e[a][n]=r,t):i<=a?(e[i]=r,256&t&&n in(e=e[a])&&delete e[n],t):(r!==void 0&&(n>=(a=t>>15&1023||536870912)?r!=null&&(e[a+s]={[n]:r},Ut(e,t|=256)):e[i]=r),t)}function Dl(e,t){let n=0|(e=e.u)[Te];const r=gs(e,n,t),s=Ks(r);return s!=null&&s!==r&&bt(e,n,t,s),s}function ky(e){let t=0|(e=e.u)[Te];const n=gs(e,t,1),r=Ih(n,!0);return r!=null&&r!==n&&bt(e,t,1,r),r}function oi(){return Iw===void 0?2:4}function ai(e,t,n,r,s){const i=e.u,a=2&(e=0|i[Te])?1:r;s=!!s;let c=0|(r=Gh(i,e,t))[Te];if(!(4&c)){4&c&&(r=Rn(r),c=as(c,e),e=bt(i,e,t,r));let d=0,h=0;for(;d<r.length;d++){const g=n(r[d]);g!=null&&(r[h++]=g)}h<d&&(r.length=h),c=Vh(c,e),n=-4097&(20|c),c=n&=-8193,Ut(r,c),2&c&&Object.freeze(r)}return a===1||a===4&&32&c?ss(c)||(s=c,c|=2,c!==s&&Ut(r,c),Object.freeze(r)):(a===2&&ss(c)&&(r=Rn(r),c=as(c,e),c=Ds(c,e,s),Ut(r,c),e=bt(i,e,t,r)),ss(c)||(t=c,c=Ds(c,e,s),c!==t&&Ut(r,c))),r}function Gh(e,t,n,r){return e=gs(e,t,n,r),Array.isArray(e)?e:Ph}function Vh(e,t){return e===0&&(e=as(e,t)),1|e}function ss(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function Ay(e){e=Rn(e);for(let t=0;t<e.length;t++){const n=e[t]=Rn(e[t]);Array.isArray(n[1])&&(n[1]=No(n[1]))}return e}function wf(e,t,n,r){let s=0|(e=e.u)[Te];Xs(s),bt(e,s,t,(r==="0"?Number(n)===0:n===r)?void 0:n)}function Po(e,t,n,r,s){Xs(t);var i=!(!(64&t)&&16384&t);const a=(s=Gh(e,t,n,s))!==Ph;if(i||!a){let c=i=a?0|s[Te]:0;(!a||2&c||ss(c)||4&c&&!(32&c))&&(s=Rn(s),c=as(c,t),t=bt(e,t,n,s)),c=-13&Vh(c,t),c=Ds(r?-17&c:16|c,t,!0),c!==i&&Ut(s,c)}return s}function cd(e,t){var n=fv;return Xh(Yh(e=e.u),e,0|e[Te],n)===t?t:-1}function Yh(e){if(Gc)return e[qo]??(e[qo]=new Map);if(qo in e)return e[qo];const t=new Map;return Object.defineProperty(e,qo,{value:t}),t}function Ey(e,t,n,r){const s=Yh(e),i=Xh(s,e,t,n);return i!==r&&(i&&(t=bt(e,t,i)),s.set(n,r)),t}function Xh(e,t,n,r){let s=e.get(r);if(s!=null)return s;s=0;for(let i=0;i<r.length;i++){const a=r[i];gs(t,n,a)!=null&&(s!==0&&(n=bt(t,n,s)),s=a)}return e.set(r,s),s}function Kh(e,t,n,r){let s,i=0|e[Te];if((r=gs(e,i,n,r))!=null&&r.W===Xa)return(t=Zc(r))!==r&&bt(e,i,n,t),t.u;if(Array.isArray(r)){const a=0|r[Te];s=2&a?$s(qc(r,a,!1),t,!0):64&a?r:$s(s,t,!0)}else s=$s(void 0,t,!0);return s!==r&&bt(e,i,n,s),s}function Cy(e,t,n,r){let s=0|(e=e.u)[Te];return(t=Uh(r=gs(e,s,n,r),t,!1,s))!==r&&t!=null&&bt(e,s,n,t),t}function tt(e,t,n,r=!1){if((t=Cy(e,t,n,r))==null)return t;if(!(2&(r=0|(e=e.u)[Te]))){const s=Zc(t);s!==t&&bt(e,r,n,t=s)}return t}function jy(e,t,n,r,s,i,a){e=e.u;var c=!!(2&t);const d=c?1:s;i=!!i,a&&(a=!c);var h=0|(s=Gh(e,t,r))[Te];if(!(c=!!(4&h))){var g=s,x=t;const w=!!(2&(h=Vh(h,t)));w&&(x|=2);let _=!w,D=!0,I=0,Y=0;for(;I<g.length;I++){const j=Uh(g[I],n,!1,x);if(j instanceof n){if(!w){const y=!!(2&(0|j.u[Te]));_&&(_=!y),D&&(D=y)}g[Y++]=j}}Y<I&&(g.length=Y),h|=4,h=D?16|h:-17&h,Ut(g,h=_?8|h:-9&h),w&&Object.freeze(g)}if(a&&!(8&h||!s.length&&(d===1||d===4&&32&h))){for(ss(h)&&(s=Rn(s),h=as(h,t),t=bt(e,t,r,s)),n=s,a=h,g=0;g<n.length;g++)(h=n[g])!==(x=Zc(h))&&(n[g]=x);a|=8,Ut(n,a=n.length?-17&a:16|a),h=a}return d===1||d===4&&32&h?ss(h)||(t=h,(h|=!s.length||16&h&&(!c||32&h)?2:2048)!==t&&Ut(s,h),Object.freeze(s)):(d===2&&ss(h)&&(Ut(s=Rn(s),h=Ds(h=as(h,t),t,i)),t=bt(e,t,r,s)),ss(h)||(r=h,(h=Ds(h,t,i))!==r&&Ut(s,h))),s}function hs(e,t,n){const r=0|e.u[Te];return jy(e,r,t,n,oi(),!1,!(2&r))}function Ie(e,t,n,r){return r==null&&(r=void 0),ft(e,n,r)}function ga(e,t,n,r){r==null&&(r=void 0);e:{let s=0|(e=e.u)[Te];if(Xs(s),r==null){const i=Yh(e);if(Xh(i,e,s,n)!==t)break e;i.set(n,0)}else s=Ey(e,s,n,t);bt(e,s,t,r)}}function as(e,t){return-2049&(e=32|(2&t?2|e:-3&e))}function Ds(e,t,n){return 32&t&&n||(e&=-33),e}function kc(e,t,n,r){const s=0|e.u[Te];Xs(s),e=jy(e,s,n,t,2,!0),r=r??new n,e.push(r),e[Te]=2&(0|r.u[Te])?-9&e[Te]:-17&e[Te]}function pr(e,t){return bo(xo(e,t))}function xr(e,t){return vo(xo(e,t))}function Ft(e,t){return Dl(e,t)??0}function Oa(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);ft(e,t,n)}function Kr(e,t,n){if(n!=null){if(typeof n!="number"||!Qc(n))throw gf("int32");n|=0}ft(e,t,n)}function be(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);ft(e,t,n)}function Ac(e,t,n){{const a=e.u;let c=0|a[Te];if(Xs(c),n==null)bt(a,c,t);else{var r=e=0|n[Te],s=ss(e),i=s||Object.isFrozen(n);for(s||(e=0),i||(n=Rn(n),r=0,e=Ds(e=as(e,c),c,!0),i=!1),e|=21,s=0;s<n.length;s++){const d=n[s],h=yy(d);Object.is(d,h)||(i&&(n=Rn(n),r=0,e=Ds(e=as(e,c),c,!0),i=!1),n[s]=h)}e!==r&&(i&&(n=Rn(n),e=Ds(e=as(e,c),c,!0)),Ut(n,e)),bt(a,c,t,n)}}}function eu(e,t,n){Xs(0|e.u[Te]),ai(e,t,vo,2,!0).push(yy(n))}function _y(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Qh(){return Error("Failed to read varint, encoding is invalid.")}function Ny(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function Jh(e){if(typeof e=="string")return{buffer:ly(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===os)return{buffer:bh(e)||new Uint8Array(0),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function qh(e,t){let n,r=0,s=0,i=0;const a=e.h;let c=e.g;do n=a[c++],r|=(127&n)<<i,i+=7;while(i<32&&128&n);for(i>32&&(s|=(127&n)>>4),i=3;i<32&&128&n;i+=7)n=a[c++],s|=(127&n)<<i;if(ui(e,c),n<128)return t(r>>>0,s>>>0);throw Qh()}function Zh(e){let t=0,n=e.g;const r=n+10,s=e.h;for(;n<r;){const i=s[n++];if(t|=i,(128&i)==0)return ui(e,n),!!(127&t)}throw Qh()}function Hs(e){const t=e.h;let n=e.g,r=t[n++],s=127&r;if(128&r&&(r=t[n++],s|=(127&r)<<7,128&r&&(r=t[n++],s|=(127&r)<<14,128&r&&(r=t[n++],s|=(127&r)<<21,128&r&&(r=t[n++],s|=r<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw Qh();return ui(e,n),s}function ps(e){return Hs(e)>>>0}function Sf(e){var t=e.h;const n=e.g,r=t[n],s=t[n+1],i=t[n+2];return t=t[n+3],ui(e,e.g+4),(r<<0|s<<8|i<<16|t<<24)>>>0}function kf(e){var t=Sf(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:e*(1/0):n==0?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(t+8388608)}function Zw(e){return Hs(e)}function ud(e,t,{ba:n=!1}={}){e.ba=n,t&&(t=Jh(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function ui(e,t){if(e.g=t,t>e.l)throw Ny(e.l,t)}function by(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,r=n+t;if(r>e.l)throw Ny(t,e.l-n);return e.g=r,n}function My(e,t){if(t==0)return yi();var n=by(e,t);return e.ba&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?new Uint8Array(0):Dw?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?yi():new os(n,mo)}vr.prototype.toJSON=void 0,vr.prototype.Ia=hy;var z1=[];function Py(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=ps(e.g);if(t=n>>>3,!((n&=7)>=0&&n<=5))throw _y(n,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function zl(e){switch(e.h){case 0:e.h!=0?zl(e):Zh(e.g);break;case 1:ui(e=e.g,e.g+8);break;case 2:if(e.h!=2)zl(e);else{var t=ps(e.g);ui(e=e.g,e.g+t)}break;case 5:ui(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!Py(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}zl(e)}break;default:throw _y(e.h,e.l)}}function Ka(e,t,n){const r=e.g.l,s=ps(e.g),i=e.g.g+s;let a=i-r;if(a<=0&&(e.g.l=i,n(t,e,void 0,void 0,void 0),a=i-e.g.g),a)throw Error(`Message parsing ended unexpectedly. Expected to read ${s} bytes, instead read ${s-a} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=i,e.g.l=r,t}function ep(e){var t=ps(e.g),n=by(e=e.g,t);if(e=e.h,Sw){var r,s=e;(r=nd)||(r=nd=new TextDecoder("utf-8",{fatal:!0})),t=n+t,s=n===0&&t===s.length?s:s.subarray(n,t);try{var i=r.decode(s)}catch(c){if(kl===void 0){try{r.decode(new Uint8Array([128]))}catch{}try{r.decode(new Uint8Array([97])),kl=!0}catch{kl=!1}}throw!kl&&(nd=void 0),c}}else{t=(i=n)+t,n=[];let c,d=null;for(;i<t;){var a=e[i++];a<128?n.push(a):a<224?i>=t?ei():(c=e[i++],a<194||(192&c)!=128?(i--,ei()):n.push((31&a)<<6|63&c)):a<240?i>=t-1?ei():(c=e[i++],(192&c)!=128||a===224&&c<160||a===237&&c>=160||(192&(r=e[i++]))!=128?(i--,ei()):n.push((15&a)<<12|(63&c)<<6|63&r)):a<=244?i>=t-2?ei():(c=e[i++],(192&c)!=128||c-144+(a<<28)>>30||(192&(r=e[i++]))!=128||(192&(s=e[i++]))!=128?(i--,ei()):(a=(7&a)<<18|(63&c)<<12|(63&r)<<6|63&s,a-=65536,n.push(55296+(a>>10&1023),56320+(1023&a)))):ei(),n.length>=8192&&(d=E1(d,n),n.length=0)}i=E1(d,n)}return i}function Ty(e){const t=ps(e.g);return My(e.g,t)}function tu(e,t,n){var r=ps(e.g);for(r=e.g.g+r;e.g.g<r;)n.push(t(e.g))}var Al=[];function e5(e){return e}let ro;function Ir(e,t,n){t.g?t.m(e,t.g,t.h,n):t.m(e,t.h,n)}var je=class{constructor(e,t){this.u=Sy(e,t)}toJSON(){const e=!ro;try{return e&&(ro=wy),Iy(this)}finally{e&&(ro=void 0)}}l(){var e=L5;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return new this.constructor(qc(e,0|e[Te],!1))}N(){return!!(2&(0|this.u[Te]))}};function Iy(e){var t=e.u;{t=(e=ro(t))!==t;let h=e.length;if(h){var n=e[h-1],r=Th(n);r?h--:n=void 0;var s=e;if(r){e:{var i,a=n,c=!1;if(a)for(let g in a)isNaN(+g)?(i??(i={}))[g]=a[g]:(r=a[g],Array.isArray(r)&&(vc(r)||P1(r)&&r.size===0)&&(r=null),r==null&&(c=!0),r!=null&&((i??(i={}))[g]=r));if(c||(i=a),i)for(let g in i){c=i;break e}c=null}a=c==null?n!=null:c!==n}for(;h>0&&((i=s[h-1])==null||vc(i)||P1(i)&&i.size===0);h--)var d=!0;(s!==e||a||d)&&(t?(d||a||c)&&(s.length=h):s=Array.prototype.slice.call(s,0,h),c&&s.push(c)),d=s}else d=e}return d}function U1(e){return e?/^\d+$/.test(e)?(Kc(e),new Af(ut,Rt)):null:t5||(t5=new Af(0,0))}je.prototype.W=Xa,je.prototype.toString=function(){try{return ro=e5,Iy(this).toString()}finally{ro=void 0}};var Af=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let t5;function H1(e){return e?/^-?\d+$/.test(e)?(Kc(e),new Ef(ut,Rt)):null:n5||(n5=new Ef(0,0))}var Ef=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let n5;function so(e,t,n){for(;n>0||t>127;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function To(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function nu(e,t){if(t>=0)To(e,t);else{for(let n=0;n<9;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function $a(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function wo(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function nr(e,t,n){To(e.g,8*t+n)}function tp(e,t){return nr(e,t,2),t=e.g.end(),wo(e,t),t.push(e.h),t}function np(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;n>127;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function ru(e,t,n){nr(e,t,2),To(e.g,n.length),wo(e,e.g.end()),wo(e,n)}function Ec(e,t,n,r){n!=null&&(t=tp(e,t),r(n,e),np(e,t))}function Br(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var rp=Br(),By=Br(),sp=Br(),ip=Br(),Ry=Br(),Ly=Br(),op=Br(),Fy=Br(),Oy=Br(),Io=class{constructor(e,t,n){this.g=e,this.h=t,e=rp,this.l=!!e&&n===e||!1}};function su(e,t){return new Io(e,t,rp)}function $y(e,t,n,r,s){Ec(e,n,Hy(t,r),s)}const r5=su(function(e,t,n,r,s){return e.h===2&&(Ka(e,Kh(t,r,n),s),!0)},$y),s5=su(function(e,t,n,r,s){return e.h===2&&(Ka(e,Kh(t,r,n,!0),s),!0)},$y);var iu=Symbol(),ap=Symbol(),W1=Symbol(),G1=Symbol();let Dy,zy;function wi(e,t,n,r){var s=r[e];if(s)return s;(s={}).Pa=r,s.V=function(x){switch(typeof x){case"boolean":return vy||(vy=[0,void 0,!0]);case"number":return x>0?void 0:x===0?Jw||(Jw=[0,void 0]):[-x,void 0];case"string":return[0,x];case"object":return x}}(r[0]);var i=r[1];let a=1;i&&i.constructor===Object&&(s.ga=i,typeof(i=r[++a])=="function"&&(s.la=!0,Dy??(Dy=i),zy??(zy=r[a+1]),i=r[a+=2]));const c={};for(;i&&Array.isArray(i)&&i.length&&typeof i[0]=="number"&&i[0]>0;){for(var d=0;d<i.length;d++)c[i[d]]=i;i=r[++a]}for(d=1;i!==void 0;){let x;typeof i=="number"&&(d+=i,i=r[++a]);var h=void 0;if(i instanceof Io?x=i:(x=r5,a--),x==null?void 0:x.l){i=r[++a],h=r;var g=a;typeof i=="function"&&(i=i(),h[g]=i),h=i}for(g=d+1,typeof(i=r[++a])=="number"&&i<0&&(g-=i,i=r[++a]);d<g;d++){const w=c[d];h?n(s,d,x,h,w):t(s,d,x,w)}}return r[e]=s}function Uy(e){return Array.isArray(e)?e[0]instanceof Io?e:[s5,e]:[e,void 0]}function Hy(e,t){return e instanceof je?e.u:Array.isArray(e)?$s(e,t,!1):void 0}function lp(e,t,n,r){const s=n.g;e[t]=r?(i,a,c)=>s(i,a,c,r):s}function cp(e,t,n,r,s){const i=n.g;let a,c;e[t]=(d,h,g)=>i(d,h,g,c||(c=wi(ap,lp,cp,r).V),a||(a=up(r)),s)}function up(e){let t=e[W1];if(t!=null)return t;const n=wi(ap,lp,cp,e);return t=n.la?(r,s)=>Dy(r,s,n):(r,s)=>{const i=0|r[Te];for(;Py(s)&&s.h!=4;){var a=s.m,c=n[a];if(c==null){var d=n.ga;d&&(d=d[a])&&(d=i5(d))!=null&&(c=n[a]=d)}c!=null&&c(s,r,a)||(a=(c=s).l,zl(c),c.fa?c=void 0:(d=c.g.g-a,c.g.g=a,c=My(c.g,d)),a=r,c&&((d=a[go])?d.push(c):a[go]=[c]))}return 16384&i&&No(r),!0},e[W1]=t}function i5(e){const t=(e=Uy(e))[0].g;if(e=e[1]){const n=up(e),r=wi(ap,lp,cp,e).V;return(s,i,a)=>t(s,i,a,r,n)}return t}function ou(e,t,n){e[t]=n.h}function au(e,t,n,r){let s,i;const a=n.h;e[t]=(c,d,h)=>a(c,d,h,i||(i=wi(iu,ou,au,r).V),s||(s=Wy(r)))}function Wy(e){let t=e[G1];if(!t){const n=wi(iu,ou,au,e);t=(r,s)=>Gy(r,s,n),e[G1]=t}return t}function Gy(e,t,n){for(var r=0|e[Te],s=512&r?0:-1,i=e.length,a=512&r?1:0,c=i+(256&r?-1:0);a<c;a++){const d=e[a];if(d==null)continue;const h=a-s,g=V1(n,h);g&&g(t,d,h)}if(256&r){r=e[i-1];for(const d in r)s=+d,Number.isNaN(s)||(i=r[s])!=null&&(c=V1(n,s))&&c(t,i,s)}if(e=Bh(e))for(wo(t,t.g.end()),n=0;n<e.length;n++)wo(t,bh(e[n])||new Uint8Array(0))}function V1(e,t){var n=e[t];if(n)return n;if((n=e.ga)&&(n=n[t])){var r=(n=Uy(n))[0].h;if(n=n[1]){const s=Wy(n),i=wi(iu,ou,au,n).V;n=e.la?zy(i,s):(a,c,d)=>r(a,c,d,i,s)}else n=r;return e[t]=n}}function Bo(e,t){if(Array.isArray(t)){var n=0|t[Te];if(4&n)return t;for(var r=0,s=0;r<t.length;r++){const i=e(t[r]);i!=null&&(t[s++]=i)}return s<r&&(t.length=s),Ut(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}function kn(e,t,n){return new Io(e,t,n)}function Ro(e,t,n){return new Io(e,t,n)}function An(e,t,n){bt(e,0|e[Te],t,n)}var o5=su(function(e,t,n,r,s){return e.h===2&&(e=Ka(e,$s([void 0,void 0],r,!0),s),Xs(r=0|t[Te]),(s=gs(t,r,n))instanceof vr?2&s.L?((s=s.X()).push(e),bt(t,r,n,s)):s.Na(e):Array.isArray(s)?(2&(0|s[Te])&&bt(t,r,n,s=Ay(s)),s.push(e)):bt(t,r,n,[e]),!0)},function(e,t,n,r,s){if(t instanceof vr)t.forEach((i,a)=>{Ec(e,n,$s([a,i],r,!1),s)});else if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Array.isArray(a)&&Ec(e,n,$s(a,r,!1),s)}});function Vy(e,t,n){if(t=function(r){if(r==null)return r;const s=typeof r;if(s==="bigint")return String($h(64,r));if(Jc(r)){if(s==="string")return zh(r);if(s==="number")return Dh(r)}}(t),t!=null&&(typeof t=="string"&&H1(t),t!=null))switch(nr(e,n,0),typeof t){case"number":e=e.g,yo(t),so(e,ut,Rt);break;case"bigint":n=BigInt.asUintN(64,t),n=new Ef(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),so(e.g,n.h,n.g);break;default:n=H1(t),so(e.g,n.h,n.g)}}function Yy(e,t,n){(t=bo(t))!=null&&t!=null&&(nr(e,n,0),nu(e.g,t))}function Xy(e,t,n){(t=my(t))!=null&&(nr(e,n,0),e.g.g.push(t?1:0))}function Ky(e,t,n){(t=vo(t))!=null&&ru(e,n,ry(t))}function Qy(e,t,n,r,s){Ec(e,n,Hy(t,r),s)}function Jy(e,t,n){(t=t==null||typeof t=="string"||Va(t)||t instanceof os?t:void 0)!=null&&ru(e,n,Jh(t).buffer)}function qy(e,t,n){return(e.h===5||e.h===2)&&(t=Po(t,0|t[Te],n,!1,!1),e.h==2?tu(e,kf,t):t.push(kf(e.g)),!0)}var es=kn(function(e,t,n){if(e.h!==1)return!1;var r=e.g;e=Sf(r);const s=Sf(r);r=2*(s>>31)+1;const i=s>>>20&2047;return e=4294967296*(1048575&s)+e,An(t,n,i==2047?e?NaN:r*(1/0):i==0?5e-324*r*e:r*Math.pow(2,i-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=Ks(t))!=null&&(nr(e,n,1),e=e.g,(n=py||(py=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),ut=n.getUint32(0,!0),Rt=n.getUint32(4,!0),$a(e,ut),$a(e,Rt))},Br()),Ht=kn(function(e,t,n){return e.h===5&&(An(t,n,kf(e.g)),!0)},function(e,t,n){(t=Ks(t))!=null&&(nr(e,n,5),e=e.g,Rh(t),$a(e,ut))},op),a5=Ro(qy,function(e,t,n){if((t=Bo(Ks,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(nr(r,s,5),r=r.g,Rh(i),$a(r,ut))}},op),dp=Ro(qy,function(e,t,n){if((t=Bo(Ks,t))!=null&&t.length){nr(e,n,2),To(e.g,4*t.length);for(let r=0;r<t.length;r++)n=e.g,Rh(t[r]),$a(n,ut)}},op),Ws=kn(function(e,t,n){return e.h===0&&(An(t,n,qh(e.g,Fh)),!0)},Vy,Ly),dd=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=qh(e.g,Fh))===0?void 0:e),!0)},Vy,Ly),l5=kn(function(e,t,n){return e.h===0&&(An(t,n,qh(e.g,Lh)),!0)},function(e,t,n){if((t=Hw(t))!=null&&(typeof t=="string"&&U1(t),t!=null))switch(nr(e,n,0),typeof t){case"number":e=e.g,yo(t),so(e,ut,Rt);break;case"bigint":n=BigInt.asUintN(64,t),n=new Af(Number(n&BigInt(4294967295)),Number(n>>BigInt(32))),so(e.g,n.h,n.g);break;default:n=U1(t),so(e.g,n.h,n.g)}},Br()),Lt=kn(function(e,t,n){return e.h===0&&(An(t,n,Hs(e.g)),!0)},Yy,ip),lu=Ro(function(e,t,n){return(e.h===0||e.h===2)&&(t=Po(t,0|t[Te],n,!1,!1),e.h==2?tu(e,Hs,t):t.push(Hs(e.g)),!0)},function(e,t,n){if((t=Bo(bo,t))!=null&&t.length){n=tp(e,n);for(let r=0;r<t.length;r++)nu(e.g,t[r]);np(e,n)}},ip),Yi=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Hs(e.g))===0?void 0:e),!0)},Yy,ip),At=kn(function(e,t,n){return e.h===0&&(An(t,n,Zh(e.g)),!0)},Xy,By),io=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=Zh(e.g))===!1?void 0:e),!0)},Xy,By),hn=Ro(function(e,t,n){return e.h===2&&(e=ep(e),Po(t,0|t[Te],n,!1).push(e),!0)},function(e,t,n){if((t=Bo(vo,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&ru(r,s,ry(i))}},sp),Ns=kn(function(e,t,n){return e.h===2&&(An(t,n,(e=ep(e))===""?void 0:e),!0)},Ky,sp),it=kn(function(e,t,n){return e.h===2&&(An(t,n,ep(e)),!0)},Ky,sp),Vt=function(e,t,n=rp){return new Io(e,t,n)}(function(e,t,n,r,s){return e.h===2&&(r=$s(void 0,r,!0),Po(t,0|t[Te],n,!0).push(r),Ka(e,r,s),!0)},function(e,t,n,r,s){if(Array.isArray(t))for(let i=0;i<t.length;i++)Qy(e,t[i],n,r,s)}),ot=su(function(e,t,n,r,s,i){return e.h===2&&(Ey(t,0|t[Te],i,n),Ka(e,t=Kh(t,r,n),s),!0)},Qy),Zy=kn(function(e,t,n){return e.h===2&&(An(t,n,Ty(e)),!0)},Jy,Fy),c5=Ro(function(e,t,n){return(e.h===0||e.h===2)&&(t=Po(t,0|t[Te],n,!1,!1),e.h==2?tu(e,ps,t):t.push(ps(e.g)),!0)},function(e,t,n){if((t=Bo(gy,t))!=null)for(let a=0;a<t.length;a++){var r=e,s=n,i=t[a];i!=null&&(nr(r,s,0),To(r.g,i))}},Ry),u5=kn(function(e,t,n){return e.h===0&&(An(t,n,(e=ps(e.g))===0?void 0:e),!0)},function(e,t,n){(t=gy(t))!=null&&t!=null&&(nr(e,n,0),To(e.g,t))},Ry),wr=kn(function(e,t,n){return e.h===0&&(An(t,n,Hs(e.g)),!0)},function(e,t,n){(t=bo(t))!=null&&(t=parseInt(t,10),nr(e,n,0),nu(e.g,t))},Oy);class d5{constructor(t,n){this.h=t,this.g=n,this.l=tt,this.m=Ie,this.defaultValue=void 0}}function Rr(e,t){return new d5(e,t)}function Qs(e,t){return(n,r)=>{if(Al.length){const i=Al.pop();i.o(r),ud(i.g,n,r),n=i}else n=new class{constructor(i,a){if(z1.length){const c=z1.pop();ud(c,i,a),i=c}else i=new class{constructor(c,d){this.h=null,this.m=!1,this.g=this.l=this.j=0,ud(this,c,d)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(i,a);this.g=i,this.l=this.g.g,this.h=this.m=-1,this.o(a)}o({fa:i=!1}={}){this.fa=i}}(n,r);try{const i=new e,a=i.u;up(t)(a,n);var s=i}finally{n.g.clear(),n.m=-1,n.h=-1,Al.length<100&&Al.push(n)}return s}}function cu(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const a=this.g;return this.g=[],a}}}};Gy(this.u,t,wi(iu,ou,au,e)),wo(t,t.g.end());const n=new Uint8Array(t.h),r=t.l,s=r.length;let i=0;for(let a=0;a<s;a++){const c=r[a];n.set(c,i),i+=c.length}return t.l=[n],n}}var Y1=class extends je{constructor(e){super(e)}},X1=[0,Ns,kn(function(e,t,n){return e.h===2&&(An(t,n,(e=Ty(e))===yi()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof je){const r=t.Ra;return void(r&&(t=r(t),t!=null&&ru(e,n,Jh(t).buffer)))}if(Array.isArray(t))return}Jy(e,t,n)},Fy)];let fd,K1=globalThis.trustedTypes;function Q1(e){fd===void 0&&(fd=function(){let n=null;if(!K1)return n;try{const r=s=>s;n=K1.createPolicy("goog#html",{createHTML:r,createScript:r,createScriptURL:r})}catch{}return n}());var t=fd;return new class{constructor(n){this.g=n}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function f5(e,...t){if(t.length===0)return Q1(e[0]);let n=e[0];for(let r=0;r<t.length;r++)n+=encodeURIComponent(t[r])+e[r+1];return Q1(n)}var ev=[0,Lt,wr,At,-1,lu,wr,-1],h5=class extends je{constructor(e){super(e)}},tv=[0,At,it,At,wr,-1,Ro(function(e,t,n){return(e.h===0||e.h===2)&&(t=Po(t,0|t[Te],n,!1,!1),e.h==2?tu(e,Zw,t):t.push(Hs(e.g)),!0)},function(e,t,n){if((t=Bo(bo,t))!=null&&t.length){n=tp(e,n);for(let r=0;r<t.length;r++)nu(e.g,t[r]);np(e,n)}},Oy),it,-1,[0,At,-1],wr,At,-1],nv=[0,it,-2],J1=class extends je{constructor(e){super(e)}},rv=[0],sv=[0,Lt,At,1,At,-3],Zn=class extends je{constructor(e){super(e,2)}},Wt={};Wt[336783863]=[0,it,At,-1,Lt,[0,[1,2,3,4,5,6,7,8],ot,rv,ot,tv,ot,nv,ot,sv,ot,ev,ot,[0,it,-2],ot,[0,it,wr],ot,[0,wr,it]],[0,it],At,[0,[1,3],[2,4],ot,[0,lu],-1,ot,[0,hn],-1,Vt,[0,it,-1]],it];var q1=[0,dd,-1,io,-3,dd,lu,Ns,Yi,dd,-1,io,Yi,io,-2,Ns];function rr(e,t){wf(e,2,Mo(t),"")}function pt(e,t){eu(e,3,t)}function Je(e,t){eu(e,4,t)}var xn=class extends je{constructor(e){super(e,500)}o(e){return Ie(this,0,7,e)}},ya=[-1,{}],Z1=[0,it,1,ya],e0=[0,it,hn,ya];function sr(e,t){kc(e,1,xn,t)}function xt(e,t){eu(e,10,t)}function st(e,t){eu(e,15,t)}var Fn=class extends je{constructor(e){super(e,500)}o(e){return Ie(this,0,1001,e)}},iv=[-500,Vt,[-500,Ns,-1,hn,-3,[-2,Wt,At],Vt,X1,Yi,-1,Z1,e0,Vt,[0,Ns,io],Ns,q1,Yi,hn,987,hn],4,Vt,[-500,it,-1,[-1,{}],998,it],Vt,[-500,it,hn,-1,[-2,{},At],997,hn,-1],Yi,Vt,[-500,it,hn,ya,998,hn],hn,Yi,Z1,e0,Vt,[0,Ns,-1,ya],hn,-2,q1,Ns,-1,io,[0,io,u5],978,ya,Vt,X1];Fn.prototype.g=cu(iv);var p5=Qs(Fn,iv),m5=class extends je{constructor(e){super(e)}},ov=class extends je{constructor(e){super(e)}g(){return hs(this,m5,1)}},av=[0,Vt,[0,Lt,Ht,it,-1]],uu=Qs(ov,av),g5=class extends je{constructor(e){super(e)}},y5=class extends je{constructor(e){super(e)}},hd=class extends je{constructor(e){super(e)}h(){return tt(this,g5,2)}g(){return hs(this,y5,5)}},lv=Qs(class extends je{constructor(e){super(e)}},[0,hn,lu,dp,[0,wr,[0,Lt,-3],[0,Ht,-3],[0,Lt,-1,[0,Vt,[0,Lt,-2]]],Vt,[0,Ht,-1,it,Ht]],it,-1,Ws,Vt,[0,Lt,Ht],hn,Ws]),cv=class extends je{constructor(e){super(e)}},oo=Qs(class extends je{constructor(e){super(e)}},[0,Vt,[0,Ht,-4]]),uv=class extends je{constructor(e){super(e)}},Qa=Qs(class extends je{constructor(e){super(e)}},[0,Vt,[0,Ht,-4]]),v5=class extends je{constructor(e){super(e)}},x5=[0,Lt,-1,dp,wr],dv=class extends je{constructor(e){super(e)}};dv.prototype.g=cu([0,Ht,-4,Ws]);var w5=class extends je{constructor(e){super(e)}},S5=Qs(class extends je{constructor(e){super(e)}},[0,Vt,[0,1,Lt,it,av],Ws]),t0=class extends je{constructor(e){super(e)}},k5=class extends je{constructor(e){super(e)}oa(){const e=ky(this);return e??yi()}},A5=class extends je{constructor(e){super(e)}},fv=[1,2],E5=Qs(class extends je{constructor(e){super(e)}},[0,Vt,[0,fv,ot,[0,dp],ot,[0,Zy],Lt,it],Ws]),fp=class extends je{constructor(e){super(e)}},hv=[0,it,Lt,Ht,hn,-1],n0=class extends je{constructor(e){super(e)}},C5=[0,At,-1],r0=class extends je{constructor(e){super(e)}},Ul=[1,2,3,4,5],Cc=class extends je{constructor(e){super(e)}g(){return ky(this)!=null}h(){return xr(this,2)!=null}},Et=class extends je{constructor(e){super(e)}g(){return my(xo(this,2))??!1}},pv=[0,Zy,it,[0,Lt,Ws,-1],[0,l5,Ws]],$t=[0,pv,At,[0,Ul,ot,sv,ot,tv,ot,ev,ot,rv,ot,nv],wr],du=class extends je{constructor(e){super(e)}},hp=[0,$t,Ht,-1,Lt],j5=Rr(502141897,du);Wt[502141897]=hp;var _5=Qs(class extends je{constructor(e){super(e)}},[0,[0,wr,-1,a5,c5],x5]),mv=class extends je{constructor(e){super(e)}},gv=class extends je{constructor(e){super(e)}},pp=[0,$t,Ht,[0,$t],At],yv=[0,$t,hp,pp,Ht,[0,[0,pv]]],N5=Rr(508968150,gv);Wt[508968150]=yv,Wt[508968149]=pp;var vv=class extends je{constructor(e){super(e)}},b5=Rr(513916220,vv);Wt[513916220]=[0,$t,yv,Lt];var Ti=class extends je{constructor(e){super(e)}h(){return tt(this,fp,2)}g(){ft(this,2)}},xv=[0,$t,hv];Wt[478825465]=xv;var M5=class extends je{constructor(e){super(e)}},wv=class extends je{constructor(e){super(e)}},mp=class extends je{constructor(e){super(e)}},gp=class extends je{constructor(e){super(e)}},Sv=class extends je{constructor(e){super(e)}},s0=[0,$t,[0,$t],xv,-1],kv=[0,$t,Ht,Lt],yp=[0,$t,Ht],Av=[0,$t,kv,yp,Ht],P5=Rr(479097054,Sv);Wt[479097054]=[0,$t,Av,s0],Wt[463370452]=s0,Wt[464864288]=kv;var T5=Rr(462713202,gp);Wt[462713202]=Av,Wt[474472470]=yp;var I5=class extends je{constructor(e){super(e)}},Ev=class extends je{constructor(e){super(e)}},Cv=class extends je{constructor(e){super(e)}},jv=class extends je{constructor(e){super(e)}},vp=[0,$t,Ht,-1,Lt],Cf=[0,$t,Ht,At];jv.prototype.g=cu([0,$t,yp,[0,$t],hp,pp,vp,Cf]);var _v=class extends je{constructor(e){super(e)}},B5=Rr(456383383,_v);Wt[456383383]=[0,$t,hv];var Nv=class extends je{constructor(e){super(e)}},R5=Rr(476348187,Nv);Wt[476348187]=[0,$t,C5];var bv=class extends je{constructor(e){super(e)}},i0=class extends je{constructor(e){super(e)}},Mv=[0,wr,-1],L5=Rr(458105876,class extends je{constructor(e){super(e)}g(){var e=this.u;const t=0|e[Te],n=2&t;return e=function(r,s,i){var a=i0;const c=2&s;let d=!1;if(i==null){if(c)return D1();i=[]}else if(i.constructor===vr){if(!(2&i.L)||c)return i;i=i.X()}else Array.isArray(i)?d=!!(2&(0|i[Te])):i=[];if(c){if(!i.length)return D1();d||(d=!0,No(i))}else d&&(d=!1,i=Ay(i));return d||(64&(0|i[Te])?i[Te]&=-33:32&s&&Vc(i,32)),bt(r,s,2,a=new vr(i,a,Ww,void 0)),a}(e,t,gs(e,t,2)),!n&&i0&&(e.ra=!0),e}});Wt[458105876]=[0,Mv,o5,[!0,Ws,[0,it,-1,hn]]];var xp=class extends je{constructor(e){super(e)}},Pv=Rr(458105758,xp);Wt[458105758]=[0,$t,it,Mv];var Tv=class extends je{constructor(e){super(e)}},F5=Rr(443442058,Tv);Wt[443442058]=[0,$t,it,Lt,Ht,hn,-1,At,Ht],Wt[514774813]=vp;var Iv=class extends je{constructor(e){super(e)}},O5=Rr(516587230,Iv);function jf(e,t){return t=t?t.clone():new fp,e.displayNamesLocale!==void 0?ft(t,1,Mo(e.displayNamesLocale)):e.displayNamesLocale===void 0&&ft(t,1),e.maxResults!==void 0?Kr(t,2,e.maxResults):"maxResults"in e&&ft(t,2),e.scoreThreshold!==void 0?be(t,3,e.scoreThreshold):"scoreThreshold"in e&&ft(t,3),e.categoryAllowlist!==void 0?Ac(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&ft(t,4),e.categoryDenylist!==void 0?Ac(t,5,e.categoryDenylist):"categoryDenylist"in e&&ft(t,5),t}function wp(e,t=-1,n=""){return{categories:e.map(r=>({index:pr(r,1)??0??-1,score:Ft(r,2)??0,categoryName:xr(r,3)??""??"",displayName:xr(r,4)??""??""})),headIndex:t,headName:n}}function Bv(e){var a,c;var t=ai(e,3,Ks,oi()),n=ai(e,2,bo,oi()),r=ai(e,1,vo,oi()),s=ai(e,9,vo,oi());const i={categories:[],keypoints:[]};for(let d=0;d<t.length;d++)i.categories.push({score:t[d],index:n[d]??-1,categoryName:r[d]??"",displayName:s[d]??""});if((t=(a=tt(e,hd,4))==null?void 0:a.h())&&(i.boundingBox={originX:pr(t,1)??0,originY:pr(t,2)??0,width:pr(t,3)??0,height:pr(t,4)??0,angle:0}),(c=tt(e,hd,4))==null?void 0:c.g().length)for(const d of tt(e,hd,4).g())i.keypoints.push({x:Dl(d,1)??0,y:Dl(d,2)??0,score:Dl(d,4)??0,label:xr(d,3)??""});return i}function fu(e){const t=[];for(const n of hs(e,uv,1))t.push({x:Ft(n,1)??0,y:Ft(n,2)??0,z:Ft(n,3)??0,visibility:Ft(n,4)??0});return t}function va(e){const t=[];for(const n of hs(e,cv,1))t.push({x:Ft(n,1)??0,y:Ft(n,2)??0,z:Ft(n,3)??0,visibility:Ft(n,4)??0});return t}function o0(e){return Array.from(e,t=>t>127?t-256:t)}function a0(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,r=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],s+=t[i]*t[i];if(r<=0||s<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(r*s)}let El;Wt[516587230]=[0,$t,vp,Cf,Ht],Wt[518928384]=Cf;const $5=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function Rv(){if(El===void 0)try{await WebAssembly.instantiate($5),El=!0}catch{El=!1}return El}async function Zo(e,t=f5``){const n=await Rv()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${n}.js`,wasmBinaryPath:`${t}/${e}_${n}.wasm`}}var Es=class{};function Lv(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function l0(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,r)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",s=>{r(s)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function Fv(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function Pe(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function c0(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[r,s]=Fv(t);return!e.l||r===e.i.canvas.width&&s===e.i.canvas.height||(e.i.canvas.width=r,e.i.canvas.height=s),[r,s]}function u0(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const r=new Uint32Array(t.length);for(let s=0;s<t.length;s++)r[s]=e.i.stringToNewUTF8(t[s]);t=e.i._malloc(4*r.length),e.i.HEAPU32.set(r,t>>2),n(t);for(const s of r)e.i._free(s);e.i._free(t)}function zr(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function Ss(e,t,n){let r=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(s,i,a)=>{i?(n(r,a),r=[]):r.push(s)}}Es.forVisionTasks=function(e){return Zo("vision",e)},Es.forTextTasks=function(e){return Zo("text",e)},Es.forGenAiExperimentalTasks=function(e){return Zo("genai_experimental",e)},Es.forGenAiTasks=function(e){return Zo("genai",e)},Es.forAudioTasks=function(e){return Zo("audio",e)},Es.isSimdSupported=function(){return Rv()};async function D5(e,t,n,r){return e=await(async(s,i,a,c,d)=>{if(i&&await l0(i),!self.ModuleFactory||a&&(await l0(a),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&d&&((i=self.Module).locateFile=d.locateFile,d.mainScriptUrlOrBlob&&(i.mainScriptUrlOrBlob=d.mainScriptUrlOrBlob)),d=await self.ModuleFactory(self.Module||d),self.ModuleFactory=self.Module=void 0,new s(d,c)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:s=>s.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&s.endsWith(".data")?n.assetBinaryPath.toString():s}),await e.o(r),e}function pd(e,t){const n=tt(e.baseOptions,Cc,1)||new Cc;typeof t=="string"?(ft(n,2,Mo(t)),ft(n,1)):t instanceof Uint8Array&&(ft(n,1,Ih(t,!1)),ft(n,2)),Ie(e.baseOptions,0,1,n)}function d0(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(n=>n.message).join(", "))}finally{e.G=[]}}function Ae(e,t){e.B=Math.max(e.B,t)}function hu(e,t){e.A=new xn,rr(e.A,"PassThroughCalculator"),pt(e.A,"free_memory"),Je(e.A,"free_memory_unused_out"),xt(t,"free_memory"),sr(t,e.A)}function So(e,t){pt(e.A,t),Je(e.A,t+"_unused_out")}function pu(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var Hl=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,r,s,i,a,c;if(t){const d=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((r=e.baseOptions)!=null&&r.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((s=tt(this.baseOptions,Cc,1))!=null&&s.g()||(i=tt(this.baseOptions,Cc,1))!=null&&i.h()||(a=e.baseOptions)!=null&&a.modelAssetBuffer||(c=e.baseOptions)!=null&&c.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(h,g){let x=tt(h.baseOptions,r0,3);if(!x){var w=x=new r0,_=new J1;ga(w,4,Ul,_)}"delegate"in g&&(g.delegate==="GPU"?(g=x,w=new h5,ga(g,2,Ul,w)):(g=x,w=new J1,ga(g,4,Ul,w))),Ie(h.baseOptions,0,3,x)}(this,d),d.modelAssetPath)return fetch(d.modelAssetPath.toString()).then(h=>{if(h.ok)return h.arrayBuffer();throw Error(`Failed to fetch model: ${d.modelAssetPath} (${h.status})`)}).then(h=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(h),!0,!1,!1),pd(this,"/model.dat"),this.m(),this.I()});if(d.modelAssetBuffer instanceof Uint8Array)pd(this,d.modelAssetBuffer);else if(d.modelAssetBuffer)return async function(h){const g=[];for(var x=0;;){const{done:w,value:_}=await h.read();if(w)break;g.push(_),x+=_.length}if(g.length===0)return new Uint8Array(0);if(g.length===1)return g[0];h=new Uint8Array(x),x=0;for(const w of g)h.set(w,x),x+=w.length;return h}(d.modelAssetBuffer).then(h=>{pd(this,h),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let e;if(this.g.da(t=>{e=p5(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,r)=>{this.G.push(Error(r))}),this.g.La(),this.g.setGraph(e,t),this.A=void 0,d0(this)}finishProcessing(){this.g.finishProcessing(),d0(this)}close(){this.A=void 0,this.g.closeGraph()}};function ls(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}Hl.prototype.close=Hl.prototype.close,function(e,t){e=e.split(".");var n,r=gi;for((e[0]in r)||r.execScript===void 0||r.execScript("var "+e[0]);e.length&&(n=e.shift());)e.length||t===void 0?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}("TaskRunner",Hl);class z5{constructor(t,n,r,s){this.g=t,this.h=n,this.m=r,this.l=s}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function f0(e,t,n){const r=e.g;if(n=ls(r.createShader(n),"Failed to create WebGL shader"),r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${r.getShaderInfoLog(n)}`);return r.attachShader(e.h,n),n}function h0(e,t){const n=e.g,r=ls(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(r);const s=ls(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,s),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const i=ls(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.I),n.vertexAttribPointer(e.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new z5(n,r,s,i)}function Sp(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function kp(e,t,n,r){return Sp(e,t),e.h||(e.m(),e.C()),n?(e.s||(e.s=h0(e,!0)),n=e.s):(e.v||(e.v=h0(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=r(),n.g.bindVertexArray(null),e}function mu(e,t,n){return Sp(e,t),e=ls(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function gu(e,t,n){Sp(e,t),e.A||(e.A=ls(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function Ap(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var Ep=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=ls(e.createProgram(),"Failed to create WebGL program"),this.aa=f0(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Z=f0(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.O=e.getAttribLocation(this.h,"aVertex"),this.I=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.aa),e.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function ts(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function _f(e){var t=ts(e,1);if(!t){if(t=ts(e,0))t=new Float32Array(t).map(r=>r/255);else{t=new Float32Array(e.width*e.height);const r=ko(e);var n=Cp(e);if(gu(n,r,Ov(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),r.readPixels(0,0,e.width,e.height,r.RGBA,r.FLOAT,n);for(let s=0,i=0;s<t.length;++s,i+=4)t[s]=n[i]}else r.readPixels(0,0,e.width,e.height,r.RED,r.FLOAT,t)}e.g.push(t)}return t}function Ov(e){let t=ts(e,2);if(!t){const n=ko(e);t=Dv(e);const r=_f(e),s=$v(e);n.texImage2D(n.TEXTURE_2D,0,s,e.width,e.height,0,n.RED,n.FLOAT,r),Nf(e)}return t}function ko(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ls(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function $v(e){if(e=ko(e),!Cl)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))Cl=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");Cl=e.R16F}return Cl}function Cp(e){return e.l||(e.l=new Ep),e.l}function Dv(e){const t=ko(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=ts(e,2);return n||(n=mu(Cp(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function Nf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var Cl,Jt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.m=t,this.j=n,this.canvas=r,this.l=s,this.width=i,this.height=a,this.j&&--p0===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!ts(this,0)}ja(){return!!ts(this,1)}P(){return!!ts(this,2)}ia(){return(t=ts(e=this,0))||(t=_f(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ha(){return _f(this)}M(){return Ov(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const r=ko(this),s=Cp(this);r.activeTexture(r.TEXTURE1),n=mu(s,r,this.m?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,n);const i=$v(this);r.texImage2D(r.TEXTURE_2D,0,i,this.width,this.height,0,r.RED,r.FLOAT,null),r.bindTexture(r.TEXTURE_2D,null),gu(s,r,n),kp(s,r,!1,()=>{Dv(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),Nf(this)}),Ap(s),Nf(this)}}e.push(n)}return new Jt(e,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&ko(this).deleteTexture(ts(this,2)),p0=-1}};Jt.prototype.close=Jt.prototype.close,Jt.prototype.clone=Jt.prototype.clone,Jt.prototype.getAsWebGLTexture=Jt.prototype.M,Jt.prototype.getAsFloat32Array=Jt.prototype.ha,Jt.prototype.getAsUint8Array=Jt.prototype.ia,Jt.prototype.hasWebGLTexture=Jt.prototype.P,Jt.prototype.hasFloat32Array=Jt.prototype.ja,Jt.prototype.hasUint8Array=Jt.prototype.Fa;var p0=250;function Gr(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function zv(e){var t=Gr(e,0);if(!t){t=Ao(e);const n=yu(e),r=new Uint8Array(e.width*e.height*4);gu(n,t,Wl(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),Ap(n),t=new ImageData(new Uint8ClampedArray(r.buffer),e.width,e.height),e.g.push(t)}return t}function Wl(e){let t=Gr(e,2);if(!t){const n=Ao(e);t=Gl(e);const r=Gr(e,1)||zv(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),ia(e)}return t}function Ao(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ls(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function yu(e){return e.l||(e.l=new Ep),e.l}function Gl(e){const t=Ao(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Gr(e,2);return n||(n=mu(yu(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function ia(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function m0(e){const t=Ao(e);return kp(yu(e),t,!0,()=>function(n,r){const s=n.canvas;if(s.width===n.width&&s.height===n.height)return r();const i=s.width,a=s.height;return s.width=n.width,s.height=n.height,n=r(),s.width=i,s.height=a,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var qt=class{constructor(e,t,n,r,s,i,a){this.g=e,this.j=t,this.m=n,this.canvas=r,this.l=s,this.width=i,this.height=a,(this.j||this.m)&&--g0===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!Gr(this,0)}ka(){return!!Gr(this,1)}P(){return!!Gr(this,2)}Ca(){return zv(this)}Ba(){var e=Gr(this,1);return e||(Wl(this),Gl(this),e=m0(this),ia(this),this.g.push(e),this.j=!0),e}M(){return Wl(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const r=Ao(this),s=yu(this);r.activeTexture(r.TEXTURE1),n=mu(s,r),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindTexture(r.TEXTURE_2D,null),gu(s,r,n),kp(s,r,!1,()=>{Gl(this),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_FAN,0,4),ia(this)}),Ap(s),ia(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Wl(this),Gl(this),n=m0(this),ia(this)}e.push(n)}return new qt(e,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Gr(this,1).close(),this.m&&Ao(this).deleteTexture(Gr(this,2)),g0=-1}};qt.prototype.close=qt.prototype.close,qt.prototype.clone=qt.prototype.clone,qt.prototype.getAsWebGLTexture=qt.prototype.M,qt.prototype.getAsImageBitmap=qt.prototype.Ba,qt.prototype.getAsImageData=qt.prototype.Ca,qt.prototype.hasWebGLTexture=qt.prototype.P,qt.prototype.hasImageBitmap=qt.prototype.ka,qt.prototype.hasImageData=qt.prototype.Ea;var g0=250;function Lr(...e){return e.map(([t,n])=>({start:t,end:n}))}const U5=function(e){return class extends e{La(){this.i._registerModelResourcesGraphService()}}}((y0=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:Lv()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,r=this.i._malloc(n);this.i.HEAPU8.set(e,r),t?this.i._changeBinaryGraph(n,r):this.i._changeTextGraph(n,r),this.i._free(r)}configureAudio(e,t,n,r,s){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),Pe(this,r||"input_audio",i=>{Pe(this,s=s||"audio_header",a=>{this.i._configureAudio(i,a,e,t??0,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}da(e){zr(this,"__graph_config__",t=>{e(t)}),Pe(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,r,s){const i=4*e.length;this.h!==i&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(i),this.h=i),this.i.HEAPF32.set(e,this.g/4),Pe(this,r,a=>{this.i._addAudioToInputStream(this.g,t,n,a,s)})}addGpuBufferToStream(e,t,n){Pe(this,t,r=>{const[s,i]=c0(this,e,r);this.i._addBoundTextureToStream(r,s,i,n)})}addBoolToStream(e,t,n){Pe(this,t,r=>{this.i._addBoolToInputStream(e,r,n)})}addDoubleToStream(e,t,n){Pe(this,t,r=>{this.i._addDoubleToInputStream(e,r,n)})}addFloatToStream(e,t,n){Pe(this,t,r=>{this.i._addFloatToInputStream(e,r,n)})}addIntToStream(e,t,n){Pe(this,t,r=>{this.i._addIntToInputStream(e,r,n)})}addUintToStream(e,t,n){Pe(this,t,r=>{this.i._addUintToInputStream(e,r,n)})}addStringToStream(e,t,n){Pe(this,t,r=>{Pe(this,e,s=>{this.i._addStringToInputStream(s,r,n)})})}addStringRecordToStream(e,t,n){Pe(this,t,r=>{u0(this,Object.keys(e),s=>{u0(this,Object.values(e),i=>{this.i._addFlatHashMapToInputStream(s,i,Object.keys(e).length,r,n)})})})}addProtoToStream(e,t,n,r){Pe(this,n,s=>{Pe(this,t,i=>{const a=this.i._malloc(e.length);this.i.HEAPU8.set(e,a),this.i._addProtoToInputStream(a,e.length,i,s,r),this.i._free(a)})})}addEmptyPacketToStream(e,t){Pe(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){Pe(this,t,r=>{const s=this.i._allocateBoolVector(e.length);if(!s)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(s,i);this.i._addBoolVectorToInputStream(s,r,n)})}addDoubleVectorToStream(e,t,n){Pe(this,t,r=>{const s=this.i._allocateDoubleVector(e.length);if(!s)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(s,i);this.i._addDoubleVectorToInputStream(s,r,n)})}addFloatVectorToStream(e,t,n){Pe(this,t,r=>{const s=this.i._allocateFloatVector(e.length);if(!s)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(s,i);this.i._addFloatVectorToInputStream(s,r,n)})}addIntVectorToStream(e,t,n){Pe(this,t,r=>{const s=this.i._allocateIntVector(e.length);if(!s)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(s,i);this.i._addIntVectorToInputStream(s,r,n)})}addUintVectorToStream(e,t,n){Pe(this,t,r=>{const s=this.i._allocateUintVector(e.length);if(!s)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(s,i);this.i._addUintVectorToInputStream(s,r,n)})}addStringVectorToStream(e,t,n){Pe(this,t,r=>{const s=this.i._allocateStringVector(e.length);if(!s)throw Error("Unable to allocate new string vector on heap.");for(const i of e)Pe(this,i,a=>{this.i._addStringVectorEntry(s,a)});this.i._addStringVectorToInputStream(s,r,n)})}addBoolToInputSidePacket(e,t){Pe(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){Pe(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){Pe(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){Pe(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addUintToInputSidePacket(e,t){Pe(this,t,n=>{this.i._addUintToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){Pe(this,t,n=>{Pe(this,e,r=>{this.i._addStringToInputSidePacket(r,n)})})}addProtoToInputSidePacket(e,t,n){Pe(this,n,r=>{Pe(this,t,s=>{const i=this.i._malloc(e.length);this.i.HEAPU8.set(e,i),this.i._addProtoToInputSidePacket(i,e.length,s,r),this.i._free(i)})})}addBoolVectorToInputSidePacket(e,t){Pe(this,t,n=>{const r=this.i._allocateBoolVector(e.length);if(!r)throw Error("Unable to allocate new bool vector on heap.");for(const s of e)this.i._addBoolVectorEntry(r,s);this.i._addBoolVectorToInputSidePacket(r,n)})}addDoubleVectorToInputSidePacket(e,t){Pe(this,t,n=>{const r=this.i._allocateDoubleVector(e.length);if(!r)throw Error("Unable to allocate new double vector on heap.");for(const s of e)this.i._addDoubleVectorEntry(r,s);this.i._addDoubleVectorToInputSidePacket(r,n)})}addFloatVectorToInputSidePacket(e,t){Pe(this,t,n=>{const r=this.i._allocateFloatVector(e.length);if(!r)throw Error("Unable to allocate new float vector on heap.");for(const s of e)this.i._addFloatVectorEntry(r,s);this.i._addFloatVectorToInputSidePacket(r,n)})}addIntVectorToInputSidePacket(e,t){Pe(this,t,n=>{const r=this.i._allocateIntVector(e.length);if(!r)throw Error("Unable to allocate new int vector on heap.");for(const s of e)this.i._addIntVectorEntry(r,s);this.i._addIntVectorToInputSidePacket(r,n)})}addUintVectorToInputSidePacket(e,t){Pe(this,t,n=>{const r=this.i._allocateUintVector(e.length);if(!r)throw Error("Unable to allocate new unsigned int vector on heap.");for(const s of e)this.i._addUintVectorEntry(r,s);this.i._addUintVectorToInputSidePacket(r,n)})}addStringVectorToInputSidePacket(e,t){Pe(this,t,n=>{const r=this.i._allocateStringVector(e.length);if(!r)throw Error("Unable to allocate new string vector on heap.");for(const s of e)Pe(this,s,i=>{this.i._addStringVectorEntry(r,i)});this.i._addStringVectorToInputSidePacket(r,n)})}attachBoolListener(e,t){zr(this,e,t),Pe(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){Ss(this,e,t),Pe(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){zr(this,e,t),Pe(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){Ss(this,e,t),Pe(this,e,n=>{this.i._attachIntVectorListener(n)})}attachUintListener(e,t){zr(this,e,t),Pe(this,e,n=>{this.i._attachUintListener(n)})}attachUintVectorListener(e,t){Ss(this,e,t),Pe(this,e,n=>{this.i._attachUintVectorListener(n)})}attachDoubleListener(e,t){zr(this,e,t),Pe(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){Ss(this,e,t),Pe(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){zr(this,e,t),Pe(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){Ss(this,e,t),Pe(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){zr(this,e,t),Pe(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){Ss(this,e,t),Pe(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){zr(this,e,t),Pe(this,e,r=>{this.i._attachProtoListener(r,n||!1)})}attachProtoVectorListener(e,t,n){Ss(this,e,t),Pe(this,e,r=>{this.i._attachProtoVectorListener(r,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),zr(this,e,(r,s)=>{r=new Float32Array(r.buffer,r.byteOffset,r.length/4),t(r,s)}),Pe(this,e,r=>{this.i._attachAudioListener(r,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends y0{get ea(){return this.i}qa(e,t,n){Pe(this,t,r=>{const[s,i]=c0(this,e,r);this.ea._addBoundTextureAsImageToStream(r,s,i,n)})}U(e,t){zr(this,e,t),Pe(this,e,n=>{this.ea._attachImageListener(n)})}ca(e,t){Ss(this,e,t),Pe(this,e,n=>{this.ea._attachImageVectorListener(n)})}}));var y0,Sr=class extends U5{};async function Qe(e,t,n){return async function(r,s,i,a){return D5(r,s,i,a)}(e,n.canvas??(Lv()?void 0:document.createElement("canvas")),t,n)}function Uv(e,t,n,r){if(e.T){const i=new dv;if(n!=null&&n.regionOfInterest){if(!e.pa)throw Error("This task doesn't support region-of-interest.");var s=n.regionOfInterest;if(s.left>=s.right||s.top>=s.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(s.left<0||s.top<0||s.right>1||s.bottom>1)throw Error("Expected RectF values to be in [0,1].");be(i,1,(s.left+s.right)/2),be(i,2,(s.top+s.bottom)/2),be(i,4,s.right-s.left),be(i,3,s.bottom-s.top)}else be(i,1,.5),be(i,2,.5),be(i,4,1),be(i,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(be(i,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[a,c]=Fv(t);n=Ft(i,3)*c/a,s=Ft(i,4)*a/c,be(i,4,n),be(i,3,s)}}e.g.addProtoToStream(i.g(),"mediapipe.NormalizedRect",e.T,r)}e.g.qa(t,e.aa,r??performance.now()),e.finishProcessing()}function kr(e,t,n){var r;if((r=e.baseOptions)!=null&&r.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Uv(e,t,n,e.B+1)}function Qr(e,t,n,r){var s;if(!((s=e.baseOptions)!=null&&s.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Uv(e,t,n,r)}function Eo(e,t,n,r){var s=t.data;const i=t.width,a=i*(t=t.height);if((s instanceof Uint8Array||s instanceof Float32Array)&&s.length!==a)throw Error("Unsupported channel count: "+s.length/a);return e=new Jt([s],n,!1,e.g.i.canvas,e.O,i,t),r?e.clone():e}var Ln=class extends Hl{constructor(e,t,n,r){super(e),this.g=e,this.aa=t,this.T=n,this.pa=r,this.O=new Ep}l(e,t=!0){if("runningMode"in e&&Oa(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Ln.prototype.close=Ln.prototype.close;var ar=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Ie(e=this.h=new du,0,1,t=new Et),be(this.h,2,.5),be(this.h,3,.3)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&be(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&be(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},kr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Qr(this,e,n,t),this.j}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect_in"),st(e,"detections");const t=new Zn;Ir(t,j5,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect_in"),Je(n,"DETECTIONS:detections"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=lv(i),this.j.detections.push(Bv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ar.prototype.detectForVideo=ar.prototype.F,ar.prototype.detect=ar.prototype.D,ar.prototype.setOptions=ar.prototype.o,ar.createFromModelPath=async function(e,t){return Qe(ar,e,{baseOptions:{modelAssetPath:t}})},ar.createFromModelBuffer=function(e,t){return Qe(ar,e,{baseOptions:{modelAssetBuffer:t}})},ar.createFromOptions=function(e,t){return Qe(ar,e,t)};var jp=Lr([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),_p=Lr([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),Np=Lr([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),Hv=Lr([474,475],[475,476],[476,477],[477,474]),bp=Lr([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),Mp=Lr([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Wv=Lr([469,470],[470,471],[471,472],[472,469]),Pp=Lr([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),Gv=[...jp,..._p,...Np,...bp,...Mp,...Pp],Vv=Lr([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function v0(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var It=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Ie(e=this.h=new gv,0,1,t=new Et),this.v=new mv,Ie(this.h,0,3,this.v),this.s=new du,Ie(this.h,0,2,this.s),Kr(this.s,4,1),be(this.s,2,.5),be(this.v,2,.5),be(this.h,4,.5)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"numFaces"in e&&Kr(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&be(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&be(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&be(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return v0(this),kr(this,e,t),this.j}F(e,t,n){return v0(this),Qr(this,e,n,t),this.j}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect"),st(e,"face_landmarks");const t=new Zn;Ir(t,N5,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("face_landmarks",(r,s)=>{for(const i of r)r=Qa(i),this.j.faceLandmarks.push(fu(r));Ae(this,s)}),this.g.attachEmptyPacketListener("face_landmarks",r=>{Ae(this,r)}),this.outputFaceBlendshapes&&(st(e,"blendshapes"),Je(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(r,s)=>{if(this.outputFaceBlendshapes)for(const i of r)r=uu(i),this.j.faceBlendshapes.push(wp(r.g()??[]));Ae(this,s)}),this.g.attachEmptyPacketListener("blendshapes",r=>{Ae(this,r)})),this.outputFacialTransformationMatrixes&&(st(e,"face_geometry"),Je(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(r,s)=>{if(this.outputFacialTransformationMatrixes)for(const i of r)(r=tt(_5(i),v5,2))&&this.j.facialTransformationMatrixes.push({rows:pr(r,1)??0??0,columns:pr(r,2)??0??0,data:ai(r,3,Ks,oi()).slice()??[]});Ae(this,s)}),this.g.attachEmptyPacketListener("face_geometry",r=>{Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};It.prototype.detectForVideo=It.prototype.F,It.prototype.detect=It.prototype.D,It.prototype.setOptions=It.prototype.o,It.createFromModelPath=function(e,t){return Qe(It,e,{baseOptions:{modelAssetPath:t}})},It.createFromModelBuffer=function(e,t){return Qe(It,e,{baseOptions:{modelAssetBuffer:t}})},It.createFromOptions=function(e,t){return Qe(It,e,t)},It.FACE_LANDMARKS_LIPS=jp,It.FACE_LANDMARKS_LEFT_EYE=_p,It.FACE_LANDMARKS_LEFT_EYEBROW=Np,It.FACE_LANDMARKS_LEFT_IRIS=Hv,It.FACE_LANDMARKS_RIGHT_EYE=bp,It.FACE_LANDMARKS_RIGHT_EYEBROW=Mp,It.FACE_LANDMARKS_RIGHT_IRIS=Wv,It.FACE_LANDMARKS_FACE_OVAL=Pp,It.FACE_LANDMARKS_CONTOURS=Gv,It.FACE_LANDMARKS_TESSELATION=Vv;var Ur=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!0),Ie(e=this.j=new vv,0,1,t=new Et)}get baseOptions(){return tt(this.j,Et,1)}set baseOptions(e){Ie(this.j,0,1,e)}o(e){return super.l(e)}Oa(e,t,n){const r=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,kr(this,e,r??{}),!this.h)return this.s}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect"),st(e,"stylized_image");const t=new Zn;Ir(t,b5,this.j);const n=new xn;rr(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),sr(e,n),this.g.U("stylized_image",(r,s)=>{var i=!this.h,a=r.data,c=r.width;const d=c*(r=r.height);if(a instanceof Uint8Array)if(a.length===3*d){const h=new Uint8ClampedArray(4*d);for(let g=0;g<d;++g)h[4*g]=a[3*g],h[4*g+1]=a[3*g+1],h[4*g+2]=a[3*g+2],h[4*g+3]=255;a=new ImageData(h,c,r)}else{if(a.length!==4*d)throw Error("Unsupported channel count: "+a.length/d);a=new ImageData(new Uint8ClampedArray(a.buffer,a.byteOffset,a.length),c,r)}else if(!(a instanceof WebGLTexture))throw Error(`Unsupported format: ${a.constructor.name}`);c=new qt([a],!1,!1,this.g.i.canvas,this.O,c,r),this.s=i=i?c.clone():c,this.h&&this.h(i),Ae(this,s)}),this.g.attachEmptyPacketListener("stylized_image",r=>{this.s=null,this.h&&this.h(null),Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Ur.prototype.stylize=Ur.prototype.Oa,Ur.prototype.setOptions=Ur.prototype.o,Ur.createFromModelPath=function(e,t){return Qe(Ur,e,{baseOptions:{modelAssetPath:t}})},Ur.createFromModelBuffer=function(e,t){return Qe(Ur,e,{baseOptions:{modelAssetBuffer:t}})},Ur.createFromOptions=function(e,t){return Qe(Ur,e,t)};var Tp=Lr([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function x0(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function w0(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function S0(e,t=!0){const n=[];for(const s of e){var r=uu(s);e=[];for(const i of r.g())r=t&&pr(i,1)!=null?pr(i,1)??0:-1,e.push({score:Ft(i,2)??0,index:r,categoryName:xr(i,3)??""??"",displayName:xr(i,4)??""??""});n.push(e)}return n}var Gn=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Ie(e=this.j=new Sv,0,1,t=new Et),this.s=new gp,Ie(this.j,0,2,this.s),this.C=new mp,Ie(this.s,0,3,this.C),this.v=new wv,Ie(this.s,0,2,this.v),this.h=new M5,Ie(this.j,0,3,this.h),be(this.v,2,.5),be(this.s,4,.5),be(this.C,2,.5)}get baseOptions(){return tt(this.j,Et,1)}set baseOptions(e){Ie(this.j,0,1,e)}o(e){var s,i,a,c;if(Kr(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&be(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&be(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&be(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new Ti,n=t,r=jf(e.cannedGesturesClassifierOptions,(s=tt(this.h,Ti,3))==null?void 0:s.h());Ie(n,0,2,r),Ie(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((i=tt(this.h,Ti,3))==null||i.g());return e.customGesturesClassifierOptions?(Ie(n=t=new Ti,0,2,r=jf(e.customGesturesClassifierOptions,(a=tt(this.h,Ti,4))==null?void 0:a.h())),Ie(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((c=tt(this.h,Ti,4))==null||c.g()),this.l(e)}Ja(e,t){return x0(this),kr(this,e,t),w0(this)}Ka(e,t,n){return x0(this),Qr(this,e,n,t),w0(this)}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect"),st(e,"hand_gestures"),st(e,"hand_landmarks"),st(e,"world_hand_landmarks"),st(e,"handedness");const t=new Zn;Ir(t,P5,this.j);const n=new xn;rr(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"HAND_GESTURES:hand_gestures"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r){r=Qa(i);const a=[];for(const c of hs(r,uv,1))a.push({x:Ft(c,1)??0,y:Ft(c,2)??0,z:Ft(c,3)??0,visibility:Ft(c,4)??0});this.landmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r){r=oo(i);const a=[];for(const c of hs(r,cv,1))a.push({x:Ft(c,1)??0,y:Ft(c,2)??0,z:Ft(c,3)??0,visibility:Ft(c,4)??0});this.worldLandmarks.push(a)}Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("hand_gestures",(r,s)=>{this.gestures.push(...S0(r,!1)),Ae(this,s)}),this.g.attachEmptyPacketListener("hand_gestures",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{this.handedness.push(...S0(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function k0(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Gn.prototype.recognizeForVideo=Gn.prototype.Ka,Gn.prototype.recognize=Gn.prototype.Ja,Gn.prototype.setOptions=Gn.prototype.o,Gn.createFromModelPath=function(e,t){return Qe(Gn,e,{baseOptions:{modelAssetPath:t}})},Gn.createFromModelBuffer=function(e,t){return Qe(Gn,e,{baseOptions:{modelAssetBuffer:t}})},Gn.createFromOptions=function(e,t){return Qe(Gn,e,t)},Gn.HAND_CONNECTIONS=Tp;var Vn=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Ie(e=this.h=new gp,0,1,t=new Et),this.s=new mp,Ie(this.h,0,3,this.s),this.j=new wv,Ie(this.h,0,2,this.j),Kr(this.j,3,1),be(this.j,2,.5),be(this.s,2,.5),be(this.h,4,.5)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"numHands"in e&&Kr(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&be(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&be(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&be(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],kr(this,e,t),k0(this)}F(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Qr(this,e,n,t),k0(this)}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect"),st(e,"hand_landmarks"),st(e,"world_hand_landmarks"),st(e,"handedness");const t=new Zn;Ir(t,T5,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"LANDMARKS:hand_landmarks"),Je(n,"WORLD_LANDMARKS:world_hand_landmarks"),Je(n,"HANDEDNESS:handedness"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("hand_landmarks",(r,s)=>{for(const i of r)r=Qa(i),this.landmarks.push(fu(r));Ae(this,s)}),this.g.attachEmptyPacketListener("hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("world_hand_landmarks",(r,s)=>{for(const i of r)r=oo(i),this.worldLandmarks.push(va(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_hand_landmarks",r=>{Ae(this,r)}),this.g.attachProtoVectorListener("handedness",(r,s)=>{var i=this.handedness,a=i.push;const c=[];for(const d of r){r=uu(d);const h=[];for(const g of r.g())h.push({score:Ft(g,2)??0,index:pr(g,1)??0??-1,categoryName:xr(g,3)??""??"",displayName:xr(g,4)??""??""});c.push(h)}a.call(i,...c),Ae(this,s)}),this.g.attachEmptyPacketListener("handedness",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Vn.prototype.detectForVideo=Vn.prototype.F,Vn.prototype.detect=Vn.prototype.D,Vn.prototype.setOptions=Vn.prototype.o,Vn.createFromModelPath=function(e,t){return Qe(Vn,e,{baseOptions:{modelAssetPath:t}})},Vn.createFromModelBuffer=function(e,t){return Qe(Vn,e,{baseOptions:{modelAssetBuffer:t}})},Vn.createFromOptions=function(e,t){return Qe(Vn,e,t)},Vn.HAND_CONNECTIONS=Tp;var Yv=Lr([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function A0(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function E0(e){try{if(!e.C)return e.h;e.C(e.h)}finally{pu(e)}}function jl(e,t){e=Qa(e),t.push(fu(e))}var St=class extends Ln{constructor(e,t){super(new Sr(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Ie(e=this.j=new jv,0,1,t=new Et),this.J=new mp,Ie(this.j,0,2,this.J),this.Z=new I5,Ie(this.j,0,3,this.Z),this.s=new du,Ie(this.j,0,4,this.s),this.H=new mv,Ie(this.j,0,5,this.H),this.v=new Ev,Ie(this.j,0,6,this.v),this.K=new Cv,Ie(this.j,0,7,this.K),be(this.s,2,.5),be(this.s,3,.3),be(this.H,2,.5),be(this.v,2,.5),be(this.v,3,.3),be(this.K,2,.5),be(this.J,2,.5)}get baseOptions(){return tt(this.j,Et,1)}set baseOptions(e){Ie(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&be(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&be(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&be(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&be(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&be(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&be(this.K,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&be(this.J,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:n,A0(this),kr(this,e,r),E0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.C=typeof n=="function"?n:r,A0(this),Qr(this,e,s,t),E0(this)}m(){var e=new Fn;xt(e,"input_frames_image"),st(e,"pose_landmarks"),st(e,"pose_world_landmarks"),st(e,"face_landmarks"),st(e,"left_hand_landmarks"),st(e,"left_hand_world_landmarks"),st(e,"right_hand_landmarks"),st(e,"right_hand_world_landmarks");const t=new Zn,n=new Y1;wf(n,1,Mo("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(s,i){if(i!=null)if(Array.isArray(i))ft(s,2,wy(i));else{if(!(typeof i=="string"||i instanceof os||Va(i)))throw Error("invalid value in Any.value field: "+i+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");wf(s,2,Ih(i,!1),yi())}}(n,this.j.g());const r=new xn;rr(r,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),kc(r,8,Y1,n),pt(r,"IMAGE:input_frames_image"),Je(r,"POSE_LANDMARKS:pose_landmarks"),Je(r,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),Je(r,"FACE_LANDMARKS:face_landmarks"),Je(r,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),Je(r,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),Je(r,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),Je(r,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),r.o(t),sr(e,r),hu(this,e),this.g.attachProtoListener("pose_landmarks",(s,i)=>{jl(s,this.h.poseLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("pose_world_landmarks",(s,i)=>{var a=this.h.poseWorldLandmarks;s=oo(s),a.push(va(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("pose_world_landmarks",s=>{Ae(this,s)}),this.outputPoseSegmentationMasks&&(Je(r,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),So(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(s,i)=>{this.h.poseSegmentationMasks=[Eo(this,s,!0,!this.C)],Ae(this,i)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",s=>{this.h.poseSegmentationMasks=[],Ae(this,s)})),this.g.attachProtoListener("face_landmarks",(s,i)=>{jl(s,this.h.faceLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",s=>{Ae(this,s)}),this.outputFaceBlendshapes&&(st(e,"extra_blendshapes"),Je(r,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(s,i)=>{var a=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(s=uu(s),a.push(wp(s.g()??[]))),Ae(this,i)}),this.g.attachEmptyPacketListener("extra_blendshapes",s=>{Ae(this,s)})),this.g.attachProtoListener("left_hand_landmarks",(s,i)=>{jl(s,this.h.leftHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("left_hand_world_landmarks",(s,i)=>{var a=this.h.leftHandWorldLandmarks;s=oo(s),a.push(va(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_landmarks",(s,i)=>{jl(s,this.h.rightHandLandmarks),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_landmarks",s=>{Ae(this,s)}),this.g.attachProtoListener("right_hand_world_landmarks",(s,i)=>{var a=this.h.rightHandWorldLandmarks;s=oo(s),a.push(va(s)),Ae(this,i)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",s=>{Ae(this,s)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};St.prototype.detectForVideo=St.prototype.F,St.prototype.detect=St.prototype.D,St.prototype.setOptions=St.prototype.o,St.createFromModelPath=function(e,t){return Qe(St,e,{baseOptions:{modelAssetPath:t}})},St.createFromModelBuffer=function(e,t){return Qe(St,e,{baseOptions:{modelAssetBuffer:t}})},St.createFromOptions=function(e,t){return Qe(St,e,t)},St.HAND_CONNECTIONS=Tp,St.POSE_CONNECTIONS=Yv,St.FACE_LANDMARKS_LIPS=jp,St.FACE_LANDMARKS_LEFT_EYE=_p,St.FACE_LANDMARKS_LEFT_EYEBROW=Np,St.FACE_LANDMARKS_LEFT_IRIS=Hv,St.FACE_LANDMARKS_RIGHT_EYE=bp,St.FACE_LANDMARKS_RIGHT_EYEBROW=Mp,St.FACE_LANDMARKS_RIGHT_IRIS=Wv,St.FACE_LANDMARKS_FACE_OVAL=Pp,St.FACE_LANDMARKS_CONTOURS=Gv,St.FACE_LANDMARKS_TESSELATION=Vv;var lr=class extends Ln{constructor(e,t){super(new Sr(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Ie(e=this.h=new _v,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return Ie(this.h,0,2,jf(e,tt(this.h,fp,2))),this.l(e)}sa(e,t){return this.j={classifications:[]},kr(this,e,t),this.j}ta(e,t,n){return this.j={classifications:[]},Qr(this,e,n,t),this.j}m(){var e=new Fn;xt(e,"input_image"),xt(e,"norm_rect"),st(e,"classifications");const t=new Zn;Ir(t,B5,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),pt(n,"IMAGE:input_image"),pt(n,"NORM_RECT:norm_rect"),Je(n,"CLASSIFICATIONS:classifications"),n.o(t),sr(e,n),this.g.attachProtoListener("classifications",(r,s)=>{this.j=function(i){const a={classifications:hs(i,w5,1).map(c=>{var d;return wp(((d=tt(c,ov,4))==null?void 0:d.g())??[],pr(c,2)??0,xr(c,3)??"")})};return Sc(xo(i,2))!=null&&(a.timestampMs=Sc(xo(i,2))??0),a}(S5(r)),Ae(this,s)}),this.g.attachEmptyPacketListener("classifications",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};lr.prototype.classifyForVideo=lr.prototype.ta,lr.prototype.classify=lr.prototype.sa,lr.prototype.setOptions=lr.prototype.o,lr.createFromModelPath=function(e,t){return Qe(lr,e,{baseOptions:{modelAssetPath:t}})},lr.createFromModelBuffer=function(e,t){return Qe(lr,e,{baseOptions:{modelAssetBuffer:t}})},lr.createFromOptions=function(e,t){return Qe(lr,e,t)};var Yn=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!0),this.h=new Nv,this.embeddings={embeddings:[]},Ie(e=this.h,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){var t=this.h,n=tt(this.h,n0,2);return n=n?n.clone():new n0,e.l2Normalize!==void 0?Oa(n,1,e.l2Normalize):"l2Normalize"in e&&ft(n,1),e.quantize!==void 0?Oa(n,2,e.quantize):"quantize"in e&&ft(n,2),Ie(t,0,2,n),this.l(e)}za(e,t){return kr(this,e,t),this.embeddings}Aa(e,t,n){return Qr(this,e,n,t),this.embeddings}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect"),st(e,"embeddings_out");const t=new Zn;Ir(t,R5,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"EMBEDDINGS:embeddings_out"),n.o(t),sr(e,n),this.g.attachProtoListener("embeddings_out",(r,s)=>{r=E5(r),this.embeddings=function(i){return{embeddings:hs(i,A5,1).map(a=>{var d,h;const c={headIndex:pr(a,3)??0??-1,headName:xr(a,4)??""??""};if(Cy(a,t0,cd(a,1))!==void 0)a=ai(a=tt(a,t0,cd(a,1)),1,Ks,oi()),c.floatEmbedding=a.slice();else{const g=new Uint8Array(0);c.quantizedEmbedding=((h=(d=tt(a,k5,cd(a,2)))==null?void 0:d.oa())==null?void 0:h.h())??g}return c}),timestampMs:Sc(xo(i,2))??0}}(r),Ae(this,s)}),this.g.attachEmptyPacketListener("embeddings_out",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Yn.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=a0(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=a0(o0(e.quantizedEmbedding),o0(t.quantizedEmbedding))}return e},Yn.prototype.embedForVideo=Yn.prototype.Aa,Yn.prototype.embed=Yn.prototype.za,Yn.prototype.setOptions=Yn.prototype.o,Yn.createFromModelPath=function(e,t){return Qe(Yn,e,{baseOptions:{modelAssetPath:t}})},Yn.createFromModelBuffer=function(e,t){return Qe(Yn,e,{baseOptions:{modelAssetBuffer:t}})},Yn.createFromOptions=function(e,t){return Qe(Yn,e,t)};var bf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function C0(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function j0(e){try{const t=new bf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{pu(e)}}bf.prototype.close=bf.prototype.close;var fn=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new xp,this.v=new bv,Ie(this.h,0,3,this.v),Ie(e=this.h,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,Mo(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}I(){(function(e){var n,r;const t=hs(e.da(),xn,1).filter(s=>(xr(s,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((r=(n=tt(t[0],Zn,7))==null?void 0:n.l())==null?void 0:r.g())??new Map).forEach((s,i)=>{e.s[Number(i)]=xr(s,1)??""})})(this)}segment(e,t,n){const r=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,C0(this),kr(this,e,r),j0(this)}Ma(e,t,n,r){const s=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:r,C0(this),Qr(this,e,s,t),j0(this)}Da(){return this.s}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect");const t=new Zn;Ir(t,Pv,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),n.o(t),sr(e,n),hu(this,e),this.outputConfidenceMasks&&(st(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),So(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>Eo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(st(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),So(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=Eo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),st(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};fn.prototype.getLabels=fn.prototype.Da,fn.prototype.segmentForVideo=fn.prototype.Ma,fn.prototype.segment=fn.prototype.segment,fn.prototype.setOptions=fn.prototype.o,fn.createFromModelPath=function(e,t){return Qe(fn,e,{baseOptions:{modelAssetPath:t}})},fn.createFromModelBuffer=function(e,t){return Qe(fn,e,{baseOptions:{modelAssetBuffer:t}})},fn.createFromOptions=function(e,t){return Qe(fn,e,t)};var Mf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};Mf.prototype.close=Mf.prototype.close;var H5=class extends je{constructor(e){super(e)}},Ii=[0,Lt,-2],jc=[0,es,-3,At,es,-1],_0=[0,jc],N0=[0,jc,Lt,-1],md=class extends je{constructor(e){super(e)}},b0=[0,es,-1,At],W5=class extends je{constructor(e){super(e)}},M0=class extends je{constructor(e){super(e)}},Pf=[1,2,3,4,5,6,7,8,9,10,14,15],Xv=class extends je{constructor(e){super(e)}};Xv.prototype.g=cu([0,Vt,[0,Pf,ot,jc,ot,[0,jc,Ii],ot,_0,ot,[0,_0,Ii],ot,b0,ot,[0,es,-3,At,wr],ot,[0,es,-3,At],ot,[0,it,es,-2,At,Lt,At,-1,2,es,Ii],ot,N0,ot,[0,N0,Ii],es,Ii,it,ot,[0,es,-3,At,Ii,-1],ot,[0,Vt,b0]],it,[0,it,Lt,-1,At]]);var Hr=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new xp,this.s=new bv,Ie(this.h,0,3,this.s),Ie(e=this.h,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,n,r){const s=typeof n!="function"?n:{};this.j=typeof n=="function"?n:r,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.B+1,r=new Xv;const i=new M0;var a=new H5;if(Kr(a,1,255),Ie(i,0,12,a),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var c=new md;Oa(c,3,!0),be(c,1,t.keypoint.x),be(c,2,t.keypoint.y),ga(i,5,Pf,c)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(c of(a=new W5,t.scribble))Oa(t=new md,3,!0),be(t,1,c.x),be(t,2,c.y),kc(a,1,md,t);ga(i,15,Pf,a)}kc(r,1,M0,i),this.g.addProtoToStream(r.g(),"drishti.RenderData","roi_in",n),kr(this,e,s);e:{try{const h=new Mf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var d=h;break e}this.j(h)}finally{pu(this)}d=void 0}return d}m(){var e=new Fn;xt(e,"image_in"),xt(e,"roi_in"),xt(e,"norm_rect_in");const t=new Zn;Ir(t,Pv,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),pt(n,"IMAGE:image_in"),pt(n,"ROI:roi_in"),pt(n,"NORM_RECT:norm_rect_in"),n.o(t),sr(e,n),hu(this,e),this.outputConfidenceMasks&&(st(e,"confidence_masks"),Je(n,"CONFIDENCE_MASKS:confidence_masks"),So(this,"confidence_masks"),this.g.ca("confidence_masks",(r,s)=>{this.confidenceMasks=r.map(i=>Eo(this,i,!0,!this.j)),Ae(this,s)}),this.g.attachEmptyPacketListener("confidence_masks",r=>{this.confidenceMasks=[],Ae(this,r)})),this.outputCategoryMask&&(st(e,"category_mask"),Je(n,"CATEGORY_MASK:category_mask"),So(this,"category_mask"),this.g.U("category_mask",(r,s)=>{this.categoryMask=Eo(this,r,!1,!this.j),Ae(this,s)}),this.g.attachEmptyPacketListener("category_mask",r=>{this.categoryMask=void 0,Ae(this,r)})),st(e,"quality_scores"),Je(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(r,s)=>{this.qualityScores=r,Ae(this,s)}),this.g.attachEmptyPacketListener("quality_scores",r=>{this.categoryMask=void 0,Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Hr.prototype.segment=Hr.prototype.segment,Hr.prototype.setOptions=Hr.prototype.o,Hr.createFromModelPath=function(e,t){return Qe(Hr,e,{baseOptions:{modelAssetPath:t}})},Hr.createFromModelBuffer=function(e,t){return Qe(Hr,e,{baseOptions:{modelAssetBuffer:t}})},Hr.createFromOptions=function(e,t){return Qe(Hr,e,t)};var cr=class extends Ln{constructor(e,t){super(new Sr(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Ie(e=this.h=new Tv,0,1,t=new Et)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?ft(this.h,2,Mo(e.displayNamesLocale)):"displayNamesLocale"in e&&ft(this.h,2),e.maxResults!==void 0?Kr(this.h,3,e.maxResults):"maxResults"in e&&ft(this.h,3),e.scoreThreshold!==void 0?be(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&ft(this.h,4),e.categoryAllowlist!==void 0?Ac(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&ft(this.h,5),e.categoryDenylist!==void 0?Ac(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&ft(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},kr(this,e,t),this.j}F(e,t,n){return this.j={detections:[]},Qr(this,e,n,t),this.j}m(){var e=new Fn;xt(e,"input_frame_gpu"),xt(e,"norm_rect"),st(e,"detections");const t=new Zn;Ir(t,F5,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),pt(n,"IMAGE:input_frame_gpu"),pt(n,"NORM_RECT:norm_rect"),Je(n,"DETECTIONS:detections"),n.o(t),sr(e,n),this.g.attachProtoVectorListener("detections",(r,s)=>{for(const i of r)r=lv(i),this.j.detections.push(Bv(r));Ae(this,s)}),this.g.attachEmptyPacketListener("detections",r=>{Ae(this,r)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};cr.prototype.detectForVideo=cr.prototype.F,cr.prototype.detect=cr.prototype.D,cr.prototype.setOptions=cr.prototype.o,cr.createFromModelPath=async function(e,t){return Qe(cr,e,{baseOptions:{modelAssetPath:t}})},cr.createFromModelBuffer=function(e,t){return Qe(cr,e,{baseOptions:{modelAssetBuffer:t}})},cr.createFromOptions=function(e,t){return Qe(cr,e,t)};var Tf=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function P0(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function T0(e){try{const t=new Tf(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{pu(e)}}Tf.prototype.close=Tf.prototype.close;var Xn=class extends Ln{constructor(e,t){super(new Sr(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Ie(e=this.h=new Iv,0,1,t=new Et),this.v=new Cv,Ie(this.h,0,3,this.v),this.j=new Ev,Ie(this.h,0,2,this.j),Kr(this.j,4,1),be(this.j,2,.5),be(this.v,2,.5),be(this.h,4,.5)}get baseOptions(){return tt(this.h,Et,1)}set baseOptions(e){Ie(this.h,0,1,e)}o(e){return"numPoses"in e&&Kr(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&be(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&be(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&be(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,n){const r=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,P0(this),kr(this,e,r),T0(this)}F(e,t,n,r){const s=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:r,P0(this),Qr(this,e,s,t),T0(this)}m(){var e=new Fn;xt(e,"image_in"),xt(e,"norm_rect"),st(e,"normalized_landmarks"),st(e,"world_landmarks"),st(e,"segmentation_masks");const t=new Zn;Ir(t,O5,this.h);const n=new xn;rr(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),pt(n,"IMAGE:image_in"),pt(n,"NORM_RECT:norm_rect"),Je(n,"NORM_LANDMARKS:normalized_landmarks"),Je(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),sr(e,n),hu(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(r,s)=>{this.landmarks=[];for(const i of r)r=Qa(i),this.landmarks.push(fu(r));Ae(this,s)}),this.g.attachEmptyPacketListener("normalized_landmarks",r=>{this.landmarks=[],Ae(this,r)}),this.g.attachProtoVectorListener("world_landmarks",(r,s)=>{this.worldLandmarks=[];for(const i of r)r=oo(i),this.worldLandmarks.push(va(r));Ae(this,s)}),this.g.attachEmptyPacketListener("world_landmarks",r=>{this.worldLandmarks=[],Ae(this,r)}),this.outputSegmentationMasks&&(Je(n,"SEGMENTATION_MASK:segmentation_masks"),So(this,"segmentation_masks"),this.g.ca("segmentation_masks",(r,s)=>{this.segmentationMasks=r.map(i=>Eo(this,i,!0,!this.s)),Ae(this,s)}),this.g.attachEmptyPacketListener("segmentation_masks",r=>{this.segmentationMasks=[],Ae(this,r)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Xn.prototype.detectForVideo=Xn.prototype.F,Xn.prototype.detect=Xn.prototype.D,Xn.prototype.setOptions=Xn.prototype.o,Xn.createFromModelPath=function(e,t){return Qe(Xn,e,{baseOptions:{modelAssetPath:t}})},Xn.createFromModelBuffer=function(e,t){return Qe(Xn,e,{baseOptions:{modelAssetBuffer:t}})},Xn.createFromOptions=function(e,t){return Qe(Xn,e,t)},Xn.POSE_CONNECTIONS=Yv;const Kv="/Creative-Foraging-Detection-Media-Pipe/assets/selfie_multiclass_256x256-B2950kLz.tflite",G5=Kv,_c=e=>{if(!e)return null;if(typeof e=="string"){let t=e.trim();if(!t.startsWith("#")||(t=t.slice(1),t.length===3&&(t=t.split("").map(i=>i+i).join("")),t.length!==6))return null;const n=parseInt(t.slice(0,2),16),r=parseInt(t.slice(2,4),16),s=parseInt(t.slice(4,6),16);return[n,r,s].some(i=>Number.isNaN(i))?null:{r:n,g:r,b:s}}if(typeof e=="object"&&e!==null&&typeof e.h<"u"){const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let c=0,d=0,h=0;t>=0&&t<60?(c=s,d=i,h=0):t<120?(c=i,d=s,h=0):t<180?(c=0,d=s,h=i):t<240?(c=0,d=i,h=s):t<300?(c=i,d=0,h=s):(c=s,d=0,h=i);const g=x=>Math.max(0,Math.min(255,Math.round((x+a)*255)));return{r:g(c),g:g(d),b:g(h)}}return null},Ip=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),I0=(e,t)=>(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b),B0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},Qv=(e,t,n)=>{if(!e)return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1};let r=null,s=t,i=n,a=!1;try{if(typeof e.getAsUint8Array=="function")return r=e.getAsUint8Array(),s=e.width||t,i=e.height||n,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return r=e,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:!1};if(e.canvas){const c=e.canvas;return s=c.width,i=c.height,r=c.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,s,i).data,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}if(e instanceof ImageData)return r=e.data,s=e.width||t,i=e.height||n,a=!0,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a};if(e.data)return r=e.data,s=e.width||t,i=e.height||n,a=r.length>=s*i*4,{maskData:r,maskWidth:s,maskHeight:i,isRGBA:a}}catch(c){console.warn("[ColorDetector] Failed to extract category mask data:",c)}return{maskData:null,maskWidth:t,maskHeight:n,isRGBA:!1}},V5=(e,t,n,r={})=>new Promise(s=>{if(!e){s({suggestion:"None",stats:{mode:"colorMask"}});return}const i=_c(t),a=_c(n);if(!i||!a){console.warn("[ColorDetector] Invalid color configs, returning None"),s({suggestion:"None",stats:{mode:"colorMask"}});return}const{anchor:c="bottom",maxWidth:d=320,colorThreshold:h=80,minPixels:g=50,minGapRatio:x=.05}=r,w=new Image;w.crossOrigin="anonymous",w.onload=()=>{try{const _=w.width>d?d/w.width:1,D=Math.max(1,Math.round(w.width*_)),I=Math.max(1,Math.round(w.height*_)),Y=document.createElement("canvas");Y.width=D,Y.height=I;const j=Y.getContext("2d");if(!j){s({suggestion:"None",stats:{mode:"colorMask"}});return}j.drawImage(w,0,0,D,I);const y=j.getImageData(0,0,D,I),{data:A}=y,M=h*h,b={minY:I,maxY:-1,pixels:0},H={minY:I,maxY:-1,pixels:0},R=new Uint8Array(D*I);for(let J=0;J<I;J+=1)for(let re=0;re<D;re+=1){const pe=(J*D+re)*4,me=J*D+re,Se=A[pe],ie=A[pe+1],ne=A[pe+2],ee=(Se-i.r)*(Se-i.r)+(ie-i.g)*(ie-i.g)+(ne-i.b)*(ne-i.b),he=(Se-a.r)*(Se-a.r)+(ie-a.g)*(ie-a.g)+(ne-a.b)*(ne-a.b);ee<M&&ee<he?(b.pixels+=1,J<b.minY&&(b.minY=J),J>b.maxY&&(b.maxY=J),R[me]=1):he<M&&he<ee&&(H.pixels+=1,J<H.minY&&(H.minY=J),J>H.maxY&&(H.maxY=J),R[me]=2)}const O={mode:"colorMask",pixelsA:b.pixels,pixelsB:H.pixels,minYA:b.pixels>0?b.minY:null,maxYA:b.pixels>0?b.maxY:null,minYB:H.pixels>0?H.minY:null,maxYB:H.pixels>0?H.maxY:null,width:D,height:I},z=b.pixels>=g,W=H.pixels>=g;let X="None";if(z&&!W)X="A";else if(!z&&W)X="B";else if(z&&W){let J,re;c==="top"?(J=b.minY,re=H.minY):(J=b.maxY,re=H.maxY);const pe=Math.abs(J-re),me=I*x;pe>=me&&(X=c==="top"?J<re?"A":"B":J>re?"A":"B")}let q=null;try{const J=document.createElement("canvas");J.width=D,J.height=I;const re=J.getContext("2d");re.drawImage(w,0,0,D,I);const pe=re.getImageData(0,0,D,I),me=pe.data,Se=(ee,he)=>{me[ee]=Math.round(me[ee]*.3+he.r*.7),me[ee+1]=Math.round(me[ee+1]*.3+he.g*.7),me[ee+2]=Math.round(me[ee+2]*.3+he.b*.7),me[ee+3]=255},ie={r:255,g:82,b:97},ne={r:80,g:170,b:255};for(let ee=0;ee<R.length;ee+=1)R[ee]===1?Se(ee*4,ie):R[ee]===2&&Se(ee*4,ne);re.putImageData(pe,0,0),q=J.toDataURL("image/png")}catch(J){console.warn("[ColorDetector] Failed generating preview",J)}s({suggestion:X,stats:O,preview:q})}catch(_){console.error("[ColorDetector] Error processing frame:",_),s({suggestion:"None",stats:{mode:"colorMask"}})}},w.onerror=_=>{console.error("[ColorDetector] Failed to load frame image",_),s({suggestion:"None",stats:{mode:"colorMask"}})},typeof e=="string"&&e.startsWith("data:image")?w.src=e:typeof e=="string"?w.src=`data:image/jpeg;base64,${e}`:s({suggestion:"None",stats:{mode:"colorMask"}})}),R0=(e,t,n,r,s=.1)=>{if(e.length===0)return{count:0,pixels:[],largestBlobSize:0};const i=new Int32Array(t*n);for(const _ of e){const D=_.y*t+_.x;D>=0&&D<i.length&&(i[D]=1)}const a=[],c=[{dx:r,dy:0},{dx:-r,dy:0},{dx:0,dy:r},{dx:0,dy:-r}];for(const _ of e){const D=_.y*t+_.x;if(D<0||D>=i.length||i[D]!==1)continue;let I=0;const Y=[{x:_.x,y:_.y}];i[D]=2;const j=[];let y=0;for(;y<Y.length;){const{x:A,y:M}=Y[y++];I++,j.push({x:A,y:M});for(const b of c){const H=A+b.dx,R=M+b.dy;if(H>=0&&H<t&&R>=0&&R<n){const O=R*t+H;O>=0&&O<i.length&&i[O]===1&&(i[O]=2,Y.push({x:H,y:R}))}}}a.push({size:I,pixels:j})}if(a.length===0)return{count:0,pixels:[],largestBlobSize:0};const h=a.reduce((_,D)=>D.size>_.size?D:_).size,g=Math.max(1,Math.floor(h*s));let x=0;const w=[];for(const _ of a)_.size>=g&&(x+=_.size,w.push(..._.pixels));return{count:x,pixels:w,largestBlobSize:h,minBlobSize:g,totalBlobs:a.length,filteredBlobs:a.filter(_=>_.size>=g).length}},Y5=async(e,t,n,r={})=>{if(!e)return{suggestion:"None",stats:{mode:"segmentation"}};const s=_c(t),i=_c(n);if(!s||!i)return console.warn("[ColorDetector] Invalid color configs"),{suggestion:"None",stats:{mode:"segmentation"}};try{const a=await Ip(e),c=a.naturalWidth||a.width,d=a.naturalHeight||a.height,g=(await Bp()).segment(a),{maskData:x,maskWidth:w,maskHeight:_,isRGBA:D}=Qv(g.categoryMask,c,d);if(!x)throw new Error("Failed to extract segmentation mask data");const I=new Uint8ClampedArray(c*d*4),Y=c/w,j=d/_;for(let U=0;U<d;U++)for(let G=0;G<c;G++){const Q=Math.min(w-1,Math.floor(G/Y)),$=(Math.min(_-1,Math.floor(U/j))*w+Q)*(D?4:1);let m=0;x&&$<x.length&&(m=x[$]);const P=m!==0&&m!==2?255:0,N=(U*c+G)*4;I[N]=P,I[N+1]=P,I[N+2]=P,I[N+3]=255}const y=document.createElement("canvas");y.width=c,y.height=d;const A=y.getContext("2d");A.drawImage(a,0,0,c,d);const M=A.getImageData(0,0,c,d).data,b=r.maskThreshold||100,H=r.colorThreshold??95,R=r.anchor||"top",O=H*H,z=r.scanDepth??1,W=r.stride||2;let X=R==="top"?d:0,q=!1;if(R==="top")for(let U=0;U<d;U+=W){for(let G=0;G<c;G+=W)if(I[(U*c+G)*4]>=b){X=U,q=!0;break}if(q)break}else for(let U=d-1;U>=0;U-=W){for(let G=0;G<c;G+=W)if(I[(U*c+G)*4]>=b){X=U,q=!0;break}if(q)break}let J,re,pe;if(r.manualBounds&&R==="manually")J=r.manualBounds.topY,re=r.manualBounds.bottomY,pe=re-J,q||(X=J);else{if(!q)return{suggestion:"None",stats:{mode:"segmentation",reason:"no_person"},preview:null,maskPreview:null};pe=z?Math.floor(d*z):d,R==="top"?(J=X,re=Math.min(d,X+pe)):(J=Math.max(0,X-pe),re=X)}const me=[],Se=[];for(let U=J;U<re;U+=W)for(let G=0;G<c;G+=W){const Q=(U*c+G)*4;if(I[Q]<b)continue;const te=M[Q],$=M[Q+1],m=M[Q+2],P=I0({r:te,g:$,b:m},s),N=I0({r:te,g:$,b:m},i);P<O&&P<N?me.push({x:G,y:U}):N<O&&N<P&&Se.push({x:G,y:U})}const ie=r.minBlobRatio??.1,ne=R0(me,c,d,W,ie),ee=R0(Se,c,d,W,ie),he=ne.count,_e=ee.count,We=ne.pixels.map(U=>({...U,idx:(U.y*c+U.x)*4})),ze=ee.pixels.map(U=>({...U,idx:(U.y*c+U.x)*4})),Ne=50;let De="None",se=null;he>Ne&&he>_e?(De="A",se={color:"A",pixelCount:he,minY:J,maxY:re,anchorY:X,rawPixels:me.length,largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize}):_e>Ne&&_e>he&&(De="B",se={color:"B",pixelCount:_e,minY:J,maxY:re,anchorY:X,rawPixels:Se.length,largestBlobSize:ee.largestBlobSize,minBlobSize:ee.minBlobSize});let le=null,ve=null;try{const U=document.createElement("canvas");U.width=c,U.height=d;const G=U.getContext("2d");G.drawImage(a,0,0,c,d),G.fillStyle="rgba(0,0,0,0.6)",G.fillRect(0,0,c,d),G.globalCompositeOperation="destination-out",G.fillStyle="rgba(0,0,0,1)",G.fillRect(0,J,c,re-J),G.globalCompositeOperation="destination-over",G.drawImage(a,0,0,c,d),G.globalCompositeOperation="source-over";const Q=G.createImageData(c,d),te=Q.data;for(let F=J;F<re;F+=1)for(let V=0;V<c;V+=1){const Z=(F*c+V)*4;I[Z]>=b&&(te[Z]=0,te[Z+1]=255,te[Z+2]=255,te[Z+3]=90)}G.putImageData(Q,0,0);const $=G.createImageData(c,d),m=$.data;for(const F of We){const V=F.idx;V>=0&&V<m.length-3&&(m[V]=255,m[V+1]=0,m[V+2]=0,m[V+3]=180)}for(const F of ze){const V=F.idx;V>=0&&V<m.length-3&&(m[V]=0,m[V+1]=100,m[V+2]=255,m[V+3]=180)}G.putImageData($,0,0),G.globalCompositeOperation="source-over",G.strokeStyle="#00FF00",G.lineWidth=3,G.setLineDash([]),G.beginPath(),G.moveTo(0,J),G.lineTo(c,J),G.stroke(),G.strokeStyle="#FFFF00",G.lineWidth=3,G.setLineDash([5,5]),G.beginPath(),G.moveTo(0,re),G.lineTo(c,re),G.stroke(),X!==J&&X!==re&&(G.strokeStyle="#FF00FF",G.lineWidth=2,G.setLineDash([2,2]),G.beginPath(),G.moveTo(0,X),G.lineTo(c,X),G.stroke()),le=U.toDataURL("image/png");const P=document.createElement("canvas");P.width=c,P.height=d;const N=P.getContext("2d"),v=N.createImageData(c,d),T=v.data;for(let F=0;F<c*d;F+=1){const V=F*4,ce=I[F*4]>=b?255:0;T[V]=ce,T[V+1]=ce,T[V+2]=ce,T[V+3]=255}N.putImageData(v,0,0),ve=P.toDataURL("image/png")}catch(U){console.warn("[ColorDetector] Failed generating preview",U)}const fe={mode:"segmentation",width:c,height:d,pixelsA:he,pixelsB:_e,rawPixelsA:me.length,rawPixelsB:Se.length,tipY:X,scanDepth:pe,scanDepthRatio:z,anchor:R,bestArm:se,blobInfoA:{largestBlobSize:ne.largestBlobSize,minBlobSize:ne.minBlobSize,totalBlobs:ne.totalBlobs,filteredBlobs:ne.filteredBlobs,droppedPixels:me.length-he},blobInfoB:{largestBlobSize:ee.largestBlobSize,minBlobSize:ee.minBlobSize,totalBlobs:ee.totalBlobs,filteredBlobs:ee.filteredBlobs,droppedPixels:Se.length-_e},minBlobRatio:ie};return{suggestion:De,stats:fe,preview:le,maskPreview:ve}}catch(a){return console.error("[ColorDetector] Segmentation failed:",a),{suggestion:"None"}}},X5=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},Nc=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),K5=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,c=-1/0;for(const x of e){const w=Nc(x,i);w>c&&(c=w,a=x)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,g=!0;for(;g&&h<n;){g=!1;for(let _=0;_<e.length;_++){let D=0,I=1/0;for(let Y=0;Y<s.length;Y++){const j=Nc(e[_],s[Y]);j<I&&(I=j,D=Y)}d[_]!==D&&(d[_]=D,g=!0)}const x=Array.from({length:s.length},()=>new Array(r).fill(0)),w=new Array(s.length).fill(0);e.forEach((_,D)=>{const I=d[D];w[I]+=1;for(let Y=0;Y<r;Y++)x[I][Y]+=_[Y]});for(let _=0;_<s.length;_++)w[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=x[_].map(D=>D/w[_]);h+=1}return{assignments:d,centroids:s}},Q5=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for cloth analysis");const n=await Bp(),r=t.maxFrames||e.length,s=t.stride||2;t.minClothPixels;const i=t.manualBounds||null,a=e.slice(0,r),c=[];let d=0;for(const y of a)try{const A=await Ip(y.frameDataUrl),M=A.naturalWidth||A.width,b=A.naturalHeight||A.height,H=n.segment(A),{maskData:R,maskWidth:O,maskHeight:z,isRGBA:W}=Qv(H.categoryMask,M,b);if(!R){d+=1;continue}const X=document.createElement("canvas");X.width=M,X.height=b;const q=X.getContext("2d");q.drawImage(A,0,0,M,b);const J=q.getImageData(0,0,M,b).data,re=M/O,pe=b/z;let me,Se=0,ie=1,ne=0,ee=M/2,he=b/2;if(i){if(me=i.bottomY-i.topY,Se=i.rotation||0,Se!==0){const $=-Se*Math.PI/180;ie=Math.cos($),ne=Math.sin($)}}else me=b;const _e=Math.floor(me/s),We=Math.floor(M/s),ze=_e*We,De=Math.max(Math.floor(ze*.005),20);let se=0,le=0,ve=0,fe=0,U=0,G=0;for(let $=0;$<b;$+=s){if(i&&Se===0&&($<i.topY||$>i.bottomY))continue;const m=Math.min(z-1,Math.floor($/pe));for(let P=0;P<M;P+=s){if(i&&Se!==0){const F=P-ee,V=$-he,Z=F*ne+V*ie+he;if(Z<i.topY||Z>i.bottomY)continue}const N=Math.min(O-1,Math.floor(P/re)),v=(m*O+N)*(W?4:1);if(R[v]===4){const F=($*M+P)*4,V=J[F],Z=J[F+1],ce=J[F+2];se+=V,le+=Z,ve+=ce,fe+=P,U+=$,G+=1}}}if(G<De){console.log(`[Cloth] Frame ${y.moveId} SKIPPED - cloth pixels: ${G}, threshold: ${De}, scan area: ${me}px, manual bounds: ${i?"YES":"NO"}`),d+=1;continue}console.log(`[Cloth] Frame ${y.moveId} ACCEPTED - cloth pixels: ${G}, threshold: ${De}, scan area: ${me}px, manual bounds: ${i?`Y:${i.topY}-${i.bottomY}`:"NO"}`);const Q={r:se/G,g:le/G,b:ve/G};let te=null;try{const $=document.createElement("canvas");$.width=M,$.height=b;const m=$.getContext("2d");m.drawImage(A,0,0,M,b);const P=m.getImageData(0,0,M,b),N=P.data;for(let v=0;v<b;v+=1){const T=Math.min(z-1,Math.floor(v/pe));for(let F=0;F<M;F+=1){const V=Math.min(O-1,Math.floor(F/re)),Z=(T*O+V)*(W?4:1);if(R[Z]===4){const Ee=(v*M+F)*4;N[Ee]=Math.round(N[Ee]*.5+50),N[Ee+1]=Math.round(N[Ee+1]*.5+255*.5),N[Ee+2]=Math.round(N[Ee+2]*.5+50)}}}m.putImageData(P,0,0),i&&(m.save(),Se!==0&&(m.translate(ee,he),m.rotate(Se*Math.PI/180),m.translate(-ee,-he)),m.strokeStyle="#00FF00",m.lineWidth=3,m.setLineDash([]),m.beginPath(),m.moveTo(-M,i.topY),m.lineTo(M*2,i.topY),m.stroke(),m.strokeStyle="#FFFF00",m.lineWidth=3,m.setLineDash([5,5]),m.beginPath(),m.moveTo(-M,i.bottomY),m.lineTo(M*2,i.bottomY),m.stroke(),m.fillStyle="rgba(0, 255, 0, 0.2)",m.fillRect(-M,i.topY,M*3,i.bottomY-i.topY),m.fillStyle="#00FF00",m.font="bold 16px Arial",m.fillText(`Manual Scan Area (${me}px)`,10,i.topY-10),m.restore()),m.fillStyle="rgba(0, 0, 0, 0.7)",m.fillRect(10,10,300,80),m.fillStyle="#FFFFFF",m.font="bold 14px Arial",m.fillText(`Cloth Pixels: ${G}`,20,30),m.fillText(`Threshold: ${De}`,20,50),m.fillText(`Mean Color: ${B0(Q.r,Q.g,Q.b)}`,20,70),te=$.toDataURL("image/png")}catch($){console.warn("[ColorDetector] Failed to generate debug preview:",$)}c.push({moveId:y.moveId,meanColor:Q,feature:[Q.r/255,Q.g/255,Q.b/255],centroidX:fe/G/M,centroidY:U/G/b,pixelCount:G,existingPlayer:y.existingPlayer||null,debugPreview:te})}catch(A){console.warn("[ColorDetector] Cloth analysis failed for frame",y.moveId,A),d+=1}if(c.length<2)throw new Error("Not enough frames with detectable clothing");const h=c.map(y=>y.feature),{assignments:g,centroids:x}=K5(h,Math.min(2,c.length)),w=x.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));g.forEach((y,A)=>{const M=c[A],b=w[y];b.samples.push({moveId:M.moveId,centroidX:M.centroidX,centroidY:M.centroidY,pixelCount:M.pixelCount}),b.sumR+=M.meanColor.r,b.sumG+=M.meanColor.g,b.sumB+=M.meanColor.b,b.sumPixels+=M.pixelCount,b.sumBrightness+=(M.meanColor.r+M.meanColor.g+M.meanColor.b)/3,(M.existingPlayer==="Player A"||M.existingPlayer==="Player B")&&(b.labelCounts[M.existingPlayer]+=1)});const _={};w.forEach((y,A)=>{const M=y.labelCounts["Player A"],b=y.labelCounts["Player B"];M>b?_[A]="Player A":b>M&&(_[A]="Player B")});const D=w.map((y,A)=>{const M=y.sumR/Math.max(1,y.samples.length),b=y.sumG/Math.max(1,y.samples.length),H=y.sumB/Math.max(1,y.samples.length);return{idx:A,hue:X5(M,b,H),brightness:y.sumBrightness/Math.max(1,y.samples.length)}}).sort((y,A)=>y.hue-A.hue||y.brightness-A.brightness),I=["Player A","Player B"];D.forEach(({idx:y})=>{if(!_[y]){const A=Object.values(_),M=I.find(b=>!A.includes(b))||"Player A";_[y]=M}});const Y={};g.forEach((y,A)=>{const M=c[A],b=_[y]||(y===0?"Player A":"Player B"),H=x[y],R=x[y===0?1:0],O=Nc(M.feature,H),z=R?Nc(M.feature,R):O,W=R?Math.max(0,1-O/(O+z+1e-6)):1;Y[M.moveId]={player:b,clusterId:y,styleLabel:`Style ${y+1}`,confidence:W,stats:{meanColor:M.meanColor,pixelCount:M.pixelCount,debugPreview:M.debugPreview}}});const j=w.map((y,A)=>{const M=y.sumR/Math.max(1,y.samples.length),b=y.sumG/Math.max(1,y.samples.length),H=y.sumB/Math.max(1,y.samples.length),R=B0(M,b,H);return{id:A,styleLabel:`Style ${A+1}`,assignedPlayer:_[A]||(A===0?"Player A":"Player B"),hexColor:R,meanColor:{r:M,g:b,b:H},sampleCount:y.samples.length,avgPixels:y.sumPixels/Math.max(1,y.samples.length),avgBrightness:y.sumBrightness/Math.max(1,y.samples.length),knownAssignments:y.labelCounts}});return{assignments:Y,clusters:j,analytics:{totalFrames:a.length,usedFrames:c.length,skippedFrames:d,clusters:j}}};let gd=null;const Bp=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!gd){const e=await Es.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");gd=await fn.createFromOptions(e,{baseOptions:{modelAssetPath:G5,delegate:"GPU"},outputCategoryMask:!0,outputConfidenceMasks:!1,runningMode:"IMAGE"})}return gd},J5=async e=>{try{const t=await Ip(e),n=t.naturalWidth||t.width,r=t.naturalHeight||t.height,i=(await Bp()).segment(t);if(!i.categoryMask)throw new Error("No category mask returned");const a=[{id:0,name:"Background",desc:"Walls, ceiling, screen",color:[0,0,0]},{id:1,name:"Hair",desc:"Hair",color:[255,140,0]},{id:2,name:"Body Skin",desc:'Arms, neck (Your "Arm" layer)',color:[255,0,0]},{id:3,name:"Face Skin",desc:"Face skin",color:[255,200,100]},{id:4,name:"Clothes",desc:"T-shirt, etc.",color:[0,100,255]},{id:5,name:"Others",desc:"Accessories (Watch, wristband)",color:[255,255,0]}];let c;if(i.categoryMask.getAsUint8Array)c=i.categoryMask.getAsUint8Array();else if(i.categoryMask.canvas){if(c=i.categoryMask.canvas.getContext("2d").getImageData(0,0,n,r).data,c.length===n*r*4){const g=new Uint8Array(n*r);for(let x=0;x<n*r;x++)g[x]=c[x*4];c=g}}else if(i.categoryMask instanceof Uint8Array)c=i.categoryMask;else{const h=i.categoryMask.data||i.categoryMask;if(h.length===n*r*4){const g=new Uint8Array(n*r);for(let x=0;x<n*r;x++)g[x]=h[x*4];c=g}else c=h}return await Promise.all(a.map(async h=>{const g=document.createElement("canvas");g.width=n,g.height=r;const x=g.getContext("2d");x.drawImage(t,0,0,n,r);const w=x.getImageData(0,0,n,r),_=w.data;let D=0;for(let I=0;I<c.length;I++)if(c[I]===h.id){D++;const Y=I*4;h.id===0?(_[Y]=_[Y]*.25,_[Y+1]=_[Y+1]*.25,_[Y+2]=_[Y+2]*.25):(_[Y]=(_[Y]+h.color[0])/2,_[Y+1]=(_[Y+1]+h.color[1])/2,_[Y+2]=(_[Y+2]+h.color[2])/2)}return x.putImageData(w,0,0),{...h,pixelCount:D,preview:g.toDataURL("image/png")}}))}catch(t){return console.error("[ColorDetector] Multiclass segmentation failed:",t),null}},q5=Kv,Z5=e=>new Promise((t,n)=>{if(!e||typeof e!="string"){n(new Error("Invalid image source"));return}const r=new Image;r.crossOrigin="anonymous",r.onload=()=>t(r),r.onerror=s=>n(s),e.startsWith("data:image")?r.src=e:r.src=`data:image/jpeg;base64,${e}`}),Xi=(e=[],t=[])=>Math.sqrt(e.reduce((n,r,s)=>n+Math.pow(r-(t[s]||0),2),0)),e6=(e=[],t=2,n=25)=>{if(!Array.isArray(e)||e.length===0)throw new Error("No points provided for k-means clustering");const r=e[0].length;let s=[];const i=e[0];let a=i,c=-1/0;for(const x of e){const w=Xi(x,i);w>c&&(c=w,a=x)}for(s.push(i.slice()),t>1&&s.push(a.slice());s.length<t;)s.push(e[Math.floor(Math.random()*e.length)].slice());let d=new Array(e.length).fill(0),h=0,g=!0;for(;g&&h<n;){g=!1;for(let _=0;_<e.length;_++){let D=0,I=1/0;for(let Y=0;Y<s.length;Y++){const j=Xi(e[_],s[Y]);j<I&&(I=j,D=Y)}d[_]!==D&&(d[_]=D,g=!0)}const x=Array.from({length:s.length},()=>new Array(r).fill(0)),w=new Array(s.length).fill(0);e.forEach((_,D)=>{const I=d[D];w[I]+=1;for(let Y=0;Y<r;Y++)x[I][Y]+=_[Y]});for(let _=0;_<s.length;_++)w[_]===0?s[_]=e[Math.floor(Math.random()*e.length)].slice():s[_]=x[_].map(D=>D/w[_]);h+=1}return{assignments:d,centroids:s}},t6=(e,t,n)=>{e/=255,t/=255,n/=255;const r=Math.max(e,t,n),s=Math.min(e,t,n);if(r===s)return 0;let i=0;return r===e?i=(t-n)/(r-s):r===t?i=2+(n-e)/(r-s):i=4+(e-t)/(r-s),i*=60,i<0&&(i+=360),i},L0=(e,t,n)=>{const r=s=>{const i=Math.max(0,Math.min(255,Math.round(s))).toString(16);return i.length===1?`0${i}`:i};return`#${r(e)}${r(t)}${r(n)}`.toUpperCase()},F0=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null};let yd=null;const n6=async()=>{if(typeof window>"u")throw new Error("Image segmenter is only available in the browser");if(!yd){const e=await Es.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm");yd=await fn.createFromOptions(e,{baseOptions:{modelAssetPath:q5,delegate:"GPU"},outputCategoryMask:!1,outputConfidenceMasks:!0,runningMode:"IMAGE"})}return yd},r6=async(e=[],t={})=>{if(!Array.isArray(e)||e.length===0)throw new Error("No frames provided for analysis");const n=await n6(),r=t.maxFrames||e.length,s=t.stride||2,i=t.minPixels||5,a=t.manualBounds||null,c=t.playerColors||null,d=t.sensitivity||.8,h=e.slice(0,r),g=[];let x=0;for(const b of h)try{const H=await Z5(b.frameDataUrl),R=H.naturalWidth||H.width,O=H.naturalHeight||H.height,z=n.segment(H),W=z.confidenceMasks[0].getAsFloat32Array(),X=z.confidenceMasks[0].width,q=z.confidenceMasks[0].height,J=document.createElement("canvas");J.width=R,J.height=O;const re=J.getContext("2d");re.drawImage(H,0,0,R,O);const pe=re.getImageData(0,0,R,O).data,me=R/X,Se=O/q;let ie=0,ne=O,ee=0,he=1,_e=0,We=R/2,ze=O/2;if(a)if(ee=a.rotation||0,ee!==0){const Q=-ee*Math.PI/180;he=Math.cos(Q),_e=Math.sin(Q),ie=0,ne=O}else ie=Math.max(0,a.topY),ne=Math.min(O,a.bottomY);let Ne=0,De=0,se=0,le=0,ve=0,fe=0;for(let Q=ie;Q<ne;Q+=s){const te=Math.min(q-1,Math.floor(Q/Se));for(let $=0;$<R;$+=s){if(a&&ee!==0){const v=$-We,T=Q-ze,F=v*_e+T*he+ze;if(F<a.topY||F>a.bottomY)continue}const m=Math.min(X-1,Math.floor($/me)),P=te*X+m;if(W[P]<d){const v=(Q*R+$)*4,T=pe[v],F=pe[v+1],V=pe[v+2];Ne+=T,De+=F,se+=V,le+=$,ve+=Q,fe+=1}}}if(fe<i){x+=1;continue}const U={r:Ne/fe,g:De/fe,b:se/fe};let G=null;try{const Q=document.createElement("canvas");Q.width=R,Q.height=O;const te=Q.getContext("2d");te.drawImage(H,0,0,R,O);const $=te.getImageData(0,0,R,O),m=$.data;for(let P=0;P<O;P+=1){const N=Math.min(q-1,Math.floor(P/Se));for(let v=0;v<R;v+=1){const T=Math.min(X-1,Math.floor(v/me)),F=N*X+T;if(W[F]<d){const Z=(P*R+v)*4;m[Z]=Math.min(255,m[Z]+50),m[Z+1]=Math.max(0,m[Z+1]-20),m[Z+2]=Math.max(0,m[Z+2]-20)}}}if(te.putImageData($,0,0),a){te.save(),ee!==0&&(te.translate(We,ze),te.rotate(ee*Math.PI/180),te.translate(-We,-ze)),te.strokeStyle="#00FF00",te.lineWidth=3,te.setLineDash([]),te.beginPath(),te.moveTo(-R,a.topY),te.lineTo(R*2,a.topY),te.stroke(),te.strokeStyle="#FFFF00",te.lineWidth=3,te.setLineDash([5,5]),te.beginPath(),te.moveTo(-R,a.bottomY),te.lineTo(R*2,a.bottomY),te.stroke(),te.fillStyle="rgba(0, 255, 0, 0.2)",te.fillRect(-R,a.topY,R*3,a.bottomY-a.topY);const P=a.bottomY-a.topY;te.fillStyle="#00FF00",te.font="bold 16px Arial",te.fillText(`Manual Scan Area (${P}px)`,10,a.topY-10),te.restore()}te.fillStyle="rgba(0, 0, 0, 0.7)",te.fillRect(10,10,300,80),te.fillStyle="#FFFFFF",te.font="bold 14px Arial",te.fillText(`Non-BG Pixels: ${fe}`,20,30),te.fillText(`Threshold: ${i}`,20,50),te.fillText(`Mean Color: ${L0(U.r,U.g,U.b)}`,20,70),G=Q.toDataURL("image/png")}catch(Q){console.warn("[ColorDetectorGeneral] Failed to generate debug preview:",Q)}g.push({moveId:b.moveId,meanColor:U,feature:[U.r/255,U.g/255,U.b/255],centroidX:le/fe/R,centroidY:ve/fe/O,pixelCount:fe,existingPlayer:b.existingPlayer||null,debugPreview:G})}catch(H){console.warn("[ColorDetectorGeneral] Analysis failed for frame",b.moveId,H),x+=1}if(g.length<2)throw new Error("Not enough frames with detectable pixels (need at least 2)");const w=g.map(b=>b.feature),{assignments:_,centroids:D}=e6(w,Math.min(2,g.length)),I=D.map(()=>({samples:[],sumR:0,sumG:0,sumB:0,sumPixels:0,sumBrightness:0,labelCounts:{"Player A":0,"Player B":0}}));_.forEach((b,H)=>{const R=g[H],O=I[b];O.samples.push({moveId:R.moveId,centroidX:R.centroidX,centroidY:R.centroidY,pixelCount:R.pixelCount}),O.sumR+=R.meanColor.r,O.sumG+=R.meanColor.g,O.sumB+=R.meanColor.b,O.sumPixels+=R.pixelCount,O.sumBrightness+=(R.meanColor.r+R.meanColor.g+R.meanColor.b)/3,(R.existingPlayer==="Player A"||R.existingPlayer==="Player B")&&(O.labelCounts[R.existingPlayer]+=1)});const Y={};if(c&&c["Player A"]&&c["Player B"]){const b=F0(c["Player A"]),H=F0(c["Player B"]);if(b&&H){const R=I.map((O,z)=>{const W=O.sumR/Math.max(1,O.samples.length),X=O.sumG/Math.max(1,O.samples.length),q=O.sumB/Math.max(1,O.samples.length),J=[W,X,q];return{idx:z,distA:Xi(J,[b.r,b.g,b.b]),distB:Xi(J,[H.r,H.g,H.b])}});if(R.length===2){const O=R[0],z=R[1],W=O.distA+z.distB,X=O.distB+z.distA;W<X?(Y[O.idx]="Player A",Y[z.idx]="Player B"):(Y[O.idx]="Player B",Y[z.idx]="Player A")}else R.forEach(O=>{O.distA<O.distB?Y[O.idx]="Player A":Y[O.idx]="Player B"})}}I.forEach((b,H)=>{if(Y[H])return;const R=b.labelCounts["Player A"],O=b.labelCounts["Player B"];R>O?Y[H]="Player A":O>R&&(Y[H]="Player B")});const j=I.map((b,H)=>{const R=b.sumR/Math.max(1,b.samples.length),O=b.sumG/Math.max(1,b.samples.length),z=b.sumB/Math.max(1,b.samples.length);return{idx:H,hue:t6(R,O,z),brightness:b.sumBrightness/Math.max(1,b.samples.length)}}).sort((b,H)=>b.hue-H.hue||b.brightness-H.brightness),y=["Player A","Player B"];j.forEach(({idx:b})=>{if(!Y[b]){const H=Object.values(Y),R=y.find(O=>!H.includes(O))||"Player A";Y[b]=R}});const A={};_.forEach((b,H)=>{const R=g[H],O=Y[b]||(b===0?"Player A":"Player B"),z=D[b],W=D[b===0?1:0],X=Xi(R.feature,z),q=W?Xi(R.feature,W):X,J=W?Math.max(0,1-X/(X+q+1e-6)):1,re=I[b],pe=re.sumR/Math.max(1,re.samples.length),me=re.sumG/Math.max(1,re.samples.length),Se=re.sumB/Math.max(1,re.samples.length);A[R.moveId]={player:O,clusterId:b,styleLabel:`Style ${b+1}`,confidence:J,stats:{meanColor:{r:pe,g:me,b:Se},pixelCount:R.pixelCount,debugPreview:R.debugPreview}}});const M=I.map((b,H)=>{const R=b.sumR/Math.max(1,b.samples.length),O=b.sumG/Math.max(1,b.samples.length),z=b.sumB/Math.max(1,b.samples.length),W=L0(R,O,z);return{id:H,styleLabel:`Style ${H+1}`,assignedPlayer:Y[H]||(H===0?"Player A":"Player B"),hexColor:W,meanColor:{r:R,g:O,b:z},sampleCount:b.samples.length,avgPixels:b.sumPixels/Math.max(1,b.samples.length),avgBrightness:b.sumBrightness/Math.max(1,b.samples.length),knownAssignments:b.labelCounts}});return{assignments:A,clusters:M,analytics:{totalFrames:h.length,usedFrames:g.length,skippedFrames:x,clusters:M}}},vd=(e,t)=>!t||!e?"0%":`${(e/t*100).toFixed(1)}%`,s6=e=>typeof e!="number"?"":`${e.toLocaleString()} pixels`;function i6({colorPreview:e,onClose:t}){var _,D,I,Y,j,y,A,M,b,H,R,O,z,W;const[n,r]=k.useState("overview"),[s,i]=k.useState(null),[a,c]=k.useState(!1),d=async()=>{if(e!=null&&e.original){c(!0);try{const X=await J5(e.original);i(X)}catch(X){console.error("Failed to run multiclass segmentation:",X)}finally{c(!1)}}};if(!e)return null;const h=e==null?void 0:e.stats,g=h!=null&&h.width&&(h!=null&&h.height)?h.width*h.height:0,x=e!=null&&e.anchor?e.anchor==="top"?"Top edge (closest to ceiling camera)":"Bottom edge (closest to screen base)":"",w=(h==null?void 0:h.mode)==="arm-segmentation"?"Arm Segmentation (MediaPipe Image Segmenter)":(h==null?void 0:h.mode)==="segmentation"?"Segmentation (MediaPipe Selfie)":"Color band mask";return l.jsx("div",{className:"image-modal",onClick:t,children:l.jsxs("div",{className:"image-modal-content color-preview-modal",onClick:X=>X.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:t,children:""}),l.jsxs("div",{className:"color-preview-tabs",children:[l.jsx("button",{className:`color-preview-tab ${n==="overview"?"active":""}`,onClick:()=>r("overview"),children:"Overview"}),l.jsx("button",{className:`color-preview-tab ${n==="multiclass"?"active":""}`,onClick:()=>{r("multiclass"),!s&&!a&&d()},children:"MediaPipe Classes (6)"})]}),n==="overview"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"color-preview-grid",children:[l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Original Frame"}),l.jsx("img",{src:e.original,alt:"Original frame"})]}),l.jsxs("div",{className:"color-preview-panel",children:[l.jsx("h3",{children:"Mask View"}),e.preview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((_=e.stats)==null?void 0:_.mode)==="segmentation"?"Overlay: Cyan = MediaPipe Person | Red/Blue = Filtered Blobs Only (Noise Removed) | Green Line = Top Boundary | Yellow Dashed = Bottom Boundary | Magenta = Tip (if different)":((D=e.stats)==null?void 0:D.mode)==="arm-segmentation"?"Arms Only - Color Detection (Red = Player A, Blue = Player B)":"Color Overlay"}),l.jsx("img",{src:e.preview,alt:"Mask preview"})]}):e.maskPreview?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"mask-label",children:((I=e.stats)==null?void 0:I.mode)==="arm-segmentation"?"Arms Only Mask (White = Arms, Black = Background)":"MediaPipe Segmentation (White = Person, Black = Background)"}),l.jsx("img",{src:e.maskPreview,alt:"MediaPipe mask"})]}):l.jsx("p",{children:"No mask preview available"})]})]}),e.stats&&l.jsxs("div",{className:"color-preview-stats",children:[l.jsxs("div",{className:"color-preview-meta",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Frame:"})," ",e.stats.width&&e.stats.height?`${e.stats.width}  ${e.stats.height} (${g.toLocaleString()} px)`:""]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Method:"})," ",w]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Anchor:"})," ",x]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Suggestion:"})," ",e.suggestion==="A"?"Player A":e.suggestion==="B"?"Player B":"None"]}),e.stats.detectionPoint&&l.jsxs("div",{children:[l.jsx("strong",{children:"Detected point:"})," ",e.stats.detectionPoint.label," (",e.stats.detectionPoint.x,","," ",e.stats.detectionPoint.y,")"]}),e.stats.mode==="segmentation"&&typeof e.stats.personPixels=="number"&&l.jsxs("div",{children:[l.jsx("strong",{children:"Person coverage:"})," ",s6(e.stats.personPixels)]}),e.stats.reason&&l.jsxs("div",{children:[l.jsx("strong",{children:"Note:"})," ",e.stats.reason]})]}),l.jsxs("div",{className:"color-preview-calibration",children:[l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player A color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorA}})]}),l.jsx("code",{children:e.colorA||""}),e.calibrationA&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationA.h??""," / s=",e.calibrationA.s??""," / v=",e.calibrationA.v??""]})]}),l.jsxs("div",{className:"calibration-card",children:[l.jsxs("div",{className:"calibration-header",children:[l.jsx("span",{className:"player-label",children:"Player B color"}),l.jsx("div",{className:"color-chip",style:{backgroundColor:e.colorB}})]}),l.jsx("code",{children:e.colorB||""}),e.calibrationB&&l.jsxs("div",{className:"calibration-hsv",children:["HSV: h=",e.calibrationB.h??""," / s=",e.calibrationB.s??""," / v=",e.calibrationB.v??""]})]})]}),e.stats.mode==="segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:"Detection Results"}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Scan Zone"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.tipY??""]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Depth:"})," ",((Y=e.stats.scanDepth)==null?void 0:Y.toLocaleString())||0," pixels (",e.stats.scanDepthRatio?`${(e.stats.scanDepthRatio*100).toFixed(0)}%`:"",")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Anchor:"})," ",e.stats.anchor==="top"?"Top":e.stats.anchor==="manually"?"Manual":"Bottom"]}),e.stats.minBlobRatio!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Blob filter:"})," Keep blobs  ",((e.stats.minBlobRatio||.1)*100).toFixed(0),"% of largest"]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color A Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((j=e.stats.pixelsA)==null?void 0:j.toLocaleString())||0," pixels"]}),e.stats.rawPixelsA!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((y=e.stats.rawPixelsA)==null?void 0:y.toLocaleString())||0," pixels"]}),e.stats.blobInfoA&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((A=e.stats.blobInfoA.largestBlobSize)==null?void 0:A.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((M=e.stats.blobInfoA.minBlobSize)==null?void 0:M.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoA.filteredBlobs||0," / ",e.stats.blobInfoA.totalBlobs||0," kept"]})]})]}),l.jsxs("div",{className:"segmentation-card",children:[l.jsx("h4",{children:"Color B Pixels"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Filtered:"})," ",((b=e.stats.pixelsB)==null?void 0:b.toLocaleString())||0," pixels"]}),e.stats.rawPixelsB!==void 0&&l.jsxs("p",{children:[l.jsx("strong",{children:"Raw (before blob filter):"})," ",((H=e.stats.rawPixelsB)==null?void 0:H.toLocaleString())||0," pixels"]}),e.stats.blobInfoB&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Largest blob:"})," ",((R=e.stats.blobInfoB.largestBlobSize)==null?void 0:R.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Min blob size:"})," ",((O=e.stats.blobInfoB.minBlobSize)==null?void 0:O.toLocaleString())||0," px"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Blobs:"})," ",e.stats.blobInfoB.filteredBlobs||0," / ",e.stats.blobInfoB.totalBlobs||0," kept"]})]})]}),e.stats.bestArm&&l.jsxs("div",{className:"segmentation-card",style:{border:"2px solid #4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)"},children:[l.jsxs("h4",{children:["Best Match: Player ",e.stats.bestArm.color,l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:""})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixel Count:"})," ",((z=e.stats.bestArm.pixelCount)==null?void 0:z.toLocaleString())||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Scan Zone:"})," Y=",e.stats.bestArm.minY,"  ",e.stats.bestArm.maxY]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Tip Y:"})," ",e.stats.bestArm.anchorY]})]})]}):e.stats.mode==="arm-segmentation"?l.jsxs("div",{className:"segmentation-breakdown",children:[l.jsxs("h3",{style:{marginBottom:"1rem",fontSize:"1.1rem",color:"#4CAF50"},children:["Detected Arms (",((W=e.stats.armRegions)==null?void 0:W.length)||0,")"]}),e.stats.armRegions&&e.stats.armRegions.length>0?e.stats.armRegions.map((X,q)=>{const J=e.stats.bestArm&&X.category===e.stats.bestArm.category&&X.dominantColor===e.stats.bestArm.dominantColor;return l.jsxs("div",{className:"segmentation-card",style:{border:J?"2px solid #4CAF50":"1px solid #2a2a2a",backgroundColor:J?"rgba(76, 175, 80, 0.1)":"#0f0f0f"},children:[l.jsxs("h4",{children:["Arm ",q+1,": ",X.categoryName,J&&l.jsx("span",{style:{color:"#4CAF50",marginLeft:"0.5rem"},children:" Best Match"})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Dominant Color:"})," ",l.jsxs("span",{style:{color:X.dominantColor==="A"?"#FF5252":"#2196F3",fontWeight:"bold"},children:["Player ",X.dominantColor]})]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels A:"})," ",X.pixelsA||0," | ",l.jsx("strong",{children:"Pixels B:"})," ",X.pixelsB||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Total arm pixels:"})," ",X.pixelCount||0]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," Y=",X.minY,"  ",X.maxY," (Anchor Y: ",X.anchorY,")"]})]},q)}):l.jsx("p",{children:"No arms detected with matching colors"})]}):l.jsxs("div",{className:"color-preview-breakdown",children:[l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player A band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsA||0," ","(",vd(e.stats.pixelsA,g),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYA??"","  ",e.stats.maxYA??""]})]}),l.jsxs("div",{className:"breakdown-card",children:[l.jsx("h4",{children:"Player B band"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Pixels:"})," ",e.stats.pixelsB||0," ","(",vd(e.stats.pixelsB,g),")"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Vertical span:"})," ",e.stats.minYB??"","  ",e.stats.maxYB??""]})]})]})]})]}):l.jsxs("div",{className:"multiclass-view",children:[l.jsxs("div",{className:"multiclass-header",children:[l.jsx("h2",{children:"MediaPipe Multiclass Segmentation (6 Classes)"}),l.jsx("p",{children:"Verifying layer detection quality. The model identifies these specific regions:"})]}),a&&l.jsxs("div",{className:"loading-indicator",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Running segmentation model..."})]}),!a&&s&&l.jsx("div",{className:"multiclass-grid",children:s.map(X=>l.jsxs("div",{className:"multiclass-card",children:[l.jsxs("div",{className:"multiclass-card-header",style:{borderLeft:`5px solid rgb(${X.color.join(",")})`},children:[l.jsxs("h4",{children:[X.id,". ",X.name]}),l.jsx("span",{className:"multiclass-badge",children:vd(X.pixelCount,g)})]}),l.jsx("p",{className:"multiclass-desc",children:X.desc}),l.jsx("div",{className:"multiclass-preview-container",children:l.jsx("img",{src:X.preview,alt:X.name})}),l.jsxs("div",{className:"multiclass-footer",children:[X.pixelCount.toLocaleString()," pixels"]})]},X.id))}),!a&&!s&&l.jsxs("div",{className:"error-message",children:[l.jsx("p",{children:"Failed to load segmentation data. Check console for details."}),l.jsx("button",{onClick:d,children:"Retry"})]})]})]})})}function o6({frameDataUrl:e,onSave:t,onCancel:n}){const[r,s]=k.useState(0),[i,a]=k.useState(0),[c,d]=k.useState(0),[h,g]=k.useState(!1),[x,w]=k.useState(!1),_=k.useRef(null),[D,I]=k.useState(0),[Y,j]=k.useState(0),y=k.useRef(null),A=J0.useCallback((z,W,X,q,J,re,pe)=>{z.clearRect(0,0,J,re),pe&&z.drawImage(pe,0,0),z.save();const me=J/2,Se=re/2;z.translate(me,Se),z.rotate(q*Math.PI/180),z.translate(-me,-Se),z.fillStyle="rgba(0, 255, 0, 0.2)",z.fillRect(-J,W,J*3,X-W),z.strokeStyle="#00FF00",z.lineWidth=3,z.setLineDash([]),z.beginPath(),z.moveTo(-J,W),z.lineTo(J*2,W),z.stroke(),z.strokeStyle="#FFFF00",z.setLineDash([]),z.beginPath(),z.moveTo(-J,X),z.lineTo(J*2,X),z.stroke(),z.fillStyle="#00FF00",z.font="16px Arial",z.fillText("Top",10,W-5),z.fillStyle="#FFFF00",z.fillText("Bottom",10,X+20),z.restore()},[]);k.useEffect(()=>{if(!e||!_.current)return;const z=new Image;z.crossOrigin="anonymous",z.onload=()=>{const W=_.current,X=W.getContext("2d");W.width=z.width,W.height=z.height,j(z.width),I(z.height),y.current=z;const q=Math.floor(z.height*.2),J=Math.floor(z.height*.8);s(q),a(J),A(X,q,J,0,z.width,z.height,z)},e.startsWith("data:image")?z.src=e:z.src=`data:image/jpeg;base64,${e}`},[e,A]),k.useEffect(()=>{if(!_.current||D===0||!y.current)return;const z=_.current.getContext("2d");A(z,r,i,c,Y,D,y.current)},[r,i,c,Y,D,A]);const M=(z,W)=>{const X=_.current,q=X.getBoundingClientRect(),J=X.width/q.width,re=X.height/q.height,pe=(z-q.left)*J,me=(W-q.top)*re,Se=X.width/2,ie=X.height/2,ne=pe-Se,ee=me-ie,he=-c*Math.PI/180;return ne*Math.sin(he)+ee*Math.cos(he)+ie},b=z=>{const W=M(z.clientX,z.clientY);Math.abs(W-r)<10?g(!0):Math.abs(W-i)<10&&w(!0)},H=z=>{if(!h&&!x)return;const W=M(z.clientX,z.clientY),X=Math.max(-D,Math.min(D*2,W));if(h){const q=Math.min(X,i-10);s(q)}else if(x){const q=Math.max(X,r+10);a(q)}},R=()=>{g(!1),w(!1)},O=()=>{t({topY:r,bottomY:i,rotation:c})};return l.jsx("div",{className:"image-modal",onClick:n,children:l.jsxs("div",{className:"image-modal-content manual-scan-selector",onClick:z=>z.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:n,children:""}),l.jsx("h2",{children:"Set Manual Scan Area"}),l.jsx("p",{children:"Drag the green (top) and yellow (bottom) lines. Use slider to rotate."}),l.jsxs("div",{className:"scan-controls",style:{marginBottom:"10px",display:"flex",alignItems:"center",gap:"10px"},children:[l.jsxs("label",{children:["Rotation: ",c,""]}),l.jsx("input",{type:"range",min:"-45",max:"45",value:c,onChange:z=>d(Number(z.target.value)),style:{flex:1}})]}),l.jsx("canvas",{ref:_,onMouseDown:b,onMouseMove:H,onMouseUp:R,onMouseLeave:R,style:{cursor:h||x?"ns-resize":"default",maxWidth:"100%",height:"auto",border:"2px solid #333"}}),l.jsx("div",{className:"manual-scan-info",children:l.jsxs("p",{children:[l.jsx("strong",{children:"Top Y:"})," ",Math.round(r)," | ",l.jsx("strong",{children:"Bottom Y:"})," ",Math.round(i)," | ",l.jsx("strong",{children:"Height:"})," ",Math.round(i-r),"px"]})}),l.jsxs("div",{className:"manual-scan-actions",children:[l.jsx("button",{onClick:O,className:"save-btn",children:"Save Bounds"}),l.jsx("button",{onClick:n,className:"cancel-btn",children:"Cancel"})]})]})})}const O0=Ga(),a6="adminPassword",$0=e=>{if(!e||typeof e.h>"u")return null;const t=(e.h||0)*2,n=(e.s||0)/255,r=(e.v||0)/255,s=r*n,i=s*(1-Math.abs(t/60%2-1)),a=r-s;let c=0,d=0,h=0;t>=0&&t<60?(c=s,d=i,h=0):t<120?(c=i,d=s,h=0):t<180?(c=0,d=s,h=i):t<240?(c=0,d=i,h=s):t<300?(c=i,d=0,h=s):(c=s,d=0,h=i);const g=x=>{const w=Math.round((x+a)*255).toString(16);return w.length===1?"0"+w:w};return`#${g(c)}${g(d)}${g(h)}`.toUpperCase()},D0=(e,t=.3)=>{if(!e||!e.startsWith("#"))return"#0f0f23";const n=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16),i=Math.round(n*t),a=Math.round(r*t),c=Math.round(s*t);return`#${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}${c.toString(16).padStart(2,"0")}`};function Jv({sessionGameId:e,onClose:t,initialFrames:n=[],clusterColors:r={}}){var N;const[s,i]=k.useState([]),[a,c]=k.useState(0),[d,h]=k.useState(!0),[g,x]=k.useState(null),[w,_]=k.useState(""),[D,I]=k.useState(null),[Y,j]=k.useState(!1),[y,A]=k.useState({x:0,y:0}),[M,b]=k.useState({total:0,labeled:0,skipped:0}),[H,R]=k.useState([]),[O,z]=k.useState([]),[W,X]=k.useState([]),[q,J]=k.useState(!1),[re,pe]=k.useState(null),[me,Se]=k.useState({colorA:null,colorB:null}),ie=k.useRef(null),ne=k.useRef({x:0,y:0}),ee=k.useRef(null),he=v=>r[v]?r[v]:v==="Player A"?"#FF5722":v==="Player B"?"#2196F3":"#9E9E9E";k.useEffect(()=>{const v=localStorage.getItem(a6);v&&_(v);try{const T=JSON.parse(localStorage.getItem("calibrationA")||"null"),F=JSON.parse(localStorage.getItem("calibrationB")||"null"),V=$0(T),Z=$0(F);Se({colorA:V,colorB:Z}),console.log("[SwipeView]  Loaded calibration colors:",{colorA:V,colorB:Z})}catch(T){console.warn("[SwipeView] Error loading calibration colors:",T)}},[]);const _e=()=>{const v=me.colorA||r["Player A"]||"#FF5722",T=me.colorB||r["Player B"]||"#2196F3",F=D0(v,.15),V=D0(T,.15);return{background:`linear-gradient(135deg, ${F} 0%, #0f0f23 50%, ${V} 100%)`}};k.useEffect(()=>{n&&n.length>0?(i(n),b({total:n.length,labeled:0,skipped:0}),h(!1)):e&&w&&We()},[e,w,n]);const We=async()=>{if(w){h(!0),x(null);try{const v=await fetch(`${O0}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":w}});if(!v.ok)throw new Error(`Failed to load session (${v.status})`);const Z=((await v.json()).moves||[]).filter(ce=>ce.camera_frame).filter(ce=>!ce.player||ce.player==="Unknown"||ce.player==="None").map(ce=>({id:ce._id,frameUrl:ce.camera_frame,player:ce.player||"Unknown",time:ce.elapsed,confidence:null,type:ce.type,phase:ce.phase}));i(Z),b({total:Z.length,labeled:0,skipped:0})}catch(v){console.error("[SwipeView] Error loading session:",v),x(v.message)}finally{h(!1)}}};k.useCallback(async(v,T,F)=>!e||!v||!w?(console.error("[SwipeView]  Missing required data for update:",{sessionGameId:e,moveId:v,hasPassword:!!w}),!1):(console.log(`[SwipeView]  Frame #${F+1} queued: ${v}  ${T}`),!0),[e,w]);const ze=k.useCallback(async()=>{if(W.length===0)return console.log("[SwipeView] No decisions to save"),!0;if(!e||!w)return console.error("[SwipeView]  Missing sessionGameId or password"),!1;J(!0),pe(null);try{console.log(`[SwipeView]  Saving ${W.length} decisions in batch...`);const v=await fetch(`${O0}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":w},body:JSON.stringify({updates:W.map(F=>({moveId:F.moveId,player:F.player}))})});if(!v.ok)throw new Error(`Failed to save (${v.status})`);const T=await v.json();return console.log("[SwipeView]  Batch save successful:",T),!0}catch(v){return console.error("[SwipeView]  Batch save FAILED:",v.message),pe(v.message),!1}finally{J(!1)}},[W,e,w]),Ne=k.useCallback(v=>{if(a>=s.length)return;const T=s[a],F=a;let V;v==="left"?V="Player A":v==="right"?V="Player B":V="None",I(v),b(Z=>({...Z,labeled:v!=="skip"?Z.labeled+1:Z.labeled,skipped:v==="skip"?Z.skipped+1:Z.skipped})),v==="skip"?z(Z=>[...Z,T.id]):R(Z=>[...Z,T.id]),X(Z=>[...Z,{moveId:T.id,player:V,frameIndex:F}]),console.log(`[SwipeView]  Frame #${F+1}: ${T.id}  ${V}`),setTimeout(()=>{I(null),A({x:0,y:0}),c(Z=>Z+1)},200)},[a,s]),De=k.useCallback(()=>{Ne("skip")},[Ne]),se=v=>{j(!0);const T=v.type.includes("touch")?v.touches[0].clientX:v.clientX,F=v.type.includes("touch")?v.touches[0].clientY:v.clientY;ne.current={x:T,y:F}},le=k.useCallback(v=>{if(!Y)return;const T=v.type.includes("touch")?v.touches[0].clientX:v.clientX,F=v.type.includes("touch")?v.touches[0].clientY:v.clientY,V=T-ne.current.x,Z=F-ne.current.y;A({x:V,y:Z})},[Y]),ve=k.useCallback(()=>{if(!Y)return;j(!1);const v=100;y.x>v?Ne("right"):y.x<-v?Ne("left"):A({x:0,y:0})},[Y,y,Ne]);k.useEffect(()=>{const v=T=>{if(!(a>=s.length))switch(T.key){case"ArrowLeft":Ne("left");break;case"ArrowRight":Ne("right");break;case"ArrowDown":case" ":T.preventDefault(),De();break;case"Escape":t&&t({labeledIds:H,skippedIds:O});break}};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[a,s.length,Ne,De,t,H,O]),k.useEffect(()=>(Y&&(window.addEventListener("mousemove",le),window.addEventListener("mouseup",ve),window.addEventListener("touchmove",le),window.addEventListener("touchend",ve)),()=>{window.removeEventListener("mousemove",le),window.removeEventListener("mouseup",ve),window.removeEventListener("touchmove",le),window.removeEventListener("touchend",ve)}),[Y,le,ve]);const fe=s[a],U=s.length>0?a/s.length*100:0,G=a>=s.length,[Q,te]=k.useState(!1),$=y.x*.05,m=Math.max(.5,1-Math.abs(y.x)/400);k.useEffect(()=>{G&&W.length>0&&!q&&!Q&&!re&&(console.log("[SwipeView]  Completed! Triggering batch save..."),ze().then(v=>{v&&te(!0)}))},[G,W.length,q,Q,re,ze]);const P=k.useCallback(()=>{t&&t({labeledIds:H,skippedIds:O})},[t,H,O]);return d?l.jsx("div",{className:"swipe-view-container",style:_e(),children:l.jsxs("div",{className:"swipe-view-loading",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Loading frames..."})]})}):g?l.jsx("div",{className:"swipe-view-container",style:_e(),children:l.jsxs("div",{className:"swipe-view-error",children:[l.jsx("h2",{children:"Error"}),l.jsx("p",{children:g}),l.jsx("button",{onClick:P,className:"close-btn",children:"Close"})]})}):s.length===0?l.jsx("div",{className:"swipe-view-container",style:_e(),children:l.jsxs("div",{className:"swipe-view-empty",children:[l.jsx("h2",{children:" All Done!"}),l.jsx("p",{children:"No frames need review."}),l.jsx("button",{onClick:P,className:"close-btn",children:"Close"})]})}):l.jsxs("div",{className:"swipe-view-container",ref:ee,style:_e(),children:[l.jsxs("header",{className:"swipe-view-header",children:[l.jsx("button",{className:"close-btn",onClick:P,children:""}),l.jsxs("div",{className:"swipe-view-title",children:[l.jsx("h1",{children:"Swipe View"}),l.jsx("span",{className:"session-badge",children:e})]}),l.jsx("div",{className:"progress-info",children:l.jsxs("span",{children:[a," / ",s.length]})})]}),l.jsx("div",{className:"progress-bar-container",children:l.jsx("div",{className:"progress-bar",style:{width:`${U}%`}})}),l.jsx("main",{className:"swipe-view-main",children:G?l.jsxs("div",{className:"swipe-complete",children:[l.jsx("div",{className:"complete-icon",children:""}),l.jsx("h2",{children:"All Done!"}),l.jsxs("div",{className:"complete-stats",children:[l.jsxs("div",{className:"stat",children:[l.jsx("span",{className:"stat-value",children:M.labeled}),l.jsx("span",{className:"stat-label",children:"Labeled"})]}),l.jsxs("div",{className:"stat",children:[l.jsx("span",{className:"stat-value",children:M.skipped}),l.jsx("span",{className:"stat-label",children:"Skipped"})]}),l.jsxs("div",{className:"stat",children:[l.jsx("span",{className:"stat-value",children:M.total}),l.jsx("span",{className:"stat-label",children:"Total"})]})]}),q&&l.jsxs("div",{style:{color:"#FFC107",marginTop:"16px",fontSize:"14px"},children:[" Saving ",W.length," changes..."]}),re&&l.jsxs("div",{style:{color:"#f44336",marginTop:"8px",fontSize:"14px"},children:[" Save failed: ",re,l.jsx("button",{onClick:()=>{pe(null),ze().then(v=>{v&&te(!0)})},style:{marginLeft:"8px",padding:"4px 8px",cursor:"pointer"},children:"Retry"})]}),Q&&l.jsxs("div",{style:{color:"#4CAF50",marginTop:"16px",fontSize:"14px"},children:[" All ",W.length," changes saved!"]}),!q&&!re&&!Q&&W.length===0&&l.jsx("div",{style:{color:"#4CAF50",marginTop:"16px",fontSize:"14px"},children:" Nothing to save"}),l.jsx("button",{onClick:P,className:"done-btn",disabled:q,style:q?{opacity:.5,cursor:"wait"}:{},children:q?"Saving...":"Done"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"swipe-arrow left",onClick:()=>Ne("left"),style:{backgroundColor:he("Player A"),border:`4px solid ${he("Player A")}`,boxShadow:`0 0 0 4px rgba(0,0,0,0.3), 0 4px 20px ${he("Player A")}66, inset 0 0 20px rgba(255,255,255,0.1)`,outline:`3px solid ${he("Player A")}`,outlineOffset:"2px"},children:[l.jsx("span",{className:"arrow-icon",children:""}),l.jsx("span",{className:"arrow-label",children:"Player A"})]}),l.jsxs("div",{className:"swipe-card-container",children:[l.jsxs("div",{ref:ie,className:`swipe-card ${D?`swiping-${D}`:""} ${Y?"dragging":""}`,style:{transform:`translateX(${y.x}px) rotate(${$}deg)`,opacity:D?0:m},onMouseDown:se,onTouchStart:se,children:[l.jsx("div",{className:"swipe-indicator left",style:{opacity:y.x<-30?Math.min(1,Math.abs(y.x)/100):0,backgroundColor:he("Player A")},children:"Player A"}),l.jsx("div",{className:"swipe-indicator right",style:{opacity:y.x>30?Math.min(1,y.x/100):0,backgroundColor:he("Player B")},children:"Player B"}),l.jsx("div",{className:"frame-image-container",children:l.jsx("img",{src:fe.frameUrl,alt:`Frame ${a+1}`,draggable:!1})}),l.jsxs("div",{className:"frame-info",children:[l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Player:"}),l.jsx("span",{className:"info-value",children:fe.player||"Unknown"})]}),l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Time:"}),l.jsxs("span",{className:"info-value",children:[((N=fe.time)==null?void 0:N.toFixed(1))||"","s"]})]}),l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Confidence:"}),l.jsx("span",{className:"info-value",children:fe.confidence!=null?`${Math.round(fe.confidence*100)}%`:"Skipped"})]}),fe.styleLabel&&l.jsxs("div",{className:"info-row",children:[l.jsx("span",{className:"info-label",children:"Style:"}),l.jsx("span",{className:"info-value",children:fe.styleLabel})]})]})]}),l.jsx("button",{className:"skip-btn",onClick:De,children:"Skip (None)"})]}),l.jsxs("div",{className:"swipe-arrow right",onClick:()=>Ne("right"),style:{backgroundColor:he("Player B"),border:`4px solid ${he("Player B")}`,boxShadow:`0 0 0 4px rgba(0,0,0,0.3), 0 4px 20px ${he("Player B")}66, inset 0 0 20px rgba(255,255,255,0.1)`,outline:`3px solid ${he("Player B")}`,outlineOffset:"2px"},children:[l.jsx("span",{className:"arrow-icon",children:""}),l.jsx("span",{className:"arrow-label",children:"Player B"})]})]})}),l.jsxs("footer",{className:"swipe-view-footer",children:[l.jsxs("div",{className:"keyboard-hints",children:[l.jsx("span",{children:" Player A"}),l.jsx("span",{children:" or Space: Skip"}),l.jsx("span",{children:" Player B"}),l.jsx("span",{children:"Esc: Close"})]}),l.jsx("div",{className:"sync-status",style:{marginTop:"8px",display:"flex",justifyContent:"center",gap:"16px"},children:W.length>0&&l.jsxs("span",{style:{color:"#90CAF9",fontSize:"12px"},children:[" ",W.length," queued (saves at end)"]})})]})]})}const _l=Ga(),l6="adminPassword",Bi=(e,t=2)=>typeof e!="number"||!Number.isFinite(e)?"":e.toFixed(t),c6=(e,t)=>{if(!e||!e.startsWith("#"))return`rgba(0, 0, 0, ${t})`;let n=e.slice(1);if(n.length===3&&(n=n.split("").map(a=>a+a).join("")),n.length!==6)return`rgba(0, 0, 0, ${t})`;const r=parseInt(n.slice(0,2),16),s=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16);return`rgba(${r}, ${s}, ${i}, ${t})`};function u6({sessionGameId:e}){var Fo,Ei,Ci,Oo,_n,Hn,vs,ji,_i,$o;const[t,n]=k.useState(null),[r,s]=k.useState(!0),[i,a]=k.useState(null),[c,d]=k.useState(null),[h,g]=k.useState(null),[x,w]=k.useState("all"),[_,D]=k.useState("all"),[I,Y]=k.useState(""),[j,y]=k.useState(!1),[A,M]=k.useState({}),[b,H]=k.useState({current:0,total:0}),[R,O]=k.useState("#FF0000"),[z,W]=k.useState("#0000FF"),[X,q]=k.useState(!1),[J,re]=k.useState(!1),[pe,me]=k.useState({}),[Se,ie]=k.useState({current:0,total:0}),[ne,ee]=k.useState("bottom"),[he,_e]=k.useState(100),[We,ze]=k.useState(null),[Ne,De]=k.useState(null),[se,le]=k.useState(!1),[ve,fe]=k.useState(null),[U,G]=k.useState(!1),[Q,te]=k.useState(null),[$,m]=k.useState({}),[P,N]=k.useState(!1),[v,T]=k.useState(""),[F,V]=k.useState(!1),[Z,ce]=k.useState(null),[Ee,Be]=k.useState("chronological"),[Fe,nt]=k.useState(55),[qe,lt]=k.useState(!1),[ct,Ge]=k.useState({current:0,total:0}),[Ue,Ve]=k.useState(null),[Ze,Ct]=k.useState(!1),[On,mt]=k.useState([]),[Dt,Pt]=k.useState({}),tn=k.useCallback(async L=>{if(!L)return{suggestion:"None",stats:null};try{const ue=await Y5(L,R,z,{anchor:ne,modelSelection:1,stride:2,maskThreshold:100,colorThreshold:95,scanDepth:ne==="manually"&&Ne?null:he/100,manualBounds:ne==="manually"?Ne:null});if(ue)return ue}catch(ue){console.warn("[MoveHistoryEditor] Selfie segmentation detector failed, falling back to color bands:",ue)}return V5(L,R,z,{anchor:ne})},[R,z,ne,he,Ne]);k.useEffect(()=>{const L=localStorage.getItem(l6);L&&Y(L)},[]),k.useEffect(()=>{e&&I&&cn()},[e,I]);const ln=L=>{if(!L||typeof L.h>"u")return null;const ue=(L.h||0)*2,ge=(L.s||0)/255,ae=(L.v||0)/255,xe=ae*ge,Le=xe*(1-Math.abs(ue/60%2-1)),Ce=ae-xe;let He=0,Re=0,Ke=0;ue>=0&&ue<60?(He=xe,Re=Le,Ke=0):ue<120?(He=Le,Re=xe,Ke=0):ue<180?(He=0,Re=xe,Ke=Le):ue<240?(He=0,Re=Le,Ke=xe):ue<300?(He=Le,Re=0,Ke=xe):(He=xe,Re=0,Ke=Le);const Xt=ir=>{const Nn=Math.round((ir+Ce)*255).toString(16);return Nn.length===1?"0"+Nn:Nn};return`#${Xt(He)}${Xt(Re)}${Xt(Ke)}`.toUpperCase()},cn=async()=>{var L,ue,ge,ae;if(I){s(!0),a(null);try{const xe=await fetch(`${_l}/sessions/${encodeURIComponent(e)}`,{headers:{"x-admin-password":I}});if(!xe.ok)throw new Error(`Failed to load session (${xe.status})`);const Le=await xe.json();n(Le);let Ce=null,He=null,Re="";if(Le.colorA&&Le.colorB?(Ce=Le.colorA,He=Le.colorB,Re="session root"):(ue=(L=Le.metadata)==null?void 0:L.config)!=null&&ue.colorA&&((ae=(ge=Le.metadata)==null?void 0:ge.config)!=null&&ae.colorB)&&(Ce=Le.metadata.config.colorA,He=Le.metadata.config.colorB,Re="session metadata"),Ce&&He)O(Ce),W(He),console.log(`[MoveHistoryEditor]  Loaded colors from ${Re}:`,Ce,He);else try{const Ke=JSON.parse(localStorage.getItem("calibrationA")||"null"),Xt=JSON.parse(localStorage.getItem("calibrationB")||"null");if(Ke&&Xt){const ir=ln(Ke),Nn=ln(Xt);ir&&Nn?(O(ir),W(Nn),console.log("[MoveHistoryEditor]  Session has no colors, loaded from localStorage calibration:",ir,Nn)):console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}else console.log("[MoveHistoryEditor]  No calibration found, using default colors (red/blue)")}catch(Ke){console.warn("[MoveHistoryEditor] Error reading calibration from localStorage:",Ke),console.log("[MoveHistoryEditor]  Using default colors (red/blue)")}}catch(xe){console.error("[MoveHistoryEditor] Error loading session:",xe),a(xe.message)}finally{s(!1)}}},En=async(L,ue)=>{if(!(!e||!L||!I))try{const ge=await fetch(`${_l}/sessions/${encodeURIComponent(e)}/moves/${encodeURIComponent(L)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-admin-password":I},body:JSON.stringify({player:ue})});if(!ge.ok)throw new Error(`Failed to update player (${ge.status})`);n(ae=>ae&&{...ae,moves:ae.moves.map(xe=>xe._id===L?{...xe,player:ue}:xe)}),M(ae=>{const xe={...ae};return delete xe[L],xe}),console.log("[MoveHistoryEditor] Player updated:",L,ue)}catch(ge){console.error("[MoveHistoryEditor] Error updating player:",ge),alert("Failed to update player: "+ge.message)}},Cn=async L=>{const ue=A[L];ue&&await En(L,ue.player)},Jr=async L=>{const ue=pe[L];ue&&(await En(L,ue.player),me(ge=>{const ae={...ge};return delete ae[L],ae}))},Fr=async L=>{if(!t||!Array.isArray(t.moves))return;const ue=t.moves.find(ge=>ge._id===L);if(!ue||!ue.camera_frame){alert("This move has no camera frame for color-based identification.");return}try{console.log(`[MoveHistoryEditor] Color-identifying single move: ${L}`);const ge=await tn(ue.camera_frame);if(!ge){alert("Color-based identification failed for this move.");return}me(Le=>({...Le,[L]:{method:"color",player:ge.suggestion==="A"?"Player A":ge.suggestion==="B"?"Player B":"None",stats:ge.stats,preview:ge.preview}}));let ae=null,xe=null;try{ae=JSON.parse(localStorage.getItem("calibrationA")||"null")}catch{ae=null}try{xe=JSON.parse(localStorage.getItem("calibrationB")||"null")}catch{xe=null}ze({moveId:L,original:ue.camera_frame,preview:ge.preview,maskPreview:ge.maskPreview,stats:ge.stats,suggestion:ge.suggestion,colorA:R,colorB:z,calibrationA:ae,calibrationB:xe,anchor:ne})}catch(ge){console.error("[MoveHistoryEditor] Error color-identifying move:",ge),alert("Color-based identification failed: "+ge.message)}},$n=k.useCallback(async({mode:L})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ue=t.moves.filter(ae=>ae.camera_frame);if(ue.length===0){alert("No camera frames available for cloth-based identification.");return}const ge=new Set(t.moves.filter(ae=>!ae.player||ae.player==="Unknown"||ae.player==="None").map(ae=>ae._id));if(L==="unknown"&&ge.size===0){alert("All moves already have players assigned.");return}G(!0),te(null);try{const ae=ue.map(Re=>({moveId:Re._id,frameDataUrl:Re.camera_frame,existingPlayer:Re.player&&Re.player!=="Unknown"?Re.player:null})),xe=await Q5(ae,{maxFrames:ue.length,stride:2,minClothPixels:80,manualBounds:ne==="manually"?Ne:null});xe!=null&&xe.analytics&&te(xe.analytics);const Le={};xe!=null&&xe.assignments&&Object.entries(xe.assignments).forEach(([Re,Ke])=>{var Xt;(Xt=Ke.stats)!=null&&Xt.debugPreview&&(Le[Re]=Ke.stats.debugPreview)}),Object.keys(Le).length>0&&m(Le);const Ce={};xe!=null&&xe.assignments&&Object.entries(xe.assignments).forEach(([Re,Ke])=>{(L==="all"||ge.has(Re))&&(Ce[Re]={method:"cloth",player:Ke.player,styleLabel:Ke.styleLabel,confidence:Ke.confidence,stats:Ke.stats})});const He=Object.keys(Ce).length;He===0?alert(`Cloth-based method did not find suggestions for any ${L==="all"?"moves":"unknown moves"}.`):(me(Ke=>({...Ke,...Ce})),alert(`Cloth-based method suggested players for ${He} ${L==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(ae){console.error("[MoveHistoryEditor] Cloth identification failed:",ae),alert("Cloth-based identification failed: "+ae.message)}finally{G(!1)}},[t,ne,Ne]);k.useCallback(()=>{$n({mode:"all"})},[$n]),k.useCallback(()=>{$n({mode:"unknown"})},[$n]);const Dn=k.useCallback(async({mode:L})=>{if(!t||!Array.isArray(t.moves)){alert("No session data available.");return}const ue=t.moves.filter(ae=>ae.camera_frame);if(ue.length===0){alert("No camera frames available for All-All identification.");return}const ge=new Set(t.moves.filter(ae=>!ae.player||ae.player==="Unknown"||ae.player==="None").map(ae=>ae._id));if(L==="unknown"&&ge.size===0){alert("All moves already have players assigned.");return}V(!0),ce(null);try{const ae=ue.map(Re=>({moveId:Re._id,frameDataUrl:Re.camera_frame,existingPlayer:Re.player&&Re.player!=="Unknown"&&Re.player!=="None"?Re.player:null})),xe=await r6(ae,{maxFrames:ue.length,stride:2,minPixels:80,manualBounds:ne==="manually"?Ne:null,playerColors:{"Player A":R,"Player B":z}});xe!=null&&xe.analytics&&ce(xe.analytics);const Le={};xe!=null&&xe.assignments&&Object.entries(xe.assignments).forEach(([Re,Ke])=>{var Xt;(Xt=Ke.stats)!=null&&Xt.debugPreview&&(Le[Re]=Ke.stats.debugPreview)}),Object.keys(Le).length>0&&m(Re=>({...Re,...Le}));const Ce={};xe!=null&&xe.assignments&&Object.entries(xe.assignments).forEach(([Re,Ke])=>{(L==="all"||ge.has(Re))&&(Ce[Re]={method:"allall",player:Ke.player,styleLabel:Ke.styleLabel,confidence:Ke.confidence,stats:Ke.stats})});const He=Object.keys(Ce).length;He===0?alert(`All-All method did not find suggestions for any ${L==="all"?"moves":"unknown moves"}.`):(me(Ke=>({...Ke,...Ce})),alert(`All-All method suggested players for ${He} ${L==="all"?"moves":"unknown moves"}. Review and confirm suggestions below.`))}catch(ae){console.error("[MoveHistoryEditor] All-All identification failed:",ae),alert("All-All identification failed: "+ae.message)}finally{V(!1)}},[t,ne,Ne]),ys=k.useCallback(()=>{Dn({mode:"all"})},[Dn]),zn=k.useCallback(()=>{Dn({mode:"unknown"})},[Dn]),Si=async L=>{if(!(!e||!I))try{console.log(`[MoveHistoryEditor] Identifying single move: ${L}`);const ue=await fetch(`${_l}/ai/identify-move`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":I},body:JSON.stringify({sessionGameId:e,moveId:L,colorA:R,colorB:z,cameraPosition:ne==="top"||ne==="bottom"?ne:void 0})});if(ue.ok){const ge=await ue.json();M(ae=>({...ae,[L]:{player:ge.suggestion==="A"?"Player A":ge.suggestion==="B"?"Player B":"None",confidence:ge.confidence,rawResponse:ge.rawResponse}})),console.log(`[MoveHistoryEditor]  Move identified: ${ge.suggestion}`)}else{const ge=await ue.json();alert(`Failed to identify move: ${ge.message}`)}}catch(ue){console.error("[MoveHistoryEditor] Error identifying move:",ue),alert("AI identification failed: "+ue.message)}},jn=((Fo=t==null?void 0:t.moves)==null?void 0:Fo.filter(L=>{let ue=!0;x!=="all"&&(ue=L.phase===x);let ge=!0;return _!=="all"&&(_==="None"?ge=!L.player||L.player==="None"||L.player==="Unknown":ge=L.player===_),ue&&ge}))||[],Js=(()=>{const L=[...jn];return Ee==="chronological"?L:L.sort((ue,ge)=>{var He,Re;const ae=!!pe[ue._id],xe=!!pe[ge._id];if(ae&&!xe)return-1;if(!ae&&xe)return 1;if(!ae&&!xe)return 0;const Le=((He=pe[ue._id])==null?void 0:He.confidence)||0,Ce=((Re=pe[ge._id])==null?void 0:Re.confidence)||0;return Ee==="confidenceDesc"?Ce-Le:Ee==="confidenceAsc"?Le-Ce:0})})(),wt=async()=>{if(!e||!I)return;const L=Object.entries(pe).filter(([ue,ge])=>(ge.confidence||0)*100>=Fe).map(([ue,ge])=>({moveId:ue,player:ge.player}));if(L.length===0){alert(`No moves found with confidence above ${Fe}%`);return}if(window.confirm(`Are you sure you want to confirm ${L.length} moves with confidence >= ${Fe}%?`)){lt(!0),Ge({current:0,total:L.length});try{const ue=await fetch(`${_l}/sessions/${encodeURIComponent(e)}/moves/update-players-batch`,{method:"POST",headers:{"Content-Type":"application/json","x-admin-password":I},body:JSON.stringify({updates:L})});if(!ue.ok)throw new Error(`Failed to update players (${ue.status})`);const ge=await ue.json();console.log("[MoveHistoryEditor] Bulk update success:",ge),n(ae=>{if(!ae)return ae;const xe=ae.moves.map(Le=>{const Ce=L.find(He=>He.moveId===Le._id);return Ce?{...Le,player:Ce.player}:Le});return{...ae,moves:xe}}),me(ae=>{const xe={...ae};return L.forEach(({moveId:Le})=>{delete xe[Le]}),xe}),alert(`Successfully confirmed ${L.length} moves.`)}catch(ue){console.error("Failed to confirm moves:",ue),alert("Failed to confirm moves: "+ue.message)}finally{lt(!1),Ge({current:0,total:0})}}},Un=()=>{if(!t||!Array.isArray(t.moves))return;const L={};Z!=null&&Z.clusters?Z.clusters.forEach(Ce=>{Ce.assignedPlayer&&Ce.hexColor&&(L[Ce.assignedPlayer]=Ce.hexColor)}):Q!=null&&Q.clusters&&Q.clusters.forEach(Ce=>{Ce.assignedPlayer&&Ce.hexColor&&(L[Ce.assignedPlayer]=Ce.hexColor)}),L["Player A"]||(L["Player A"]=R),L["Player B"]||(L["Player B"]=z);const ue=t.moves.filter(Ce=>Ce.camera_frame),ge=ue.filter(Ce=>{const He=pe[Ce._id];return He?(He.confidence||0)*100<Fe:!1}).map(Ce=>{const He=pe[Ce._id];return{id:Ce._id,frameUrl:Ce.camera_frame,player:Ce.player||"Unknown",time:Ce.elapsed,confidence:(He==null?void 0:He.confidence)||null,styleLabel:He==null?void 0:He.styleLabel,type:Ce.type,phase:Ce.phase,needsReview:!0}}),ae=new Set(ge.map(Ce=>Ce.id)),xe=ue.filter(Ce=>!ae.has(Ce._id)&&(!Ce.player||Ce.player==="Unknown"||Ce.player==="None")).map(Ce=>({id:Ce._id,frameUrl:Ce.camera_frame,player:Ce.player||"Unknown",time:Ce.elapsed,confidence:null,type:Ce.type,phase:Ce.phase,needsReview:!0})),Le=[...ge,...xe];if(Le.length===0){alert("No frames need review! All frames are either confirmed or have high confidence.");return}mt(Le),Pt(L),Ct(!0)},Lo=L=>{Ct(!1),L!=null&&L.labeledIds&&L.labeledIds.length>0&&(me(ue=>{const ge={...ue};return L.labeledIds.forEach(ae=>{delete ge[ae]}),ge}),M(ue=>{const ge={...ue};return L.labeledIds.forEach(ae=>{delete ge[ae]}),ge})),cn()};if(r)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-loading",children:"Loading session data..."})});if(i)return l.jsx("div",{className:"move-editor-container",children:l.jsxs("div",{className:"move-editor-error",children:[l.jsx("h2",{children:"Error Loading Session"}),l.jsx("p",{children:i}),l.jsx("button",{onClick:()=>window.location.hash="#/admin",children:" Back to Admin"})]})});if(!t)return l.jsx("div",{className:"move-editor-container",children:l.jsx("div",{className:"move-editor-error",children:"Session not found"})});const vu=((Ei=t.moves)==null?void 0:Ei.filter(L=>L.phase==="practice").length)||0,ki=((Ci=t.moves)==null?void 0:Ci.filter(L=>L.phase==="experiment").length)||0,Ai=((Oo=t.moves)==null?void 0:Oo.filter(L=>L.player==="Player A").length)||0,qs=((_n=t.moves)==null?void 0:_n.filter(L=>L.player==="Player B").length)||0,Zs=((Hn=t.moves)==null?void 0:Hn.filter(L=>!L.player||L.player==="None"||L.player==="Unknown").length)||0;return l.jsxs("div",{className:"move-editor-container",children:[l.jsxs("header",{className:"move-editor-header",children:[l.jsx("button",{className:"back-button",onClick:()=>window.location.hash="#/admin",children:" Back to Admin"}),l.jsxs("div",{className:"move-editor-title",children:[l.jsx("h1",{children:"Move History Editor"}),l.jsxs("div",{className:"session-info",children:[l.jsxs("span",{className:"session-id",children:["Session: ",e]}),l.jsxs("span",{className:"session-meta",children:["Participant: ",t.subjectId]}),l.jsxs("span",{className:"session-meta",children:["Condition: ",t.condition]})]}),l.jsxs("div",{className:"player-stats",style:{marginTop:"5px",fontSize:"0.9em"},children:[l.jsxs("span",{style:{marginRight:"15px",color:R,fontWeight:"bold"},children:["Player A: ",Ai]}),l.jsxs("span",{style:{color:z,fontWeight:"bold"},children:["Player B: ",qs]})]})]}),l.jsxs("div",{className:"header-center-group",children:[l.jsxs("div",{className:"phase-filter",children:[l.jsxs("button",{className:`filter-btn ${x==="all"?"active":""}`,onClick:()=>w("all"),children:["All (",((vs=t.moves)==null?void 0:vs.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${x==="practice"?"active":""}`,onClick:()=>w("practice"),children:["Practice (",vu,")"]}),l.jsxs("button",{className:`filter-btn ${x==="experiment"?"active":""}`,onClick:()=>w("experiment"),children:["Experiment (",ki,")"]})]}),l.jsxs("div",{className:"player-filter",style:{marginTop:"4px"},children:[l.jsxs("button",{className:`filter-btn ${_==="all"?"active":""}`,onClick:()=>D("all"),children:["All Players (",((ji=t.moves)==null?void 0:ji.length)||0,")"]}),l.jsxs("button",{className:`filter-btn ${_==="Player A"?"active":""}`,onClick:()=>D("Player A"),style:{borderColor:R,color:_==="Player A"?"white":R,backgroundColor:_==="Player A"?R:"transparent"},children:["Player A (",Ai,")"]}),l.jsxs("button",{className:`filter-btn ${_==="Player B"?"active":""}`,onClick:()=>D("Player B"),style:{borderColor:z,color:_==="Player B"?"white":z,backgroundColor:_==="Player B"?z:"transparent"},children:["Player B (",qs,")"]}),l.jsxs("button",{className:`filter-btn ${_==="None"?"active":""}`,onClick:()=>D("None"),children:["None/Unknown (",Zs,")"]})]})]}),l.jsxs("div",{className:"header-controls-group",children:[l.jsxs("div",{className:"bracelet-colors-controls",children:[l.jsx("button",{className:"color-picker-toggle",onClick:()=>q(!X),children:"Bracelet Colors"}),X&&l.jsxs("div",{className:"color-picker-panel",children:[l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player A:"}),l.jsx("input",{type:"color",value:R,onChange:L=>O(L.target.value)}),l.jsx("span",{children:R})]}),l.jsxs("div",{className:"color-input-group",children:[l.jsx("label",{children:"Player B:"}),l.jsx("input",{type:"color",value:z,onChange:L=>W(L.target.value)}),l.jsx("span",{children:z})]})]})]}),l.jsxs("div",{className:"color-controls",children:[Object.keys($).length>0&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:`ai-btn debug-btn ${P?"active":""}`,onClick:()=>N(!P),style:{backgroundColor:P?"#4CAF50":"#666",marginLeft:"20px"},children:P?" Debug View ON":" Show Debug View"}),l.jsx("button",{className:"ai-btn debug-btn",onClick:()=>{N(!1),m({})},style:{backgroundColor:"#ff5722"},children:" Clear Debug"})]}),l.jsx("button",{className:"ai-btn allall-btn",onClick:ys,disabled:F,children:F?" Identifying by All All...":" Identify by All All"}),l.jsx("button",{className:"ai-btn allall-btn",onClick:zn,disabled:F,children:F?" Identifying by All All...":" Identify by All Unknown"}),l.jsxs("button",{onClick:Un,style:{background:"linear-gradient(135deg, #9C27B0, #673AB7)",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px",boxShadow:"0 2px 8px rgba(156, 39, 176, 0.3)"},title:"Open Swipe View to review frames",children:[" Swipe View (",(()=>{const L=new Set(((t==null?void 0:t.moves)||[]).filter(ge=>ge.camera_frame&&(!ge.player||ge.player==="Unknown"||ge.player==="None")).map(ge=>ge._id));return new Set(Object.entries(pe).filter(([,ge])=>(ge.confidence||0)*100<Fe).map(([ge])=>ge)).forEach(ge=>L.add(ge)),L.size})(),")"]}),l.jsxs("div",{className:"color-anchor-toggle",style:{display:"flex",alignItems:"center",gap:"10px"},children:[l.jsxs("div",{className:"scan-mode-radios",style:{display:"flex",gap:"10px",alignItems:"center"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("input",{type:"radio",name:"scanMode",checked:ne!=="manually",onChange:()=>{ee("bottom"),le(!1),De(null),fe(null)}}),"General"]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("input",{type:"radio",name:"scanMode",checked:ne==="manually",onChange:()=>{ee("manually");const L=(t==null?void 0:t.moves)||[];if(L.length>0){const ue=L[Math.floor(Math.random()*L.length)];ue!=null&&ue.camera_frame?(fe(ue.camera_frame),le(!0)):(alert("No frames available. Please ensure moves have camera frames."),ee("bottom"))}else alert("No moves available."),ee("bottom")}}),"Manual"]})]}),ne!=="manually"&&l.jsxs(l.Fragment,{children:[l.jsx("label",{children:"Scan area:"}),l.jsxs("select",{value:ne,onChange:L=>ee(L.target.value),style:{padding:"6px",borderRadius:"4px",background:"#222",color:"#fff",border:"1px solid #444"},children:[l.jsx("option",{value:"bottom",children:"Bottom"}),l.jsx("option",{value:"top",children:"Top"})]}),l.jsxs("div",{className:"color-scan-percentage",children:[l.jsxs("label",{children:[he,"%"]}),l.jsx("input",{type:"range",min:"20",max:"100",step:"5",value:he,onChange:L=>_e(Number(L.target.value)),style:{width:"80px",marginLeft:"8px"}})]})]}),ne==="manually"&&l.jsxs("div",{className:"manual-bounds-info",style:{display:"flex",alignItems:"center",gap:"8px"},children:[Ne?l.jsxs("span",{style:{fontSize:"12px",color:"#aaa"},children:["Y: ",Math.round(Ne.topY),"",Math.round(Ne.bottomY)]}):l.jsx("span",{style:{fontSize:"12px",color:"#f44336"},children:"Not set"}),l.jsx("button",{onClick:()=>{if(ve)le(!0);else{const L=(t==null?void 0:t.moves)||[],ue=L[Math.floor(Math.random()*L.length)];ue!=null&&ue.camera_frame&&(fe(ue.camera_frame),le(!0))}},className:"ai-btn",style:{padding:"4px 8px",fontSize:"12px",backgroundColor:"#2196F3"},children:"Change scan area"})]})]})]})]})]}),Q&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsx("div",{className:"cloth-analytics-header",children:l.jsxs("div",{children:[l.jsx("h3",{children:"Cloth Styles Analytics"}),l.jsxs("p",{children:["Frames analyzed: ",Q.usedFrames,"/",Q.totalFrames,"  Skipped:"," ",Q.skippedFrames]})]})}),l.jsx("div",{className:"cloth-style-grid",children:(_i=Q.clusters)==null?void 0:_i.map(L=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:L.styleLabel}),l.jsx("span",{className:"player-label",children:L.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:L.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",L.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",L.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Bi(L.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Bi(L.avgBrightness||0)]})]})]},L.id))})]}),Z&&l.jsxs("section",{className:"cloth-analytics",children:[l.jsxs("div",{className:"cloth-analytics-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:" All-All Styles Analytics (Background Excluded)"}),l.jsxs("p",{children:["Frames analyzed: ",Z.usedFrames,"/",Z.totalFrames,"  Skipped:"," ",Z.skippedFrames]})]}),l.jsxs("div",{className:"analytics-controls",style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"15px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#f5f5f5",padding:"4px 8px",borderRadius:"4px"},children:[l.jsxs("label",{style:{fontSize:"14px"},children:["Confirm threshold: ",Fe,"%"]}),l.jsx("input",{type:"range",min:"50",max:"100",value:Fe,onChange:L=>nt(Number(L.target.value)),style:{width:"100px"}}),l.jsx("button",{onClick:wt,disabled:qe,style:{backgroundColor:qe?"#9E9E9E":"#4CAF50",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:qe?"not-allowed":"pointer",fontSize:"12px",fontWeight:"bold",minWidth:"140px"},children:qe?`Saving ${ct.current}/${ct.total}...`:`Confirm All  ${Fe}% (${Object.values(pe).filter(L=>(L.confidence||0)*100>=Fe).length})`})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("label",{children:"Sort by:"}),l.jsxs("select",{value:Ee,onChange:L=>Be(L.target.value),style:{padding:"4px",borderRadius:"4px"},children:[l.jsx("option",{value:"chronological",children:"Chronological"}),l.jsx("option",{value:"confidenceDesc",children:"Confidence (High to Low)"}),l.jsx("option",{value:"confidenceAsc",children:"Confidence (Low to High)"})]})]}),l.jsx("button",{onClick:Un,style:{background:"linear-gradient(135deg, #9C27B0, #673AB7)",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px",boxShadow:"0 2px 8px rgba(156, 39, 176, 0.3)"},title:"Open Swipe View to review unconfirmed frames",children:" Review Unconfirmed"})]})]}),l.jsx("div",{className:"cloth-style-grid",children:($o=Z.clusters)==null?void 0:$o.map(L=>l.jsxs("div",{className:"cloth-style-card",children:[l.jsxs("div",{className:"cloth-style-card-header",children:[l.jsx("span",{className:"style-label",children:L.styleLabel}),l.jsx("span",{className:"player-label",children:L.assignedPlayer})]}),l.jsx("div",{className:"cloth-style-color-chip",style:{backgroundColor:L.hexColor}}),l.jsxs("div",{className:"cloth-style-stats",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Mean color:"})," ",L.hexColor]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Frames:"})," ",L.sampleCount]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg pixels:"})," ",Bi(L.avgPixels||0)]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Avg brightness:"})," ",Bi(L.avgBrightness||0)]})]})]},L.id))})]}),l.jsxs("div",{className:"move-editor-content",children:[l.jsx("div",{className:"moves-grid",children:Js.map((L,ue)=>{var ge;return l.jsxs("div",{className:`move-card ${(c==null?void 0:c._id)===L._id?"selected":""}`,onClick:()=>d(L),children:[l.jsxs("div",{className:"move-card-header",children:[l.jsxs("span",{className:"move-number",children:["#",ue+1]}),l.jsx("span",{className:`move-phase ${L.phase}`,children:L.phase})]}),L.camera_frame&&l.jsxs("div",{className:"move-image",onClick:ae=>{ae.stopPropagation(),g(P&&$[L._id]?$[L._id]:L.camera_frame)},style:{position:"relative"},children:[l.jsx("img",{src:P&&$[L._id]?$[L._id]:L.camera_frame,alt:`Move ${ue+1}`}),l.jsx("div",{className:"image-overlay",children:" Click to enlarge"}),P&&$[L._id]&&l.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(76, 175, 80, 0.9)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:" DEBUG"})]}),l.jsxs("div",{className:"move-card-body",children:[l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Type:"}),l.jsx("span",{className:"value",children:L.type})]}),A[L._id]&&(()=>{const ae=A[L._id].player,Le=ae==="A"||ae==="Player A"?R:z;return l.jsxs("div",{className:"ai-suggestion-banner",style:{borderColor:Le,outline:`2px solid ${c6(Le,.25)}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:""}),l.jsxs("span",{className:"ai-text",children:["AI suggests: ",l.jsx("strong",{children:A[L._id].player})]})]}),l.jsx("button",{className:"ai-confirm-btn",onClick:Ce=>{Ce.stopPropagation(),Cn(L._id)},children:" Confirm"})]})})(),pe[L._id]&&(()=>{const ae=pe[L._id],Ce=ae.player==="Player A"?R:z,He=ae.method||"color",Re=He==="cloth"?"":He==="allall"?"":"",Ke=He==="cloth"?`Cloth suggests${ae.styleLabel?` (${ae.styleLabel})`:""}:`:He==="allall"?`All-All suggests${ae.styleLabel?` (${ae.styleLabel})`:""}:`:"Color suggests:",Xt=typeof ae.confidence=="number"?`  ${Math.round(ae.confidence*100)}% confidence`:"";let ir=Ce;if(ae.stats&&ae.stats.meanColor){const{r:Nn,g:Ja,b:qa}=ae.stats.meanColor,Kt=Za=>{const Ni=Math.round(Za).toString(16);return Ni.length===1?"0"+Ni:Ni};ir=`#${Kt(Nn)}${Kt(Ja)}${Kt(qa)}`}return l.jsxs("div",{className:"ai-suggestion-banner color-suggestion-banner",style:{borderColor:ir,borderWidth:"2px",outline:`4px solid ${ir}`,outlineOffset:"2px"},children:[l.jsxs("div",{className:"ai-suggestion-content",children:[l.jsx("span",{className:"ai-icon",children:Re}),l.jsxs("span",{className:"ai-text",children:[Ke," ",l.jsx("strong",{children:ae.player}),Xt]})]}),l.jsx("button",{className:"ai-confirm-btn",disabled:Ue===L._id,onClick:async Nn=>{Nn.stopPropagation(),Ve(L._id),await Jr(L._id),Ve(null)},children:Ue===L._id?"...":" Confirm"})]})})(),l.jsxs("div",{className:"move-info-row player-row",style:{borderColor:L.player==="Player A"?R:L.player==="Player B"?z:L.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("span",{className:"label",children:"Player:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",flex:1,alignItems:"center"},children:[l.jsxs("select",{className:`player-select ${(ge=L.player)==null?void 0:ge.toLowerCase().replace(" ","-")}`,value:L.player||"Unknown",onChange:ae=>En(L._id,ae.target.value),onClick:ae=>ae.stopPropagation(),style:{flex:1,borderColor:L.player==="Player A"?R:L.player==="Player B"?z:L.player==="None"?"#9E9E9E":"#FFC107"},children:[l.jsx("option",{value:"Player A",children:"Player A"}),l.jsx("option",{value:"Player B",children:"Player B"}),l.jsx("option",{value:"None",children:"None"}),l.jsx("option",{value:"Unknown",children:"Unknown"})]}),L.camera_frame&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"ai-single-btn",onClick:ae=>{ae.stopPropagation(),Si(L._id)},title:"Identify this move with AI",children:""}),l.jsx("button",{className:"ai-single-btn color-single-btn",onClick:ae=>{ae.stopPropagation(),Fr(L._id)},title:"Identify this move by color",children:""})]})]})]}),L.blockId!==null&&L.blockId!==void 0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Block:"}),l.jsx("span",{className:"value",children:L.blockId})]}),Array.isArray(L.position)&&L.position.length===2&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Position:"}),l.jsxs("span",{className:"value",children:["(",L.position[0],", ",L.position[1],")"]})]}),l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Time:"}),l.jsxs("span",{className:"value",children:[Bi(L.elapsed,1),"s"]})]}),Number.isFinite(L.holdTime)&&L.holdTime>0&&l.jsxs("div",{className:"move-info-row",children:[l.jsx("span",{className:"label",children:"Hold:"}),l.jsxs("span",{className:"value",children:[Bi(L.holdTime,2),"s"]})]})]})]},L._id||ue)})}),jn.length===0&&l.jsx("div",{className:"no-moves",children:l.jsx("p",{children:"No moves found for selected filter."})})]}),h&&l.jsx("div",{className:"image-modal",onClick:()=>g(null),children:l.jsxs("div",{className:"image-modal-content",onClick:L=>L.stopPropagation(),children:[l.jsx("button",{className:"close-modal",onClick:()=>g(null),children:""}),l.jsx("img",{src:h,alt:"Expanded view"})]})}),l.jsx(i6,{colorPreview:We,onClose:()=>ze(null)}),se&&ve&&l.jsx(o6,{frameDataUrl:ve,onSave:L=>{De(L),le(!1)},onCancel:()=>{le(!1),ee("bottom"),fe(null)}}),Ze&&l.jsx(Jv,{sessionGameId:e,onClose:Lo,initialFrames:On,clusterColors:Dt})]})}const d6=!1;function f6(){const[e,t]=k.useState(!1),[n,r]=k.useState(null),[s,i]=k.useState(null),[a,c]=k.useState(window.location.hash),[d,h]=k.useState(!1);k.useEffect(()=>{const I=()=>{c(window.location.hash)};return window.addEventListener("hashchange",I),()=>window.removeEventListener("hashchange",I)},[]),k.useEffect(()=>(window.toggleInterface=I=>{h(I),console.log("[App] Interface "+(I?"hidden":"shown"))},()=>{window.toggleInterface&&delete window.toggleInterface}),[]);const g=I=>{r(I),t(!0)},x=()=>{s&&!s.closed&&s.close();const I=window.location.origin+window.location.pathname+"#/detector",Y=window.open(I,"BraceletDetector","width=700,height=600,left=100,top=100");i(Y)};k.useEffect(()=>()=>{s&&!s.closed&&s.close()},[s]),k.useEffect(()=>(window.secEnd=()=>{try{console.log("[App] secEnd() called - triggering game end"),window.endGameExperience?window.endGameExperience():(console.warn("[App] endGameExperience() not available - game may not be running"),alert("Game is not currently running or already ended."))}catch(I){console.error("Error ending experience:",I),alert("Error ending experience: "+I.message)}},()=>{window.secEnd&&delete window.secEnd}),[]);let w=null;const _=a.match(/^#\/admin\/edit-moves\/(.+)$/),D=a.match(/^#\/admin\/swipe\/(.+)$/);if(a==="#/detector")w=l.jsx(x1,{});else if(a==="#/calibrate")w=l.jsx(gw,{});else if(a==="#/detector2")w=l.jsx(yw,{});else if(a==="#/summary")w=l.jsx(ny,{});else if(a==="#/admin")w=l.jsx(xw,{});else if(a==="#/admin/upload")w=l.jsx(ww,{});else if(D){const I=decodeURIComponent(D[1]);w=l.jsx(Jv,{sessionGameId:I,onClose:()=>window.location.hash=`#/admin/edit-moves/${encodeURIComponent(I)}`},I)}else if(_){const I=decodeURIComponent(_[1]);w=l.jsx(u6,{sessionGameId:I},I)}else w=e?l.jsxs(l.Fragment,{children:[l.jsx(pw,{config:n,interfaceHidden:d}),l.jsx(x1,{hidden:d}),d6,!d&&l.jsxs("div",{style:{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",gap:4,zIndex:9999},children:[l.jsx("button",{onClick:x,style:{background:"#4CAF50",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},title:"Open Bracelet Detector in new window",children:" Detector"}),l.jsx("a",{href:"#/detector2",style:{background:"#222",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none"},children:"Detector2"}),l.jsx("a",{href:"#/admin",style:{background:"#444",color:"#fff",padding:"4px 8px",borderRadius:4,fontSize:12,textDecoration:"none",textAlign:"center"},children:"Admin"})]}),!d&&l.jsx("div",{style:{position:"fixed",bottom:8,left:8,zIndex:9999},children:l.jsx("button",{onClick:()=>h(!0),style:{background:"#555",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:14,border:"none",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:"Hide"})})]}):l.jsx(ow,{onStart:g});return l.jsx("div",{className:"App",children:w})}xd.createRoot(document.getElementById("root")).render(l.jsx(J0.StrictMode,{children:l.jsx(f6,{})}));
